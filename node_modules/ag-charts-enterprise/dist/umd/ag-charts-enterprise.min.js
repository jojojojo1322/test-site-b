(function(kp,aa){typeof exports=="object"&&typeof module=="object"?module.exports=aa():typeof define=="function"&&define.amd?define("agCharts",[],aa):typeof exports=="object"?exports.agCharts=aa():kp.agCharts=aa()})(this,()=>{var kp={},aa={exports:kp};if(typeof nse>"u")var nse=function(t){throw new Error("Unknown module: "+t)};var lm=Object.defineProperty,mL=Object.getOwnPropertyDescriptor,a_=Object.getOwnPropertyNames,r_=Object.prototype.hasOwnProperty,Vs=(e,t)=>{for(var i in t)lm(e,i,{get:t[i],enumerable:!0})},l_=(e,t,i,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of a_(t))!r_.call(e,n)&&n!==i&&lm(e,n,{get:()=>t[n],enumerable:!(s=mL(t,n))||s.enumerable});return e},c_=e=>l_(lm({},"__esModule",{value:!0}),e),g=(e,t,i,s)=>{for(var n=s>1?void 0:s?mL(t,i):t,o=e.length-1,a;o>=0;o--)(a=e[o])&&(n=(s?a(t,i,n):a(n))||n);return s&&n&&lm(t,i,n),n},yL={};Vs(yL,{AG_CHARTS_LOCALE_EN_US:()=>Pw,AgCharts:()=>fo,AgChartsCommunityModule:()=>kY,AgChartsEnterpriseModule:()=>ise,AgTooltipAnchorToType:()=>VL,AgTooltipPlacementType:()=>GL,AllCartesianAxesModule:()=>vF,AllCartesianModule:()=>zF,AllCartesianSeriesModule:()=>FF,AllCommunityModule:()=>JI,AllEnterpriseModule:()=>sL,AllGaugeModule:()=>Mz,AllMapSeriesModule:()=>NB,AllPolarModule:()=>sB,AngleCategoryAxisModule:()=>Az,AngleNumberAxisModule:()=>Cz,AnimationModule:()=>Mf,AnnotationsModule:()=>Jk,AreaSeriesModule:()=>wI,BandHighlightModule:()=>eA,BarSeriesModule:()=>sb,BoxPlotSeriesModule:()=>uA,BubbleSeriesModule:()=>FI,CandlestickSeriesModule:()=>rv,CartesianChartModule:()=>oi,CategoryAxisModule:()=>X2,ChartToolbarModule:()=>ev,ChordSeriesModule:()=>lE,ConeFunnelSeriesModule:()=>TF,ContextMenuModule:()=>Pf,CrosshairModule:()=>nA,DataSourceModule:()=>iv,DonutSeriesModule:()=>K2,ErrorBarsModule:()=>oA,FinancialChartModule:()=>WF,FlashOnUpdateModule:()=>iR,FunnelSeriesModule:()=>RF,GradientLegendModule:()=>Lv,GroupedCategoryAxisModule:()=>q2,HeatmapSeriesModule:()=>SA,HistogramSeriesModule:()=>BI,LegendModule:()=>AI,LicenseManager:()=>tse,LineSeriesModule:()=>lb,LinearGaugeModule:()=>cz,LocaleModule:()=>XI,LogAxisModule:()=>Z2,MapLineBackgroundSeriesModule:()=>cB,MapLineSeriesModule:()=>fB,MapMarkerSeriesModule:()=>DB,MapShapeBackgroundSeriesModule:()=>kB,MapShapeSeriesModule:()=>TB,ModuleRegistry:()=>me,NavigatorModule:()=>HA,NightingaleSeriesModule:()=>Hz,NumberAxisModule:()=>qI,OhlcSeriesModule:()=>lv,OrdinalTimeAxisModule:()=>nC,PieSeriesModule:()=>Y2,PolarChartModule:()=>Nr,PyramidSeriesModule:()=>mE,RadarAreaSeriesModule:()=>Yz,RadarLineSeriesModule:()=>Zz,RadialBarSeriesModule:()=>tB,RadialColumnSeriesModule:()=>iB,RadialGaugeModule:()=>Sz,RadiusCategoryAxisModule:()=>Ez,RadiusNumberAxisModule:()=>Pz,RangeAreaSeriesModule:()=>pv,RangeBarSeriesModule:()=>gv,RangesModule:()=>$A,SankeySeriesModule:()=>ME,ScatterSeriesModule:()=>HI,SparklinePresetModule:()=>P2,StatusBarModule:()=>KA,SunburstSeriesModule:()=>wE,SyncModule:()=>qA,TimeAxisModule:()=>QI,TreemapSeriesModule:()=>PE,UnitTimeAxisModule:()=>Q2,VERSION:()=>ue,WaterfallSeriesModule:()=>GA,ZoomModule:()=>mp,_ModuleSupport:()=>L,_Scene:()=>hb,_Theme:()=>db,_Util:()=>ub,_Widget:()=>gf,time:()=>uG}),aa.exports=c_(yL);var xL={};Vs(xL,{AGGREGATION_INDEX_UNSET:()=>cl,AGGREGATION_INDEX_X_MAX:()=>js,AGGREGATION_INDEX_X_MIN:()=>Hs,AGGREGATION_INDEX_Y_MAX:()=>$s,AGGREGATION_INDEX_Y_MIN:()=>Ws,AGGREGATION_MAX_POINTS:()=>WL,AGGREGATION_MIN_RANGE:()=>ar,AGGREGATION_SPAN:()=>In,AGGREGATION_THRESHOLD:()=>ua,AbstractModuleInstance:()=>bi,ActionOnSet:()=>He,AdjacencyListGraph:()=>v0,AsyncAwaitQueue:()=>rg,BASE_FONT_SIZE:()=>Oo,BREAK_TRANSFORM_CHAIN:()=>Wp,BaseProperties:()=>K,Border:()=>cr,CARTESIAN_AXIS_TYPE:()=>t0,CARTESIAN_POSITION:()=>e0,CallbackCache:()=>o0,ChangeDetectableProperties:()=>Ry,ChartAxisDirection:()=>Jp,ChartUpdateType:()=>kc,CleanupRegistry:()=>pt,Color:()=>Be,DEFAULT_ANNOTATION_HANDLE_FILL:()=>md,DEFAULT_ANNOTATION_STATISTICS_COLOR:()=>bd,DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE:()=>vd,DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL:()=>Sd,DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE:()=>Md,DEFAULT_ANNOTATION_STATISTICS_FILL:()=>yd,DEFAULT_ANNOTATION_STATISTICS_STROKE:()=>xd,DEFAULT_CAPTION_ALIGNMENT:()=>lr,DEFAULT_CAPTION_LAYOUT_STYLE:()=>ma,DEFAULT_FIBONACCI_STROKES:()=>fd,DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL:()=>os,DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR:()=>As,DEFAULT_POLAR_SERIES_STROKE:()=>ig,DEFAULT_SHADOW_COLOUR:()=>fa,DEFAULT_SPARKLINE_CROSSHAIR_STROKE:()=>sg,DEFAULT_TEXTBOX_COLOR:()=>kd,DEFAULT_TEXTBOX_FILL:()=>Dd,DEFAULT_TEXTBOX_STROKE:()=>Id,DEFAULT_TEXT_ANNOTATION_COLOR:()=>ng,DEFAULT_TOOLBAR_POSITION:()=>Ad,Debug:()=>Me,DebugMetrics:()=>Jn,DeclaredSceneChangeDetection:()=>_e,DeclaredSceneObjectChangeDetection:()=>Zd,Deprecated:()=>ew,DeprecatedAndRenamedTo:()=>tw,EllipsisChar:()=>od,ErrorType:()=>TS,EventEmitter:()=>Sn,FONT_SIZE:()=>JS,FONT_SIZE_RATIO:()=>Si,IS_DARK_THEME:()=>ul,InterpolationProperties:()=>dl,LRUCache:()=>wp,LineSplitter:()=>Ya,Logger:()=>j,LonLatBBox:()=>Tc,MementoCaretaker:()=>Bm,ModuleRegistry:()=>me,ModuleType:()=>uS,ObserveChanges:()=>Wt,PALETTE_ALT_DOWN_FILL:()=>Zm,PALETTE_ALT_DOWN_STROKE:()=>Km,PALETTE_ALT_NEUTRAL_FILL:()=>Xm,PALETTE_ALT_NEUTRAL_STROKE:()=>qm,PALETTE_ALT_UP_FILL:()=>Ym,PALETTE_ALT_UP_STROKE:()=>Um,PALETTE_DOWN_FILL:()=>jm,PALETTE_DOWN_STROKE:()=>Gm,PALETTE_NEUTRAL_FILL:()=>$m,PALETTE_NEUTRAL_STROKE:()=>Wm,PALETTE_UP_FILL:()=>Hm,PALETTE_UP_STROKE:()=>Vm,POLAR_AXIS_SHAPE:()=>s0,POLAR_AXIS_TYPE:()=>i0,PREV_NEXT_KEYS:()=>Nd,Padding:()=>gr,ParallelStateMachine:()=>F0,PolarZIndexMap:()=>XS,PropertiesArray:()=>Pi,Property:()=>m,ProxyOnWrite:()=>XL,ProxyProperty:()=>Bt,ProxyPropertyOnWrite:()=>kt,SKIP_JS_BUILTINS:()=>Pm,ScaleAlignment:()=>gS,SceneArrayChangeDetection:()=>Yd,SceneChangeDetection:()=>U,SceneObjectChangeDetection:()=>br,SceneRefChangeDetection:()=>Ig,SeriesContentZIndexMap:()=>QS,SeriesZIndexMap:()=>qS,SimpleCache:()=>JL,SpanJoin:()=>tM,StateMachine:()=>he,StateMachineProperty:()=>it,TRIPLE_EQ:()=>Vc,TextMeasurer:()=>yy,TickIntervals:()=>xg,ToolbarButtonProperties:()=>Vo,TrimEdgeGuard:()=>ad,UnknownError:()=>Pp,ValidationError:()=>la,Vec2:()=>H,Vec4:()=>ke,Vertex:()=>S0,WeakCache:()=>m0,ZIndexMap:()=>n0,addEscapeEventListener:()=>hy,addFakeTransformToInstanceProperty:()=>m,addMouseCloseListener:()=>k0,addObserverToInstanceProperty:()=>Tm,addOverrideFocusVisibleEventListener:()=>C0,addTouchCloseListener:()=>A0,addTransformToInstanceProperty:()=>sr,aggregationBucketForDatum:()=>$L,aggregationDatumMatchesIndex:()=>UL,aggregationDomain:()=>si,aggregationIndexForXRatio:()=>eg,aggregationRangeFittingPoints:()=>pa,aggregationXRatioForDatumIndex:()=>Lc,aggregationXRatioForXValue:()=>kn,and:()=>Ue,angleBetween:()=>Eo,angularPadding:()=>ty,appendEllipsis:()=>mm,arcDistanceSquared:()=>iw,areScalingEqual:()=>_o,array:()=>sn,arrayLength:()=>qa,arrayOf:()=>be,arrayOfDefs:()=>Ft,arraysEqual:()=>vn,assignIfNotStrictlyEqual:()=>Fm,attachDescription:()=>Ge,attachListener:()=>ot,autoSizedLabelOptionsDefs:()=>ir,barHighlightOptionsDef:()=>io,bezier2DDistance:()=>q0,bezier2DExtrema:()=>Z0,boolean:()=>R,borderOptionsDef:()=>rl,boxCollides:()=>sy,boxContains:()=>lg,boxEmpty:()=>u0,boxesEqual:()=>cg,buildDateFormatter:()=>Sc,cachedTextMeasurer:()=>Ze,calcLineHeight:()=>Mn,calculatePlacement:()=>my,callWithContext:()=>as,callback:()=>ct,callbackDefs:()=>Qe,callbackOf:()=>vi,checkDatum:()=>U0,circularSliceArray:()=>qn,clamp:()=>ge,clampArray:()=>Ac,clipLines:()=>B0,clipSpanX:()=>Py,collapseSpanToPoint:()=>eM,collectAggregationLevels:()=>KL,color:()=>ie,colorStopsOrderValidator:()=>Dm,colorUnion:()=>ks,commonChartOptionsDefs:()=>we,commonSeriesOptionsDefs:()=>et,commonSeriesThemeableOptionsDefs:()=>Je,compactAggregationIndices:()=>hl,compareDates:()=>oy,computeExtremesAggregation:()=>rr,computeExtremesAggregationPartial:()=>tg,constant:()=>Le,contextMenuItemsArray:()=>Hp,countFractionDigits:()=>vc,countLines:()=>CS,createAggregationIndices:()=>ga,createButton:()=>Kd,createCanvasContext:()=>f0,createCheckbox:()=>oM,createDeprecationWarning:()=>ly,createElement:()=>xe,createElementId:()=>ur,createIcon:()=>lM,createId:()=>Mi,createIdsGenerator:()=>Sg,createNumberFormatter:()=>hm,createSelect:()=>aM,createSvgElement:()=>Pt,createTextArea:()=>rM,createTicks:()=>Rc,date:()=>is,dateToNumber:()=>Wi,dateTruncationForDomain:()=>vg,datesSortOrder:()=>ry,debounce:()=>Np,decodeIntervalValue:()=>j0,deepClone:()=>Re,deepFreeze:()=>on,defaultEpoch:()=>Ay,defined:()=>le,diffArrays:()=>y0,distribute:()=>oS,downloadUrl:()=>lS,dropFirstWhile:()=>sS,dropLastWhile:()=>nS,durationDay:()=>vl,durationHour:()=>bl,durationMinute:()=>fr,durationMonth:()=>vy,durationSecond:()=>Pc,durationWeek:()=>_0,durationYear:()=>zd,easeIn:()=>Lw,easeInOut:()=>ww,easeInOutQuad:()=>Ow,easeInQuad:()=>Tw,easeOut:()=>xr,easeOutQuad:()=>Nw,encodedToTimestamp:()=>mr,enterpriseRegistry:()=>Oi,entries:()=>ht,errorBarOptionsDefs:()=>pd,errorBarThemeableOptionsDefs:()=>ud,estimateTickCount:()=>wy,evaluateBezier:()=>Bo,every:()=>WS,expandLegendPosition:()=>ll,extent:()=>Ro,extractDecoratedProperties:()=>HS,extractDomain:()=>Jh,fillGradientDefaults:()=>zp,fillImageDefaults:()=>_p,fillOptionsDef:()=>se,fillPatternDefaults:()=>Bp,findMaxIndex:()=>hr,findMaxValue:()=>ny,findMinIndex:()=>Nc,findMinMax:()=>Tt,findMinValue:()=>qL,findRangeExtent:()=>da,first:()=>Gs,focusCursorAtEnd:()=>Qm,fontFamilyFull:()=>Vp,fontOptionsDef:()=>Ke,formatNumber:()=>b0,formatObjectValidator:()=>VS,formatPercent:()=>x0,formatValue:()=>ao,fromPairs:()=>$S,generateUUID:()=>Od,geoJson:()=>ml,getAngleRatioRadians:()=>h0,getAttribute:()=>fl,getDocument:()=>Qn,getElementBBox:()=>a0,getIconClassNames:()=>pl,getLastFocus:()=>gy,getMaxInnerRectSize:()=>l0,getMidpointsForIndices:()=>No,getMinOuterRectSize:()=>ZL,getPath:()=>Em,getTickTimeInterval:()=>jd,getWindow:()=>Ve,googleFont:()=>km,gradientColorStops:()=>Rp,gradientStrict:()=>Fp,greaterThan:()=>ns,groupBy:()=>Zh,guardTextEdges:()=>IS,hasNoModifiers:()=>Td,hasRequiredInPath:()=>ol,highlightOptionsDef:()=>Im,htmlElement:()=>bm,inRange:()=>fS,initRovingTabIndex:()=>uy,insertListItemsSorted:()=>fy,instanceOf:()=>BL,interpolationOptionsDefs:()=>jp,intervalCeil:()=>V0,intervalEpoch:()=>Sl,intervalExtent:()=>Iy,intervalFloor:()=>Ys,intervalHierarchy:()=>Hd,intervalMilliseconds:()=>rs,intervalNext:()=>Dy,intervalPrevious:()=>G0,intervalRange:()=>wn,intervalRangeCount:()=>mg,intervalRangeNumeric:()=>H0,intervalRangeStartIndex:()=>ky,intervalStep:()=>Fo,intervalUnit:()=>ro,inverseEaseOut:()=>hM,isArray:()=>Ce,isBetweenAngles:()=>Us,isBoolean:()=>xS,isButtonClickEvent:()=>py,isColor:()=>SS,isContinuous:()=>Bc,isDate:()=>Is,isDecoratedObject:()=>Up,isDefined:()=>St,isDenseInterval:()=>Ml,isEmptyObject:()=>id,isEnumKey:()=>AL,isEnumValue:()=>CL,isFiniteNumber:()=>$e,isFunction:()=>Co,isGradientFill:()=>Ut,isGradientFillArray:()=>Sw,isGradientOrPatternFill:()=>Mw,isHtmlElement:()=>vS,isImageFill:()=>zo,isInputPending:()=>r0,isInteger:()=>mS,isKeyOf:()=>il,isNegative:()=>bc,isNumber:()=>gt,isNumberEqual:()=>qe,isNumberObject:()=>$0,isObject:()=>fe,isObjectLike:()=>td,isObjectWithProperty:()=>US,isObjectWithStringProperty:()=>KS,isPatternFill:()=>Tn,isPlainObject:()=>st,isPointLabelDatum:()=>Q0,isProperties:()=>wc,isRegExp:()=>bS,isScaleValid:()=>Dl,isSegmentTruncated:()=>Op,isString:()=>Rt,isStringFillArray:()=>Y0,isStringObject:()=>Ty,isSymbol:()=>sd,isTextTruncated:()=>sl,isTruncated:()=>AS,isUnitTimeCategoryScaling:()=>yr,isValidDate:()=>tl,isValidNumberFormat:()=>MS,iterate:()=>or,joinFormatted:()=>Za,jsonApply:()=>wd,jsonDiff:()=>Ln,jsonPropertyCompare:()=>D0,jsonWalk:()=>ya,kebabCase:()=>wS,labelBoxOptionsDef:()=>Dn,legendPositionValidator:()=>dd,lessThan:()=>ss,lessThanOrEqual:()=>OS,levenshteinDistance:()=>LS,lineDashOptionsDef:()=>ne,lineDistanceSquared:()=>dr,lineHighlightOptionsDef:()=>Qa,lineSegmentOptions:()=>RS,lineSegmentation:()=>FS,linear:()=>cM,linearGaugeSeriesOptionsDef:()=>ha,linearGaugeSeriesThemeableOptionsDef:()=>qp,linearGaugeTargetOptionsDef:()=>Zp,linearPoints:()=>iM,listDecoratedProperties:()=>nr,lowestGranularityForInterval:()=>Wd,lowestGranularityUnitForTicks:()=>bg,lowestGranularityUnitForValue:()=>$d,makeAccessibleClickListener:()=>cw,mapValues:()=>Dc,markerOptionsDefs:()=>so,markerStyleOptionsDefs:()=>tr,measureTextSegments:()=>Ks,memo:()=>Ed,merge:()=>gd,mergeArrayDefaults:()=>Om,mergeDefaults:()=>oe,modulus:()=>yS,multiSeriesHighlightOptionsDef:()=>zt,nearestSquared:()=>Pd,nearestSquaredInContainer:()=>N0,nextPowerOf2:()=>Cc,niceTicksDomain:()=>Ly,normalisedExtentWithMetadata:()=>Ec,normalisedTimeExtentWithMetadata:()=>dg,normalizeAngle180:()=>ag,normalizeAngle360:()=>tt,normalizeAngle360FromDegrees:()=>Po,normalizeAngle360Inclusive:()=>Ld,number:()=>W,numberFormatValidator:()=>nn,numberMin:()=>Sm,numberRange:()=>NS,object:()=>Xa,objectsEqual:()=>ii,objectsEqualWith:()=>Nm,optionsDefs:()=>Ot,or:()=>Ae,padding:()=>al,paddingOptions:()=>zS,parseColor:()=>cS,parseNumberFormat:()=>Tp,partialAssign:()=>Yp,pause:()=>iy,pick:()=>Kp,placeLabels:()=>J0,positiveNumber:()=>P,positiveNumberNonZero:()=>Mc,previousPowerOf2:()=>_m,radialGaugeSeriesOptionsDef:()=>Ic,radialGaugeSeriesThemeableOptionsDef:()=>Qp,radialGaugeTargetOptionsDef:()=>Xp,range:()=>zc,rangeValidator:()=>Gp,ratio:()=>ce,readIntegratedWrappedValue:()=>Ny,required:()=>$,rescaleSpan:()=>_c,rescaleVisibleRange:()=>yg,resetIds:()=>dw,rotatePoint:()=>ey,roundTo:()=>ed,safeCall:()=>gm,seriesLabelOptionsDefs:()=>ft,setAttribute:()=>Fe,setAttributes:()=>oo,setDocument:()=>aS,setElementBBox:()=>Cd,setElementStyle:()=>Cn,setElementStyles:()=>d0,setPath:()=>Rm,setWindow:()=>rS,shadowOptionsDefs:()=>wo,shallowClone:()=>yl,shapeHighlightOptionsDef:()=>It,shapeSegmentOptions:()=>PS,shapeSegmentation:()=>ca,shapeValidator:()=>Ja,simpleMemorize:()=>ji,simpleMemorize2:()=>pr,smoothPoints:()=>nM,solveBezier:()=>Dg,sortAndUniqueDates:()=>ay,sortBasedOnArray:()=>iS,spanRange:()=>Zs,splitBezier2D:()=>Ud,stepPoints:()=>sM,stopPageScrolling:()=>L0,strictObjectKeys:()=>To,strictUnion:()=>Mm,string:()=>N,stringLength:()=>vm,stringifyValue:()=>rd,strokeOptionsDef:()=>J,textOrSegments:()=>Hi,themeOperator:()=>hd,throttle:()=>pm,tickFormat:()=>Cy,tickStep:()=>Fc,toArray:()=>Yh,toDegrees:()=>c0,toFontString:()=>fm,toIterable:()=>jS,toPlainText:()=>Pe,toRadians:()=>mt,toTextString:()=>Dt,toolbarButtonOptionsDefs:()=>er,tooltipOptionsDefs:()=>Ye,transformIntegratedCategoryValue:()=>Mg,truncateLine:()=>xl,typeUnion:()=>nl,undocumented:()=>ee,unguardTextEdges:()=>kS,union:()=>Z,unionSymbol:()=>ld,unique:()=>Ap,validate:()=>Ei,without:()=>Q,wrapLines:()=>Fd,wrapText:()=>xa,wrapTextOrSegments:()=>Rd,wrapTextSegments:()=>by});var Me={};Vs(Me,{Time:()=>y_,check:()=>qh,create:()=>f_,inDevelopmentMode:()=>m_});function Yh(e){return e===void 0?[]:Array.isArray(e)?e:[e]}function Ap(e){return Array.from(new Set(e))}function Zh(e,t){return e.reduce((i,s)=>{const n=t(s);return i[n]??(i[n]=[]),i[n].push(s),i},{})}function vn(e,t){if(e==null||t==null||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(Array.isArray(e[i])&&Array.isArray(t[i])){if(!vn(e[i],t[i]))return!1}else if(e[i]!==t[i])return!1;return!0}function qn(e,t,i=0){if(e.length===0)return[];const s=[];for(let n=0;n<t;n++)s.push(e.at((n+i)%e.length));return s}function iS(e,t){const i=new Map;for(const[s,n]of t.entries())i.set(n,s);return e.sort((s,n)=>{const o=i.get(s)??1/0,a=i.get(n)??1/0;return o-a})}function sS(e,t){let i=0;for(;i<e.length&&t(e[i]);)i+=1;const s=i;s!==0&&e.splice(0,s)}function nS(e,t){let i=e.length-1;for(;i>=0&&t(e[i]);)i-=1;const s=e.length-1-i;s!==0&&e.splice(e.length-s,s)}function oS(e,t,i){const s=[e],n=Math.round((t-e)/(i-1));if(n>0)for(let o=e+n;o<t&&!(s.push(o)>=i-1);o+=n);return s.push(t),s}var Ka={};typeof globalThis.window<"u"&&(Ka.window=globalThis.window),typeof document<"u"?Ka.document=document:typeof globalThis.global<"u"&&(Ka.document=globalThis.document);function Qn(e){return e?Ka.document?.[e]:Ka.document}function Ve(e){return e?Ka.window?.[e]:Ka.window}function aS(e){Ka.document=e}function rS(e){Ka.window=e}function xe(e,t,i){const s=Qn().createElement(e);if(typeof t=="object"&&(i=t,t=void 0),t)for(const n of t.split(" "))s.classList.add(n);return i&&Object.assign(s.style,i),s}function Pt(e){return Qn().createElementNS("http://www.w3.org/2000/svg",e)}function lS(e,t){const i=Qn("body"),s=xe("a",{display:"none"});s.href=e,s.download=t,i.appendChild(s),s.click(),setTimeout(()=>s.remove())}function ot(e,t,i,s){return e.addEventListener(t,i,s),()=>e.removeEventListener(t,i,s)}var Cp;function cS(e){if(Cp==null){const i=Ve("Option");Cp=new i().style}Cp.color=e;const t=Cp.color||null;return Cp.color="",t}var j={};Vs(j,{error:()=>vL,errorOnce:()=>d_,log:()=>cm,logGroup:()=>ML,reset:()=>u_,table:()=>h_,warn:()=>bL,warnOnce:()=>Xh});var hS=new Set;function cm(...e){console.log(...e)}function bL(e,...t){console.warn(`AG Charts - ${e}`,...t)}function vL(e,...t){typeof e=="object"?console.error("AG Charts error",e,...t):console.error(`AG Charts - ${e}`,...t)}function h_(...e){console.table(...e)}function SL(e,t,i){let s;e instanceof Error?s=e.message:typeof e=="string"?s=e:typeof e=="object"?s=JSON.stringify(e):s=String(e);const n=`${t}: ${s}`;hS.has(n)||(i(e),hS.add(n))}function Xh(e,...t){SL(e,"Logger.warn",i=>bL(i,...t))}function d_(e,...t){SL(e,"Logger.error",i=>vL(i,...t))}function u_(){hS.clear()}function ML(e,t){console.groupCollapsed(e);try{return t()}finally{console.groupEnd()}}var p_=2e3,DL=Date.now();function g_(){const e=Date.now()-DL;if(e>p_){const t=(Math.floor(e/100)/10).toFixed(1);cm(`**** ${t}s since last log message ****`)}DL=Date.now()}function f_(...e){return Object.assign((...i)=>{qh(...e)&&(typeof i[0]=="function"&&(i=Yh(i[0]())),g_(),cm(...i))},{check:()=>qh(...e),group:(i,s)=>qh(...e)?ML(i,s):s()})}function qh(...e){return e.length===0&&e.push(!0),Yh(Ve("agChartsDebug")).some(i=>e.includes(i))}function m_(e){if(qh("dev"))return e()}function y_(e,t={}){const{logResult:i=!0,logStack:s=!1,logArgs:n=!1,logData:o}=t;return function(a,r,l){const c=l.value;l.value=function(...h){const d=performance.now(),u=c.apply(this,h),f={duration:performance.now()-d};return i&&(f.result=u),n&&(f.args=h),s&&(f.stack=new Error("Stack trace for timing debug").stack),o&&(f.logData=o(this)),cm(e,f),u}}}var Jn={};Vs(Jn,{flush:()=>b_,record:()=>x_});var dS=new Map;function x_(e,t){qh("scene:stats:verbose")&&dS.set(e,t)}function b_(){const e=Object.fromEntries(dS);return dS.clear(),e}var Oi={},me={};Vs(me,{RegistryMode:()=>IL,getAxisModule:()=>k_,getChartModule:()=>A_,getPresetModule:()=>C_,getSeriesModule:()=>L_,hasModule:()=>M_,isEnterprise:()=>T_,isIntegrated:()=>N_,isModuleType:()=>Qh,isUmd:()=>O_,listModules:()=>D_,listModulesByType:()=>I_,register:()=>pS,registerModules:()=>v_,reset:()=>S_,setRegistryMode:()=>w_});var uS=(e=>(e.Chart="chart",e.Axis="axis",e.Series="series",e.Plugin="plugin",e.AxisPlugin="axis:plugin",e.SeriesPlugin="series:plugin",e.Preset="preset",e))(uS||{}),IL=(e=>(e.Enterprise="enterprise",e.Integrated="integrated",e.UMD="umd",e))(IL||{}),Lp=new Set,ra=new Map;function kL(e){if(ra.set(e.name,e),e.dependencies)for(const t of e.dependencies)pS(t)}function pS(e){const t=ra.get(e.name);if(!t){kL(e);return}if(t.version===e.version){!t.enterprise&&e.enterprise&&kL(e);return}throw new Error([`AG Charts - Module '${e.name}' already registered with different version:`,`${t.version} vs ${e.version}`,"","Check your package.json for conflicting dependencies - depending on your package manager","one of these commands may help:","- npm ls ag-charts-community","- yarn why ag-charts-community"].join(`
`))}function v_(e){for(const t of e.flat())pS(t)}function S_(){Lp.clear(),ra.clear()}function M_(e){return ra.has(e)}function*D_(){for(const e of ra.values())yield e}function*I_(e){for(const t of ra.values())Qh(e,t)&&(yield t)}function k_(e){const t=ra.get(e);if(Qh("axis",t))return t}function A_(e){const t=ra.get(e);if(Qh("chart",t))return t;throw new Error("AG Charts - Unknown chart type; Check options are correctly structured and series types are specified")}function C_(e){const t=ra.get(e);if(Qh("preset",t))return t}function L_(e){const t=ra.get(e);if(Qh("series",t))return t}function w_(e){Lp.add(e)}function T_(){return Lp.has("enterprise")}function N_(){return Lp.has("integrated")}function O_(){return Lp.has("umd")}function Qh(e,t){return t?.type===e}var pt=class{constructor(){this.callbacks=new Set}flush(){for(const e of this.callbacks)e();this.callbacks.clear()}merge(e){for(const t of e.callbacks)this.callbacks.add(t)}register(...e){for(const t of e)t&&this.callbacks.add(t)}},bi=class{constructor(){this.cleanup=new pt}destroy(){this.cleanup.flush()}};function Jh(e){return e.domain}var gS=(e=>(e[e.Leading=0]="Leading",e[e.Trailing=1]="Trailing",e[e.Interpolate=2]="Interpolate",e))(gS||{}),Sn=class{constructor(){this.events=new Map}on(e,t){return this.events.has(e)||this.events.set(e,new Set),this.events.get(e)?.add(t),()=>this.off(e,t)}off(e,t){const i=this.events.get(e);i&&(i.delete(t),i.size===0&&this.events.delete(e))}emit(e,t){const i=this.events.get(e);if(i)for(const s of i)s(t)}clear(e){e?this.events.delete(e):this.events.clear()}},wp=class{constructor(e){if(this.maxCacheSize=e,this.store=new Map,e<=0)throw new Error("LRUCache size must be greater than 0")}get(e){if(!this.store.has(e))return;const t=this.store.get(e);return this.store.delete(e),this.store.set(e,t),t}has(e){return this.store.has(e)}set(e,t){return this.store.set(e,t),this.store.size>this.maxCacheSize&&this.store.delete(this.store.keys().next().value),t}clear(){this.store.clear()}};function ge(e,t,i){return Math.min(i,Math.max(e,t))}function fS(e,t,i=1e-10){return e>=t[0]-i&&e<=t[1]+i}function qe(e,t,i=1e-10){return e===t||Math.abs(e-t)<i}function bc(e){return Math.sign(e)===-1||Object.is(e,-0)}function mS(e){return e%1===0}function ed(e,t=2){const i=10**t;return Math.round(e*i)/i}function yS(e,t){return Math.floor(e%t+(e<0?Math.abs(t):0))}function vc(e){if(Math.floor(e)===e)return 0;let t=String(e),i=0;if(e<1e-6||e>=1e21){let n;[t,n]=t.split("e"),n!=null&&(i=Number(n))}const s=t.split(".")[1]?.length??0;return Math.max(s-i,0)}function St(e){return e!=null}function Ce(e){return Array.isArray(e)}function xS(e){return typeof e=="boolean"}function Is(e){return e instanceof Date}function tl(e){return Is(e)&&!Number.isNaN(Number(e))}function bS(e){return e instanceof RegExp}function Co(e){return typeof e=="function"}function fe(e){return typeof e=="object"&&e!==null&&!Ce(e)}function td(e){return Ce(e)||st(e)}function st(e){return typeof e=="object"&&e!==null&&e.constructor?.name==="Object"}function id(e){if(typeof e!="object"||e===null)return!1;for(const t in e)return!1;return!0}function Rt(e){return typeof e=="string"}function gt(e){return typeof e=="number"}function $e(e){return Number.isFinite(e)}function vS(e){return typeof globalThis.window<"u"&&e instanceof HTMLElement}function AL(e,t){return Rt(t)&&Object.keys(e).includes(t)}function CL(e,t){return Object.values(e).includes(t)}function sd(e){return typeof e=="symbol"}function SS(e){return Rt(e)&&(e==="none"||cS(e)!=null)}function il(e,t){return e in t}var LL=/^(?:(.)?([<>=^]))?([+\-( ])?([$€£¥₣₹#])?(0)?(\d+)?(,)?(?:\.(\d+))?(~)?([%a-z])?$/i,wL=/^((?:[^#]|#[^{])*)#{([^}]+)}(.*)$/;function MS(e){if(!Rt(e))return!1;const t=wL.exec(e);return LL.test(t?t[2]:e)}function Tp(e){let t,i;const s=wL.exec(e);s&&([,t,e,i]=s);const n=LL.exec(e);if(!n){j.warnOnce(`The number formatter is invalid: ${e}`);return}const[,o,a,r,l,c,h,d,u,p,f]=n;return{fill:o,align:a,sign:r,symbol:l,zero:c,width:Number.parseInt(h),comma:d,precision:Number.parseInt(u),trim:!!p,type:f,prefix:t,suffix:i}}function hm(e){const t=typeof e=="string"?Tp(e):e;if(t==null)return;const{fill:i,align:s,sign:n="-",symbol:o,zero:a,width:r,comma:l,type:c,prefix:h="",suffix:d="",precision:u}=t;let{trim:p}=t;const f=u==null||Number.isNaN(u);let y;if(!c)y=eo.g,p=!0;else if(c in eo&&c in nd)y=f?nd[c]:eo[c];else if(c in eo)y=eo[c];else if(c in nd)y=nd[c];else throw new Error(`The number formatter type is invalid: ${c}`);const b=c?6:12;let x;f||(x=u);let v=s,S=i;return a&&(S??(S="0"),v??(v="=")),(M,D)=>{let k;x!=null?k=x:c==="f"||c==="%"?k=D??b:c?k=b:k=D??b;let I=y(M,k);p&&(I=R_(I)),l&&(I=F_(I,l));const A=V_(o,c),C=A?.length??0;A&&(I=`${A}${I}`),c==="s"&&(I=`${I}${z_(M)}`),(c==="%"||c==="p")&&(I=`${I}%`);const{value:w,prefixLength:T}=B_(M,I,n),O=T+C;let E=w;return r!=null&&!Number.isNaN(r)&&(E=__(E,r,S??" ",v,O)),E=`${h}${E}${d}`,E}}var nd={b:e=>dm(e).toString(2),c:e=>String.fromCodePoint(e),d:e=>Math.round(Math.abs(e)).toFixed(0),o:e=>dm(e).toString(8),x:e=>dm(e).toString(16),X:e=>nd.x(e).toUpperCase(),n:e=>nd.d(e),"%":e=>`${dm(e*100).toFixed(0)}`},eo={e:(e,t)=>Math.abs(e).toExponential(t),E:(e,t)=>eo.e(e,t).toUpperCase(),f:(e,t)=>Math.abs(e).toFixed(t),F:(e,t)=>eo.f(e,t).toUpperCase(),g:(e,t)=>{if(e===0)return"0";const i=Math.abs(e),s=Math.floor(Math.log10(i));return s>=-4&&s<t?i.toFixed(t-1-s):i.toExponential(t-1)},G:(e,t)=>eo.g(e,t).toUpperCase(),n:(e,t)=>eo.g(e,t),p:(e,t)=>eo.r(e*100,t),r:(e,t)=>{if(e===0)return"0";const i=Math.abs(e),n=Math.floor(Math.log10(i))-(t-1);if(n<=0)return i.toFixed(-n);const o=10**n;return(Math.round(i/o)*o).toFixed()},s:(e,t)=>{const i=OL(e);return eo.r(e/10**i,t)},"%":(e,t)=>eo.f(e*100,t)},TL=-24,NL=24,E_={[TL]:"y",[-21]:"z",[-18]:"a",[-15]:"f",[-12]:"p",[-9]:"n",[-6]:"\xB5",[-3]:"m",0:"",3:"k",6:"M",9:"G",12:"T",15:"P",18:"E",21:"Z",[NL]:"Y"},P_="\u2212";function dm(e){return Math.floor(Math.abs(e))}function R_(e){if(!e.endsWith("0")||!e.includes("."))return e;let t=e.length-1;for(;t>0;)if(e[t]=="0")t-=1;else if(e[t]=="."){t-=1;break}else break;return e.substring(0,t+1)}function F_(e,t){let i=e.indexOf(".");i<0&&(i=e.length);const s=e.substring(0,i).split(""),n=e.substring(i);for(let o=s.length-3;o>0;o-=3)s.splice(o,0,t);return`${s.join("")}${n}`}function z_(e){return E_[OL(e)]}function OL(e){return ge(TL,e?Math.floor(Math.log10(Math.abs(e))/3)*3:0,NL)}function B_(e,t,i=""){if(i==="(")return e>=0?{value:t,prefixLength:0}:{value:`(${t})`,prefixLength:1};let s="";return e<0?s=P_:i==="+"?s="+":i===" "&&(s=" "),{value:`${s}${t}`,prefixLength:s.length}}function __(e,t,i=" ",s=">",n=0){const o=t-e.length;if(o<=0)return e;const a=i.repeat(o);if(s==="="){const r=Math.min(Math.max(n,0),e.length),l=e.slice(0,r),c=e.slice(r);return`${l}${a}${c}`}if(s===">"||!s)return a+e;if(s==="<")return`${e}${a}`;if(s==="^"){const r=Math.ceil(o/2),l=Math.floor(o/2);return`${i.repeat(r)}${e}${i.repeat(l)}`}return a+e}function V_(e,t){if(e==="#")switch(t){case"b":return"0b";case"o":return"0o";case"x":return"0x";case"X":return"0X";default:return""}return e??""}var um={periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]};function DS(e,t=new Date(e.getFullYear(),0,1)){const i=e.getTimezoneOffset()-t.getTimezoneOffset(),s=e.getTime()-t.getTime()+i*6e4,n=36e5*24;return Math.floor(s/n)}function EL(e,t){const s=new Date(e.getFullYear(),0,1).getDay(),n=(t-s+7)%7,o=new Date(e.getFullYear(),0,n+1);return o<=e?Math.floor(DS(e,o)/7)+1:0}var G_=0,PL=1,RL=4;function FL(e,t=e.getFullYear()){const s=new Date(t,0,1).getDay(),n=(RL-s+7)%7,o=new Date(t,0,n-(RL-PL)+1);return o<=e?Math.floor(DS(e,o)/7)+1:FL(e,t-1)}function H_(e){const t=e.getTimezoneOffset(),i=Math.abs(t);return`${t>0?"-":"+"}${ts(Math.floor(i/60),2,"0")}${ts(Math.floor(i%60),2,"0")}`}var j_={a:e=>um.shortDays[e.getDay()],A:e=>um.days[e.getDay()],b:e=>um.shortMonths[e.getMonth()],B:e=>um.months[e.getMonth()],c:"%x, %X",d:(e,t)=>ts(e.getDate(),2,t??"0"),e:"%_d",f:(e,t)=>ts(e.getMilliseconds()*1e3,6,t??"0"),H:(e,t)=>ts(e.getHours(),2,t??"0"),I:(e,t)=>{const i=e.getHours()%12;return i===0?"12":ts(i,2,t??"0")},j:(e,t)=>ts(DS(e)+1,3,t??"0"),m:(e,t)=>ts(e.getMonth()+1,2,t??"0"),M:(e,t)=>ts(e.getMinutes(),2,t??"0"),L:(e,t)=>ts(e.getMilliseconds(),3,t??"0"),p:e=>e.getHours()<12?"AM":"PM",Q:e=>String(e.getTime()),s:e=>String(Math.floor(e.getTime()/1e3)),S:(e,t)=>ts(e.getSeconds(),2,t??"0"),u:e=>{let t=e.getDay();return t<1&&(t+=7),String(t%7)},U:(e,t)=>ts(EL(e,G_),2,t??"0"),V:(e,t)=>ts(FL(e),2,t??"0"),w:(e,t)=>ts(e.getDay(),2,t??"0"),W:(e,t)=>ts(EL(e,PL),2,t??"0"),x:"%-m/%-d/%Y",X:"%-I:%M:%S %p",y:(e,t)=>ts(e.getFullYear()%100,2,t??"0"),Y:(e,t)=>ts(e.getFullYear(),4,t??"0"),Z:e=>H_(e),"%":()=>"%"},W_={_:" ",0:"0","-":""};function ts(e,t,i){const s=String(Math.floor(e));return s.length>=t?s:`${i.repeat(t-s.length)}${s}`}function Sc(e){const t=[];for(;e.length>0;){let i=e.indexOf("%");if(i!==0){const r=i>0?e.substring(0,i):e;t.push(r)}if(i<0)break;const s=e[i+1],n=W_[s];n!=null&&i++;const o=e[i+1],a=j_[o];if(typeof a=="function")t.push([a,n]);else if(typeof a=="string"){const r=Sc(a);t.push([r,n])}else t.push(`${n??""}${o}`);e=e.substring(i+2)}return i=>{const s=typeof i=="number"?new Date(i):i;return t.map(n=>typeof n=="string"?n:n[0](s,n[1])).join("")}}function Np(e,t=0,i){const{leading:s=!1,trailing:n=!0,maxWait:o=1/0}=i??{};let a,r;if(o<t)throw new Error("Value of maxWait cannot be lower than waitMs.");function l(...c){if(s&&!r){r=Date.now(),a=setTimeout(()=>r=null,t),e(...c);return}let h=t;if(o!==1/0&&r){const d=Date.now()-r;t>o-d&&(h=o-d)}clearTimeout(a),r??(r=Date.now()),a=setTimeout(()=>{r=null,n&&e(...c)},h)}return Object.assign(l,{cancel(){clearTimeout(a),r=null}})}function pm(e,t,i){const{leading:s=!0,trailing:n=!0}=i??{};let o,a,r=!1;function l(){n&&a?(o=setTimeout(l,t),e(...a)):r=!1,a=null}function c(...h){r?a=h:(r=!0,o=setTimeout(l,t),s?e(...h):a=h)}return Object.assign(c,{cancel(){clearTimeout(o),r=!1,a=null}})}function gm(e,t,i=""){try{return e(...t)}catch(s){const n=i?` \`${i}\``:"";Xh(`Uncaught exception in user callback${n}`,s)}}var od="\u2026",Ya=/\r?\n/g,ad="\u200B";function fm({fontSize:e,fontStyle:t,fontWeight:i,fontFamily:s}){let n="";return t&&t!=="normal"&&(n+=`${t} `),i&&i!=="normal"&&i!==400&&(n+=`${i} `),n+=`${e}px`,n+=` ${s}`,n}function Mn(e,t=1.15){return Math.round(e*t)}function Dt(e){return String(e??"")}var $_=/[\s.,;:-]{1,5}$/;function mm(e){return e.replace($_,"")+od}function IS(e){return ad+e+ad}function kS(e){return e.replaceAll(ad,"")}function AS(e){return Ce(e)?Op(e.at(-1)):sl(Dt(e))}function sl(e){return e.endsWith(od)}function Op(e){return Dt(e?.text).endsWith(od)}function Za(e,t="and",i=String,s=1/0){if(e.length===0)return"";if(e.length===1)return i(e[0]);e=e.map(i);const n=e.pop();if(e.length>=s){const o=e.length-(s-1);return`${e.slice(0,s-1).join(", ")}, and ${o} more ${t} ${n}`}return`${e.join(", ")} ${t} ${n}`}function rd(e,t=1/0){if(typeof e=="number"){if(Number.isNaN(e))return"NaN";if(e===1/0)return"Infinity";if(e===-1/0)return"-Infinity"}const i=JSON.stringify(e)??typeof e;return i.length>t?`${i.slice(0,t)}... (+${i.length-t} characters)`:i}function CS(e){let t=1;for(let i=0;i<e.length;i++)e.codePointAt(i)===10&&t++;return t}function LS(e,t){if(e===t)return 0;const[i,s]=e.length<t.length?[e,t]:[t,e],n=i.length,o=s.length;let a=new Array(n+1).fill(0).map((l,c)=>c),r=new Array(n+1);for(let l=1;l<=o;l++){r[0]=l;for(let c=1;c<=n;c++){const h=s[l-1]===i[c-1]?0:1;r[c]=Math.min(a[c]+1,r[c-1]+1,a[c-1]+h)}[a,r]=[r,a]}return a[n]}function wS(e){return e.replaceAll(U_,(t,i)=>(i>0?"-":"")+t.toLowerCase())}var U_=/[A-Z]+(?![a-z])|[A-Z]/g;function Pe(e,t=""){return e==null?t:Ce(e)?e.map(i=>Dt(i.text)).join(""):Rt(e)?e:String(e)}var to=Symbol("description"),zL=Symbol("required"),ym=Symbol("marked"),xm=Symbol("undocumented"),ld=Symbol("union"),K_=[["placement","position"],["padding","spacing","gap"],["color","fill","stroke"],["whisker","wick"],["nodeClick","seriesNodeClick"],["nodeDoubleClick","seriesNodeDoubleClick"],["src","url"]].reduce((e,t)=>{for(const i of t)e.set(i.toLowerCase(),new Set(t.filter(s=>s!==i)));return e},new Map),TS=(e=>(e.Invalid="invalid",e.Required="required",e.Unknown="unknown",e))(TS||{});function Ep(e,t){return $e(t)?`${e}[${t}]`:e?`${e}.${t}`:t}var la=class{constructor(e,t,i,s,n){this.type=e,this.description=t,this.value=i,this.path=s,this.key=n}setUnionType(e,t){if(this.path.startsWith(t)){const i=this.path.slice(t.length);this.altPath=`${t}[type=${e}]${i}`}}getPrefix(){const{altPath:e=this.path,key:t}=this;return!e&&!t?"Value":`Option \`${t?Ep(e,t):e}\``}toString(){const{description:e="unknown",type:t,value:i}=this;return t==="required"&&i==null?`${this.getPrefix()} is required and has not been provided; expecting ${e}, ignoring.`:`${this.getPrefix()} cannot be set to \`${rd(i,50)}\`; expecting ${e}, ignoring.`}},Pp=class extends la{constructor(e,t,i,s){super("unknown",void 0,t,i,s),this.suggestions=e,this.key=s}getPrefix(){return`Unknown option \`${Ep(this.altPath??this.path,this.key)}\``}getPostfix(){const e=Za(Y_(this.key,this.suggestions),"or",t=>`\`${t}\``);return e?`; Did you mean ${e}? Ignoring.`:", ignoring."}toString(){return`${this.getPrefix()}${this.getPostfix()}`}};function Ei(e,t,i=""){if(!fe(e))return{cleared:null,invalid:[new la("required","an object",e,i)]};const s={},n=[],o=new Set(Object.keys(e)),a=[];if(ld in t){const r=Object.keys(t),l=t[ld];if(e.type!=null&&r.includes(e.type)||e.type==null&&l!=null){const{type:c=l,...h}=e,d=Ei(h,t[c],i);Object.assign(s,{type:c},d.cleared);for(const u of d.invalid)u.setUnionType(c,i);n.push(...d.invalid)}else{const c=Za(r,"or",h=>`'${h}'`);n.push(new la("required",`a keyword such as ${c}`,e.type,i,"type"))}return{cleared:s,invalid:n}}for(const r of Object.keys(t)){const l=t[r],c=l[zL],h=e[r];if(o.delete(r),h===void 0&&(l[xm]||a.push(r),!c))continue;const d=Ep(i,r);if(Co(l)){const p=l(h,{options:e,path:d});if(typeof p=="object"){if(n.push(...p.invalid),p.valid){s[r]=p.cleared;continue}else if(ol(p.invalid,d))continue}else if(p){s[r]=h;continue}n.push(new la(c?"required":"invalid",l[to],h,i,r))}else{const u=Ei(h,l,d);u.cleared!=null&&(s[r]=u.cleared),n.push(...u.invalid)}}for(const r of o){const l=e[r];l!==void 0&&n.push(new Pp(a,l,i,r))}return{cleared:s,invalid:n}}function Y_(e,t,i=2){const s=e.toLowerCase(),n=K_.get(s);return t.filter(o=>{const a=o.toLowerCase();return n?.has(o)===!0||a.includes(s)||LS(s,a)<=i})}function Ge(e,t){if(Co(e)){let s=function(n,o){return e(n,o)};var i=s;return s[to]=t,s}else return{...e,[to]:t}}function $(e){return Object.assign(Co(e)?(t,i)=>e(t,i):Ot(e),{[zL]:!0,[to]:e[to]})}function ee(e){return Object.assign(Co(e)?(t,i)=>e(t,i):Ot(e),{[xm]:!0,[to]:e[to]})}var Ot=(e,t="an object",i=!1)=>Ge((s,n)=>{const o=Ei(s,e,n.path),a=!ol(o.invalid,n.path);return{valid:a,cleared:a||!i?o.cleared:null,invalid:o.invalid}},t),nl=(e,t,i)=>({...e,[to]:t,[ld]:i}),Ue=(...e)=>Ge((t,i)=>{const s=[];for(const n of e){const o=n(t,i);if(typeof o=="object"){if(s.push(...o.invalid),!o.valid)return{valid:!1,cleared:t,invalid:s};t=o.cleared}else if(!o)return!1}return{valid:!0,cleared:t,invalid:s}},Za(e.filter(t=>!t[xm]).map(t=>t[to]).filter(St),"and")),Ae=(...e)=>Ge((t,i)=>{for(const s of e){const n=s(t,i);if(typeof n=="object"?n.valid:n)return n}return!1},Za(e.filter(t=>!t[xm]).map(t=>t[to]).filter(St),"or")),cd=e=>$e(e)||tl(e),Z_=e=>Is(e)||($e(e)||Rt(e))&&tl(new Date(e)),sn=Ge(Ce,"an array"),R=Ge(xS,"a boolean"),ct=Ge(Co,"a function"),ie=Ge(SS,"a color string"),is=Ge(Z_,"a date"),le=Ge(St,"a defined value"),W=Ge($e,"a number"),Xa=Ge(fe,"an object"),N=Ge(Rt,"a string"),bm=Ge(e=>typeof HTMLElement>"u"||e instanceof HTMLElement,"an html element"),qa=(e,t=1/0)=>{let i;return t===1/0?i=`an array of at least ${e} items`:e===t?i=`an array of exactly ${e} items`:e===0?i=`an array of no more than ${t} items`:i=`an array of at least ${e} and no more than ${t} items`,Ge(s=>Ce(s)&&s.length>=e&&s.length<=t,i)},vm=(e,t=1/0)=>{let i;return t===1/0?i=`a string of at least ${e} characters`:e===t?i=`an string of exactly ${e} characters`:e===0?i=`an string of no more than ${t} characters`:i=`an string of at least ${e} and no more than ${t} characters`,Ge(s=>Rt(s)&&s.length>=e&&s.length<=t,i)},Sm=(e,t=!0)=>Ge(i=>$e(i)&&(i>e||t&&i===e),`a number greater than ${t?"or equal to ":""}${e}`),NS=(e,t)=>Ge(i=>$e(i)&&i>=e&&i<=t,`a number between ${e} and ${t} inclusive`),P=Sm(0),Mc=Sm(0,!1),ce=NS(0,1),ss=e=>Ge((t,{options:i})=>!cd(t)||!cd(i[e])||t<i[e],`the value to be less than \`${e}\``),OS=e=>Ge((t,{options:i})=>!cd(t)||!cd(i[e])||t<=i[e],`the value to be less than or equal to \`${e}\``),ns=e=>Ge((t,{options:i})=>!cd(t)||!cd(i[e])||t>i[e],`the value to be greater than \`${e}\``);function Z(...e){fe(e[0])&&(e=Object.values(e[0]));const t=Za(e,"or",i=>`'${i}'`);return Ge(i=>e.includes(i),`a keyword such as ${t}`)}function Mm(){return Z}var Le=e=>Ge(t=>e===t,`the value ${JSON.stringify(e)}`),BL=(e,t)=>Ge(i=>i instanceof e,t??`an instance of ${e.name}`),be=(e,t,i=!0)=>Ge((s,n)=>{if(!Ce(s))return!1;let o=i;const a=[],r=[],l=c=>{o=i?o&&c:o||c};if(s.length===0)return{valid:!0,cleared:a,invalid:r};for(let c=0;c<s.length;c++){const h=s[c],d=e(h,{options:h,path:`${n.path}[${c}]`});typeof d=="object"?(l(d.valid),r.push(...d.invalid),d.cleared!=null&&a.push(d.cleared)):(l(d),d&&a.push(h))}return{valid:o,cleared:o||!i?a:null,invalid:r}},t??`${e[to]} array`),Ft=(e,t="an object array")=>Ge((i,s)=>{if(!Ce(i))return!1;const n=[],o=[];for(let a=0;a<i.length;a++){const r=`${s.path}[${a}]`,l=Ei(i[a],e,r);ol(l.invalid,r)||n.push(l.cleared),o.push(...l.invalid)}return{valid:!0,cleared:n,invalid:o}},t),vi=(e,t)=>Ge((i,s)=>{if(!Co(i))return!1;if(ym in i)return!0;const n=t??e[to];return{valid:!0,cleared:Object.assign((...a)=>{const r=gm(i,a);if(r==null)return;const l=e(r,{options:r,path:""});if(typeof l=="object"){if(_L(l,s,n,r),l.valid)return l.cleared}else{if(l)return r;Xh(`Callback \`${s.path}\` returned an invalid value \`${rd(r,50)}\`; expecting ${n}, ignoring.`)}},{[ym]:!0}),invalid:[]}},"a function"),Qe=(e,t="an object")=>Ge((i,s)=>{if(!Co(i))return!1;if(ym in i)return!0;const n=t;return{valid:!0,cleared:Object.assign((...a)=>{const r=gm(i,a,s.path);if(r==null)return;const l=Ei(r,e);return _L(l,s,n,r),l.cleared},{[ym]:!0}),invalid:[]}},"a function");function ol(e,t){return e.some(i=>i.type==="required"&&i.path===t)}function _L(e,t,i,s){if(e.invalid.length!==0){if(Ce(s)){const n=i??e.invalid[0]?.description??"a valid value";return Xh(`Callback \`${t.path}\` returned an invalid value \`${rd(s,50)}\`; expecting ${n}, ignoring.`)}for(const n of e.invalid){if(n instanceof Pp)return Xh(`Callback \`${t.path}\` returned an unknown property \`${Ep(n.path,n.key)}\`${n.getPostfix()}`);const o=rd(n.value,50);Xh(n.key?`Callback \`${t.path}\` returned an invalid property \`${Ep(n.path,n.key)}\`: \`${o}\`; expecting ${n.description}, ignoring.`:`Callback \`${t.path}\` returned an invalid value \`${o}\`; expecting ${i??n.description}, ignoring.`)}}}var hd=e=>{if(!fe(e))return!1;const t=Object.keys(e);return t.length===1&&t[0].startsWith("$")},X_=Ot({color:ie,stop:ce},""),Dm=Ge(e=>{let t=-1/0;for(const i of e)if(i?.stop!=null){if(i.stop<t)return!1;t=i.stop}return!0},"color stops to be defined in ascending order"),Rp=Ue(qa(2),be(X_),Dm),ES=Z("axis","item","series"),Fp=Ot({type:$(Le("gradient")),colorStops:$(Rp),rotation:W,gradient:ee(Z("linear","radial","conic")),bounds:ee(ES),reverse:ee(R),colorSpace:ee(Z("rgb","oklch"))},"a gradient object with color stops"),J={stroke:ie,strokeWidth:P,strokeOpacity:ce},zp=Ot({type:$(Le("gradient")),gradient:$(Z("linear","radial","conic")),bounds:$(ES),colorStops:$(Ae(Rp,Ue(qa(2),be(ie)))),rotation:$(W),reverse:$(R),colorSpace:$(Z("rgb","oklch"))}),Bp=Ot({type:$(Le("pattern")),pattern:$(Z("vertical-lines","horizontal-lines","forward-slanted-lines","backward-slanted-lines","circles","squares","triangles","diamonds","stars","hearts","crosses")),path:vm(2),width:$(P),height:$(P),fill:$(ie),fillOpacity:$(ce),backgroundFill:$(ie),backgroundFillOpacity:$(ce),padding:$(P),rotation:$(W),scale:$(P),stroke:$(ie),strokeWidth:$(P),strokeOpacity:$(ce)}),_p=Ot({type:$(Le("image")),url:N,width:P,height:P,rotation:$(W),backgroundFill:$(ie),backgroundFillOpacity:ce,fit:$(Z("stretch","contain","cover")),repeat:$(Z("repeat","repeat-x","repeat-y","no-repeat"))}),q_=nl({gradient:{colorStops:Rp,rotation:W,gradient:ee(Z("linear","radial","conic")),bounds:ee(ES),reverse:ee(R),colorSpace:ee(Z("rgb","oklch"))},pattern:{pattern:Z("vertical-lines","horizontal-lines","forward-slanted-lines","backward-slanted-lines","circles","squares","triangles","diamonds","stars","hearts","crosses"),path:vm(2),width:P,height:P,rotation:W,scale:P,fill:ie,fillOpacity:ce,backgroundFill:ie,backgroundFillOpacity:ce,...J,padding:ee(P)},image:{url:$(N),backgroundFill:ie,backgroundFillOpacity:ce,width:P,height:P,fit:Z("stretch","contain","cover","none"),repeat:Z("repeat","repeat-x","repeat-y","no-repeat"),rotation:W}},"a color object"),ks=Ae(ie,Ot(q_,"a color object")),se={fill:ks,fillOpacity:ce};se.fillGradientDefaults=ee(zp),se.fillPatternDefaults=ee(Bp),se.fillImageDefaults=ee(_p);var ne={lineDash:be(P),lineDashOffset:W},io={...se,...J,...ne,opacity:ce,cornerRadius:P},Qa={...J,...ne,opacity:ce},It={...se,...J,...ne,opacity:ce};function Im(e){return{enabled:R,range:Z("tooltip","node"),highlightedItem:e,unhighlightedItem:e}}function zt(e,t){return{enabled:R,range:Z("tooltip","node"),highlightedItem:e,unhighlightedItem:e,highlightedSeries:t,unhighlightedSeries:t,bringToFront:R}}var PS={start:le,stop:le,...J,...se,...ne},RS={start:le,stop:le,...J,...ne},ca=Ot({enabled:R,key:$(Z("x","y")),segments:Ft(PS,"path segments array")},"a segmentation object",!0),FS=Ot({enabled:R,key:$(Z("x","y")),segments:Ft(RS,"path segments array")},"a segmentation object",!0),km=Ot({googleFont:N},"google font"),Vp=Ae(N,hd,km,be(Ae(N,km))),Ke={color:ie,fontFamily:Vp,fontSize:P,fontStyle:Z("normal","italic","oblique"),fontWeight:Ae(P,Z("normal","bold","bolder","lighter"))},zS=Ot({top:W,right:W,bottom:W,left:W},"padding object"),al=Ae(W,zS),rl={enabled:R,stroke:ie,strokeWidth:P,strokeOpacity:ce},Dn={border:{...rl},cornerRadius:W,padding:al,...se},Q_=void 0,J_=void 0;J_=Q_;var eV=void 0,tV=void 0;tV=eV;var VL=(e=>(e.POINTER="pointer",e.NODE="node",e.CHART="chart",e))(VL||{}),GL=(e=>(e.TOP="top",e.RIGHT="right",e.BOTTOM="bottom",e.LEFT="left",e.TOP_RIGHT="top-right",e.BOTTOM_RIGHT="bottom-right",e.BOTTOM_LEFT="bottom-left",e.TOP_LEFT="top-left",e.CENTER="center",e))(GL||{}),iV=void 0,sV=void 0;sV=iV;var nV=void 0,oV=void 0;oV=nV;var BS=["top","top-right","top-left","bottom","bottom-right","bottom-left","right","right-top","right-bottom","left","left-top","left-bottom"],aV={floating:R,placement:Z(...BS),xOffset:W,yOffset:W},dd=Ge((e,t)=>{let i;if(typeof e=="string")BS.includes(e)?i=!0:(i={valid:!1,invalid:[],cleared:null},i.invalid.push(new la("invalid",`a legend placement string: ["${BS.join('", "')}"]`,e,t.path)));else{const{cleared:s,invalid:n}=Ei(e,aV);i={valid:n.length===0,cleared:s,invalid:n}}return i},"a legend position object or placement string"),Ja=Ae(Z("circle","cross","diamond","heart","plus","pin","square","star","triangle"),ct),HL=Z("never","always","hyphenate","on-space"),Am=Z("top","right","bottom","left","top-right","bottom-right","bottom-left","top-left","center"),Gp=Ae(P,Z("exact","nearest")),Hi=Ae(N,W,is,Ft({text:$(N),...Ke},"text segments array")),Cm={enabled:R,text:Hi,textAlign:Z("left","center","right"),wrapping:Z("never","always","hyphenate","on-space"),spacing:P,maxWidth:P,maxHeight:P,...Ke};Cm.padding=ee(P);var Lm={enabled:R,text:Hi,renderer:vi(Ae(N,bm))},_S=["defaults","download","zoom-to-cursor","pan-to-cursor","reset-zoom","toggle-series-visibility","toggle-other-series","separator"],jL={type:Z("action","separator"),showOn:Z("always","series-area","series-node","legend-item"),label:$(N),enabled:R,action:ct,items:(e,t)=>Hp(e,t)};jL.iconUrl=ee(N);var rV=Ot(jL),lV=Ge((e,t)=>{let i;return typeof e=="string"?_S.includes(e)?i=!0:(i={valid:!1,invalid:[],cleared:null},i.invalid.push(new la("invalid",`a context menu item string alias: ["${_S.join('", "')}"]`,e,t.path))):i=rV(e,t),i},`a context menu item object or string alias: [${_S.join(", ")}]`),Hp=be(lV,"a menu items array",!1),er={label:N,ariaLabel:N,tooltip:N,icon:Z("align-center","align-left","align-right","arrow-drawing","arrow-down-drawing","arrow-up-drawing","callout-annotation","candlestick-series","close","comment-annotation","date-range-drawing","date-price-range-drawing","delete","disjoint-channel-drawing","drag-handle","fill-color","line-style-solid","line-style-dashed","line-style-dotted","high-low-series","hlc-series","hollow-candlestick-series","horizontal-line-drawing","line-color","line-series","line-with-markers-series","locked","measurer-drawing","note-annotation","ohlc-series","pan-end","pan-left","pan-right","pan-start","parallel-channel-drawing","position-bottom","position-center","position-top","price-label-annotation","price-range-drawing","reset","settings","step-line-series","text-annotation","trend-line-drawing","fibonacci-retracement-drawing","fibonacci-retracement-trend-based-drawing","unlocked","vertical-line-drawing","zoom-in","zoom-out")},Lo=Ae(N,vi(Hi)),VS=Ot({x:Lo,y:Lo,angle:Lo,radius:Lo,size:Lo,color:Lo,label:Lo,secondaryLabel:Lo,sectorLabel:Lo,calloutLabel:Lo,legendItem:Lo}),nn=Ge(MS,"a valid number format string"),we={width:P,height:P,minWidth:P,minHeight:P,suppressFieldDotNotation:R,title:Cm,subtitle:Cm,footnote:Cm,padding:{top:P,right:P,bottom:P,left:P},seriesArea:{border:rl,clip:R,cornerRadius:W,padding:al},legend:{enabled:R,position:dd,orientation:Z("horizontal","vertical"),maxWidth:P,maxHeight:P,spacing:P,border:rl,cornerRadius:W,padding:al,fill:ks,fillOpacity:ce,preventHidingAll:R,reverseOrder:R,toggleSeries:R,item:{marker:{size:P,shape:Ja,padding:P,strokeWidth:P},line:{length:P,strokeWidth:P},label:{maxLength:P,formatter:ct,...Ke},maxWidth:P,paddingX:P,paddingY:P,showSeriesStroke:R},pagination:{marker:{size:P,shape:Ja,padding:P},activeStyle:{...se,...J},inactiveStyle:{...se,...J},highlightStyle:{...se,...J},label:Ke},listeners:{legendItemClick:ct,legendItemDoubleClick:ct}},gradientLegend:{enabled:R,position:dd,spacing:P,reverseOrder:R,border:rl,cornerRadius:W,padding:al,fill:ks,fillOpacity:ce,gradient:{preferredLength:P,thickness:P},scale:{label:{...Ke,minSpacing:P,format:nn,formatter:ct},padding:P,interval:{step:W,values:sn,minSpacing:Ue(P,ss("maxSpacing")),maxSpacing:Ue(P,ns("minSpacing"))}}},listeners:{seriesNodeClick:ct,seriesNodeDoubleClick:ct,seriesVisibilityChange:ct,click:ct,doubleClick:ct,annotations:ct,zoom:ct},loadGoogleFonts:R,highlight:{drawingMode:Z("overlay","cutout"),range:Z("tooltip","node")},overlays:{loading:Lm,noData:Lm,noVisibleSeries:Lm,unsupportedBrowser:Lm},tooltip:{enabled:R,showArrow:R,pagination:R,delay:P,range:Gp,wrapping:HL,mode:Z("single","shared","compact"),position:{anchorTo:Z("pointer","node","chart"),placement:Ae(Am,be(Am)),xOffset:W,yOffset:W}},animation:le,contextMenu:le,context:()=>!0,dataSource:{getData:ct},keyboard:{enabled:R,tabIndex:W},touch:{dragAction:Z("none","drag","hover")},ranges:{enabled:R,buttons:Ft({...er,value:Ae(W,Ue(be(Ae(W,is)),qa(2,2)),ct)},"range button options array")},locale:{localeText:Xa,getLocaleText:vi(N)},background:{visible:R,fill:ie,image:{url:$(N),top:W,right:W,bottom:W,left:W,width:P,height:P,opacity:ce}},styleNonce:N,sync:le,zoom:le,formatter:Ae(vi(Hi),VS)};we.flashOnUpdate=ee(le),we.dataSource.requestThrottle=ee(P),we.dataSource.updateThrottle=ee(P),we.dataSource.updateDuringInteraction=ee(R),we.statusBar=ee(le),we.foreground=ee({visible:R,text:N,image:{url:N,top:W,right:W,bottom:W,left:W,width:P,height:P,opacity:ce},...se}),we.overrideDevicePixelRatio=ee(W),we.sync.domainMode=ee(Z("direction","position","key"));var Je={cursor:N,context:()=>!0,showInLegend:R,nodeClickRange:Gp,listeners:{seriesNodeClick:ct,seriesNodeDoubleClick:ct},highlight:Im(It)},et={...Je,id:N,visible:R,context:()=>!0,data:sn};et.seriesGrouping=ee(le);var tr={shape:Ja,size:P,...se,...J,...ne},so={enabled:R,itemStyler:Qe({...se,...J,...ne,shape:Ja,size:P}),...tr},ft={enabled:R,formatter:vi(Hi),format:nn,itemStyler:Qe({enabled:R,...Dn,...Ke}),...Dn,...Ke},ir={...ft,lineHeight:P,minimumFontSize:P,wrapping:HL,overflowStrategy:Z("ellipsis","hide")},ud={visible:R,cap:{visible:R,length:P,lengthRatio:ce,...J,...ne},...J,...ne},pd={...ud,xLowerKey:N,xUpperKey:N,yLowerKey:N,yUpperKey:N,xLowerName:N,xUpperName:N,yLowerName:N,yUpperName:N,itemStyler:Qe({visible:R,...J,...ne,cap:{visible:R,length:P,lengthRatio:ce,...J,...ne}})},Ye={enabled:R,showArrow:R,range:Gp,renderer:vi(Ae(N,W,is,Ot({heading:N,title:N,symbol:{marker:{enabled:R,shape:Ja,...se,stroke:ie,strokeOpacity:ce,strokeWidth:P,...ne},line:{enabled:R,stroke:ie,strokeWidth:P,strokeOpacity:ce,...ne}},data:Ft({label:$(N),value:$(Ae(N,W,is))})},"tooltip renderer result object"))),position:{anchorTo:Z("node","pointer","chart"),placement:Ae(Am,be(Am)),xOffset:W,yOffset:W},interaction:{enabled:R}},wo={enabled:R,xOffset:W,yOffset:W,blur:P,color:ie},jp=nl({linear:{},smooth:{tension:ce},step:{position:Z("start","middle","end")}},"interpolation line options"),Wp=Symbol("BREAK"),$p="__decorator_config",wm="__decorator_accessors";function m(e,t){GS(e,t).optional=!0}function GS(e,t){if(Object.getOwnPropertyDescriptor(e,$p)==null&&Object.defineProperty(e,$p,{value:{}}),Object.getOwnPropertyDescriptor(e,wm)==null){const h=Object.getPrototypeOf(e)?.[wm]?.slice()??[];Object.defineProperty(e,wm,{value:h})}const i=e[$p],s=t.toString();if(i[s]!=null)return i[s];i[s]={setters:[],getters:[],observers:[]};const n=Object.getOwnPropertyDescriptor(e,t);let o=n?.get,a=n?.set;if(o==null||a==null){const c=e[wm];let h=c.indexOf(t);h===-1&&(h=c.push(t)-1),o??(o=function(){let d=this.__accessors;return d==null&&(d=c.slice().fill(void 0),Object.defineProperty(this,"__accessors",{value:d})),d[h]}),a??(a=function(d){let u=this.__accessors;u==null&&(u=c.slice().fill(void 0),Object.defineProperty(this,"__accessors",{value:u})),u[h]=d})}return Object.defineProperty(e,t,{set:function(c){const{setters:h,observers:d}=i[s];let u;h.some(p=>p.length>2)&&(u=o.call(this));for(const p of h)if(c=p(this,t,c,u),c===Wp)return;a.call(this,c);for(const p of d)p(this,c,u)},get:function(){let c=o.call(this);for(const h of i[s].getters)if(c=h(this,t,c),c===Wp)return;return c},enumerable:!0,configurable:!1}),i[s]}function sr(e,t,i){return(s,n)=>{const o=GS(s,n);o.setters.push(e),t&&o.getters.unshift(t),i&&Object.assign(o,i)}}function Tm(e){return(t,i)=>{GS(t,i).observers.push(e)}}function Up(e){return e!==void 0&&$p in e}function nr(e){const t=new Set;for(;Up(e);)t.add(e?.[$p]),e=Object.getPrototypeOf(e);return Array.from(t).flatMap(i=>Object.keys(i))}function HS(e){return nr(e).reduce((t,i)=>(t[String(i)]=e[i]??null,t),{})}function*or(...e){for(const t of e)t!=null&&(t[Symbol.iterator]?yield*t:yield t)}function jS(e){return e!=null&&typeof e=="object"&&Symbol.iterator in e?e:[e]}function Gs(e){for(const t of e)return t;throw new Error("AG Charts - no first() value found")}function*ht(e){const t=[void 0,void 0];for(const i of Object.keys(e))t[0]=i,t[1]=e[i],yield t}function To(e){return Object.keys(e)}function ii(e,t){return Array.isArray(e)?!Array.isArray(t)||e.length!==t.length?!1:e.every((i,s)=>ii(i,t[s])):st(e)?st(t)?Nm(e,t,ii):!1:e===t}function Nm(e,t,i){if(Object.is(e,t))return!0;for(const s of Object.keys(t))if(!(s in e))return!1;for(const s of Object.keys(e))if(!(s in t)||!i(e[s],t[s]))return!1;return!0}function oe(...e){const t={};for(const i of e){if(!fe(i))continue;const s=Up(i)?nr(i):Object.keys(i);for(const n of s)st(t[n])&&st(i[n])?t[n]=oe(t[n],i[n]):t[n]??(t[n]=i[n])}return t}function gd(...e){const t={};for(const i of e){if(!fe(i))continue;const s=Up(i)?nr(i):Object.keys(i);for(const n of s)st(t[n])&&st(i[n])?t[n]=gd(t[n],i[n]):n in t||(t[n]??(t[n]=i[n]))}return t}function Om(e,...t){return t&&Ce(e)?e.map(i=>oe(i,...t)):e}function Dc(e,t){const i={};for(const[s,n]of ht(e))i[s]=t(n,s,e);return i}function Q(e,t){const i={...e};for(const s of t)delete i[s];return i}function Kp(e,t){if(e==null)return;const i={};for(const s of t)Object.hasOwn(e,s)&&(i[s]=e[s]);return i}function WS(e,t){if(e==null)return!0;for(const[i,s]of ht(e))if(!t(i,s))return!1;return!0}function $S(e){const t={};if(e==null)return t;for(const[i,s]of e)t[i]=s;return t}function Em(e,t){return(Ce(t)?t:t.split(".")).reduce((s,n)=>s[n],e)}var Pm=new Set(["__proto__","constructor","prototype"]);function Rm(e,t,i){const s=Ce(t)?t.slice():t.split("."),n=s.pop();if(s.some(a=>Pm.has(a)))return;const o=s.reduce((a,r)=>a[r],e);return o[n]=i,o[n]}function Yp(e,t,i){if(i===void 0)return t;for(const s of e){const n=i[s];n!==void 0&&(t[s]=n)}return t}function Fm(e,t,i){const s=i??Object.keys(t);for(let n=0,o=s.length;n<o;n++){const a=s[n],r=t[a];e[a]!==r&&(e[a]=r)}return e}function on(e){if(e==null||typeof e!="object"||!st(e))return e;Object.freeze(e);for(const t of Object.getOwnPropertyNames(e)){const i=e[t];i!==null&&(typeof i=="object"||typeof i=="function")&&!Object.isFrozen(i)&&on(i)}return e}function US(e,t){return st(e)&&t in e}function KS(e,t){return US(e,t)&&typeof e[t]=="string"}var zm={fills:Ue(qa(2),be(Ot({color:ie,stop:W},"")),Dm),fillMode:Z("continuous","discrete")},Zp={value:$(W),text:N,shape:Ae(Z("circle","cross","diamond","heart","plus","pin","square","star","triangle","line"),ct),placement:Z("before","after","middle"),spacing:P,size:P,rotation:W,...se,...J,...ne},Xp={value:$(W),text:N,shape:Ae(Z("circle","cross","diamond","heart","plus","pin","square","star","triangle","line"),ct),placement:Z("inside","outside","middle"),spacing:P,size:P,rotation:W,label:{...ft,spacing:P},...se,...J,...ne},qp={...Q(Je,["listeners"]),direction:Z("horizontal","vertical"),cornerMode:Z("container","item"),cornerRadius:P,thickness:P,segmentation:{enabled:R,spacing:P,interval:{values:be(W),step:W,count:W}},bar:{enabled:R,thickness:P,thicknessRatio:ce,...zm,...se,...J,...ne},label:{...ir,text:N,spacing:P,avoidCollisions:R,placement:Z("inside-start","outside-start","inside-end","outside-end","inside-center","bar-inside","bar-inside-end","bar-outside-end","bar-end")},tooltip:Ye},ha={...Q(et,["listeners"]),...qp,type:$(Le("linear-gauge")),value:$(W),scale:{min:Ue(W,ss("max")),max:Ue(W,ns("min")),label:{enabled:R,formatter:ct,rotation:W,spacing:P,minSpacing:P,placement:Z("before","after"),avoidCollisions:R,format:nn,...Ke},interval:{values:be(W),step:W},...zm,...se,...J,...ne},targets:Ft(Zp,"target options array")};ha.margin=ee(W),ha.defaultColorRange=ee(be(ie)),ha.defaultTarget=ee({...Zp,value:W,label:{...ft,spacing:W}}),ha.defaultScale=ee(ha.scale),ha.scale.defaultFill=ee(ie);var Qp={...Q(Je,["listeners"]),outerRadius:P,innerRadius:P,outerRadiusRatio:ce,innerRadiusRatio:ce,startAngle:W,endAngle:W,spacing:P,cornerMode:Z("container","item"),cornerRadius:P,scale:{min:Ue(W,ss("max")),max:Ue(W,ns("min")),label:{enabled:R,formatter:ct,rotation:W,spacing:P,minSpacing:P,avoidCollisions:R,format:nn,...Ke},interval:{values:be(W),step:W},...zm,...se,...J,...ne},segmentation:{enabled:R,spacing:P,interval:{values:be(W),step:W,count:W}},bar:{enabled:R,...zm,...se,...J,...ne},needle:{enabled:R,spacing:P,radiusRatio:ce,...se,...J,...ne},label:{text:N,spacing:P,...ir},secondaryLabel:{text:N,...ir},tooltip:Ye},Ic={...Q(et,["listeners"]),...Qp,type:$(Le("radial-gauge")),value:$(W),targets:Ft(Xp,"target options array")};Ic.defaultColorRange=ee(be(ie)),Ic.defaultTarget=ee({...Xp,value:W,label:{...ft,spacing:W}}),Ic.scale.defaultFill=ee(ie);var Bm=class rL{constructor(t){this.version=t.split("-")[0]}save(...t){const i={version:this.version};for(const s of Object.values(t))i[s.mementoOriginatorKey]=this.encode(s,s.createMemento());return i}restore(t,...i){if(typeof t!="object"){j.warnOnce(`Could not restore data of type [${typeof t}], expecting an object, ignoring.`);return}if(t==null){j.warnOnce("Could not restore data of type [null], expecting an object, ignoring.");return}if(!("version"in t)||typeof t.version!="string"){j.warnOnce("Could not restore data, missing [version] string in object, ignoring.");return}for(const s of i){const n=this.decode(s,t[s.mementoOriginatorKey]),o=[];if(!s.guardMemento(n,o)){const a=o.length>0?`

${o.join(`

`)}

`:"";j.warnOnce(`Could not restore [${s.mementoOriginatorKey}] data, value was invalid, ignoring.${a}`,n);return}s.restoreMemento(this.version,t.version,n)}}encode(t,i){try{return JSON.parse(JSON.stringify(i,rL.encodeTypes))}catch(s){throw new Error(`Failed to encode [${t.mementoOriginatorKey}] value [${s}].`,{cause:s})}}decode(t,i){if(i==null)return i;try{return JSON.parse(JSON.stringify(i),rL.decodeTypes)}catch(s){throw new Error(`Failed to decode [${t.mementoOriginatorKey}] value [${s}].`,{cause:s})}}static encodeTypes(t,i){return Is(this[t])?{__type:"date",value:this[t].toISOString()}:i}static decodeTypes(t,i){return fe(this[t])&&"__type"in this[t]&&this[t].__type==="date"?new Date(this[t].value):i}},Jp=(e=>(e.X="x",e.Y="y",e.Angle="angle",e.Radius="radius",e))(Jp||{}),kc=(e=>(e[e.FULL=0]="FULL",e[e.UPDATE_DATA=1]="UPDATE_DATA",e[e.PROCESS_DATA=2]="PROCESS_DATA",e[e.PROCESS_DOMAIN=3]="PROCESS_DOMAIN",e[e.PERFORM_LAYOUT=4]="PERFORM_LAYOUT",e[e.SERIES_UPDATE=5]="SERIES_UPDATE",e[e.PRE_SCENE_RENDER=6]="PRE_SCENE_RENDER",e[e.SCENE_RENDER=7]="SCENE_RENDER",e[e.NONE=8]="NONE",e))(kc||{});function ll(e){const{placement:t="bottom",floating:i=!1,xOffset:s=0,yOffset:n=0}=typeof e=="string"?{placement:e,floating:!1}:e;return{placement:t,floating:i,xOffset:s,yOffset:n}}function Ac(e,t){const[i,s]=Tt(t);return ge(i,e,s)}function Tt(e){if(e.length===0)return[];const t=[1/0,-1/0];for(const i of e)i<t[0]&&(t[0]=i),i>t[1]&&(t[1]=i);return t}function da(e){const[t,i]=Tt(e);return i-t}function Cc(e){return e=Math.trunc(e),e<=0?1:e===1?2:1<<32-Math.clz32(e-1)}function _m(e){return e=Math.trunc(e),e<=0?0:e===1?1:1<<31-Math.clz32(e)}var Hs=0,js=1,Ws=2,$s=3,In=4,ua=1e3,WL=10,ar=64,cl=4294967295,cV=3,hV=20,YS=100;function ZS(e,t,i,s,n,o,a,r){let l=0;for(;l<YS&&e[s]==null&&s<n;)s+=1,l+=1;for(;l<YS&&e[n]==null&&n>s;)n-=1,l+=1;if(l>=YS||s>=n)return o;const c=Number.isFinite(t)?kn(e[n],t,i,r)-kn(e[s],t,i,r):Lc(n,e.length)-Lc(s,e.length);if(c===0||!Number.isFinite(c))return o;const h=Math.abs(c)/(n-s);let d;if(a<cV?d=!0:a>hV?d=!1:d=h<=o,o=Math.min(o,h),!d)return o;const u=Math.floor((s+n)/2),p=ZS(e,t,i,s,u,o,a+1,r),f=ZS(e,t,i,u+1,n,o,a+1,r);return Math.min(p,f,o)}function dV(e,t,i,s){return ZS(e,t,i,0,e.length-1,1/(e.length-1),0,s)}function pa(e,t,i,s){if(Number.isFinite(t)){const n=s?.smallestKeyInterval,o=s?.xNeedsValueOf??!0,a=n==null?dV(e,t,i,o):n/(i-t);return Cc(Math.trunc(1/a))>>3}else{let n=Math.ceil(Math.log2(e.length))-1;return n=Math.min(Math.max(n,0),24),Math.trunc(2**n)}}function si(e,t){const{domain:i,sortMetadata:s}=t;switch(e){case"category":return[Number.NaN,Number.NaN];case"number":case"time":case"ordinal-time":case"unit-time":{if(i.length===0)return[1/0,-1/0];if(s?.sortOrder===1)return[Number(i[0]),Number(i.at(-1))];if(s?.sortOrder===-1)return[Number(i.at(-1)),Number(i[0])];let n=1/0,o=-1/0;for(const a of i){const r=Number(a);n=Math.min(n,r),o=Math.max(o,r)}return[n,o]}case"color":case"log":case"mercator":return[0,0]}}function Lc(e,t){return e/t}function kn(e,t,i,s){return s?(e.valueOf()-t)/(i-t):(e-t)/(i-t)}function eg(e,t){return Math.trunc(Math.min(Math.floor(e*t),t-1)*In)}function $L(e,t,i,s,n,{xNeedsValueOf:o=!0,xValuesLength:a}={}){const r=e[n];if(r==null)return-1;const l=a??e.length,c=Number.isFinite(t)?kn(r,t,i,o):Lc(n,l);return eg(c,s)}function UL(e,t,i,s){for(const n of s)if(i===e[t+n])return!0;return!1}function ga(e,t,i,s,n,o,{positive:a,split:r=!1,xNeedsValueOf:l=!0,yNeedsValueOf:c=!0,reuseIndexData:h,reuseValueData:d,reuseNegativeIndexData:u,reuseNegativeValueData:p}={}){const f=Number.NaN,y=o*In,b=h?.length===y?h:new Uint32Array(y),x=d?.length===y?d:new Float64Array(y);let v,S;r&&(u&&u.length===y?v=u:v=new Uint32Array(y),p&&p.length===y?S=p:S=new Float64Array(y));const M=Number.isFinite(s)&&Number.isFinite(n),D=e.length;M&&(x.fill(f),b.fill(cl),r&&(S.fill(f),v.fill(cl)));const k=M?o/(n-s):o*(1/D);let I=-1,A=-1,C=f,w=-1,T=f,O=-1,E=f,z=-1,F=f,_=-1,G=-1,B=f,V=-1,Y=f,X=-1,q=f,te=-1,pe=f;const Se=e.length,ve=t===i;for(let ae=0;ae<Se;ae++){const Ie=e[ae];if(Ie==null)continue;const ze=t[ae],Xe=ve?ze:i[ae];let Te,de;c?(Te=ze==null?f:ze.valueOf(),de=Xe==null?f:Xe.valueOf()):(Te=ze??f,de=Xe??f);let De=!0;if(r)De=Te>=0;else if(a!=null&&Te>=0!==a)continue;let ye;M?l?ye=(Ie.valueOf()-s)*k:ye=(Ie-s)*k:ye=ae*k;const Ee=Math.floor(ye),Ne=(Ee<o?Ee:o-1)<<2;if(De){Ne!==I&&(I!==-1&&(b[I]=A,b[I+1]=w,b[I+2]=O,b[I+3]=z,x[I]=C,x[I+1]=T,x[I+2]=E,x[I+3]=F),I=Ne,A=-1,C=f,w=-1,T=f,O=-1,E=f,z=-1,F=f);const xt=de===de,nt=Te===Te;A===-1?(A=ae,C=ye,w=ae,T=ye,xt&&(O=ae,E=de),nt&&(z=ae,F=Te)):(ye<C&&(A=ae,C=ye),ye>T&&(w=ae,T=ye),xt&&de<E&&(O=ae,E=de),nt&&Te>F&&(z=ae,F=Te))}else{Ne!==_&&(_!==-1&&(v[_]=G,v[_+1]=V,v[_+2]=X,v[_+3]=te,S[_]=B,S[_+1]=Y,S[_+2]=q,S[_+3]=pe),_=Ne,G=-1,B=f,V=-1,Y=f,X=-1,q=f,te=-1,pe=f);const xt=de===de,nt=Te===Te;G===-1?(G=ae,B=ye,V=ae,Y=ye,xt&&(X=ae,q=de),nt&&(te=ae,pe=Te)):(ye<B&&(G=ae,B=ye),ye>Y&&(V=ae,Y=ye),xt&&de<q&&(X=ae,q=de),nt&&Te>pe&&(te=ae,pe=Te))}}return I!==-1&&(b[I]=A,b[I+1]=w,b[I+2]=O,b[I+3]=z,x[I]=C,x[I+1]=T,x[I+2]=E,x[I+3]=F),r&&_!==-1&&(v[_]=G,v[_+1]=V,v[_+2]=X,v[_+3]=te,S[_]=B,S[_+1]=Y,S[_+2]=q,S[_+3]=pe),{indexData:b,valueData:x,negativeIndexData:v,negativeValueData:S}}function hl(e,t,i,{inPlace:s=!1,midpointData:n,reuseIndexData:o,reuseValueData:a}={}){const r=Math.trunc(i/2),l=r*In;let c;s?c=e:o&&o.length===l?c=o:c=new Uint32Array(l);let h;s?h=t:a&&a.length===l?h=a:h=new Float64Array(l);const d=n??new Uint32Array(r);for(let u=0;u<r;u+=1){const p=Math.trunc(u*In),f=Math.trunc(p*2),y=Math.trunc(f+In),b=e[y+Hs]===cl,x=b||t[f+Hs]<t[y+Hs]?f:y,v=e[x+Hs];c[p+Hs]=v,h[p+Hs]=t[x+Hs];const S=b||t[f+js]>t[y+js]?f:y,M=e[S+js];c[p+js]=M,h[p+js]=t[S+js],d[u]=v+M>>1;const D=b||t[f+Ws]<t[y+Ws]?f:y;c[p+Ws]=e[D+Ws],h[p+Ws]=t[D+Ws];const k=b||t[f+$s]>t[y+$s]?f:y;c[p+$s]=e[k+$s],h[p+$s]=t[k+$s]}return{maxRange:r,indexData:c,valueData:h,midpointData:d}}function No(e,t,i,s=Hs,n=js,o=-1){const a=i&&i.length===e?i:new Uint32Array(e);for(let r=0,l=0;r<e;r+=1,l+=In){const c=t[l+s],h=t[l+n];a[r]=c===o?o:c+h>>1}return a}function KL(e,{collectLevel:t,shouldContinue:i,minRange:s=ar,compactInPlace:n=!1}){let o=e,a=t(o);const r=[a];for(;o.maxRange>s&&i(a,o);){const l=hl(o.indexData,o.valueData,o.maxRange,{inPlace:n});o={maxRange:l.maxRange,indexData:l.indexData,valueData:l.valueData,midpointData:l.midpointData},a=t(o),r.push(a)}return r.reverse(),r}function rr(e,t,i,s,n){if(t.length<ua)return;const[o,a]=e,{smallestKeyInterval:r,xNeedsValueOf:l,yNeedsValueOf:c,existingFilters:h}=n;let d=pa(t,o,a,{smallestKeyInterval:r,xNeedsValueOf:l});const u=h?.find(x=>x.maxRange===d);let{indexData:p,valueData:f}=ga(t,i,s,o,a,d,{xNeedsValueOf:l,yNeedsValueOf:c,reuseIndexData:u?.indexData,reuseValueData:u?.valueData}),y=No(d,p,u?.midpointIndices);const b=[{maxRange:d,indexData:p,valueData:f,midpointIndices:y}];for(;d>ar;){const x=d,v=Math.trunc(x/2),S=h?.find(D=>D.maxRange===v),M=hl(p,f,x,{reuseIndexData:S?.indexData,reuseValueData:S?.valueData});d=M.maxRange,p=M.indexData,f=M.valueData,y=M.midpointData??No(d,p,S?.midpointIndices),b.push({maxRange:d,indexData:p,valueData:f,midpointIndices:y})}return b.reverse(),b}function tg(e,t,i,s,n){if(t.length<ua)return;const[o,a]=e,{smallestKeyInterval:r,targetRange:l,xNeedsValueOf:c,yNeedsValueOf:h,existingFilters:d}=n,u=pa(t,o,a,{smallestKeyInterval:r,xNeedsValueOf:c}),p=Math.min(u,Cc(Math.max(l,ar))),f=d?.find(M=>M.maxRange===p),{indexData:y,valueData:b}=ga(t,i,s,o,a,p,{xNeedsValueOf:c,yNeedsValueOf:h,reuseIndexData:f?.indexData,reuseValueData:f?.valueData}),x=No(p,y,f?.midpointIndices),v={maxRange:p,indexData:y,valueData:b,midpointIndices:x};function S(){return rr([o,a],t,i,s,{smallestKeyInterval:r,xNeedsValueOf:c,yNeedsValueOf:h,existingFilters:d})?.filter(D=>D.maxRange!==p)??[]}return{immediate:[v],computeRemaining:S}}var K=class{handleUnknownProperties(e,t){}set(e){const{className:t=this.constructor.name}=this.constructor;if(e==null)return this.clear(),this;if(typeof e!="object")return j.warn(`unable to set ${t} - expecting a properties object`),this;const i=new Set(Object.keys(e));for(const s of nr(this))if(i.has(s)){const n=e[s],o=this;if(wc(o[s]))if(o[s]instanceof Pi){const a=o[s].reset(n);a==null?j.warn(`unable to set [${String(s)}] - expecting a properties array`):o[s]=a}else o[s].set(n);else st(n)?o[s]=gd(n,o[s]??{}):o[s]=n;i.delete(s)}this.handleUnknownProperties(i,e);for(const s of i)j.warn(`unable to set [${String(s)}] in ${t} - property is unknown`);return this}clear(){for(const e of nr(this)){const t=this[e];wc(t)?t.clear():this[e]=void 0}return this}toJson(){return nr(this).reduce((e,t)=>{const i=this[t];return e[String(t)]=wc(i)?i.toJson():i,e},{})}},Pi=class RB extends Array{constructor(t,...i){super(i.length);const n=(o=>!!o?.prototype?.constructor?.name)(t)?o=>new t().set(o):t;Object.defineProperty(this,"itemFactory",{value:n,enumerable:!1,configurable:!1}),this.set(i)}set(t){if(Ce(t)){this.length=t.length;for(let i=0;i<t.length;i++)this[i]=this.itemFactory(t[i])}return this}reset(t){if(Array.isArray(t))return new RB(this.itemFactory,...t)}toJson(){return this.map(t=>t?.toJson?.()??t)}};function wc(e){return e instanceof K||e instanceof Pi}var dl=class extends K{constructor(){super(...arguments),this.type="linear",this.tension=1,this.position="end"}};g([m],dl.prototype,"type",2),g([m],dl.prototype,"tension",2),g([m],dl.prototype,"position",2);var XS=(e=>(e[e.BACKGROUND=0]="BACKGROUND",e[e.FOREGROUND=1]="FOREGROUND",e[e.HIGHLIGHT=2]="HIGHLIGHT",e[e.LABEL=3]="LABEL",e))(XS||{}),qS=(e=>(e[e.BACKGROUND=0]="BACKGROUND",e[e.ANY_CONTENT=1]="ANY_CONTENT",e))(qS||{}),QS=(e=>(e[e.FOREGROUND=0]="FOREGROUND",e[e.HIGHLIGHT=1]="HIGHLIGHT",e[e.LABEL=2]="LABEL",e))(QS||{}),Tc=class FB{constructor(t,i,s,n){this.lon0=t,this.lat0=i,this.lon1=s,this.lat1=n}extend(t,i,s,n){return this.lon0=Math.min(this.lon0,t),this.lat0=Math.min(this.lat0,i),this.lon1=Math.max(this.lon1,s),this.lat1=Math.max(this.lat1,n),this}merge(t){return this.extend(t.lon0,t.lat0,t.lon1,t.lat1)}static extend(t,i,s,n,o){return t?t.extend(i,s,n,o):new FB(i,s,n,o)}},JS=(e=>(e[e.SMALLEST=8]="SMALLEST",e[e.SMALLER=10]="SMALLER",e[e.SMALL=12]="SMALL",e[e.MEDIUM=13]="MEDIUM",e[e.LARGE=14]="LARGE",e[e.LARGEST=17]="LARGEST",e))(JS||{}),Oo=12,Si={SMALLEST:8/Oo,SMALLER:10/Oo,SMALL:12/Oo,MEDIUM:13/Oo,LARGE:14/Oo,LARGEST:17/Oo},e0=(e=>(e.TOP="top",e.TOP_RIGHT="top-right",e.TOP_LEFT="top-left",e.RIGHT="right",e.RIGHT_TOP="right-top",e.RIGHT_BOTTOM="right-bottom",e.BOTTOM="bottom",e.BOTTOM_RIGHT="bottom-right",e.BOTTOM_LEFT="bottom-left",e.LEFT="left",e.LEFT_TOP="left-top",e.LEFT_BOTTOM="left-bottom",e))(e0||{}),t0=(e=>(e.CATEGORY="category",e.GROUPED_CATEGORY="grouped-category",e.ORDINAL_TIME="ordinal-time",e.UNIT_TIME="unit-time",e.TIME="time",e.NUMBER="number",e.LOG="log",e))(t0||{}),i0=(e=>(e.ANGLE_CATEGORY="angle-category",e.ANGLE_NUMBER="angle-number",e.RADIUS_CATEGORY="radius-category",e.RADIUS_NUMBER="radius-number",e))(i0||{}),s0=(e=>(e.CIRCLE="circle",e.POLYGON="polygon",e))(s0||{}),ul=Symbol("is-dark-theme"),fa=Symbol("default-shadow-colour"),ma=Symbol("default-caption-layout-style"),lr=Symbol("default-caption-alignment"),Vm=Symbol("palette-up-stroke"),Gm=Symbol("palette-down-stroke"),Hm=Symbol("palette-up-fill"),jm=Symbol("palette-down-fill"),Wm=Symbol("palette-neutral-stroke"),$m=Symbol("palette-neutral-fill"),Um=Symbol("palette-alt-up-stroke"),Km=Symbol("palette-alt-down-stroke"),Ym=Symbol("palette-alt-up-fill"),Zm=Symbol("palette-alt-down-fill"),Xm=Symbol("palette-gray-fill"),qm=Symbol("palette-gray-stroke"),ig=Symbol("default-polar-series-stroke"),sg=Symbol("default-sparkline-crosshair-stroke"),As=Symbol("default-financial-charts-annotation-stroke"),fd=Symbol("default-hierarchy-strokes"),ng=Symbol("default-text-annotation-color"),os=Symbol("default-financial-charts-annotation-background-fill"),md=Symbol("default-annotation-handle-fill"),yd=Symbol("default-annotation-statistics-fill"),xd=Symbol("default-annotation-statistics-stroke"),bd=Symbol("default-annotation-statistics-color"),vd=Symbol("default-annotation-statistics-divider-stroke"),Sd=Symbol("default-annotation-statistics-fill"),Md=Symbol("default-annotation-statistics-stroke"),Dd=Symbol("default-textbox-fill"),Id=Symbol("default-textbox-stroke"),kd=Symbol("default-textbox-color"),Ad=Symbol("default-toolbar-position"),n0=(e=>(e[e.CHART_BACKGROUND=0]="CHART_BACKGROUND",e[e.AXIS_BAND_HIGHLIGHT=1]="AXIS_BAND_HIGHLIGHT",e[e.AXIS_GRID=2]="AXIS_GRID",e[e.AXIS=3]="AXIS",e[e.SERIES_AREA_CONTAINER=4]="SERIES_AREA_CONTAINER",e[e.ZOOM_SELECTION=5]="ZOOM_SELECTION",e[e.SERIES_CROSSLINE_RANGE=6]="SERIES_CROSSLINE_RANGE",e[e.SERIES_LAYER=7]="SERIES_LAYER",e[e.AXIS_FOREGROUND=8]="AXIS_FOREGROUND",e[e.SERIES_CROSSHAIR=9]="SERIES_CROSSHAIR",e[e.SERIES_CROSSLINE_LINE=10]="SERIES_CROSSLINE_LINE",e[e.SERIES_ANNOTATION=11]="SERIES_ANNOTATION",e[e.CHART_ANNOTATION=12]="CHART_ANNOTATION",e[e.CHART_ANNOTATION_FOCUSED=13]="CHART_ANNOTATION_FOCUSED",e[e.STATUS_BAR=14]="STATUS_BAR",e[e.SERIES_LABEL=15]="SERIES_LABEL",e[e.LEGEND=16]="LEGEND",e[e.NAVIGATOR=17]="NAVIGATOR",e[e.FOREGROUND=18]="FOREGROUND",e))(n0||{});function uV(e,t){return"context"in e}function YL(e,t){return e!=null&&uV(e,t)&&t!=null&&typeof t=="object"&&t.context===void 0?(t.context=e.context,!0):!1}function as(e,t,i){if(Array.isArray(e)){for(const s of e)if(YL(s,i))break}else YL(e,i);return t(i)}var o0=class{constructor(){this.cache=new WeakMap}call(e,t,i){let s,n=this.cache.get(t);try{s=JSON.stringify(i)}catch{return this.invoke(e,t,n,void 0,i)}return n==null&&(n=new Map,this.cache.set(t,n)),n.has(s)?n.get(s):this.invoke(e,t,n,s,i)}invoke(e,t,i,s,n){try{const o=as(e,t,n);return i&&s!=null&&i.set(s,o),o}catch(o){j.warnOnce("User callback errored, ignoring",o);return}}invalidateCache(){this.cache=new WeakMap}};function Cd(e,t){if(!e)return;const{x:i,y:s,width:n,height:o}=pV(t);Jm(e.style,"width",n),Jm(e.style,"height",o),Jm(e.style,"left",i),Jm(e.style,"top",s)}function a0(e){const t=Number.parseFloat(e.style.width),i=Number.parseFloat(e.style.height),s=Number.parseFloat(e.style.left),n=Number.parseFloat(e.style.top),o=Number.isFinite(t)?t:e.offsetWidth,a=Number.isFinite(i)?i:e.offsetHeight,r=Number.isFinite(s)?s:e.offsetLeft,l=Number.isFinite(n)?n:e.offsetTop;return{x:r,y:l,width:o,height:a}}function Qm(e){if(e.focus({preventScroll:!0}),e.lastChild?.textContent==null)return;const t=Qn().createRange();t.setStart(e.lastChild,e.lastChild.textContent.length),t.setEnd(e.lastChild,e.lastChild.textContent.length);const i=Ve().getSelection();i?.removeAllRanges(),i?.addRange(t)}function r0(){const e=Ve("navigator");if("scheduling"in e){const t=e.scheduling;if("isInputPending"in t)return t.isInputPending({includeContinuous:!0})}return!1}function pl(e){return`ag-charts-icon ag-charts-icon-${e}`}function pV(e){let{x:t,y:i,width:s,height:n}=e;return(s==null||s>0)&&(n==null||n>0)?e:(t!=null&&s!=null&&s<0&&(s=-s,t=t-s),i!=null&&n!=null&&n<0&&(n=-n,i=i-n),{x:t,y:i,width:s,height:n})}function Jm(e,t,i){i==null?e.removeProperty(t):e.setProperty(t,`${i}px`)}function l0(e,t,i=1/0){const s=t,n=i,o=e%180*(Math.PI/180),a=Math.abs(Math.sin(o)),r=Math.abs(Math.cos(o));if(a===0)return{width:s,height:n};if(r===0)return{width:n,height:s};if(!Number.isFinite(n)){const c=r/a,h=s/(r+c*a);return{width:h,height:c*h}}const l=r*r-a*a;if(l===0){const c=Math.min(s,n)/Math.SQRT2;return{width:c,height:c}}return{width:Math.abs((s*r-n*a)/l),height:Math.abs((n*r-s*a)/l)}}function ZL(e,t,i=1/0){const s=t,n=i,o=e%180*(Math.PI/180),a=Math.abs(Math.sin(o)),r=Math.abs(Math.cos(o));return a===0?{width:s,height:n}:r===0?{width:n,height:s}:{width:s*r+n*a,height:s*a+n*r}}function ey(e,t,i,s=0,n=0){const o=Math.cos(i),a=Math.sin(i),r=e-s,l=t-n;return{x:s+r*o-l*a,y:n+r*a+l*o}}var no=Math.PI*2,og=Math.PI/2;function tt(e){return e%=no,e+=no,e%=no,e}function Ld(e){return e%=no,e+=no,e!==no&&(e%=no),e}function ag(e){return e%=no,e<-Math.PI?e+=no:e>=Math.PI&&(e-=no),e}function Us(e,t,i){const s=tt(e),n=tt(t),o=tt(i);return n<o?n<=s&&s<=o:n>o?n<=s||s<=o:t!==i}function mt(e){return e/180*Math.PI}function c0(e){return e/Math.PI*180}function Eo(e,t){return e=tt(e),t=tt(t),t-e+(e>t?no:0)}function h0(e){const t=tt(e);return t<=og?t/og:t<=Math.PI?(Math.PI-t)/og:t<=1.5*Math.PI?(t-Math.PI)/og:(no-t)/og}function ty(e,t,i){const s=h0(i);return e*s+t*Math.abs(1-s)}function Po(e){return e?tt(mt(e)):0}var rg=class{constructor(){this.queue=[]}waitForCompletion(e=50){const t=this.queue;function i(s){function n(){clearTimeout(a),s(!0)}function o(){const r=t.indexOf(n);r<0||(t.splice(r,1),s(!1))}const a=setTimeout(o,e);t.push(n)}return new Promise(i)}notify(){for(const e of this.queue.splice(0))e()}};function iy(e=0){function t(i){setTimeout(i,e)}return new Promise(t)}function gl(e){return e==="true"}function gV(e){return Number(e)}function An(e){return e}var fV={role:An,"aria-checked":gl,"aria-controls":An,"aria-describedby":An,"aria-disabled":gl,"aria-expanded":gl,"aria-haspopup":An,"aria-hidden":gl,"aria-label":An,"aria-labelledby":An,"aria-live":An,"aria-orientation":An,"aria-selected":gl,"data-focus-override":gl,"data-focus-visible-override":gl,"data-preventdefault":gl,class:An,for:An,id:An,tabindex:gV,title:An,placeholder:An};function Fe(e,t,i){i==null||i===""||i===""?e?.removeAttribute(t):e?.setAttribute(t,i.toString())}function oo(e,t){if(t!=null)for(const[i,s]of ht(t))i!=="class"&&Fe(e,i,s)}function fl(e,t,i){if(!(e instanceof HTMLElement))return;const s=e.getAttribute(t);return s===null?i:fV[t]?.(s)??void 0}function Cn(e,t,i){e!=null&&(i==null?e.style.removeProperty(t):e.style.setProperty(t,i.toString()))}function d0(e,t){for(const[i,s]of ht(t))Cn(e,i,s)}function Bt(e,t){const i=Array.isArray(e)?e:e.split(".");if(i.length===1){const[s]=i;return sr((n,o,a)=>n[s]=a,n=>n[s],t)}return sr((s,n,o)=>Rm(s,i,o),s=>Em(s,i),t)}function XL(e){return sr((t,i,s)=>t[e]=s)}function kt(e,t){return sr((i,s,n)=>i[e][t??s]=n)}function He(e){const{newValue:t,oldValue:i,changeValue:s}=e;return sr((n,o,a,r)=>(a!==r&&(r!==void 0&&i?.call(n,r),a!==void 0&&t?.call(n,a),s?.call(n,a,r)),a))}function Wt(e){return Tm(e)}var cr=class extends K{constructor(e){super(),this.node=e,this.enabled=!1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=1}};g([He({changeValue(e){e?this.node.strokeWidth=this.strokeWidth:this.node.strokeWidth=0}}),m],cr.prototype,"enabled",2),g([kt("node","stroke"),m],cr.prototype,"stroke",2),g([kt("node","strokeOpacity"),m],cr.prototype,"strokeOpacity",2),g([He({changeValue(e){this.enabled?this.node.strokeWidth=e:this.node.strokeWidth=0}}),m],cr.prototype,"strokeWidth",2);function sy(e,t,i,s,n){return t<e.x+e.width&&t+s>e.x&&i<e.y+e.height&&i+n>e.y}function lg(e,t,i,s=0,n=0){return t>=e.x&&t+s<=e.x+e.width&&i>=e.y&&i+n<=e.y+e.height}function u0(e){return e==null||e.height===0||e.width===0||Number.isNaN(e.height)||Number.isNaN(e.width)}function cg(e,t){return e===t?!0:e==null||t==null?!1:e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function hr(e,t,i){if(e>t)return;let s;for(;t>=e;){const n=Math.floor((t+e)/2);i(n)?(s=n,e=n+1):t=n-1}return s}function Nc(e,t,i){if(e>t)return;let s;for(;t>=e;){const n=Math.floor((t+e)/2);i(n)?(s=n,t=n-1):e=n+1}return s}function ny(e,t,i){if(e>t)return;let s;for(;t>=e;){const n=Math.floor((t+e)/2),o=i(n);o==null?t=n-1:(s=o,e=n+1)}return s}function qL(e,t,i){if(e>t)return;let s;for(;t>=e;){const n=Math.floor((t+e)/2),o=i(n);o==null?e=n+1:(s=o,t=n-1)}return s}var Oc=(e,t,i)=>e*(1-i)+t*i,p0=e=>{const t=e<0?-1:1,i=Math.abs(e);return i<=.04045?e/12.92:t*((i+.055)/1.055)**2.4},g0=e=>{const t=e<0?-1:1,i=Math.abs(e);return i>.0031308?t*(1.055*i**(1/2.4)-.055):12.92*e},QL=class lt{constructor(t,i,s,n=1){this.r=ge(0,t||0,1),this.g=ge(0,i||0,1),this.b=ge(0,s||0,1),this.a=ge(0,n||0,1)}static validColorString(t){return t.includes("#")?!!lt.parseHex(t):t.includes("rgb")?!!lt.stringToRgba(t):lt.nameToHex.has(t.toLowerCase())}static fromString(t){if(t.includes("#"))return lt.fromHexString(t);const i=lt.nameToHex.get(t.toLowerCase());if(i)return lt.fromHexString(i);if(t.includes("rgb"))return lt.fromRgbaString(t);throw new Error(`Invalid color string: '${t}'`)}static parseHex(t){t=t.replaceAll(" ","").slice(1);let i;switch(t.length){case 6:case 8:i=[];for(let s=0;s<t.length;s+=2)i.push(Number.parseInt(`${t[s]}${t[s+1]}`,16));break;case 3:case 4:i=t.split("").map(s=>Number.parseInt(s,16)).map(s=>s+s*16);break}if(i?.length>=3&&i.every(s=>s>=0))return i.length===3&&i.push(255),i}static fromHexString(t){const i=lt.parseHex(t);if(i){const[s,n,o,a]=i;return new lt(s/255,n/255,o/255,a/255)}throw new Error(`Malformed hexadecimal color string: '${t}'`)}static stringToRgba(t){let i=-1,s=-1;for(let r=0;r<t.length;r++){const l=t[r];if(i===-1&&l==="(")i=r;else if(l===")"){s=r;break}}if(i===-1||s===-1)return;const o=t.substring(i+1,s).split(","),a=[];for(let r=0;r<o.length;r++){const l=o[r];let c=Number.parseFloat(l);if(!Number.isFinite(c))return;l.includes("%")?(c=ge(0,c,100),c/=100):r===3?c=ge(0,c,1):(c=ge(0,c,255),c/=255),a.push(c)}return a}static fromRgbaString(t){const i=lt.stringToRgba(t);if(i){if(i.length===3)return new lt(i[0],i[1],i[2]);if(i.length===4)return new lt(i[0],i[1],i[2],i[3])}throw new Error(`Malformed rgb/rgba color string: '${t}'`)}static fromArray(t){if(t.length===4)return new lt(t[0],t[1],t[2],t[3]);if(t.length===3)return new lt(t[0],t[1],t[2]);throw new Error("The given array should contain 3 or 4 color components (numbers).")}static fromHSB(t,i,s,n=1){const o=lt.HSBtoRGB(t,i,s);return new lt(o[0],o[1],o[2],n)}static fromHSL(t,i,s,n=1){const o=lt.HSLtoRGB(t,i,s);return new lt(o[0],o[1],o[2],n)}static fromOKLCH(t,i,s,n=1){const o=lt.OKLCHtoRGB(t,i,s);return new lt(o[0],o[1],o[2],n)}static padHex(t){return t.length===1?"0"+t:t}toHexString(){let t="#"+lt.padHex(Math.round(this.r*255).toString(16))+lt.padHex(Math.round(this.g*255).toString(16))+lt.padHex(Math.round(this.b*255).toString(16));return this.a<1&&(t+=lt.padHex(Math.round(this.a*255).toString(16))),t}toRgbaString(t=3){const i=[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255)],s=Math.pow(10,t);return this.a!==1?(i.push(Math.round(this.a*s)/s),`rgba(${i.join(", ")})`):`rgb(${i.join(", ")})`}toString(){return this.a===1?this.toHexString():this.toRgbaString()}toHSB(){return lt.RGBtoHSB(this.r,this.g,this.b)}static RGBtoOKLCH(t,i,s){const n=p0(t),o=p0(i),a=p0(s),r=Math.cbrt(.4122214708*n+.5363325363*o+.0514459929*a),l=Math.cbrt(.2119034982*n+.6806995451*o+.1073969566*a),c=Math.cbrt(.0883024619*n+.2817188376*o+.6299787005*a),h=.2104542553*r+.793617785*l-.0040720468*c,d=1.9779984951*r-2.428592205*l+.4505937099*c,u=.0259040371*r+.7827717662*l-.808675766*c,p=Math.atan2(u,d)*180/Math.PI,f=h,y=Math.hypot(d,u),b=p>=0?p:p+360;return[f,y,b]}static OKLCHtoRGB(t,i,s){const n=t,o=i*Math.cos(s*Math.PI/180),a=i*Math.sin(s*Math.PI/180),r=(n+.3963377774*o+.2158037573*a)**3,l=(n-.1055613458*o-.0638541728*a)**3,c=(n-.0894841775*o-1.291485548*a)**3,h=4.0767416621*r-3.3077115913*l+.2309699292*c,d=-1.2684380046*r+2.6097574011*l-.3413193965*c,u=-.0041960863*r-.7034186147*l+1.707614701*c,p=g0(h),f=g0(d),y=g0(u);return[p,f,y]}static RGBtoHSL(t,i,s){const n=Math.min(t,i,s),o=Math.max(t,i,s),a=(o+n)/2;let r,l;if(o===n)r=0,l=0;else{const c=o-n;l=a>.5?c/(2-o-n):c/(o+n),o===t?r=(i-s)/c+(i<s?6:0):o===i?r=(s-t)/c+2:r=(t-i)/c+4,r*=360/6}return[r,l,a]}static HSLtoRGB(t,i,s){if(t=(t%360+360)%360,i===0)return[s,s,s];const n=s<.5?s*(1+i):s+i-s*i,o=2*s-n;function a(h){return h<0&&(h+=1),h>1&&(h-=1),h<1/6?o+(n-o)*6*h:h<1/2?n:h<2/3?o+(n-o)*(2/3-h)*6:o}const r=a(t/360+1/3),l=a(t/360),c=a(t/360-1/3);return[r,l,c]}static RGBtoHSB(t,i,s){const n=Math.min(t,i,s),o=Math.max(t,i,s),a=o===0?0:(o-n)/o;let r=0;if(n!==o){const l=o-n,c=(o-t)/l,h=(o-i)/l,d=(o-s)/l;t===o?r=d-h:i===o?r=2+c-d:r=4+h-c,r/=6,r<0&&(r=r+1)}return[r*360,a,o]}static HSBtoRGB(t,i,s){t=(t%360+360)%360/360;let n=0,o=0,a=0;if(i===0)n=o=a=s;else{const r=(t-Math.floor(t))*6,l=r-Math.floor(r),c=s*(1-i),h=s*(1-i*l),d=s*(1-i*(1-l));switch(Math.trunc(r)){case 0:n=s,o=d,a=c;break;case 1:n=h,o=s,a=c;break;case 2:n=c,o=s,a=d;break;case 3:n=c,o=h,a=s;break;case 4:n=d,o=c,a=s;break;case 5:n=s,o=c,a=h;break}}return[n,o,a]}static mix(t,i,s){return new lt(Oc(t.r,i.r,s),Oc(t.g,i.g,s),Oc(t.b,i.b,s),Oc(t.a,i.a,s))}static lighten(t,i){const s=lt.RGBtoOKLCH(t.r,t.g,t.b);return lt.fromOKLCH(ge(0,s[0]+i,1),s[1],s[2])}static darken(t,i){const s=lt.RGBtoOKLCH(t.r,t.g,t.b);return lt.fromOKLCH(ge(0,s[0]-i,1),s[1],s[2])}static interpolate(t,i){const s=1/(t.length-1),n=t.map(o=>lt.RGBtoOKLCH(o.r,o.g,o.b));return Array.from({length:i},(o,a)=>{const r=a/(i-1),l=t.length<=2?0:Math.min(Math.floor(r*(t.length-1)),t.length-2),c=(r-l*s)/s,h=n[l],d=n[l+1];return lt.fromOKLCH(Oc(h[0],d[0],c),Oc(h[1],d[1],c),Oc(h[2],d[2],c))})}};QL.nameToHex=new Map([["aliceblue","#F0F8FF"],["antiquewhite","#FAEBD7"],["aqua","#00FFFF"],["aquamarine","#7FFFD4"],["azure","#F0FFFF"],["beige","#F5F5DC"],["bisque","#FFE4C4"],["black","#000000"],["blanchedalmond","#FFEBCD"],["blue","#0000FF"],["blueviolet","#8A2BE2"],["brown","#A52A2A"],["burlywood","#DEB887"],["cadetblue","#5F9EA0"],["chartreuse","#7FFF00"],["chocolate","#D2691E"],["coral","#FF7F50"],["cornflowerblue","#6495ED"],["cornsilk","#FFF8DC"],["crimson","#DC143C"],["cyan","#00FFFF"],["darkblue","#00008B"],["darkcyan","#008B8B"],["darkgoldenrod","#B8860B"],["darkgray","#A9A9A9"],["darkgreen","#006400"],["darkgrey","#A9A9A9"],["darkkhaki","#BDB76B"],["darkmagenta","#8B008B"],["darkolivegreen","#556B2F"],["darkorange","#FF8C00"],["darkorchid","#9932CC"],["darkred","#8B0000"],["darksalmon","#E9967A"],["darkseagreen","#8FBC8F"],["darkslateblue","#483D8B"],["darkslategray","#2F4F4F"],["darkslategrey","#2F4F4F"],["darkturquoise","#00CED1"],["darkviolet","#9400D3"],["deeppink","#FF1493"],["deepskyblue","#00BFFF"],["dimgray","#696969"],["dimgrey","#696969"],["dodgerblue","#1E90FF"],["firebrick","#B22222"],["floralwhite","#FFFAF0"],["forestgreen","#228B22"],["fuchsia","#FF00FF"],["gainsboro","#DCDCDC"],["ghostwhite","#F8F8FF"],["gold","#FFD700"],["goldenrod","#DAA520"],["gray","#808080"],["green","#008000"],["greenyellow","#ADFF2F"],["grey","#808080"],["honeydew","#F0FFF0"],["hotpink","#FF69B4"],["indianred","#CD5C5C"],["indigo","#4B0082"],["ivory","#FFFFF0"],["khaki","#F0E68C"],["lavender","#E6E6FA"],["lavenderblush","#FFF0F5"],["lawngreen","#7CFC00"],["lemonchiffon","#FFFACD"],["lightblue","#ADD8E6"],["lightcoral","#F08080"],["lightcyan","#E0FFFF"],["lightgoldenrodyellow","#FAFAD2"],["lightgray","#D3D3D3"],["lightgreen","#90EE90"],["lightgrey","#D3D3D3"],["lightpink","#FFB6C1"],["lightsalmon","#FFA07A"],["lightseagreen","#20B2AA"],["lightskyblue","#87CEFA"],["lightslategray","#778899"],["lightslategrey","#778899"],["lightsteelblue","#B0C4DE"],["lightyellow","#FFFFE0"],["lime","#00FF00"],["limegreen","#32CD32"],["linen","#FAF0E6"],["magenta","#FF00FF"],["maroon","#800000"],["mediumaquamarine","#66CDAA"],["mediumblue","#0000CD"],["mediumorchid","#BA55D3"],["mediumpurple","#9370DB"],["mediumseagreen","#3CB371"],["mediumslateblue","#7B68EE"],["mediumspringgreen","#00FA9A"],["mediumturquoise","#48D1CC"],["mediumvioletred","#C71585"],["midnightblue","#191970"],["mintcream","#F5FFFA"],["mistyrose","#FFE4E1"],["moccasin","#FFE4B5"],["navajowhite","#FFDEAD"],["navy","#000080"],["oldlace","#FDF5E6"],["olive","#808000"],["olivedrab","#6B8E23"],["orange","#FFA500"],["orangered","#FF4500"],["orchid","#DA70D6"],["palegoldenrod","#EEE8AA"],["palegreen","#98FB98"],["paleturquoise","#AFEEEE"],["palevioletred","#DB7093"],["papayawhip","#FFEFD5"],["peachpuff","#FFDAB9"],["peru","#CD853F"],["pink","#FFC0CB"],["plum","#DDA0DD"],["powderblue","#B0E0E6"],["purple","#800080"],["rebeccapurple","#663399"],["red","#FF0000"],["rosybrown","#BC8F8F"],["royalblue","#4169E1"],["saddlebrown","#8B4513"],["salmon","#FA8072"],["sandybrown","#F4A460"],["seagreen","#2E8B57"],["seashell","#FFF5EE"],["sienna","#A0522D"],["silver","#C0C0C0"],["skyblue","#87CEEB"],["slateblue","#6A5ACD"],["slategray","#708090"],["slategrey","#708090"],["snow","#FFFAFA"],["springgreen","#00FF7F"],["steelblue","#4682B4"],["tan","#D2B48C"],["teal","#008080"],["thistle","#D8BFD8"],["tomato","#FF6347"],["transparent","#00000000"],["turquoise","#40E0D0"],["violet","#EE82EE"],["wheat","#F5DEB3"],["white","#FFFFFF"],["whitesmoke","#F5F5F5"],["yellow","#FFFF00"],["yellowgreen","#9ACD32"]]);var Be=QL;function f0(e=0,t=0){return new OffscreenCanvas(e,t).getContext("2d")}var JL=class{constructor(e){this.getter=e}get(){return this.result??(this.result=this.getter()),this.result}clear(){this.result=void 0}},m0=class{constructor(e){this.getter=e}get(){let e=this.result?.deref();return e||(e=this.getter(),this.result=new WeakRef(e),e)}clear(){this.result=void 0}};function oy(e,t){return e.valueOf()-t.valueOf()}function mV(e){let t=Number.NaN;const i=[];for(const s of e){const n=s.valueOf();t!==n&&i.push(s),t=n}return i}function ay(e){const t=e.slice().sort(oy);return ry(t)==null?mV(t):t}function ry(e){if(e.length===0)return 1;const t=Number(e.at(-1))>Number(e[0])?1:-1;let i=-1/0*t;for(const s of e){const n=s.valueOf();if(Math.sign(n-i)!==t)return;i=n}return t}function ly(){return(e,t)=>{const i=[`Property [${e}] is deprecated.`,t].filter(Boolean).join(" ");j.warnOnce(i)}}function ew(e,t){const i=ly(),s=t?.default;return sr((n,o,a)=>(a!==s&&i(o.toString(),e),a))}function tw(e,t){const i=ly();return sr((s,n,o)=>(o!==s[e]&&(i(n.toString(),`Use [${e}] instead.`),Rm(s,e,t?t(o):o)),Wp),(s,n)=>(i(n.toString(),`Use [${e}] instead.`),Em(s,e)))}function y0(e,t){const i=Math.max(e.length,t.length),s=new Set,n=new Set;for(let o=0;o<i;o++){const a=e[o],r=t[o];a!==r&&(n.has(r)?n.delete(r):r&&s.add(r),s.has(a)?s.delete(a):a&&n.add(a))}return{changed:s.size>0||n.size>0,added:s,removed:n}}function hg(e,t,i,s){const n=e-i,o=t-s;return n*n+o*o}function dr(e,t,i,s,n,o,a){if(i===n&&s===o)return Math.min(a,hg(e,t,i,s));const r=n-i,l=o-s,c=Math.max(0,Math.min(1,((e-i)*r+(t-s)*l)/(r*r+l*l))),h=i+c*r,d=s+c*l;return Math.min(a,hg(e,t,h,d))}function iw(e,t,i,s,n,o,a,r,l){r&&([a,o]=[o,a]);const c=Math.atan2(t-s,e-i);if(!Us(c,o,a)){const d=i+Math.cos(o)*n,u=s+Math.sin(o)*n,p=i+Math.cos(o)*n,f=s+Math.sin(o)*n;return Math.min(l,hg(e,t,d,u),hg(e,t,p,f))}const h=n-Math.sqrt(hg(e,t,i,s));return Math.min(l,h*h)}function Ro(e,t){if(e.length===0)return null;if(t!==void 0){const o=e.at(0),a=e.at(-1),r=o instanceof Date?o.getTime():o,l=a instanceof Date?a.getTime():a;if(typeof r=="number"&&typeof l=="number")return t===1?[r,l]:[l,r]}let i=1/0,s=-1/0;for(const o of e){const a=o instanceof Date?o.getTime():o;typeof a=="number"&&(a<i&&(i=a),a>s&&(s=a))}const n=[i,s];return n.every(Number.isFinite)?n:null}function Ec(e,t,i,s,n,o,a){let r=!1;const l=Ro(e,a),c=l&&o?[o(l[0]),o(l[1])]:l;if(c==null){let u;return t!=null&&i!=null&&t<=i?u=[t,i]:s!=null&&n!=null&&s<=n&&(u=[s,n]),{extent:u??[],clipped:!1}}let[h,d]=c;return t!=null?(r||(r=t>h),h=t):s!=null&&s<h&&(h=s),i!=null?(r||(r=i<d),d=i):n!=null&&n>d&&(d=n),h>d?{extent:[],clipped:!1}:{extent:[h,d],clipped:r}}function dg(e,t,i,s,n){const{extent:o,clipped:a}=Ec(e.domain,gt(t)?new Date(t):t,gt(i)?new Date(i):i,gt(s)?new Date(s):s,gt(n)?new Date(n):n,r=>new Date(r),e.sortMetadata?.sortOrder);return{extent:o.map(r=>new Date(r)),clipped:a}}var yV=new Intl.NumberFormat("en-US",{style:"percent"});function ao(e,t=2){return typeof e=="number"?b0(e,t):typeof e=="string"?e:String(e??"")}function x0(e){return yV.format(e)}var sw=new Map().set(2,new Intl.NumberFormat("en-US",{maximumFractionDigits:2,useGrouping:!1}));function b0(e,t){let i=sw.get(t);return i||(i=new Intl.NumberFormat("en-US",{maximumFractionDigits:t,useGrouping:!1}),sw.set(t,i)),i.format(e)}function nw(e){return Array.isArray(e)&&e.length>=2&&e.every($e)}function cy(e){return Array.isArray(e)&&e.length>=2&&e.every(nw)}function xV(e){const t=e[0],i=e.at(-1);return i===void 0?!1:qe(t[0],i[0],.001)&&qe(t[1],i[1],.001)}function ow(e){return Array.isArray(e)&&e.every(cy)&&e.every(xV)}function aw(e){if(e===null)return!0;if(!fe(e)||e.type==null)return!1;const{type:t,coordinates:i}=e;switch(t){case"GeometryCollection":return Array.isArray(e.geometries)&&e.geometries.every(aw);case"MultiPolygon":return Array.isArray(i)&&i.every(ow);case"Polygon":return ow(i);case"MultiLineString":return Array.isArray(i)&&i.every(cy);case"LineString":return cy(i);case"MultiPoint":return cy(i);case"Point":return nw(i);default:return!1}}function bV(e){return fe(e)&&e.type==="Feature"&&aw(e.geometry)}function vV(e){return fe(e)&&e.type==="FeatureCollection"&&Array.isArray(e.features)&&e.features.every(bV)}var ml=Ge(vV,"a GeoJSON object"),v0=class{constructor(e,t,i){this._vertexCount=0,this._edgeCount=0,this.pendingProcessingEdgesFrom=[],this.pendingProcessingEdgesTo=[],this.cachedNeighboursEdge=e,this.processedEdge=t,this.singleValueEdges=i}clear(){this._vertexCount=0,this._edgeCount=0,this.pendingProcessingEdgesFrom=[],this.pendingProcessingEdgesTo=[],this.singleValueEdges?.clear()}getVertexCount(){return this._vertexCount}getEdgeCount(){return this._edgeCount}addVertex(e){const t=new S0(e);return this._vertexCount++,t}addEdge(e,t,i){i===this.cachedNeighboursEdge?e.updateCachedNeighbours().set(t.value,t):i===this.processedEdge&&(this.pendingProcessingEdgesFrom.push(e),this.pendingProcessingEdgesTo.push(t));const{edges:s}=e,n=s.get(i);n?n.includes(t)||(this.singleValueEdges?.has(i)?s.set(i,[t]):(n.push(t),this._edgeCount++)):(s.set(i,[t]),this._edgeCount++)}removeVertex(e){this._vertexCount--;const t=e.edges;if(t){for(const[,i]of t)this._vertexCount-=i.length;e.clear()}}removeEdge(e,t,i){const s=e.edges.get(i);if(!s)return;const n=s.indexOf(t);n!==-1&&(s.splice(n,1),s.length===0&&e.edges.delete(i),this._edgeCount--,i===this.cachedNeighboursEdge&&e.readCachedNeighbours()?.delete(t.value))}removeEdges(e,t){e.edges.delete(t)}getVertexValue(e){return e.value}*neighbours(e){for(const[,t]of e.edges)for(const i of t)yield i}*neighboursAndEdges(e){for(const[t,i]of e.edges)for(const s of i)yield[s,t]}neighboursWithEdgeValue(e,t){return e.edges.get(t)}findNeighbour(e,t){return e.edges.get(t)?.[0]}findNeighbourValue(e,t){const i=this.findNeighbour(e,t);if(i)return this.getVertexValue(i)}findNeighbourWithValue(e,t,i){const s=i==null?this.neighbours(e):this.neighboursWithEdgeValue(e,i);if(s){for(const n of s)if(this.getVertexValue(n)===t)return n}}findVertexAlongEdge(e,t,i){if(i===this.cachedNeighboursEdge){let n;for(const o of t)if(n=(n??e).readCachedNeighbours()?.get(o),!n)return;return n}if(t.length===0)return;let s=e;for(const n of t){const o=s?this.neighboursWithEdgeValue(s,i):void 0;if(!o)return;s=o.find(a=>a.value===n)}return s}adjacent(e,t){for(const[,i]of e.edges)if(i.includes(t))return!0;return!1}},S0=class{constructor(e){this.value=e,this.edges=new Map}readCachedNeighbours(){return this._cachedNeighbours}updateCachedNeighbours(){return this._cachedNeighbours??(this._cachedNeighbours=new Map),this._cachedNeighbours}clear(){this.edges.clear(),this._cachedNeighbours?.clear()}},M0="class-instance";function Ln(e,t,i){if(Ce(t)){if(!Ce(e)||e.length!==t.length||t.some((s,n)=>Ln(e[n],s,i)!=null))return t}else if(st(t)){if(!st(e))return t;const s={},n=new Set([...Object.keys(e),...Object.keys(t)]);for(const o of n)if(e[o]!==t[o])if(i?.has(o))s[o]=t[o];else if(typeof e[o]==typeof t[o]){const a=Ln(e[o],t[o],i);a!==null&&(s[o]=a)}else s[o]=t[o];return Object.keys(s).length?s:null}else if(e!==t)return t;return null}function D0(e,t){for(const i of Object.keys(e))if(e[i]!==t?.[i])return!1;return!0}function Re(e,t){return Ce(e)?SV(e,t):st(e)?MV(e,t):e instanceof Map?new Map(Re(Array.from(e))):yl(e)}function SV(e,t){const i=[],s=t?.seen;for(const n of e){if(typeof n=="object"&&s?.includes(n)){j.warn("cycle detected in array",n);continue}s?.push(n),i.push(Re(n,t)),s?.pop()}return i}function MV(e,t){const i={};for(const s of Object.keys(e))t?.assign?.has(s)?i[s]=e[s]:t?.shallow?.has(s)?i[s]=yl(e[s]):i[s]=Re(e[s],t);return i}function yl(e){return Ce(e)?e.slice(0):st(e)?{...e}:Is(e)?new Date(e):bS(e)?new RegExp(e.source,e.flags):e}function ya(e,t,i,s,n,o){if(Ce(e)){o=t(e,s,n,o);let a=0;for(const r of e)o=ya(r,t,i,s?.[a],n,o),a++}else if(st(e)){o=t(e,s,n,o);for(const a of Object.keys(e)){if(i?.has(a))continue;const r=e[a];o=ya(r,t,i,s?.[a],n,o)}}return o}function wd(e,t,i={}){const{path:s,matcherPath:n=s?.replace(/(\[[0-9+]+])/i,"[]"),skip:o=[]}=i;if(e==null)throw new Error(`AG Charts - target is uninitialised: ${s??"<root>"}`);if(t==null)return e;if(wc(e))return e.set(t);const a=e,r=I0(e);for(const l of Object.keys(t)){if(Pm.has(l))continue;const c=`${n?n+".":""}${l}`;if(o.includes(c))continue;const h=t[l],d=`${s?s+".":""}${l}`,u=a.constructor,p=a[l];try{const f=I0(p),y=I0(h);if(r===M0&&!(l in e||l==="context")){if(h===void 0)continue;j.warn(`unable to set [${d}] in ${u?.name} - property is unknown`);continue}if(f!=null&&y!=null&&y!==f&&(f!==M0||y!=="object")){j.warn(`unable to set [${d}] in ${u?.name} - can't apply type of [${y}], allowed types are: [${f}]`);continue}if(wc(p))h===void 0?p.clear():p.set(h);else if(y==="object"&&l!=="context"){if(!(l in a)){j.warn(`unable to set [${d}] in ${u?.name} - property is unknown`);continue}p==null?a[l]=h:wd(p,h,{...i,path:d,matcherPath:c})}else a[l]=h}catch(f){j.warn(`unable to set [${d}] in [${u?.name}]; nested error is: ${f.message}`)}}return e}function I0(e){return e==null?null:vS(e)||Is(e)?"primitive":Ce(e)?"array":fe(e)?st(e)?"object":M0:Co(e)?"function":"primitive"}function hy(e,t,i=["Escape"]){return ot(e,"keydown",s=>{dy(s,...i)&&t(s)})}function k0(e,t){const i=ot(Ve(),"mousedown",s=>{[0,2].includes(s.button)&&!rw(e,s)&&(t(),i())});return i}function A0(e,t){const i=ot(Ve(),"touchstart",s=>{Array.from(s.targetTouches).some(o=>!rw(e,o))&&(t(),i())});return i}function rw(e,t){return t.target instanceof Element&&t.target.shadowRoot!=null?!0:t.target instanceof Node&&e.contains(t.target)}function C0(e,t,i){const s=n=>{for(const o of t)Fe(o,"data-focus-visible-override",n)};return s(i),ot(e,"keydown",()=>s(!0),{once:!0})}function Td(e){return!(e.shiftKey||e.altKey||e.ctrlKey||e.metaKey)}function dy(e,...t){return Td(e)&&t.includes(e.key)}function lw(e,t,i){return ot(e,"keydown",s=>{dy(s,i)&&t.focus()})}var Nd={horizontal:{nextKey:"ArrowRight",prevKey:"ArrowLeft"},vertical:{nextKey:"ArrowDown",prevKey:"ArrowUp"}};function uy(e){const{orientation:t,buttons:i,wrapAround:s=!1,onEscape:n,onFocus:o,onBlur:a}=e,{nextKey:r,prevKey:l}=Nd[t],c=p=>{if(p.target&&"tabIndex"in p.target){for(const f of i)f.tabIndex=-1;p.target.tabIndex=0}},[h,d]=s?[i.length,i.length]:[0,1/0],u=new pt;for(let p=0;p<i.length;p++){const f=i[(h+p-1)%d],y=i[p],b=i[(h+p+1)%d];u.register(ot(y,"focus",c),o&&ot(y,"focus",o),a&&ot(y,"blur",a),n&&hy(y,n),f&&lw(y,f,l),b&&lw(y,b,r),ot(y,"keydown",x=>{dy(x,r,l)&&x.preventDefault()})),y.tabIndex=p===0?0:-1}return u}function cw(e,t){return i=>{if(e.ariaDisabled==="true")return i.preventDefault();t(i)}}function py(e){return"button"in e?e.button===0:Td(e)&&(e.code==="Space"||e.key==="Enter")}function gy(e){if(e?.target instanceof HTMLElement&&"tabindex"in e.target.attributes)return e.target}function L0(e){return ot(e,"keydown",t=>{if(t.defaultPrevented)return;fl(t.target,"data-preventdefault",!0)&&dy(t,"ArrowRight","ArrowLeft","ArrowDown","ArrowUp")&&t.preventDefault()})}var w0=new Map,hw=1;function dw(){w0.clear(),hw=1}function Mi(e){const t=e.constructor;let i=Object.hasOwn(t,"className")?t.className:t.name;Me.inDevelopmentMode(()=>{if(!i)throw new Error(`The ${String(t)} is missing the 'className' property.`)}),i??(i="Unknown");const s=(w0.get(i)??0)+1;return w0.set(i,s),`${i}-${s}`}function ur(){return`ag-charts-${hw++}`}function Od(){return crypto.randomUUID?.()??DV()}function DV(){const e=new Uint8Array(16);crypto.getRandomValues(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let t="";for(let i=0;i<e.length;i++)(i===4||i===6||i===8||i===10)&&(t+="-"),t+=e[i].toString(16).padStart(2,"0");return t}function fy(e,t,i){let s=e,n=s;for(const o of t)if(s==null||i(s.value,o)>0)s={value:o,next:s},n=s;else{for(n=n;n.next!=null&&i(n.next.value,o)<=0;)n=n.next;n.next={value:o,next:n.next}}return s}var ug=new WeakMap;function Ed(e,t){const i=JSON.stringify(e,null,0);return ug.has(t)||ug.set(t,new Map),ug.get(t)?.has(i)||ug.get(t)?.set(i,t(e)),ug.get(t)?.get(i)}var T0=class{constructor(){this.weak=new WeakMap,this.strong=new Map,this.set=!1,this.value=void 0}};function pr(e,t){let i=new T0;const s=(...n)=>{let o=i;for(const a of n){const r=typeof a=="object"||typeof a=="symbol"?o.weak:o.strong;let l=r.get(a);l==null&&(l=new T0,r.set(a,l)),o=l}if(o.set)return t?.("hit",e,n),o.value;{const a=e(...n);return o.set=!0,o.value=a,t?.("miss",e,n),a}};return s.reset=()=>{i=new T0},s}function ji(e,t){const i=new Map,s=(...a)=>a.map(r=>typeof r=="object"||typeof r=="symbol"?r:(i.has(r)||i.set(r,{v:r}),i.get(r))),n={},o=new WeakMap;return(...a)=>{const r=a.length===0?[n]:s(...a);let l=o;for(const d of r.slice(0,-1))l.has(d)||l.set(d,new WeakMap),l=l.get(d);const c=r.at(-1);let h=l.get(c);return h?t?.("hit",e,a):(h=e(...a),l.set(c,h),t?.("miss",e,a)),h}}function Pd(e,t,i,s=1/0){const n={nearest:void 0,distanceSquared:s};for(const o of i){const a=o.distanceSquared(e,t);if(a===0)return{nearest:o,distanceSquared:0};a<n.distanceSquared&&(n.nearest=o,n.distanceSquared=a)}return n}function N0(e,t,i,s=1/0){const{x:n=e,y:o=t}=i.transformPoint?.(e,t)??{},a={nearest:void 0,distanceSquared:s};for(const r of i.children){const{nearest:l,distanceSquared:c}=r.nearestSquared(n,o,a.distanceSquared);if(c===0)return{nearest:l,distanceSquared:c};c<a.distanceSquared&&(a.nearest=l,a.distanceSquared=c)}return a}var gr=class extends K{constructor(e=0,t=e,i=e,s=t){super(),this.top=e,this.right=t,this.bottom=i,this.left=s}};g([m],gr.prototype,"top",2),g([m],gr.prototype,"right",2),g([m],gr.prototype,"bottom",2),g([m],gr.prototype,"left",2);function my(e,t,i,s){let{top:n,right:o,bottom:a,left:r,width:l,height:c}=s;return r!=null?l!=null?o=i.width-r+l:o!=null&&(l=i.width-r-o):o!=null&&l!=null&&(r=i.width-o-l),n!=null?c!=null?a=i.height-n-c:a!=null&&(c=i.height-a-n):a!=null&&c!=null&&(n=i.height-a-c),l==null?c==null?(c=t,l=e):l=Math.ceil(e*c/t):c??(c=Math.ceil(t*l/e)),r==null&&(o==null?r=Math.floor((i.width-l)/2):r=i.width-o-l),n==null&&(a==null?n=Math.floor((i.height-c)/2):n=i.height-c-a),{x:r,y:n,width:l,height:c}}var O0="color: green",E0="color: grey";function it(){return Tm(()=>{})}function P0(e,t){const i=nr(t);if(i.length===0)return;const s=HS(e);for(const n of i)n in s&&(t[n]=s[n])}var uw=class{transitionRoot(e,t){this.parent?this.parent.transitionRoot(e,t):this.transition(e,t)}},R0=class xn extends uw{constructor(t,i,s){super(),this.defaultState=t,this.states=i,this.enterEach=s,this.debug=Me.create(!0,"animation"),this.state=t,this.debug(`%c${this.constructor.name} | init -> ${t}`,O0)}transition(t,i){if(!this.transitionChild(t,i)||this.state===xn.child||this.state===xn.parent)return;const n=this.state,o=this.states[this.state];let a=o[t];const r=`%c${this.constructor.name} | ${this.state} -> ${t} ->`;if(Array.isArray(a))a=a.find(h=>{if(!h.guard)return!0;const d=h.guard(i);return d||this.debug(`${r} (guarded)`,h.target,E0),d});else if(typeof a=="object"&&!(a instanceof xn)&&a.guard&&!a.guard(i)){this.debug(`${r} (guarded)`,a.target,E0);return}if(!a){this.debug(`${r} ${this.state}`,E0);return}const l=this.getDestinationState(a),c=l===this.state?void 0:o.onExit;this.debug(`${r} ${l}`,O0),this.state=l,typeof a=="function"?a(i):typeof a=="object"&&!(a instanceof xn)&&a.action?.(i),c?.(),this.enterEach?.(n,l),l!==n&&l!==xn.child&&l!==xn.parent&&this.states[l].onEnter?.(n,i)}transitionAsync(t,i){setTimeout(()=>{this.transition(t,i)},0)}is(t){return this.state===xn.child&&this.childState?this.childState.is(t):this.state===t}resetHierarchy(){this.debug(`%c${this.constructor.name} | ${this.state} -> [resetHierarchy] -> ${this.defaultState}`,"color: green"),this.state=this.defaultState}transitionChild(t,i){return this.state!==xn.child||!this.childState||(P0(this,this.childState),this.childState.transition(t,i),!this.childState.is(xn.parent))?!0:(this.debug(`%c${this.constructor.name} | ${this.state} -> ${t} -> ${this.defaultState}`,O0),this.state=this.defaultState,this.states[this.state].onEnter?.(),this.childState.resetHierarchy(),!1)}getDestinationState(t){let i=this.state;return typeof t=="string"?i=t:t instanceof xn?(this.childState=t,this.childState.parent=this,i=xn.child):typeof t=="object"&&(t.target instanceof xn?(this.childState=t.target,this.childState.parent=this,i=xn.child):t.target!=null&&(i=t.target)),i}};R0.child="__child",R0.parent="__parent";var he=R0,F0=class extends uw{constructor(...e){super(),this.stateMachines=e;for(const t of e)t.parent=this}transition(e,t){for(const i of this.stateMachines)P0(this,i),i.transition(e,t)}transitionAsync(e,t){for(const i of this.stateMachines)P0(this,i),i.transitionAsync(e,t)}},yy=class{constructor(e,t){this.ctx=e,this.measureTextCached=t,this.baselineMap=new Map,this.charMap=new Map,this.lineHeightCache=null}baselineDistance(e){if(e==="alphabetic")return 0;if(this.baselineMap.has(e))return this.baselineMap.get(e);this.ctx.textBaseline=e;const{alphabeticBaseline:t}=this.ctx.measureText("");return this.baselineMap.set(e,t),this.ctx.textBaseline="alphabetic",t}lineHeight(){return this.lineHeightCache??(this.lineHeightCache=this.measureText("").height),this.lineHeightCache}measureText(e){const t=this.measureTextCached?.(e)??this.ctx.measureText(e),{width:i,fontBoundingBoxAscent:s=t.emHeightAscent,fontBoundingBoxDescent:n=t.emHeightDescent}=t,o=s+n;return{width:i,height:o,ascent:s,descent:n}}measureLines(e){const t=typeof e=="string"?e.split(Ya):e;let i=0,s=0;const n=t.map(o=>{const a=this.measureText(o);return i<a.width&&(i=a.width),s+=a.height,{text:o,...a}});return{width:i,height:s,lineMetrics:n}}textWidth(e,t){if(t){let i=0;for(let s=0;s<e.length;s++)i+=this.textWidth(e.charAt(s));return i}return e.length>1?this.ctx.measureText(e).width:this.charMap.get(e)??this.charWidth(e)}charWidth(e){const{width:t}=this.ctx.measureText(e);return this.charMap.set(e,t),t}},z0=new wp(50);function Ze(e){typeof e=="object"&&(e=fm(e));let t=z0.get(e);if(t)return t;const i=new wp(1e4),s=f0();return s.font=e,t=new yy(s,n=>{let o=i.get(n);return o||(o=s.measureText(n),i.set(n,o),o)}),z0.set(e,t),t}Ze.clear=()=>z0.clear();function Ks(e,t){let i={segments:[],width:0,height:0,ascent:0,descent:0};const s=[i];for(const a of e){const{text:r,fontSize:l=t.fontSize,fontStyle:c=t.fontStyle,fontWeight:h=t.fontWeight,fontFamily:d=t.fontFamily,...u}=a,p={fontSize:l,fontStyle:c,fontWeight:h,fontFamily:d},f=Ze(p),y=Dt(r).split(Ya);for(let b=0;b<y.length;b++){const x=y[b],v=f.measureText(x);b>0&&(i={segments:[],width:0,height:0,ascent:0,descent:0},s.push(i)),x&&(i.width+=v.width,i.ascent=Math.max(i.ascent,v.ascent),i.descent=Math.max(i.descent,v.descent),i.height=Math.max(i.height,i.ascent+i.descent),i.segments.push({...p,...u,text:x,textMetrics:v}))}}let n=0,o=0;for(const a of s)n=Math.max(n,a.width),o+=a.height;return{width:n,height:o,lineMetrics:s}}function pw(e,t){return t.overflow==="hide"&&e.some(sl)}function Rd(e,t){return Ce(e)?by(e,t):Fd(Dt(e),t).join(`
`)}function xa(e,t){return Fd(e,t).join(`
`)}function Fd(e,t){return xy(e,t)}function xl(e,t,i,s){const n=t.textWidth(od);let o=0,a=0;for(;a<e.length;a++){const r=t.textWidth(e.charAt(a));if(o+r>i)break;o+=r}if(e.length===a&&(!s||o+n<=i))return s?mm(e):e;for(e=e.slice(0,a).trimEnd();e.length&&t.textWidth(e)+n>i;)e=e.slice(0,-1).trimEnd();return mm(e)}function xy(e,t,i=0){const s=e.split(Ya),n=Ze(t.font),o=[];if(t.textWrap==="never"){for(const c of s){const h=xl(c.trimEnd(),n,Math.max(0,t.maxWidth-i));if(!h)break;o.push(h),i=0}return pw(o,t)?[]:o}const a=t.textWrap==="hyphenate",r=t.textWrap==null||t.textWrap==="on-space";for(const c of s){let h=c.trimEnd();if(h===""){o.push(h);continue}let d=0,u=0,p=0;for(o.length||(u=i);d<h.length;){const f=h.charAt(d);if(f===" "&&(p=d),u+=n.textWidth(f),u>t.maxWidth){if(d===0){h="";break}let y=n.textWidth(h.slice(0,d+1));if(o.length||(y+=i),y<=t.maxWidth){u=y,d++;continue}if(p){const v=IV(h,p+1),S=n.textWidth(v);if(S<=t.maxWidth){o.push(h.slice(0,p).trimEnd()),h=h.slice(p).trimStart(),d=0,u=0,p=0;continue}else r&&S>t.maxWidth&&o.push(h.slice(0,p).trimEnd(),xl(h.slice(p).trimStart(),n,t.maxWidth,!0))}else if(r){const v=xl(h,n,t.maxWidth,!0);v&&o.push(v)}if(r){h="";break}const b=a?"-":"";let x=h.slice(0,d).trim();for(;x.length&&n.textWidth(x+b)>t.maxWidth;)x=x.slice(0,-1).trimEnd();if(x&&x!==ad)o.push(x+b);else{h="";break}h=h.slice(x.length).trimStart(),d=-1,u=0,p=0}d++}h&&o.push(h)}kV(o,n,t);const l=B0(o,n,t);return pw(l,t)?[]:l}function IV(e,t){const i=e.indexOf(" ",t);return i===-1?e.slice(t):e.slice(t,i)}function B0(e,t,i){if(!$e(i.maxHeight))return e;const{height:s,lineMetrics:n}=t.measureLines(e);if(s<=i.maxHeight)return e;for(let o=0,a=0;o<n.length;o++)if(a+=n[o].height,a>i.maxHeight){if(i.overflow==="hide"||o===0)return[];const r=e.slice(0,o),l=r.pop();return r.concat(sl(l)?l:xl(l,t,i.maxWidth,!0))}return e}function kV(e,t,i){if(i.avoidOrphans===!1||e.length<2)return;const{length:s}=e,n=e[s-1],o=e[s-2];if(o.length<n.length)return;const a=o.lastIndexOf(" ");if(a===-1||a===o.indexOf(" ")||n.includes(" "))return;const r=o.slice(a+1);t.textWidth(n+r)<=i.maxWidth&&(e[s-2]=o.slice(0,a),e[s-1]=r+" "+n)}function by(e,t){const{maxHeight:i=1/0}=t,s=[];let n=0,o=0;function a(){const r=s.pop();if(!r)return;const l=Ze(r),c=xl(r.text,l,t.maxWidth,!0),h=l.measureText(c);s.push({...r,text:c,textMetrics:h})}for(const{width:r,height:l,segments:c}of Ks(e,t.font).lineMetrics){if(o+l>i){s.length&&a();break}if(n+r<=t.maxWidth){n+=r,o+=l,s.push(...c);continue}for(const h of c){if(n+h.textMetrics.width<=t.maxWidth){n+=h.textMetrics.width,s.push(h);continue}const d=Ze(h),u=IS(h.text),p={...t,font:h,maxHeight:i-o};let f=xy(u,{...p,overflow:"hide"},n);if(f.length===0)if(t.textWrap==="never")f=xy(u,p,n);else{f=xy(u,p);const x=s.at(-1);x&&(x.text+=`
`,n=0)}if(f.length===0){a();break}const y=f.findIndex(sl);y!==-1&&(f=f.slice(0,y+1));const b=f.at(-1);for(const x of f){const v=kS(x),S=d.measureText(v),M={...h,text:v,textMetrics:S};x===b?n+=S.width:(M.text+=`
`,n=0),o+=S.height,s.push(M)}if(y!==-1)break}}return s}var Pc=1e3,fr=Pc*60,bl=fr*60,vl=bl*24,_0=vl*7,vy=vl*30,zd=vl*365,Bd=new Date().getTimezoneOffset()*fr,_d={millisecond:{milliseconds:1,hierarchy:"day",encode(e){return e.getTime()},decode(e){return new Date(e)}},second:{milliseconds:Pc,hierarchy:"day",encode(e,t){const i=t?0:Bd;return Math.floor((e.getTime()-i)/Pc)},decode(e,t){const i=t?0:Bd;return new Date(i+e*Pc)}},minute:{milliseconds:fr,hierarchy:"day",encode(e,t){const i=t?0:Bd;return Math.floor((e.getTime()-i)/fr)},decode(e,t){const i=t?0:Bd;return new Date(i+e*fr)}},hour:{milliseconds:bl,hierarchy:"day",encode(e,t){const i=t?0:Bd;return Math.floor((e.getTime()-i)/bl)},decode(e,t){const i=t?0:Bd;return new Date(i+e*bl)}},day:{milliseconds:vl,hierarchy:"month",encode(e,t){const i=t?0:e.getTimezoneOffset()*fr;return Math.floor((e.getTime()-i)/vl)},decode(e,t){let i;return t?(i=new Date(0),i.setUTCDate(i.getUTCDate()+e),i.setUTCHours(0,0,0,0)):(i=new Date(1970,0,1),i.setDate(i.getDate()+e)),i}},month:{milliseconds:vy,hierarchy:"year",encode(e,t){return t?e.getUTCFullYear()*12+e.getUTCMonth():e.getFullYear()*12+e.getMonth()},decode(e,t){if(t){const i=Math.floor(e/12),s=e-i*12;return new Date(Date.UTC(i,s,1))}else{const i=Math.floor(e/12),s=e-i*12;return new Date(i,s,1)}}},year:{milliseconds:zd,hierarchy:void 0,encode(e,t){return t?e.getUTCFullYear():e.getFullYear()},decode(e,t){let i;return t?(i=new Date,i.setUTCFullYear(e),i.setUTCMonth(0,1),i.setUTCHours(0,0,0,0)):i=new Date(e,0,1,0,0,0,0),i}}};function pg(e){return typeof e=="string"?{unit:e,step:1,epoch:void 0,utc:!1}:{unit:e.unit,step:e.step??1,epoch:e.epoch,utc:e.utc??!1}}function gg(e,t,i,s){if(i==null)return 0;const n=_d[e];return Math.floor(n.encode(new Date(i),s))%t}function Vd(e,t,i,s,n){const o=_d[t];return Math.floor((o.encode(new Date(e),s)-n)/i)}function Gd(e,t,i,s,n){return _d[t].decode(e*i+n,s)}function Sy(e,t,i,s,n){const o=new Date(e),a=Vd(o,t,i,s,n);return Gd(a,t,i,s,n)}function My(e,t,i,s,n){const o=new Date(Number(e)-1),a=Vd(o,t,i,s,n);return Gd(a+1,t,i,s,n)}function Ys(e,t){const{unit:i,step:s,epoch:n,utc:o}=pg(e),a=gg(i,s,n,o);return Sy(t,i,s,o,a)}function V0(e,t){const{unit:i,step:s,epoch:n,utc:o}=pg(e),a=gg(i,s,n,o);return My(t,i,s,o,a)}function G0(e,t){const{unit:i,step:s,epoch:n,utc:o}=pg(e),a=gg(i,s,n,o);return Gd(Vd(My(t,i,s,o,a),i,s,o,a)-1,i,s,o,a)}function Dy(e,t){const{unit:i,step:s,epoch:n,utc:o}=pg(e),a=gg(i,s,n,o);return Gd(Vd(Sy(t,i,s,o,a),i,s,o,a)+1,i,s,o,a)}function Iy(e,t,i){if(e.valueOf()>t.valueOf()&&([e,t]=[t,e],i!=null&&(i=[1-i[1],1-i[0]])),i!=null){const s=t.valueOf()-e.valueOf(),n=e.valueOf();e=new Date(n+i[0]*s),t=new Date(n+i[1]*s)}return[new Date(e),new Date(t)]}function fg(e,t,i,{extend:s=!1,visibleRange:n=[0,1],limit:o,defaultAlignment:a="start"}={}){const r=pg(e),{unit:l,step:c,utc:h}=r;let d;r.epoch!=null?d=r.epoch:a==="interval"?d=void 0:t.valueOf()>i.valueOf()?d=i:d=t;const u=gg(r.unit,r.step,d,r.utc);let[p,f]=Iy(t,i,n);p=s?Sy(p,l,c,h,u):My(p,l,c,h,u),f=s?My(f,l,c,h,u):Sy(f,l,c,h,u);const y=Vd(p,l,c,h,u);let b=Vd(f,l,c,h,u);return o!=null&&b-y>o&&(b=y+o),{range:[y,b],unit:l,step:c,utc:h,offset:u}}function mg(e,t,i,s){const{range:[n,o]}=fg(e,t,i,s);return Math.abs(o-n)}function wn(e,t,i,s){const{range:[n,o],unit:a,step:r,utc:l,offset:c}=fg(e,t,i,s),h=[];for(let d=n;d<=o;d+=1){const u=Gd(d,a,r,l,c);h.push(u)}return h}function H0(e,t,i,s){const{range:[n,o],unit:a,step:r,utc:l,offset:c}=fg(e,t,i,s),h=Math.max(0,o-n+1),d=new Array(h);for(let u=0;u<h;u++)d[u]=n+u;return{encodedValues:d,encodingParams:{unit:a,step:r,utc:l,offset:c}}}function j0(e,t){return Gd(e,t.unit,t.step,t.utc,t.offset)}var W0=new Date().getTimezoneOffset()*6e4,AV=1e3,CV=6e4,LV=36e5;function mr(e,t){const{unit:i,step:s,utc:n,offset:o}=t,a=e*s+o;switch(i){case"millisecond":return a;case"second":return(n?0:W0)+a*AV;case"minute":return(n?0:W0)+a*CV;case"hour":return(n?0:W0)+a*LV;default:return _d[i].decode(a,n).valueOf()}}function ky(e,t,i,{extend:s,visibleRange:n,limit:o,defaultAlignment:a}={}){const{range:[r]}=fg(e,t,i,{extend:s,visibleRange:n,limit:o,defaultAlignment:a}),{range:[l]}=fg(e,t,i,{extend:s,limit:o,defaultAlignment:a});return r-l}function ro(e){return typeof e=="string"?e:e.unit}function Fo(e){return typeof e=="string"?1:e.step??1}function Sl(e){return typeof e=="string"?void 0:e.epoch}function Hd(e){return _d[ro(e)].hierarchy}function rs(e){return Fo(e)*_d[ro(e)].milliseconds}function yg(e,[t,i],[s,n]){const o=n-s,a=i-t,r=t+a*e[0],l=t+a*e[1];return[(r-s)/o,(l-s)/o]}var $t=(e,t)=>({duration:rs(e)*t,timeInterval:e,step:t}),xg=[$t({unit:"second"},1),$t({unit:"second"},5),$t({unit:"second"},15),$t({unit:"second"},30),$t({unit:"minute"},1),$t({unit:"minute"},5),$t({unit:"minute"},15),$t({unit:"minute"},30),$t({unit:"hour"},1),$t({unit:"hour"},3),$t({unit:"hour"},6),$t({unit:"hour"},12),$t({unit:"day"},1),$t({unit:"day"},2),$t({unit:"day",step:7},1),$t({unit:"day",step:7},2),$t({unit:"day",step:7},3),$t({unit:"month"},1),$t({unit:"month"},2),$t({unit:"month"},3),$t({unit:"month"},4),$t({unit:"month"},6),$t({unit:"year"},1)],gw=[1,2,5,10];function fw(e,t){return Math.abs(Math.round(e)-e)<t}function mw(e,t,i){return Math.abs(t-e)>=i?Math.abs(t-e)/i+1:1}function Rc(e,t,i,s,n,o){if(e===t)return{ticks:[e],count:1,firstTickIndex:0};if(i<2)return{ticks:[e,t],count:2,firstTickIndex:0};const a=Fc(e,t,i,s,n);if(!Number.isFinite(a))return{ticks:[],count:0,firstTickIndex:void 0};let r=e,l=t;fw(r/a,1e-12)||(r=Math.ceil(r/a)*a),fw(l/a,1e-12)||(l=Math.floor(l/a)*a),o!=null&&(o=yg(o,[e,t],[r,l]));const{ticks:c}=zc(r,l,a,o),h=c.at(0);return{ticks:c,count:mw(r,l,a),firstTickIndex:h==null?void 0:Math.round((h-r)/a)}}var wV=Math.floor(2*_0/vy*10)/10;function yw({timeInterval:e,step:t}){const i=rs(e)*t,s=Hd(e),n=s?rs(s):void 0;return i<=(n??1/0)*wV}function Ay(e,{weekStart:t}){if(e.unit==="day"&&e.step===7)return t}function jd(e,t,i,s,n,{weekStart:o,primaryOnly:a=!1,targetInterval:r}){if(i<=0)return;const l=r??Math.abs(t-e)/Math.max(i,1),c=xg.findLast(p=>(!a||yw(p))&&l>p.duration),h=xg.find(p=>(!a||yw(p))&&l<=p.duration);if(c==null)return{unit:"millisecond",step:Math.max(Fc(e,t,i,s,n),1)};if(h==null)return{unit:"year",step:r==null?Fc(e/zd,t/zd,i,s,n):1};const{timeInterval:d,step:u}=l-c.duration<h.duration-l?c:h;return{unit:d.unit,step:Fo(d)*u,epoch:Ay(d,{weekStart:o})}}function Fc(e,t,i,s=0,n=1/0){if(e===t)return ge(1,s,n);if(i<1)return Number.NaN;const o=Math.abs(t-e),a=10**Math.floor(Math.log10(o/i));let r=Number.NaN,l=1/0,c=!1;for(const h of gw){const d=Math.ceil(o/(h*a)),u=d>=s&&d<=n;if(c&&!u)continue;const p=Math.abs(d-i);(l>p||c!==u)&&(c||(c=u),l=p,r=h)}return r*a}function xw(e){for(let t=e.length-1;t>=0;t-=1)if(e[t]!=="0")return t+1;return 0}function Cy(e,t){const i=Tp(t??",f");if(i==null)return;(i.precision==null||Number.isNaN(i.precision))&&(!i.type||"eEFgGnprs".includes(i.type)?i.precision=Math.max(...e.map(n=>{if(!Number.isFinite(n))return 0;const[o,a]=n.toExponential((i.type?6:12)-1).split(/[.e]/g);return(o!=="1"&&o!=="-1"?1:0)+xw(a)+1})):"f%".includes(i.type)&&(i.precision=Math.max(...e.map(n=>{if(!Number.isFinite(n)||n===0)return 0;const o=Math.floor(Math.log10(Math.abs(n))),a=i.type?6:12,r=n.toExponential(a-1).split(/[.e]/g)[1],l=xw(r);return Math.max(0,l-o)}))));const s=hm(i);return n=>s(Number(n))}function zc(e,t,i,s){if(!Number.isFinite(i)||i<=0)return{ticks:[],count:0,firstTickIndex:void 0};if(e===t)return{ticks:[e],count:1,firstTickIndex:0};const n=10**vc(i),o=Math.min(e,t),a=Math.max(e,t);let r,l;if(s!=null&&(s[0]!==0||s[1]!==1)){const d=t-e,u=e+d*s[0],p=t-d*(1-s[1]);r=Math.min(u,p),l=Math.max(u,p)}else r=o,l=a;r=Math.floor(r*n)/n,l=Math.ceil(l*n)/n;const c=[];for(let d=0;;d+=1){const u=Math.round((o+i*d)*n)/n;if(u>a)break;u>=r&&u<=l&&c.push(u)}const h=c.at(0);return{ticks:c,count:mw(o,a,i),firstTickIndex:h==null?void 0:Math.round((h-o)/i)}}function Ml(e,t){return e>=t?(j.warnOnce("the configured interval results in more than 1 item per pixel, ignoring. Supply a larger interval or omit this configuration"),!0):!1}function Ly(e,t){const i=Math.abs(t-e),s=10**Math.floor(Math.log10(i));let n=1/0,o=[e,t];for(const a of gw){const r=a*s,l=Math.floor(e/r)*r,c=Math.ceil(t/r)*r,h=1-i/Math.abs(c-l);n>h&&(n=h,o=[l,c])}return o}function wy(e,t,i,s,n,o){if(e<=0)return{minTickCount:0,maxTickCount:0,tickCount:0};o=Math.max(o,e/(n+1)),i??(i=o),s??(s=e),i>s&&(i===o?i=s:s=i),i=Math.max(i,1);const a=Math.max(1,Math.floor(e/(t*i))),r=Math.min(a,Math.ceil(e/(t*s))),l=ge(r,Math.floor(n/t),a);return{minTickCount:r,maxTickCount:a,tickCount:l}}function Wi(e){return e instanceof Date?e.getTime():e}function Wd(e){return e<Pc?"millisecond":e<fr?"second":e<bl?"minute":e<bl*23?"hour":e<28*vl?"day":e<zd?"month":"year"}function bg(e){if(e.length===0)return"millisecond";if(e.length===1)return $d(e[0]);let t=1/0;for(let i=1;i<e.length;i++)t=Math.min(t,Math.abs(e[i].valueOf()-e[i-1].valueOf()));return Wd(t)}function $d(e){return Ys("second",e)<e?"millisecond":Ys("minute",e)<e?"second":Ys("hour",e)<e?"minute":Ys("day",e)<e?"hour":Ys("month",e)<e?"day":Ys("year",e)<e?"month":"year"}function vg(e){const[t,i]=e.length===0?[0,0]:Tt([e[0].valueOf(),e.at(-1).valueOf()]),s=new Date(t).getFullYear(),n=new Date(i).getFullYear();if(s!==n)return;const o=new Date(t).getMonth(),a=new Date(i).getMonth();if(o!==a)return"year";const r=new Date(t).getDate(),l=new Date(i).getDate();return r!==l?"month":"day"}function Sg(){const e=new Map;return t=>{const i=e.get(t);return i?(e.set(t,i+1),`${t}_${i}`):(e.set(t,1),t)}}function Ty(e){return e!=null&&Object.hasOwn(e,"toString")&&Rt(e.toString())}function $0(e){return e!=null&&Object.hasOwn(e,"valueOf")&&$e(e.valueOf())}function Bc(e){return $e(e)||tl(e)||$0(e)}function U0(e,t){return e!=null&&(!t||Bc(e))}function Mg(e){return Ty(e)&&Object.hasOwn(e,"id")?e.id:e}function Ny(e){return Ty(e)&&Object.hasOwn(e,"value")?e.value:e}var H={};Vs(H,{add:()=>TV,angle:()=>RV,apply:()=>WV,distance:()=>OV,distanceSquared:()=>EV,equal:()=>HV,from:()=>jV,gradient:()=>zV,intercept:()=>BV,intersectAtX:()=>VV,intersectAtY:()=>_V,length:()=>Oy,lengthSquared:()=>bw,multiply:()=>NV,normalized:()=>PV,origin:()=>vw,required:()=>$V,rotate:()=>FV,round:()=>GV,sub:()=>K0});function TV(e,t){return typeof t=="number"?{x:e.x+t,y:e.y+t}:{x:e.x+t.x,y:e.y+t.y}}function K0(e,t){return typeof t=="number"?{x:e.x-t,y:e.y-t}:{x:e.x-t.x,y:e.y-t.y}}function NV(e,t){return typeof t=="number"?{x:e.x*t,y:e.y*t}:{x:e.x*t.x,y:e.y*t.y}}function Oy(e){return Math.hypot(e.x,e.y)}function bw(e){return e.x*e.x+e.y*e.y}function OV(e,t){return Oy(K0(e,t))}function EV(e,t){return bw(K0(e,t))}function PV(e){const t=Oy(e);return{x:e.x/t,y:e.y/t}}function RV(e,t){return t==null?Math.atan2(e.y,e.x):Math.atan2(e.y,e.x)-Math.atan2(t.y,t.x)}function FV(e,t,i=vw()){const s=Oy(e);return{x:i.x+s*Math.cos(t),y:i.y+s*Math.sin(t)}}function zV(e,t,i){const s=t.x-e.x;return(i==null?t.y-e.y:i-t.y-(i-e.y))/s}function BV(e,t,i){return(i==null?e.y:i-e.y)-t*e.x}function _V(e,t,i=0,s){return{x:e===1/0?1/0:(i-t)/e,y:s==null?i:s-i}}function VV(e,t,i=0,s){const n=e===1/0?1/0:e*i+t;return{x:i,y:s==null?n:s-n}}function GV(e,t=2){return{x:ed(e.x,t),y:ed(e.y,t)}}function HV(e,t){return e.x===t.x&&e.y===t.y}function jV(e,t){if(typeof e=="number")return{x:e,y:t};if("currentX"in e)return{x:e.currentX,y:e.currentY};if("offsetWidth"in e)return{x:e.offsetWidth,y:e.offsetHeight};if("width"in e)return[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y+e.height}];if("x1"in e)return[{x:e.x1,y:e.y1},{x:e.x2,y:e.y2}];throw new Error(`Values can not be converted into a vector: [${JSON.stringify(e)}] [${t}]`)}function WV(e,t){return e.x=t.x,e.y=t.y,e}function $V(e){return{x:e?.x??0,y:e?.y??0}}function vw(){return{x:0,y:0}}var ke={};Vs(ke,{bottomCenter:()=>XV,center:()=>ZV,clone:()=>eG,collides:()=>tG,end:()=>KV,from:()=>iG,height:()=>QV,normalise:()=>Ey,origin:()=>sG,round:()=>JV,start:()=>UV,topCenter:()=>YV,width:()=>qV});function UV(e){return{x:e.x1,y:e.y1}}function KV(e){return{x:e.x2,y:e.y2}}function YV(e){return{x:(e.x1+e.x2)/2,y:Math.min(e.y1,e.y2)}}function ZV(e){return{x:(e.x1+e.x2)/2,y:(e.y1+e.y2)/2}}function XV(e){return{x:(e.x1+e.x2)/2,y:Math.max(e.y1,e.y2)}}function qV(e){return Math.abs(e.x2-e.x1)}function QV(e){return Math.abs(e.y2-e.y1)}function JV(e){return{x1:Math.round(e.x1),y1:Math.round(e.y1),x2:Math.round(e.x2),y2:Math.round(e.y2)}}function eG(e){return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}}function tG(e,t){const i=Ey(e),s=Ey(t);return i.x1<=s.x2&&i.x2>=s.x1&&i.y1<=s.y2&&i.y2>=s.y1}function Ey(e){return{x1:Math.min(e.x1,e.x2),x2:Math.max(e.x1,e.x2),y1:Math.min(e.y1,e.y2),y2:Math.max(e.y1,e.y2)}}function iG(e,t,i,s){if(typeof e=="number")return{x1:e,y1:t,x2:i,y2:s};if("width"in e)return Ey({x1:e.x,y1:e.y,x2:e.x+e.width,y2:e.y+e.height});throw new Error(`Values can not be converted into a vector4: [${JSON.stringify(e)}] [${t}] [${i}] [${s}]`)}function sG(){return{x1:0,y1:0,x2:0,y2:0}}function Ut(e){return fe(e)&&e.type=="gradient"}function Sw(e){return Ce(e)&&e.every(Ut)}function Y0(e){return Ce(e)&&e.every(t=>typeof t=="string")}function Tn(e){return e!==null&&fe(e)&&e.type=="pattern"}function zo(e){return e!==null&&fe(e)&&e.type=="image"}function Mw(e){return Ut(e)||Tn(e)}function Bo(e,t,i,s,n){return(1-n)**3*e+3*(1-n)**2*n*t+3*(1-n)*n**2*i+n**3*s}function Dg(e,t,i,s,n){if(n<=Math.min(e,s))return e<s?0:1;if(n>=Math.max(e,s))return e<s?1:0;let o=0,a=1,r=Number.NaN;for(let l=0;l<12;l+=1)r=(o+a)/2,Bo(e,t,i,s,r)<n?o=r:a=r;return r}function Ud(e,t,i,s,n,o,a,r,l){const c=(1-l)*e+l*i,h=(1-l)*t+l*s,d=(1-l)*i+l*n,u=(1-l)*s+l*o,p=(1-l)*n+l*a,f=(1-l)*o+l*r,y=(1-l)*c+l*d,b=(1-l)*h+l*u,x=(1-l)*d+l*p,v=(1-l)*u+l*f,S=(1-l)*y+l*x,M=(1-l)*b+l*v;return[[{x:e,y:t},{x:c,y:h},{x:y,y:b},{x:S,y:M}],[{x:S,y:M},{x,y:v},{x:p,y:f},{x:a,y:r}]]}function Dw(e,t,i,s){const n=-e+3*t-3*i+s,o=2*(e-2*t+i),a=-e+t;if(n===0){if(o!==0){const l=-a/o;if(l>0&&l<1)return[l]}return[]}const r=o*o-4*n*a;if(r>=0){const l=Math.sqrt(r),c=(-o+l)/(2*n),h=(-o-l)/(2*n);return[c,h].filter(d=>d>0&&d<1)}return[]}function Z0(e,t,i,s,n,o,a,r){const l=Dw(e,i,n,a),c=Dw(t,s,o,r);return[...l,...c]}function X0(e,t,i){const s=Bo(e[0].x,e[1].x,e[2].x,e[3].x,.5),n=Bo(e[0].y,e[1].y,e[2].y,e[3].y,.5),o=Math.hypot(s-t,n-i),a=Math.min(Math.hypot(e[0].x-t,e[0].y-i),Math.hypot(e[1].x-t,e[1].y-i),Math.hypot(e[2].x-t,e[2].y-i),Math.hypot(e[3].x-t,e[3].y-i));return{points:e,distance:o,minDistance:a}}function q0(e,t,i,s,n,o,a,r,l,c,h=1){let u={value:X0([{x:e,y:t},{x:i,y:s},{x:n,y:o},{x:a,y:r}],l,c),next:null},p;for(;u!=null;){const{points:f,distance:y,minDistance:b}=u.value;if(u=u.next,(p==null||y<p.distance)&&(p={distance:y,minDistance:b}),p!=null&&p.distance-b<=h)continue;const[x,v]=Ud(f[0].x,f[0].y,f[1].x,f[1].y,f[2].x,f[2].y,f[3].x,f[3].y,.5),S=[X0(x,l,c),X0(v,l,c)].sort(Iw);u=fy(u,S,Iw)}return p?.distance??1/0}var Iw=(e,t)=>t.minDistance-e.minDistance;function nG({point:e,anchor:t},i,s,n,o){if(e.size===0)return!1;let a=e.x,r=e.y;t!=null&&(a-=(t.x-.5)*e.size,r-=(t.y-.5)*e.size);let l=a;a<i?l=i:a>i+n&&(l=i+n);let c=r;r<s?c=s:r>s+o&&(c=s+o);const h=a-l,d=r-c;return Math.hypot(h,d)<=e.size/2}function Q0(e){return e!=null&&typeof e.point=="object"&&typeof e.label=="object"}var oG={top:{x:0,y:-1},bottom:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0},"top-left":{x:-1,y:-1},"top-right":{x:1,y:-1},"bottom-left":{x:-1,y:1},"bottom-right":{x:1,y:1}};function J0(e,t,i=5){const s=new Map,n=[],o=new Map(Array.from(e.entries(),([r,l])=>[r,l.toSorted((c,h)=>h.point.size-c.point.size)])),a=[...o.values()].flat();for(const[r,l]of o.entries()){const c=[];if(l[0]?.label){for(let h=0,d=l.length;h<d;h++){const u=l[h],{point:p,label:f,anchor:y}=u,{text:b,width:x,height:v}=f,S=p.size/2;let M=0,D=0;if(S>0&&u.placement!=null){const A=oG[u.placement];M=(x/2+S+i)*A.x,D=(v/2+S+i)*A.y}let k=p.x-x/2+M,I=p.y-v/2+D;if(y&&(k-=(y.x-.5)*p.size,I-=(y.y-.5)*p.size),lg(t,k,I,x,v)&&!a.some(A=>nG(A,k,I,x,v))&&!n.some(A=>sy(A,k,I,x,v))){const A={index:h,text:b,x:k,y:I,width:x,height:v,datum:u};c.push(A),n.push(A)}}s.set(r,c)}}return s}function kw(e){return e.type==="continuous"||e.type==="log"}function Aw(e){return e.type==="category"}function yr(e){return"variant"in e&&e.variant==="unit-time"}function Cw(e){return!("variant"in e)}function _o(e,t){return e===void 0||t===void 0?e!==void 0||t!==void 0:kw(e)&&kw(t)?e.type===t.type&&vn(e.domain,t.domain)&&vn(e.range,t.range):Aw(e)&&Aw(t)?yr(e)&&yr(t)?e.firstBandTime===t.firstBandTime&&e.lastBandTime===t.lastBandTime&&e.bandCount===t.bandCount&&e.intervalMs===t.intervalMs&&e.inset===t.inset&&e.step===t.step:Cw(e)&&Cw(t)?e.inset===t.inset&&e.step===t.step&&vn(e.domain,t.domain):!1:!1}function Dl(e){return e==null?!1:e.type==="category"?yr(e)?Number.isFinite(e.firstBandTime)&&Number.isFinite(e.lastBandTime)&&Number.isFinite(e.bandCount)&&e.bandCount>0:e.domain.every(t=>t!=null):e.domain.every(t=>Number.isFinite(t)||t instanceof Date)&&e.range.every(t=>Number.isFinite(t))}function Zs(e){switch(e.type){case"linear":case"step":case"multi-line":return[{x:e.x0,y:e.y0},{x:e.x1,y:e.y1}];case"cubic":return[{x:e.cp0x,y:e.cp0y},{x:e.cp3x,y:e.cp3y}]}}function aG(e){const t=Zs(e);return t[0].x>t[1].x&&t.reverse(),t}function eM(e,t){const{x:i,y:s}=t;switch(e.type){case"linear":return{type:"linear",moveTo:e.moveTo,x0:i,y0:s,x1:i,y1:s};case"step":return{type:"step",moveTo:e.moveTo,x0:i,y0:s,x1:i,y1:s,stepX:i};case"cubic":return{type:"cubic",moveTo:e.moveTo,cp0x:i,cp0y:s,cp1x:i,cp1y:s,cp2x:i,cp2y:s,cp3x:i,cp3y:s};case"multi-line":return{type:"multi-line",moveTo:e.moveTo,x0:i,y0:s,x1:i,y1:s,midPoints:e.midPoints.map(()=>({x:i,y:s}))}}}function _c(e,t,i){const[s,n]=Zs(e),o=n.x===s.x?0:(i.x-t.x)/(n.x-s.x),a=n.y===s.y?0:(i.y-t.y)/(n.y-s.y);switch(e.type){case"linear":return{type:"linear",moveTo:e.moveTo,x0:t.x,y0:t.y,x1:i.x,y1:i.y};case"cubic":return{type:"cubic",moveTo:e.moveTo,cp0x:t.x,cp0y:t.y,cp1x:i.x-(e.cp2x-s.x)*o,cp1y:i.y-(e.cp2y-s.y)*a,cp2x:i.x-(e.cp1x-s.x)*o,cp2y:i.y-(e.cp1y-s.y)*a,cp3x:i.x,cp3y:i.y};case"step":return{type:"step",moveTo:e.moveTo,x0:t.x,y0:t.y,x1:i.x,y1:i.y,stepX:i.x-(e.stepX-s.x)*o};case"multi-line":return{type:"multi-line",moveTo:e.moveTo,x0:t.x,y0:t.y,x1:i.x,y1:i.y,midPoints:e.midPoints.map(r=>({x:t.x+(r.x-s.x)*o,y:t.y+(r.y-s.y)*a}))}}}function Py(e,t,i){const{moveTo:s}=e,[n,o]=aG(e),{x:a,y:r}=n,{x:l,y:c}=o;if(i<a)return _c(e,n,n);if(t>l)return _c(e,o,o);switch(e.type){case"linear":{const h=r===c?void 0:(c-r)/(l-a),d=h==null?r:h*(t-a)+r,u=h==null?r:h*(i-a)+r;return{type:"linear",moveTo:s,x0:t,y0:d,x1:i,y1:u}}case"step":if(i<=e.stepX){const h=e.y0;return{type:"step",moveTo:s,x0:t,y0:h,x1:i,y1:h,stepX:i}}else if(t>=e.stepX){const h=e.y1;return{type:"step",moveTo:s,x0:t,y0:h,x1:i,y1:h,stepX:t}}else{const{y0:h,y1:d,stepX:u}=e;return{type:"step",moveTo:s,x0:t,y0:h,x1:i,y1:d,stepX:u}}case"cubic":{const h=Dg(e.cp0x,e.cp1x,e.cp2x,e.cp3x,t);let[d,u]=Ud(e.cp0x,e.cp0y,e.cp1x,e.cp1y,e.cp2x,e.cp2y,e.cp3x,e.cp3y,h);const p=Dg(u[0].x,u[1].x,u[2].x,u[3].x,i);return[u,d]=Ud(u[0].x,u[0].y,u[1].x,u[1].y,u[2].x,u[2].y,u[3].x,u[3].y,p),{type:"cubic",moveTo:s,cp0x:u[0].x,cp0y:u[0].y,cp1x:u[1].x,cp1y:u[1].y,cp2x:u[2].x,cp2y:u[2].y,cp3x:u[3].x,cp3y:u[3].y}}case"multi-line":{const{midPoints:h}=e,d=h.findLastIndex(k=>k.x<=t);let u=h.findIndex(k=>k.x>=i);u===-1&&(u=h.length);const p=d>=0?h[d]:void 0,f=p?.x??a,y=p?.y??r,b=u<h.length?h[u]:void 0,x=b?.x??l,v=b?.y??c,S=y===v?void 0:(v-y)/(x-f),M=S==null?y:S*(f-a)+y,D=S==null?y:S*(x-a)+y;return{type:"multi-line",moveTo:s,x0:t,y0:M,x1:i,y1:D,midPoints:h.slice(Math.max(d,0),u)}}}}var tM=(e=>(e[e.MoveTo=0]="MoveTo",e[e.LineTo=1]="LineTo",e[e.Skip=2]="Skip",e))(tM||{});function iM(e){const t=[];let i=0,s=Number.NaN,n=Number.NaN;for(const{x:o,y:a}of e){if(i>0){const r=i===1;t.push({type:"linear",moveTo:r,x0:s,y0:n,x1:o,y1:a})}i+=1,s=o,n=a}return t}var rG={start:0,middle:.5,end:1};function sM(e,t){const i=[];let s=0,n=Number.NaN,o=Number.NaN;const a=typeof t=="number"?t:rG[t];for(const{x:r,y:l}of e){if(s>0){const c=s===1,h=n+(r-n)*a;i.push({type:"step",moveTo:c,x0:n,y0:o,x1:r,y1:l,stepX:h})}s+=1,n=r,o=l}return i}function nM(e,t){const i=Array.isArray(e)?e:Array.from(e);if(i.length<=1)return[];const s=.05,n=i.map((a,r)=>{const l=r===0?a:i[r-1],c=r===i.length-1?a:i[r+1],h=r===0||r===i.length-1;if(Math.sign(l.y-a.y)===Math.sign(c.y-a.y))return 0;if(!h){const d=Math.abs(l.y-c.y),u=Math.abs(a.y-l.y)/d,p=Math.abs(a.y-c.y)/d;if(u<=s||1-u<=s||p<=s||1-p<=s)return 0}return(c.y-l.y)/(c.x-l.x)});n[1]===0&&(n[0]*=2),n.at(-2)===0&&(n[n.length-1]*=2);const o=[];for(let a=1;a<i.length;a+=1){const r=i[a-1],l=n[a-1],c=i[a],h=n[a],d=c.x-r.x,u=c.y-r.y;let p=d*t/3,f=d*l*t/3,y=d*t/3,b=d*h*t/3;h===0&&Math.abs(f)>Math.abs(u)&&(p*=Math.abs(u/f),f=Math.sign(f)*Math.abs(u)),l===0&&Math.abs(b)>Math.abs(u)&&(y*=Math.abs(u/b),b=Math.sign(b)*Math.abs(u)),o.push({type:"cubic",moveTo:a===1,cp0x:r.x,cp0y:r.y,cp1x:r.x+p,cp1y:r.y+f,cp2x:c.x-y,cp2y:c.y-b,cp3x:c.x,cp3y:c.y})}return o}var Ry=class extends K{constructor(){super(...arguments),this._dirty=!0}markDirty(){this._dirty=!0}markClean(e){this._dirty=!1}isDirty(){return this._dirty}onChangeDetection(e){this.markDirty()}},Vo=class extends K{};g([m],Vo.prototype,"icon",2),g([m],Vo.prototype,"label",2),g([m],Vo.prototype,"ariaLabel",2),g([m],Vo.prototype,"tooltip",2);function Kd(e,t){const i=xe("button",Fy("ag-charts-input ag-charts-button",t));return e.label===void 0?(i.append(lM(e.icon)),i.ariaLabel=e.altText):i.append(e.label),i.addEventListener("click",e.onPress),oo(i,t),i}function oM(e,t){const i=xe("input",Fy("ag-charts-input ag-charts-checkbox",t));return i.type="checkbox",i.checked=e.checked,i.addEventListener("change",s=>e.onChange(i.checked,s)),i.addEventListener("keydown",s=>{py(s)&&(s.preventDefault(),i.click())}),oo(i,t),i}function aM(e,t){const i=xe("select",Fy("ag-charts-input ag-charts-select",t));return i.append(...e.options.map(s=>{const n=xe("option");return n.value=s.value,n.textContent=s.label,n})),Fe(i,"data-preventdefault",!1),i.value=e.value,i.addEventListener("change",s=>e.onChange(i.value,s)),oo(i,t),i}function rM(e,t){const i=xe("textarea",Fy("ag-charts-input ag-charts-textarea",t));return i.value=e.value,i.addEventListener("input",s=>e.onChange(i.value,s)),oo(i,t),Fe(i,"data-preventdefault",!1),i}function lM(e){const t=xe("span",`ag-charts-icon ag-charts-icon-${e}`);return Fe(t,"aria-hidden",!0),t}function Fy(e,t){return t==null?e:`${e} ${t.class}`}var cM=e=>e,Lw=e=>1-Math.cos(e*Math.PI/2),xr=e=>Math.sin(e*Math.PI/2),ww=e=>-(Math.cos(e*Math.PI)-1)/2,Tw=e=>e*e,Nw=e=>1-(1-e)**2,Ow=e=>e<.5?2*e*e:1-(-2*e+2)**2/2,hM=e=>2*Math.asin(e)/Math.PI,Vc=(e,t)=>e===t;function U(e){return function(t,i){const s=`__${i}`;t[i]||dM(t,i,s,e)}}function Ig(e){return U(e)}function br(e){return U(e)}function Yd(e){const t=e??{};return t.equals=vn,U(e)}function _e(e){return function(t,i){const s=`__${i}`;t[i]||dM(t,i,s,e)}}function Zd(e){return function(t,i){const s=`__${i}`;t[i]||dM(t,i,s,e)}}function dM(e,t,i,s){const{changeCb:n,convertor:o,checkDirtyOnAssignment:a=!1}=s??{},r={changeCb:n,checkDirtyOnAssignment:a,convertor:o},l=hG(i,cG(lG(dG(i,r),r),r),r);function c(){return this[i]}Object.defineProperty(e,t,{set:l,get:c,enumerable:!0,configurable:!0})}function lG(e,t){const{convertor:i}=t;if(i){let n=function(a){e.call(this,o(a))};var s=n;const o=i;return n}return e}var Ew=Symbol("no-change");function cG(e,t){const{changeCb:i}=t;if(i){let n=function(a){const r=e.call(this,a);return r!==Ew&&o.call(this,this),r};var s=n;const o=i;return n}return e}function hG(e,t,i){const{checkDirtyOnAssignment:s}=i;if(s){let o=function(a){const r=t.call(this,a);return a?._dirty===!0&&this.markDirty(e),r};var n=o;return o}return t}function dG(e,t){const{equals:i=Vc}=t;function s(n){const o=this[e];return i(n,o)?Ew:(this[e]=n,this.onChangeDetection(e),n)}return s}var Pw={ariaInitSeriesArea:"interactive chart",ariaAnnounceHoverDatum:"${datum}",ariaAnnounceChart:"chart, ${seriesCount}[number] series",ariaAnnounceStandaloneChart:"chart, ${caption}",ariaAnnounceHierarchyChart:"hierarchy chart, ${caption}",ariaAnnounceGaugeChart:"gauge chart, ${caption}",ariaAnnounceHierarchyDatum:"level ${level}[number], ${count}[number] children, ${description}",ariaAnnounceFlowProportionLink:"link ${index} of ${count}, from ${from} to ${to}, ${sizeName} ${size}",ariaAnnounceFlowProportionNode:"node ${index} of ${count}, ${description}",ariaDescriptionLegendItem:"Press Space or Enter to toggle visibility",ariaLabelAddHorizontalLine:"Add Horizontal Line",ariaLabelAnnotationsToolbar:"Annotations",ariaLabelAnnotationOptionsToolbar:"Annotation Options",ariaLabelAnnotationSettingsDialog:"Annotation Settings",ariaLabelColor:"Color",ariaLabelColorPicker:"Color picker",ariaLabelColorPickerAlpha:"Transparency",ariaLabelColorPickerHue:"Hue",ariaLabelColorPickerMultiColor:"Multi Color",ariaLabelColorPickerPalette:"Palette",ariaLabelFinancialCharts:"Financial Charts",ariaLabelGaugeTarget:"Target",ariaLabelGaugeValue:"Value",ariaLabelLegend:"Legend",ariaLabelLegendPagination:"Legend Pagination",ariaLabelLegendPagePrevious:"Previous Legend Page",ariaLabelLegendPageNext:"Next Legend Page",ariaLabelLegendItem:"${label}, Legend item ${index}[number] of ${count}[number]",ariaLabelLegendItemUnknown:"Unknown legend item",ariaLabelNavigator:"Navigator",ariaLabelNavigatorRange:"Range",ariaLabelNavigatorMinimum:"Minimum",ariaLabelNavigatorMaximum:"Maximum",ariaLabelRangesToolbar:"Ranges",ariaLabelSettingsTabBar:"Settings",ariaLabelZoomToolbar:"Zoom",ariaRoleDescription2DSlider:"2D slider",ariaValueColorPalette:"s ${s}[percent0to2dp], v ${v}[percent0to2dp]",ariaValueColorPaletteFirstV:"v ${v}[percent0to2dp], s ${s}[percent0to2dp]",ariaValuePanRange:"${min}[percent0to2dp] to ${max}[percent0to2dp]",iconAltTextLineStyleSolid:"Solid",iconAltTextLineStyleDashed:"Long-dashed",iconAltTextLineStyleDotted:"Short-dashed",iconAltTextPositionTop:"Top",iconAltTextPositionCenter:"Center",iconAltTextPositionBottom:"Bottom",iconAltTextAlignLeft:"Left",iconAltTextAlignCenter:"Center",iconAltTextAlignRight:"Right",iconAltTextClose:"Close",overlayLoadingData:"Loading data...",overlayNoData:"No data to display",overlayNoVisibleSeries:"No visible series",overlayUnsupportedBrowser:"Incompatible browser version. Please upgrade your browser.",seriesHistogramTooltipFrequency:"Frequency",seriesHistogramTooltipSum:"${yName} (sum)",seriesHistogramTooltipCount:"${yName} (count)",seriesHistogramTooltipMean:"${yName} (mean)",toolbarSeriesTypeDropdown:"Chart Type",toolbarSeriesTypeOHLC:"OHLC",toolbarSeriesTypeHLC:"HLC",toolbarSeriesTypeHighLow:"High Low",toolbarSeriesTypeCandles:"Candles",toolbarSeriesTypeHollowCandles:"Hollow Candles",toolbarSeriesTypeLine:"Line",toolbarSeriesTypeLineWithMarkers:"Line with Markers",toolbarSeriesTypeStepLine:"Step Line",toolbarAnnotationsTrendLine:"Trend Line",toolbarAnnotationsFibonacciRetracement:"Fib Retracement",toolbarAnnotationsFibonacciRetracementTrendBased:"Fib Trend Based",toolbarAnnotationsHorizontalLine:"Horizontal Line",toolbarAnnotationsVerticalLine:"Vertical Line",toolbarAnnotationsParallelChannel:"Parallel Channel",toolbarAnnotationsDisjointChannel:"Disjoint Channel",toolbarAnnotationsClearAll:"Clear All",toolbarAnnotationsFillColor:"Fill Color",toolbarAnnotationsLineColor:"Line Color",toolbarAnnotationsLineStyle:"Line Style",toolbarAnnotationsLineStrokeWidth:"Line Stroke Width",toolbarAnnotationsSettings:"Settings",toolbarAnnotationsTextColor:"Text Color",toolbarAnnotationsTextSize:"Text Size",toolbarAnnotationsLock:"Lock",toolbarAnnotationsUnlock:"Unlock",toolbarAnnotationsDelete:"Delete",toolbarAnnotationsDragHandle:"Drag Toolbar",toolbarAnnotationsLineAnnotations:"Trend Lines",toolbarAnnotationsFibonacciAnnotations:"Fibonacci",toolbarAnnotationsTextAnnotations:"Text Annotations",toolbarAnnotationsShapeAnnotations:"Arrows",toolbarAnnotationsMeasurerAnnotations:"Measurers",toolbarAnnotationsCallout:"Callout",toolbarAnnotationsComment:"Comment",toolbarAnnotationsNote:"Note",toolbarAnnotationsText:"Text",toolbarAnnotationsArrow:"Arrow",toolbarAnnotationsArrowUp:"Arrow Up",toolbarAnnotationsArrowDown:"Arrow Down",toolbarAnnotationsDateRange:"Date Range",toolbarAnnotationsPriceRange:"Price Range",toolbarAnnotationsDatePriceRange:"Date and Price",toolbarAnnotationsQuickDatePriceRange:"Measure",toolbarRange1Month:"1M",toolbarRange1MonthAria:"1 month",toolbarRange3Months:"3M",toolbarRange3MonthsAria:"3 months",toolbarRange6Months:"6M",toolbarRange6MonthsAria:"6 months",toolbarRangeYearToDate:"YTD",toolbarRangeYearToDateAria:"Year to date",toolbarRange1Year:"1Y",toolbarRange1YearAria:"1 year",toolbarRangeAll:"All",toolbarRangeAllAria:"All",toolbarZoomZoomOut:"Zoom out",toolbarZoomZoomIn:"Zoom in",toolbarZoomPanLeft:"Pan left",toolbarZoomPanRight:"Pan right",toolbarZoomPanStart:"Pan to the start",toolbarZoomPanEnd:"Pan to the end",toolbarZoomReset:"Reset the zoom",contextMenuDownload:"Download",contextMenuToggleSeriesVisibility:"Toggle Visibility",contextMenuToggleOtherSeries:"Toggle Other Series",contextMenuZoomToCursor:"Zoom to here",contextMenuPanToCursor:"Pan to here",contextMenuResetZoom:"Reset zoom",dialogHeaderChannel:"Channel",dialogHeaderLine:"Line",dialogHeaderFibonacciRange:"Fib Retracement",dialogHeaderDateRange:"Date Range",dialogHeaderPriceRange:"Price Range",dialogHeaderDatePriceRange:"Date and Price",dialogHeaderText:"Text",dialogInputAlign:"Align",dialogInputColorPicker:"Color",dialogInputColorPickerAltText:"Text Color",dialogInputFillColorPicker:"Fill",dialogInputFillColorPickerAltText:"Fill Color",dialogInputExtendChannelStart:"Extend channel start",dialogInputExtendChannelEnd:"Extend channel end",dialogInputExtendLineStart:"Extend line start",dialogInputExtendLineEnd:"Extend line end",dialogInputExtendAbove:"Extend above",dialogInputExtendBelow:"Extend below",dialogInputExtendLeft:"Extend left",dialogInputExtendRight:"Extend right",dialogInputReverse:"Reverse",dialogInputShowFill:"Show Fill",dialogInputFontSize:"Size",dialogInputFontSizeAltText:"Font Size",dialogInputLineStyle:"Dash",dialogInputPosition:"Position",dialogInputStrokeWidth:"Weight",dialogInputStrokeWidthAltText:"Line Weight",dialogInputFibonacciBands:"Bands",dialogInputFibonacciBandsAltText:"Fibonacci Bands",inputTextareaPlaceholder:"Add Text",measurerDateRangeBars:"${value}[number] bars",measurerPriceRangeValue:"${value}[number]",measurerPriceRangePercent:"${value}[percent]",measurerVolume:"Vol ${value}",tooltipPaginationStatus:"${index}[number] of ${count}[number]"};function Rw(e,t,i,s){return{unit:e,step:t,epoch:i,utc:s,every(n){return Rw(this.unit,(this.step??1)*n,this.epoch,this.utc)}}}var Fw={};function ri(e,t=1,i,s=!1){j.warnOnce("time import is deprecated, use object notation instead");const n=`${e}:${t}:${i?.getTime()??0}:${s}`;let o=Fw[n];return o==null&&(o=Rw(e,t,i,s),Fw[n]=o),o}var uG={get millisecond(){return ri("millisecond")},get second(){return ri("second")},get minute(){return ri("minute")},get hour(){return ri("hour")},get day(){return ri("day")},get monday(){return ri("day",7,new Date(1970,0,5))},get tuesday(){return ri("day",7,new Date(1970,0,6))},get wednesday(){return ri("day",7,new Date(1970,0,7))},get thursday(){return ri("day",7,new Date(1970,0,1))},get friday(){return ri("day",7,new Date(1970,0,2))},get saturday(){return ri("day",7,new Date(1970,0,3))},get sunday(){return ri("day",7,new Date(1970,0,4))},get month(){return ri("month")},get year(){return ri("year")},get utcMillisecond(){return ri("millisecond",1,void 0,!0)},get utcSecond(){return ri("second",1,void 0,!0)},get utcMinute(){return ri("minute",1,void 0,!0)},get utcHour(){return ri("hour",1,void 0,!0)},get utcDay(){return ri("day",1,void 0,!0)},get utcMonth(){return ri("month",1,void 0,!0)},get utcYear(){return ri("year",1,void 0,!0)}},zy=Symbol("interpolate"),By=e=>e[zy]!=null,kg=class Ip{constructor(t,i,s,n){this.x=t,this.y=i,this.width=s,this.height=n}static fromObject({x:t,y:i,width:s,height:n}){return new Ip(t,i,s,n)}static merge(t){let i=1/0,s=1/0,n=-1/0,o=-1/0;for(const a of t)a.x<i&&(i=a.x),a.y<s&&(s=a.y),Cs(a.x,a.width)>n&&(n=Cs(a.x,a.width)),Cs(a.y,a.height)>o&&(o=Cs(a.y,a.height));return new Ip(i,s,n-i,o-s)}static nearestBox(t,i,s){return Pd(t,i,s)}toDOMRect(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.y,left:this.x,right:Cs(this.x,this.width),bottom:Cs(this.y,this.height),toJSON(){return{}}}}clone(){const{x:t,y:i,width:s,height:n}=this;return new Ip(t,i,s,n)}equals(t){return cg(this,t)}containsPoint(t,i){return lg(this,t,i)}intersection(t){const i=Math.max(this.x,t.x),s=Math.max(this.y,t.y),n=Math.min(Cs(this.x,this.width),Cs(t.x,t.width)),o=Math.min(Cs(this.y,this.height),Cs(t.y,t.height));if(!(i>n||s>o))return new Ip(i,s,n-i,o-s)}collidesBBox(t){return this.x<Cs(t.x,t.width)&&Cs(this.x,this.width)>t.x&&this.y<Cs(t.y,t.height)&&Cs(this.y,this.height)>t.y}computeCenter(){return{x:this.x+this.width/2,y:this.y+this.height/2}}isFinite(){return Number.isFinite(this.x)&&Number.isFinite(this.y)&&Number.isFinite(this.width)&&Number.isFinite(this.height)}distanceSquared(t,i){if(this.containsPoint(t,i))return 0;const s=t-ge(this.x,t,Cs(this.x,this.width)),n=i-ge(this.y,i,Cs(this.y,this.height));return s*s+n*n}shrink(t,i){if(typeof t=="number")this.applyMargin(t,i);else for(const s of Object.keys(t)){const n=t[s];typeof n=="number"&&this.applyMargin(n,s)}return this.width<0&&(this.width=0),this.height<0&&(this.height=0),this}grow(t,i){if(typeof t=="number")this.applyMargin(-t,i);else for(const s of Object.keys(t)){const n=t[s];typeof n=="number"&&this.applyMargin(-n,s)}return this}applyMargin(t,i){switch(i){case"top":this.y+=t;case"bottom":this.height-=t;break;case"left":this.x+=t;case"right":this.width-=t;break;case"vertical":this.y+=t,this.height-=t*2;break;case"horizontal":this.x+=t,this.width-=t*2;break;case void 0:this.x+=t,this.y+=t,this.width-=t*2,this.height-=t*2;break}}translate(t,i){return this.x+=t,this.y+=i,this}[zy](t,i){return new Ip(this.x*(1-i)+t.x*i,this.y*(1-i)+t.y*i,this.width*(1-i)+t.width*i,this.height*(1-i)+t.height*i)}};kg.zero=Object.freeze(new kg(0,0,0,0)),kg.NaN=Object.freeze(new kg(Number.NaN,Number.NaN,Number.NaN,Number.NaN));var re=kg;function Cs(e,t){return e===-1/0&&t===1/0?1/0:e+t}function zw({context:e,pixelRatio:t,width:i,height:s}){e.save();try{e.resetTransform(),e.clearRect(0,0,Math.ceil(i*t),Math.ceil(s*t))}finally{e.restore()}}function Bw(e){if(Me.check("canvas")){const t=e.save.bind(e),i=e.restore.bind(e);let s=0;Object.assign(e,{save(){t(),s++},restore(){if(s===0)throw new Error("AG Charts - Unable to restore() past depth 0");i(),s--},verifyDepthZero(){if(s!==0)throw new Error(`AG Charts - Save/restore depth is non-zero: ${s}`)}})}}function _w(e,t,i){return[Math.floor(e*i),Math.floor(t*i)]}var uM;function pG(){return uM??(uM=new OffscreenCanvas(1,1)),uM}var pM=class{constructor(e){const{width:t,height:i,pixelRatio:s,willReadFrequently:n=!1}=e;this.width=t,this.height=i,this.pixelRatio=s;const[o,a]=_w(t,i,s);this.canvas=new OffscreenCanvas(o,a),this.context=this.canvas.getContext("2d",{willReadFrequently:n}),this.context.setTransform(s,0,0,s,0,0),Bw(this.context)}drawImage(e,t=0,i=0){return e.drawImage(this.canvas,t,i)}transferToImageBitmap(){return this.canvas.width<1||this.canvas.height<1?pG().transferToImageBitmap():this.canvas.transferToImageBitmap()}resize(e,t,i){if(!(e>0&&t>0))return;const{canvas:s,context:n}=this;if(e!==this.width||t!==this.height||i!==this.pixelRatio){const[o,a]=_w(e,t,i);s.width=o,s.height=a}n.setTransform(i,0,0,i,0,0),this.width=e,this.height=t,this.pixelRatio=i}clear(){zw(this)}destroy(){this.canvas.width=0,this.canvas.height=0,this.context.clearRect(0,0,0,0),this.canvas=null,this.context=null,Object.freeze(this)}},gM=(e,t)=>Math.sign(e-t);function Vw(e,t){if(typeof e=="number"&&typeof t=="number")return gM(e,t);const i=typeof e=="number"?[e]:e,s=typeof t=="number"?[t]:t,n=Math.min(i.length,s.length);for(let o=0;o<n;o+=1){const a=gM(i[o],s[o]);if(a!==0)return a}return gM(i.length,s.length)}var Gw=(e=>(e[e.All=0]="All",e[e.None=1]="None",e))(Gw||{}),gG=5,Gc=class lL{constructor(t){this.serialNumber=lL._nextSerialNumber++,this.childNodeCounts={groups:0,nonGroups:0,thisComplexity:0,complexity:0},this.id=Mi(this),this.name=void 0,this.transitionOut=void 0,this.pointerEvents=0,this._datum=void 0,this._previousDatum=void 0,this.scene=void 0,this._debugDirtyProperties=void 0,this.parentNode=void 0,this.cachedBBox=void 0,this.isContainerNode=!1,this.visible=!0,this.zIndex=0,this.batchLevel=0,this.batchDirty=!1,this.name=t?.name,this.tag=t?.tag??Number.NaN,this.zIndex=t?.zIndex??0,this.scene=t?.scene,(t?.debugDirty??lL._debugEnabled)&&(this._debugDirtyProperties=new Map([["__first__",[]]]))}static toSVG(t,i,s){const n=t?.toSVG();if(n==null||!n.elements.length&&!n.defs?.length)return;const o=Pt("svg");if(o.setAttribute("width",String(i)),o.setAttribute("height",String(s)),o.setAttribute("viewBox",`0 0 ${i} ${s}`),o.setAttribute("overflow","visible"),n.defs?.length){const a=Pt("defs");a.append(...n.defs),o.append(a)}return o.append(...n.elements),o.outerHTML}static*extractBBoxes(t,i){for(const s of t)if(!i||s.visible&&!s.transitionOut){const n=s.getBBox();n&&(yield n)}}get datum(){return this._datum}set datum(t){this._datum!==t&&(this._previousDatum=this._datum,this._datum=t)}get previousDatum(){return this._previousDatum}get layerManager(){return this.scene?.layersManager}get imageLoader(){return this.scene?.imageLoader}closestDatum(){for(const{datum:t}of this.traverseUp(!0))if(t!=null)return t}preRender(t,i=1){if(this.childNodeCounts.groups=0,this.childNodeCounts.nonGroups=1,this.childNodeCounts.complexity=i,this.childNodeCounts.thisComplexity=i,this.batchLevel>0||this.batchDirty)throw new Error("AG Charts - illegal rendering state; batched update in progress");return this.childNodeCounts}isolatedRender(t){t.ctx.save();try{this.render(t)}catch(i){const s=i.errorCount??1;if(s>=gG)throw i.errorCount=s,i;j.warnOnce("Error during rendering",i,i.stack)}finally{t.ctx.restore()}}render(t){const{stats:i}=t;if(this.debugDirtyProperties(),t.debugNodeSearch){const s=this.name??this.id;t.debugNodeSearch.some(n=>typeof n=="string"?n===s:n.test(s))&&(t.debugNodes[this.name??this.id]=this)}i&&(i.nodesRendered++,i.opsPerformed+=this.childNodeCounts.thisComplexity)}setScene(t){this.scene=t}*traverseUp(t){t&&(yield this);let i=this.parentNode;for(;i;)yield i,i=i.parentNode}isRoot(){return!this.parentNode}removeChild(t){throw new Error(`AG Charts - internal error, unknown child node ${t.name??t.id} in $${this.name??this.id}`)}remove(){this.parentNode?.removeChild(this)}destroy(){this.parentNode&&this.remove()}batchedUpdate(t){this.batchLevel++,t(),this.batchLevel--,this.batchLevel===0&&this.batchDirty&&(this.markDirty(),this.batchDirty=!1)}setProperties(t){return this.batchLevel++,Fm(this,t),this.batchLevel--,this.batchLevel===0&&this.batchDirty&&(this.markDirty(),this.batchDirty=!1),this}setPropertiesWithKeys(t,i){return this.batchLevel++,Fm(this,t,i),this.batchLevel--,this.batchLevel===0&&this.batchDirty&&(this.markDirty(),this.batchDirty=!1),this}containsPoint(t,i){return!1}pickNode(t,i){if(this.containsPoint(t,i))return this}pickNodes(t,i,s=[]){return this.containsPoint(t,i)&&s.push(this),s}getBBox(){return this.cachedBBox??(this.cachedBBox=Object.freeze(this.computeBBox())),this.cachedBBox}computeBBox(){}onChangeDetection(t){this.markDirty(t)}markDirtyChildrenOrder(){this.cachedBBox=void 0}markDirty(t){if(this.batchLevel>0){this.batchDirty=!0;return}t!=null&&this._debugDirtyProperties&&this.markDebugProperties(t),this.cachedBBox=void 0,this.parentNode?.markDirty()}markDebugProperties(t){const i=this._debugDirtyProperties?.get(t)??[],s=new Error("Stack trace for property change tracking").stack?.split(`
`).filter(n=>n!=="Error"&&!n.includes(".markDebugProperties")&&!n.includes(".markDirty")&&!n.includes("Object.assign ")&&!n.includes(`${this.constructor.name}.`))??"unknown";i.push(s[0].replace(" at ","").trim()),this._debugDirtyProperties?.set(t,i)}debugDirtyProperties(){if(this._debugDirtyProperties!=null){if(!this._debugDirtyProperties.has("__first__"))for(const[t,i]of this._debugDirtyProperties.entries())i.length>1&&j.logGroup(`Property changed multiple times before render: ${this.constructor.name}.${t} (${i.length}x)`,()=>{for(const s of i)j.log(s)});this._debugDirtyProperties.clear()}}static handleNodeZIndexChange(t){t.onZIndexChange()}onZIndexChange(){this.parentNode?.markDirtyChildrenOrder()}toSVG(){}};Gc.className="AbstractNode",Gc._nextSerialNumber=0,Gc._debugEnabled=!1,g([_e()],Gc.prototype,"visible",2),g([_e({equals:ii,changeCb:Gc.handleNodeZIndexChange})],Gc.prototype,"zIndex",2);var vr=Gc,_y=class{ticks(e,t,i){}niceDomain(e,t=this.domain){return t}get bandwidth(){}get step(){}get inset(){}},Vy=(e,t)=>{const i=Symbol(String(t));e[i]=void 0,Object.defineProperty(e,t,{get(){return this[i]},set(s){this[i]!==s&&(this[i]=s,this.invalid=!0)},enumerable:!0,configurable:!1})};function Hw(e,t,i){if(i==null||i[0]===0&&i[1]===1)return;const s=ge(0,Math.floor(i[0]*e.length),e.length),n=ge(0,Math.ceil(i[1]*e.length),e.length),o=t?e.length-n:s,a=t?e.length-s:n;return[o,a]}function fG(e,t,i){return Hw(e,t,i)??[0,e.length]}function jw(e,t,i){const s=Hw(e,t,i);if(s==null)return{ticks:e,count:e.length,firstTickIndex:0};const[n,o]=s;return{ticks:e.slice(n,o),count:e.length,firstTickIndex:n}}function Gy(e){const t=Ny(e.at(0)),i=Ny(e.at(-1));return t!=null&&i!=null?[t,i]:[void 0,void 0]}var Ww=e=>{const t=Be.fromString(e),[i,s,n]=Be.RGBtoOKLCH(t.r,t.g,t.b);return{l:i,c:s,h:n,a:t.a}},fM=1e-6,$w=e=>e.c<fM||e.l<fM||e.l>1-fM,mG=(e,t,i)=>{i=ge(0,i,1);let s;if($w(e))s=t.h;else if($w(t))s=e.h;else{const r=e.h;let l=t.h;const c=t.h-e.h;c>180?l-=360:c<-180&&(l+=360),s=r*(1-i)+l*i}const n=e.c*(1-i)+t.c*i,o=e.l*(1-i)+t.l*i,a=e.a*(1-i)+t.a*i;return Be.fromOKLCH(o,n,s,a)},Xd=class extends _y{constructor(){super(...arguments),this.type="color",this.defaultTickCount=0,this.invalid=!0,this.domain=[0,1],this.range=["red","blue"],this.parsedRange=this.range.map(Ww)}update(){const{domain:e,range:t}=this;e.length<2&&(j.warnOnce("`colorDomain` should have at least 2 values."),e.length===0?e.push(0,1):e.length===1&&e.push(e[0]+1));for(let i=1;i<e.length;i++){const s=e[i-1],n=e[i];if(s>n){j.warnOnce("`colorDomain` values should be supplied in ascending order."),e.sort((o,a)=>o-a);break}}if(t.length<e.length)for(let i=t.length;i<e.length;i++)t.push(t.length>0?t[0]:"black");this.parsedRange=this.range.map(Ww)}normalizeDomains(...e){return{domain:e.map(t=>t.domain).flat(),animatable:!0}}toDomain(){}convert(e){this.refresh();const{domain:t,range:i,parsedRange:s}=this,n=t[0],o=t.at(-1),a=i[0],r=i.at(-1);if(e<=n)return a;if(e>=o)return r;let l,c;if(t.length===2){const u=(e-n)/(o-n),p=1/(i.length-1);l=i.length<=2?0:Math.min(Math.floor(u*(i.length-1)),i.length-2),c=(u-l*p)/p}else{for(l=0;l<t.length-2&&!(e<t[l+1]);l++);const u=t[l],p=t[l+1];c=(e-u)/(p-u)}const h=s[l],d=s[l+1];return mG(h,d,c).toRgbaString()}invert(){}getDomainMinMax(){return Gy(this.domain)}refresh(){this.invalid&&(this.invalid=!1,this.update(),this.invalid&&j.warnOnce("Expected update to not invalidate scale"))}};g([Vy],Xd.prototype,"domain",2),g([Vy],Xd.prototype,"range",2);var mM=class{constructor(e,t=[],i){this.colorSpace=e,this.stops=t,this.bbox=i,this._cache=void 0}createGradient(e,t,i){const s=this.bbox??t;if(!s.isFinite())return;if(this._cache!=null&&this._cache.ctx===e&&this._cache.bbox.equals(s))return this._cache.gradient;const{stops:n,colorSpace:o}=this;if(n.length===0)return;if(n.length===1)return n[0].color;let a=this.createCanvasGradient(e,s,i);if(a==null)return;const r=o==="oklch",l=.05;let c=n[0];a.addColorStop(c.stop,c.color);for(let h=1;h<n.length;h+=1){const d=n[h];if(r){const u=new Xd;u.domain=[c.stop,d.stop],u.range=[c.color,d.color];for(let p=c.stop+l;p<d.stop;p+=l)a.addColorStop(p,u.convert(p)??"transparent")}a.addColorStop(d.stop,d.color),c=d}return"createPattern"in a&&(a=a.createPattern()),this._cache={ctx:e,bbox:s,gradient:a},a}toSvg(e){const t=this.bbox??e,i=this.createSvgGradient(t);for(const{stop:s,color:n}of this.stops){const o=Pt("stop");o.setAttribute("offset",`${s}`),o.setAttribute("stop-color",`${n}`),i.appendChild(o)}return i}},yG=class extends mM{constructor(e,t,i=0,s){super(e,t,s),this.angle=i}createCanvasGradient(e,t,i){const{angle:n}=this,o=Po(n+-90),a=i?.centerX??t.x+t.width*.5,r=i?.centerY??t.y+t.height*.5;return e.createConicGradient(o,a,r)}createSvgGradient(e){return Pt("linearGradient")}},xG=class extends mM{constructor(e,t,i=0,s){super(e,t,s),this.angle=i}getGradientPoints(e){const{angle:i}=this,s=Po(i+90),n=Math.cos(s),o=Math.sin(s),a=e.width,r=e.height,l=e.x+a*.5,c=e.y+r*.5,h=Math.hypot(r,a)/2,d=Math.atan2(r,a);let u;s<Math.PI/2?u=s:s<Math.PI?u=Math.PI-s:s<1.5*Math.PI?u=s-Math.PI:u=2*Math.PI-s;const p=h*Math.abs(Math.cos(u-d));return{x0:l+n*p,y0:c+o*p,x1:l-n*p,y1:c-o*p}}createCanvasGradient(e,t){const{x0:i,y0:s,x1:n,y1:o}=this.getGradientPoints(t);if(!(Number.isNaN(i)||Number.isNaN(s)||Number.isNaN(n)||Number.isNaN(o)))return e.createLinearGradient(i,s,n,o)}createSvgGradient(e){const{x0:t,y0:i,x1:s,y1:n}=this.getGradientPoints(e),o=Pt("linearGradient");return o.setAttribute("x1",String(t)),o.setAttribute("y1",String(i)),o.setAttribute("x2",String(s)),o.setAttribute("y2",String(n)),o.setAttribute("gradientUnits","userSpaceOnUse"),o}},bG=class extends mM{constructor(e,t,i){super(e,t,i)}createCanvasGradient(e,t,i){const s=i?.centerX??t.x+t.width*.5,n=i?.centerY??t.y+t.height*.5,o=i?.innerRadius??0,a=i?.outerRadius??Math.hypot(t.width*.5,t.height*.5)/Math.SQRT2;return e.createRadialGradient(s,n,o,s,n,a)}createSvgGradient(e){const t=e.x+e.width*.5,i=e.y+e.height*.5,s=Pt("radialGradient");return s.setAttribute("cx",String(t)),s.setAttribute("cy",String(i)),s.setAttribute("r",String(Math.hypot(e.width*.5,e.height*.5)/Math.SQRT2)),s.setAttribute("gradientUnits","userSpaceOnUse"),s}},yM=class extends K{constructor(){super(...arguments),this.color="black"}};g([m],yM.prototype,"stop",2),g([m],yM.prototype,"color",2);function vG(e){let t;for(const i of e)if(i?.stop!=null){if(t!=null&&i.stop<t)return!1;t=i.stop}return!0}function Uw(e){return e.flatMap((t,i)=>{const{stop:s}=t,n=e.at(i+1)?.color;return n==null?[t]:[t,{stop:s,color:n}]})}function SG(e,t){const i=t==="discrete"?1:0,s=e.map((n,o,{length:a})=>({stop:(o+i)/(a-1+i),color:n}));return t==="discrete"?Uw(s):s}function Kw(e,t,i,s="continuous"){const n=e.map(f=>typeof f=="string"?{color:f}:f);if(n.length===0)return SG(t,s);if(!vG(n))return j.warnOnce("[fills] must have the stops defined in ascending order"),[];const o=Math.min(...i),a=Math.max(...i),r=s==="discrete",l=new Float64Array(n.length);let c=0,h=-1;for(let f=0;f<n.length;f+=1){const y=n[f];if(f>=h){h=n.length-1;for(let x=f+1;x<n.length;x+=1)if(n[x]?.stop!=null){h=x;break}}let b=y?.stop;if(b==null){const x=n[c]?.stop,v=n[h]?.stop,S=x??o,M=v??a,D=r&&x==null?1:0;b=S+(M-S)*(f-c+D)/(h-c+D)}else c=f;l[f]=Math.max(0,Math.min(1,(b-o)/(a-o)))}let d=n.find(f=>f.color!=null)?.color,u;const p=n.map((f,y)=>{let b=f?.color;const x=l[y];return b!=null?d=b:d==null?(u==null&&(u=new Xd,u.domain=[0,1],u.range=t),b=u.convert(x)):b=d,{stop:x,color:b}});return s==="discrete"?Uw(p):p}var MG=class{constructor(e,t){this.imageLoader=e,this._cache=void 0,this.url=t.url,this.backgroundFill=t.backgroundFill??"black",this.backgroundFillOpacity=t.backgroundFillOpacity??1,this.repeat=t.repeat??"no-repeat",this.width=t.width,this.height=t.height,this.fit=t.fit??"stretch",this.rotation=t.rotation??0}createCanvasImage(e,t,i,s){if(!t)return null;const[n,o]=this.getSize(t.width,t.height,i,s);return n<1||o<1?(j.warnOnce("Image fill is too small to render, ignoring."),null):e.createPattern(t,this.repeat)}getSize(e,t,i,s){const{fit:n}=this;let o=e,a=t,r=1;const l=i/s,c=e/t;return n==="stretch"||e===0||t===0?(o=i,a=s):n==="contain"?r=c>l?i/e:s/t:n==="cover"&&(r=c>l?s/t:i/e),[Math.max(1,o*r),Math.max(1,a*r)]}setImageTransform(e,t){if(typeof e=="string")return;const{url:i,rotation:s,width:n,height:o}=this,a=this.imageLoader?.loadImage(i);if(!a)return;const r=Po(s),l=Math.cos(r),c=Math.sin(r),[h,d]=this.getSize(a.width,a.height,n??t.width,o??t.height),u=h/a.width,p=d/a.height,f=t.x+t.width/2,y=t.y+t.height/2,b=l*h-c*d,x=c*h+l*d,v=b/2,S=x/2;e?.setTransform(new DOMMatrix([l*u,c*p,-c*u,l*p,f-v,y-S]))}createPattern(e,t,i,s){const n=this.width??t,o=this.height??i,a=this._cache;if(a!=null&&a.ctx===e&&a.width===n&&a.height===o)return a.pattern;const r=this.imageLoader?.loadImage(this.url,s),l=this.createCanvasImage(e,r,n,o);if(l!=null)return this._cache={ctx:e,pattern:l,width:n,height:o},l}toSvg(e,t){const{url:i,rotation:s,backgroundFill:n,backgroundFillOpacity:o}=this,{x:a,y:r,width:l,height:c}=e,h=Pt("pattern");h.setAttribute("viewBox",`0 0 ${l} ${c}`),h.setAttribute("x",String(a)),h.setAttribute("y",String(r)),h.setAttribute("width",String(l)),h.setAttribute("height",String(c)),h.setAttribute("patternUnits","userSpaceOnUse");const d=Pt("rect");d.setAttribute("x","0"),d.setAttribute("y","0"),d.setAttribute("width",String(l)),d.setAttribute("height",String(c)),d.setAttribute("fill",n),d.setAttribute("fill-opacity",String(o)),h.appendChild(d);const u=Pt("image");return u.setAttribute("href",i),u.setAttribute("x","0"),u.setAttribute("y","0"),u.setAttribute("width",String(l)),u.setAttribute("height",String(c)),u.setAttribute("preserveAspectRatio","none"),u.setAttribute("transform",`scale(${1/t}) rotate(${s}, ${l/2}, ${c/2})`),h.appendChild(u),h}},DG=/^[\t\n\f\r ]*([achlmqstvz])[\t\n\f\r ]*/i,At=/^[+-]?((\d*\.\d+)|(\d+\.)|(\d+))(e[+-]?\d+)?/i,IG=/[\t\n\f\r ]*,?[\t\n\f\r ]*/,Yw=/^[01]/,kG={z:[],h:[At],v:[At],m:[At,At],l:[At,At],t:[At,At],s:[At,At,At,At],q:[At,At,At,At],c:[At,At,At,At,At,At],a:[At,At,At,Yw,Yw,At,At]};function AG(e){if(!e)return;const t=[];let i=0,s;for(;i<e.length;){const n=DG.exec(e.slice(i));let o;if(n==null){if(!s){j.warnOnce(`Invalid SVG path, error at index ${i}: Missing command.`);return}o=s}else o=n[1],i+=n[0].length;const a=CG(o,e,i);if(!a)return;i=a[0],s=o,t.push(a[1])}return t}function CG(e,t,i){const s=kG[e.toLocaleLowerCase()],n={command:e,params:[]};for(const o of s){const a=t.slice(i),r=o.exec(a);if(r!=null){n.params.push(Number.parseFloat(r[0])),i+=r[0].length;const l=IG.exec(a.slice(r[0].length));l!=null&&(i+=l[0].length)}else{if(n.params.length===1)return[i,n];j.warnOnce(`Invalid SVG path, error at index ${i}: No path segment parameters for command [${e}]`);return}}return[i,n]}function LG(e,t){const i=-t/e;return e!==0&&i>=0&&i<=1?[i]:[]}function wG(e,t,i,s=1e-6){if(Math.abs(e)<s)return LG(t,i);const n=t*t-4*e*i,o=[];if(Math.abs(n)<s){const a=-t/(2*e);a>=0&&a<=1&&o.push(a)}else if(n>0){const a=Math.sqrt(n),r=(-t-a)/(2*e),l=(-t+a)/(2*e);r>=0&&r<=1&&o.push(r),l>=0&&l<=1&&o.push(l)}return o}function TG(e,t,i,s,n=1e-6){if(Math.abs(e)<n)return wG(t,i,s,n);const o=t/e,a=i/e,r=s/e,l=(3*a-o*o)/9,c=(9*o*a-27*r-2*o*o*o)/54,h=l*l*l+c*c,d=1/3,u=[];if(h>=0){const p=Math.sqrt(h),f=Math.sign(c+p)*Math.pow(Math.abs(c+p),d),y=Math.sign(c-p)*Math.pow(Math.abs(c-p),d),b=Math.abs(Math.sqrt(3)*(f-y)/2),x=-d*o+(f+y);if(x>=0&&x<=1&&u.push(x),Math.abs(b)<n){const v=-d*o-(f+y)/2;v>=0&&v<=1&&u.push(v)}}else{const p=Math.acos(c/Math.sqrt(-l*l*l)),f=d*o,y=2*Math.sqrt(-l),b=y*Math.cos(d*p)-f,x=y*Math.cos(d*(p+2*Math.PI))-f,v=y*Math.cos(d*(p+4*Math.PI))-f;b>=0&&b<=1&&u.push(b),x>=0&&x<=1&&u.push(x),v>=0&&v<=1&&u.push(v)}return u}function Ag(e,t,i,s,n,o,a,r){const l=(i-e)*(r-o)-(s-t)*(a-n);if(l===0)return 0;const c=((a-n)*(t-o)-(e-n)*(r-o))/l,h=((i-e)*(t-o)-(s-t)*(e-n))/l;return c>=0&&c<=1&&h>=0&&h<=1?1:0}function NG(e,t,i,s,n,o,a,r,l,c,h,d){let u=0;const p=c-d,f=h-l,y=l*(d-c)-c*(h-l),b=Zw(e,i,n,a),x=Zw(t,s,o,r),v=p*b[0]+f*x[0],S=p*b[1]+f*x[1],M=p*b[2]+f*x[2],D=p*b[3]+f*x[3]+y,k=TG(v,S,M,D);for(const I of k){const A=I*I,C=I*A,w=b[0]*C+b[1]*A+b[2]*I+b[3],T=x[0]*C+x[1]*A+x[2]*I+x[3];let O;l===h?O=(T-c)/(d-c):O=(w-l)/(h-l),O>=0&&O<=1&&u++}return u}function Zw(e,t,i,s){return[-e+3*t-3*i+s,3*e-6*t+3*i,-3*e+3*t,e]}var qd=class{constructor(){this.path2d=new Path2D,this.previousCommands=[],this.previousParams=[],this.previousClosedPath=!1,this.commands=[],this.params=[],this.commandsLength=0,this.paramsLength=0,this.cx=Number.NaN,this.cy=Number.NaN,this.sx=Number.NaN,this.sy=Number.NaN,this.openedPath=!1,this.closedPath=!1}isEmpty(){return this.commandsLength===0}isDirty(){return this.closedPath!==this.previousClosedPath||this.previousCommands.length!==this.commandsLength||this.previousParams.length!==this.paramsLength||this.previousCommands.toString()!==this.commands.slice(0,this.commandsLength).toString()||this.previousParams.toString()!==this.params.slice(0,this.paramsLength).toString()}getPath2D(){return this.path2d}moveTo(e,t){this.openedPath=!0,this.sx=e,this.sy=t,this.cx=e,this.cy=t,this.path2d.moveTo(e,t),this.commands[this.commandsLength++]=0,this.params[this.paramsLength++]=e,this.params[this.paramsLength++]=t}lineTo(e,t){this.openedPath?(this.cx=e,this.cy=t,this.path2d.lineTo(e,t),this.commands[this.commandsLength++]=1,this.params[this.paramsLength++]=e,this.params[this.paramsLength++]=t):this.moveTo(e,t)}cubicCurveTo(e,t,i,s,n,o){this.openedPath||this.moveTo(e,t),this.path2d.bezierCurveTo(e,t,i,s,n,o),this.commands[this.commandsLength++]=2,this.params[this.paramsLength++]=e,this.params[this.paramsLength++]=t,this.params[this.paramsLength++]=i,this.params[this.paramsLength++]=s,this.params[this.paramsLength++]=n,this.params[this.paramsLength++]=o}closePath(){this.openedPath&&(this.cx=this.sx,this.cy=this.sy,this.sx=Number.NaN,this.sy=Number.NaN,this.path2d.closePath(),this.commands[this.commandsLength++]=3,this.openedPath=!1,this.closedPath=!0)}rect(e,t,i,s){this.moveTo(e,t),this.lineTo(e+i,t),this.lineTo(e+i,t+s),this.lineTo(e,t+s),this.closePath()}roundRect(e,t,i,s,n){n=Math.min(n,i/2,s/2),this.moveTo(e,t+n),this.arc(e+n,t+n,n,Math.PI,1.5*Math.PI),this.lineTo(e+n,t),this.lineTo(e+i-n,t),this.arc(e+i-n,t+n,n,1.5*Math.PI,2*Math.PI),this.lineTo(e+i,t+n),this.lineTo(e+i,t+s-n),this.arc(e+i-n,t+s-n,n,0,Math.PI/2),this.lineTo(e+i-n,t+s),this.lineTo(e+n,t+s),this.arc(e+ +n,t+s-n,n,Math.PI/2,Math.PI),this.lineTo(e,t+s-n),this.closePath()}ellipse(e,t,i,s,n,o,a,r=!1){const l=i,c=s/i,h=Math.cos(n),d=Math.sin(n),u=-c*d,p=c*h,f=l*Math.cos(o),y=l*Math.sin(o),b=e+h*f+u*y,x=t+d*f+p*y,v=(b-this.cx)**2+(x-this.cy)**2;this.openedPath?v>1e-6&&this.lineTo(b,x):this.moveTo(b,x);let S=r?-tt(o-a):tt(a-o);Math.abs(Math.abs(a-o)-2*Math.PI)<1e-6&&S<2*Math.PI&&(S+=2*Math.PI*(r?-1:1));const M=Math.max(Math.ceil(Math.abs(S)/(Math.PI/2)),1),D=S/M,k=4/3*Math.tan(D/4);for(let I=0;I<M;I+=1){const A=o+D*(I+0),C=o+D*(I+1),w=l*Math.sin(A),T=l*Math.cos(A),O=l*Math.sin(C),E=l*Math.cos(C),z=T-k*w,F=w+k*T,_=E+k*O,G=O-k*E,B=E,V=O;this.cubicCurveTo(e+h*z+u*F,t+d*z+p*F,e+h*_+u*G,t+d*_+p*G,e+h*B+u*V,t+d*B+p*V)}}arc(e,t,i,s,n,o){this.ellipse(e,t,i,i,0,s,n,o)}appendSvg(e){const t=AG(e);if(t==null)return!1;let i=0,s=0,n,o,a=0,r=0;for(const{command:l,params:c}of t){n??(n=c[0]),o??(o=c[1]);const h=l===l.toLowerCase(),d=h?n:0,u=h?o:0;switch(l.toLowerCase()){case"m":this.moveTo(d+c[0],u+c[1]),n=d+c[0],o=u+c[1],i=n,s=o;break;case"c":this.cubicCurveTo(d+c[0],u+c[1],d+c[2],u+c[3],d+c[4],u+c[5]),a=d+c[2],r=u+c[3],n=d+c[4],o=u+c[5];break;case"s":this.cubicCurveTo(n+n-a,o+o-r,d+c[0],u+c[1],d+c[2],u+c[3]),a=d+c[0],r=u+c[1],n=d+c[2],o=u+c[3];break;case"q":this.cubicCurveTo((d+2*c[0])/3,(u+2*c[1])/3,(2*c[0]+c[2])/3,(2*c[1]+c[3])/3,c[2],c[3]),a=c[0],r=c[1],n=c[2],o=c[3];break;case"t":this.cubicCurveTo((n+2*(n+n-a))/3,(o+2*(o+o-r))/3,(2*(n+n-a)+c[0])/3,(2*(o+o-r)+c[1])/3,c[0],c[1]),a=n+n-a,r=o+o-r,n=c[0],o=c[1];break;case"a":this.svgEllipse(n,o,c[0],c[1],c[2]*Math.PI/180,c[3],c[4],d+c[5],u+c[6]),n=d+c[5],o=u+c[6];break;case"h":this.lineTo(d+c[0],o),n=d+c[0];break;case"l":this.lineTo(d+c[0],u+c[1]),n=d+c[0],o=u+c[1];break;case"v":this.lineTo(n,u+c[0]),o=u+c[0];break;case"z":this.closePath(),n=i,o=s;break;default:throw new Error(`Could not translate command '${l}' with '${c.join(" ")}'`)}}return!0}svgEllipse(e,t,i,s,n,o,a,r,l){i=Math.abs(i),s=Math.abs(s);const c=(e-r)/2,h=(t-l)/2,d=Math.sin(n),u=Math.cos(n),p=u*c+d*h,f=-d*c+u*h,y=p/i,b=f/s;let x=y*y+b*b,v=(e+r)/2,S=(t+l)/2,M=0,D=0;x>=1?(x=Math.sqrt(x),i*=x,s*=x):(x=Math.sqrt(1/x-1),o===a&&(x=-x),M=x*i*b,D=-x*s*y,v+=u*M-d*D,S+=d*M+u*D);const k=Math.atan2((f-D)/s,(p-M)/i),I=Math.atan2((-f-D)/s,(-p-M)/i)-k,A=k+I,C=!!(1-a);this.ellipse(v,S,i,s,n,k,A,C)}clear(e){e?(this.previousCommands=this.commands.slice(0,this.commandsLength),this.previousParams=this.params.slice(0,this.paramsLength),this.previousClosedPath=this.closedPath,this.commands=[],this.params=[],this.commandsLength=0,this.paramsLength=0):(this.commandsLength=0,this.paramsLength=0),this.path2d=new Path2D,this.openedPath=!1,this.closedPath=!1}isPointInPath(e,t){const i=this.commands,s=this.params,n=this.commandsLength,o=-1e4,a=-1e4;let r=Number.NaN,l=Number.NaN,c=0,h=0,d=0;for(let u=0,p=0;u<n;u++)switch(i[u]){case 0:d+=Ag(r,l,c,h,o,a,e,t),c=s[p++],r=c,h=s[p++],l=h;break;case 1:d+=Ag(c,h,s[p++],s[p++],o,a,e,t),c=s[p-2],h=s[p-1];break;case 2:d+=NG(c,h,s[p++],s[p++],s[p++],s[p++],s[p++],s[p++],o,a,e,t),c=s[p-2],h=s[p-1];break;case 3:d+=Ag(r,l,c,h,o,a,e,t);break}return d%2===1}distanceSquared(e,t){let i=1/0;const s=this.commands,n=this.params,o=this.commandsLength;let a=Number.NaN,r=Number.NaN,l=0,c=0;for(let h=0,d=0;h<o;h++)switch(s[h]){case 0:l=a=n[d++],c=r=n[d++];break;case 1:{const u=l,p=c;l=n[d++],c=n[d++],i=dr(e,t,u,p,l,c,i);break}case 2:{const u=l,p=c,f=n[d++],y=n[d++],b=n[d++],x=n[d++];l=n[d++],c=n[d++],i=q0(u,p,f,y,b,x,l,c,e,t)**2;break}case 3:i=dr(e,t,l,c,a,r,i);break}return i}toSVG(e=(t,i)=>({x:t,y:i})){const t=[],{commands:i,params:s}=this,n=(a,r)=>{t.push(a);for(let l=0;l<r;l+=2){const{x:c,y:h}=e(s[o++],s[o++]);t.push(c,h)}};let o=0;for(let a=0;a<this.commandsLength;a++)switch(i[a]){case 0:n("M",2);break;case 1:n("L",2);break;case 2:n("C",6);break;case 3:n("Z",0);break}return t.join(" ")}computeBBox(){const{commands:e,params:t}=this;let[i,s,n,o]=[1/0,1/0,-1/0,-1/0],[a,r]=[Number.NaN,Number.NaN],[l,c]=[Number.NaN,Number.NaN];const h=(u,p)=>{i=Math.min(p,i),s=Math.min(u,s),n=Math.max(u,n),o=Math.max(p,o),a=u,r=p};let d=0;for(let u=0;u<this.commandsLength;u++)switch(e[u]){case 0:h(t[d++],t[d++]),l=a,c=r;break;case 1:h(t[d++],t[d++]);break;case 2:{const f=a,y=r,b=t[d++],x=t[d++],v=t[d++],S=t[d++],M=t[d++],D=t[d++],k=Z0(f,y,b,x,v,S,M,D);for(const I of k){const A=Bo(f,b,v,M,I),C=Bo(y,x,S,D,I);h(A,C)}h(M,D);break}case 3:h(l,c),l=Number.NaN,c=Number.NaN;break}return new re(s,i,n-s,o-i)}};function Ri(e,t,i){const s=Math.round(t*e)/e;return i==null?s:i===0?0:i<1?Math.ceil(i*e)/e:Math.round((i+t)*e)/e-s}function Xw(e,t){return Math.floor(t*e)/e}function xM(e,t,i){const{width:s,height:n,padding:o,strokeWidth:a}=t,r=s/2,l=n/2,c=Math.max(1,s-o-a/2),h=Math.max(1,n-o-a/2);let d=!1;for(const[u,p]of i){const f=r+(u-.5)*c,y=l+(p-.5)*h;d?e.lineTo(f,y):e.moveTo(f,y),d=!0}e.closePath()}var qw={circles(e,{width:t,strokeWidth:i,padding:s}){const n=t/2,o=Math.max(1,n-s-i/2);e.arc(n,n,o,0,Math.PI*2)},squares(e,{width:t,height:i,pixelRatio:s,padding:n,strokeWidth:o}){const a=n+o/2;e.moveTo(Ri(s,a),Ri(s,a)),e.lineTo(Ri(s,t-a),Ri(s,a)),e.lineTo(Ri(s,t-a),Ri(s,i-a)),e.lineTo(Ri(s,a),Ri(s,i-a)),e.closePath()},triangles(e,t){xM(e,t,[[.5,0],[1,1],[0,1]])},diamonds(e,t){xM(e,t,[[.5,0],[1,.5],[.5,1],[0,.5]])},stars(e,{width:t,height:i,padding:s}){const o=Math.max(1,(t-s)/2),a=o/2,r=Math.PI/2;for(let l=0;l<5*2;l++){const c=l%2===0?o:a,h=l*Math.PI/5-r,d=t/2+Math.cos(h)*c,u=i/2+Math.sin(h)*c;e.lineTo(d,u)}e.closePath()},hearts(e,{width:t,height:i,padding:s}){const n=Math.max(1,t/4-s/2),o=t/2,a=i/2+n/2;e.arc(o-n,a-n,n,mt(130),mt(330)),e.arc(o+n,a-n,n,mt(220),mt(50)),e.lineTo(o,a+n),e.closePath()},crosses(e,t){xM(e,t,[[.25,0],[.5,.25],[.75,0],[1,.25],[.75,.5],[1,.75],[.75,1],[.5,.75],[.25,1],[0,.75],[.25,.5],[0,.25]])},"vertical-lines"(e,{width:t,height:i,pixelRatio:s,strokeWidth:n}){const o=Ri(s,t/2)-n%2/2;e.moveTo(o,0),e.lineTo(o,i)},"horizontal-lines"(e,{width:t,height:i,pixelRatio:s,strokeWidth:n}){const o=Ri(s,i/2)-n%2/2;e.moveTo(0,o),e.lineTo(t,o)},"forward-slanted-lines"(e,{width:t,height:i,strokeWidth:s}){const n=Math.atan2(i,t),o=s*Math.cos(n),a=s*Math.sin(n);e.moveTo(-o,a),e.lineTo(o,-a),e.moveTo(-o,i+a),e.lineTo(t+o,-a),e.moveTo(t-o,i+a),e.lineTo(t+o,i-a)},"backward-slanted-lines"(e,{width:t,height:i,strokeWidth:s}){const n=Math.atan2(i,t),o=s*Math.cos(n),a=s*Math.sin(n);e.moveTo(t-o,-a),e.lineTo(t+o,a),e.moveTo(-o,-a),e.lineTo(t+o,i+a),e.moveTo(-o,i-a),e.lineTo(o,i+a)}},OG=class{constructor(e){this._cache=void 0,this.width=Math.max(e?.width??10,1),this.height=Math.max(e?.height??10,1),this.fill=e.fill??"none",this.fillOpacity=e.fillOpacity??1,this.backgroundFill=e.backgroundFill??"none",this.backgroundFillOpacity=e.backgroundFillOpacity??1,this.stroke=e.stroke??"black",this.strokeOpacity=e.strokeOpacity??1,this.strokeWidth=e.strokeWidth??1,this.padding=e.padding??1,this.pattern=e.pattern??"forward-slanted-lines",this.rotation=e.rotation??0,this.scale=e.scale??1,this.path=e.path}getPath(e){const{pattern:t,width:i,height:s,padding:n,strokeWidth:o,path:a}=this,r=new qd;let l=qw[t]!=null;return a&&l&&(l=!r.appendSvg(a)),l&&qw[t](r,{width:i,height:s,pixelRatio:e,strokeWidth:o,padding:n}),r}renderStroke(e,t){const{stroke:i,strokeWidth:s,strokeOpacity:n}=this;s&&(t.strokeStyle=i,t.lineWidth=s,t.globalAlpha=n,t.stroke(e))}renderFill(e,t){const{fill:i,fillOpacity:s}=this;i!=="none"&&(t.fillStyle=i,t.globalAlpha=s,t.fill(e))}createCanvasPattern(e,t){const{width:i,height:s,scale:n,backgroundFill:o,backgroundFillOpacity:a}=this;if(i*n<1||s*n<1)return j.warnOnce("Pattern fill is too small to render, ignoring."),null;const r=new pM({width:i,height:s,pixelRatio:t*n}),l=r.context;o!=="none"&&(l.fillStyle=o,l.globalAlpha=a,l.fillRect(0,0,i,s));const c=this.getPath(t).getPath2D();this.renderFill(c,l),this.renderStroke(c,l);const h=e.createPattern(r.canvas,"repeat");return this.setPatternTransform(h,t),r.destroy(),h}setPatternTransform(e,t,i=0,s=0){if(e==null)return;const n=Po(this.rotation),o=1/t,a=Math.cos(n)*o,r=Math.sin(n)*o;e.setTransform(new DOMMatrix([a,r,-r,a,i,s]))}createPattern(e,t){if(this._cache!=null&&this._cache.ctx===e&&this._cache.pixelRatio===t)return this._cache.pattern;const i=this.createCanvasPattern(e,t);if(i!=null)return this._cache={ctx:e,pattern:i,pixelRatio:t},i}toSvg(){const{width:e,height:t,fill:i,fillOpacity:s,backgroundFill:n,backgroundFillOpacity:o,stroke:a,strokeWidth:r,strokeOpacity:l,rotation:c,scale:h}=this,d=Pt("pattern");d.setAttribute("viewBox",`0 0 ${e} ${t}`),d.setAttribute("width",String(e)),d.setAttribute("height",String(t)),d.setAttribute("patternUnits","userSpaceOnUse");const u=Pt("rect");u.setAttribute("x","0"),u.setAttribute("y","0"),u.setAttribute("width",String(e)),u.setAttribute("height",String(t)),u.setAttribute("fill",n),u.setAttribute("fill-opacity",String(o)),d.appendChild(u);const p=Pt("path");return p.setAttribute("fill",i),p.setAttribute("fill-opacity",String(s)),p.setAttribute("stroke-opacity",String(l)),p.setAttribute("stroke",a),p.setAttribute("stroke-width",String(r)),p.setAttribute("transform",`rotate(${c}) scale(${h})`),p.setAttribute("d",this.getPath(1).toSVG()),d.appendChild(p),d}};function Qw(e,t){const{fontStyle:i,fontWeight:s,fontSize:n,fontFamily:o}=t;i&&e.setAttribute("font-style",i),s&&e.setAttribute("font-weight",String(s)),n!=null&&e.setAttribute("font-size",String(n)),o&&e.setAttribute("font-family",o)}function EG(e,t){const{stroke:i,strokeWidth:s,strokeOpacity:n}=t;i&&e.setAttribute("stroke",i),s!=null&&e.setAttribute("stroke-width",String(s)),n!=null&&e.setAttribute("stroke-opacity",String(n))}function PG(e,t){const{lineDash:i,lineDashOffset:s}=t;if(i?.some(n=>n!==0)){const n=i.length%2===1?[...i,...i]:i;e.setAttribute("stroke-dasharray",n.join(" ")),s!=null&&e.setAttribute("stroke-dashoffset",String(s))}}var $i=class extends vr{constructor(){super(...arguments),this.drawingMode="overlay",this.fillOpacity=1,this.strokeOpacity=1,this.fill="black",this.strokeWidth=0,this.lineDashOffset=0,this.opacity=1}getGradient(t){if(Ut(t))return this.createGradient(t)}createGradient(t){const{colorSpace:i="rgb",gradient:s="linear",colorStops:n,rotation:o=0,reverse:a=!1}=t;if(n==null)return;let r=Kw(n,["black"],[0,1]);switch(a&&(r=r.map(l=>({color:l.color,stop:1-l.stop})).reverse()),s){case"linear":return new xG(i,r,o);case"radial":return new bG(i,r);case"conic":return new yG(i,r,o)}}getPattern(t){if(Tn(t))return this.createPattern(t)}createPattern(t){return new OG(t)}getImage(t){if(zo(t))return this.createImage(t)}createImage(t){return new MG(this.imageLoader,t)}onFillChange(){typeof this.fill=="object"&&ii(this._cachedFill??{},this.fill)||(this.fillGradient=this.getGradient(this.fill),this.fillPattern=this.getPattern(this.fill),this.fillImage=this.getImage(this.fill),this._cachedFill=this.fill)}onStrokeChange(){this.strokeGradient=this.getGradient(this.stroke)}align(t,i){return Ri(this.layerManager?.canvas?.pixelRatio??1,t,i)}markDirty(t){super.markDirty(t),this.cachedDefaultGradientFillBBox=void 0}fillStroke(t,i){this.__drawingMode==="cutout"&&(t.globalCompositeOperation="destination-out",this.executeFill(t,i),this.executeStroke(t,i),t.globalCompositeOperation="source-over"),this.renderFill(t,i),this.renderStroke(t,i)}renderFill(t,i){const{__fill:s,__fillOpacity:n=1,fillImage:o}=this;if(s!=null&&s!=="none"&&n>0){const a=t.globalAlpha;o&&(t.globalAlpha=o.backgroundFillOpacity,t.fillStyle=o.backgroundFill,this.executeFill(t,i),t.globalAlpha=a),this.applyFillAndAlpha(t),this.applyShadow(t),this.executeFill(t,i),t.globalAlpha=a,this.fillShadow?.enabled&&(t.shadowColor="rgba(0, 0, 0, 0)")}}executeFill(t,i){i?t.fill(i):t.fill()}applyFillAndAlpha(t){const{__fill:i,fillGradient:s,fillPattern:n,fillImage:o,__fillOpacity:a=1,__opacity:r=1}=this,l=r*a;if(l!==1&&(t.globalAlpha*=l),s){const{fillBBox:c=this.getDefaultGradientFillBBox()??this.getBBox(),fillParams:h}=this;t.fillStyle=s.createGradient(t,c,h)??"black"}else if(n){const{x:c,y:h}=this.getBBox(),d=this.layerManager?.canvas?.pixelRatio??1,u=n.createPattern(t,d);n.setPatternTransform(u,d,c,h),u?t.fillStyle=u:(t.fillStyle=n.fill,t.globalAlpha*=n.fillOpacity)}else if(o){const c=this.getBBox(),h=o.createPattern(t,c.width,c.height,this);o.setImageTransform(h,c),t.fillStyle=h??"transparent"}else t.fillStyle=typeof i=="string"?i:"black"}applyStrokeAndAlpha(t){const{__stroke:i,__strokeOpacity:s=1,strokeGradient:n,__opacity:o=1}=this;t.strokeStyle=n?.createGradient(t,this.getBBox())??(typeof i=="string"?i:void 0)??"black";const a=o*s;a!==1&&(t.globalAlpha*=a)}applyShadow(t){const i=this.layerManager?.canvas.pixelRatio??1,{__fillShadow:s}=this;s?.enabled&&(t.shadowColor=s.color,t.shadowOffsetX=s.xOffset*i,t.shadowOffsetY=s.yOffset*i,t.shadowBlur=s.blur*i)}renderStroke(t,i){const{__stroke:s,__strokeWidth:n=0,__strokeOpacity:o=1,__lineDash:a,__lineDashOffset:r,__lineCap:l,__lineJoin:c,__miterLimit:h}=this;if(s!=null&&s!=="none"&&n>0&&o>0){const{globalAlpha:d}=t;this.applyStrokeAndAlpha(t),t.lineWidth=n,a&&t.setLineDash(a),r&&(t.lineDashOffset=r),l&&(t.lineCap=l),c&&(t.lineJoin=c),h!=null&&(t.miterLimit=h),this.executeStroke(t,i),t.globalAlpha=d}}executeStroke(t,i){i?t.stroke(i):t.stroke()}getDefaultGradientFillBBox(){return this.cachedDefaultGradientFillBBox??(this.cachedDefaultGradientFillBBox=Object.freeze(this.computeDefaultGradientFillBBox())),this.cachedDefaultGradientFillBBox}computeDefaultGradientFillBBox(){}containsPoint(t,i){return this.isPointInPath(t,i)}applySvgFillAttributes(t,i){const{fill:s,fillOpacity:n}=this;if(typeof s=="string")t.setAttribute("fill",s);else if(Ut(s)&&this.fillGradient){i??(i=[]);const o=this.fillGradient.toSvg(this.fillBBox??this.getBBox()),a=Od();o.setAttribute("id",a),i.push(o),t.setAttribute("fill",`url(#${a})`)}else if(Tn(s)&&this.fillPattern){i??(i=[]);const o=this.fillPattern.toSvg(),a=Od();o.setAttribute("id",a),i.push(o),t.setAttribute("fill",`url(#${a})`)}else if(zo(s)&&this.fillImage){i??(i=[]);const o=this.layerManager?.canvas?.pixelRatio??1,a=this.fillImage.toSvg(this.getBBox(),o),r=Od();a.setAttribute("id",r),i.push(a),t.setAttribute("fill",`url(#${r})`)}else t.setAttribute("fill","none");return t.setAttribute("fill-opacity",String(n)),i}applySvgStrokeAttributes(t){const{stroke:i,strokeOpacity:s,strokeWidth:n,lineDash:o,lineDashOffset:a}=this;EG(t,{stroke:Rt(i)?i:void 0,strokeOpacity:s,strokeWidth:n}),PG(t,{lineDash:o,lineDashOffset:a})}static handleFillChange(t){t.onFillChange()}static handleStrokeChange(t){t.onStrokeChange()}setStyleProperties(t,i,s){const n=t?.opacity??1,o=t?.fill,a=(t?.fillOpacity??1)*n,r=(t?.strokeOpacity??1)*n,l=t?.strokeWidth??0,c=t?.lineDashOffset??0;let h=!1;this.__fillOpacity!==a&&(this.__fillOpacity=a,h=!0),this.__strokeOpacity!==r&&(this.__strokeOpacity=r,h=!0),this.__strokeWidth!==l&&(this.__strokeWidth=l,h=!0),this.__lineDashOffset!==c&&(this.__lineDashOffset=c,h=!0),this.__lineDash!==t?.lineDash&&(this.__lineDash=t?.lineDash,h=!0),this.setFillProperties(o,i,s),o!==this.fill&&(this.fill=o),t?.stroke!==this.stroke&&(this.stroke=t?.stroke),h&&this.markDirty()}setFillProperties(t,i,s){const n=i==null||!Ut(t)||t.bounds==null||t.bounds==="item"?void 0:i[t.bounds];let o=!1;this.__fillBBox!==n&&(this.__fillBBox=n,o=!0),this.__fillParams!==s&&(this.__fillParams=s,o=!0),o&&(this.onFillChange(),this.markDirty())}};g([_e()],$i.prototype,"drawingMode",2),g([_e()],$i.prototype,"fillOpacity",2),g([_e()],$i.prototype,"strokeOpacity",2),g([Zd({equals:ii,changeCb:$i.handleFillChange})],$i.prototype,"fill",2),g([br({equals:ii,changeCb:$i.handleStrokeChange})],$i.prototype,"stroke",2),g([_e()],$i.prototype,"strokeWidth",2),g([Yd()],$i.prototype,"lineDash",2),g([_e()],$i.prototype,"lineDashOffset",2),g([_e()],$i.prototype,"lineCap",2),g([_e()],$i.prototype,"lineJoin",2),g([_e()],$i.prototype,"miterLimit",2),g([_e({convertor:e=>ge(0,e??1,1)})],$i.prototype,"opacity",2),g([br({equals:Vc,checkDirtyOnAssignment:!0})],$i.prototype,"fillShadow",2),g([Zd({equals:cg,changeCb:e=>e.onFillChange()})],$i.prototype,"fillBBox",2),g([Zd({equals:ii,changeCb:e=>e.onFillChange()})],$i.prototype,"fillParams",2);var Hc=$i,Jw=[1,0,0,1,0,0],jc=class Xv{get e(){return[...this.elements]}constructor(t=Jw){this.elements=[...t]}setElements(t){const i=this.elements;return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],this}get identity(){const t=this.elements;return qe(t[0],1)&&qe(t[1],0)&&qe(t[2],0)&&qe(t[3],1)&&qe(t[4],0)&&qe(t[5],0)}AxB(t,i,s){const n=t[0]*i[0]+t[2]*i[1],o=t[1]*i[0]+t[3]*i[1],a=t[0]*i[2]+t[2]*i[3],r=t[1]*i[2]+t[3]*i[3],l=t[0]*i[4]+t[2]*i[5]+t[4],c=t[1]*i[4]+t[3]*i[5]+t[5];s=s??t,s[0]=n,s[1]=o,s[2]=a,s[3]=r,s[4]=l,s[5]=c}multiplySelf(t){return this.AxB(this.elements,t.elements),this}multiply(t){const i=[Number.NaN,Number.NaN,Number.NaN,Number.NaN,Number.NaN,Number.NaN];return t instanceof Xv?this.AxB(this.elements,t.elements,i):this.AxB(this.elements,[t.a,t.b,t.c,t.d,t.e,t.f],i),new Xv(i)}preMultiplySelf(t){return this.AxB(t.elements,this.elements,this.elements),this}inverse(){const t=this.elements;let i=t[0],s=t[1],n=t[2],o=t[3];const a=t[4],r=t[5],l=1/(i*o-s*n);return i*=l,s*=l,n*=l,o*=l,new Xv([o,-s,-n,i,n*r-o*a,s*a-i*r])}invertSelf(){const t=this.elements;let i=t[0],s=t[1],n=t[2],o=t[3];const a=t[4],r=t[5],l=1/(i*o-s*n);return i*=l,s*=l,n*=l,o*=l,t[0]=o,t[1]=-s,t[2]=-n,t[3]=i,t[4]=n*r-o*a,t[5]=s*a-i*r,this}transformPoint(t,i){const s=this.elements;return{x:t*s[0]+i*s[2]+s[4],y:t*s[1]+i*s[3]+s[5]}}transformBBox(t,i){const s=this.elements,n=s[0],o=s[1],a=s[2],r=s[3],l=t.width*.5,c=t.height*.5,h=t.x+l,d=t.y+c,u=Math.abs(l*n)+Math.abs(c*a),p=Math.abs(l*o)+Math.abs(c*r);return i??(i=new re(0,0,0,0)),i.x=h*n+d*a+s[4]-u,i.y=h*o+d*r+s[5]-p,i.width=u+u,i.height=p+p,i}toContext(t){if(this.identity)return;const i=this.elements;t.transform(i[0],i[1],i[2],i[3],i[4],i[5])}static updateTransformMatrix(t,i,s,n,o,a,r){const l=i,c=s;let h,d;l===1&&c===1?(h=0,d=0):(h=r?.scalingCenterX??0,d=r?.scalingCenterY??0);const u=n,p=Math.cos(u),f=Math.sin(u);let y,b;u===0?(y=0,b=0):(y=r?.rotationCenterX??0,b=r?.rotationCenterY??0);const x=o,v=a,S=h*(1-l)-y,M=d*(1-c)-b;return t.setElements([p*l,f*l,-f*c,p*c,p*S-f*M+y+x,f*S+p*M+b+v]),t}};function Il(e){return tT(e.constructor)}var eT=Symbol("isMatrixTransform");function tT(e){return e[eT]===!0}function bM(e){var t,i;const s=e;if(tT(e))return e;const n=Symbol("matrix_combined_transform");class o extends s{constructor(){super(...arguments),this[i]=new jc,this._dirtyTransform=!0}onChangeDetection(r){super.onChangeDetection(r),this._dirtyTransform=!0,!(this.batchLevel>0)&&this.markDirty("transform")}updateMatrix(r){}computeTransformMatrix(){this._dirtyTransform&&(this[n].setElements(Jw),this.updateMatrix(this[n]),this._dirtyTransform=!1)}toParent(r){return this.computeTransformMatrix(),this[n].identity?r.clone():this[n].transformBBox(r)}toParentPoint(r,l){return this.computeTransformMatrix(),this[n].identity?{x:r,y:l}:this[n].transformPoint(r,l)}fromParent(r){return this.computeTransformMatrix(),this[n].identity?r.clone():this[n].inverse().transformBBox(r)}fromParentPoint(r,l){return this.computeTransformMatrix(),this[n].identity?{x:r,y:l}:this[n].inverse().transformPoint(r,l)}computeBBox(){const r=super.computeBBox();return r&&this.toParent(r)}computeBBoxWithoutTransforms(){return super.computeBBox()}pickNode(r,l){return{x:r,y:l}=this.fromParentPoint(r,l),super.pickNode(r,l)}pickNodes(r,l,c){return{x:r,y:l}=this.fromParentPoint(r,l),super.pickNodes(r,l,c)}render(r){this.computeTransformMatrix();const{ctx:l}=r,c=this[n];let h=!1;try{c.identity||(l.save(),h=!0,c.toContext(l)),super.render(r)}finally{h&&l.restore()}}toSVG(){this.computeTransformMatrix();const r=super.toSVG(),l=this[n];if(l.identity||r==null)return r;const c=Pt("g");c.append(...r.elements);const[h,d,u,p,f,y]=l.e;return c.setAttribute("transform",`matrix(${h} ${d} ${u} ${p} ${f} ${y})`),{elements:[c],defs:r.defs}}}return t=eT,i=n,o[t]=!0,o}function Qd(e){var t;const i=e,s=Symbol("matrix_rotation");class n extends bM(i){constructor(){super(...arguments),this[t]=new jc,this.rotationCenterX=0,this.rotationCenterY=0,this.rotation=0}updateMatrix(a){super.updateMatrix(a);const{rotation:r,rotationCenterX:l,rotationCenterY:c}=this;r!==0&&(jc.updateTransformMatrix(this[s],1,1,r,0,0,{rotationCenterX:l,rotationCenterY:c}),a.multiplySelf(this[s]))}}return t=s,g([U()],n.prototype,"rotationCenterX",2),g([U()],n.prototype,"rotationCenterY",2),g([U()],n.prototype,"rotation",2),n}function RG(e){return"scalingX"in e&&"scalingY"in e&&"scalingCenterX"in e&&"scalingCenterY"in e}function Hy(e){var t;const i=e,s=Symbol("matrix_scale");class n extends bM(i){constructor(){super(...arguments),this[t]=new jc,this.scalingX=1,this.scalingY=1,this.scalingCenterX=0,this.scalingCenterY=0}updateMatrix(a){super.updateMatrix(a);const{scalingX:r,scalingY:l,scalingCenterX:c,scalingCenterY:h}=this;r===1&&l===1||(jc.updateTransformMatrix(this[s],r,l,0,0,0,{scalingCenterX:c,scalingCenterY:h}),a.multiplySelf(this[s]))}resetScalingProperties(a,r,l,c){this.__scalingX=a,this.__scalingY=r,this.__scalingCenterX=l,this.__scalingCenterY=c,this.onChangeDetection("scaling")}}return t=s,g([U()],n.prototype,"scalingX",2),g([U()],n.prototype,"scalingY",2),g([U()],n.prototype,"scalingCenterX",2),g([U()],n.prototype,"scalingCenterY",2),n}function Jd(e){var t;const i=e,s=Symbol("matrix_translation");class n extends bM(i){constructor(){super(...arguments),this[t]=new jc,this.translationX=0,this.translationY=0}updateMatrix(a){super.updateMatrix(a);const{translationX:r,translationY:l}=this;r===0&&l===0||(jc.updateTransformMatrix(this[s],1,1,0,r,l),a.multiplySelf(this[s]))}}return t=s,g([U()],n.prototype,"translationX",2),g([U()],n.prototype,"translationY",2),n}var Kt=class{static fromCanvas(e,t){const i=[];for(const s of e.traverseUp())Il(s)&&i.unshift(s);for(const s of i)t=s.fromParent(t);return Il(e)&&(t=e.fromParent(t)),t}static toCanvas(e,t){t==null?t=e.getBBox():Il(e)&&(t=e.toParent(t));for(const i of e.traverseUp())Il(i)&&(t=i.toParent(t));return t}static fromCanvasPoint(e,t,i){const s=[];for(const n of e.traverseUp())Il(n)&&s.unshift(n);for(const n of s)({x:t,y:i}=n.fromParentPoint(t,i));return Il(e)&&({x:t,y:i}=e.fromParentPoint(t,i)),{x:t,y:i}}static toCanvasPoint(e,t,i){Il(e)&&({x:t,y:i}=e.toParentPoint(t,i));for(const s of e.traverseUp())Il(s)&&({x:t,y:i}=s.toParentPoint(t,i));return{x:t,y:i}}},Cg,vM=class em extends vr{constructor(t){super(t),this.childNodes=new Set,this.dirty=!1,this.dirtyZIndex=!1,this.clipRect=void 0,this.opacity=1,this.layer=void 0,this.image=void 0,this._lastWidth=Number.NaN,this._lastHeight=Number.NaN,this._lastDevicePixelRatio=Number.NaN,this.isContainerNode=!0,this.renderToOffscreenCanvas=t?.renderToOffscreenCanvas===!0,this.optimizeForInfrequentRedraws=t?.optimizeForInfrequentRedraws===!0}static is(t){return t instanceof em}static computeChildrenBBox(t,i=!0){return re.merge(vr.extractBBoxes(t,i))}static compareChildren(t,i){return Vw(t.__zIndex,i.__zIndex)||t.serialNumber-i.serialNumber}containsPoint(t,i){return!0}computeBBox(){return em.computeChildrenBBox(this.children())}computeSafeClippingBBox(t){const i=this.computeBBox();if(i?.isFinite()!==!0)return;let s=0;const n=4;for(const u of this.descendants())u instanceof Hc&&(s=Math.max(s,u.strokeWidth));const o=Math.max(1,s/2*n),{x:a,y:r}=Kt.toCanvasPoint(this,0,0),l=Xw(t,a+i.x-o)-a,c=Xw(t,r+i.y-o)-r,h=Math.ceil(i.x+i.width-l+o),d=Math.ceil(i.y+i.height-c+o);return new re(l,c,h,d)}prepareSharedCanvas(t,i,s){return Cg==null||Cg.pixelRatio!==s?Cg=new pM({width:t,height:i,pixelRatio:s}):Cg.resize(t,i,s),Cg}setScene(t){const i=this.scene;super.setScene(t),this.layer&&i&&i!==t&&(i.layersManager.removeLayer(this.layer),this.layer=void 0);for(const s of this.children())s.setScene(t)}markDirty(t){this.dirty=!0,super.markDirty(t)}markDirtyChildrenOrder(){super.markDirtyChildrenOrder(),this.dirtyZIndex=!0,this.markDirty()}append(t){for(const i of jS(t))i.remove(),this.childNodes.add(i),i.parentNode=this,i.setScene(this.scene);this.markDirtyChildrenOrder(),this.markDirty()}appendChild(t){return this.append(t),t}removeChild(t){if(!this.childNodes?.delete(t))throw new Error(`AG Charts - internal error, unknown child node ${t.name??t.id} in $${this.name??this.id}`);t.parentNode=void 0,t.setScene(),this.markDirtyChildrenOrder(),this.markDirty()}clear(){for(const t of this.children())delete t.parentNode,t.setScene();this.childNodes?.clear(),this.markDirty()}pickNode(t,i){if(!(!this.visible||this.pointerEvents===1||!this.containsPoint(t,i))){if(this.childNodes!=null&&this.childNodes.size!==0){const s=[...this.children()];for(let n=s.length-1;n>=0;n--){const a=s[n].pickNode(t,i);if(a!=null)return a}}else if(!this.isContainerNode)return this}}pickNodes(t,i,s=[]){if(!this.visible||this.pointerEvents===1||!this.containsPoint(t,i))return s;this.isContainerNode||s.push(this);for(const n of this.children())n.pickNodes(t,i,s);return s}isDirty(t){const{width:i,height:s,devicePixelRatio:n}=t,{dirty:o,layer:a}=this,r=a!=null&&(this._lastWidth!==i||this._lastHeight!==s),l=this._lastDevicePixelRatio!==n;return this._lastWidth=i,this._lastHeight=s,this._lastDevicePixelRatio=n,o||r||l}preRender(t){let i;if(this.dirty){i=super.preRender(t,0);for(const s of this.children()){const n=s.preRender(t);i.groups+=n.groups,i.nonGroups+=n.nonGroups,i.complexity+=n.complexity}i.groups+=1,i.nonGroups-=1}else i=this.childNodeCounts;return this.renderToOffscreenCanvas&&!this.optimizeForInfrequentRedraws&&i.nonGroups>0&&this.getVisibility()?this.layer??(this.layer=this.layerManager?.addLayer({name:this.name})):this.layer!=null&&(this.layerManager?.removeLayer(this.layer),this.layer=void 0),i}render(t){const{layer:i,renderToOffscreenCanvas:s}=this,n={...t},o=this.isDirty(t);if(this.dirty=!1,!s){this.renderInContext(n),super.render(n);return}const{ctx:a,stats:r,devicePixelRatio:l}=t;let{image:c}=this;if(o){c?.bitmap.close(),c=void 0;const d=i?void 0:this.computeSafeClippingBBox(l),u=(p,...f)=>{const y=p.context;n.ctx=y,p.clear(),y.save();try{y.setTransform(...f),y.globalAlpha=1,this.renderInContext(n)}finally{y.restore(),y.verifyDepthZero?.()}};if(i)u(i,a.getTransform());else if(d){const{x:p,y:f,width:y,height:b}=d,x=Math.floor(y*l),v=Math.floor(b*l);if(x>0&&v>0){const S=this.prepareSharedCanvas(y,b,l);u(S,l,0,0,l,-p*l,-f*l),c={bitmap:S.transferToImageBitmap(),x:p,y:f,width:y,height:b}}}this.image=c,r&&r.layersRendered++}else r&&r.layersSkipped++;const{globalAlpha:h}=a;if(a.globalAlpha=h*this.opacity,i){a.save();try{a.resetTransform(),i.drawImage(a)}finally{a.restore()}}else if(c){const{bitmap:d,x:u,y:p,width:f,height:y}=c;a.drawImage(d,0,0,f*l,y*l,u,p,f,y)}a.globalAlpha=h,super.render(n)}applyClip(t,i){const{x:s,y:n,width:o,height:a}=i;t.beginPath(),t.rect(s,n,o,a),t.clip()}renderInContext(t){const{ctx:i,stats:s}=t;this.dirtyZIndex&&(this.sortChildren(em.compareChildren),this.dirtyZIndex=!1),i.save();try{i.globalAlpha*=this.opacity,this.clipRect!=null&&(this.applyClip(i,this.clipRect),t.clipBBox=Kt.toCanvas(this,this.clipRect));for(const n of this.children()){if(!n.visible){s&&(s.nodesSkipped+=n.childNodeCounts.nonGroups+n.childNodeCounts.groups,s.opsSkipped+=n.childNodeCounts.complexity);continue}n.isolatedRender(t)}}finally{i.restore()}}sortChildren(t){if(!this.childNodes)return;const i=[...this.childNodes].sort(t);this.childNodes.clear();for(const s of i)this.childNodes.add(s)}*children(){yield*this.childNodes}*excludeChildren(t){for(const i of this.children())(t.instance&&!(i instanceof t.instance)||t.name&&i.name!==t.name)&&(yield i)}*descendants(){for(const t of this.children())yield t,t instanceof em&&(yield*t.descendants())}setClipRect(t){this.clipRect=t?Kt.fromCanvas(this,t):void 0}setClipRectCanvasSpace(t){this.clipRect=t}getVisibility(){for(const t of this.traverseUp(!0))if(!t.visible)return!1;return!0}toSVG(){if(!this.visible)return;const t=[],i=[];for(const s of this.children()){const n=s.toSVG();n!=null&&(i.push(...n.elements),n.defs!=null&&t.push(...n.defs))}return{elements:i,defs:t}}};vM.className="Group",g([U({convertor:e=>ge(0,e,1)})],vM.prototype,"opacity",2);var Oe=vM,FG=class extends Hy(Oe){},ose=class extends Qd(Oe){},ls=class extends Jd(Oe){},eu=class extends Qd(Jd(Oe)){},zG=class{constructor(){this.available=!0,this.acquireQueue=[]}acquire(e){return new Promise((t,i)=>{this.acquireQueue.push([e,t,i]),this.available&&this.dispatchNext().catch(i)})}async acquireImmediately(e){return this.available?(await this.acquire(e),!0):!1}async waitForClearAcquireQueue(){return this.acquire(()=>Promise.resolve(void 0))}async dispatchNext(){this.available=!1;let[e,t,i]=this.acquireQueue.shift()??[];for(;e;){try{await e(),t?.()}catch(s){i?.(s)}[e,t,i]=this.acquireQueue.shift()??[]}this.available=!0}},iT=class{constructor(){this.eventListeners=new Map}addEventListener(e,t){if(typeof t!="function")throw new TypeError("AG Charts - listener must be a Function");const i=this.eventListeners.get(e);i?i.add(t):this.eventListeners.set(e,new Set([t]))}removeEventListener(e,t){const i=this.eventListeners.get(e);i!=null&&(i.delete(t),i.size===0&&this.eventListeners.delete(e))}hasEventListener(e){return this.eventListeners.has(e)}clearEventListeners(){this.eventListeners.clear()}fireEvent(e){const t=this.eventListeners.get(e.type);if(t)for(const i of t)i(e)}};function BG(e){const t=Ve();function i(n,o){return t.requestAnimationFrame(n)}function s(n){t.cancelAnimationFrame(n)}return sT(i,e,s)}function SM(e){function t(s,n=0){if(n===0){queueMicrotask(s);return}return setTimeout(s,n)}function i(s){clearTimeout(s)}return sT(t,e,i)}function sT(e,t,i){let s=0,n=!1,o,a,r;function l(){return n}function c(){n=!1,r=void 0,a?.(),a=void 0,o=void 0,s>0&&(r=e(h))}function h(){const y=s;s=0,n=!0;const b=t({count:y});if(!b){c();return}b.then(c,c)}function d(y){s===0&&!l()&&(r=e(h,y)),s++}function u(){r!=null&&i&&(i(r),r=void 0,s=0)}async function p(){if(l())for(o??(o=new Promise(f));l();)await o}function f(y){a=y}return{schedule:d,cancel:u,waitForCompletion:p}}var nT=["blur","change","contextmenu","focus","keydown","keyup","click","dblclick","mouseenter","mousemove","mouseleave","wheel","touchstart","touchmove","touchend","touchcancel"];function tu(e,t,i){const{offsetX:s,offsetY:n,clientX:o,clientY:a}=t,{currentX:r,currentY:l}=kl.calcCurrentXY(i,t);return{type:e,device:"mouse",offsetX:s,offsetY:n,clientX:o,clientY:a,currentX:r,currentY:l,sourceEvent:t}}function jy(e,t,i){return{type:e,sourceEvent:t}}var _G={blur:e=>({type:"blur",sourceEvent:e}),change:e=>({type:"change",sourceEvent:e}),contextmenu:(e,t)=>tu("contextmenu",e,t),focus:e=>({type:"focus",sourceEvent:e}),keydown:e=>({type:"keydown",sourceEvent:e}),keyup:e=>({type:"keyup",sourceEvent:e}),click:(e,t)=>tu("click",e,t),dblclick:(e,t)=>tu("dblclick",e,t),mouseenter:(e,t)=>tu("mouseenter",e,t),mousemove:(e,t)=>tu("mousemove",e,t),mouseleave:(e,t)=>tu("mouseleave",e,t),wheel:e=>{const{offsetX:t,offsetY:i,clientX:s,clientY:n}=e,o=e.deltaMode===0?.01:1,a=e.deltaX*o,r=e.deltaY*o;return{type:"wheel",offsetX:t,offsetY:i,clientX:s,clientY:n,deltaX:a,deltaY:r,sourceEvent:e}},touchstart:(e,t)=>jy("touchstart",e,t),touchmove:(e,t)=>jy("touchmove",e,t),touchend:(e,t)=>jy("touchend",e,t),touchcancel:(e,t)=>jy("touchcancel",e,t)},kl=class{static alloc(e,t,i){return _G[e](t,i)}static isHTMLEvent(e){return nT.includes(e)}static calcCurrentXY(e,t){const i=e.getBoundingClientRect();return{currentX:t.clientX-i.x,currentY:t.clientY-i.y}}},VG=class{constructor(){this.widgetListeners={},this.sourceListeners={}}initSourceHandler(e,t){this.sourceListeners??(this.sourceListeners={}),this.sourceListeners[e]=t}lazyGetWidgetListeners(e,t){var i;if(!(e in(this.sourceListeners??{}))){const s=o=>{const a=kl.alloc(e,o,t.getElement());this.dispatch(e,t,a)},n={};e.startsWith("touch")&&(n.passive=!1),this.initSourceHandler(e,s),t.getElement().addEventListener(e,s,n)}return this.widgetListeners??(this.widgetListeners={}),(i=this.widgetListeners)[e]??(i[e]=[]),this.widgetListeners[e]}add(e,t,i){this.lazyGetWidgetListeners(e,t).push(i)}remove(e,t,i){const s=this.lazyGetWidgetListeners(e,t),n=s.indexOf(i);n>-1&&s.splice(n,1)}destroy(e){if(this.widgetListeners=void 0,this.sourceListeners){for(const[t,i]of ht(this.sourceListeners))e.getElement().removeEventListener(t,i);this.sourceListeners=void 0}}dispatch(e,t,i){for(const s of this.widgetListeners?.[e]??[])s(i,t)}},GG=class{constructor(e,t,i,s){this.glob=e,this.self=t,this.window=Ve(),this.cleanup=new pt,this.mousegeneral=l=>{l.stopPropagation(),l.stopImmediatePropagation()},this.mousemove=l=>{l.stopPropagation(),l.stopImmediatePropagation(),this.glob.globalMouseDragCallbacks?.mousemove(l)},this.mouseup=l=>{l.button===0&&(l.stopPropagation(),l.stopImmediatePropagation(),this.glob.globalMouseDragCallbacks?.mouseup(l),this.destroy())};const{window:n,mousegeneral:o,mousemove:a,mouseup:r}=this;this.cleanup.register(ot(n,"mousedown",o,{capture:!0}),ot(n,"mouseenter",o,{capture:!0}),ot(n,"mouseleave",o,{capture:!0}),ot(n,"mouseout",o,{capture:!0}),ot(n,"mouseover",o,{capture:!0}),ot(n,"mousemove",a,{capture:!0}),ot(n,"mouseup",r,{capture:!0})),t.mouseDragger=this,e.globalMouseDragCallbacks=i,e.globalMouseDragCallbacks.mousedown(s),s.stopPropagation(),s.stopImmediatePropagation()}destroy(){this.cleanup.flush(),this.glob.globalMouseDragCallbacks=void 0,this.self.mouseDragger=void 0}};function HG(e,t,i,s){if(e.globalMouseDragCallbacks==null)return new GG(e,t,i,s)}var jG=500,WG=100;function $G(e,t){const i=e.clientX-t.clientX,s=e.clientY-t.clientY;return i*i+s*s}var MM=!1,UG=class{constructor(e,t,i,s,n){this.glob=e,this.self=t,this.initialTouch=s,this.target=n,this.cleanup=new pt,this.longTapInterrupted=!1,this.longtap=()=>{const{target:r,initialTouch:l}=this;if(!this.longTapInterrupted){const c=new pt;r.dispatchEvent(new TouchEvent("touchcancel",{touches:[l],bubbles:!0})),MM=!0;const h=y=>y.preventDefault(),d=y=>{MM=!1,y.preventDefault(),c.flush()};c.register(ot(r,"touchmove",h,{passive:!1}),ot(r,"touchend",d,{passive:!1}),ot(r,"touchcancel",d,{passive:!1}));const{clientX:u,clientY:p}=l,f=new PointerEvent("contextmenu",{bubbles:!0,cancelable:!0,view:Ve(),clientX:u,clientY:p,pointerType:"touch"});r.dispatchEvent(f)}},this.touchmove=r=>{const{glob:l,self:c,initialTouch:h}=this,d=this.findInitialFinger(r.targetTouches);d!=null&&(this.longTapInterrupted=this.longTapInterrupted||$G(h,d)>WG,c.dragTouchEnabled&&l.globalTouchDragCallbacks?.touchmove(r,d))},this.touchend=r=>{this.longTapInterrupted=!0;const l=this.findInitialFinger(r.changedTouches,r.touches);l!=null&&this.glob.globalTouchDragCallbacks?.touchend(r,l),this.destroy()},this.longtapTimer=setTimeout(this.longtap,jG);const{touchmove:o,touchend:a}=this;this.cleanup.register(ot(n,"touchmove",o,{passive:!1}),ot(n,"touchstart",a,{passive:!1}),ot(n,"touchend",a,{passive:!1}),ot(n,"touchcancel",a,{passive:!1})),t.touchDragger=this,e.globalTouchDragCallbacks=i}destroy(){clearTimeout(this.longtapTimer),this.cleanup.flush(),this.glob.globalTouchDragCallbacks=void 0,this.self.touchDragger=void 0}findInitialFinger(...e){const t=e.flatMap(i=>Array.from(i));return Array.from(t).find(i=>i.identifier===this.initialTouch.identifier)}};function KG(e,t,i,s,n){if(!(e.globalTouchDragCallbacks!=null||MM))return new UG(e,t,i,s,n)}function DM(e,t,i,s){const{currentX:n,currentY:o}=kl.calcCurrentXY(e.getElement(),s),a=s.pageX-i.pageX,r=s.pageY-i.pageY;return{type:t,device:"mouse",offsetX:i.offsetX+a,offsetY:i.offsetY+r,clientX:s.clientX,clientY:s.clientY,currentX:n,currentY:o,originDeltaX:a,originDeltaY:r,sourceEvent:s}}function YG(e,{pageX:t,pageY:i}){const{x:s,y:n}=e.getElement().getBoundingClientRect();return{offsetX:t-s,offsetY:i-n}}function IM(e,t,i,s,n){const{currentX:o,currentY:a}=kl.calcCurrentXY(e.getElement(),n),r=n.pageX-i.pageX,l=n.pageY-i.pageY;return{type:t,device:"touch",offsetX:i.offsetX+r,offsetY:i.offsetY+l,clientX:n.clientX,clientY:n.clientY,currentX:o,currentY:a,originDeltaX:r,originDeltaY:l,sourceEvent:s}}var oT={},aT=class{constructor(e){this.dispatchCallback=e,this.dragTouchEnabled=!0}destroy(){this.dragTriggerRemover?.(),this.dragTriggerRemover=void 0,this.listeners?.clear(),this.mouseDragger?.destroy(),this.touchDragger?.destroy()}getListenerSet(e){this.listeners??(this.listeners=new Map);let t=this.listeners.get(e);return t===void 0&&(t=new Set,this.listeners.set(e,t)),t}add(e,t,i){switch(this.getListenerSet(e).add(i),e){case"drag-start":case"drag-move":case"drag-end":{this.registerDragTrigger(t);break}}}remove(e,t,i){this.getListenerSet(e).delete(i)}registerDragTrigger(e){if(this.dragTriggerRemover==null){const t=e.getElement(),i=new pt;i.register(ot(t,"mousedown",s=>this.triggerMouseDrag(e,s)),ot(t,"touchstart",s=>this.triggerTouchDrag(e,s),{passive:!1})),this.dragTriggerRemover=()=>i.flush()}}triggerMouseDrag(e,t){t.button===0&&this.startMouseDrag(e,t)}startMouseDrag(e,t){const i={pageX:Number.NaN,pageY:Number.NaN,offsetX:Number.NaN,offsetY:Number.NaN};Yp(["pageX","pageY","offsetX","offsetY"],i,t);const s={mousedown:n=>{const o=DM(e,"drag-start",i,n);this.dispatch("drag-start",e,o)},mousemove:n=>{const o=DM(e,"drag-move",i,n);this.dispatch("drag-move",e,o)},mouseup:n=>{const o=DM(e,"drag-end",i,n);this.dispatch("drag-end",e,o),this.endDrag(e,o)}};this.mouseDragger=HG(oT,this,s,t)}endDrag(e,{sourceEvent:t,clientX:i,clientY:s}){const n=e.getElement(),o=n.getBoundingClientRect();lg(o,i,s)||(n.dispatchEvent(new MouseEvent("mouseleave",t)),t.target?.dispatchEvent(new MouseEvent("mouseenter",t)))}triggerTouchDrag(e,t){const i=t.targetTouches[0];t.targetTouches.length===1&&i!=null&&this.startOneFingerTouch(e,t,i)}startOneFingerTouch(e,t,i){const s={pageX:Number.NaN,pageY:Number.NaN,...YG(e,i)};Yp(["pageX","pageY"],s,i);const n={touchmove:(r,l)=>{const c=IM(e,"drag-move",s,r,l);this.dispatch("drag-move",e,c)},touchend:(r,l)=>{const c=IM(e,"drag-end",s,r,l);this.dispatch("drag-end",e,c)}},o=e.getElement();this.touchDragger=KG(oT,this,n,i,o);const a=IM(e,"drag-start",s,t,i);this.dispatch("drag-start",e,a)}dispatch(e,t,i){for(const s of this.getListenerSet(e))s(i,t);this.dispatchCallback(e,i)}},ZG=class{constructor(e){this.elem=e}setBounds(e){Cd(this.elemContainer??this.elem,e)}getBounds(){return a0(this.elemContainer??this.elem)}static setElementContainer(e,t){const i=e.getBounds();Cd(t,i),d0(e.elem,{width:"100%",height:"100%"}),e.elem.remove(),e.elemContainer=t,e.elemContainer.replaceChildren(e.elem)}},Sr=class extends ZG{constructor(){super(...arguments),this.index=Number.NaN,this.children=[]}set id(e){Fe(this.elem,"id",e)}get id(){return fl(this.elem,"id")}getElement(){return this.elem}getBoundingClientRect(){return this.elem.getBoundingClientRect()}get clientWidth(){return this.elem.clientWidth}get clientHeight(){return this.elem.clientHeight}destroy(){this.destroyListener?.(),this.destroyListener=void 0,this.remove();for(const e of this.children)e.parent=void 0,e.destroy();this.children.length=0,this.destructor(),this.remove(),this.internalListener?.destroy(),this.htmlListener?.destroy(this)}remove(){this.elem.remove(),this.elemContainer?.remove()}setHidden(e){Cn(this.elem,"display",e?"none":void 0)}isHidden(){return Ve()?.getComputedStyle?.(this.elem).display==="none"}setCursor(e){Cn(this.elem,"cursor",e)}setTextContent(e){this.elem.textContent=e??null}setAriaDescribedBy(e){Fe(this.elem,"aria-describedby",e)}setAriaHidden(e){Fe(this.elem,"aria-hidden",e)}setAriaLabel(e){Fe(this.elem,"aria-label",e)}setAriaExpanded(e){Fe(this.elem,"aria-expanded",e)}setAriaControls(e){Fe(this.elem,"aria-controls",e)}setAriaHasPopup(e){Fe(this.elem,"aria-haspopup",e)}setInnerHTML(e){this.elem.innerHTML=e}setPointerEvents(e){Cn(this.elem,"pointer-events",e)}setCSSVariable(e,t){this.elem.style.setProperty(e,t)}isDisabled(){return fl(this.elem,"aria-disabled",!1)}hasPopup(){const e=fl(this.elem,"aria-haspopup");return e!==void 0&&e!=="false"}parseFloat(e){return e===""?0:Number.parseFloat(e)}cssLeft(){return this.parseFloat(this.elem.style.left)}cssTop(){return this.parseFloat(this.elem.style.top)}cssWidth(){return this.parseFloat(this.elem.style.width)}cssHeight(){return this.parseFloat(this.elem.style.height)}focus(e){this.elem.focus(e)}setFocusOverride(e){Fe(this.elem,"data-focus-override",e)}setPreventsDefault(e){Fe(this.elem,"data-preventdefault",e)}setTabIndex(e){Fe(this.elem,"tabindex",e)}addChild(e){this.addChildToDOM(e,this.getBefore(e)),this.children.push(e),e.index=this.children.length-1,e.parent=this,this.onChildAdded(e)}removeChild(e){const t=this.children.indexOf(e);this.children.splice(t,1),this.removeChildFromDOM(e),this.onChildRemoved(e)}moveChild(e,t){e.domIndex!==t&&(e.domIndex=t,this.removeChildFromDOM(e),this.addChildToDOM(e,this.getBefore(e)))}addClass(...e){this.elem.classList.add(...e)}removeClass(...e){this.elem.classList.remove(...e)}toggleClass(e,t){this.elem.classList.toggle(e,t)}appendOrInsert(e,t){t?t.getElement().insertAdjacentElement("beforebegin",e):this.elem.appendChild(e)}addChildToDOM(e,t){this.appendOrInsert(e.getElement(),t)}removeChildFromDOM(e){e.getElement().remove()}onChildAdded(e){}onChildRemoved(e){}getBefore({domIndex:e}){if(e!==void 0)return this.children.filter(t=>t.domIndex!==void 0&&t.domIndex>e).reduce((t,i)=>!t||i.domIndex<t.domIndex?i:t,void 0)}addListener(e,t){return kl.isHTMLEvent(e)?(this.htmlListener??(this.htmlListener=new VG),this.htmlListener.add(e,this,t)):(this.internalListener??(this.internalListener=new aT(this.onDispatch.bind(this))),this.internalListener.add(e,this,t)),()=>this.removeListener(e,t)}removeListener(e,t){kl.isHTMLEvent(e)?this.htmlListener?.remove(e,this,t):this.htmlListener!=null&&this.internalListener?.remove(e,this,t)}setDragTouchEnabled(e){this.internalListener??(this.internalListener=new aT(this.onDispatch.bind(this))),this.internalListener.dragTouchEnabled=e}onDispatch(e,t){if(!t.sourceEvent?.bubbles)return;let{parent:i}=this;for(;i!=null;){const{internalListener:s}=i;if(s!=null){const n={...t,...kl.calcCurrentXY(i.getElement(),t)};s.dispatch(e,i,n)}i=i.parent}}static addWindowEvent(e,t){const i=s=>{s.persisted||t()};return ot(Ve(),"pagehide",i)}},Lg=(e,{x0:t,y0:i,x1:s,y1:n,cx:o,cy:a},r,l)=>{if(l&&e.moveTo(t,i),t!==s||i!==n){const c=Math.atan2(i-a,t-o),h=Math.atan2(n-a,s-o);e.arc(o,a,r,c,h)}else e.lineTo(t,i)},Fi=class extends Hc{constructor(){super(...arguments),this.path=new qd,this._clipX=Number.NaN,this._clipY=Number.NaN,this.clip=!1,this._dirtyPath=!0,this.lastPixelRatio=Number.NaN}set clipX(e){this._clipX=e,this.dirtyPath=!0}set clipY(e){this._clipY=e,this.dirtyPath=!0}set dirtyPath(e){this._dirtyPath!==e&&(this._dirtyPath=e,e&&this.markDirty("path"))}get dirtyPath(){return this._dirtyPath}checkPathDirty(){this._dirtyPath||(this.dirtyPath=this.path.isDirty()||(this.fillShadow?.isDirty()??!1)||(this._clipPath?.isDirty()??!1))}resetPathDirty(){this.path.clear(!0),this._dirtyPath=!1}isPathDirty(){return this.path.isDirty()}onChangeDetection(e){this._dirtyPath||(this._dirtyPath=!0,super.onChangeDetection(e))}computeBBox(){return this.updatePathIfDirty(),this.path.computeBBox()}isPointInPath(e,t){return this.updatePathIfDirty(),this.path.closedPath&&this.path.isPointInPath(e,t)}distanceSquared(e,t){return this.distanceSquaredTransformedPoint(e,t)}svgPathData(e){return this.updatePathIfDirty(),this.path.toSVG(e)}distanceSquaredTransformedPoint(e,t){return this.updatePathIfDirty(),this.path.closedPath&&this.path.isPointInPath(e,t)?0:this.path.distanceSquared(e,t)}isDirtyPath(){return!1}updatePath(){}updatePathIfDirty(){(this.dirtyPath||this.isDirtyPath())&&(this.updatePath(),this.dirtyPath=!1)}preRender(e){return e.devicePixelRatio!==this.lastPixelRatio&&(this.dirtyPath=!0),this.lastPixelRatio=e.devicePixelRatio,this.updatePathIfDirty(),super.preRender(e,this.path.commands.length)}render(e){const{ctx:t}=e;if(this.clip&&!Number.isNaN(this._clipX)&&!Number.isNaN(this._clipY)){t.save();try{const i=this.strokeWidth/2;this._clipPath??(this._clipPath=new qd),this._clipPath.clear(),this._clipPath.rect(-i,-i,this._clipX+i,this._clipY+i+i),t.clip(this._clipPath?.getPath2D()),this._clipX>0&&this._clipY>0&&this.drawPath(t)}finally{t.restore()}}else this._clipPath=void 0,this.drawPath(t);this.fillShadow?.markClean(),super.render(e)}drawPath(e){this.fillStroke(e,this.path.getPath2D())}toSVG(){if(!this.visible)return;const e=Pt("path");e.setAttribute("d",this.svgPathData());const t=this.applySvgFillAttributes(e,[]);return this.applySvgStrokeAttributes(e),{elements:[e],defs:t}}};Fi.className="Path",g([U()],Fi.prototype,"clip",2),g([U()],Fi.prototype,"clipX",1),g([U()],Fi.prototype,"clipY",1);function Wy(e,t,i,s,n){let o=!1,a=!1,r=s-Math.sqrt(Math.max(n**2-i**2,0)),l=0,c=0,h=i-Math.sqrt(Math.max(n**2-s**2,0));return r>e?(o=!0,r=e,l=i-Math.sqrt(Math.max(n**2-(s-e)**2))):qe(r,0)&&(r=0),h>t?(a=!0,c=s-Math.sqrt(Math.max(n**2-(i-t)**2)),h=t):qe(h,0)&&(h=0),{leading0:r,leading1:l,trailing0:c,trailing1:h,leadingClipped:o,trailingClipped:a}}function $y(e,t,i,s,n,o,a){let{topLeft:r,topRight:l,bottomRight:c,bottomLeft:h}=o;const d=Math.max(r+h,l+c),u=Math.max(r+l,h+c);if(d<=0&&u<=0){if(a==null)e.rect(t,i,s,n);else{const I=Math.max(t,a.x),A=Math.min(t+s,a.x+a.width),C=Math.max(i,a.y),w=Math.min(i+n,a.y+a.height);e.rect(I,C,A-I,w-C)}return}else if(a==null&&r===l&&r===c&&r===h){e.roundRect(t,i,s,n,r);return}if(s<0&&(t+=s,s=Math.abs(s)),n<0&&(i+=n,n=Math.abs(n)),s<=0||n<=0)return;if(a==null)a=new re(t,i,s,n);else{const I=Math.max(t,a.x),A=Math.min(t+s,a.x+a.width),C=Math.max(i,a.y),w=Math.min(i+n,a.y+a.height);a=new re(I,C,A-I,w-C)}const p=Math.max(d/n,u/s,1);p>1&&(r/=p,l/=p,c/=p,h/=p);let f=!0,y=!0,b=!0,x=!0,v,S,M,D;if(f){const I=Wy(a.height,a.width,Math.max(t+r-a.x,0),Math.max(i+r-a.y,0),r);I.leadingClipped&&(x=!1),I.trailingClipped&&(y=!1);const A=Math.max(a.x+I.leading1,a.x),C=Math.max(a.y+I.leading0,a.y),w=Math.max(a.x+I.trailing1,a.x),T=Math.max(a.y+I.trailing0,a.y),O=t+r,E=i+r;v={x0:A,y0:C,x1:w,y1:T,cx:O,cy:E}}if(y){const I=Wy(a.width,a.height,Math.max(i+l-a.y,0),Math.max(a.x+a.width-(t+s-l),0),l);I.leadingClipped&&(f=!1),I.trailingClipped&&(b=!1);const A=Math.min(a.x+a.width-I.leading0,a.x+a.width),C=Math.max(a.y+I.leading1,a.y),w=Math.min(a.x+a.width-I.trailing0,a.x+a.width),T=Math.max(a.y+I.trailing1,a.y),O=t+s-l,E=i+l;S={x0:A,y0:C,x1:w,y1:T,cx:O,cy:E}}if(b){const I=Wy(a.height,a.width,Math.max(a.x+a.width-(t+s-c),0),Math.max(a.y+a.height-(i+n-c),0),c);I.leadingClipped&&(y=!1),I.trailingClipped&&(x=!1);const A=Math.min(a.x+a.width-I.leading1,a.x+a.width),C=Math.min(a.y+a.height-I.leading0,a.y+a.height),w=Math.min(a.x+a.width-I.trailing1,a.x+a.width),T=Math.min(a.y+a.height-I.trailing0,a.y+a.height),O=t+s-c,E=i+n-c;M={x0:A,y0:C,x1:w,y1:T,cx:O,cy:E}}if(x){const I=Wy(a.width,a.height,Math.max(a.y+a.height-(i+n-h),0),Math.max(t+h-a.x,0),h);I.leadingClipped&&(b=!1),I.trailingClipped&&(f=!1);const A=Math.max(a.x+I.leading0,a.x),C=Math.min(a.y+a.height-I.leading1,a.y+a.height),w=Math.max(a.x+I.trailing0,a.x),T=Math.min(a.y+a.height-I.trailing1,a.y+a.height),O=t+h,E=i+n-h;D={x0:A,y0:C,x1:w,y1:T,cx:O,cy:E}}let k=!1;f&&v!=null&&(Lg(e,v,r,!k),k||(k=!0)),y&&S!=null&&(Lg(e,S,l,!k),k||(k=!0)),b&&M!=null&&(Lg(e,M,c,!k),k||(k=!0)),x&&D!=null&&Lg(e,D,h,!k),e.closePath()}var Di=class extends Fi{constructor(){super(...arguments),this.borderPath=new qd,this.x=0,this.y=0,this.width=10,this.height=10,this.topLeftCornerRadius=0,this.topRightCornerRadius=0,this.bottomRightCornerRadius=0,this.bottomLeftCornerRadius=0,this.clipBBox=void 0,this.crisp=!1,this.lastUpdatePathStrokeWidth=this.__strokeWidth,this.effectiveStrokeWidth=this.__strokeWidth,this.hittester=super.isPointInPath.bind(this),this.distanceCalculator=super.distanceSquaredTransformedPoint.bind(this),this.microPixelEffectOpacity=1}set cornerRadius(e){this.topLeftCornerRadius=e,this.topRightCornerRadius=e,this.bottomRightCornerRadius=e,this.bottomLeftCornerRadius=e}isDirtyPath(){return this.lastUpdatePathStrokeWidth!==this.__strokeWidth||!!(this.path.isDirty()||this.borderPath.isDirty())}updatePath(){const{path:e,borderPath:t,__crisp:i,__topLeftCornerRadius:s,__topRightCornerRadius:n,__bottomRightCornerRadius:o,__bottomLeftCornerRadius:a}=this;let{__x:r,__y:l,__width:c,__height:h,__strokeWidth:d,__clipBBox:u}=this;const f=1/(this.layerManager?.canvas.pixelRatio??1);let y=1;if(e.clear(),t.clear(),c===0||h===0){this.effectiveStrokeWidth=0,this.lastUpdatePathStrokeWidth=0,this.microPixelEffectOpacity=0;return}if(i&&(c<=f&&(y*=c/f),h<=f&&(y*=h/f),c=this.align(r,c),h=this.align(l,h),r=this.align(r),l=this.align(l),u=u==null?void 0:new re(this.align(u.x),this.align(u.y),this.align(u.x,u.width),this.align(u.y,u.height))),d)if(c<f){const x=r+f/2;t.moveTo(x,l),t.lineTo(x,l+h),d=f,this.borderClipPath=void 0}else if(h<f){const x=l+f/2;t.moveTo(r,x),t.lineTo(r+c,x),d=f,this.borderClipPath=void 0}else if(d<c&&d<h){const x=d/2;r+=x,l+=x,c-=d,h-=d;const v=u?.clone().shrink(x),S={topLeft:s>0?s-d:0,topRight:n>0?n-d:0,bottomRight:o>0?o-d:0,bottomLeft:a>0?a-d:0};this.borderClipPath=void 0,c>0&&h>0&&(v==null||v?.width>0&&v?.height>0)&&($y(e,r,l,c,h,S,v),$y(t,r,l,c,h,S,v))}else this.borderClipPath=this.borderClipPath??new qd,this.borderClipPath.clear(),this.borderClipPath.rect(r,l,c,h),t.rect(r,l,c,h);else{const x={topLeft:s,topRight:n,bottomRight:o,bottomLeft:a};this.borderClipPath=void 0,$y(e,r,l,c,h,x,u)}if([s,n,o,a].every(XG)){let x=function(M,D){return S.getBBox().distanceSquared(M,D)};var b=x;const v=this.getBBox();this.hittester=v.containsPoint.bind(v);const S=this;this.distanceSquared=x}else this.hittester=super.isPointInPath,this.distanceCalculator=super.distanceSquaredTransformedPoint;this.effectiveStrokeWidth=d,this.lastUpdatePathStrokeWidth=d,this.microPixelEffectOpacity=y}computeBBox(){const{__x:e,__y:t,__width:i,__height:s,__clipBBox:n}=this;return n?.clone()??new re(e,t,i,s)}isPointInPath(e,t){return this.hittester(e,t)}get midPoint(){return{x:this.__x+this.__width/2,y:this.__y+this.__height/2}}setStaticProperties(e,t,i,s,n,o,a,r){this.__drawingMode=e,this.__topLeftCornerRadius=t,this.__topRightCornerRadius=i,this.__bottomRightCornerRadius=s,this.__bottomLeftCornerRadius=n,this.__visible=o,this.__crisp=a,this.__fillShadow=r,this.dirtyPath=!0,this.markDirty()}resetAnimationProperties(e,t,i,s,n,o){this.__x=e,this.__y=t,this.__width=i,this.__height=s,this.__opacity=n,this.__clipBBox=o,this.dirtyPath=!0,this.markDirty()}distanceSquared(e,t){return this.distanceCalculator(e,t)}applyFillAndAlpha(e){super.applyFillAndAlpha(e),e.globalAlpha*=this.microPixelEffectOpacity}applyStrokeAndAlpha(e){super.applyStrokeAndAlpha(e),e.globalAlpha*=this.microPixelEffectOpacity}renderStroke(e){const{stroke:t,effectiveStrokeWidth:i}=this;if(t&&i){const{globalAlpha:s}=e,{lineDash:n,lineDashOffset:o,lineCap:a,lineJoin:r,borderPath:l,borderClipPath:c}=this;c&&e.clip(c.getPath2D()),this.applyStrokeAndAlpha(e),e.lineWidth=i,n&&e.setLineDash(n),o&&(e.lineDashOffset=o),a&&(e.lineCap=a),r&&(e.lineJoin=r),e.stroke(l.getPath2D()),e.globalAlpha=s}}};Di.className="Rect",g([_e()],Di.prototype,"x",2),g([_e()],Di.prototype,"y",2),g([_e()],Di.prototype,"width",2),g([_e()],Di.prototype,"height",2),g([_e()],Di.prototype,"topLeftCornerRadius",2),g([_e()],Di.prototype,"topRightCornerRadius",2),g([_e()],Di.prototype,"bottomRightCornerRadius",2),g([_e()],Di.prototype,"bottomLeftCornerRadius",2),g([_e({equals:cg})],Di.prototype,"clipBBox",2),g([_e()],Di.prototype,"crisp",2);function XG(e){return e===0}var qG=class{constructor(){this.stats=new Map,this.lastLogTime=Date.now(),this.LOG_INTERVAL_MS=1e4,this.startPeriodicLogging()}startPeriodicLogging(){Me.check("scene:stats","scene:stats:verbose")&&(this.stopPeriodicLogging(),this.intervalId=setInterval(()=>{this.logAccumulatedStats()},this.LOG_INTERVAL_MS))}stopPeriodicLogging(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0)}recordTiming(e,t){const i=this.stats.get(e);i?(i.min=Math.min(i.min,t),i.max=Math.max(i.max,t),i.sum+=t,i.count+=1):this.stats.set(e,{min:t,max:t,sum:t,count:1})}recordTimings(e){for(const[t,i]of Object.entries(e))t!=="start"&&typeof i=="number"&&this.recordTiming(t,i)}logAccumulatedStats(){if(this.stats.size===0)return;const e=(Date.now()-this.lastLogTime)/1e3,t=Array.from(this.stats.keys()).sort((o,a)=>o==="\u23F1\uFE0F"?-1:a==="\u23F1\uFE0F"?1:o.localeCompare(a)),i=[];for(const o of t){const a=this.stats.get(o),r=a.sum/a.count;i.push(`${o}[${a.min.toFixed(1)}/${r.toFixed(1)}/${a.max.toFixed(1)}]ms`)}const n=this.stats.get("\u23F1\uFE0F")?.count??0;j.log(`\u{1F4CA} Stats (${e.toFixed(0)}s, ${n} renders): ${i.join(" ")}`),this.stats.clear(),this.lastLogTime=Date.now()}destroy(){this.stopPeriodicLogging(),this.stats.clear()}},iu,Wc=0;function QG(){return iu??(iu=new qG),iu}function JG(){Wc++;let e=!1;return()=>{e||Wc===0||(e=!0,Wc--,Wc===0&&hT())}}function eH(e){for(const t of["B","KB","MB","GB"]){if(e<1536)return`${e.toFixed(1)}${t}`;e/=1024}return`${e.toFixed(1)}TB}`}function tH(){if(!("memory"in performance))return;const{totalJSHeapSize:e,usedJSHeapSize:t,jsHeapSizeLimit:i}=performance.memory,s=[];for(const n of[t,e,i])typeof n=="number"&&s.push(eH(n));return`Heap ${s.join(" / ")}`}function rT(e,t,i,s,n={},o=re.zero){if(!Me.check("scene:stats","scene:stats:verbose"))return;const{layersRendered:a=0,layersSkipped:r=0,nodesRendered:l=0,nodesSkipped:c=0,opsPerformed:h=0,opsSkipped:d=0}=s??{},u=performance.now(),{start:p,...f}=t,y=u-p,b=QG();b.recordTimings(f),b.recordTiming("\u23F1\uFE0F",y);const x=Object.entries(f).map(([G,B])=>cT(G,B)).filter(G=>G!=null).join(" + "),v=Object.entries(n).map(([G,B])=>`${G}: ${JSON.stringify(B)}`).join(" ; "),S=Me.check("scene:stats:verbose"),M=S?tH():null,D=S?Jn.flush():{},k=Object.entries(D),I=[],A=[];for(const[G,B]of k)G.endsWith(":aggregation")&&Array.isArray(B)?I.push(`${G.replace(":aggregation","")}(${B.join(",")})`):G.endsWith(":nodeData")&&typeof B=="number"&&A.push(`${G.replace(":nodeData","")}(${B})`);const C=I.length>0?`Aggregation: ${I.join(", ")}`:null,w=A.length>0?`NodeData: ${A.join(", ")}`:null,T=[`${cT("\u23F1\uFE0F",p,u)} (${x})`,`${v}`,C,w,`Layers: ${S?kM(a,r):e.size}`,S?`Nodes: ${kM(l,c)}`:null,S?`Ops: ${kM(h,d)}`:null,M].filter(Rt),O=new yy(i),E=new Map(T.map(G=>[G,O.measureText(G)])),z=Math.max(...Array.from(E.values(),G=>G.width)),F=rH(E.values(),G=>G.height),_=2+o.x;i.save();try{i.fillStyle="white",i.fillRect(_,0,z,F),i.fillStyle="black";let G=0;for(const[B,V]of E.entries())G+=V.height,i.fillText(B,_,G)}catch(G){j.warnOnce("Error during debug stats rendering",G)}finally{i.restore()}}function iH(e){const t=Yh(Ve("agChartsSceneDebug")),i=[];for(const s of t)s==="layout"?i.push("seriesRoot","legend","root",/.*Axis-\d+-axis.*/):i.push(s);e.debugNodeSearch=i}function sH(e,t){e.save();try{for(const[i,s]of Object.entries(t)){const n=Kt.toCanvas(s);if(!n){j.log(`Scene.render() - no bbox for debugged node [${i}].`);continue}e.globalAlpha=.8,e.strokeStyle="red",e.lineWidth=1,e.strokeRect(n.x,n.y,n.width,n.height),e.fillStyle="red",e.strokeStyle="white",e.font="16px sans-serif",e.textBaseline="top",e.textAlign="left",e.lineWidth=2,e.strokeText(i,n.x,n.y,n.width),e.fillText(i,n.x,n.y,n.width)}}catch(i){j.warnOnce("Error during debug rendering",i)}finally{e.restore()}}var nH=new Set,oH=new Set(["gradient","zIndex","clipRect","cachedBBox","childNodeCounts","path","__zIndex","name","__scalingCenterX","__scalingCenterY","__rotationCenterX","__rotationCenterY","_previousDatum","__fill","__lineDash","borderPath","borderClipPath","_clipPath"]);function aH(e){const{...t}=e;for(const i of Object.keys(t))oH.has(i)||typeof t[i]!="number"&&typeof t[i]!="string"&&typeof t[i]!="boolean"&&(nH.add(i),delete t[i]);return t}function Uy(e,t){if(!Me.check(!0,"scene"))return{};let i=0;return{node:t==="json"?aH(e):e,name:e.name??e.id,dirty:e instanceof Oe?e.dirty:void 0,...Array.from(e instanceof Oe?e.children():[],s=>Uy(s,t)).reduce((s,n)=>{let{name:o}=n;const{node:{visible:a,opacity:r,zIndex:l,translationX:c,translationY:h,rotation:d,scalingX:u,scalingY:p},node:f}=n;(!a||r<=0)&&(o=`(${o})`),Oe.is(f)&&f.renderToOffscreenCanvas&&(o=`*${o}*`);const y=Array.isArray(l)?`(${l.join(", ")})`:l,b=[`${(i++).toString().padStart(3,"0")}|`,`${o??"<unknown>"}`,`z: ${y}`,c&&`x: ${c}`,h&&`y: ${h}`,d&&`r: ${d}`,u!=null&&u!==1&&`sx: ${u}`,p!=null&&p!==1&&`sy: ${p}`].filter(S=>!!S).join(" ");let x=b,v=1;for(;s[x]!=null&&v<100;)x=`${b} (${v++})`;return s[x]=n,s},{})}}function lT(e){const t=e instanceof Oe?e.dirty:void 0;if(!t)return{dirtyTree:{},paths:[]};const i=Array.from(e instanceof Oe?e.children():[],o=>lT(o)).filter(o=>o.paths.length>0),s=Oe.is(e)?e.name??e.id:e.id,n=i.length?i.flatMap(o=>o.paths).map(o=>`${s}.${o}`):[s];return{dirtyTree:{name:s,node:e,dirty:t,...i.map(o=>o.dirtyTree).filter(o=>o.dirty!=null).reduce((o,a)=>(o[a.name??"<unknown>"]=a,o),{})},paths:n}}function kM(e,t){const i=e+t;return`${e} / ${i} (${Math.round(100*e/i)}%)`}function cT(e,t,i){const s=i==null?t:i-t;return`${e}: ${Math.round(s*100)/100}ms`}function rH(e,t){let i=0;for(const s of e)i+=t(s);return i}function hT(e=!1){if(!iu){e&&(Wc=0);return}!e&&Wc>0||(iu.destroy(),iu=void 0,e&&(Wc=0))}var an=class ko extends Hc{constructor(t){super(t),this.x=0,this.y=0,this.lines=[],this.text=void 0,this.fontCache=void 0,this.fontSize=ko.defaultFontSize,this.fontFamily="sans-serif",this.textAlign="start",this.textBaseline="alphabetic",this.boxPadding=0,this.trimText=t?.trimText??!0}onTextChange(){if(this.richText?.clear(),this.textMap?.clear(),Ce(this.text))this.lines=[],this.richText??(this.richText=new Oe),this.richText.setScene(this.scene),this.richText.append(this.text.flatMap(t=>Dt(t.text).split(Ya)).filter(Boolean).map(()=>new ko({trimText:!1})));else{const t=Dt(this.text).split(Ya);this.lines=this.trimText?t.map(i=>i.trim()):t}}get font(){return this.fontCache??(this.fontCache=fm(this)),this.fontCache}static measureBBox(t,i,s,n){if(Ce(t)){const{font:o,lineHeight:a,textAlign:r,textBaseline:l}=n,{width:c,height:h,lineMetrics:d}=Ks(t,o),u=a?a*d.length:h,p=ko.calcTopOffset(u,d[0],l),f=ko.calcLeftOffset(c,r);return new re(i-f,s-p,c,u)}else return ko.computeBBox(Dt(t).split(Ya),i,s,n)}static computeBBox(t,i,s,n){const{font:o,lineHeight:a,textAlign:r,textBaseline:l}=n,{width:c,height:h,lineMetrics:d}=Ze(o).measureLines(t),u=a?a*d.length:h,p=ko.calcTopOffset(u,d[0],l),f=ko.calcLeftOffset(c,r);return new re(i-f,s-p,c,u)}static calcTopOffset(t,i,s){switch(s){case"alphabetic":return i?.ascent??0;case"middle":return t/2;case"bottom":return t;default:return 0}}static calcLeftOffset(t,i){let s=0;switch(i){case"center":s=.5;break;case"right":case"end":s=1}return t*s}computeBBox(){if(this.generateTextMap(),this.textMap?.size){const r=re.merge(this.textMap.values());return r.x=this.x-ko.calcLeftOffset(r.width,this.textAlign),r.y=this.y,r}const{x:t,y:i,lines:s,textBaseline:n,textAlign:o}=this,a=ko.computeBBox(s,t,i,{font:this,textBaseline:n,textAlign:o});return this.boxing!=null&&a.grow(this.boxPadding),a}getTextMeasureBBox(){return this.computeBBox()}getPlainText(){return Pe(this.text)}isPointInPath(t,i){return this.getBBox()?.containsPoint(t,i)??!1}setScene(t){this.richText?.setScene(t),super.setScene(t)}generateTextMap(){if(!Ce(this.text)||this.textMap?.size)return;this.textMap??(this.textMap=new Map);let t=0;const i=this.richText.children();for(const{width:s,height:n,ascent:o,segments:a}of Ks(this.text,this).lineMetrics){let r=0;for(const{color:l,textMetrics:c,...h}of a){const d=i.next().value;d.x=this.x-s/2+r,d.y=o+t,d.setProperties({...h,fill:l??this.fill});const u=d.getBBox();this.textMap.set(d,u),r+=c.width}t+=n}}render(t){const{ctx:i,stats:s}=t;if(!this.layerManager||!this.hasRenderableText())return s&&(s.nodesSkipped+=1),super.render(t);if(Ce(this.text)&&this.richText){this.generateTextMap();const n=this.richText.getBBox(),{width:o,height:a,lineMetrics:r}=Ks(this.text,this);let l=0;switch(this.textAlign){case"left":case"start":l=o/2;break;case"right":case"end":l=o/-2}let c=this.y;switch(this.textBaseline){case"alphabetic":c-=r[0]?.ascent??0;break;case"middle":c-=r.length===1?r[0].ascent+r[0].segments.reduce((h,d)=>Math.min(h,Ze(d).baselineDistance("middle")),0):a/2;break;case"bottom":c-=a;break}this.renderBoxing(t,n.clone().translate(l,c)),i.save(),i.translate(l,c),this.richText.opacity=this.opacity,this.richText.render(t),i.restore()}else this.renderText(t);if(ko.debug.check()&&!this.textMap?.size){const n=this.getBBox();i.strokeStyle="red",i.lineWidth=1,i.strokeRect(n.x,n.y,n.width,n.height)}super.render(t)}markDirty(t){return this.textMap?.clear(),super.markDirty(t)}renderText(t){const{fill:i,stroke:s,strokeWidth:n,font:o,textAlign:a}=this;if(!i&&!(s&&n)||!this.layerManager)return super.render(t);const{ctx:r}=t;r.font!==o&&(r.font=o),r.textAlign=a,this.renderBoxing(t),this.fillStroke(r)}renderBoxing(t,i){if(!this.boxing)return;const s=i??ko.computeBBox(this.lines,this.x,this.y,this);if(s.width===0||s.height===0)return;const{x:n,y:o,width:a,height:r}=s.grow(this.boxPadding);this.boxing.opacity=this.opacity,this.boxing.x=n,this.boxing.y=o,this.boxing.width=a,this.boxing.height=r,this.boxing.preRender(t),this.boxing.render(t)}executeFill(t){this.renderLines((i,s,n)=>t.fillText(i,s,n))}executeStroke(t){this.renderLines((i,s,n)=>t.strokeText(i,s,n))}renderLines(t){const{x:i,y:s,lines:n}=this;if(!Number.isFinite(i)||!Number.isFinite(s))return;const o=Ze(this),{lineMetrics:a}=o.measureLines(n),{textBaseline:r,lineHeight:l=o.lineHeight()}=this;let c=0;r==="top"?c=a[0].ascent:(r==="middle"||r==="bottom")&&(c=l*(1-n.length),r==="middle"?(c/=2,c-=o.baselineDistance(r)):c-=a[0].descent);for(const h of a)t(h.text,i,s+c),c+=l}setFont(t){this.fontFamily=t.fontFamily,this.fontSize=t.fontSize,this.fontStyle=t.fontStyle,this.fontWeight=t.fontWeight}setAlign(t){this.textAlign=t.textAlign,this.textBaseline=t.textBaseline}setBoxing(t){const i=t.border?.enabled?t.border?.stroke:void 0;t.fill!=null||i!=null?(this.boxing??(this.boxing=new Di({scene:this.scene})),this.boxing.fill=t.fill,this.boxing.fillOpacity=t.fillOpacity??1,this.boxing.cornerRadius=t.cornerRadius??0,this.boxing.stroke=i,this.boxing.strokeWidth=t.border?.strokeWidth??0,this.boxing.strokeOpacity=t.border?.strokeOpacity??1,this.boxPadding=t.padding??0):this.boxing&&(this.boxing.destroy(),this.boxing=void 0)}getBoxingProperties(){const{fill:t,fillOpacity:i,cornerRadius:s,stroke:n,strokeWidth:o,strokeOpacity:a}=this.boxing??{};return{border:{enabled:n!=null,stroke:n,strokeWidth:o,strokeOpacity:a},cornerRadius:s,fill:t,fillOpacity:i,padding:this.boxPadding}}toSVG(){if(!this.visible||!this.hasRenderableText())return;const t=this.text;if(t==null)return;const i=Pt("text");if(Ce(t))for(const s of t){const n=Pt("tspan");Qw(n,{fontSize:s.fontSize??this.fontSize,fontFamily:s.fontFamily??this.fontFamily,fontWeight:s.fontWeight??this.fontWeight,fontStyle:s.fontStyle??this.fontStyle}),this.applySvgFillAttributes(n),n.textContent=Dt(s.text),i.append(n)}else this.applySvgFillAttributes(i),Qw(i,this),i.setAttribute("text-anchor",{center:"middle",left:"start",right:"end",start:"start",end:"end"}[this.textAlign??"start"]),i.setAttribute("alignment-baseline",this.textBaseline),i.setAttribute("x",String(this.x)),i.setAttribute("y",String(this.y)),i.textContent=Dt(t);return{elements:[i]}}hasRenderableText(){const{text:t}=this;return t==null?!1:Ce(t)?!0:Dt(t)!==""}};an.className="Text",an.debug=Me.create(!0,"scene:text"),an.defaultFontSize=10,g([U()],an.prototype,"x",2),g([U()],an.prototype,"y",2),g([Ig({changeCb:e=>e.onTextChange()})],an.prototype,"text",2),g([U({changeCb:e=>{e.fontCache=void 0}})],an.prototype,"fontStyle",2),g([U({changeCb:e=>{e.fontCache=void 0}})],an.prototype,"fontWeight",2),g([U({changeCb:e=>{e.fontCache=void 0}})],an.prototype,"fontSize",2),g([U({changeCb:e=>{e.fontCache=void 0}})],an.prototype,"fontFamily",2),g([U()],an.prototype,"textAlign",2),g([U()],an.prototype,"textBaseline",2),g([U()],an.prototype,"lineHeight",2);var rn=an,dT=class extends Qd(rn){},su=class extends Qd(Jd(rn)){},nu=class extends bi{constructor(e){super(),this.ctx=e,this.rectNode=new Di,this.textNode=new rn,this.fill="white",this.node=this.createNode(),this.node.append([this.rectNode,this.textNode]),this.visible=!0,this.cleanup.register(e.scene.attachNode(this.node),e.eventsHub.on("layout:complete",t=>this.onLayoutComplete(t)))}createNode(){return new Oe({name:"background",zIndex:0})}onLayoutComplete(e){const{width:t,height:i}=e.chart;this.rectNode.width=t,this.rectNode.height=i}};g([m,kt("node","visible")],nu.prototype,"visible",2),g([m,kt("rectNode","fill")],nu.prototype,"fill",2),g([m],nu.prototype,"image",2),g([m,kt("textNode")],nu.prototype,"text",2);var Et=class extends K{constructor(){super(...arguments),this.id=Mi(this),this.node=new dT({zIndex:1}).setProperties({textAlign:"center",pointerEvents:1}),this.enabled=!1,this.textAlign="center",this.fontSize=10,this.fontFamily="sans-serif",this.wrapping="always",this.padding=0,this.layoutStyle="block",this.truncated=!1}registerInteraction(e,t){return e.eventsHub.on("layout:complete",()=>this.updateA11yText(e,t))}computeTextWrap(e,t){const{text:i,padding:s,wrapping:n}=this,o=Math.min(this.maxWidth??1/0,e)-s*2,a=this.maxHeight??t-s*2,r={maxWidth:o,maxHeight:a,font:this,textWrap:n};if(!Number.isFinite(o)&&!Number.isFinite(a)){this.node.text=i;return}let l;Ce(i)?(l=by(i,r),this.truncated=l.some(Op)):(l=xa(Dt(i),r),this.truncated=sl(l)),this.node.text=l}updateA11yText(e,t){const{proxyInteractionService:i}=e;if(!this.enabled||!this.text){this.destroyProxyText();return}const s=Kt.toCanvas(this.node);if(!s)return;const{id:n}=this;this.proxyText==null&&(this.proxyText=i.createProxyElement({type:"text",domManagerId:n,where:t}),this.proxyTextListeners=[this.proxyText.addListener("mousemove",r=>this.handleMouseMove(e,r)),this.proxyText.addListener("mouseleave",r=>this.handleMouseLeave(e,r))]);const o=Pe(this.text);o!==this.lastProxyTextContent&&(this.proxyText.textContent=o,this.lastProxyTextContent=o);const{lastProxyBBox:a}=this;(a==null||s.x!==a.x||s.y!==a.y||s.width!==a.width||s.height!==a.height)&&(this.proxyText.setBounds(s),this.lastProxyBBox={x:s.x,y:s.y,width:s.width,height:s.height})}handleMouseMove(e,t){if(t!=null&&this.enabled&&this.truncated){const{x:i,y:s}=Kt.toCanvas(this.node),n=t.sourceEvent.offsetX+i,o=t.sourceEvent.offsetY+s;e.tooltipManager.updateTooltip(this.id,{canvasX:n,canvasY:o,showArrow:!1},[{type:"structured",title:Pe(this.text)}])}}handleMouseLeave(e,t){e.tooltipManager.removeTooltip(this.id,void 0,!0)}destroy(){this.destroyProxyText()}destroyProxyText(){if(this.proxyText!=null){for(const e of this.proxyTextListeners??[])e();this.proxyTextListeners=void 0,this.proxyText.destroy(),this.proxyText=void 0,this.lastProxyTextContent=void 0,this.lastProxyBBox=void 0}}};Et.className="Caption",Et.SMALL_PADDING=10,g([m,kt("node","visible")],Et.prototype,"enabled",2),g([m,kt("node")],Et.prototype,"text",2),g([m,kt("node")],Et.prototype,"textAlign",2),g([m,kt("node")],Et.prototype,"fontStyle",2),g([m,kt("node")],Et.prototype,"fontWeight",2),g([m,kt("node")],Et.prototype,"fontSize",2),g([m,kt("node")],Et.prototype,"fontFamily",2),g([m,kt("node","fill")],Et.prototype,"color",2),g([m],Et.prototype,"spacing",2),g([m],Et.prototype,"maxWidth",2),g([m],Et.prototype,"maxHeight",2),g([m],Et.prototype,"wrapping",2),g([m],Et.prototype,"padding",2),g([m],Et.prototype,"layoutStyle",2);var Ky=class extends Array{destroy(){for(const e of this)e.destroy();this.length=0}findById(e){return this.find(t=>t.id===e)}matches(e){return this.length===Object.keys(e).length&&WS(e,(t,i)=>fe(i)&&"type"in i&&this.findById(t)?.type===i.type)}getById(e){const t=this.findById(e);if(!t)throw new Error(`Could not find axis by id [${e}].`);return t}},lH=class extends Ky{get x(){return this.getById("x")}get y(){return this.getById("y")}perpendicular(e){const t=e.direction==="x"?"y":"x";return this[t]}},cH=class extends Ky{get angle(){return this.getById("angle")}get radius(){return this.getById("radius")}},Yy=class{constructor(){this.title=new Et,this.subtitle=new Et,this.footnote=new Et}positionCaptions({layoutBox:e}){const{title:t,subtitle:i,footnote:s}=this,n=e.height/10;t.enabled&&(this.positionCaption("top",t,e,n),this.shrinkLayoutByCaption("top",t,e)),i.enabled&&(this.positionCaption("top",i,e,n),this.shrinkLayoutByCaption("top",i,e)),s.enabled&&(this.positionCaption("bottom",s,e,n),this.shrinkLayoutByCaption("bottom",s,e))}positionAbsoluteCaptions(e){const{title:t,subtitle:i,footnote:s}=this,{rect:n}=e.series;for(const o of[t,i,s])if(o.layoutStyle==="overlay"){if(o.textAlign==="left")o.node.x=n.x+o.padding;else if(o.textAlign==="right"){const a=o.node.getBBox();o.node.x=n.x+n.width-a.width-o.padding}}}computeX(e,t){return e==="left"?t.x:e==="right"?t.x+t.width:t.x+t.width/2}positionCaption(e,t,i,s){if(!t.text)return;const{lineMetrics:n}=Ce(t.text)?Ks(t.text,t):Ze(t).measureLines(Dt(t.text)),o=Math.max(n[0].height,s);t.node.x=this.computeX(t.textAlign,i)+t.padding,t.node.y=i.y+(e==="top"?0:i.height)+t.padding,t.node.textBaseline=e,t.computeTextWrap(i.width,o)}shrinkLayoutByCaption(e,t,i){if(t.layoutStyle==="block"){const s=t.node.getBBox().clone(),{spacing:n=0}=t;e==="bottom"&&Ce(t.text)&&(s.y-=s.height),i.shrink(Math.ceil(e==="top"?s.y-i.y+s.height+n:i.y+i.height-s.y+n),e)}}};g([m],Yy.prototype,"title",2),g([m],Yy.prototype,"subtitle",2),g([m],Yy.prototype,"footnote",2);var hH=["candlestick","hollow-candlestick","ohlc","line","step-line","hlc","high-low"],dH=class{constructor(e){this.chartService=e,this.mementoOriginatorKey="chartType"}createMemento(){let e=this.chartService.publicApi?.getOptions()?.chartType;return e??(e="candlestick"),e}guardMemento(e){return e==null||hH.includes(e)}restoreMemento(e,t,i){if(i==null)return;const s={chartType:i};this.chartService.publicApi?.updateDelta(s).catch(n=>j.error("error restoring state",n))}},ue="13.0.0",uT=Symbol("previous-memento-not-found"),uH=class{constructor(e){this.history=[],this.historyIndex=-1,this.originators=new Map,this.clearState=new Map,this.maxHistoryLength=100,this.debug=Me.create(!0,"history"),this.cleanup=new pt,this.cleanup.register(e.on("series:undo",this.undo.bind(this)),e.on("series:redo",this.redo.bind(this)))}destroy(){this.cleanup.flush()}addMementoOriginator(e){this.originators.set(e.mementoOriginatorKey,e),this.clearState.set(e.mementoOriginatorKey,e.createMemento()),this.debugEvent("History add originator:",e.mementoOriginatorKey)}clear(){this.debug("History clear:",Object.keys(this.originators)),this.history=[],this.historyIndex=-1;for(const[e,t]of this.originators.entries())this.clearState.set(e,t.createMemento())}record(e,...t){this.historyIndex<this.history.length-1&&(this.history=this.history.slice(0,this.historyIndex+1)),this.history.length>this.maxHistoryLength&&(this.history=this.history.slice(-this.maxHistoryLength));const i=new Map;for(const s of t){if(!this.originators.has(s.mementoOriginatorKey))throw new Error(`Originator [${s.mementoOriginatorKey}] has not been added to the HistoryManager.`);i.set(s.mementoOriginatorKey,s.createMemento())}this.history.push({label:e,mementos:i}),this.historyIndex=this.history.length-1,this.debugEvent(`History record: [${e}]`)}undo(){const e=this.history[this.historyIndex];if(e){for(const t of e.mementos.keys()){const i=this.findPreviousMemento(t);if(i===uT)throw new Error(`Could not find previous memento for [${t}].`);this.restoreMemento(t,i)}this.historyIndex-=1,this.debugEvent(`History undo: [${e.label}]`)}}redo(){const e=this.history[this.historyIndex+1];if(e){for(const[t,i]of e.mementos.entries())this.restoreMemento(t,i);this.historyIndex+=1,this.debugEvent(`History redo: [${e.label}]`)}}findPreviousMemento(e){for(let t=this.historyIndex-1;t>=0;t--)if(this.history[t].mementos.has(e))return this.history[t].mementos.get(e);return this.clearState.has(e)?this.clearState.get(e):uT}restoreMemento(e,t){this.originators.get(e)?.restoreMemento(ue,ue,t)}debugEvent(...e){this.debug(...e,this.history.map((t,i)=>i===this.historyIndex?`** ${t.label} **`:t.label))}},pH=class{constructor(){this.caretaker=new Bm(ue),this.state=new Map}setState(e,t){ii(this.state.get(e.mementoOriginatorKey),t)||this.setStateAndRestore(e,t)}setStateAndRestore(e,t){this.state.set(e.mementoOriginatorKey,t),this.restoreState(e)}restoreState(e){const{caretaker:t,state:i}=this;if(!i.has(e.mementoOriginatorKey))return;const s=i.get(e.mementoOriginatorKey);t.restore({version:t.version,[e.mementoOriginatorKey]:s},e)}},gH=`.ag-charts-wrapper,.ag-charts-wrapper:after,.ag-charts-wrapper:before,.ag-charts-wrapper *,.ag-charts-wrapper *:after,.ag-charts-wrapper *:before{box-sizing:border-box}.ag-charts-wrapper{--align-items: center;--justify-content: center;position:relative;user-select:none;-webkit-user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.ag-charts-wrapper--safe-horizontal{--justify-content: flex-start}.ag-charts-wrapper--safe-vertical{--align-items: flex-start}.ag-charts-tab-guard{width:0%;height:0%;position:absolute;pointer-events:none}.ag-charts-canvas-background{position:absolute}.ag-charts-canvas-center{width:100%;height:100%;position:absolute;touch-action:auto;pointer-events:auto;display:flex;align-items:var(--align-items);justify-content:var(--justify-content)}.ag-charts-canvas-container,.ag-charts-canvas{position:relative;user-select:none;-webkit-user-select:none}.ag-charts-canvas-container>*,.ag-charts-canvas>*{pointer-events:none}.ag-charts-canvas canvas{display:block}.ag-charts-series-area{outline:none;pointer-events:auto;position:absolute}.ag-charts-swapchain{top:0;left:0;outline:none;opacity:0;pointer-events:none;position:absolute;width:100%;height:100%}.ag-charts-swapchain:focus-visible{opacity:1}.ag-charts-canvas-proxy,.ag-charts-canvas-overlay{inset:0;pointer-events:none;position:absolute;user-select:none;-webkit-user-select:none}.ag-charts-canvas-overlay>*{position:absolute;pointer-events:auto}.ag-charts-theme-default,.ag-charts-theme-default-dark{--ag-charts-accent-color: #2196f3;--ag-charts-background-color: #fff;--ag-charts-border-color: #dddddd;--ag-charts-border-radius: 4px;--ag-charts-chart-background-color: #fff;--ag-charts-chart-padding: 20px;--ag-charts-focus-shadow: 0 0 0 3px #2196f3;--ag-charts-foreground-color: #181d1f;--ag-charts-font-family: Verdana, sans-serif;--ag-charts-font-size: 12px;--ag-charts-font-weight: 400;--ag-charts-popup-shadow: 0 0 16px rgba(0, 0, 0, .15);--ag-charts-subtle-text-color: #8c8c8c;--ag-charts-text-color: #181d1f;--ag-charts-chrome-background-color: #fafafa;--ag-charts-chrome-font-family: Verdana, sans-serif;--ag-charts-chrome-font-size: 12px;--ag-charts-chrome-font-weight: 400;--ag-charts-chrome-subtle-text-color: #8c8c8c;--ag-charts-chrome-text-color: #181d1f;--ag-charts-button-background-color: #fff;--ag-charts-button-border: 1px solid #dddddd;--ag-charts-button-font-weight: normal;--ag-charts-button-text-color: inherit;--ag-charts-input-background-color: #fff;--ag-charts-input-border: 1px solid #dddddd;--ag-charts-input-text-color: #181d1f;--ag-charts-menu-background-color: #fafafa;--ag-charts-menu-border: 1px solid #dddddd;--ag-charts-menu-text-color: #181d1f;--ag-charts-panel-background-color: #fafafa;--ag-charts-panel-text-color: #181d1f;--ag-charts-tooltip-background-color: #fafafa;--ag-charts-tooltip-border: 1px solid #dddddd;--ag-charts-tooltip-text-color: #181d1f;--ag-charts-tooltip-subtle-text-color: #8c8c8c;--ag-charts-crosshair-label-background-color: #fafafa;--ag-charts-crosshair-label-text-color: #181d1f;--ag-charts-spacing: 4px;--ag-charts-icon-size: 16px;--ag-charts-focus-color: color-mix(in srgb, var(--ag-charts-background-color), var(--ag-charts-accent-color) 12%);--ag-charts-input-border-radius: var(--ag-charts-border-radius);--ag-charts-input-focus-border-color: var(--ag-charts-accent-color);--ag-charts-input-focus-text-color: var(--ag-charts-accent-color);--ag-charts-input-disabled-background-color: color-mix( in srgb, var(--ag-charts-chrome-background-color), var(--ag-charts-foreground-color) 6% );--ag-charts-input-disabled-border-color: var(--ag-charts-border-color);--ag-charts-input-disabled-text-color: color-mix( in srgb, var(--ag-charts-chrome-background-color), var(--ag-charts-input-text-color) 50% );--ag-charts-input-placeholder-text-color: color-mix( in srgb, var(--ag-charts-input-background-color), var(--ag-charts-input-text-color) 60% );--ag-charts-button-border-radius: var(--ag-charts-border-radius);--ag-charts-button-focus-background-color: color-mix( in srgb, var(--ag-charts-button-background-color), var(--ag-charts-accent-color) 12% );--ag-charts-button-focus-border-color: var(--ag-charts-accent-color);--ag-charts-button-focus-text-color: var(--ag-charts-accent-color);--ag-charts-button-disabled-background-color: color-mix( in srgb, var(--ag-charts-chrome-background-color), var(--ag-charts-foreground-color) 6% );--ag-charts-button-disabled-border-color: var(--ag-charts-border-color);--ag-charts-button-disabled-text-color: color-mix( in srgb, var(--ag-charts-chrome-background-color), var(--ag-charts-chrome-text-color) 50% );--ag-charts-checkbox-background-color: color-mix( in srgb, var(--ag-charts-background-color), var(--ag-charts-foreground-color) 35% );--ag-charts-checkbox-checked-background-color: var(--ag-charts-accent-color);--ag-charts-tooltip-border-radius: var(--ag-charts-border-radius);--ag-charts-menu-border-radius: var(--ag-charts-border-radius);--ag-charts-chrome-font-size-small: var(--ag-charts-chrome-font-size);--ag-charts-chrome-font-size-medium: calc(var(--ag-charts-chrome-font-size) * (13 / 12));--ag-charts-chrome-font-size-large: calc(var(--ag-charts-chrome-font-size) * (14 / 12));--ag-charts-border: 1px solid var(--ag-charts-border-color);--ag-charts-focus-border: 1px solid var(--ag-charts-accent-color);--ag-charts-focus-border-shadow: 0 0 0 3px color-mix(in srgb, transparent, var(--ag-charts-accent-color) 20%);--ag-charts-layer-menu: 6;--ag-charts-layer-ui-overlay: 5;--ag-charts-layer-tooltip: 4;--ag-charts-layer-toolbar: 3;--ag-charts-layer-crosshair: 2;--ag-charts-layer-annotations: 1}.ag-charts-theme-default-dark{--ag-charts-focus-color: color-mix(in srgb, var(--ag-charts-background-color), var(--ag-charts-accent-color) 22%)}.ag-chart-canvas-wrapper .ag-charts-theme-default{--ag-charts-border-radius: var(--ag-border-radius, 4px);--ag-charts-border: var(--ag-borders-critical, solid 1px) var(--ag-charts-border-color);--ag-charts-focus-shadow: var(--ag-focus-shadow, 0 0 0 3px var(--ag-charts-accent-color));--ag-charts-focus-border-shadow: var( --ag-focus-shadow, 0 0 0 3px color-mix(in srgb, transparent, var(--ag-charts-accent-color) 20%) )}.ag-charts-icon{display:block;width:20px;height:20px;speak:none;speak:never;mask:var(--icon) center / contain no-repeat;background-color:currentColor;transition:background-color .25s ease-in-out}.ag-charts-icon-align-center{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNNyAxMGg2djFIN3pNNCA3aDEydjFINHptMSA2aDEwdjFINXoiLz48L3N2Zz4=)}.ag-charts-icon-align-left{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNNCAxMGg2djFINHptMC0zaDEydjFINHptMCA2aDEwdjFINHoiLz48L3N2Zz4=)}.ag-charts-icon-align-right{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMTAgMTBoNnYxaC02ek00IDdoMTJ2MUg0em0yIDZoMTB2MUg2eiIvPjwvc3ZnPg==)}.ag-charts-icon-arrow-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE1LjI5MyA0LjVIMTIuNXYtMUgxN3Y0aC0xVjUuMjA3bC05LjY0NiA5LjY0Ny0uNzA4LS43MDh6IiBmaWxsPSIjMDAwIi8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik03IDE2YTIuNSAyLjUgMCAxIDEtNSAwIDIuNSAyLjUgMCAwIDEgNSAwbS0yLjUgMS41YTEuNSAxLjUgMCAxIDAgMC0zIDEuNSAxLjUgMCAwIDAgMCAzIiBmaWxsPSIjMDAwIi8+PC9zdmc+)}.ag-charts-icon-arrow-down-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02IDhMMS41IDhMMTAgMThMMTguNSA4TDE0IDhMMTQgM0w2IDNMNiA4Wk03IDRMNyA5SDMuNjYyNDRMMTAgMTYuNDU2TDE2LjMzNzYgOUwxMyA5TDEzIDRMNyA0WiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==)}.ag-charts-icon-arrow-up-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNCAxMkgxOC41TDEwIDJMMS41IDEySDZMNi4wMDAwMiAxN0gxNFYxMlpNMTMgMTZWMTFIMTYuMzM3NkwxMCAzLjU0NDA1TDMuNjYyNDQgMTFIN0w3LjAwMDAyIDE2SDEzWiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==)}.ag-charts-icon-callout-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMyA0LjVBMS41IDEuNSAwIDAgMSA0LjUgM2gxMUExLjUgMS41IDAgMCAxIDE3IDQuNXY4YTEuNSAxLjUgMCAwIDEtMS41IDEuNWgtNC41MTRhMjYgMjYgMCAwIDAtMi4wMTcgMS41NGwtLjMxNC4yNmMtLjU1LjQ1Ny0xLjExNS45MjYtMS43NiAxLjQtLjY2OS40OTEtMS41NjItLjAxMi0xLjU2Mi0uOFYxNEg0LjVBMS41IDEuNSAwIDAgMSAzIDEyLjV6TTQuNSA0YS41LjUgMCAwIDAtLjUuNXY4YS41LjUgMCAwIDAgLjUuNWgxLjgzM3YzLjM3MmEzNiAzNiAwIDAgMCAxLjY3OC0xLjMzOGwuMzItLjI2NWEyNiAyNiAwIDAgMSAyLjIyNS0xLjY4NWwuMTI2LS4wODRIMTUuNWEuNS41IDAgMCAwIC41LS41di04YS41LjUgMCAwIDAtLjUtLjV6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-candlestick-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNyAxdjNoMnYxMkg3djNINnYtM0g0VjRoMlYxek01IDVoM3YxMEg1ek0xMSAxNFY2aDJWMy4yNWgxVjZoMnY4aC0ydjIuNzVoLTFWMTR6bTEtN2gzdjZoLTN6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-close{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJtNSA1IDEwIDEwTTUgMTUgMTUgNSIgc3Ryb2tlPSIjMDAwIi8+PC9zdmc+)}.ag-charts-icon-comment-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNy41MTMgMy45OTVhNi41IDYuNSAwIDAgMSA2LjA5OCAxMS40MWMtLjU4OC4zOTMtMS4yMTcuNTM2LTEuODI5LjU4NWExMyAxMyAwIDAgMS0xLjI3LjAxN0EyNyAyNyAwIDAgMCAxMCAxNkg0LjVhLjUuNSAwIDAgMS0uNS0uNVYxMHEwLS4yNDctLjAwNy0uNTEzYy0uMDA4LS40MTYtLjAxNi0uODU3LjAxNy0xLjI2OS4wNS0uNjEyLjE5Mi0xLjI0LjU4NS0xLjgzYTYuNSA2LjUgMCAwIDEgMi45MTgtMi4zOTNtMy41Ni42MWE1LjUgNS41IDAgMCAwLTUuNjQ2IDIuMzRjLS4yNjYuMzk3LS4zNzkuODQyLS40MiAxLjM1NC0uMDMuMzYtLjAyMi43MTgtLjAxNSAxLjEwOFE1IDkuNjg5IDUgMTB2NWg1cS4zMTEuMDAxLjU5My4wMDhjLjM5LjAwNy43NDcuMDE1IDEuMTA4LS4wMTUuNTEyLS4wNDEuOTU3LS4xNTQgMS4zNTUtLjQyYTUuNSA1LjUgMCAwIDAtMS45ODMtOS45NjciIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-crosshair-add-line{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTEwIDUuNWEuNS41IDAgMCAxIC41LjV2My41aDMuODc1YS41LjUgMCAwIDEgMCAxSDEwLjV2NC4yNWEuNS41IDAgMSAxLTEgMFYxMC41SDUuNjI1YS41LjUgMCAxIDEgMC0xSDkuNVY2YS41LjUgMCAwIDEgLjUtLjUiLz48L3N2Zz4=)}.ag-charts-icon-date-range-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMiAyaDF2MTZIMnptMTUgMGgxdjE2aC0xeiIgZmlsbD0iIzE4MUQxRiIvPjxwYXRoIGQ9Ik0xMy4xNTcgMTFINXYtMWg3Ljc5M0wxMSA4LjIwN2wuNzA3LS43MDcgMy4xODIgMy4xODItMy4xODIgMy4xODItLjcwNy0uNzA3eiIgZmlsbD0iIzAwMCIvPjwvc3ZnPg==)}.ag-charts-icon-date-price-range-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMyAySDJ2MTZoMXptMy41MDcgNC44OUw4LjUgNC44OTVWMTBINXYxaDMuNXY3aDF2LTdoNS4wODhsLTEuOTU3IDEuOTU3LjcwNy43MDcgMy4xODItMy4xODJMMTMuMzM4IDcuM2wtLjcwNy43MDdMMTQuNjI0IDEwSDkuNVY0LjkzMmwxLjk1NyAxLjk1Ny43MDctLjcwN0w4Ljk4MiAzIDUuOCA2LjE4MnoiIGZpbGw9IiMxODFEMUYiLz48L3N2Zz4=)}.ag-charts-icon-delete{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZD0iTTguNDk2IDguOTk2QS41LjUgMCAwIDEgOSA5LjQ5MnY0YS41LjUgMCAxIDEtMSAuMDA4di00YS41LjUgMCAwIDEgLjQ5Ni0uNTA0TTEyIDkuNWEuNS41IDAgMCAwLTEgMHY0YS41LjUgMCAwIDAgMSAweiIvPjxwYXRoIGZpbGw9IiMxMzE3MjIiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTYgNVYzLjVBMi41IDIuNSAwIDAgMSA4LjUgMWgzQTIuNSAyLjUgMCAwIDEgMTQgMy41VjVoMi44MzNhLjUuNSAwIDAgMSAwIDFIMTV2MTAuMjVjMCAuNDE1LS4wNjYuODYzLS4zIDEuMjIxLS4yNTcuMzk0LS42NzIuNjEyLTEuMi42MTJoLTdjLS41MjggMC0uOTQzLS4yMTgtMS4yLS42MTItLjIzNC0uMzU4LS4zLS44MDYtLjMtMS4yMjFWNkgzLjMzM2EuNS41IDAgMCAxIDAtMXptMS0xLjVBMS41IDEuNSAwIDAgMSA4LjUgMmgzQTEuNSAxLjUgMCAwIDEgMTMgMy41VjVIN3pNNiAxNi4yNVY2aDh2MTAuMjVjMCAuMzM1LS4wNTkuNTU0LS4xMzguNjc1LS4wNTUuMDg1LS4xNC4xNTgtLjM2Mi4xNThoLTdjLS4yMjIgMC0uMzA3LS4wNzMtLjM2Mi0uMTU4LS4wOC0uMTIxLS4xMzgtLjM0LS4xMzgtLjY3NSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-disjoint-channel,.ag-charts-icon-disjoint-channel-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTkuMDI4IDE3LjQ2YTIuMjUgMi4yNSAwIDAgMC00LjA5Mi0xLjg1bC05LjUxMS0yLjM3OGEyLjI1IDIuMjUgMCAxIDAtLjIyNS45NzRsOS40NzUgMi4zNjlhMi4yNTEgMi4yNTEgMCAwIDAgNC4zNTMuODg2bS0xLjY2Mi0xLjk2NWExLjI1IDEuMjUgMCAxIDEtLjg4NSAyLjMzOCAxLjI1IDEuMjUgMCAwIDEgLjg4NS0yLjMzOE00LjM0MyAxMy42NjlhMS4yNSAxLjI1IDAgMSAwLTIuMzM4LS44ODUgMS4yNSAxLjI1IDAgMCAwIDIuMzM4Ljg4NU0zLjk3IDguNzY5YTIuMjUgMi4yNSAwIDAgMCAxLjQ1NS0yLjExbDkuNTExLTIuMzc4YTIuMjUgMi4yNSAwIDEgMC0uMjYtLjk2NUw1LjIgNS42ODVhMi4yNSAyLjI1IDAgMSAwLTEuMjMgMy4wODRtLjM3My0yLjU0N2ExLjI1IDEuMjUgMCAxIDEtMi4zMzguODg1IDEuMjUgMS4yNSAwIDAgMSAyLjMzOC0uODg1bTEzLjc1LTMuNDM4YTEuMjUgMS4yNSAwIDEgMS0yLjMzOC44ODUgMS4yNSAxLjI1IDAgMCAxIDIuMzM4LS44ODUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-drag-handle{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSI1Ljc1IiBjeT0iNy43NSIgcj0iLjc1IiBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii41Ii8+PGNpcmNsZSBjeD0iOS43NSIgY3k9IjcuNzUiIHI9Ii43NSIgZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuNSIvPjxjaXJjbGUgY3g9IjEzLjc1IiBjeT0iNy43NSIgcj0iLjc1IiBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii41Ii8+PGNpcmNsZSBjeD0iMTMuNzUiIGN5PSIxMS43NSIgcj0iLjc1IiBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii41Ii8+PGNpcmNsZSBjeD0iOS43NSIgY3k9IjExLjc1IiByPSIuNzUiIGZpbGw9IiMwMDAiIGZpbGwtb3BhY2l0eT0iLjUiLz48Y2lyY2xlIGN4PSI1Ljc1IiBjeT0iMTEuNzUiIHI9Ii43NSIgZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuNSIvPjwvc3ZnPg==)}.ag-charts-icon-fibonacci-retracement-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMiA1aDEydjFIMnoiLz48Y2lyY2xlIGN4PSIxNS43NSIgY3k9IjUuNSIgcj0iMS43NSIgc3Ryb2tlPSIjMDAwIi8+PGNpcmNsZSBjeD0iNC4yNSIgY3k9IjE0LjUiIHI9IjEuNzUiIHN0cm9rZT0iIzAwMCIvPjxwYXRoIGZpbGw9IiMwMDAiIGQ9Ik0xOCAxNUg2di0xaDEyem0wLTQuNUgydi0xaDE2eiIvPjwvc3ZnPg==)}.ag-charts-icon-fibonacci-retracement-trend-based-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJtNC45OTYgMTIuNjc0IDMuMjkxLTUuNzQzLjg2OC40OTctMy4yOTEgNS43NDN6Ii8+PGNpcmNsZSBjeD0iOS43NSIgY3k9IjUuNSIgcj0iMS43NSIgc3Ryb2tlPSIjMDAwIi8+PGNpcmNsZSBjeD0iNC4zNTEiIGN5PSIxNC41IiByPSIxLjc1IiBzdHJva2U9IiMwMDAiLz48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMTggNmgtN1Y1aDd6bTAgNC41aC03di0xaDd6bTAgNC41SDZ2LTFoMTJ6Ii8+PC9zdmc+)}.ag-charts-icon-fill-color{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJtOC4wNzEgNC4wNi0uOTI0LS45MjQuNzA3LS43MDcgNy4yODggNy4yODgtNC45NSA0Ljk1YTMuNSAzLjUgMCAwIDEtNC45NSAwbC0xLjQxNC0xLjQxNGEzLjUgMy41IDAgMCAxIDAtNC45NXptLjcwNy43MDhMNC41MzYgOS4wMWEyLjUgMi41IDAgMCAwIDAgMy41MzZMNS45NSAxMy45NmEyLjUgMi41IDAgMCAwIDMuNTM1IDBsNC4yNDMtNC4yNDN6bTYuOSA3LjIwMi0uMzQ1LjM2My0uMzQ0LS4zNjNhLjUuNSAwIDAgMSAuNjg4IDBtLS4zNDUgMS4wOGE4IDggMCAwIDAtLjI4LjMyMyA0LjMgNC4zIDAgMCAwLS40MDkuNTgyYy0uMTEzLjIwMS0uMTQ0LjMyNi0uMTQ0LjM3OGEuODMzLjgzMyAwIDAgMCAxLjY2NyAwYzAtLjA1Mi0uMDMxLS4xNzctLjE0NC0uMzc4YTQuMyA0LjMgMCAwIDAtLjQxLS41ODIgOCA4IDAgMCAwLS4yOC0uMzIybS0uMzQ0LTEuMDguMzQ0LjM2My4zNDQtLjM2My4wMDIuMDAyLjAwNC4wMDQuMDEzLjAxMmE2IDYgMCAwIDEgLjIwNi4yMDhjLjEzMS4xMzYuMzA4LjMyNy40ODUuNTQ1LjE3Ni4yMTUuMzYzLjQ2Ny41MDcuNzI0LjEzNy4yNDMuMjczLjU1My4yNzMuODY4YTEuODMzIDEuODMzIDAgMSAxLTMuNjY3IDBjMC0uMzE1LjEzNi0uNjI1LjI3My0uODY4LjE0NC0uMjU3LjMzLS41MDkuNTA3LS43MjRhOSA5IDAgMCAxIC42NDUtLjcwOGwuMDQ2LS4wNDUuMDEzLS4wMTIuMDA0LS4wMDR6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-hollow-candlestick-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1vcGFjaXR5PSIuMTUiIGQ9Ik01IDVoM3YxMEg1eiIvPjxwYXRoIGZpbGw9IiMxMzE3MjIiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTcgMXYzaDJ2MTJIN3YzSDZ2LTNINFY0aDJWMXpNNSA1aDN2MTBINXptNyAyaDN2NmgtM3ptLTEgN1Y2aDJWMy4yNWgxVjZoMnY4aC0ydjIuNzVoLTFWMTR6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-horizontal-line,.ag-charts-icon-horizontal-line-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNLjUgOS41aDcuMzA2YTIuMjUgMi4yNSAwIDAgMSA0LjM4OCAwSDE5LjV2MWgtNy4zMDZhMi4yNSAyLjI1IDAgMCAxLTQuMzg4IDBILjV6bTkuNSAxLjc1YTEuMjUgMS4yNSAwIDEgMCAwLTIuNSAxLjI1IDEuMjUgMCAwIDAgMCAyLjUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-line-color{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTQuMjQyIDIuNzIyYy0uNjEyIDAtMS4yLjI0My0xLjYzMi42NzVsLTEuMzQzIDEuMzQ0YS41LjUgMCAwIDAtLjExMi4xMTJMNC4wNSAxMS45NTljLS4yMDcuMjA3LS4zNi40Ni0uNDQ2Ljc0di4wMDFsLS42OSAyLjc2N3YuMDAyYS44Mi44MiAwIDAgMCAxLjAyMiAxLjAyMWguMDAybDIuNjM0LS44MjJjLjI4LS4wODUuNTM0LS4yMzcuNzQtLjQ0M2w3LjEwNy03LjEwOGEuNS41IDAgMCAwIC4xMTItLjExMmwxLjM0My0xLjM0M2EyLjMwOCAyLjMwOCAwIDAgMC0xLjYzMi0zLjk0TTE0LjEyMiA3bDEuMDQ0LTEuMDQ1YTEuMzA4IDEuMzA4IDAgMSAwLTEuODQ5LTEuODVMMTIuMjcxIDUuMTV6bS0yLjU1OC0xLjE0Mi02LjgwNyA2LjgwOWEuOC44IDAgMCAwLS4xOTYuMzI1bC0uNzUgMi40NjggMi40Ny0uNzQ5YS44LjggMCAwIDAgLjMyNS0uMTk0bDYuODA4LTYuODF6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-line-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJtMTcuMzYyIDQuODczLTQuNTk0IDYuNjU0LTQuODUtMy4zMTctNC4yNTEgNi45NzctLjg1NC0uNTJMNy42MTIgNi43OWw0Ljg5OSAzLjM1IDQuMDI4LTUuODM2eiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-line-style-dashed{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMiA5aDR2MUgyem0xMiAwaDR2MWgtNHpNOCA5aDR2MUg4eiIvPjwvc3ZnPg==)}.ag-charts-icon-line-style-dotted{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIyLjUiIGN5PSI5LjUiIHI9Ii41IiBmaWxsPSIjMDAwIi8+PGNpcmNsZSBjeD0iNC41IiBjeT0iOS41IiByPSIuNSIgZmlsbD0iIzAwMCIvPjxjaXJjbGUgY3g9IjYuNSIgY3k9IjkuNSIgcj0iLjUiIGZpbGw9IiMwMDAiLz48Y2lyY2xlIGN4PSI4LjUiIGN5PSI5LjUiIHI9Ii41IiBmaWxsPSIjMDAwIi8+PGNpcmNsZSBjeD0iMTAuNSIgY3k9IjkuNSIgcj0iLjUiIGZpbGw9IiMwMDAiLz48Y2lyY2xlIGN4PSIxMi41IiBjeT0iOS41IiByPSIuNSIgZmlsbD0iIzAwMCIvPjxjaXJjbGUgY3g9IjE0LjUiIGN5PSI5LjUiIHI9Ii41IiBmaWxsPSIjMDAwIi8+PGNpcmNsZSBjeD0iMTYuNSIgY3k9IjkuNSIgcj0iLjUiIGZpbGw9IiMwMDAiLz48L3N2Zz4=)}.ag-charts-icon-line-style-solid{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMiA5aDE2djFIMnoiLz48L3N2Zz4=)}.ag-charts-icon-line-with-markers-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJtMTguMTk4IDQuODg4LTMuNTU2IDQuOTE4YTIuMjUgMi4yNSAwIDEgMS0zLjg2Ni43NWwtMS40MzItLjlhMi4yNCAyLjI0IDAgMCAxLTIuMDA5LjQzNWwtMy44MjggNi40MjgtLjg2LS41MTJMNi40NSA5LjYyM2EyLjI1IDIuMjUgMCAxIDEgMy41MS0uNzYxbDEuMzI5LjgzNWEyLjI0IDIuMjQgMCAwIDEgMi41NTctLjQ5N2wzLjU0Mi00Ljg5OHptLTQuOTYgNS4xNTNhMS4yNSAxLjI1IDAgMSAwLS42NCAyLjQxOSAxLjI1IDEuMjUgMCAwIDAgLjY0LTIuNDE5TTkuMSA4LjMyMXEuMDY2LS4xOTIuMDY3LS40MDRhMS4yNSAxLjI1IDAgMSAwLS4wNjcuNDA0IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-lock,.ag-charts-icon-locked{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTAuMjA3IDMuNzY0YTIuODk0IDIuODk0IDAgMCAwLTIuODk1IDIuODk0VjloNS43ODlWNi42NThhMi44OTQgMi44OTQgMCAwIDAtMi44OTUtMi44OTRNMTQuMSA5VjYuNjU4YTMuODk0IDMuODk0IDAgMSAwLTcuNzg5IDB2Mi4zNDlBMi41IDIuNSAwIDAgMCA0IDExLjV2M0EyLjUgMi41IDAgMCAwIDYuNSAxN2g4YTIuNSAyLjUgMCAwIDAgMi41LTIuNXYtM0EyLjUgMi41IDAgMCAwIDE0LjUgOXpNNi41IDEwQTEuNSAxLjUgMCAwIDAgNSAxMS41djNBMS41IDEuNSAwIDAgMCA2LjUgMTZoOGExLjUgMS41IDAgMCAwIDEuNS0xLjV2LTNhMS41IDEuNSAwIDAgMC0xLjUtMS41eiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-measurer-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0ibTQuNDYxIDEyLjcxIDEuNTMyLTEuNTMxIDEuNDE0IDEuNDE0LjcwNy0uNzA3TDYuNyAxMC40NzJsMS41MzItMS41MzMgMiAyIC43MDctLjcwNy0yLTIgNi4wMS02LjAxIDIuODMgMi44MjhMNS4wNSAxNy43NzggMi4yMjIgMTQuOTVsMS41MzItMS41MzIgMS40MTQgMS40MTQuNzA3LS43MDd6TS44MDggMTQuOTVsLjcwNy0uNzA3TDE0LjI0MyAxLjUxNWwuNzA3LS43MDcuNzA3LjcwNyAyLjgyOCAyLjgyOC43MDcuNzA3LS43MDcuNzA3TDUuNzU3IDE4LjQ4NWwtLjcwNy43MDctLjcwNy0uNzA3LTIuODI4LTIuODI4em0xMS4wNzgtNi44MzVMMTAuNDcgNi43bC43MDctLjcwNyAxLjQxNSAxLjQxNHptLjgyNC0zLjY1NCAxIDEgLjcwOC0uNzA3LTEtMXoiIGZpbGw9IiMxODFEMUYiLz48L3N2Zz4=)}.ag-charts-icon-note-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMyA0LjVBMS41IDEuNSAwIDAgMSA0LjUgM2gxMUExLjUgMS41IDAgMCAxIDE3IDQuNXY4YTEuNSAxLjUgMCAwIDEtMS41IDEuNWgtMy4yMWwtMS40NjkgMi41N2ExIDEgMCAwIDEtMS42ODIuMDg1TDcuMjQzIDE0SDQuNUExLjUgMS41IDAgMCAxIDMgMTIuNXpNNC41IDRhLjUuNSAwIDAgMC0uNS41djhhLjUuNSAwIDAgMCAuNS41aDMuMjU3bDIuMTk2IDMuMDc0TDExLjcxIDEzaDMuNzlhLjUuNSAwIDAgMCAuNS0uNXYtOGEuNS41IDAgMCAwLS41LS41eiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNi41IDYuNUEuNS41IDAgMCAxIDcgNmg2YS41LjUgMCAwIDEgMCAxSDdhLjUuNSAwIDAgMS0uNS0uNU02LjUgOS41QS41LjUgMCAwIDEgNyA5aDZhLjUuNSAwIDAgMSAwIDFIN2EuNS41IDAgMCAxLS41LS41IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-ohlc-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZD0iTTEzIDExaC0zdi0xaDNWM2gxdjJoNHYxaC00djExaC0xek02IDE3di0yaDN2LTFINlY0SDV2MUgydjFoM3YxMXoiLz48L3N2Zz4=)}.ag-charts-icon-pan-end{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZD0ibTYuNjQ2IDEzLjgxMy0uMzUzLjM1NC43MDcuNzA3LjM1NC0uMzU0ek0xMS4xNjYgMTBsLjM1NC4zNTQuMzU0LS4zNTQtLjM1NC0uMzU0ek03LjM1NSA1LjQ4IDcgNS4xMjZsLS43MDcuNzA3LjM1My4zNTR6bTAgOS4wNCA0LjE2Ni00LjE2Ni0uNzA3LS43MDgtNC4xNjcgNC4xNjd6bTQuMTY2LTQuODc0TDcuMzU0IDUuNDhsLS43MDguNzA3IDQuMTY3IDQuMTY3ek0xMy4wODMgNXYxMGgxVjV6Ii8+PC9zdmc+)}.ag-charts-icon-pan-left{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTIuNzkgNS44MzMgOC42MjUgMTBsNC4xNjYgNC4xNjctLjcwNy43MDdMNy4yMSAxMGw0Ljg3My00Ljg3NHoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-pan-right{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNy4yMSAxNC4xNjcgMTEuMzc2IDEwIDcuMjEgNS44MzNsLjcwNy0uNzA3TDEyLjc5IDEwbC00Ljg3MyA0Ljg3NHoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-pan-start{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTYgNXYxMGgxVjV6TTkuNjI0IDEwbDQuMTY2LTQuMTY3LS43MDctLjcwN0w4LjIxIDEwbDQuODc0IDQuODc0LjcwNy0uNzA3eiIvPjwvc3ZnPg==)}.ag-charts-icon-parallel-channel,.ag-charts-icon-parallel-channel-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTcuNzIgNS4zMzFBMi4yNSAyLjI1IDAgMSAwIDE0LjcwNSAzLjZsLTkuNDkgNC41NjJhMi4yNSAyLjI1IDAgMSAwIC4yMDkgMS4wMWw5LjY2Mi00LjY0NmEyLjI1IDIuMjUgMCAwIDAgMi42MzQuODA1bS4zNzMtMi41NDdhMS4yNSAxLjI1IDAgMSAxLTIuMzM4Ljg4NSAxLjI1IDEuMjUgMCAwIDEgMi4zMzgtLjg4NU00LjM0MyA4LjY3YTEuMjUgMS4yNSAwIDEgMS0yLjMzOC44ODUgMS4yNSAxLjI1IDAgMCAxIDIuMzM4LS44ODVNNS4zMDcgMTYuNzI4YTIuMjUgMi4yNSAwIDEgMS0uNTI1LS44NThsOS45MjMtNC43N2EyLjI1IDIuMjUgMCAxIDEgLjM4MS45MjZ6bS0uOTY0LjI3NGExLjI1IDEuMjUgMCAxIDEtMi4zMzguODg1IDEuMjUgMS4yNSAwIDAgMSAyLjMzOC0uODg1bTEzLjAyMy01LjEwNmExLjI1IDEuMjUgMCAxIDAtLjg4NS0yLjMzOSAxLjI1IDEuMjUgMCAwIDAgLjg4NSAyLjMzOSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-position-bottom{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii4yNSIgZD0iTTMgMTBoMTR2MUgzem0zLTNoOHYxSDZ6Ii8+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTYgMTNoOHYxSDZ6Ii8+PC9zdmc+)}.ag-charts-icon-position-center{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMyAxMGgxNHYxSDN6Ii8+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuMjUiIGQ9Ik02IDdoOHYxSDZ6bTAgNmg4djFINnoiLz48L3N2Zz4=)}.ag-charts-icon-position-top{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii4yNSIgZD0iTTMgMTBoMTR2MUgzeiIvPjxwYXRoIGZpbGw9IiMwMDAiIGQ9Ik02IDdoOHYxSDZ6Ii8+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuMjUiIGQ9Ik02IDEzaDh2MUg2eiIvPjwvc3ZnPg==)}.ag-charts-icon-price-label-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNC41IDNBMS41IDEuNSAwIDAgMCAzIDQuNVYxM2ExLjUgMS41IDAgMCAwIDEuNSAxLjVoLjgzM3YuMDU3Yy4yNDItLjI5OS41OTctLjUwMyAxLS41NDhWMTMuNUg0LjVBLjUuNSAwIDAgMSA0IDEzVjQuNWEuNS41IDAgMCAxIC41LS41aDExYS41LjUgMCAwIDEgLjUuNXY4YS41LjUgMCAwIDEtLjUuNWgtNC44MThsLS4xMjYuMDg0YTI2IDI2IDAgMCAwLTIuMjI1IDEuNjg1bC0uMzIuMjY1LS4wNjguMDU2YTEuNSAxLjUgMCAwIDEtMi42MDkgMS4zNTRjLjAzMy43NjMuOTA1IDEuMjM4IDEuNTYuNzU2LjY0Ni0uNDc0IDEuMjEtLjk0MyAxLjc2MS0xLjRsLjMxMy0uMjZBMjYgMjYgMCAwIDEgMTAuOTg2IDE0SDE1LjVhMS41IDEuNSAwIDAgMCAxLjUtMS41di04QTEuNSAxLjUgMCAwIDAgMTUuNSAzeiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNOC43MTYgMTQuODE1YTIuMjUgMi4yNSAwIDEgMS00LjIxIDEuNTkzIDIuMjUgMi4yNSAwIDAgMSA0LjIxLTEuNTkzbS0xLjY2MiAxLjk2NmExLjI1IDEuMjUgMCAxIDAtLjg4NS0yLjMzOSAxLjI1IDEuMjUgMCAwIDAgLjg4NSAyLjMzOSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-price-range-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNOS4wNDYgMTVWNS44NzdoLjk0MlYxNXoiIGZpbGw9IiMxODFEMUYiLz48cGF0aCBkPSJNOS4wNDYgMTVWNS44NzdoLjk0MlYxNXoiIGZpbGw9IiMxODFEMUYiLz48cGF0aCBkPSJNOS41IDYuMjI4IDcuMTY3IDguMzc2IDYuNSA3Ljc2MiA5LjUgNWwzIDIuNzYyLS42NjcuNjE0eiIgZmlsbD0iIzAwMCIvPjxwYXRoIGQ9Ik0yIDE4di0xaDE2djF6TTIgM1YyaDE2djF6IiBmaWxsPSIjMTgxRDFGIi8+PC9zdmc+)}.ag-charts-icon-reset{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTIuMDQgNC40NDVhNS44MSA1LjgxIDAgMCAwLTcuMjU3IDIuNDUzLjUuNSAwIDAgMS0uODY1LS41MDJBNi44MSA2LjgxIDAgMSAxIDMgOS44MTNhLjUuNSAwIDAgMSAxIDAgNS44MSA1LjgxIDAgMSAwIDguMDQtNS4zNjgiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjxwYXRoIGZpbGw9IiMwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTQuMjg5IDMuMDAyYS41LjUgMCAwIDEgLjUuNXYyLjY1NWgyLjY1NWEuNS41IDAgMCAxIDAgMUg0LjI5YS41LjUgMCAwIDEtLjUtLjVWMy41MDJhLjUuNSAwIDAgMSAuNS0uNSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-settings{--icon: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjAgMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgc3R5bGU9ImZpbGwtcnVsZTpldmVub2RkIj48cGF0aCBkPSJNMTAgMTNhMyAzIDAgMSAwIDAtNiAzIDMgMCAwIDAgMCA2bTAtMWEyIDIgMCAxIDEtLjAwMS0zLjk5OUEyIDIgMCAwIDEgMTAgMTIiLz48cGF0aCBkPSJNMi4zMSAxNC4zNDVjLS44MTctMS40OTEuMDI3LTIuNDk5LjQ3NC0yLjg2NS41MzEtLjQzNC45NjktLjM2NS45NzItMS40OC0uMDAzLTEuMTE1LS40NDEtMS4wNDYtLjk3Mi0xLjQ4MS0uNDU0LS4zNzEtMS4zMTctMS40MDUtLjQzNC0yLjkzNmwuMDA1LS4wMDljLjg4NC0xLjUyIDIuMjA3LTEuMjkgMi43NTUtMS4wODMuNjQxLjI0My44MDEuNjU2IDEuNzY4LjEwMS45NjQtLjU2LjY4Ni0uOTA0Ljc5Ni0xLjU4Mi4wOTQtLjU3OC41NTktMS44NDMgMi4zMjYtMS44NDNoLjAxYzEuNzU5LjAwNSAyLjIyMiAxLjI2NiAyLjMxNiAxLjg0My4xMS42NzgtLjE2OCAxLjAyMi43OTYgMS41ODIuOTY3LjU1NSAxLjEyNy4xNDIgMS43NjgtLjEwMS41NDktLjIwOCAxLjg3Ni0uNDM4IDIuNzYgMS4wOTJzLjAyIDIuNTY1LS40MzQgMi45MzZjLS41MzEuNDM1LS45NjkuMzY2LS45NzIgMS40ODEuMDAzIDEuMTE1LjQ0MSAxLjA0Ni45NzIgMS40OC40NTQuMzcyIDEuMzE3IDEuNDA2LjQzNCAyLjkzN2wtLjAwNS4wMDljLS44ODQgMS41Mi0yLjIwNyAxLjI5LTIuNzU1IDEuMDgzLS42NDEtLjI0My0uODAxLS42NTYtMS43NjgtLjEwMS0uOTY0LjU2LS42ODYuOTA0LS43OTYgMS41ODEtLjA5NC41NzktLjU1OSAxLjg0NC0yLjMyNiAxLjg0NGgtLjAxYy0xLjc1OS0uMDA1LTIuMjIyLTEuMjY2LTIuMzE2LTEuODQ0LS4xMS0uNjc3LjE2OC0xLjAyMS0uNzk2LTEuNTgxLS45NjctLjU1NS0xLjEyNy0uMTQyLTEuNzY4LjEwMS0uNTQ5LjIwOC0xLjg3Ni40MzgtMi43Ni0xLjA5MmwtLjAyLS4wMzZ6TTkuOTg0IDIuMTYySDEwYzEuMzU1IDAgMS4zNDIgMS4wMzkgMS4zNTMgMS40MjUuMDA4LjMxMi4wNCAxLjE2IDEuMjU5IDEuODcybC4wMTUuMDA4YzEuMjI1LjcgMS45NzYuMzA0IDIuMjUxLjE1NS4zMzctLjE4MyAxLjIyNi0uNzExIDEuOTAyLjQ0NWwuMDA4LjAxNGMuNjc4IDEuMTczLS4yMjkgMS42ODItLjU1OCAxLjg4NC0uMjY2LjE2My0uOTg0LjYxNS0uOTkxIDIuMDI3di4wMTZjLjAwNyAxLjQxMi43MjUgMS44NjQuOTkxIDIuMDI3LjMyOC4yMDEgMS4yMjkuNzA3LjU2NiAxLjg3bC0uMDA4LjAxNGMtLjY3NyAxLjE3NC0xLjU3MS42NDMtMS45MS40NTktLjI3NS0uMTQ5LTEuMDI2LS41NDUtMi4yNTEuMTU0bC0uMDE1LjAwOWMtMS4yMTkuNzEyLTEuMjUxIDEuNTYtMS4yNTkgMS44NzItLjAxMS4zODYuMDAyIDEuNDI1LTEuMzUzIDEuNDI1cy0xLjM0Mi0xLjAzOS0xLjM1My0xLjQyNWMtLjAwOC0uMzEyLS4wNC0xLjE2LTEuMjU5LTEuODcybC0uMDE1LS4wMDljLTEuMjI1LS42OTktMS45NzYtLjMwMy0yLjI1MS0uMTU0LS4zMzYuMTgzLTEuMjE5LjcwNi0xLjg5NC0uNDMybC0uMDE2LS4wMjdjLS42NzgtMS4xNzQuMjI5LTEuNjgyLjU1OC0xLjg4NC4yNjYtLjE2My45ODQtLjYxNS45OTEtMi4wMjd2LS4wMTZjLS4wMDctMS40MTItLjcyNS0xLjg2NC0uOTkxLTIuMDI3LS4zMjgtLjIwMS0xLjIyOS0uNzA3LS41NjYtMS44N2wuMDA4LS4wMTRjLjY3Ny0xLjE3NCAxLjU3MS0uNjQzIDEuOTEtLjQ1OS4yNzUuMTQ5IDEuMDI2LjU0NSAyLjI1MS0uMTU1bC4wMTUtLjAwOGMxLjIxOS0uNzEyIDEuMjUxLTEuNTYgMS4yNTktMS44NzIuMDEtLjM4NC0uMDAyLTEuNDE3IDEuMzM3LTEuNDI1Ii8+PC9zdmc+)}.ag-charts-icon-step-line-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzE4MUQxRiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNiA0aDV2OGgzVjhoNXYxaC00djRoLTVWNUg3djEwSDJ2LTFoNHoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-text-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00IDRIMTZWN0gxNVY1SDEwLjVWMTVIMTRWMTZINlYxNUg5LjVWNUg1VjdINFY0WiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==)}.ag-charts-icon-trend-line,.ag-charts-icon-trend-line-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNS4zMTQgMTAuOTM4YTIuMjUgMi4yNSAwIDEgMSAuMDEtMWg5LjM1MmEyLjI1IDIuMjUgMCAxIDEgLjAxIDF6bS0yLjE4OS43MjlhMS4yNSAxLjI1IDAgMSAwIDAtMi41IDEuMjUgMS4yNSAwIDAgMCAwIDIuNW0xMy43NSAwYTEuMjUgMS4yNSAwIDEgMCAwLTIuNSAxLjI1IDEuMjUgMCAwIDAgMCAyLjUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-unlock,.ag-charts-icon-unlocked{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTAuNjUxIDMuNWEyLjg5NCAyLjg5NCAwIDAgMC0yLjg5NCAyLjg5NFY5SDE0LjVhMi41IDIuNSAwIDAgMSAyLjUgMi41djNhMi41IDIuNSAwIDAgMS0yLjUgMi41aC04QTIuNSAyLjUgMCAwIDEgNCAxNC41di0zQTIuNSAyLjUgMCAwIDEgNi41IDloLjI1N1Y2LjM5NGEzLjg5NCAzLjg5NCAwIDEgMSA3Ljc4OSAwIC41LjUgMCAwIDEtMSAwQTIuODk0IDIuODk0IDAgMCAwIDEwLjY1IDMuNU02LjUgMTBBMS41IDEuNSAwIDAgMCA1IDExLjV2M0ExLjUgMS41IDAgMCAwIDYuNSAxNmg4YTEuNSAxLjUgMCAwIDAgMS41LTEuNXYtM2ExLjUgMS41IDAgMCAwLTEuNS0xLjV6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-vertical-line,.ag-charts-icon-vertical-line-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTAuNSA3LjgwNmEyLjI1IDIuMjUgMCAwIDEgMCA0LjM4OFYxOS41aC0xdi03LjMwNmEyLjI1IDIuMjUgMCAwIDEgMC00LjM4OFYuNWgxem0tLjUuOTQ0YTEuMjUgMS4yNSAwIDEgMSAwIDIuNSAxLjI1IDEuMjUgMCAwIDEgMC0yLjUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-zoom-in{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTEwIDUuNWEuNS41IDAgMCAxIC41LjV2My41aDMuODc1YS41LjUgMCAwIDEgMCAxSDEwLjV2NC4yNWEuNS41IDAgMSAxLTEgMFYxMC41SDUuNjI1YS41LjUgMCAxIDEgMC0xSDkuNVY2YS41LjUgMCAwIDEgLjUtLjUiLz48L3N2Zz4=)}.ag-charts-icon-zoom-out{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNS41IDEwYS41LjUgMCAwIDEgLjUtLjVoOGEuNS41IDAgMCAxIDAgMUg2YS41LjUgMCAwIDEtLjUtLjUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-high-low-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNyA0aDJ2MTJINFY0aDNNNSA1aDN2MTBINXpNMTEgMTRWNmg1djhoLTVtMS03aDN2NmgtM3oiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-hlc-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJtMTguMTYzIDEuODM3LTUuMzM0IDExLjYyMUw2Ljk1NyA4LjEybC00LjE5OSA5LjYyMi0uOTE2LS40IDQuNzU2LTEwLjlMMTIuNDkgMTEuOCAxNy4yNTQgMS40MnoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjxwYXRoIGZpbGw9IiMwMDAiIGZpbGwtb3BhY2l0eT0iLjQiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTUuODI1IDIuNzA0LjU1IDEzLjc4NWwuOTAyLjQzIDQuNzI0LTkuOTE5IDYuMDM0IDUuMDI5IDMuMjU1LTguMTQtLjkyOC0uMzctMi43NDUgNi44NnptNy44NTIgMTQuNjM2IDUuNzgtMTMuMTM5LS45MTUtLjQwMi01LjIxOSAxMS44Ni02LjAwNS01LjUwNC0zLjI3OCA3LjY0OC45Mi4zOTQgMi43MjItNi4zNTJ6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-chevron-right{--icon: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjAgMjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik03LjQ3IDUuNDdhLjc1Ljc1IDAgMCAxIDEuMDYgMGw0IDRhLjc1Ljc1IDAgMCAxIDAgMS4wNmwtNCA0YS43NS43NSAwIDAgMS0xLjA2LTEuMDZMMTAuOTQgMTAgNy40NyA2LjUzYS43NS43NSAwIDAgMSAwLTEuMDYiIGZpbGw9IiMwMDAiLz48L3N2Zz4=)}.ag-charts-icon-zoom-in-alt{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLXpvb20taW4iPjxjaXJjbGUgY3g9IjExIiBjeT0iMTEiIHI9IjgiLz48bGluZSB4MT0iMjEiIHgyPSIxNi42NSIgeTE9IjIxIiB5Mj0iMTYuNjUiLz48bGluZSB4MT0iMTEiIHgyPSIxMSIgeTE9IjgiIHkyPSIxNCIvPjxsaW5lIHgxPSI4IiB4Mj0iMTQiIHkxPSIxMSIgeTI9IjExIi8+PC9zdmc+)}.ag-charts-icon-zoom-out-alt{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLXpvb20tb3V0Ij48Y2lyY2xlIGN4PSIxMSIgY3k9IjExIiByPSI4Ii8+PGxpbmUgeDE9IjIxIiB4Mj0iMTYuNjUiIHkxPSIyMSIgeTI9IjE2LjY1Ii8+PGxpbmUgeDE9IjgiIHgyPSIxNCIgeTE9IjExIiB5Mj0iMTEiLz48L3N2Zz4=)}.ag-charts-input{--input-layer-active: 1;--input-layer-focus: 2;--input-padding: calc(var(--ag-charts-spacing) * 2);--input-padding-large: calc(var(--ag-charts-spacing) * 2.5);color:var(--ag-charts-input-text-color);font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size-large);transition-duration:.25s;transition-property:none;transition-timing-function:ease-out}.ag-charts-input:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:var(--input-layer-focus)}.ag-charts-button{background:var(--ag-charts-button-background-color);border:var(--ag-charts-button-border);border-radius:var(--ag-charts-button-border-radius);color:var(--ag-charts-button-text-color);cursor:pointer;padding:var(--input-padding);transition-property:background,border-color}.ag-charts-button:hover{background:var(--ag-charts-focus-color)}.ag-charts-button:has(.ag-charts-icon){padding:2px}.ag-charts-checkbox{--checkbox-transition-duration: .1s;appearance:none;background:var(--ag-charts-checkbox-background-color);border-radius:calc(var(--ag-charts-border-radius) * 9);cursor:pointer;height:18px;margin:0;transition-duration:var(--checkbox-transition-duration);transition-property:margin;width:29px}.ag-charts-checkbox:before{display:block;background:var(--ag-charts-input-background-color);border-radius:calc(var(--ag-charts-border-radius) * 7);content:" ";height:14px;margin:2px;transition-duration:var(--checkbox-transition-duration);transition-property:margin;transition-timing-function:var(--ag-charts-input-transition-easing);width:14px}.ag-charts-checkbox:checked{background:var(--ag-charts-checkbox-checked-background-color)}.ag-charts-checkbox:checked:before{margin-left:13px}.ag-charts-select{background:var(--ag-charts-input-background-color);border:var(--ag-charts-input-border);border-radius:var(--ag-charts-input-border-radius);padding:3px 2px 4px;font-size:inherit}.ag-charts-textarea{--textarea-line-height: 1.38;background:var(--ag-charts-input-background-color);border:var(--ag-charts-input-border);border-radius:var(--ag-charts-input-border-radius);line-height:var(--textarea-line-height);font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size-large);padding:var(--input-padding-large) var(--input-padding)}.ag-charts-textarea::placeholder{color:var(--ag-charts-input-placeholder-text-color)}.ag-charts-proxy-container{pointer-events:none;position:absolute}.ag-charts-proxy-legend-toolbar{pointer-events:auto}.ag-charts-proxy-legend-toolbar>div[role=listitem]{pointer-events:none}.ag-charts-proxy-elem{-webkit-appearance:none;appearance:none;background:none;border:none;color:#0000;overflow:hidden;pointer-events:auto;position:absolute}.ag-charts-proxy-elem::-moz-range-thumb,.ag-charts-proxy-elem::-moz-range-track{opacity:0}.ag-charts-proxy-elem::-webkit-slider-runnable-track,.ag-charts-proxy-elem::-webkit-slider-thumb{opacity:0}.ag-charts-proxy-elem:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow)}.ag-charts-focus-indicator{position:absolute;display:block;pointer-events:none;user-select:none;-webkit-user-select:none;width:100%;height:100%}.ag-charts-focus-indicator>div{position:absolute;outline:solid 1px var(--ag-charts-chrome-background-color);box-shadow:var(--ag-charts-focus-shadow)}.ag-charts-focus-indicator>svg{width:100%;height:100%;fill:none;overflow:visible}.ag-charts-focus-svg-outer-path{stroke:var(--ag-charts-chrome-background-color);stroke-width:4px}.ag-charts-focus-svg-inner-path{stroke:var(--ag-charts-accent-color);stroke-width:2px}.ag-charts-overlay{color:#181d1f;pointer-events:none}.ag-charts-overlay.ag-charts-dark-overlay{color:#fff}.ag-charts-overlay--loading{color:#8c8c8c}.ag-charts-overlay__loading-background{background:#fff;pointer-events:none}.ag-charts-overlay.ag-charts-dark-overlay .ag-charts-overlay__loading-background{background:#192232}.ag-charts-tooltip{--tooltip-arrow-size: 8px;--tooltip-row-spacing: 8px;--tooltip-column-spacing: 16px;position:fixed;inset:unset;margin:0;padding:0;overflow:visible;top:var(--top, 0px);left:var(--left, 0px);width:max-content;max-width:100%;font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size);font-weight:var(--ag-charts-chrome-font-weight);color:var(--ag-charts-tooltip-text-color);background:var(--ag-charts-tooltip-background-color);border:var(--ag-charts-tooltip-border);border-radius:var(--ag-charts-tooltip-border-radius);box-shadow:var(--ag-charts-popup-shadow)}.ag-charts-tooltip--compact .ag-charts-tooltip-content{--tooltip-row-spacing: 2px;--tooltip-column-spacing: 8px;padding:3px 6px}.ag-charts-tooltip--arrow-top:before,.ag-charts-tooltip--arrow-right:before,.ag-charts-tooltip--arrow-bottom:before,.ag-charts-tooltip--arrow-left:before{content:"";position:absolute;display:block;width:var(--tooltip-arrow-size);height:var(--tooltip-arrow-size);border:inherit;border-bottom-color:transparent;border-right-color:transparent;background:inherit;clip-path:polygon(0 0,100% 0,100% 1px,1px 100%,0 100%)}.ag-charts-tooltip--arrow-top:before{bottom:100%;left:50%;transform:translate(-50%) translateY(calc(var(--tooltip-arrow-size) * .5)) rotate(45deg)}.ag-charts-tooltip--arrow-bottom:before{top:100%;left:50%;transform:translate(-50%) translateY(calc(var(--tooltip-arrow-size) * -.5)) rotate(225deg)}.ag-charts-tooltip--arrow-left:before{right:100%;top:50%;transform:translateY(-50%) translate(calc(var(--tooltip-arrow-size) * .5)) rotate(315deg)}.ag-charts-tooltip--arrow-right:before{left:100%;top:50%;transform:translateY(-50%) translate(calc(var(--tooltip-arrow-size) * -.5)) rotate(135deg)}.ag-charts-tooltip--no-interaction{pointer-events:none;user-select:none;-webkit-user-select:none}.ag-charts-tooltip--wrap-always{overflow-wrap:break-word;word-break:break-word;hyphens:none}.ag-charts-tooltip--wrap-hyphenate{overflow-wrap:break-word;word-break:break-word;hyphens:auto}.ag-charts-tooltip--wrap-on-space{overflow-wrap:normal;word-break:normal}.ag-charts-tooltip--wrap-never{white-space:nowrap}.ag-charts-tooltip-heading,.ag-charts-tooltip-title,.ag-charts-tooltip-label,.ag-charts-tooltip-value{overflow:hidden;text-overflow:ellipsis}.ag-charts-tooltip-content{display:grid;grid:auto-flow minmax(1em,auto) / 1fr;padding:8px 12px;gap:var(--tooltip-row-spacing)}.ag-charts-tooltip-content:has(.ag-charts-tooltip-symbol){grid:auto-flow minmax(1em,auto) / auto 1fr}.ag-charts-tooltip-heading{grid-column:1 / -1}.ag-charts-tooltip-symbol{grid-column:1 / 2;place-self:center}.ag-charts-tooltip-symbol svg{display:block}.ag-charts-tooltip-title{grid-column:-2 / -1}.ag-charts-tooltip-row{grid-column:1 / -1;display:flex;gap:var(--tooltip-column-spacing);align-items:baseline;justify-content:space-between;overflow:hidden}.ag-charts-tooltip-row--inline{grid-column:-2 / -1}.ag-charts-tooltip-label{flex:1;min-width:0}.ag-charts-tooltip-value{min-width:0}.ag-charts-tooltip-footer{grid-column:1 / -1;color:var(--ag-charts-tooltip-subtle-text-color);text-align:center}.ag-charts-popover{position:absolute;border:var(--ag-charts-border);border-radius:var(--ag-charts-border-radius);background:var(--ag-charts-panel-background-color);color:var(--ag-charts-chrome-text-color);font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size);font-weight:var(--ag-charts-chrome-font-weight);box-shadow:var(--ag-charts-popup-shadow);z-index:var(--ag-charts-layer-ui-overlay)}.ag-charts-menu{--item-padding: 6px 12px;--icon-color: var(--ag-charts-menu-text-color);display:grid;grid:auto-flow auto / 1fr;column-gap:12px;font-size:var(--ag-charts-chrome-font-size)}.ag-charts-menu:has(.ag-charts-menu__icon,.ag-charts-menu__row--stroke-width-visible){grid:auto-flow auto / auto 1fr}.ag-charts-menu__row--stroke-width-visible:before{content:"";height:var(--strokeWidth);width:12px;background:var(--icon-color)}.ag-charts-menu__row--stroke-width-visible[aria-disabled=true]:before{filter:grayscale(1);opacity:.5}.ag-charts-menu__row{display:grid;grid-column:1 / -1;grid-template-columns:subgrid;align-items:center;padding:var(--item-padding)}.ag-charts-menu__row:not(.ag-charts-menu__row--active){cursor:pointer}.ag-charts-menu__row:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.ag-charts-menu__row:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.ag-charts-menu__row:focus{background:var(--ag-charts-focus-color)}.ag-charts-menu__row:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:var(--ag-charts-layer-menu)}.ag-charts-menu__row--active{--icon-color: var(--ag-charts-accent-color);background:var(--ag-charts-focus-color);color:var(--ag-charts-accent-color)}.ag-charts-menu__label{grid-column:-1 / span 1}.ag-charts-toolbar{--toolbar-gap: calc(var(--ag-charts-spacing) * 2);--toolbar-size: 34px;--toolbar-button-padding: 6px;align-items:center;display:flex;flex-wrap:nowrap;position:absolute}.ag-charts-toolbar__button{align-items:center;background:var(--ag-charts-chrome-background-color);border:var(--ag-charts-button-border);color:var(--ag-charts-button-text-color);cursor:pointer;display:flex;font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size-medium);font-weight:var(--ag-charts-chrome-font-weight);justify-content:center;min-height:var(--toolbar-size);min-width:var(--toolbar-size);padding:var(--toolbar-button-padding);position:relative;transition:background-color .25s ease-in-out,border-color .25s ease-in-out,color .25s ease-in-out;white-space:nowrap}.ag-charts-toolbar__button:hover{background:var(--ag-charts-focus-color);z-index:1}.ag-charts-toolbar__button:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:calc(var(--ag-charts-layer-ui-overlay) + 1)}.ag-charts-toolbar__button--active{background:var(--ag-charts-focus-color);border-color:var(--ag-charts-accent-color);color:var(--ag-charts-accent-color);z-index:2;+.ag-charts-toolbar__button{border-left-color:var(--ag-charts-accent-color)}}.ag-charts-toolbar__button[aria-disabled=true]{background:var(--ag-charts-button-disabled-background-color);color:var(--ag-charts-button-disabled-text-color);cursor:default}.ag-charts-toolbar--horizontal{flex-direction:row;.ag-charts-toolbar__button{border-right-width:0}.ag-charts-toolbar__button--first{border-bottom-left-radius:var(--ag-charts-border-radius);border-top-left-radius:var(--ag-charts-border-radius);margin:0}.ag-charts-toolbar__button--last{border-bottom-right-radius:var(--ag-charts-border-radius);border-top-right-radius:var(--ag-charts-border-radius);border-right-width:1px}}.ag-charts-toolbar--vertical{flex-direction:column;.ag-charts-toolbar__button{margin:-1px 0 0;max-width:100%}.ag-charts-toolbar__button--first{border-top-left-radius:var(--ag-charts-border-radius);border-top-right-radius:var(--ag-charts-border-radius);margin:0}.ag-charts-toolbar__button--last{border-bottom-left-radius:var(--ag-charts-border-radius);border-bottom-right-radius:var(--ag-charts-border-radius)}}.ag-charts-toolbar__icon+.ag-charts-toolbar__label{margin-left:var(--toolbar-gap)}.ag-charts-toolbar__icon,.ag-charts-toolbar__label{pointer-events:none}.ag-charts-floating-toolbar{border:none;display:flex;.ag-charts-toolbar{align-items:unset;position:unset}}.ag-charts-floating-toolbar__drag-handle{align-items:center;background:var(--ag-charts-chrome-background-color);border:var(--ag-charts-border);border-bottom-left-radius:var(--ag-charts-border-radius);border-top-left-radius:var(--ag-charts-border-radius);border-right-width:0;cursor:grab;display:flex;justify-content:center;min-width:24px;padding-left:0;padding-right:0}.ag-charts-floating-toolbar__drag-handle--dragging{cursor:grabbing}
`,AM=class{constructor(){this.cleanup=new pt,this.destroyed=!1}destroy(){this.cleanup.flush(),this.destroyed=!0}},fH=class qv{constructor(t,i,s){this.element=t,this.topTabGuard=i,this.bottomTabGuard=s,this.cleanup=new pt,this.guardTabIndex=0,this.hasFocus=!1,this.initTabGuard(this.topTabGuard,!1),this.initTabGuard(this.bottomTabGuard,!0),this.element.addEventListener("focus",()=>this.onFocus(),{capture:!0}),this.element.addEventListener("blur",n=>this.onBlur(n),{capture:!0})}set tabIndex(t){this.guardTabIndex=t,this.guardTabIndex===0?this.setGuardIndices(void 0):this.hasFocus||this.setGuardIndices(this.guardTabIndex)}destroy(){this.cleanup.flush()}initTabGuard(t,i){this.cleanup.register(ot(t,"focus",()=>this.onTab(t,i)))}setGuardIndices(t){const i=t;Fe(this.topTabGuard,"tabindex",i),Fe(this.bottomTabGuard,"tabindex",i)}onFocus(){this.hasFocus=!0,this.guardTabIndex!==0&&this.setGuardIndices(0)}onBlur({relatedTarget:t}){const{topTabGuard:i,bottomTabGuard:s}=this;this.hasFocus=!1,this.guardTabIndex!==0&&t!==i&&t!==s&&this.setGuardIndices(this.guardTabIndex)}onTab(t,i){if(this.guardTabIndex!==0){let s;t.tabIndex===0?(s=this.findExitTarget(!i),this.setGuardIndices(this.guardTabIndex)):s=this.findEnterTarget(i),s?.focus()}}static queryFocusable(t,i){const s=Ve();return Array.from(t.querySelectorAll(i)).filter(n=>{if(n instanceof HTMLElement){const o=s.getComputedStyle(n);return o.display!=="none"&&o.visibility!=="none"}return!1})}findEnterTarget(t){const i=qv.queryFocusable(this.element,'[tabindex="0"]'),s=t?i.length-1:0;return i[s]}findExitTarget(t){const i=qv.queryFocusable(Qn(),"[tabindex]").filter(o=>o.tabIndex>0).sort((o,a)=>o.tabIndex-a.tabIndex),{before:s,after:n}=qv.findBeforeAndAfter(i,this.guardTabIndex);return t?s:n}static findBeforeAndAfter(t,i){let s=0,n=t.length-1,o,a;for(;s<=n;){const r=Math.floor((s+n)/2),l=t[r].tabIndex;if(l===i){o=t[r-1]||void 0,a=t[r+1]||void 0;break}else l<i?(o=t[r],s=r+1):(a=t[r],n=r-1)}return{before:o,after:a}}},mH=class{constructor(e){this.callback=e,this.devicePixelRatio=Ve("devicePixelRatio")??1,this.devicePixelRatioMediaQuery=void 0,this.devicePixelRatioListener=t=>{t.matches||(this.devicePixelRatio=Ve("devicePixelRatio")??1,this.unregisterDevicePixelRatioListener(),this.registerDevicePixelRatioListener(),this.callback(this.pixelRatio))}}get pixelRatio(){return this.devicePixelRatio}observe(){this.registerDevicePixelRatioListener()}disconnect(){this.unregisterDevicePixelRatioListener()}unregisterDevicePixelRatioListener(){this.devicePixelRatioMediaQuery?.removeEventListener("change",this.devicePixelRatioListener),this.devicePixelRatioMediaQuery=void 0}registerDevicePixelRatioListener(){const e=Ve("matchMedia")?.(`(resolution: ${this.pixelRatio}dppx)`);e?.addEventListener("change",this.devicePixelRatioListener),this.devicePixelRatioMediaQuery=e}},pT=class{constructor(){this.elements=new Map,this.documentReady=!1,this.queuedObserveRequests=[],this.onLoad=()=>{this.documentReady=!0;for(const[t,i]of this.queuedObserveRequests)this.observe(t,i);this.queuedObserveRequests=[],this.observeWindow()},typeof ResizeObserver<"u"&&(this.resizeObserver=new ResizeObserver(t=>{for(const{target:i,contentRect:{width:s,height:n}}of t){const o=this.elements.get(i);this.checkSize(o,i,s,n)}}));let e;this.pixelRatioObserver=new mH(()=>{clearTimeout(e),e=setTimeout(()=>this.checkPixelRatio(),0)}),this.documentReady=Qn("readyState")==="complete",this.documentReady?this.observeWindow():Ve()?.addEventListener("load",this.onLoad)}destroy(){Ve()?.removeEventListener("load",this.onLoad),this.resizeObserver?.disconnect(),this.resizeObserver=void 0,this.pixelRatioObserver?.disconnect(),this.pixelRatioObserver=void 0}observeWindow(){this.pixelRatioObserver?.observe()}checkPixelRatio(){const e=this.pixelRatioObserver?.pixelRatio??1;for(const[t,i]of this.elements)if(i.size!=null&&i.size.pixelRatio!==e){const{width:s,height:n}=i.size;i.size={width:s,height:n,pixelRatio:e},i.cb(i.size,t)}}checkSize(e,t,i,s){if(e&&(i!==e.size?.width||s!==e.size?.height)){const n=this.pixelRatioObserver?.pixelRatio??1;e.size={width:i,height:s,pixelRatio:n},e.cb(e.size,t)}}observe(e,t){if(!this.documentReady){this.queuedObserveRequests.push([e,t]);return}this.elements.has(e)?this.removeFromQueue(e):this.resizeObserver?.observe(e);const i={cb:t};this.elements.set(e,i)}unobserve(e){this.resizeObserver?.unobserve(e),this.elements.delete(e),this.removeFromQueue(e),this.elements.size||this.destroy()}removeFromQueue(e){this.queuedObserveRequests=this.queuedObserveRequests.filter(([t])=>t!==e)}},Zy=class extends Map{constructor(e,t){super(),this.defaultValue=e,this.defaultState=t}set(e,t){return this.delete(e),t!==void 0&&super.set(e,t),delete this.cachedState,delete this.cachedValue,this}delete(e){return delete this.cachedState,delete this.cachedValue,super.delete(e)}stateId(){return this.cachedState??(this.cachedState=Array.from(this.keys()).pop()??this.defaultState),this.cachedState}stateValue(){return this.cachedValue??(this.cachedValue=Array.from(this.values()).pop()??this.defaultValue),this.cachedValue}},yH='<div role="presentation" class="ag-charts-wrapper ag-charts-styles" data-ag-charts><div role="presentation" class="ag-charts-canvas-center"><div role="presentation" class="ag-charts-canvas-container"><div role="presentation" class="ag-charts-canvas-background" aria-hidden="true"></div><div role="presentation" class="ag-charts-canvas" aria-hidden="true"></div><div role="figure" class="ag-charts-canvas-proxy"><div role="presentation" class="ag-charts-series-area"></div></div><div role="presentation" class="ag-charts-canvas-overlay ag-charts-tooltip-container"></div></div></div></div>',xH=["styles","canvas","canvas-background","canvas-center","canvas-container","canvas-overlay","canvas-proxy","series-area","tooltip-container"],bH=new Set(["styles","canvas-container","canvas","tooltip-container"]),gT={safeHorizontal:"ag-charts-wrapper--safe-horizontal",safeVertical:"ag-charts-wrapper--safe-vertical"},vH=new Map([["styles",{childElementType:"style"}],["canvas",{childElementType:"canvas"}],["canvas-proxy",{childElementType:"div"}],["canvas-overlay",{childElementType:"div"}],["canvas-center",{childElementType:"div"}],["series-area",{childElementType:"div"}],["tooltip-container",{childElementType:"div"}]]);function SH(e,t){if(typeof IntersectionObserver>"u")return;const i=new IntersectionObserver(s=>{for(const n of s)n.target===e&&t(n.intersectionRatio)},{root:e});return i.observe(e),i}var fT={x:0,y:0,width:0,height:0,top:0,bottom:0,left:0,right:0,toJSON(){return fT}};function mT(e,t){const i=xe("div");return i.className="ag-charts-tab-guard",e.insertAdjacentElement(t,i),i}var Xy=class Uh extends AM{constructor(t,i,s,n,o="normal"){super(),this.eventsHub=t,this.chart=i,this.styleContainer=n,this.mode=o,this.anchorName=`--${Mi(this)}`,this.styles=new Map,this.pendingContainer=void 0,this.container=void 0,this.documentRoot=void 0,this.initiallyConnected=void 0,this.containerSize=void 0,this.sizeMonitor=new pT,this.cursorState=new Zy("default"),this.minWidth=0,this.minHeight=0,this.element=this.initDOM(),this.rootElements=this.initRootElements(),this.rootElements.canvas.element.style.setProperty("anchor-name",this.anchorName);let a=!1;if(this.observer=SH(this.element,r=>{r===0&&!a&&this.eventsHub.emit("dom:hidden",null),a=r===0}),this.setSizeOptions(),this.updateContainerSize(),this.addStyles("ag-charts-community",gH),this.setContainer(s),this.cleanup.register(L0(this.element)),this.mode==="normal"){const r=this.rootElements["canvas-center"].element;if(r==null)throw new Error("Error initializing tab guards");const l=mT(r,"beforebegin"),c=mT(r,"afterend");this.tabGuards=new fH(r,l,c)}}initDOM(){if(this.mode==="normal"){const s=xe("div");return s.innerHTML=yH,s.firstChild}const t=xe("div");t.role="presentation",t.dataset.agCharts="",t.classList.add("ag-charts-wrapper");const i=xe("div");return t.appendChild(i),i.role="presentation",i.classList.add("ag-charts-series-area"),t}initRootElements(){const{mode:t,element:i}=this,s={};for(const n of xH){const o=`ag-charts-${n}`;let a;if(t==="normal"?a=i.classList.contains(o)?i:i.getElementsByClassName(o)[0]:bH.has(n)?a=i:a=i.getElementsByClassName(o)[0]??xe("div"),a==null)throw new Error(`AG Charts - unable to find DOM element ${o}`);s[n]={element:a,children:new Map,listeners:[]}}return s}destroy(){super.destroy(),this.observer?.unobserve(this.element),this.container&&this.sizeMonitor.unobserve(this.container),this.pendingContainer=void 0;for(const t of Object.values(this.rootElements)){for(const i of t.children.values())i.remove();t.element.remove()}this.element.remove()}postRenderUpdate(){this.updateStylesLocation(),this.mode!=="minimal"&&(this.pendingContainer==null||this.pendingContainer===this.container||(Uh.batchedUpdateContainer.length===0&&Ve().setTimeout(this.applyBatchedUpdateContainer.bind(this),0),Uh.batchedUpdateContainer.push(this)))}applyBatchedUpdateContainer(){for(const t of Uh.batchedUpdateContainer)t.destroyed||t.updateContainer();Uh.batchedUpdateContainer.splice(0)}updateStylesLocation(){if(!(this.initiallyConnected===!0||this.container?.isConnected===!1)){this.documentRoot=this.getShadowDocumentRoot(this.container),this.initiallyConnected=!0;for(const t of this.rootElements.styles.children.keys())this.removeChild("styles",t);for(const[t,i]of this.styles)this.addStyles(t,i)}}setSizeOptions(t=300,i=300,s,n){const{style:o}=this.element;o.width=`${s??t}px`,o.height=`${n??i}px`,this.minWidth=s??t,this.minHeight=n??i,this.updateContainerClassName()}updateContainerSize(){const{style:t}=this.rootElements["canvas-center"].element;t.visibility=this.containerSize==null?"hidden":"",this.containerSize?(t.width=`${this.containerSize.width??0}px`,t.height=`${this.containerSize.height??0}px`):(t.width="",t.height=""),this.updateContainerClassName()}setTabGuardIndex(t){this.tabGuards&&(this.tabGuards.tabIndex=t)}setContainer(t){t!==this.container&&(this.pendingContainer=t,(this.mode==="minimal"||this.container==null)&&this.updateContainer())}updateContainer(){const{pendingContainer:t}=this;if(!(t==null||t===this.container)){if(this.container&&(this.element.remove(),this.sizeMonitor.unobserve(this.container)),this.documentRoot!=null)for(const i of this.rootElements.styles.children.keys())this.removeChild("styles",i);this.container=t,this.pendingContainer=void 0,this.documentRoot=this.getShadowDocumentRoot(t),this.initiallyConnected=t.isConnected;for(const[i,s]of this.styles)this.addStyles(i,s);t.appendChild(this.element),this.sizeMonitor.observe(t,i=>{this.containerSize=i,this.updateContainerSize(),this.eventsHub.emit("dom:resize",null)}),this.eventsHub.emit("dom:container-change",null)}}setThemeClass(t){const i="ag-charts-theme-";for(const s of Array.from(this.element.classList))s.startsWith(i)&&s!==t&&this.element.classList.remove(s);this.element.classList.add(t)}setThemeParameters(t){for(const[i,s]of ht(t)){let n=`${s}`;i.endsWith("Size")||i.endsWith("Radius")?n=`${s}px`:i.endsWith("Border")&&typeof s=="boolean"&&(n=s?"var(--ag-charts-border)":"none"),this.element.style.setProperty(`--ag-charts-${wS(i)}`,n)}}updateCanvasLabel(t){Fe(this.rootElements["canvas-proxy"].element,"aria-label",t)}getEventElement(t,i){return["focus","blur","keydown","keyup"].includes(i)?this.rootElements["series-area"].element:t}addEventListener(t,i,s){const n=this.getEventElement(this.element,t);return ot(n,t,i,s)}removeEventListener(t,i,s){this.getEventElement(this.element,t).removeEventListener(t,i,s)}getBoundingClientRect(){return this.rootElements.canvas.element.getBoundingClientRect()}getOverlayClientRect(){const t=Ve(),i=new re(0,0,t.innerWidth,t.innerHeight),s=this.getRawOverlayClientRect();return i.intersection(s)?.toDOMRect()??fT}getRawOverlayClientRect(){let t=this.element;const i=this.element.getRootNode()?.fullscreenElement;for(;t!=null;){let o;if(i!=null&&t===i)o=!0;else{const r=t.computedStyleMap?.()?.get("overflow-y")?.toString();o=r==="auto"||r==="scroll"}if(o)return re.fromObject(t.getBoundingClientRect());t=t.parentElement}if(this.documentRoot!=null)return re.fromObject(this.documentRoot.getBoundingClientRect());const{innerWidth:s,innerHeight:n}=Ve();return new re(0,0,s,n)}getShadowDocumentRoot(t=this.container){const i=t?.ownerDocument?.body??Qn("body");for(;t!=null;){if(t===i)return;if(t.parentNode instanceof DocumentFragment)return t;t=t.parentNode}}getParent(t){return this.rootElements[t].element}getChildBoundingClientRect(t){const{children:i}=this.rootElements[t],s=[];for(const n of i.values())s.push(re.fromObject(n.getBoundingClientRect()));return re.merge(s)}isManagedChildDOMElement(t,i,s){const{children:n}=this.rootElements[i],o=n?.get(s);return o!=null&&t.contains(o)}contains(t,i){return i==null?this.element.contains(t):this.rootElements[i].element.contains(t)}addStyles(t,i){const s="data-ag-charts";if(this.styles.set(t,i),this.container==null)return;const n=r=>r.getAttribute(s)===t,o=r=>{const l=new Set(["TITLE","META"]);let c=!0,h;for(const u of r.children){if(c&&l.has(u.tagName)){h=u;continue}if(c=!1,n(u))return;u.hasAttribute(s)&&(h=u)}const d=xe("style");return this.chart.styleNonce!=null&&(d.nonce=this.chart.styleNonce),h==null?r.prepend(d):r.insertBefore(d,h.nextSibling),d};let a;this.styleContainer?a=o(this.styleContainer):this.initiallyConnected===!1?a=this.addChild("styles",t):this.documentRoot==null&&!Uh.headStyles.has(t)?(a=o(Qn("head")),Uh.headStyles.add(t)):this.documentRoot!=null&&(a=this.addChild("styles",t)),!(a==null||n(a))&&(a.setAttribute(s,t),a.innerHTML=i)}removeStyles(t){this.removeChild("styles",t)}updateCursor(t,i){this.cursorState.set(t,i),this.element.style.cursor=this.cursorState.stateValue()}getCursor(){return this.element.style.cursor}addChild(t,i,s,n){const{element:o,children:a,listeners:r}=this.rootElements[t];if(!a)throw new Error("AG Charts - unable to create DOM elements after destroy()");if(a.has(i))return a.get(i);const{childElementType:l="div"}=vH.get(t)??{};if(s&&s.tagName.toLowerCase()!==l.toLowerCase())throw new Error("AG Charts - mismatching DOM element type");const c=s??xe(l);for(const[h,d,u]of r)c.addEventListener(h,d,u);if(a.set(i,c),l==="style"&&this.chart.styleNonce!=null&&(c.nonce=this.chart.styleNonce),n){const h=o.querySelector(n.query);if(h==null)throw new Error(`AG Charts - addChild query failed ${n.query}`);h.insertAdjacentElement(n.where,c)}else o?.appendChild(c);return c}removeChild(t,i){const{children:s}=this.rootElements[t];s&&(s.get(i)?.remove(),s.delete(i))}incrementDataCounter(t){const{dataset:i}=this.element;i[t]??(i[t]="0"),i[t]=String(Number(i[t])+1)}setDataBoolean(t,i){this.element.dataset[t]=String(i)}setDataNumber(t,i){this.element.dataset[t]=String(i)}updateContainerClassName(){const{element:t,containerSize:i,minWidth:s,minHeight:n}=this;t.classList.toggle(gT.safeHorizontal,s>=(i?.width??1/0)),t.classList.toggle(gT.safeVertical,n>=(i?.height??1/0))}};Xy.className="DOMManager",Xy.batchedUpdateContainer=[],Xy.headStyles=new Set;var yT=Xy,MH=class extends Sr{constructor(){super(xe("div")),this.textElement=Pt("text"),this.textElement.role="presentation",this.svgElement=Pt("svg"),this.svgElement.appendChild(this.textElement),this.svgElement.style.width="100%",this.svgElement.style.opacity="0",this.svgElement.role="presentation",this.elem.appendChild(this.svgElement),this.elem.role="presentation"}set textContent(e){this.textElement.textContent=e;const i=this.textElement.getBBox?.();i&&this.svgElement.setAttribute("viewBox",`${i.x} ${i.y} ${i.width} ${i.height}`)}get textContent(){return this.textElement.textContent}destructor(){}},DH=class{constructor(e,t){this.getDispatcher=t,this.onExpanded=()=>{this.controller.setAriaExpanded(!0);const i=this.getDispatcher();if(i&&this.controls){const s={type:"expand-controlled-widget",controlled:this.controls};i.dispatch("expand-controlled-widget",this.controller,s)}},this.onCollapsed=i=>{this.controller.setAriaExpanded(!1),i.mode==="0"&&this.controller.focus()},e.setAriaExpanded(!1),this.controller=e}destroy(){this.controls?.collapse({mode:"2"}),this.setControlled(void 0)}setControlled(e){this.controls&&(this.controls.removeListener("expand-widget",this.onExpanded),this.controls.removeListener("collapse-widget",this.onCollapsed)),this.controls=e,this.controls&&(this.controller.setAriaControls(this.controls.id),this.controls.addListener("expand-widget",this.onExpanded),this.controls.addListener("collapse-widget",this.onCollapsed))}getControlled(){return this.controls}expandControlled(e){this.controller.isDisabled()||this.controls?.expand({controller:this.controller,sourceEvent:void 0,overrideFocusVisible:e?.overrideFocusVisible})}},CM=class extends Sr{constructor(e,t){super(e),Fe(this.elem,"role",t),this.setEnabled(!0),this.addListener("keydown",({sourceEvent:i})=>{py(i)&&(i.preventDefault(),this.htmlListener?.dispatch("click",this,{type:"click",device:"keyboard",sourceEvent:i}))})}lazyControllerImpl(){return this.controllerImpl??(this.controllerImpl=new DH(this,()=>this.internalListener)),this.controllerImpl}destructor(){this.controllerImpl?.destroy()}setEnabled(e){Fe(this.elem,"aria-disabled",!e)}setControlled(e){return this.lazyControllerImpl().setControlled(e)}getControlled(){return this.lazyControllerImpl().getControlled()}expandControlled(e){return this.lazyControllerImpl().expandControlled(e)}addListener(e,t){return super.addListener(e,(i,s)=>{(e==="click"||e==="dblclick")&&this.isDisabled()||t(i,s)})}},qy=class extends CM{constructor(){super(xe("button"))}},IH=class extends Sr{constructor(){super(xe("div")),Fe(this.elem,"role","group")}destructor(){}},LM=class extends Sr{constructor(e,t){super(xe("div")),this.focusedChildIndex=0,this.onChildFocus=(i,s)=>{const n=this.children[this.focusedChildIndex];this.focusedChildIndex=s.index,n?.setTabIndex(-1),s.setTabIndex(0)},this.onChildKeyDown=(i,s)=>{const n=this.orientation,[o,a]=n==="both"?[Nd.horizontal,Nd.vertical]:[Nd[n],void 0];let r=-1;if(Td(i.sourceEvent)){const l=i.sourceEvent.key;l===o.nextKey||l===a?.nextKey?r=s.index+1:(l===o.prevKey||l===a?.prevKey)&&(r=s.index-1)}this.children[r]?.focus()},Fe(this.elem,"role",t),this.orientation=e}get orientation(){return fl(this.elem,"aria-orientation")??"both"}set orientation(e){Fe(this.elem,"aria-orientation",e==="both"?void 0:e)}focus(){this.children[this.focusedChildIndex]?.focus()}clear(){this.focusedChildIndex=0;for(const e of this.children)this.removeChildListeners(e),e.parent=void 0;this.elem.textContent="",this.children.length=0}addChildListeners(e){e.addListener("focus",this.onChildFocus),e.addListener("keydown",this.onChildKeyDown)}removeChildListeners(e){e.removeListener("focus",this.onChildFocus),e.removeListener("keydown",this.onChildKeyDown)}onChildAdded(e){this.addChildListeners(e),e.setTabIndex(this.children.length===1?0:-1)}onChildRemoved(e){this.removeChildListeners(e);const{focusedChildIndex:t,children:i}=this,s=t===e.index;for(let n=0;n<i.length;n++){const o=i[n];o.index===t&&(this.focusedChildIndex=n),o.index=n}if(s){const n=i[t]??i[t-1];n?(this.focusedChildIndex=n.index,n.setTabIndex(0)):this.focusedChildIndex=0}}},kH=class extends LM{constructor(){super("both","list"),this.setHidden(!0)}destructor(){for(const e of this.children)e.getElement().parentElement.remove()}addChildToDOM(e,t){const i=xe("div");Fe(i,"role","listitem"),Cn(i,"position","absolute"),Sr.setElementContainer(e,i),this.appendOrInsert(i,t),this.setHidden(!1)}removeChildFromDOM(e){e.getElement().parentElement.remove(),this.setHidden(this.children.length===0)}setHidden(e){this.children.length===0&&(e=!0),super.setHidden(e)}},ou=class extends Sr{constructor(e){super(e)}destructor(){}},wM=class tm extends Sr{constructor(){super(xe("input")),this._step=tm.STEP_ONE,this.orientation="both"}get step(){return this._step}set step(t){this._step=t,this.getElement().step=t.attributeValue}get keyboardStep(){return this._keyboardStep?.step??this._step}set keyboardStep(t){if(t!==this._keyboardStep?.step&&(this._keyboardStep!==void 0&&(this.removeListener("keydown",this._keyboardStep.onKeyDown),this.removeListener("keyup",this._keyboardStep.onKeyUp),this.removeListener("blur",this._keyboardStep.onBlur),this._keyboardStep=void 0),t!==void 0)){const i=()=>this.getElement().step=t.attributeValue,s=()=>this.getElement().step=this._step.attributeValue;this._keyboardStep={step:t,onKeyDown:i,onKeyUp:s,onBlur:s},this.addListener("keydown",this._keyboardStep.onKeyDown),this.addListener("keyup",this._keyboardStep.onKeyUp),this.addListener("blur",this._keyboardStep.onBlur)}}get orientation(){return fl(this.elem,"aria-orientation")??"both"}set orientation(t){Fe(this.elem,"aria-orientation",t==="both"?void 0:t),tm.registerDefaultPreventers(this,t)}destructor(){}clampValueRatio(t,i){const s=this.getValueRatio(),n=ge(t,s,i);return n!==s&&this.setValueRatio(n),n}setValueRatio(t,i){const{divider:s}=this.step,n=Math.round(t*1e4)/s,{ariaValueText:o=x0(n/s)}=i??{},a=this.getElement();a.value=`${n}`,a.ariaValueText=o}getValueRatio(){return this.getElement().valueAsNumber/this.step.divider}static registerDefaultPreventers(t,i){i==="both"?t.removeListener("keydown",tm.onKeyDown):t.addListener("keydown",tm.onKeyDown)}static onKeyDown(t,i){let s=[];const{orientation:n}=i;n==="horizontal"?s=["ArrowUp","ArrowDown"]:n==="vertical"&&(s=["ArrowLeft","ArrowRight"]),s.includes(t.sourceEvent.code)&&t.sourceEvent.preventDefault()}};wM.STEP_ONE={attributeValue:"1",divider:1},wM.STEP_HUNDRETH={attributeValue:"0.01",divider:100};var TM=wM,AH=class extends qy{constructor(){super(),Fe(this.elem,"role","switch"),this.setChecked(!1)}setChecked(e){Fe(this.elem,"aria-checked",e)}},Qy=class extends LM{constructor(e="horizontal"){super(e,"toolbar")}destructor(){}};function au(e,t){return t.params?.type===e}function CH(e){if(e==="button")return new qy;if(e==="slider")return new TM;if(e==="toolbar")return new Qy;if(e==="group")return new IH;if(e==="list")return new kH;if(e==="region")return new ou(xe("div"));if(e==="text")return new MH;if(e==="listswitch")return new AH;throw new Error("AG Charts - error allocating meta")}function xT(e){const t={params:e,result:void 0};return t.result=CH(t.params.type),t}var LH=class{constructor(e,t,i){this.eventsHub=e,this.localeManager=t,this.domManager=i,this.cleanup=new pt}destroy(){this.cleanup.flush()}addLocalisation(e){e(),this.cleanup.register(this.eventsHub.on("locale:change",e))}createProxyContainer(e){const t=xT(e),{params:i,result:s}=t,n=s.getElement();return this.domManager.addChild("canvas-proxy",i.domManagerId,n),n.classList.add(...i.classList,"ag-charts-proxy-container"),n.role=i.type,au("toolbar",t)&&(t.result.orientation=t.params.orientation),this.addLocalisation(()=>{n.ariaLabel=this.localeManager.t(i.ariaLabel.id,i.ariaLabel.params)}),s}createProxyElement(e){const t=xT(e);if(au("button",t)){const{params:i,result:s}=t,n=s.getElement();if(this.initInteract(i,s),typeof i.textContent=="string")n.textContent=i.textContent;else{const{textContent:o}=i;this.addLocalisation(()=>{n.textContent=this.localeManager.t(o.id,o.params)})}this.setParent(t.params,t.result)}if(au("slider",t)){const{params:i,result:s}=t,n=s.getElement();this.initInteract(i,s),n.type="range",n.role="presentation",n.style.margin="0px",this.addLocalisation(()=>{n.ariaLabel=this.localeManager.t(i.ariaLabel.id,i.ariaLabel.params)}),this.setParent(t.params,t.result)}if(au("text",t)){const{params:i,result:s}=t;this.initElement(i,s),this.setParent(t.params,t.result)}if(au("listswitch",t)){const{params:i,result:s}=t;this.initInteract(i,s),s.setTextContent(i.textContent),s.setChecked(i.ariaChecked),s.setAriaDescribedBy(i.ariaDescribedBy),this.setParent(t.params,t.result)}if(au("region",t)){const{params:i,result:s}=t,n=s.getElement();this.initInteract(i,s),n.role="region",this.setParent(t.params,t.result)}return t.result}initElement(e,t){const i=t.getElement();return Cn(i,"cursor",e.cursor),i.classList.toggle("ag-charts-proxy-elem",!0),i}initInteract(e,t){const{tabIndex:i,domIndex:s}=e,n=this.initElement(e,t);i!==void 0&&(n.tabIndex=i),s!==void 0&&(t.domIndex=s)}setParent(e,t){if("parent"in e)e.parent?.addChild(t);else{const i={where:e.where,query:".ag-charts-series-area"};this.domManager.addChild("canvas-proxy",e.domManagerId,t.getElement(),i),t.destroyListener=()=>{this.domManager.removeChild("canvas-proxy",e.domManagerId)}}}},wH=/\$\{(\w+)}(?:\[(\w+)])?/gi,NM={number:new Intl.NumberFormat("en-US"),percent:new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2}),percent0to2dp:new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:0,maximumFractionDigits:2}),date:new Intl.DateTimeFormat("en-US",{dateStyle:"full"}),time:new Intl.DateTimeFormat("en-US",{timeStyle:"full"}),datetime:new Intl.DateTimeFormat("en-US",{dateStyle:"full",timeStyle:"full"})},TH=({defaultValue:e,variables:t})=>e?.replaceAll(wH,(i,s,n)=>{const o=t[s],a=n==null?null:NM[n];return n!=null&&a==null&&j.warnOnce(`Format style [${n}] is not supported`),a!=null?a.format(o):typeof o=="number"?NM.number.format(o):o instanceof Date?NM.datetime.format(o):String(o)}),NH=class{constructor(e){this.eventsHub=e,this.localeText=void 0,this.getLocaleText=void 0}setLocaleText(e){this.localeText!==e&&(this.localeText=e,this.eventsHub.emit("locale:change",null))}setLocaleTextFormatter(e){this.getLocaleText=e,this.getLocaleText!==e&&(this.getLocaleText=e,this.eventsHub.emit("locale:change",null))}t(e,t={}){const{localeText:i=Pw,getLocaleText:s}=this,n=i[e];return String(s?.({key:e,defaultValue:n,variables:t})??TH({key:e,defaultValue:n,variables:t})??e)}},bT=class{constructor(e){this.enabled=!0,this.width=600,this.height=300;const{width:t,height:i,canvasElement:s,willReadFrequently:n=!1}=e;this.pixelRatio=e.pixelRatio??Ve("devicePixelRatio")??1,this.element=s??xe("canvas"),this.element.style.display="block",this.element.style.width=(t??this.width)+"px",this.element.style.height=(i??this.height)+"px",this.element.width=Math.round((t??this.width)*this.pixelRatio),this.element.height=Math.round((i??this.height)*this.pixelRatio),this.context=this.element.getContext("2d",{willReadFrequently:n}),this.onEnabledChange(),this.resize(t??0,i??0,this.pixelRatio),Bw(this.context)}drawImage(e,t=0,i=0){return e.drawImage(this.context.canvas,t,i)}toDataURL(e){return this.element.toDataURL(e)}resize(e,t,i){if(!(e>0&&t>0))return;const{element:s,context:n}=this;s.width=Math.round(e*i),s.height=Math.round(t*i),n.setTransform(i,0,0,i,0,0),s.style.width=e+"px",s.style.height=t+"px",this.width=e,this.height=t,this.pixelRatio=i}clear(){zw(this)}destroy(){this.element.remove(),this.element.width=0,this.element.height=0,this.context.clearRect(0,0,0,0),Object.freeze(this)}reset(){this.context.reset(),this.context.verifyDepthZero?.()}onEnabledChange(){this.element&&(this.element.style.display=this.enabled?"":"none")}};g([Wt(e=>e.onEnabledChange())],bT.prototype,"enabled",2);var OH=class extends Sn{constructor(){super(...arguments),this.cache=new Map,this.imageLoadingCount=0}loadImage(e,t){const i=this.cache.get(e);if(i?.image)return i.image;if(i!=null&&t){i.nodes.add(t);return}if(!t)return;const s={image:void 0,nodes:new Set([t])},n=new Image;return this.imageLoadingCount++,n.onload=()=>{s.image=n;for(const o of s.nodes)o.markDirty();s.nodes.clear(),this.imageLoadingCount--,this.emit("image-loaded",{uri:e})},n.onerror=()=>{this.imageLoadingCount--,s.nodes.clear(),this.emit("image-error",{uri:e})},n.src=e,this.cache.set(e,s),s.image}waitingToLoad(){return this.imageLoadingCount>0}destroy(){for(const e of this.cache.values())e.nodes.clear();this.cache.clear()}},EH=class{constructor(e){this.canvas=e,this.debug=Me.create(!0,"scene"),this.layersMap=new Map,this.nextLayerId=0}get size(){return this.layersMap.size}resize(e,t,i){this.canvas.resize(e,t,i);for(const{canvas:s}of this.layersMap.values())s.resize(e,t,i)}addLayer(e){const{width:t,height:i,pixelRatio:s}=this.canvas,{name:n}=e,o=new pM({width:t,height:i,pixelRatio:s});return this.layersMap.set(o,{id:this.nextLayerId++,name:n,canvas:o}),this.debug("Scene.addLayer() - layers",this.layersMap),o}removeLayer(e){this.layersMap.has(e)&&(this.layersMap.delete(e),e.destroy(),this.debug("Scene.removeLayer() -  layers",this.layersMap))}clear(){for(const e of this.layersMap.values())e.canvas.destroy();this.layersMap.clear()}},Jy=class extends Sn{constructor(e){super(),this.debug=Me.create(!0,"scene"),this.id=Mi(this),this.imageLoader=new OH,this.root=null,this.pendingSize=null,this.isDirty=!1,this.cleanup=new pt,this.updateDebugFlags(),this.canvas=new bT(e),this.layersManager=new EH(this.canvas),this.cleanup.register(this.imageLoader.on("image-loaded",()=>{this.emit("scene-changed",{})}),this.imageLoader.on("image-error",({uri:t})=>{j.warnOnce(`Unable to load image ${t}`)}))}waitingForUpdate(){return this.imageLoader?.waitingToLoad()??!1}get width(){return this.pendingSize?.[0]??this.canvas.width}get height(){return this.pendingSize?.[1]??this.canvas.height}get pixelRatio(){return this.pendingSize?.[2]??this.canvas.pixelRatio}setContainer(e){const{element:t}=this.canvas;return t.remove(),e.appendChild(t),this}setRoot(e){return this.root===e?this:(this.isDirty=!0,this.root?.setScene(),this.root=e,e&&(e.visible=!0,e.setScene(this)),this)}updateDebugFlags(){Me.inDevelopmentMode(()=>vr._debugEnabled=!0)}clearCanvas(){this.canvas.clear()}attachNode(e){return this.appendChild(e),()=>e.remove()}appendChild(e){return this.root?.appendChild(e),this}removeChild(e){return e.remove(),this}download(e,t){lS(this.canvas.toDataURL(t),e?.trim()??"image")}getDataURL(e){return this.canvas.toDataURL(e)}resize(e,t,i){return e=Math.round(e),t=Math.round(t),i??(i=this.pixelRatio),e>0&&t>0&&(e!==this.width||t!==this.height||i!==this.pixelRatio)?(this.pendingSize=[e,t,i],this.isDirty=!0,!0):!1}render(e){const{debugSplitTimes:t={start:performance.now()},extraDebugStats:i,seriesRect:s}=e??{},{canvas:n,canvas:{context:o}={},root:a,pendingSize:r,width:l,height:c,pixelRatio:h}=this;if(!o)return;const d=Me.check("scene:stats","scene:stats:verbose");d&&this.ensureDebugStatsRegistration();const u=performance.now();let p=!1;if(r&&(p=!0,this.layersManager.resize(...r),this.pendingSize=null),a&&!a.visible){this.isDirty=!1;return}let f;if(a instanceof Oe&&(f=a.dirty),a!=null&&f===!1&&!this.isDirty){this.debug.check()&&this.debug("Scene.render() - no-op",{tree:Uy(a,"console")}),d&&rT(this.layersManager,t,o,void 0,i,s);return}const y={ctx:o,width:l,height:c,devicePixelRatio:h,debugNodes:{}};Me.check("scene:stats:verbose")&&(y.stats={layersRendered:0,layersSkipped:0,nodesRendered:0,nodesSkipped:0,opsPerformed:0,opsSkipped:0}),iH(y);let b=!1;if((f!==!1||p)&&(b=!0,n.clear()),a&&Me.check("scene:dirtyTree")){const{dirtyTree:x,paths:v}=lT(a);Me.create("scene:dirtyTree")("Scene.render() - dirtyTree",{dirtyTree:x,paths:v})}if(a&&b){if(a.visible&&a.preRender(y),this.debug.check()){const x=Uy(a,"console");this.debug("Scene.render() - before",{canvasCleared:b,tree:x})}if(a.visible)try{o.save(),a.render(y),o.restore()}catch(x){throw this.canvas.reset(),x}}t["\u270D\uFE0F"]=performance.now()-u,o.verifyDepthZero?.(),this.isDirty=!1,d&&rT(this.layersManager,t,o,y.stats,i,s),sH(o,y.debugNodes),a&&this.debug.check()&&this.debug("Scene.render() - after",{tree:Uy(a,"console"),canvasCleared:b})}ensureDebugStatsRegistration(){if(this.releaseDebugStats)return;const e=JG(),t=()=>{e(),this.releaseDebugStats=void 0};this.releaseDebugStats=t,this.cleanup.register(t)}toSVG(){const{root:e,width:t,height:i}=this;if(e!=null)return vr.toSVG(e,t,i)}strip(){const{context:e,pixelRatio:t}=this.canvas;e.setTransform(t,0,0,t,0,0),this.layersManager.clear(),this.setRoot(null),this.isDirty=!1,this.clear()}destroy(){this.strip(),this.canvas.destroy(),this.imageLoader.destroy(),this.cleanup.flush(),hT(),Object.assign(this,{canvas:void 0})}};Jy.className="Scene";var PH=class{constructor(e,t,i){this.eventsHub=e,this.annotationRoot=t,this.fireChartEvent=i,this.mementoOriginatorKey="annotations",this.annotations=[]}createMemento(){return this.annotations}guardMemento(e){return e==null||Ce(e)}restoreMemento(e,t,i){this.annotations=this.cleanData(i??[]).map(s=>{const n=this.getAnnotationTypeStyles(s.type);return oe(s,n)}),this.eventsHub.emit("annotations:restore",{annotations:this.annotations})}updateData(e){this.annotations=this.cleanData(e??[])}fireChangedEvent(){this.fireChartEvent({type:"annotations",annotations:Re([...this.annotations])})}attachNode(e){return this.annotationRoot.append(e),()=>(e.remove(),this)}setAnnotationStyles(e){this.styles=e}getAnnotationTypeStyles(e){return this.styles?.[e]}cleanData(e){for(const t of e)"textAlign"in t&&delete t.textAlign;return e}},RH=class{constructor(e,t){this.eventsHub=e,this.sceneRoot=t,this.axes=new Map,this.axisGridGroup=new Oe({name:"Axes-Grids",zIndex:2}),this.axisGroup=new Oe({name:"Axes",zIndex:3}),this.axisLabelGroup=new Oe({name:"Axes-Labels",zIndex:15}),this.axisCrosslineRangeGroup=new Oe({name:"Axes-Crosslines-Range",zIndex:6}),this.axisCrosslineLineGroup=new Oe({name:"Axes-Crosslines-Line",zIndex:10}),this.axisCrosslineLabelGroup=new Oe({name:"Axes-Crosslines-Label",zIndex:15}),this.sceneRoot.appendChild(this.axisGroup),this.sceneRoot.appendChild(this.axisGridGroup),this.sceneRoot.appendChild(this.axisLabelGroup),this.sceneRoot.appendChild(this.axisCrosslineRangeGroup),this.sceneRoot.appendChild(this.axisCrosslineLineGroup),this.sceneRoot.appendChild(this.axisCrosslineLabelGroup)}updateAxes(e,t){const i={axisNode:this.axisGroup,gridNode:this.axisGridGroup,labelNode:this.axisLabelGroup,crossLineRangeNode:this.axisCrosslineRangeGroup,crossLineLineNode:this.axisCrosslineLineGroup,crossLineLabelNode:this.axisCrosslineLabelGroup};for(const s of e)t.includes(s)||(s.detachAxis(i),s.destroy());for(const s of t)e?.includes(s)||s.attachAxis(i);this.axes.clear();for(const s of t){const n=s.createAxisContext();this.axes.has(n.direction)?this.axes.get(n.direction)?.push(n):this.axes.set(n.direction,[n])}this.eventsHub.emit("axis:change",null)}getAxisIdContext(e){for(const[,t]of this.axes)for(const i of t)if(i.axisId===e)return i}getAxisContext(e){return this.axes.get(e)??[]}destroy(){this.axes.clear(),this.axisGroup.remove(),this.axisGridGroup.remove()}},OM=class{constructor(e,t,i){this.eventsHub=e,this.caller=t,this.animationManager=i,this.dispatchOnlyLatest=!0,this.dispatchThrottle=0,this.requestThrottle=300,this.isLoadingInitialData=!1,this.isLoadingData=!1,this.freshRequests=[],this.requestCounter=0,this.pendingData=void 0,this.debug=Me.create(!0,"data-model","data-source"),this.throttledFetch=this.createThrottledFetch(this.requestThrottle),this.throttledDispatch=this.createThrottledDispatch(this.dispatchThrottle)}updateCallback(e){typeof e=="function"&&(this.debug("DataService - updated data source callback"),this.dataSourceCallback=e,this.isLoadingInitialData=!0,this.animationManager.skip(),this.eventsHub.emit("data:source-change",null))}clearCallback(){this.dataSourceCallback=void 0}load(e){const{pendingData:t}=this;if(t!=null&&(t.params.windowStart==null&&t.params.windowEnd==null||t.params.windowStart?.valueOf()===e.windowStart?.valueOf()&&t.params.windowEnd?.valueOf()===e.windowEnd?.valueOf())){const i=this.requestCounter++;this.isLoadingInitialData=!1,this.dispatch(i,t.data);return}this.isLoadingData=!0,this.throttledFetch(e)}isLazy(){return this.dataSourceCallback!=null}isLoading(){return this.isLazy()&&(this.isLoadingInitialData||this.isLoadingData)}async getData(){const{latestRequest:e}=this;if(!e)return;const{params:t,fetchRequest:i}=e,s=await i;return{params:t,data:s}}restoreData(e){this.pendingData=e}createThrottledFetch(e){return pm(t=>this.fetch(t).catch(i=>j.error("callback failed",i)),e,{leading:!1,trailing:!0})}createThrottledDispatch(e){return pm((t,i)=>this.dispatch(t,i),e,{leading:!0,trailing:!0})}dispatch(e,t){this.debug(`DataService - dispatching 'data-load' | ${e}`),this.eventsHub.emit("data:load",{data:t})}async fetch(e){"context"in this.caller&&(e.context=this.caller.context);const t=Promise.resolve().then(async()=>{if(!this.dataSourceCallback)throw new Error("DataService - [dataSource.getData] callback not initialised");const i=performance.now(),s=this.requestCounter++;this.debug(`DataService - requesting | ${s}`);let n;try{n=await this.dataSourceCallback(e),this.debug(`DataService - response | ${performance.now()-i}ms | ${s}`)}catch(a){this.debug(`DataService - request failed | ${s}`),j.errorOnce(`DataService - request failed | [${a}]`)}this.isLoadingInitialData=!1;const o=this.freshRequests.indexOf(t);return o===-1||this.dispatchOnlyLatest&&o!==this.freshRequests.length-1?(this.debug(`DataService - discarding stale request | ${s}`),n):(this.freshRequests=this.freshRequests.slice(o+1),this.freshRequests.length===0&&(this.isLoadingData=!1),Array.isArray(n)?this.throttledDispatch(s,n):this.eventsHub.emit("data:error",null),n)});this.latestRequest={params:e,fetchRequest:t},this.freshRequests.push(t),await t}};g([He({newValue(e){this.throttledDispatch=this.createThrottledDispatch(e)}})],OM.prototype,"dispatchThrottle",2),g([He({newValue(e){this.throttledFetch=this.createThrottledFetch(e)}})],OM.prototype,"requestThrottle",2);var FH=class{constructor(e,t){this.domManager=e,this.updateService=t,this.observers=[]}updateFonts(e){if(!(!e||e.size===0)){this.loadFonts(e);for(const t of e)this.observeFontStatus(t)}}destroy(){for(const e of this.observers)e.disconnect();this.observers=[]}loadFonts(e){const t=Array.from(e).map(o=>encodeURIComponent(o)),i=":wght@100;200;300;400;500;600;700;800;900",s=`${i}&family=`,n=`@import url('https://fonts.googleapis.com/css2?family=${t.join(s)}${i}&display=swap');
`;this.domManager.addStyles(`google-font-${t.join("-")}`,n)}observeFontStatus(e){const t=globalThis.document.createElement("div");t.style.setProperty("position","absolute"),t.style.setProperty("top","0"),t.style.setProperty("margin","0"),t.style.setProperty("padding","0"),t.style.setProperty("overflow","hidden"),t.style.setProperty("visibility","hidden"),t.style.setProperty("width","auto"),t.style.setProperty("max-width","none"),t.style.setProperty("font-synthesis","none"),t.style.setProperty("font-family",e),t.style.setProperty("font-size","16px"),t.style.setProperty("white-space","nowrap"),t.textContent="UVWxyz",this.domManager.addChild("canvas-container",`font-check-${encodeURIComponent(e)}`,t);const i=new ResizeObserver(s=>{const n=s?.at(0)?.contentBoxSize.at(0)?.inlineSize;n!=null&&n>0&&(Ze.clear(),this.updateService.update(4))});i.observe(t),this.observers.push(i)}},vT=class{constructor(){this.registeredListeners=new Map}addListener(e,t){const i={symbol:Symbol(e),handler:t};return this.registeredListeners.has(e)?this.registeredListeners.get(e).push(i):this.registeredListeners.set(e,[i]),()=>this.removeListener(i.symbol)}removeListener(e){for(const[t,i]of this.registeredListeners.entries()){const s=i.findIndex(n=>n.symbol===e);if(s>=0){i.splice(s,1),i.length===0&&this.registeredListeners.delete(t);break}}}dispatch(e,...t){for(const i of this.getListenersByType(e))try{i.handler(...t)}catch(s){j.errorOnce(s)}}getListenersByType(e){return this.registeredListeners.get(e)??[]}destroy(){this.registeredListeners.clear()}},ba={millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e",month:"%b",year:"%Y"},zH={millisecond:"%Y %b %e %H:%M:%S.%L",second:"%Y %b %e %H:%M:%S",minute:"%Y %b %e %H:%M",hour:"%Y %b %e %H:%M",day:"%Y %b %e",month:"%Y %b",year:"%Y"},Ls={year:0,month:1,day:2,hour:3,minute:4,second:5,millisecond:6},BH=/%[-_0]?L/,_H=/%[-_0]?S/,VH=/%[-_0]?M/,GH=/%[-_0]?[HI]/,HH=/^%[-_0]?[de]$/,jH=/^%[-_0]?[Bbm]$/,WH=/^%[-_0]?[Yy]$/;function $H(e,t,i){if(typeof e=="string")return e;e??(e=ba);const{millisecond:s=ba.millisecond,second:n=ba.second,minute:o=ba.minute,hour:a=ba.hour,day:r=ba.day,month:l=ba.month,year:c=ba.year}=e,h=Ls[t],d=zH[t],u=i?Ls[i]:-1;if(u<Ls.year&&h>=Ls.year&&!WH.test(c)||u<Ls.month&&h>=Ls.month&&!jH.test(l)||u<Ls.day&&h>=Ls.day&&!HH.test(r))return d;let p;switch(t){case"year":return c;case"month":return u<Ls.year?`${l} ${c}`:l;case"day":return u<Ls.year?`${l} ${r} ${c}`:`${l} ${r}`;case"hour":p=a;break;case"minute":p=o;break;case"second":p=n;break;case"millisecond":p=s;break;default:return d}if(h>=Ls.hour&&!GH.test(p)||h>=Ls.minute&&!VH.test(p)||h>=Ls.second&&!_H.test(p)||h>=Ls.millisecond&&!BH.test(p))return d;let f;return u<Ls.year?f=`${l} ${r} ${c}`:u<Ls.month&&(f=`${l} ${r}`),f?`${p} ${f}`:p}var ru=class Qv extends vT{constructor(){super(...arguments),this.formats=new Map,this.dateFormatter=pr((t,i,s,n,o)=>{const a=Qv.mergeSpecifiers(t,i)??ba;return Qv.getFormatter("date",a,s,n,{truncateDate:o})}),this.formatter=void 0}static mergeSpecifiers(...t){let i;for(const s of t)st(s)&&st(i)?i={...i,...s}:i=s;return i}static getFormatter(t,i,s,n="long",{truncateDate:o}={}){if(st(i)){if(t!=="date"){j.warn("Date formatter configuration is not supported for non-date types.");return}s??(s="millisecond");const a=n==="component"?i?.[s]??ba[s]:$H(i,s,o);return Sc(a)}switch(t){case"number":{const a=Tp(i);return a==null?void 0:hm(a)}case"date":return Sc(i);case"category":return a=>i.replace("%s",String(a))}}setFormatter(t){this.formatter!==t&&(this.formatter=t,this.formats.clear(),this.dateFormatter.reset(),this.dispatch("format-changed"))}format(t,i,{specifier:s,truncateDate:n}={}){if(i.value==null)return;const{formatter:o}=this;if(o==null)return;if(typeof o=="function"){const c=t(o,i);return c==null?void 0:String(c)}const a=o[i.property];if(a==null)return;if(typeof a=="function"){const c=t(a,i);return c==null?c:Dt(c)}else if(i.type==="date"){const{unit:c,style:h}=i;return this.dateFormatter(a,s,c,h,n)?.(i.value)}const r=s??a;if(typeof r!="string")return;let l=this.formats.get(r);return l==null&&(l=Qv.getFormatter(i.type,r),this.formats.set(r,l)),l?.(i.value,i.type==="number"?i.fractionDigits:void 0)}defaultFormat(t,{specifier:i,truncateDate:s}={}){const{formatter:n}=this,o=typeof n=="function"?void 0:n?.[t.property];switch(t.type){case"date":{const{unit:a,style:r}=t,l=o!=null&&typeof o!="function"?o:void 0;return this.dateFormatter(l,i,a,r,s)?.(t.value)??String(t.value)}case"number":return ao(t.value,t.fractionDigits);case"category":return Array.isArray(t.value)?t.value.join(" - "):typeof t.value=="string"?t.value:typeof t.value=="number"?ao(t.value):String(t.value)}}};function UH(e,t){return i=>Number(e)*(1-i)+Number(t)*i}function ST(e,t){if(typeof e=="string")try{e=Be.fromString(e)}catch{e=Be.fromArray([0,0,0])}if(typeof t=="string")try{t=Be.fromString(t)}catch{t=Be.fromArray([0,0,0])}return i=>Be.mix(e,t,i).toRgbaString()}var EM=.2,wg=["initial","remove","update","add","trailing","end","none"],ex={initial:{animationDuration:1,animationDelay:0},add:{animationDuration:.25,animationDelay:.75},remove:{animationDuration:.25,animationDelay:0},update:{animationDuration:.5,animationDelay:.25},trailing:{animationDuration:EM,animationDelay:1,skipIfNoEarlierAnimations:!0},end:{animationDelay:1+EM,animationDuration:0,skipIfNoEarlierAnimations:!0},none:{animationDuration:0,animationDelay:0}};function KH(e){return e.every(t=>t instanceof vr)}function PM(e){return KH(e)?{nodes:e,selections:[]}:{nodes:[],selections:e}}function RM(e,t){return e===t?!0:Array.isArray(e)&&Array.isArray(t)?e.length===t.length&&e.every((i,s)=>RM(i,t[s])):By(e)&&By(t)?e.equals(t):st(e)&&st(t)?Nm(e,t,RM):!1}var YH=class{constructor(e){this.isComplete=!1,this.elapsed=0,this.iteration=0,this.isPlaying=!1,this.isReverse=!1,this.id=e.id,this.groupId=e.groupId,this.autoplay=e.autoplay??!0,this.ease=e.ease??cM,this.phase=e.phase;const t=e.duration??ex[this.phase].animationDuration;this.duration=t*e.defaultDuration,this.delay=(e.delay??0)*e.defaultDuration,this.onComplete=e.onComplete,this.onPlay=e.onPlay,this.onStop=e.onStop,this.onUpdate=e.onUpdate,this.interpolate=this.createInterpolator(e.from,e.to),this.from=e.from,e.skip===!0&&(this.onUpdate?.(e.to,!1,this),this.onStop?.(this),this.onComplete?.(this),this.isComplete=!0),e.collapsable!==!1&&(this.duration=this.checkCollapse(e,this.duration))}checkCollapse(e,t){return RM(e.from,e.to)?0:t}play(e=!1){this.isPlaying||this.isComplete||(this.isPlaying=!0,this.onPlay?.(this),this.autoplay&&(this.autoplay=!1,e&&this.onUpdate?.(this.from,!0,this)))}stop(){this.isPlaying=!1,this.isComplete||(this.isComplete=!0,this.onStop?.(this))}update(e){if(this.isComplete)return e;!this.isPlaying&&this.autoplay&&this.play(!0);const t=this.elapsed;if(this.elapsed+=e,this.delay>this.elapsed)return 0;const i=this.interpolate(this.isReverse?1-this.delta:this.delta);this.onUpdate?.(i,!1,this);const s=this.delay+this.duration;return this.elapsed>=s?(this.stop(),this.isComplete=!0,this.onComplete?.(this),e-(s-t)):0}get delta(){return this.ease(ge(0,(this.elapsed-this.delay)/this.duration,1))}createInterpolator(e,t){if(typeof t!="object"||By(t))return this.interpolateValue(e,t);if(Array.isArray(t)){const s=[];for(let n=0;n<t.length;n++){const o=this.createInterpolator(e[n],t[n]);o!=null&&s.push(o)}return n=>{const o=[];for(const a of s)o.push(a(n));return o}}const i=[];for(const s of Object.keys(t)){const n=this.createInterpolator(e[s],t[s]);n!=null&&i.push([s,n])}return s=>{const n={};for(const[o,a]of i)n[o]=a(s);return n}}interpolateValue(e,t){if(!(e==null||t==null)){if(By(e))return i=>e[zy](t,i);try{switch(typeof e){case"number":return UH(e,t);case"string":return ST(e,t);case"boolean":if(e===t)return()=>e;break;case"object":return()=>e;default:throw new Error(`Unable to interpolate values: ${e}, ${t}`)}}catch{}throw new Error(`Unable to interpolate values: ${e}, ${t}`)}}};function ZH(e,t,i,s){return t<e.startIndex?(e.startIndex+=i,e.endIndex+=i,!1):t<e.endIndex||t===e.endIndex&&s?(e.endIndex+=i,!0):!1}function XH(e,t,i){const s=t+i;if(s<=e.startIndex)return e.startIndex=Math.max(0,e.startIndex-i),e.endIndex=Math.max(e.startIndex,e.endIndex-i),!1;if(t>=e.endIndex)return!1;if(t<=e.startIndex&&s>=e.endIndex)e.startIndex=t,e.endIndex=t;else if(t<=e.startIndex){const n=s-e.startIndex,o=e.endIndex-e.startIndex;e.startIndex=t,e.endIndex=e.startIndex+Math.max(0,o-n)}else s>=e.endIndex?e.endIndex=Math.max(e.startIndex,t):e.endIndex=Math.max(e.startIndex,e.endIndex-i);return!0}function MT(e,t){const i=Math.ceil(e/1e3);return Math.max(t,i)}function DT(e,t){return Math.max(1,Math.ceil(e/t))}function qH(e){return e.filter(t=>t.endIndex>t.startIndex)}function QH(e,t,i){if(!t.enableBanding||e<t.minDataSizeForBanding)return[i(0,e)];const s=MT(e,t.targetBandCount),n=DT(e,s),o=[];for(let a=0;a<e;a+=n){const r=Math.min(a+n,e);o.push(i(a,r))}return o}function JH(e,t){for(const i of t)i.insertCount>0&&e.handleInsertion(i.index,i.insertCount),i.deleteCount>0&&e.handleRemoval(i.index,i.deleteCount)}function ej(e,t){for(const i of t)e.handleInsertion(i,0)}function tj(e,t){JH(e,t.spliceOps),t.updatedIndices.size>0&&ej(e,t.updatedIndices)}var ij=1e3,sj=10,IT=class{constructor(e={}){this.bands=[],this.dataSize=0,this.config={minDataSizeForBanding:e.minDataSizeForBanding??ij,targetBandCount:e.targetBandCount??sj,maxBandSize:e.maxBandSize??1/0,enableBanding:e.enableBanding??!0}}applyIndexMap(e){tj(this,e)}initializeBands(e){this.dataSize=Math.max(0,e),this.bands=QH(this.dataSize,this.config,(t,i)=>this.createBand(t,i))}getBandCount(){return this.bands.length}handleInsertion(e,t){if(this.dataSize+=t,this.bands.length===0){this.initializeBands(this.dataSize);return}const i=MT(this.dataSize,this.config.targetBandCount),s=DT(this.dataSize,i),n=Math.ceil(s*1.1);for(let o=0;o<this.bands.length;o++){const a=this.bands[o],r=o===this.bands.length-1;if(e===a.endIndex&&r&&t>0){a.endIndex-a.startIndex>=s?this.bands.push(this.createBand(e,e+t)):(a.endIndex+=t,a.isDirty=!0);break}ZH(a,e,t,r)&&(a.isDirty=!0,t>0&&e<a.endIndex&&a.endIndex-a.startIndex>n&&this.splitBand(o,s))}}handleRemoval(e,t){if(t<=0||this.bands.length===0)return;const i=Math.min(t,Math.max(0,this.dataSize-e));if(!(i<=0)){this.dataSize=Math.max(0,this.dataSize-i);for(const s of this.bands)XH(s,e,i)&&(s.isDirty=!0);this.bands=qH(this.bands)}}splitBand(e,t){const i=this.bands[e],s=i.endIndex-i.startIndex,n=Math.min(t,Math.floor(s/2)),o=i.startIndex+n,a=this.createBand(i.startIndex,o),r=this.createBand(o,i.endIndex);this.bands.splice(e,1,a,r)}getStats(){const e=this.bands.filter(t=>t.isDirty);return{totalBands:this.bands.length,dirtyBands:e.length,dataSize:this.dataSize}}markRangeDirty(e,t){for(const i of this.bands)e<i.endIndex&&t>i.startIndex&&(i.isDirty=!0)}},Nn=class zB{constructor(){this.domain=new Set,this.dateTimestamps=new Set,this.hasDateValues=!1,this.sortedValues=null,this.sortOrder=void 0,this.isSortedUnique=!1}static is(t){return t instanceof zB}setSortedUniqueMode(t,i){i&&(this.isSortedUnique=!0,this.sortOrder=t,this.sortedValues=[])}extend(t){this.isSortedUnique&&this.sortedValues?(this.sortedValues.push(t),t instanceof Date&&(this.hasDateValues=!0)):t instanceof Date?(this.hasDateValues=!0,this.dateTimestamps.add(t.valueOf())):this.domain.add(t)}getDomain(){if(this.isSortedUnique&&this.sortedValues){let t=!1;return this.sortedValues.filter(i=>{if(i==null)return t?!1:(t=!0,!0);if(i instanceof Date&&Number.isNaN(i.valueOf())){if(t)return!1;t=!0}return!0})}if(this.hasDateValues){const t=Array.from(this.dateTimestamps,i=>new Date(i));return this.domain.size>0?[...t,...Array.from(this.domain)]:t}return Array.from(this.domain)}isDateDomain(){return this.hasDateValues}isSortedUniqueMode(){return this.isSortedUnique}getSortOrder(){return this.sortOrder}mergeFrom(t){if(this.isSortedUnique&&t.isSortedUnique&&this.sortOrder===t.sortOrder&&this.sortOrder!==void 0&&t.sortedValues){t.hasDateValues&&(this.hasDateValues=!0),this.sortedValues??(this.sortedValues=[]),this.sortedValues.push(...t.sortedValues);return}if(this.convertToSetMode(),t.hasDateValues&&(this.hasDateValues=!0),t.isSortedUnique&&t.sortedValues)for(const i of t.sortedValues)i instanceof Date?this.dateTimestamps.add(i.valueOf()):this.domain.add(i);else{for(const i of t.dateTimestamps)this.dateTimestamps.add(i);for(const i of t.domain)this.domain.add(i)}}convertToSetMode(){if(this.isSortedUnique){if(this.sortedValues){for(const t of this.sortedValues)t instanceof Date?this.dateTimestamps.add(t.valueOf()):this.domain.add(t);this.sortedValues=null}this.isSortedUnique=!1,this.sortOrder=void 0}}},On=class BB{constructor(){this.domain=[1/0,-1/0]}static is(t){return t instanceof BB}static extendDomain(t,i=[1/0,-1/0]){for(const s of t)typeof s=="number"&&(i[0]>s&&(i[0]=s),i[1]<s&&(i[1]=s));return i}extend(t){typeof t!="number"&&!(t instanceof Date)||(this.domain[0]>t&&(this.domain[0]=t),this.domain[1]<t&&(this.domain[1]=t))}getDomain(){return[...this.domain]}},Tg=class extends IT{constructor(e,t={},i=!1){super(t),this.fullDomainCache=null,this.sortOrder=void 0,this.isUnique=!1,this.domainFactory=e,this.isDiscrete=i}setSortOrderMetadata(e,t){this.sortOrder=e,this.isUnique=t}createBand(e,t){const i=this.domainFactory();return this.isDiscrete&&this.sortOrder!==void 0&&this.isUnique&&Nn.is(i)&&i.setSortedUniqueMode(this.sortOrder,this.isUnique),{startIndex:e,endIndex:t,subDomain:i,isDirty:!0}}initializeBands(e){super.initializeBands(e),this.fullDomainCache=null}handleInsertion(e,t){super.handleInsertion(e,t),this.fullDomainCache=null}handleRemoval(e,t){super.handleRemoval(e,t),this.fullDomainCache=null}splitBand(e,t){this.bands.length>1&&super.splitBand(e,t)}markBandsDirty(e,t){this.markRangeDirty(e,t),this.fullDomainCache=null}markAllBandsDirty(){for(const e of this.bands)e.isDirty=!0;this.fullDomainCache=null}extendBandsFromData(e,t){const i=e.length;for(const s of this.bands){if(!s.isDirty)continue;const n=this.domainFactory();this.isDiscrete&&this.sortOrder!==void 0&&this.isUnique&&Nn.is(n)&&n.setSortedUniqueMode(this.sortOrder,this.isUnique),s.subDomain=n;const{startIndex:o,endIndex:a}=s;for(let r=o;r<a&&r<i;r++)t?.[r]||s.subDomain.extend(e[r]);s.isDirty=!1}this.fullDomainCache=null}getDirtyBands(){return this.bands.filter(e=>e.isDirty)}extend(e){this.markAllBandsDirty(),this.fullDomainCache=null}canUseSortedConcatenation(){if(!this.sortOrder||!this.isUnique||!this.isDiscrete)return!1;for(const e of this.bands)if(!Nn.is(e.subDomain)||!e.subDomain.isSortedUniqueMode()||e.subDomain.getSortOrder()!==this.sortOrder)return!1;return!0}concatenateSortedDomains(){const e=new Nn;e.setSortedUniqueMode(this.sortOrder,this.isUnique);for(const t of this.bands)Nn.is(t.subDomain)&&e.mergeFrom(t.subDomain);return e.getDomain()}deduplicateNulls(e){let t=!1;return e.filter(i=>{if(i==null)return t?!1:(t=!0,!0);if(i instanceof Date&&Number.isNaN(i.valueOf())){if(t)return!1;t=!0}return!0})}getDomain(){if(this.fullDomainCache!==null)return this.fullDomainCache;if(this.bands.length===0)return this.fullDomainCache=[],[];if(this.bands.length===1){const e=this.bands[0].subDomain.getDomain();return this.fullDomainCache=this.isDiscrete?this.deduplicateNulls(e):e,this.fullDomainCache}if(this.isDiscrete){const e=this.bands[0].subDomain;if(Nn.is(e))if(this.canUseSortedConcatenation())this.fullDomainCache=this.deduplicateNulls(this.concatenateSortedDomains());else{const t=new Nn;for(const i of this.bands)Nn.is(i.subDomain)&&t.mergeFrom(i.subDomain);this.fullDomainCache=this.deduplicateNulls(t.getDomain())}else{const t=new Set;for(const i of this.bands)for(const s of i.subDomain.getDomain())t.add(s);this.fullDomainCache=Array.from(t)}}else{let e,t;for(const i of this.bands){const s=i.subDomain.getDomain();if(s.length===2){const[n,o]=s;(e===void 0||n!=null&&e!=null&&n<e)&&(e=n),(t===void 0||o!=null&&t!=null&&o>t)&&(t=o)}}e!==void 0&&t!==void 0?this.fullDomainCache=[e,t]:this.fullDomainCache=[]}return this.fullDomainCache}getStats(){const e=this.bands.filter(i=>i.isDirty).length,t=this.bands.reduce((i,s)=>i+(s.endIndex-s.startIndex),0);return{bandCount:this.bands.length,dirtyBandCount:e,averageBandSize:this.bands.length>0?t/this.bands.length:0,dataSize:this.dataSize}}};function kT(e,t=[0,0]){for(const i of e)typeof i=="number"&&(i<0&&(t[0]+=i),i>0&&(t[1]+=i));return t}function nj(e,t){const i=t?.visible??!0;return{id:e,type:"aggregate",matchGroupIds:t?.matchGroupId?[t?.matchGroupId]:void 0,aggregateFunction:s=>kT(s),groupAggregateFunction:(s,n=[0,0])=>(i&&(n[0]+=s?.[0]??0,n[1]+=s?.[1]??0),n)}}function oj(e,t){return{id:e,matchGroupIds:[t],type:"aggregate",aggregateFunction:s=>On.extendDomain(s)}}function AT(e,t){const i=t?.visible??!0;return{id:e,type:"aggregate",aggregateFunction:()=>[0,1],groupAggregateFunction:(s,n=[0,0])=>(i&&(n[0]+=s?.[0]??0,n[1]+=s?.[1]??0),n)}}function aj(e,t){const i=t?.visible??!0;return{id:e,matchGroupIds:t?.matchGroupId?[t?.matchGroupId]:void 0,type:"aggregate",aggregateFunction:n=>kT(n),groupAggregateFunction:(n,o=[0,0,-1])=>(i&&(o[0]+=n?.[0]??0,o[2]++,o[1]+=n?.[1]??0),o),finalFunction:(n=[0,0,0])=>{const o=n[0]+n[1];return o>=0?[0,o/n[2]]:[o/n[2],0]}}}function CT(e,t,i){const s={id:e,matchGroupIds:i?[i]:void 0,type:"aggregate",aggregateFunction:(n,o=[])=>{const a=o[1]-o[0];return t.aggregateFunction(n).map(r=>r/a)}};return t.groupAggregateFunction&&(s.groupAggregateFunction=t.groupAggregateFunction),s}function rj(e){return()=>{let t=0;return i=>$e(i)?(t+=e?Math.max(0,i):i,t):i}}function lj(){return()=>{let e=0;return t=>{if(!$e(t))return t;const i=e;return e+=t,i}}}function FM(e){return e.map(t=>fe(t)?JSON.stringify(t):t).join("-")}function ln(e){const t=e?.map(Number);return t?.every(Number.isFinite)?t:[]}function LT(e,t){return t?.get(e.id)??0}function zM(e){return"scopes"in e&&Array.isArray(e.scopes)}function Al(e,t){const i=[];for(let s=0;s<e;s+=1)i[s]=t;return i}function tx(e){const t=new Set;for(const i of e.values())i&&t.add(i);return t}function BM(e,t){const i=[];for(const s of e){const n=s?.[t];if(n==null)return;i.push(n)}return i}function cj(e){const t=[];let i=0,s;const n=/((?:(?:^|\.)\s*\w+|\[\s*(?:'(?:[^']|(?<!\\)\\')*'|"(?:[^"]|(?<!\\)\\")*"|-?\d+)\s*\])\s*)/g;for(;s=n.exec(e);){if(s.index!==i)return;i=s.index+s[0].length;const o=s[1].trim();if(o.startsWith("."))t.push(o.slice(1).trim());else if(o.startsWith("[")){const a=o.slice(1,-1).trim();a.startsWith("'")?t.push(a.slice(1,-1).replaceAll(/(?<!\\)\\'/g,"'")):a.startsWith('"')?t.push(a.slice(1,-1).replaceAll(/(?<!\\)\\"/g,'"')):t.push(a)}else t.push(o)}if(i===e.length)return t}function hj(e){return t=>{let i=t;for(const s of e)i=i[s];return i}}var dj=class{constructor(e,t,i){this.ctx=e,this.scopeCacheManager=t,this.resolvers=i}aggregateUngroupedData(e){const t=this.ctx.aggregates.map(()=>[1/0,-1/0]);e.domain.aggValues=t;const{columns:i,dataSources:s}=e,n=Gs(s.keys()),o=e.keys.map(r=>r.get(n)),a=s.get(n)?.data??[];e.aggregation=a?.map((r,l)=>{const c=[];for(const[h,d]of this.ctx.aggregates.entries()){const u=this.valueGroupIdxLookup(d);let p=d.groupAggregateFunction?.()??[1/0,-1/0];const f=u.map(v=>i[v][l]),y=BM(o,l),b=y==null?void 0:d.aggregateFunction(f,y);b&&(p=d.groupAggregateFunction?.(b,p)??On.extendDomain(b,p));const x=d.finalFunction?.(p)??p;c[h]=x,On.extendDomain(x,t[h])}return c})}aggregateGroupedData(e){const t=this.ctx.aggregates.map(()=>[1/0,-1/0]);e.domain.aggValues=t;const{columns:i}=e;for(const[s,n]of this.ctx.aggregates.entries()){const o=this.valueGroupIdxLookup(n);for(let a=0;a<e.groups.length;a++){const r=e.groups[a];r.aggregation??(r.aggregation=[]);const l=r.keys;let c=n.groupAggregateFunction?.()??[1/0,-1/0];const h=Math.max(...o.map(u=>r.datumIndices[u]?.length??0));for(let u=0;u<h;u++){const p=o.map(y=>{const b=r.datumIndices[y]?.[u];if(b==null)return;const x=this.resolvers.resolveAbsoluteIndex(a,b);return i[y][x]}),f=n.aggregateFunction(p,l);f&&(c=n.groupAggregateFunction?.(f,c)??On.extendDomain(f,c))}const d=n.finalFunction?.(c)??c;r.aggregation[s]=d,On.extendDomain(d,t[s])}}}postProcessGroups(e){const{groupProcessors:t}=this.ctx,{columnScopes:i,columns:s,invalidData:n}=e;for(const o of t){const a=this.valueGroupIdxLookup(o),r=o.adjust()();for(let l=0;l<e.groups.length;l++){const c=e.groups[l];r(s,a,c,l)}for(const l of a){const h=this.ctx.values[l].valueType==="category",d=s[l],u=Gs(i[l]),p=n?.get(u),f=h?new Nn:new On;for(let y=0;y<d.length;y+=1)p?.[y]!==!0&&f.extend(d[y]);e.domain.values[l]=f.getDomain()}}}valueGroupIdxLookup(e){return this.scopeCacheManager.valueGroupIdxLookup(e)}},uj=class{constructor(e){this.ctx=e}setupDomainForDefinition(e,t,i){const s=e.valueType==="category";let n=t.get(e);return!n&&this.ctx.bandingConfig?.enableBanding!==!1&&(n=new Tg(s?()=>new Nn:()=>new On,this.ctx.bandingConfig,s),t.set(e,n)),n&&s&&n.setSortOrderMetadata(i?.sortOrder,i?.isUnique??!1),n||(s?new Nn:new On)}extendDomainFromData(e,t,i){if(e instanceof Tg)e.extendBandsFromData(t,i);else for(let s=0;s<t.length;s++)i?.[s]!==!0&&e.extend(t[s])}initializeBandedDomain(e,t,i){if(!(e instanceof Tg))return;const s=e.getStats(),n=s.bandCount===0||s.dataSize!==t;this.ctx.debug.check()&&n&&i&&this.ctx.debug(`Reinitializing bands for ${i}: bandCount=${s.bandCount}, dataSize=${s.dataSize}, dataLength=${t}`),n&&e.initializeBands(t)}},Cl=Symbol("key-sort-orders"),_M=Symbol("column-sort-orders"),VM=Symbol("domain-ranges"),Ng=Symbol("domain-bands"),$c=Symbol("reducer-bands"),wT=Object.freeze([0]);function GM(e,t){if(typeof t=="string")e.set(t,(e.get(t)??0)+1);else for(const i of t)e.set(i,(e.get(i)??0)+1)}function ix(e,t){if(e.reusableResult.valid=!1,e.hasInvalidValue){e.reusableResult.value=e.invalidValue,e.domain.extend(e.invalidValue);return}e.mode!=="integrated"&&j.warnOnce(`invalid value of type [${typeof t}] for [${e.def.scopes} / ${e.def.id}] ignored:`,`[${t}]`),e.reusableResult.value=void 0}function Og(e,t,i,s,n,o){return e&&t&&e(i,s,n)===!1?(o.reusableResult.missing=!1,ix(o,i),o.reusableResult):null}function Eg(e,t,i,s,n){n.missing=!e,!e&&!t&&GM(i,s)}function sx(e,t,i){return t.valid=!0,t.value=e,i.extend(e),t}var pj=class{constructor(e){this.ctx=e}createProcessValueFn(e,t,i,s,n,o){const a={def:e,accessor:t,domain:i,reusableResult:s,processorFns:n,mode:this.ctx.mode};return(o==="extend"?this.createSpecializedProcessValue(a,e.validation):null)??this.createGenericProcessValue(a,o)}createSpecializedProcessValue(e,t){return e.def.forceValue!=null?this.createSpecializedProcessValueForceValue(e):e.def.processor?this.createSpecializedProcessValueProcessor(e,t):t?e.def.type==="key"?this.createSpecializedProcessValueKeyValidation(e,t):this.createSpecializedProcessValueValueValidation(e,t):null}createValidationMeta(e){const{def:t,domain:i,reusableResult:s,mode:n}=e;return{reusableResult:s,hasInvalidValue:"invalidValue"in t,invalidValue:t.invalidValue,domain:i,def:t,mode:n}}createSpecializedProcessValueKeyValidation(e,t){const{def:i,accessor:s,domain:n,reusableResult:o}=e,a=i.property,r="missingValue"in i,l=i.missingValue,c=i.missing,h=this.createValidationMeta(e);if(s){const d=s;return function(p,f,y){let b;try{b=d(p)}catch{}const x=b!=null;return!x||b==null||t(b,p,f)===!1?(o.missing=!x,!x&&!r&&GM(c,y),ix(h,b),o):(o.missing=!1,o.valid=!0,o.value=b,n.extend(b),o)}}return function(u,p,f){const y=a in u,b=y?u[a]:l;return!y||b==null||t(b,u,p)===!1?(o.missing=!y,!y&&!r&&GM(c,f),ix(h,b),o):(o.missing=!1,o.valid=!0,o.value=b,n.extend(b),o)}}createSpecializedProcessValueValueValidation(e,t){const{def:i,accessor:s,domain:n,reusableResult:o}=e,a=i.property,r="missingValue"in i,l=i.missingValue,c=i.missing,h=this.createValidationMeta(e);if(s){const d=s;return function(p,f,y){let b;try{b=d(p)}catch{}const x=b!=null,v=Og(t,x,b,p,f,h);return v!==null?v:(Eg(x,r,c,y,o),sx(b,o,n))}}return function(u,p,f){const y=a in u,b=y?u[a]:l,x=Og(t,y,b,u,p,h);return x!==null?x:(Eg(y,r,c,f,o),sx(b,o,n))}}createSpecializedProcessValueForceValue(e){const{def:t,accessor:i,domain:s,reusableResult:n}=e,o=t.property,a=t.forceValue;if(i){const r=i;return function(c,h,d){let u;try{u=r(c)}catch{}const y=u!=null&&bc(u)?-1*a:a;return n.missing=!1,n.valid=!0,n.value=y,s.extend(y),n}}return function(l,c,h){const d=o in l,u=d?l[o]:void 0,f=d&&bc(u)?-1*a:a;return n.missing=!1,n.valid=!0,n.value=f,s.extend(f),n}}createSpecializedProcessValueProcessor(e,t){const{def:i,accessor:s,domain:n,reusableResult:o,processorFns:a}=e,r=i.property,l="missingValue"in i,c=i.missingValue,h=i.missing,d=i.processor,u=this.createValidationMeta(e);if(s){const p=s;return function(y,b,x){let v;try{v=p(y)}catch{}const S=v!=null,M=Og(t,S,v,y,b,u);if(M!==null)return M;Eg(S,l,h,x,o);let D=a.get(i);return D==null&&(D=d(),a.set(i,D)),v=D(v,b),sx(v,o,n)}}return function(f,y,b){const x=r in f;let v=x?f[r]:c;const S=Og(t,x,v,f,y,u);if(S!==null)return S;Eg(x,l,h,b,o);let M=a.get(i);return M==null&&(M=d(),a.set(i,M)),v=M(v,y),sx(v,o,n)}}createGenericProcessValue(e,t){const{def:i,accessor:s,domain:n,processorFns:o}=e,a=i.property,r="missingValue"in i,l=i.missingValue,c=i.missing,h=t==="extend",d=e.reusableResult,u=this.createValidationMeta(e);return function(f,y,b){let x,v;if(s){try{x=s(f)}catch{}v=x!=null}else v=a in f,x=v?f[a]:l;if(i.forceValue!=null&&(x=v&&bc(x)?-1*i.forceValue:i.forceValue,v=!0),Eg(v,r,c,b,d),i.type==="key"&&x==null)return ix(u,x),d;const M=Og(i.validation,v,x,f,y,u);if(M!==null)return M;if(d.valid=!0,i.processor){let D=o.get(i);D==null&&(D=i.processor(),o.set(i,D)),x=D(x,y)}return h&&n.extend(x),d.value=x,d}}};function gj(e,t){return!e||!t||e.length===0||t.length===0?!0:e.some(i=>t.includes(i))}function TT(e,t){if(e.valueType==="category"){for(const i of t)if(i.property===e.property&&i.valueType===e.valueType&&gj(i.scopes,e.scopes)&&i.validation===e.validation)return i}}var fj=class{constructor(e,t,i){this.ctx=e,this.initializer=t,this.scopeCacheManager=i,this.processValueFactory=new pj(e)}recomputeDomains(e){const t=this.ctx.debug.check()?performance.now():0,i=e[Ng];let s;const n=e[Cl],o=this.setupDefinitionDomains(this.ctx.keys,i,n),a=new Map;for(const h of this.ctx.values){const d=TT(h,this.ctx.keys);d&&a.set(h,d)}const r=this.setupValueDomainsWithSharing(this.ctx.values,i,o,a),l=new Set;for(const[,h]of a){const d=o.get(h);d&&l.add(d)}this.initializeDomainBands(this.ctx.keys,o,h=>{const d=e.keys[h];return Math.max(...Array.from(d.values()).map(u=>u.length))},h=>String(h.property)),this.initializeDomainBands(this.ctx.values,r,h=>e.columns[h].length,h=>String(h.property));const c=new Map;if(i.size>0){s={totalBands:0,dirtyBands:0,totalData:0};for(const h of i.values())if(h instanceof Tg){const d=h.getStats();c.set(h,d),s.totalBands+=d.bandCount,s.dirtyBands+=d.dirtyBandCount,s.totalData=Math.max(s.totalData,d.dataSize)}}if(this.extendDomainsFromData(this.ctx.keys,o,(h,d)=>e.keys[h]?.get(d),h=>h.scopes??[],h=>e.invalidKeys?.get(h)),this.extendDomainsFromData(this.ctx.values,r,(h,d)=>e.columns[h],h=>[Gs(h.scopes)],h=>e.invalidKeys?.get(h),l),e.domain.keys=this.ctx.keys.map(function(d){const u=o.get(d),p=u.getDomain();return On.is(u)&&p[0]>p[1]?[]:p}),e.domain.values=this.ctx.values.map(function(d){const u=r.get(d),p=u.getDomain();return On.is(u)&&p[0]>p[1]?[]:p}),e.type==="grouped"&&(e.domain.groups=e.groups.map(h=>h.keys)),this.collectDomainBandingMetadata(e,o,r,i,c),this.ctx.debug.check()&&t>0){const d=performance.now()-t;if(s&&s.totalBands>0){const u=s.dirtyBands/s.totalBands,p=Math.round(u*s.totalData);this.ctx.debug(`recomputeDomains with banding: ${d.toFixed(2)}ms, bands: ${s.dirtyBands}/${s.totalBands} dirty, data scanned: ~${p}/${s.totalData} (${(u*100).toFixed(1)}%)`)}else this.ctx.debug(`recomputeDomains: ${d.toFixed(2)}ms (no banding)`)}}setupDefinitionDomains(e,t,i){const s=new Map;for(const[n,o]of e.entries()){const a=i?.get(n);s.set(o,this.initializer.setupDomainForDefinition(o,t,a))}return s}initializeDomainBands(e,t,i,s){for(const[n,o]of e.entries()){const a=t.get(o);if(!a)continue;const r=i(n);this.initializer.initializeBandedDomain(a,r,s(o))}}extendDomainsFromData(e,t,i,s,n,o){for(const[a,r]of e.entries()){const l=t.get(r);if(l&&!o?.has(l))for(const c of s(r)){if(!c)continue;const h=i(a,c);if(!h)continue;const d=n(c);this.initializer.extendDomainFromData(l,h,d)}}}setupValueDomainsWithSharing(e,t,i,s){const n=new Map;for(const o of e){const a=s.get(o);if(a){const r=i.get(a);if(r){n.set(o,r);continue}}n.set(o,this.initializer.setupDomainForDefinition(o,t))}return n}initDataDomainProcessor(e){const{keys:t,values:i}=this.ctx,s=new Set;for(const u of i)if(u.scopes)for(const p of u.scopes)s.add(p);const n=new Map,o=new Map;let a=!0;const r=()=>{for(const u of t)u.valueType==="category"?n.set(u,new Nn):n.set(u,new On);for(const u of i){const p=TT(u,t);if(p){const f=n.get(p);if(f){n.set(u,f),a&&(a=(u.scopes?.length??0)===s.size);continue}}u.valueType==="category"?n.set(u,new Nn):(n.set(u,new On),a&&(a=(u.scopes?.length??0)===s.size))}};r();const l=this.scopeCacheManager.buildAccessors(or(t,i)),c=new WeakMap;for(const u of or(t,i)){const p=l.get(u.property),f=n.get(u),y={value:void 0,missing:!1,valid:!1},b=this.processValueFactory.createProcessValueFn(u,p,f,y,o,e);c.set(u,b)}function h(u){const p=c.get(u);if(!p)throw new Error("AG Charts - missing processValue function for definition");return p}function d(u,p,f,y){return h(u)(p,f,y)}return{dataDomain:n,processValue:d,getProcessValue:h,initDataDomain:r,scopes:s,allScopesHaveSameDefs:a}}collectDomainBandingMetadata(e,t,i,s,n){e.optimizations??(e.optimizations={});const o=(l,c)=>l.map(h=>{const d=c.get(h),u=s.get(h),p=d instanceof Tg;let f;p||(f=h.valueType==="category"?"discrete domain":"not configured");let y;if(p&&u){const b=n.get(u)??u.getStats(),x=b.bandCount>0?b.dirtyBandCount/b.bandCount:0;y={totalBands:b.bandCount,dirtyBands:b.dirtyBandCount,dataSize:b.dataSize,scanRatio:x}}return{property:String(h.property),applied:p,reason:f,stats:y}}),a=o(this.ctx.keys,t),r=o(this.ctx.values,i);e.optimizations.domainBanding={keyDefs:a,valueDefs:r}}};function mj(){return{lastValue:void 0,sortOrder:0,isUnique:!0,isOrdered:!0}}function yj(e,t){const i=typeof t=="number"?t:t?.valueOf?.();if(typeof i!="number"||!Number.isFinite(i))return;if(e.lastValue===void 0){e.lastValue=i;return}const s=i-e.lastValue;if(s===0)e.isUnique=!1;else if(e.isOrdered){const n=s>0?1:-1;e.sortOrder===0?e.sortOrder=n:e.sortOrder!==n&&(e.isOrdered=!1)}e.lastValue=i}function xj(e){return{sortOrder:e.isOrdered&&e.sortOrder!==0?e.sortOrder:void 0,isUnique:e.isUnique,isDirty:!1}}var bj=class{constructor(e,t){this.ctx=e,this.domainManager=t,this.markScopeDatumInvalid=function(i,s,n,o,a){for(const r of i){o.has(r)||(o.set(r,Al(s.length,!1)),a.set(r,0));const l=o.get(r);l[n]||(l[n]=!0,a.set(r,a.get(r)+1))}}}extractData(e){const{dataDomain:t,getProcessValue:i,allScopesHaveSameDefs:s}=this.domainManager.initDataDomainProcessor("extend"),{keys:n,values:o}=this.ctx,{invalidData:a,invalidKeys:r,invalidKeyCount:l,invalidDataCount:c,allKeyMappings:h,keySortOrders:d}=this.extractKeys(n,e,i),{columns:u,columnScopes:p,columnNeedValueOf:f,partialValidDataCount:y,maxDataLength:b}=this.extractValues(a,c,o,e,r,i),x=v=>{const S=t.get(v),M=S.getDomain();return On.is(S)&&M[0]>M[1]?[]:M};return{type:"ungrouped",input:{count:b},scopes:new Set(e.keys()),dataSources:e,aggregation:void 0,keys:[...h.values()],columns:u,columnScopes:p,columnNeedValueOf:f,invalidKeys:r,invalidKeyCount:l,invalidData:a,invalidDataCount:c,domain:{keys:n.map(x),values:o.map(x)},defs:{allScopesHaveSameDefs:s,keys:n,values:o},partialValidDataCount:y,time:0,version:0,[VM]:new Map,[Cl]:d,[_M]:new Map,[Ng]:new Map,[$c]:new Map}}extractKeys(e,t,i){const s=new Map,n=new Map,o=new Map,a=new Map,r=new Map,l=new Map;let c,h;const d=e.map(p=>i(p)),u=(p,f)=>{const y=h.get(p);c.set(f,c.get(y)),s.has(y)&&(s.set(f,s.get(y)),n.set(f,n.get(y)),a.set(f,a.get(y)))};for(const[p,f]of e.entries()){const{invalidValue:y,scopes:b}=f,x=d[p];c=new Map,h=new Map,r.set(f,c);const v=mj();for(const S of b??[]){const M=t.get(S)?.data??[];if(h.has(M)){u(M,S);continue}const D=[];c.set(S,D),h.set(M,S);let k,I,A=0;for(let C=0;C<M.length;C++){if(M[C]==null||typeof M[C]!="object"){k??(k=Al(M.length,!1)),I??(I=Al(M.length,!1)),A+=1,k[C]=!0,I[C]=!0,D.push(y);continue}const w=x(M[C],C,S);if(w.valid){D.push(w.value),yj(v,w.value);continue}D.push(y),k??(k=Al(M.length,!1)),I??(I=Al(M.length,!1)),A+=1,k[C]=!0,I[C]=!0}k&&I&&(s.set(S,k),n.set(S,I),o.set(S,A),a.set(S,A))}l.set(p,xj(v))}return{invalidData:n,invalidKeys:s,invalidKeyCount:o,invalidDataCount:a,allKeyMappings:r,keySortOrders:l}}extractValues(e,t,i,s,n,o){let a=0;const r=[],l=[],c=[];let h=0;const d=i.map(u=>o(u));for(const[u,p]of i.entries()){const{invalidValue:f}=p,y=d[u];if(new Set(p.scopes.map(I=>s.get(I))).size>1)throw new Error(`AG Charts - more than one data source for: ${JSON.stringify(p)}`);const x=new Set(p.scopes),v=Gs(p.scopes),S=s.get(v)?.data??[],M=new Array,D=n.get(v);let k=!1;for(let I=0;I<S.length;I++){if(S[I]==null||typeof S[I]!="object"){this.markScopeDatumInvalid(p.scopes,S,I,e,t),M[I]=f;continue}const A=S[I],C=D==null?!1:D[I],w=y(A,I,p.scopes);let T=w.value;(C||!w.valid)&&this.markScopeDatumInvalid(p.scopes,S,I,e,t),C?T=f:w.valid||(a+=1,T=f),!k&&T!=null&&typeof T=="object"&&(k=!0),M[I]=T}r.push(M),l.push(x),c.push(k),h=Math.max(h,M.length)}return{columns:r,columnScopes:l,columnNeedValueOf:c,partialValidDataCount:a,maxDataLength:h}}warnDataMissingProperties(e){if(e.size!==0)for(const t of or(this.ctx.keys,this.ctx.values))for(const[i,s]of t.missing){if(s<(e.get(i)?.data.length??1/0))continue;const n=i==null?"":` for ${i}`;j.warnOnce(`the key '${t.property}' was not found in any data element${n}.`)}}},vj=class{constructor(e){this.ctx=e}groupData(e,t){var i;const{keys:s,columns:n,columnScopes:o,invalidKeys:a,invalidData:r}=e,l=e.scopes,c=[],h=[],d=l.size!==1||t!=null?new Map:void 0;let u=!0,p=0;const f=l.size,y=this.groupBatches(l,n,o,s,r,a),b=y.length;if(this.ctx.debug?.check()&&!e.optimizations&&(e.optimizations={}),this.ctx.debug?.check()){const S=f>0?1-b/f:0;e.optimizations.batchMerging={originalBatchCount:f,mergedBatchCount:b,mergeRatio:S}}const x=y.length===1,v=Object.freeze(Al(y[0][1].length,wT));for(const[S,M,D,k,I,A]of y){const C=n[Gs(M)];for(let w=0;w<C.length;w++){if(A?.[w]===!0)continue;const T=D.map(B=>B[w]);if(T==null||T.length===0)throw new Error("AG Charts - no keys found for scope(s): "+S.join(", "));const O=t?.(T)??T,E=d==null?void 0:FM(O);let z=d?.get(E),F,_,G=!1;if(z==null?(F={keys:O,datumIndices:[],aggregation:[],validScopes:l},_=p++,z=[_,F],G=!0,d?.set(E,z),c.push(F.keys),h.push(F)):([_,F]=z,u=!1),I?.[w]===!0){F.validScopes===l&&(F.validScopes=new Set(l.values()));for(const B of k)F.validScopes.delete(B)}if(G&&w===_&&x)F.datumIndices=v;else{!G&&F.datumIndices===v&&(F.datumIndices=v.map(B=>[...B]));for(const B of M)(i=F.datumIndices)[B]??(i[B]=[]),F.datumIndices[B].push(w-_)}}}return{...e,type:"grouped",domain:{...e.domain,groups:c},groups:h,groupsUnique:u,optimizations:e.optimizations,[Ng]:e[Ng],[$c]:e[$c]}}groupBatches(e,t,i,s,n,o){const a=[],r=new Set;for(const l of e){const c=t.map((f,y)=>y).filter(f=>!r.has(f)&&i[f].has(l));if(c.length===0)continue;for(const f of c)r.add(f);const h=new Set;for(const f of c)for(const y of i[f])h.add(y);const d=s.map(f=>f.get(l)).filter(f=>f!=null),u=n?.get(l),p=o?.get(l);a.push([l,c,d,h,u,p])}return this.mergeCompatibleBatches(a)}areBatchesCompatible(e,t){const[,,i,,s,n]=e,[,,o,,a,r]=t;return i.every((l,c)=>l===o[c])&&n===r&&s===a}mergeCompatibleBatches(e){const t=[],i=new Set;for(let s=0;s<e.length;s++){if(i.has(s))continue;const[n,o,a,r,l,c]=e[s],h=[[n],[...o],a,new Set(r),l,c];this.findAndMergeCompatibleBatches(e,s,h,i),t.push(h),i.add(s)}return t}findAndMergeCompatibleBatches(e,t,i,s){const n=e[t];for(let o=t+1;o<e.length;o++){if(s.has(o))continue;const a=e[o],[r,l,,c]=a;if(this.areBatchesCompatible(n,a)){i[0].push(r),i[1].push(...l);for(const h of c)i[3].add(h);s.add(o)}}}};function NT(e){return e.removedIndices.size===0&&e.totalPrependCount===0&&e.totalAppendCount>0}function Sj(e){return e.removedIndices.size===0&&e.totalAppendCount===0&&e.totalPrependCount>0}function Mj(e){return e.removedIndices.size===0}function Dj(e){return e.removedIndices.size===0&&e.totalPrependCount===0&&e.totalAppendCount===0&&e.spliceOps.every(t=>t.insertCount===0&&t.deleteCount===0)}function Ij(e){return e.removedIndices.size>0&&e.totalPrependCount===0&&e.totalAppendCount===0&&e.spliceOps.every(t=>t.insertCount===0)}function kj(e){const{removedIndices:t}=e;if(t.size===0)return!1;const i=Array.from(t).sort((s,n)=>s-n);if(i[0]!==0)return!1;for(let s=0;s<i.length;s++)if(i[s]!==s)return!1;return!0}function Aj(e){return kj(e)&&e.totalAppendCount>0&&e.totalPrependCount===0}var Cj=class{constructor(e,t){this.indexMap=e,this.prependValues=t.prependValues,this.appendValues=t.appendValues,this.insertionValues=t.insertionValues}getRemovedIndices(){return Array.from(this.indexMap.removedIndices).sort((e,t)=>e-t)}getUpdatedIndices(){return Array.from(this.indexMap.updatedIndices).sort((e,t)=>e-t)}forEachPreservedIndex(e){const{originalLength:t,removedIndices:i,totalPrependCount:s}=this.indexMap;let n=0;const o=Array.from(i).sort((r,l)=>r-l);let a=0;for(let r=0;r<t;r++){for(;a<o.length&&o[a]<r;)n++,a++;if(!i.has(r)){const l=r+s-n;e(r,l)}}}getPrependedValues(){return this.prependValues}getAppendedValues(){return this.appendValues}getInsertionValues(){return this.insertionValues}applyToArray(e,t,i){const{spliceOps:s,finalLength:n,originalLength:o}=this.indexMap;if(!(o===n&&s.length===0)){for(const a of s){const r=a.insertCount>0?Array.from({length:a.insertCount},function(h,d){return t(a.index+d)}):[],l=e.splice(a.index,a.deleteCount,...r);i&&l.length>0&&i(l,a)}e.length!==n&&(e.length=n)}}},Lj=class extends IT{constructor(e={}){super(e),this.lastDirtyBandCount=0,this.lastScanRatio=0,this.statsCaptured=!1}createBand(e,t){return{startIndex:e,endIndex:t,cachedResult:void 0,isDirty:!0}}initializeBands(e){super.initializeBands(e),this.statsCaptured=!1}getBands(){return this.bands}evaluateFromData(e,t,i=!1){const s=e.reducer();for(const n of this.bands){if(i&&!n.isDirty)continue;const o=e.needsOverlap&&n.startIndex>0?Math.max(0,n.startIndex-1):n.startIndex,a=this.evaluateRange(e,s,t,o,n.endIndex);n.cachedResult=a,n.isDirty=!1}}getResult(e){const t=this.bands.map(i=>i.cachedResult);return e.combineResults(t)}evaluateRange(e,t,i,s,n){let o=e.initialValue;const{keyColumns:a,keysParam:r,rawData:l}=i,c=Math.min(n,l.length);for(let h=s;h<c;h+=1){for(let d=0;d<r.length;d++)r[d]=a[d]?.[h];o=t(o,r)}return o}captureStatsBeforeProcessing(){const e=this.bands.filter(i=>i.isDirty),t=e.reduce((i,s)=>i+(s.endIndex-s.startIndex),0);this.lastDirtyBandCount=e.length,this.lastScanRatio=this.dataSize>0?t/this.dataSize:0,this.statsCaptured=!0}getStats(){const e=this.bands.filter(s=>!s.isDirty&&s.cachedResult!==void 0);let t,i;if(this.statsCaptured)t=this.lastDirtyBandCount,i=this.lastScanRatio;else{const s=this.bands.filter(o=>o.isDirty),n=s.reduce((o,a)=>o+(a.endIndex-a.startIndex),0);t=s.length,i=this.dataSize>0?n/this.dataSize:0}return{totalBands:this.bands.length,dirtyBands:t,dataSize:this.dataSize,scanRatio:i,cacheHits:e.length}}},OT=class{constructor(e={}){this.bandingConfig=e}static evaluateRange(e,t,i,s,n){let o=e.initialValue;const{keyColumns:a,keysParam:r,rawData:l}=i,c=Math.min(n,l.length);for(let h=s;h<c;h+=1){for(let d=0;d<r.length;d++)r[d]=a[d]?.[h];o=t(o,r)}return o}evaluate(e,t,i={}){var s;const n=this.createContext(e,t);if(!n)return;t[s=$c]??(t[s]=new Map);const o=t[$c],a=e.property;let r=o.get(a);return r||(r=new Lj(this.bandingConfig),o.set(a,r)),r.getBandCount()===0&&r.initializeBands(n.rawData.length),i.beforeEvaluate?.(r,n),r.captureStatsBeforeProcessing(),r.evaluateFromData(e,n,i.reuseCleanBands??!1),r.getResult(e)}applyIndexMap(e,t){const i=e[$c];if(i)for(const s of i.values())s.applyIndexMap(t)}createContext(e,t){if(t.type!=="ungrouped")return;const i=zM(e)?e.scopes[0]:Gs(t.dataSources.keys());if(i==null)return;const s=t.dataSources.get(i)?.data??[],n=t.keys.map(a=>a.get(i)).filter(a=>a!=null),o=n.map(()=>{});return{scopeId:i,rawData:s,keyColumns:n,keysParam:o}}},wj=class{constructor(e,t){this.ctx=e,this.reducerManager=t}isReprocessingSupported(e){if(e.type==="grouped"){if(!e.groupsUnique||this.getUniqueDataSets(e).size!==1)return!1;const n=Gs(e.scopes);if(e.invalidKeys?.get(n)?.some(a=>a))return!1}return this.ctx.aggregates.length>0||this.ctx.reducers.some(s=>s.supportsBanding!==!0||typeof s.combineResults!="function")||this.ctx.processors.some(s=>s.incrementalCalculate===void 0)||this.ctx.propertyProcessors.length>0?!1:this.ctx.groupProcessors.every(s=>s.supportsReprocessing??!1)}reprocessData(e,t,i,s,n,o){const a=performance.now(),r=this.collectScopeChanges(e,t);if(r.size===0)return e;this.commitPendingTransactions(e);const l=this.buildDefinitionProcessors(this.ctx.keys,i),c=this.buildDefinitionProcessors(this.ctx.values,i),h=this.processAllInsertions(e,r,l,c);this.processAllUpdates(e,r,l,c,h),this.updateBandsForChanges(e,r);const d=this.transformKeysArrays(e,r,h);this.transformColumnsArrays(e,r,h),this.transformInvalidityArrays(e,r,h),this.reprocessBandedReducers(e,r),e.type==="grouped"&&(this.transformGroupsArray(e,r,h),this.ctx.groupProcessors.length>0&&s(e,r)),this.invalidateSortOrdersForChanges(e,r),n(e),this.reprocessProcessors(e),e.reduced?.diff!=null&&r.size>0&&this.generateDiffMetadata(e,r,d),this.updateProcessedDataMetadata(e);const u=performance.now();e.time=u-a,e.version+=1,o(e,"reprocess");const p=tx(r);return e.changeDescription=p.size===1?p.values().next().value:void 0,e}updateBandsForChanges(e,t){const i=e[Ng];if(i.size===0)return;const s=tx(t);for(const n of s){const{indexMap:o}=n;for(const a of i.values())a.applyIndexMap(o)}}reprocessBandedReducers(e,t){if(e.type!=="ungrouped")return;const i=this.ctx.reducers.filter(s=>s.supportsBanding&&typeof s.combineResults=="function");if(i.length!==0){e.reduced??(e.reduced={});for(const s of i){const n=this.reducerManager.evaluate(s,e,{reuseCleanBands:!0,beforeEvaluate:(o,a)=>{if(!a.scopeId)return;const r=t.get(a.scopeId);r&&o.applyIndexMap(r.indexMap)}});n!==void 0&&(e.reduced[s.property]=n)}}}collectScopeChanges(e,t){const i=new Map;for(const[s,n]of e.dataSources){const o=t?.get(n)??n.getChangeDescription();o&&i.set(s,o)}return i}commitPendingTransactions(e){const t=this.getUniqueDataSets(e);for(const i of t)i.commitPendingTransactions()}buildDefinitionProcessors(e,t){return e.map((i,s)=>({def:i,index:s,processValue:t(i)}))}processAllInsertions(e,t,i,s){const n=new Map;for(const[o,a]of t){const r=e.dataSources.get(o);if(!r)continue;const l=this.processInsertionsOnce(o,a,r,i,s);n.set(o,l)}return n}processAllUpdates(e,t,i,s,n){for(const[o,a]of t){const r=e.dataSources.get(o);if(!r)continue;const l=a.getUpdatedIndices();if(l.length===0)continue;let c=n.get(o);c||(c=new Map,n.set(o,c));for(const h of l){if(h<0||h>=r.data.length)continue;const d=this.processDatum(r,h,o,i,s);d&&c.set(h,d)}}}processInsertionsOnce(e,t,i,s,n){const o=new Map,{finalLength:a}=t.indexMap;for(const r of t.indexMap.spliceOps)if(!(r.insertCount<=0))for(let l=0;l<r.insertCount;l++){const c=r.index+l;if(c<0||c>=a)continue;const h=this.processDatum(i,c,e,s,n);h&&o.set(c,h)}return o}processDatum(e,t,i,s,n){const o=e.data[t],a=new Map,r=new Map;let l=!1,c=!1;if(o==null||typeof o!="object")l=!0,c=!0;else{for(const{index:h,def:d,processValue:u}of s){if(!d.scopes?.includes(i))continue;const p=u(o,t,i);a.set(h,{value:p.value,valid:p.valid}),p.valid||(l=!0)}for(const{index:h,def:d,processValue:u}of n){if(!d.scopes?.includes(i))continue;const p=u(o,t,d.scopes);r.set(h,{value:p.value,valid:p.valid}),p.valid||(c=!0)}}return{keys:a,values:r,hasInvalidKey:l,hasInvalidValue:c}}transformArraysWithCache(e,t,i,s,n,o){for(const[a,r]of e.entries())for(const l of n(r)){const c=t.get(l);if(!c)continue;const h=s(a,l);if(!h)continue;const d=i.get(l);this.applyChangeDescWithCache(c,h,d,(u,p)=>o(u,r,a))}}transformKeysArrays(e,t,i){const s=new Map,n=r=>{let l=s.get(r);return l||(l={tuples:[]},s.set(r,l)),l},o=new WeakSet;for(const[r,l]of this.ctx.keys.entries())for(const c of l.scopes??[]){const h=t.get(c);if(!h)continue;const d=e.keys[r]?.get(c);if(!d)continue;if(o.has(d)){const y=Array.from(e.keys[r].entries()).find(([b,x])=>x===d)?.[0];y&&y!==c&&s.has(y)&&s.set(c,s.get(y));continue}o.add(d);const u=i.get(c),p=n(c);let f=0;this.applyChangeDescWithCache(h,d,u,y=>{const b=y?.keys.get(r);return b?.valid?b.value:l.invalidValue},y=>{for(const b of y)p.tuples[f]||(p.tuples[f]=new Array(this.ctx.keys.length)),p.tuples[f][r]=b,f+=1})}const a=new Map;for(const[r,{tuples:l}]of s){if(l.length===0)continue;const c=new Set;for(const h of l){const d=[];for(const[u,p]of h.entries())this.ctx.keys[u].scopes?.includes(r)&&d.push(p);d.length>0&&c.add(FM(d))}a.set(r,c)}return a}transformColumnsArrays(e,t,i){this.transformArraysWithCache(this.ctx.values,t,i,s=>e.columns[s],s=>[Gs(s.scopes)],(s,n,o)=>{if(s){if(s.hasInvalidKey)return n.invalidValue;const a=s.values.get(o);return a?.valid?a.value:n.invalidValue}return n.invalidValue})}transformInvalidityMap(e,t,i,s){const n=new Set;for(const[o,a]of t){let r=e.get(o);if(!r){const c=i.get(o);if(c&&Array.from(c.values()).some(s))r=Al(a.indexMap.originalLength,!1),e.set(o,r);else continue}if(n.has(r))continue;n.add(r);const l=i.get(o);this.applyChangeDescWithCache(a,r,l,(c,h)=>s(c))}}transformInvalidityArrays(e,t,i){e.invalidKeys&&this.transformInvalidityMap(e.invalidKeys,t,i,s=>s?.hasInvalidKey??!1),e.invalidData&&this.transformInvalidityMap(e.invalidData,t,i,s=>s?s.hasInvalidKey||s.hasInvalidValue:!1)}applyChangeDescWithCache(e,t,i,s,n){e.applyToArray(t,a=>{const r=i?.get(a);return s(r,a)},n);const o=e.getUpdatedIndices();if(o.length!==0)for(const a of o){if(a<0||a>=t.length)continue;const r=i?.get(a);t[a]=s(r,a)}}transformGroupsArray(e,t,i){const s=Gs(e.scopes),n=t.get(s);if(!n)return;const o=i.get(s);for(const[,r]of o??[])if(r.hasInvalidKey)throw new Error("AG Charts - reprocessing grouped data with invalid keys not supported. This typically indicates a data quality issue that requires full reprocessing.");n.applyToArray(e.groups,r=>this.createDataGroupForInsertion(r,e,s,o));const a=n.getUpdatedIndices();if(a.length>0)for(const r of a)r<0||r>=e.groups.length||(e.groups[r]=this.createDataGroupForInsertion(r,e,s,o))}createDataGroupForInsertion(e,t,i,s){const n=[];for(const d of t.keys){const u=d.get(i);u&&n.push(u[e])}const o=t.groups[0],a=()=>Object.freeze(Al(t.columnScopes.length,wT)),r=o?.datumIndices??a(),c=s?.get(e)?.hasInvalidValue??!1;let h;return c?(h=new Set(t.scopes),h.delete(i)):h=t.scopes,{keys:n,datumIndices:r,aggregation:[],validScopes:h}}generateDiffMetadata(e,t,i){const s=(n,o)=>{const a=[];for(const r of e.keys){const l=r.get(n);if(!l)return;a.push(l[o])}return a.length>0?FM(a):void 0};for(const[n,o]of t){const a={changed:!0,added:new Set,removed:i.get(n)??new Set,updated:new Set,moved:new Set};for(const c of o.indexMap.spliceOps)if(c.insertCount>0)for(let h=0;h<c.insertCount;h++){const d=c.index+h,u=s(n,d);u&&a.added.add(u)}const{originalLength:r,totalPrependCount:l}=o.indexMap;if(!NT(o.indexMap))if(Sj(o.indexMap)&&r>0)for(let c=l;c<l+r;c++){const h=s(n,c);h&&a.moved.add(h)}else if(Mj(o.indexMap)&&l>0)for(let c=0;c<r;c++){const h=c+l,d=s(n,h);d&&a.moved.add(d)}else o.forEachPreservedIndex((c,h)=>{if(c!==h){const d=s(n,h);d&&a.moved.add(d)}});e.reduced.diff[n]=a}}updateProcessedDataMetadata(e){let t=0;for(const s of e.dataSources.values())t=Math.max(t,s.data.length);e.input.count=t;let i=0;for(const[s,n]of e.invalidData??new Map){const o=e.invalidKeys?.get(s);for(let a=0;a<n.length;a++)n[a]&&!o?.[a]&&(i+=1)}e.partialValidDataCount=i,this.recountInvalid(e.invalidKeys,e.invalidKeyCount),this.recountInvalid(e.invalidData,e.invalidDataCount),this.invalidateCachesForChanges(e)}updateSortOrderForAppend(e,t,i){if(i.length===0)return;const s=a=>{if(typeof a=="number")return a;if(a instanceof Date)return a.valueOf()};let n=s(t);const o=e.sortOrder;for(const a of i){const r=s(a);if(r===void 0)continue;if(n===void 0){n=r;continue}const l=r-n;if(l===0&&(e.isUnique=!1),e.sortOrder!==void 0){let c=0;l>0?c=1:l<0&&(c=-1),c!==0&&c!==o&&(e.sortOrder=void 0)}n=r}}updateKeySortOrdersForAppend(e,t){for(const[i,s]of e.keys.entries()){const n=e[Cl].get(i);if(!n)continue;const o=Gs(s.values());if(!o||o.length<=t)continue;const a=t>0?o[t-1]:void 0,r=o.slice(t);this.updateSortOrderForAppend(n,a,r)}}invalidateSortOrdersForChanges(e,t){const i=tx(t);let s=!0,n=!1,o=!1,a,r;for(const l of i){const{indexMap:c}=l;Dj(c)||(NT(c)?(n=!0,a=c.originalLength):Ij(c)||(Aj(c)?(o=!0,r={originalLength:c.originalLength,removedCount:c.removedIndices.size}):s=!1))}s?n&&a!==void 0?this.updateKeySortOrdersForAppend(e,a):o&&r&&this.updateKeySortOrdersForRollingWindow(e,r):(e[Cl].clear(),e[_M].clear())}updateKeySortOrdersForRollingWindow(e,t){const{originalLength:i,removedCount:s}=t;for(const[n,o]of e.keys.entries()){const a=e[Cl].get(n);if(!a)continue;const r=Gs(o.values());if(!r||r.length===0)continue;const l=i-s,c=l>0?r[l-1]:void 0,h=r.slice(l);this.updateSortOrderForAppend(a,c,h)}}invalidateCachesForChanges(e){this.markDomainRangesDirty(e[VM])}markDomainRangesDirty(e){for(const t of e.values())t.isDirty=!0}recountInvalid(e,t){if(!(!e||!t))for(const[i,s]of e){const n=s.filter(Boolean).length;n===0?(e.delete(i),t.delete(i)):t.set(i,n)}}reprocessProcessors(e){if(this.ctx.processors.length!==0){e.reduced??(e.reduced={});for(const t of this.ctx.processors){const i=e.reduced[t.property],s=t.incrementalCalculate?.(e,i)??t.calculate(e,i);e.reduced[t.property]=s}}}getUniqueDataSets(e){return new Set(e.dataSources.values())}},Uc=0,Kc=1,va=2,Tj=class im{constructor(t){this.isDirty=!1;const i=t.reduce((o,a)=>Math.max(o,a.length),0),{maxLevelSize:s,buffer:n}=im.createBuffer(i);this.maxLevelSize=s,this.buffer=n,this.dataLength=i,this.populateBuffer(t)}static computeMaxLevelSize(t){let s=1<<32-Math.clz32(t);return t===s/2&&(s=s>>>1),s}static createBuffer(t){const i=im.computeMaxLevelSize(t),s=new Float64Array((i*2-1)*2).fill(Number.NaN);return{maxLevelSize:i,buffer:s}}populateBuffer(t){const{maxLevelSize:i,buffer:s}=this,n=i-1;for(const o of t){const a=o.length;for(let r=0;r<a;r+=1){const l=Number(o[r]);if(l!==l)continue;const c=n+r<<1,h=s[c],d=s[c+1];(h!==h||l<h)&&(s[c]=l),(d!==d||l>d)&&(s[c+1]=l)}}for(let o=i>>>1;o>=1;o>>>=1){const a=o-1,r=a+o<<1;let l=a<<1,c=r;for(let h=0;h<o;h+=1){const d=c+2,u=s[c],p=s[d];s[l]=p!==p||u<p?u:p;const f=s[c+1],y=s[d+1];s[l+1]=y!==y||f>y?f:y,l+=2,c+=4}}}rebuild(t){const i=t.reduce((n,o)=>Math.max(n,o.length),0);if(im.computeMaxLevelSize(i)===this.maxLevelSize)this.buffer.fill(Number.NaN);else{const{maxLevelSize:n,buffer:o}=im.createBuffer(i);this.maxLevelSize=n,this.buffer=o}this.dataLength=i,this.populateBuffer(t)}updateValue(t,i){const{maxLevelSize:s,buffer:n}=this,o=s+t-1,a=Math.trunc(o*va)+Uc,r=Math.trunc(o*va)+Kc;n[a]=Number.NaN,n[r]=Number.NaN;for(const l of i){const c=Number(l),h=n[a],d=n[r];(!Number.isFinite(h)||c<h)&&(n[a]=c),(!Number.isFinite(d)||c>d)&&(n[r]=c)}this.propagateUp(o)}updateValues(t){for(const{index:i,values:s}of t)this.updateValue(i,s)}propagateUp(t){const{buffer:i}=this;for(;t>0;){const s=Math.trunc((t-1)/2),n=2*s+1,o=2*s+2,a=i[Math.trunc(n*va)+Uc],r=i[Math.trunc(n*va)+Kc],l=i[Math.trunc(o*va)+Uc],c=i[Math.trunc(o*va)+Kc];i[Math.trunc(s*va)+Uc]=!Number.isFinite(l)||a<l?a:l,i[Math.trunc(s*va)+Kc]=!Number.isFinite(c)||r>c?r:c,t=s}}computeRangeInto(t,i,s,n,o,a,r){const l=o+a-1;if(l<i||o>=s)return r;if(o>=i&&l<s){const c=t[Math.trunc(n*va)+Uc],h=t[Math.trunc(n*va)+Kc];Number.isFinite(c)&&(r[0]=Math.min(r[0],c)),Number.isFinite(h)&&(r[1]=Math.max(r[1],h))}else a>1&&(n=Math.trunc(n*2),a=Math.trunc(a/2),this.computeRangeInto(t,i,s,Math.trunc(n+1),o,a,r),this.computeRangeInto(t,i,s,Math.trunc(n+2),o+a,a,r));return r}rangeBetween(t,i,s){const n=s??[0,0];if(t>i)return n[0]=Number.NaN,n[1]=Number.NaN,n;const{maxLevelSize:o,buffer:a}=this;return n[0]=1/0,n[1]=-1/0,this.computeRangeInto(a,t,i,0,0,o,n),n}getRange(t){const{buffer:i}=this,s=t??[0,0];return s[0]=i[Uc],s[1]=i[Kc],s}get range(){const{buffer:t}=this;return[t[Uc],t[Kc]]}get length(){return this.dataLength}};function Nj(e,t){const i=e.length;if(e.length<=1)return 1;let s=0,n=e[0];for(let o=1;o<i;o++){const a=e[o];if(a==null)continue;if(typeof(t?a.valueOf():a)!="number")return;const l=Math.sign(a-n);if(l!==0){if(s!==0&&s!==l)return;s=l}n=a}return s===0?1:s}var Oj=class{constructor(e){this.ctx=e,this.rangeBetweenBuffer=[0,0]}resolveMissingDataCount(e){let t=0;for(const i of this.ctx.values)t=Math.max(t,i.missing.get(e.id)??0);return t}resolveProcessedDataDefById(e,t){const i=this.ctx.scopeCache.get(e.id)?.get(t);if(!i)throw new Error(`AG Charts - didn't find property definition for [${t}, ${e.id}]`);return{index:i.index,def:i}}resolveProcessedDataIndexById(e,t){return this.resolveProcessedDataDefById(e,t).index}resolveKeysById(e,t,i){const s=this.resolveProcessedDataIndexById(e,t),n=i.keys[s];if(n==null)throw new Error(`AG Charts - didn't find keys for [${t}, ${e.id}]`);return n.get(e.id)}hasColumnById(e,t){return this.ctx.scopeCache.get(e.id)?.get(t)!=null}resolveColumnById(e,t,i){const s=this.resolveProcessedDataIndexById(e,t),n=i.columns?.[s];if(n==null)throw new Error(`AG Charts - didn't find column for [${t}, ${e.id}]`);return n}resolveColumnNeedsValueOf(e,t,i){const s=this.resolveProcessedDataIndexById(e,t);return i.columnNeedValueOf?.[s]??!0}resolveAbsoluteIndex(e,t){return e+t}getDomain(e,t,i,s){return this.getDomainsByType(i??"value",s)?.[this.resolveProcessedDataIndexById(e,t)]??[]}getDomainBetweenRange(e,t,[i,s],n){const o=t.map(d=>this.resolveProcessedDataIndexById(e,d)),a=n.input.count;if(i<=0&&s>=a){const d=n.domain.values;let u=1/0,p=-1/0;for(const f of o){const y=d[f];y!=null&&(y[0]<u&&(u=y[0]),y[1]>p&&(p=y[1]))}return this.rangeBetweenBuffer[0]=u,this.rangeBetweenBuffer[1]=p,this.rangeBetweenBuffer}const r=o.join(":"),l=n[VM],c=o.map(d=>n.columns[d]);let h=l.get(r);return h==null?(h=new Tj(c),l.set(r,h)):h.isDirty&&(h.rebuild(c),h.isDirty=!1),h.rangeBetween(i,s,this.rangeBetweenBuffer)}getSortOrder(e,t,i,s){const n=i.get(t);if(n==null||n.isDirty){const o={sortOrder:Nj(e,s)};return i.set(t,o),o.sortOrder}return n.sortOrder}getKeySortOrder(e,t,i){const s=this.resolveProcessedDataIndexById(e,t),n=i.keys[s]?.get(e.id);return n?this.getSortOrder(n,s,i[Cl],!0):void 0}getKeySortEntry(e,t,i){const s=this.resolveProcessedDataIndexById(e,t),n=i[Cl].get(s);return n?.isDirty?void 0:n}getColumnSortOrder(e,t,i){const s=this.resolveProcessedDataIndexById(e,t),n=i.columnNeedValueOf?.[s]??!0;return this.getSortOrder(i.columns[s],s,i[_M],n)}getDomainsByType(e,t){switch(e){case"key":return t.domain.keys;case"value":return t.domain.values;case"aggregate":return t.domain.aggValues;case"group-value-processor":return t.domain.groups;default:return null}}},Ej=class{constructor(e){this.ctx=e}processScopeCache(){this.ctx.scopeCache.clear();for(const e of or(this.ctx.keys,this.ctx.values,this.ctx.aggregates))if(e.idsMap)for(const[t,i]of e.idsMap)for(const s of i)if(!this.ctx.scopeCache.has(t))this.ctx.scopeCache.set(t,new Map([[s,e]]));else{if(this.ctx.scopeCache.get(t)?.has(s))throw new Error("duplicate definition ids on the same scope are not allowed.");this.ctx.scopeCache.get(t).set(s,e)}}valueGroupIdxLookup({matchGroupIds:e}){const t=[];for(const[i,s]of this.ctx.values.entries())(!e||s.groupId&&e.includes(s.groupId))&&t.push(i);return t}valueIdxLookup(e,t){const i=e==null||e.length===0,s=typeof t=="string"?t:t.id,n=a=>{if(a.idsMap){for(const[r,l]of a.idsMap)if(e?.includes(r)&&l.has(s))return!0}return!1},o=this.ctx.values.reduce((a,r,l)=>((r.scopes==null||i&&!r.scopes.length||r.scopes.some(h=>e?.includes(h)))&&(r.property===s||r.id===s||n(r))&&a.push(l),a),[]);if(o.length===0)throw new Error(`AG Charts - configuration error, unknown property ${JSON.stringify(t)} in scope(s) ${JSON.stringify(e)}`);return o}buildAccessors(e){const t=new Map;if(this.ctx.suppressFieldDotNotation)return t;for(const i of e){if(!(i.property.includes(".")||i.property.includes("[")))continue;const n=cj(i.property);if(n==null){j.warnOnce("Invalid property path [%s]",i.property);continue}const o=hj(n);t.set(i.property,o)}return t}},HM=class{constructor(e,t="standalone",i=!1,s){this.opts=e,this.mode=t,this.suppressFieldDotNotation=i,this.eventsHub=s,this.debug=Me.create(!0,"data-model"),this.scopeCache=new Map,this.keys=[],this.values=[],this.aggregates=[],this.groupProcessors=[],this.propertyProcessors=[],this.reducers=[],this.processors=[];let n=!0;for(const c of e.props){if(c.type==="key"&&!n)throw new Error("AG Charts - internal config error: keys must come before values.");c.type==="value"&&n&&(n=!1)}const o=({matchGroupIds:c=[]})=>{for(const h of c)if(this.values.every(d=>d.groupId!==h))throw new Error(`AG Charts - internal config error: matchGroupIds properties must match defined groups (${h}).`)},a=new Set,r=new Set;for(const c of e.props){const h=c.type==="key"?a:r;if(zM(c)&&c.scopes)for(const d of c.scopes)h.add(d);switch(c.type){case"key":this.keys.push({...c,index:this.keys.length,missing:new Map});break;case"value":if(c.property==null)throw new Error(`AG Charts - internal config error: no properties specified for value definitions: ${JSON.stringify(c)}`);this.values.push({...c,index:this.values.length,missing:new Map});break;case"aggregate":o(c),this.aggregates.push({...c,index:this.aggregates.length});break;case"group-value-processor":o(c),this.groupProcessors.push({...c,index:this.groupProcessors.length});break;case"property-value-processor":this.propertyProcessors.push({...c,index:this.propertyProcessors.length});break;case"reducer":this.reducers.push({...c,index:this.reducers.length});break;case"processor":this.processors.push({...c,index:this.processors.length});break}}if(this.opts.groupByKeys||this.opts.groupByFn!=null){const c=new Set(r.values());for(const h of a)c.delete(h);if(c.size>0)throw new Error(`AG Charts - scopes missing key for grouping, illegal configuration: ${[...c.values()]}`)}const l={keys:this.keys,values:this.values,aggregates:this.aggregates,groupProcessors:this.groupProcessors,propertyProcessors:this.propertyProcessors,reducers:this.reducers,processors:this.processors,debug:this.debug,mode:this.mode,bandingConfig:this.opts.domainBandingConfig,suppressFieldDotNotation:this.suppressFieldDotNotation,scopeCache:this.scopeCache};this.resolvers=new Oj(l),this.scopeCacheManager=new Ej(l),this.domainInitializer=new uj(l),this.domainManager=new fj(l,this.domainInitializer,this.scopeCacheManager),this.reducerManager=new OT(this.opts.domainBandingConfig),this.dataExtractor=new bj(l,this.domainManager),this.dataGrouper=new vj(l),this.aggregator=new dj(l,this.scopeCacheManager,this.resolvers),this.incrementalProcessor=new wj(l,this.reducerManager)}resolveProcessedDataDefById(e,t){return this.resolvers.resolveProcessedDataDefById(e,t)}resolveProcessedDataIndexById(e,t){return this.resolvers.resolveProcessedDataIndexById(e,t)}resolveKeysById(e,t,i){return this.resolvers.resolveKeysById(e,t,i)}hasColumnById(e,t){return this.resolvers.hasColumnById(e,t)}resolveColumnById(e,t,i){return this.resolvers.resolveColumnById(e,t,i)}resolveColumnNeedsValueOf(e,t,i){return this.resolvers.resolveColumnNeedsValueOf(e,t,i)}resolveMissingDataCount(e){return this.resolvers.resolveMissingDataCount(e)}*forEachDatum(e,t,i,s){const n=t.columnScopes.findIndex(o=>o.has(e.id));for(const o of i.datumIndices[n]??[]){const a=this.resolvers.resolveAbsoluteIndex(s,o);yield t.columns[n][a]}}getUniqueDataSets(e){return new Set(e.dataSources.values())}*forEachGroupDatum(e,t){const i=t.columnScopes.findIndex(o=>o.has(e.id)),s={groupIndex:0,columnIndex:i},n=[];for(const o of t.groups){s.group=o;for(const a of o.datumIndices[i]??n)s.datumIndex=this.resolvers.resolveAbsoluteIndex(s.groupIndex,a),yield s;s.groupIndex++}}getDomain(e,t,i,s){const n=this.resolvers.getDomain(e,t,i,s);if(i==="key"&&n.length>0){const o=this.getKeySortMetadata(e,t,s);return{domain:n,sortMetadata:o}}return{domain:n}}getDomainBetweenRange(e,t,[i,s],n){return this.resolvers.getDomainBetweenRange(e,t,[i,s],n)}getKeySortOrder(e,t,i){return this.resolvers.getKeySortOrder(e,t,i)}getColumnSortOrder(e,t,i){return this.resolvers.getColumnSortOrder(e,t,i)}getKeySortMetadata(e,t,i){const s=this.resolvers.getKeySortEntry(e,t,i);if(s?.sortOrder!=null)return{sortOrder:s.sortOrder,isUnique:s.isUnique}}processData(e){const{opts:{groupByKeys:t,groupByFn:i},aggregates:s,groupProcessors:n,reducers:o,processors:a,propertyProcessors:r}=this,l=performance.now();if(t&&this.keys.length===0)return;let c=this.extractData(e);t?c=this.dataGrouper.groupData(c):i&&(c=this.dataGrouper.groupData(c,i(c))),n.length>0&&c.type==="grouped"&&this.aggregator.postProcessGroups(c),s.length>0&&c.type==="ungrouped"?this.aggregator.aggregateUngroupedData(c):s.length>0&&c.type==="grouped"&&this.aggregator.aggregateGroupedData(c),r.length>0&&this.postProcessProperties(c),o.length>0&&this.reduceData(c),a.length>0&&this.postProcessData(c),this.warnDataMissingProperties(e);const h=performance.now();return c.time=h-l,c.version+=1,this.collectOptimizationMetadata(c,"full-process"),this.debug.check()&&Pj(c),this.processScopeCache(),c}isReprocessingSupported(e){return this.incrementalProcessor.isReprocessingSupported(e)}reprocessData(e,t){if(!this.isReprocessingSupported(e)){this.debug.check()&&this.debug("Falling back to full reprocessing - incremental not supported for current configuration");const s=this.getUniqueDataSets(e);for(const n of s)n.commitPendingTransactions();return this.processData(e.dataSources)}const{getProcessValue:i}=this.initDataDomainProcessor("skip");return this.incrementalProcessor.reprocessData(e,t,i,this.reprocessGroupProcessors.bind(this),this.recomputeDomains.bind(this),this.collectOptimizationMetadata.bind(this))}recomputeDomains(e){this.domainManager.recomputeDomains(e)}warnDataMissingProperties(e){this.dataExtractor.warnDataMissingProperties(e)}processScopeCache(){this.scopeCacheManager.processScopeCache()}valueGroupIdxLookup(e){return this.scopeCacheManager.valueGroupIdxLookup(e)}valueIdxLookup(e,t){return this.scopeCacheManager.valueIdxLookup(e,t)}extractData(e){return this.dataExtractor.extractData(e)}reprocessGroupProcessors(e,t){const{groupProcessors:i}=this,{columns:s}=e;for(const o of i)if(!o.supportsReprocessing)throw new Error("AG Charts - attempted to reprocess group processor that does not support reprocessing. This is an internal error that should not occur.");const n=tx(t);for(const o of i){const a=this.valueGroupIdxLookup(o),r=o.adjust()();for(const l of n){const{indexMap:c}=l;for(const h of c.spliceOps)if(h.insertCount>0)for(let d=0;d<h.insertCount;d++){const u=h.index+d,p=e.groups[u];r(s,a,p,u)}}}}postProcessProperties(e){for(const{adjust:t,property:i,scopes:s}of this.propertyProcessors)for(const n of this.valueIdxLookup(s,i))t()(e,n)}reduceData(e){e.reduced??(e.reduced={});for(const t of this.reducers)this.shouldUseReducerBanding(t,e)?e.reduced[t.property]=this.reduceWithBands(t,e):e.reduced[t.property]=this.reduceStandard(t,e)}shouldUseReducerBanding(e,t){return t.type==="ungrouped"&&e.supportsBanding===!0&&typeof e.combineResults=="function"}reduceWithBands(e,t){const i=this.reducerManager.evaluate(e,t,{reuseCleanBands:!1});return i===void 0?this.reduceStandard(e,t):i}reduceStandard(e,t){const i=e.reducer();if(t.type==="grouped"){let r=e.initialValue;for(const l of t.groups)r=i(r,l.keys);return r}const s=zM(e)?e.scopes[0]:Gs(t.scopes);if(s==null)return e.initialValue;const n=t.dataSources.get(s)?.data??[],o=t.keys.map(r=>r.get(s)).filter(r=>r!=null),a=o.map(()=>{});return OT.evaluateRange(e,i,{rawData:n,keyColumns:o,keysParam:a},0,n.length)}postProcessData(e){e.reduced??(e.reduced={});for(const i of this.processors)e.reduced[i.property]=i.calculate(e,e.reduced[i.property]);const{diff:t}=e.reduced;t&&this.eventsHub?.emit("datamodel:diff",{diff:t})}initDataDomainProcessor(e){return this.domainManager.initDataDomainProcessor(e)}collectOptimizationMetadata(e,t){const i=e.optimizations?.domainBanding,s=e[$c];this.reducers.length>0&&s&&this.collectReducerBandingMetadata(e,s);const n=e.optimizations?.reducerBanding;e.optimizations={performance:{processingTime:e.time,pathTaken:t},...i&&{domainBanding:i},...n&&{reducerBanding:n}};const o=this.isReprocessingSupported(e),a=t==="reprocess";let r;if(!o){const l=[];if(e.type==="grouped"){e.groupsUnique||l.push("groupsUnique=false"),this.getUniqueDataSets(e).size!==1&&l.push("multiple data sources");const h=Gs(e.scopes);e.invalidKeys?.get(h)?.some(u=>u)&&l.push("has invalid keys")}this.aggregates.length>0&&l.push("has aggregates"),this.reducers.filter(c=>!c.supportsBanding).length>0&&l.push("has reducers"),this.processors.filter(c=>c.incrementalCalculate===void 0).length>0&&l.push("has processors"),this.propertyProcessors.length>0&&l.push("has property processors"),r=l.length>0?l.join(", "):void 0}if(e.optimizations.reprocessing={applied:a,reason:r},e.type==="grouped"){let l=0;const c=e.groups[0];if(c){const h=c.datumIndices;for(const d of e.groups)d.datumIndices===h&&l++}e.optimizations.sharedDatumIndices={applied:l>0,sharedGroupCount:l,totalGroupCount:e.groups.length}}}collectReducerBandingMetadata(e,t){if(this.reducers.length===0)return;e.optimizations??(e.optimizations={});const i=[];for(const s of this.reducers){const n=t.get(s.property),o=this.shouldUseReducerBanding(s,e)&&n!=null;let a;o||(s.supportsBanding!==!0?a="reducer does not support banding":e.type!=="ungrouped"?a="grouped data not supported":s.combineResults===void 0?a="missing combineResults function":a="banding not applied");let r;o&&n&&(r=n.getStats()),i.push({property:String(s.property),applied:o,reason:a,stats:r})}e.optimizations.reducerBanding={reducers:i}}buildAccessors(e){return this.scopeCacheManager.buildAccessors(e)}};function Pj(e){const t=(i,s)=>{s.length>0&&(j.log(`DataModel.processData() - ${i}`),j.table(s))};if(j.log("DataModel.processData() - processedData",e),t("Key Domains",e.domain.keys),t("Value Domains",e.domain.values),t("Aggregate Domains",e.domain.aggValues??[]),e.optimizations){j.log("DataModel.processData() - Optimization Summary");const i=e.optimizations;if(i.performance&&j.log(`  Performance: ${i.performance.processingTime.toFixed(2)}ms (${i.performance.pathTaken})`),i.reprocessing){const s=i.reprocessing.applied?"\u2713":"\u2717",n=i.reprocessing.reason?` (${i.reprocessing.reason})`:"";j.log(`  Reprocessing: ${s}${n}`)}if(i.domainBanding){const s=i.domainBanding.keyDefs.filter(r=>r.applied),n=i.domainBanding.valueDefs.filter(r=>r.applied),o=s.length+n.length,a=i.domainBanding.keyDefs.length+i.domainBanding.valueDefs.length;if(o>0){j.log(`  Domain Banding: \u2713 (${o}/${a} definitions)`);for(const r of[...s,...n])if(r.stats){const l=(r.stats.scanRatio*100).toFixed(1);j.log(`    ${r.property}: scanned ${r.stats.dirtyBands}/${r.stats.totalBands} bands (${l}%)`)}}else{const r=[...i.domainBanding.keyDefs.filter(c=>!c.applied).map(c=>c.reason),...i.domainBanding.valueDefs.filter(c=>!c.applied).map(c=>c.reason)],l=[...new Set(r)].join(", ");j.log(`  Domain Banding: \u2717 (${l})`)}}if(i.sharedDatumIndices){const s=i.sharedDatumIndices.applied?"\u2713":"\u2717",n=`${i.sharedDatumIndices.sharedGroupCount}/${i.sharedDatumIndices.totalGroupCount}`;j.log(`  Shared DatumIndices: ${s} (${n} groups)`)}if(i.batchMerging){const s=(i.batchMerging.mergeRatio*100).toFixed(0),n=`${i.batchMerging.originalBatchCount} \u2192 ${i.batchMerging.mergedBatchCount}`;j.log(`  Batch Merging: ${n} (${s}% reduction)`)}}}var ET=1e3;function PT(e,t,i){const s=e.filter(n=>typeof n=="number"&&Number.isFinite(n));return s.length>0?i(s):t}function lo(e){return e.input.count<=ET}function RT(e){return e!=null&&Bc(e)}function Rj(e){return e!=null}function FT(e){switch(e){case"number":case"log":case"time":case"unit-time":case"ordinal-time":case"color":return RT;default:return Rj}}function zT(e){switch(e){case"number":case"log":case"time":case"color":return"range";default:return"category"}}function Ll(e,t,i={}){return{property:e,type:"key",valueType:zT(t),validation:FT(t),...i}}function Ct(e,t,i={}){return{property:e,type:"value",valueType:zT(t),validation:FT(t),...i}}function Fj(e,t={}){return{property:e,type:"value",valueType:"range",missingValue:1,processor:function(){return function(){return 1}},...t}}var zj=function(e){return e};function BT(...e){const t=e.filter(i=>i!=null);return t.length===0?()=>zj:t.length===1?t[0]:function(){const s=t.map(n=>n());return function(o,a){return s.reduce((r,l)=>l(r,a),o)}}}function Bj(e,t={}){const{min:i=-1/0,max:s=1/0,processor:n,...o}=t;return{type:"value",property:e,valueType:"range",validation:RT,processor:BT(n,function(){return function(l){return $e(l)?ge(i,l,s):l}}),...o}}function jM(e,t,i={}){const{onlyPositive:s,processor:n,...o}=i;return{...Ct(e,t,o),processor:BT(n,rj(s))}}function _j(e,t,i={}){return{...Ct(e,t,i),processor:lj()}}function Pg(e,t,i,s){return[Ct(e,s,i),Yj(i.groupId,t,i.separateNegative),...i.rangeId==null?[]:[oj(i.rangeId,i.groupId)]]}var _T={type:"reducer",property:"smallestKeyInterval",initialValue:1/0,reducer(){let e=Number.NaN;return function(i,s){const n=s[0],o=typeof n=="number"?n:Number(n);if(!Number.isFinite(o))return i;const a=e;if(e=o,!Number.isFinite(e))return i;const r=Math.abs(o-a),l=i??1/0;return r>0&&r<l?r:l}},supportsBanding:!0,combineResults(e){return PT(e,1/0,t=>Math.min(...t))},needsOverlap:!0},VT={type:"reducer",property:"largestKeyInterval",initialValue:-1/0,reducer(){let e=Number.NaN;return function(i,s){const n=s[0],o=typeof n=="number"?n:Number(n);if(!Number.isFinite(o))return i;const a=e;if(e=o,!Number.isFinite(e))return i;const r=Math.abs(o-a),l=i??-1/0;return r>0&&r>l?r:l}},supportsBanding:!0,combineResults(e){return PT(e,-1/0,t=>Math.max(...t))},needsOverlap:!0},Vj={type:"processor",property:"sortedGroupDomain",calculate:function({domain:{groups:t}}){return t?.slice().sort((i,s)=>{for(let n=0;n<i.length;n++){const o=i[n]-s[n];if(o!==0)return o}return 0})}};function Gj({normaliseTo:e}){const t=(i,s)=>{if(s===0)return 0;const n=(i??0)*e/s;return n>=0?Math.min(e,n):Math.max(-e,n)};return()=>()=>(i,s,n,o)=>{const a=Hj(i,s,n,o);for(const r of s){const l=n.datumIndices[r];if(l!=null)for(const c of l){const h=o+c,d=i[r],u=d[h];if(u==null){d[h]=void 0;continue}d[h]=t(u,a)}}}}function Hj(e,t,i,s){const n=[0,0];for(const o of t){const a=e[o],r=i.datumIndices[o];if(r!=null)for(const l of r){const c=s+l,h=a[c];if(h==null)continue;const d=typeof h=="number"?h:Math.max(...h.map(p=>p??0)),u=d<0?0:1;u===0?n[u]=Math.min(n[u],d):n[u]=Math.max(n[u],d)}}return Math.max(Math.abs(n[0]),n[1])}function nx(e,t){return{type:"group-value-processor",matchGroupIds:e,adjust:Ed({normaliseTo:t},Gj)}}function jj({normaliseTo:e,zeroDomain:t,rangeMin:i,rangeMax:s}){const n=e[1]-e[0],o=function(r,l,c){const h=e[0]+(r-l)/c*n;return c===0?t:h>=e[1]?e[1]:h<e[0]?e[0]:h};return function(){return function(l,c){let[h,d]=l.domain.values[c];i!=null&&(h=i),s!=null&&(d=s);const u=d-h;l.domain.values[c]=[e[0],e[1]];const p=l.columns[c];for(let f=0;f<p.length;f+=1)p[f]=o(p[f],h,u)}}}function WM(e,t,i,s,n){return{type:"property-value-processor",property:e,adjust:Ed({normaliseTo:t,rangeMin:s,rangeMax:n,zeroDomain:i},jj)}}var Rg=1,ox=2;function Wj(e,t,i){let s=Rg|ox;if(e.valueType==="category")return t.length<i.length&&(s&=~Rg),s;let n=i[0]?.valueOf();for(let o=1;s!==0&&o<i.length;o++){const a=i[o]?.valueOf();(!Number.isFinite(a)||n>a)&&(s&=~ox),Number.isFinite(a)&&n===a&&(s&=~Rg),n=a}return s}function $j(e){return function(i,s){if(!lo(i))return;const{keys:n,values:o}=i.defs,{input:a,domain:{values:r},columns:l}=i;let c=!0,h=!0;if(a.count!==0){const d=i[Cl];for(let u=0;(c||h)&&u<n.length;u++){const p=n[u],f=d.get(u);if(p.valueType==="category"){const y=i.domain.keys[u]?.length??0,b=i.keys[u]?.values().next().value?.length??0;y<b&&(c=!1)}else f&&(f.isUnique===!1&&(c=!1),f.sortOrder!==1&&(h=!1))}if(e&&e.length>0){let u=Rg|ox;for(let p=0;u!==0&&p<o.length;p++){const f=o[p];e.includes(f.id)&&(u&=Wj(f,r[p],l[p]))}u&Rg||(c=!1),u&ox||(h=!1)}}return{uniqueKeys:c,orderedKeys:h}}}function Uj(){return{uniqueKeys:!0,orderedKeys:!1}}function Fg(e){return{type:"processor",property:"animationValidation",calculate:Ed(e,$j),incrementalCalculate:Uj}}function Kj({mode:e,separateNegative:t}){return function(){return function(){return function(o,a,r,l){const c=[0,0];for(const h of a){const d=r.datumIndices[h];if(d==null)continue;const u=c[0],p=c[1],f=o[h];let y=!1;for(const b of d){const x=l+b,v=f[x];if(!$e(v))continue;const S=t&&bc(v),M=S?u:p;if(e==="normal"?f[x]=M+v:f[x]=M,!y){const D=S?0:1;c[D]=M+v,y=!0}}}}}}}function Yj(e,t,i=!1){const s=Ed({mode:t,separateNegative:i},Kj);return{type:"group-value-processor",matchGroupIds:[e],adjust:s,supportsReprocessing:!0}}function GT(e){return e.id??e.property}function Zj(e,t,i){const s=new Map,n=t.defs.values;for(let r=0;r<n.length;r+=1){const l=n[r];if(l.scopes?.includes(e)===!1)continue;const c=GT(l);if(s.has(c))return;s.set(c,r)}const o=[],a=i.defs.values;for(let r=0;r<a.length;r+=1){const l=a[r];if(l.scopes?.includes(e)===!1)continue;const c=GT(l),h=s.get(c);if(h==null)return;s.delete(c),o.push({previousIndex:h,nextIndex:r})}if(s.size===0)return o}function $M(e,t,i,s,n){for(const{previousIndex:o,nextIndex:a}of i){const r=e[o],l=t[a],c=r[s],h=l[n];if(c!==h)return!1}return!0}function ax(e,t,i=!0){return{type:"processor",property:"diff",calculate(s,n){if(!lo(s))return;const o=new Map,a=new Map,r=new Map,l=new Map,c=t.keys.map(x=>x.get(e)),h=s.keys.map(x=>x.get(e)),d=t.columns,u=s.columns,p=Zj(e,t,s);if(p==null)return n;const f=Math.max(t.input.count,s.input.count);for(let x=0;x<f;x++){const v=x<t.input.count,S=x<s.input.count,M=v?BM(c,x):void 0,D=M==null?"":cs(...M),k=S?BM(h,x):void 0,I=k==null?"":cs(...k);if(S&&v&&D===I){$M(d,u,p,x,x)||r.set(I,x);continue}const A=l.get(I);A!=null?((i||!$M(d,u,p,A,x))&&(r.set(I,x),o.set(I,x)),l.delete(I)):S&&a.set(I,x);const C=a.get(D);C!=null?((i||!$M(d,u,p,C,x))&&(r.set(D,x),o.set(D,x)),a.delete(D)):v&&(r.delete(D),l.set(D,x))}const b={changed:a.size>0||r.size>0||l.size>0,added:new Set(a.keys()),updated:new Set(r.keys()),removed:new Set(l.keys()),moved:new Set(o.keys())};return{...n,[e]:b}}}}function cs(...e){if(e.length===1){const t=Mg(e[0]);if(typeof t=="boolean"||typeof t=="number"||typeof t=="string")return t}return e.map(t=>Mg(t)).join("___")}var HT=class{constructor(e){this.maxAnimationTime=e,this.debug=Me.create(!0,"animation"),this.controllers=new Map,this.stoppedCbs=new Set,this.currentPhase=0,this.phases=new Map(wg.map(t=>[t,[]])),this.skipAnimations=!1,this.animationTimeConsumed=0,this.isReady=!1}get size(){return this.controllers.size}get consumedTimeMs(){return this.animationTimeConsumed}isActive(){return this.controllers.size>0}getActiveControllers(){return this.phases.get(wg[this.currentPhase])??[]}checkOverlappingId(e){e!=null&&this.controllers.has(e)&&(this.controllers.get(e).stop(),this.debug(`Skipping animation batch due to update of existing animation: ${e}`),this.skip())}addAnimation(e){if(e.isComplete)return;if(wg.indexOf(e.phase)<this.currentPhase){this.debug("Skipping animation due to being for an earlier phase",e.id),e.stop();return}this.controllers.set(e.id,e),this.phases.get(e.phase)?.push(e)}removeAnimation(e){this.controllers.delete(e.id);const t=this.phases.get(e.phase),i=t?.indexOf(e);i!=null&&i>=0&&t?.splice(i,1)}progress(e){if(!this.isReady)return;let t=e===0?.01:e;const i=()=>{const c=wg[this.currentPhase];return{phaseControllers:[...this.getActiveControllers()],phase:c,phaseMeta:ex[c]}};let{phase:s,phaseControllers:n,phaseMeta:o}=i();const a=()=>wg[this.currentPhase]==null,r=()=>{for({phase:s,phaseControllers:n,phaseMeta:o}=i();!a()&&n.length===0;)this.currentPhase++,{phase:s,phaseControllers:n,phaseMeta:o}=i(),this.debug(`AnimationBatch - phase changing to ${s}`,{unusedTime:t},n)},l=this.controllers.size;this.debug(`AnimationBatch - ${e}ms; phase ${s} with ${n?.length} of ${l}`);do{const c=t,h=o.skipIfNoEarlierAnimations&&this.animationTimeConsumed===0;let d=0;for(const u of n)h?u.stop():t=Math.min(u.update(c),t),u.isComplete&&(d++,this.removeAnimation(u));this.animationTimeConsumed+=c-t,this.debug(`AnimationBatch - updated ${n.length} controllers; ${d} completed`,n),this.debug(`AnimationBatch - animationTimeConsumed: ${this.animationTimeConsumed}`),r()}while(t>0&&!a());this.animationTimeConsumed>this.maxAnimationTime&&(this.debug("Animation batch exceeded max animation time, skipping",[...this.controllers]),this.stop())}ready(){if(this.isReady)return;this.isReady=!0,this.debug(`AnimationBatch - ready; skipped: ${this.skipAnimations}`,[...this.controllers]);let e=!0;for(const[,t]of this.controllers)if(t.duration>0&&ex[t.phase].skipIfNoEarlierAnimations!==!0){e=!1;break}if(!e)for(const[,t]of this.controllers)t.autoplay&&t.play(!0)}skip(e=!0){if(this.skipAnimations===!1&&e===!0){for(const t of this.controllers.values())t.stop();this.controllers.clear()}this.skipAnimations=e}play(){for(const e of this.controllers.values())e.play()}stop(){for(const e of this.controllers.values())try{e.stop(),this.removeAnimation(e)}catch(t){j.error("Error during animation stop",t)}this.dispatchStopped()}stopByAnimationId(e){if(e!=null&&this.controllers.has(e)){const t=this.controllers.get(e);t&&(t.stop(),this.removeAnimation(t))}}stopByAnimationGroupId(e){for(const t of this.controllers.values())t.groupId===e&&this.stopByAnimationId(t.id)}dispatchStopped(){for(const e of this.stoppedCbs)e();this.stoppedCbs.clear()}isSkipped(){return this.skipAnimations}getRemainingTime(e){if(!this.isActive())return 0;let t=0;for(const[i,s]of this.phases)s.length!==0&&(e!=null&&e!==i||(t+=Math.max(...s.map(n=>n.isComplete?0:n.delay+n.duration-(n.elapsed??0)))));return t}destroy(){this.stop(),this.controllers.clear()}},jT=(e=>(e[e.Default=32]="Default",e[e.ZoomDrag=16]="ZoomDrag",e[e.Annotations=8]="Annotations",e[e.ContextMenu=4]="ContextMenu",e[e.Animation=2]="Animation",e[e.AnnotationsSelected=1]="AnnotationsSelected",e[e.Clickable=41]="Clickable",e[e.Focusable=34]="Focusable",e[e.Keyable=43]="Keyable",e[e.ContextMenuable=36]="ContextMenuable",e[e.AnnotationsMoveable=9]="AnnotationsMoveable",e[e.AnnotationsDraggable=57]="AnnotationsDraggable",e[e.ZoomDraggable=50]="ZoomDraggable",e[e.ZoomClickable=34]="ZoomClickable",e[e.ZoomWheelable=59]="ZoomWheelable",e[e.All=63]="All",e))(jT||{}),WT=class{constructor(){this.stateQueue=34}pushState(e){this.stateQueue|=e}popState(e){this.stateQueue&=~e}isState(e){return!!(this.stateQueue&-this.stateQueue&e)}};function $T(e){return e==null?!0:!Number.isNaN(e)&&e>=0&&e<=2}var Xj=class{constructor(e,t){this.interactionManager=e,this.chartUpdateMutex=t,this.defaultDuration=1e3,this.maxAnimatableItems=ET,this.batch=new HT(this.defaultDuration*1.5),this.debug=Me.create(!0,"animation"),this.events=new Sn,this.rafAvailable=typeof requestAnimationFrame<"u",this.isPlaying=!0,this.requestId=null,this.skipAnimations=!0,this.currentAnonymousAnimationId=0,this.cumulativeAnimationTime=0}addListener(e,t){return this.events.on(e,t)}animate(e){const t=this.batch;try{t.checkOverlappingId(e.id)}catch(r){this.failsafeOnError(r);return}let{id:i}=e;i==null&&(i=`__${this.currentAnonymousAnimationId}`,this.currentAnonymousAnimationId+=1);const s=this.isSkipped()||e.phase==="none";s&&this.debug("AnimationManager - skipping animation");const{delay:n,duration:o}=e;if(!$T(n))throw new Error(`Animation delay of ${n} is unsupported (${i})`);if(!$T(o))throw new Error(`Animation duration of ${o} is unsupported (${i})`);const a=new YH({...e,id:i,skip:s,autoplay:this.isPlaying?e.autoplay:!1,phase:e.phase,defaultDuration:this.defaultDuration});if(!this.forceTimeJump(a,this.defaultDuration))return this.batch.addAnimation(a),a}play(){if(!this.isPlaying){this.isPlaying=!0,this.debug("AnimationManager.play()");try{this.batch.play()}catch(e){this.failsafeOnError(e)}this.requestAnimation()}}stop(){this.isPlaying=!1,this.cancelAnimation(),this.debug("AnimationManager.stop()"),this.batch.stop()}stopByAnimationId(e){try{this.batch.stopByAnimationId(e)}catch(t){this.failsafeOnError(t)}}stopByAnimationGroupId(e){try{this.batch.stopByAnimationGroupId(e)}catch(t){this.failsafeOnError(t)}}reset(){this.isPlaying?(this.stop(),this.play()):this.stop()}skip(e=!0){this.skipAnimations=e}isSkipped(){return!this.rafAvailable||this.skipAnimations||this.batch.isSkipped()}isActive(){return this.isPlaying&&this.batch.isActive()}getRemainingTime(e){return this.batch.getRemainingTime(e)}getCumulativeAnimationTime(){return this.cumulativeAnimationTime}skipCurrentBatch(){this.debug.check()&&this.debug("AnimationManager - skipCurrentBatch()",{stack:new Error("Stack trace for animation skip tracking").stack}),this.batch.skip()}isSkippingFrames(){return!0}scheduleAnimationFrame(e){this.requestId=Ve().requestAnimationFrame(t=>{e(t).catch(i=>j.error(i))})}forceTimeJump(e,t){return!1}requestAnimation(){if(!this.rafAvailable||!this.batch.isActive()||this.requestId!==null)return;let e;const t=async i=>{await this.debug.group("AnimationManager.onAnimationFrame()",async()=>{const s=()=>{const n=i-(e??i);e=i,this.debug("AnimationManager",{controllersCount:this.batch.size,deltaTime:n}),this.interactionManager.pushState(2);try{this.batch.progress(n),this.cumulativeAnimationTime+=n}catch(o){this.failsafeOnError(o)}this.events.emit("animation-frame",{type:"animation-frame",deltaMs:n})};this.isSkippingFrames()?await this.chartUpdateMutex.acquireImmediately(s):await this.chartUpdateMutex.acquire(s),this.batch.isActive()?this.scheduleAnimationFrame(t):(this.batch.stop(),this.events.emit("animation-stop",{type:"animation-stop",deltaMs:this.batch.consumedTimeMs}))})};this.events.emit("animation-start",{type:"animation-start",deltaMs:0}),this.scheduleAnimationFrame(t)}cancelAnimation(){this.requestId!==null&&(cancelAnimationFrame(this.requestId),this.events.emit("animation-stop",{type:"animation-stop",deltaMs:this.batch.consumedTimeMs}),this.requestId=null,this.startBatch())}failsafeOnError(e,t=!0){j.error("Error during animation, skipping animations",e),t&&this.cancelAnimation()}startBatch(e){this.debug(`AnimationManager - startBatch() with skipAnimations=${e}.`),this.reset(),this.batch.destroy(),this.batch=new HT(this.defaultDuration*1.5),e===!0&&this.batch.skip()}endBatch(){this.batch.isActive()?(this.batch.ready(),this.requestAnimation()):(this.interactionManager.popState(2),this.batch.isSkipped()&&this.batch.skip(!1))}onBatchStop(e){this.batch.stoppedCbs.add(e)}destroy(){this.stop(),this.events.clear()}},qj=class{constructor(){this.download={type:"action",showOn:"always",label:"contextMenuDownload",enabled:!0,action:void 0,items:void 0},this["zoom-to-cursor"]={type:"action",showOn:"series-area",label:"contextMenuZoomToCursor",enabled:!0,action:void 0,items:void 0},this["pan-to-cursor"]={type:"action",showOn:"series-area",label:"contextMenuPanToCursor",enabled:!0,action:void 0,items:void 0},this["reset-zoom"]={type:"action",showOn:"series-area",label:"contextMenuResetZoom",enabled:!0,action:void 0,items:void 0},this["toggle-series-visibility"]={type:"action",showOn:"legend-item",label:"contextMenuToggleSeriesVisibility",enabled:!0,action:void 0,items:void 0},this["toggle-other-series"]={type:"action",showOn:"legend-item",label:"contextMenuToggleOtherSeries",enabled:!0,action:void 0,items:void 0},this.separator={type:"separator",showOn:"always",label:"separator",enabled:!0,action:void 0,items:void 0}}},Qj=class{constructor(){this.defaults=["download","zoom-to-cursor","pan-to-cursor","reset-zoom","toggle-series-visibility","toggle-other-series"]}},Jj=class{constructor(){this.items=new qj,this.lists=new Qj}},UT=class{constructor(e){this.eventsHub=e,this.builtins=new Jj,this.hiddenActions=new Set,this.toggle("zoom-to-cursor","hide"),this.toggle("pan-to-cursor","hide"),this.toggle("reset-zoom","hide")}static check(e,t){return t.showOn==e}static checkCallback(e,t,i){return e===t}dispatchContext(e,t,i,s){const{widgetEvent:n}=t;if(n.sourceEvent.defaultPrevented)return;const o=s?.x??t.canvasX,a=s?.y??t.canvasY,r={showOn:e,x:o,y:a,context:i,widgetEvent:n};this.eventsHub.emit("context-menu:setup",r),this.eventsHub.emit("context-menu:complete",r)}isVisible(e){return!this.hiddenActions.has(e)}toggle(e,t){switch(t??(t=this.isVisible(e)?"hide":"show"),t){case"show":this.hiddenActions.delete(e);break;case"hide":this.hiddenActions.add(e);break}}},KT=class Jv{constructor(t){this.eventsHub=t,this.highlightStates=new Zy,this.pendingUnhighlights=new Map,this.unhighlightDelay=100}updateHighlight(t,i,s=!1){const n=this.getActiveHighlight();if(i==null){if(s&&this.unhighlightDelay>0){if(!this.pendingUnhighlights.get(t)){const h=SM(()=>{this.applyPendingUnhighlight(t)});this.pendingUnhighlights.set(t,{scheduler:h}),h.schedule(this.unhighlightDelay)}return}const r=this.pendingUnhighlights.get(t);r&&(r.scheduler.cancel(),this.pendingUnhighlights.delete(t)),this.highlightStates.set(t,void 0);const l=this.getActiveHighlight();this.isEqual(l,n)||this.eventsHub.emit(Jv.HIGHLIGHT_CHANGE_EVENT,{callerId:t,currentHighlight:l,previousHighlight:n});return}const o=this.pendingUnhighlights.get(t);o&&(o.scheduler.cancel(),this.pendingUnhighlights.delete(t)),this.highlightStates.set(t,i);const a=this.getActiveHighlight();this.isEqual(a,n)||this.eventsHub.emit(Jv.HIGHLIGHT_CHANGE_EVENT,{callerId:t,currentHighlight:a,previousHighlight:n})}applyPendingUnhighlight(t){if(!this.pendingUnhighlights.has(t))return;this.pendingUnhighlights.delete(t);const i=this.getActiveHighlight();this.highlightStates.set(t,void 0);const s=this.getActiveHighlight();this.isEqual(s,i)||this.eventsHub.emit(Jv.HIGHLIGHT_CHANGE_EVENT,{callerId:t,currentHighlight:s,previousHighlight:i})}getActiveHighlight(){return this.highlightStates.stateValue()}destroy(){for(const{scheduler:t}of this.pendingUnhighlights.values())t.cancel();this.pendingUnhighlights.clear()}isEqual(t,i){return t===i||t!=null&&i!=null&&t?.series===i?.series&&t?.itemId===i?.itemId&&t?.datum===i?.datum}};KT.HIGHLIGHT_CHANGE_EVENT="highlight:change";var YT=KT,ZT=(e=>(e[e.None=0]="None",e[e.Item=1]="Item",e[e.Series=2]="Series",e[e.OtherSeries=3]="OtherSeries",e[e.OtherItem=4]="OtherItem",e))(ZT||{}),UM=[0,1,2,3,4];function lu(e){const t=i=>i;switch(e){case 1:return"highlighted-item";case 4:return"unhighlighted-item";case 2:return"highlighted-series";case 3:return"unhighlighted-series";case 0:return"none";default:return t(e)}}var wl=class extends K{};g([m],wl.prototype,"fill",2),g([m],wl.prototype,"fillOpacity",2),g([m],wl.prototype,"stroke",2),g([m],wl.prototype,"strokeWidth",2),g([m],wl.prototype,"strokeOpacity",2),g([m],wl.prototype,"lineDash",2),g([m],wl.prototype,"lineDashOffset",2);var Mr=class extends K{constructor(){super(...arguments),this.enabled=!0,this.range="tooltip",this.bringToFront=!0,this.highlightedItem={},this.unhighlightedItem={},this.highlightedSeries={},this.unhighlightedSeries={}}getItemHighlightStyle(e){switch(e){case 1:return this.highlightedItem;case 4:return this.unhighlightedItem;case 2:return this.highlightedSeries;case 3:return this.unhighlightedSeries}}getSeriesHighlightStyle(e){switch(e){case 1:case 4:case 2:return this.highlightedSeries;case 3:return this.unhighlightedSeries}}getStyle(e){return oe(this.getItemHighlightStyle(e),this.getSeriesHighlightStyle(e))}};g([m],Mr.prototype,"enabled",2),g([m],Mr.prototype,"range",2),g([m],Mr.prototype,"bringToFront",2),g([m],Mr.prototype,"highlightedItem",2),g([m],Mr.prototype,"unhighlightedItem",2),g([m],Mr.prototype,"highlightedSeries",2),g([m],Mr.prototype,"unhighlightedSeries",2);var Sa=class extends K{constructor(){super(...arguments),this.fill="#c16068",this.fillOpacity=1,this.stroke="#874349",this.strokeWidth=2,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};g([m],Sa.prototype,"start",2),g([m],Sa.prototype,"stop",2),g([m],Sa.prototype,"fill",2),g([m],Sa.prototype,"fillOpacity",2),g([m],Sa.prototype,"stroke",2),g([m],Sa.prototype,"strokeWidth",2),g([m],Sa.prototype,"strokeOpacity",2),g([m],Sa.prototype,"lineDash",2),g([m],Sa.prototype,"lineDashOffset",2);var rx=class{constructor(){this.key="x",this.segments=new Pi(Sa)}};g([m],rx.prototype,"enabled",2),g([m],rx.prototype,"key",2),g([m],rx.prototype,"segments",2);var Tl=class extends K{constructor(){super(...arguments),this.type="gradient",this.colorStops=[],this.bounds="item",this.gradient="linear",this.rotation=0,this.reverse=!1,this.colorSpace="rgb"}};g([m],Tl.prototype,"type",2),g([m],Tl.prototype,"colorStops",2),g([m],Tl.prototype,"bounds",2),g([m],Tl.prototype,"gradient",2),g([m],Tl.prototype,"rotation",2),g([m],Tl.prototype,"reverse",2),g([m],Tl.prototype,"colorSpace",2);var Ii=class extends K{constructor(){super(...arguments),this.type="pattern",this.colorStops=[],this.bounds="item",this.gradient="linear",this.rotation=0,this.scale=1,this.reverse=!1,this.pattern="forward-slanted-lines",this.width=26,this.height=26,this.padding=6,this.fill="black",this.fillOpacity=1,this.backgroundFill="white",this.backgroundFillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0}};g([m],Ii.prototype,"type",2),g([m],Ii.prototype,"colorStops",2),g([m],Ii.prototype,"bounds",2),g([m],Ii.prototype,"gradient",2),g([m],Ii.prototype,"rotation",2),g([m],Ii.prototype,"scale",2),g([m],Ii.prototype,"reverse",2),g([m],Ii.prototype,"path",2),g([m],Ii.prototype,"pattern",2),g([m],Ii.prototype,"width",2),g([m],Ii.prototype,"height",2),g([m],Ii.prototype,"padding",2),g([m],Ii.prototype,"fill",2),g([m],Ii.prototype,"fillOpacity",2),g([m],Ii.prototype,"backgroundFill",2),g([m],Ii.prototype,"backgroundFillOpacity",2),g([m],Ii.prototype,"stroke",2),g([m],Ii.prototype,"strokeOpacity",2),g([m],Ii.prototype,"strokeWidth",2);var Dr=class extends K{constructor(){super(...arguments),this.type="image",this.url="",this.rotation=0,this.scale=1,this.backgroundFill="black",this.backgroundFillOpacity=1,this.repeat="no-repeat",this.fit="contain"}};g([m],Dr.prototype,"type",2),g([m],Dr.prototype,"url",2),g([m],Dr.prototype,"rotation",2),g([m],Dr.prototype,"scale",2),g([m],Dr.prototype,"backgroundFill",2),g([m],Dr.prototype,"backgroundFillOpacity",2),g([m],Dr.prototype,"repeat",2),g([m],Dr.prototype,"fit",2);var Go=class extends K{constructor(){super(...arguments),this.visible=!0,this.focusPriority=1/0,this.showInLegend=!0,this.cursor="default",this.nodeClickRange="exact",this.highlight=new Mr}handleUnknownProperties(e,t){"context"in t&&(this.context=t.context,e.delete("context"))}};g([m],Go.prototype,"id",2),g([m],Go.prototype,"visible",2),g([m],Go.prototype,"focusPriority",2),g([m],Go.prototype,"showInLegend",2),g([m],Go.prototype,"cursor",2),g([m],Go.prototype,"nodeClickRange",2),g([m],Go.prototype,"highlight",2);function XT(e,t){if(e==null||t.length===0)return[!1,!1];const i=e.valueOf(),s=t[0],n=t.at(-1);if(typeof s=="string")return[i===s,i===n];let o=s.valueOf(),a=n.valueOf();return o>a&&([o,a]=[a,o]),[i===o,i===a]}function KM(e,t,i,s,n,o){const[a,r]=XT(t,o),[l,c]=XT(e,n);return{xKey:i,yKey:s,xValue:e,yValue:t,first:l,last:c,min:a,max:r}}function zg(e,t,[i,s],n){let o=Nc(0,t-1,r=>{const l=e===1?r:t-r,c=n(l)?.[1]??Number.NaN;return!Number.isFinite(c)||c>=i})??0,a=hr(0,t-1,r=>{const l=e===1?r:t-r,c=n(l)?.[0]??Number.NaN;return!Number.isFinite(c)||c<=s})??t-1;return e===-1&&([o,a]=[t-a,t-o]),o=Math.max(o,0),a=Math.min(a+1,t),[o,a]}function qT(e,t,i){if(i){const{x:n,y:o,width:a,height:r}=i;return{canvasX:n+a/2,canvasY:o+r/2}}const s=t.yBar?.upperPoint??t.midPoint??e.datumMidPoint?.(t);if(s){const{x:n,y:o}=Kt.toCanvasPoint(e.contentGroup,s.x,s.y);return{canvasX:Math.round(n),canvasY:Math.round(o)}}}function e4(e,t,i,s,n){let o=-1,a=0,r=0,l=!1;for(;a<s&&o<=t-e;){o+=1;const c=i+r;if(l||(r*=-1),r>=0&&(r+=1),l&&r<0&&(r-=1),c<e||c>t){l=!0;continue}n(c)&&(a+=1)}return a}function YM(e){const t={};for(const i of UM)t[i]=e(void 0,!1,i);return t}function t4(e,...t){const i={};for(const s of t??["default"])for(const n of UM){const o=i[s]??(i[s]={});o[n]=e(void 0,!1,n,s)}return i}var lx=class{constructor(e,t,i,s){this.domManager=i,this.tooltip=s,this.stateTracker=new Zy,this.suppressState=new Zy(!1),this.appliedState=null,this.pendingRemovals=new Map,this.removeDelay=100,this.cleanup=new pt,this.cleanup.register(s.setup(t,i),e.on("dom:hidden",()=>this.tooltip.hide()))}destroy(){for(const{scheduler:e}of this.pendingRemovals.values())e.cancel();this.pendingRemovals.clear(),this.cleanup.flush()}updateTooltip(e,t,i,s){const n=this.pendingRemovals.get(e);n&&(n.scheduler.cancel(),this.pendingRemovals.delete(e)),i??(i=this.stateTracker.get(e)?.content),this.stateTracker.set(e,{meta:t,content:i,pagination:s}),this.applyStates()}removeTooltip(e,t,i=!1){if(i&&this.removeDelay>0){const n=this.pendingRemovals.get(e);if(n){t&&(n.lastMeta=t);return}const o=SM(()=>{this.applyPendingRemoval(e)});this.pendingRemovals.set(e,{scheduler:o,lastMeta:t}),o.schedule(this.removeDelay);return}const s=this.pendingRemovals.get(e);s&&(s.scheduler.cancel(),this.pendingRemovals.delete(e)),this.stateTracker.delete(e),this.applyStates()}suppressTooltip(e){this.suppressState.set(e,!0)}unsuppressTooltip(e){this.suppressState.delete(e)}applyPendingRemoval(e){this.pendingRemovals.has(e)&&(this.pendingRemovals.delete(e),this.stateTracker.delete(e),this.applyStates())}applyStates(){const e=this.stateTracker.stateId(),t=e?this.stateTracker.get(e):void 0;if(this.suppressState.stateValue()||t?.meta==null||t?.content==null){this.appliedState=null,this.tooltip.hide();return}const i=this.domManager.getBoundingClientRect(),s=this.tooltip.bounds==="extended"?this.domManager.getOverlayClientRect():i;if(ii(this.appliedState?.content,t?.content)&&ii(this.appliedState?.pagination,t?.pagination)){const n=this.tooltip.isVisible();this.tooltip.show(s,i,t?.meta,null,void 0,n)}else this.tooltip.show(s,i,t?.meta,t?.content,t?.pagination);this.appliedState=t}static makeTooltipMeta(e,t,i,s){const{canvasX:n,canvasY:o}=e,a=t.properties.tooltip,{placement:r,anchorTo:l,xOffset:c,yOffset:h}=a.position,d=qT(t,i,s);return{canvasX:n,canvasY:o,nodeCanvasX:d?.canvasX??n,nodeCanvasY:d?.canvasY??o,enableInteraction:a.interaction?.enabled??!1,showArrow:a.showArrow,position:{placement:r,anchorTo:l,xOffset:c,yOffset:h}}}},QT=3,i4=505,JT=30;function ZM(e,t){const{device:i,offsetX:s,offsetY:n,clientX:o,clientY:a,currentX:r,currentY:l,sourceEvent:c}=t;return{type:e,device:i,offsetX:s,offsetY:n,clientX:o,clientY:a,currentX:r,currentY:l,sourceEvent:c}}function eN(e,t){const i=e*e+t*t,s=QT*QT;return i>=s}function s4(e,t){const i=e.clientX-t.clientX,s=e.clientY-t.clientY,n=i*i+s*s,o=JT*JT;return n<o}var n4=class{constructor(e){this.cleanup=new pt,this.events=new Sn,this.isDragging=!1,this.touch={distanceTravelledX:0,distanceTravelledY:0,clientX:0,clientY:0},this.cleanup.register(e.addListener("touchstart",this.onTouchStart.bind(this)),e.addListener("touchmove",this.onTouchMove.bind(this)),e.addListener("touchend",this.onTouchEnd.bind(this)),e.addListener("mousemove",this.onMouseMove.bind(this)),e.addListener("dblclick",this.onDblClick.bind(this)),e.addListener("drag-start",this.onDragStart.bind(this)),e.addListener("drag-move",this.onDragMove.bind(this)),e.addListener("drag-end",this.onDragEnd.bind(this)))}destroy(){this.cleanup.flush()}onTouchStart(e){const{clientX:t,clientY:i}=e.sourceEvent.targetTouches[0]??{clientX:1/0,clientY:1/0};this.touch.distanceTravelledX=0,this.touch.distanceTravelledY=0,this.touch.clientX=t,this.touch.clientY=i}onTouchMove(e){const{clientX:t,clientY:i}=e.sourceEvent.targetTouches[0]??{clientX:1/0,clientY:1/0};this.touch.distanceTravelledX+=Math.abs(this.touch.clientX-t),this.touch.distanceTravelledY+=Math.abs(this.touch.clientY-i),this.touch.clientX=t,this.touch.clientY=i}onTouchEnd(e){e.sourceEvent.preventDefault()}onMouseMove(e){this.events.emit("mousemove",e)}onDblClick(e){this.events.emit("dblclick",e)}onDragStart(e){this.dragStartEvent=e}onDragMove(e){this.dragStartEvent!=null&&eN(e.originDeltaX,e.originDeltaY)&&(this.events.emit("drag-start",this.dragStartEvent),this.events.emit("drag-move",{...this.dragStartEvent,type:"drag-move"}),this.dragStartEvent=void 0,this.isDragging=!0),this.isDragging&&this.events.emit("drag-move",e)}onDragEnd(e){if(this.isDragging){this.events.emit("drag-end",e),this.isDragging=!1;return}if(e.device==="mouse"){const t=ZM("click",e);this.events.emit("click",t)}else if(e.sourceEvent.type==="touchend"){if(eN(this.touch.distanceTravelledX,this.touch.distanceTravelledY))return;const t=ZM("click",e);this.events.emit("click",t);const i=Date.now();if(this.lastClick!==void 0&&i-this.lastClick.time<=i4&&s4(this.lastClick,e)){const s=ZM("dblclick",e);this.events.emit("dblclick",s),this.lastClick=void 0}else this.lastClick={time:i,clientX:e.clientX,clientY:e.clientY}}}},XM=class extends ou{constructor(e){super(e)}addChildToDOM(){}removeChildFromDOM(){}},o4=class{constructor(e,t){this.seriesWidget=new XM(e.getParent("series-area")),this.chartWidget=new XM(e.getParent("canvas-proxy")),this.containerWidget=new XM(e.getParent("canvas-container")),this.containerWidget.addChild(this.chartWidget),this.chartWidget.addChild(this.seriesWidget),t.withDragInterpretation&&(this.seriesDragInterpreter=new n4(this.seriesWidget))}destroy(){this.seriesDragInterpreter?.destroy(),this.seriesWidget.destroy(),this.chartWidget.destroy(),this.containerWidget.destroy()}},tN=class cL extends _y{constructor(t=[],i=[]){super(),this.range=i,this.defaultTickCount=cL.defaultTickCount,this.defaultClamp=!1,this._domain=[],this.domainNeedsValueOf=!0,this.d0Cache=Number.NaN,this.d1Cache=Number.NaN,this.domain=t}static is(t){return t instanceof cL}get domain(){return this._domain}set domain(t){if(this._domain=t,t&&t.length>=2){const i=t[0];this.domainNeedsValueOf=i!=null&&typeof i=="object",this.domainNeedsValueOf?(this.d0Cache=t[0].valueOf(),this.d1Cache=t[1].valueOf()):(this.d0Cache=t[0],this.d1Cache=t[1])}else this.d0Cache=Number.NaN,this.d1Cache=Number.NaN}normalizeDomains(...t){return iN(...t)}calcBandwidth(t=1,i=1){const{domain:s}=this,n=this.getPixelRange();if(s.length===0)return n;let a=Math.abs(this.d1Cache-this.d0Cache)/t+1;if(i!==0){const r=Math.floor(n);a=Math.min(a,r)}return n/Math.max(1,a)}convert(t,i){const{domain:s}=this;if(!s||s.length<2||t==null)return Number.NaN;const{range:n}=this,o=i?.clamp??this.defaultClamp;let a=this.d0Cache,r=this.d1Cache,l=typeof t=="number"?t:t.valueOf();if(this.transform&&(a=this.transform(a),r=this.transform(r),l=this.transform(l)),o){const[h,d]=Tt([a,r]);if(l<h)return n[0];if(l>d)return n[1]}if(a===r)return(n[0]+n[1])/2;if(l===a)return n[0];if(l===r)return n[1];const c=n[0];return c+(l-a)/(r-a)*(n[1]-c)}invert(t,i){const{domain:s}=this;if(s.length<2)return;let n=this.d0Cache,o=this.d1Cache;this.transform&&(n=this.transform(n),o=this.transform(o));const{range:a}=this,[r,l]=a;let c;return r===l?c=this.toDomain((n+o)/2):c=this.toDomain(n+(t-r)/(l-r)*(o-n)),this.transformInvert?this.transformInvert(c):c}getDomainMinMax(){return Gy(this.domain)}getPixelRange(){const[t,i]=this.range;return Math.abs(i-t)}};tN.defaultTickCount=5;var yt=tN;function iN(...e){let t,i=1/0,s,n=-1/0;for(const o of e){const a=o.domain;for(const r of a){const l=r.valueOf();l<i&&(i=l,t=r),l>n&&(n=l,s=r)}}return t!=null&&s!=null?{domain:[t,s],animatable:!0}:{domain:[],animatable:!1}}var qM=class _B extends _y{constructor(){super(...arguments),this.invalid=!0,this.range=[0,1],this.round=!1,this._bandwidth=1,this._step=1,this._inset=1,this._rawBandwidth=1,this._paddingInner=0,this._paddingOuter=0}static is(t){return t instanceof _B}get bandwidth(){return this.refresh(),this._bandwidth}get step(){return this.refresh(),this._step}get inset(){return this.refresh(),this._inset}get rawBandwidth(){return this.refresh(),this._rawBandwidth}set padding(t){t=ge(0,t,1),this._paddingInner=t,this._paddingOuter=t}get padding(){return this._paddingInner}set paddingInner(t){this.invalid=!0,this._paddingInner=ge(0,t,1)}get paddingInner(){return this._paddingInner}set paddingOuter(t){this.invalid=!0,this._paddingOuter=ge(0,t,1)}get paddingOuter(){return this._paddingOuter}getBandCountForUpdate(){return this.bands.length}refresh(){this.invalid&&(this.invalid=!1,this.update(),this.invalid&&j.warnOnce("Expected update to not invalidate scale"))}convert(t,i){this.refresh();const s=this.findIndex(t,i?.alignment);return s==null||s<0||s>=this.getBandCountForUpdate()?Number.NaN:this.ordinalRange(s)}getDomainMinMax(){return Gy(this.domain)}invertNearestIndex(t){this.refresh();const i=this.getBandCountForUpdate();if(i===0)return-1;let s=0,n=i-1,o=1/0,a=0;for(;s<=n;){const r=Math.trunc((n+s)/2),l=this.ordinalRange(r),c=Math.abs(l-t);if(c===0)return r;c<o&&(o=c,a=r),l<t?s=r+1:n=r-1}return a}update(){const[t,i]=this.range;let{_paddingInner:s}=this;const{_paddingOuter:n}=this,o=this.getBandCountForUpdate();if(o===0)return;const a=i-t;let r;o===1?(s=0,r=a*(1-n*2)):r=a/Math.max(1,o-s+n*2);const l=this.round&&Math.floor(r)>0,c=l?Math.floor(r):r;let h=t+(a-c*(o-s))/2,d=c*(1-s);l&&(h=Math.round(h),d=Math.round(d)),this._step=c,this._inset=h,this._bandwidth=d,this._rawBandwidth=r*(1-s)}ordinalRange(t){const{_inset:i,_step:s,range:n}=this,o=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]);return ge(o,i+s*t,a)}};g([Vy],qM.prototype,"range",2),g([Vy],qM.prototype,"round",2);var Ma=qM,a4=1e3,sN=20;function nN(e,t=0,i=e.length-1){const s=i-t+1;if(s<2)return{isUniform:!1};const n=Array.from({length:sN},(l,c)=>t+Math.floor(c*(s-1)/(sN-1))),o=n.map(l=>e[l].valueOf()),a=(o.at(-1)-o[0])/(s-1);if(!Number.isFinite(a)||a===0)return{isUniform:!1};const r=Math.abs(a*.01);for(let l=1;l<o.length;l++){const c=n[l]-n[l-1],h=(o[l]-o[l-1])/c;if(Math.abs(h-a)>r)return{isUniform:!1}}return{isUniform:!0,interval:a}}var Da=class VB extends Ma{static is(t){return t instanceof VB}toDomain(t){return new Date(t)}get reversed(){const{domain:t}=this;return t.length>0&&t[0].valueOf()>t.at(-1).valueOf()}get numericBands(){return this.bands.map(t=>t.valueOf())}convert(t,i){this.refresh(),t instanceof Date||(t=new Date(t));const{domain:s,reversed:n}=this,o=this.numericBands,a=o.length;if(s.length<=0)return Number.NaN;const r=this.ordinalRange(0),l=this.ordinalRange(a-1);if(a===0)return r;if(i?.clamp===!0){const{range:S}=this;if(t.valueOf()<o[0])return S[0];if(t.valueOf()>o.at(-1))return S[1]}if((i?.alignment??0)!==2){const S=super.convert(t,i);return n?l-(S-r):S}const h=t.valueOf();let d=this.findIndex(t)??0,u;n?(d=Math.min(Math.max(d,1),a-1),u=-1):(d=Math.min(Math.max(d,0),a-2),u=1);const p=o[d],f=o[d+u],y=this.ordinalRange(d),b=this.ordinalRange(d+u),v=(h-p)/(f-p)*(b-y)+y;return n?l-(v-r):v}invert(t,i=!1){this.refresh();const{domain:s}=this;if(s.length<=0)return;const n=this.bands,o=this.getBandCountForUpdate(),a=s[0].valueOf()>s.at(-1).valueOf();let r;return i?r=this.invertNearestIndex(t-this.bandwidth/2):r=Nc(0,o-1,c=>this.ordinalRange(c)>=t)??o-1,n[a?o-1-r:r]}getUniformityCache(t){}findIndex(t,i=0){if(t==null)return;const s=this.numericBands,n=s.length;if(n===0)return;if(n===1)return 0;const o=t.valueOf();return i===1?Nc(0,n-1,a=>s[a]>=o):hr(0,n-1,a=>s[a]<=o)}};function cx(e,t,i,s,n){return t+(s-t)*((n-e)/(i-e))}function oN(e,t,i,s,n){return e+(n-t)*((i-e)/(s-t))}function aN(e,t,i){return[oN(e,i.min,t,i.max,0),oN(e,i.min,t,i.max,1)]}function r4(e,t,i){const[s,n]=aN(e.x1,e.x2,t),[o,a]=aN(e.y1,e.y2,i);return{x1:s,x2:n,y1:o,y2:a}}function rN(e,t,i,s,n,o){if(i<=n&&o<=s)return i;const a=n-i,r=o-s,l=Math.abs(a)<Math.abs(r)?a:r;return ge(e,i+l,t)}function l4(e,t,i){const{x:s={min:0,max:1},y:n={min:0,max:1}}=t,o=ke.from(i),a=ke.from(e),r=r4(a,s,n),l=rN(r.x1,r.x2,a.x1,a.x2,o.x1,o.x2),c=rN(r.y1,r.y2,a.y1,a.y2,o.y1,o.y2),h={x:{min:cx(a.x1,s.min,a.x2,s.max,l),max:cx(a.x1,s.min,a.x2,s.max,l+e.width)},y:{min:cx(a.y1,n.min,a.y2,n.max,c),max:cx(a.y1,n.min,a.y2,n.max,c+e.height)}},d=h.x.max-h.x.min,u=h.y.max-h.y.min;return h.x.min=ge(0,h.x.min,1-d),h.x.max=h.x.min+d,h.y.min=ge(0,h.y.min,1-u),h.y.max=h.y.min+u,h}function lN(e,t){const i=e?.valueOf(),s=t?.valueOf();return typeof i!="number"||typeof s!="number"?[void 0,void 0]:i<s?[0,1]:[1,0]}var cN=e=>Ge((t,{options:i})=>!yt.is(e?.scale)&&!Da.is(e?.scale)||t==null||i.end==null?!0:t<i.end,"to be less than end");function c4(e){for(const t of To(e)){const i=e[t];if(!i)continue;const{min:s,max:n}=i;(s<0||n>1)&&(j.warnOnce(`Attempted to update axis (${t}) zoom to an invalid ratio of [{ min: ${s}, max: ${n} }], expecting a ratio of 0 to 1. Ignoring.`),delete e[t])}}function hN(e,t){const i={};for(const{id:s,direction:n}of e){const{min:o,max:a}=t[s]??{min:0,max:1};i[s]={min:o,max:a,direction:n}}return i}function h4(e,t){const i=To(e),s=To(t);if(i.length!==s.length)return!1;for(const n of i)if(!s.includes(n))return!1;for(const n of i){const o=e[n],a=t[n];if(o!==a&&(o==null||a==null||o.direction!==a.direction||o.min!==a.min||o.max!==a.max))return!1}return!0}function d4(e){return{source:"user-interaction",sourceDetail:e}}var dN=class extends AM{constructor(e,t,i){super(),this.eventsHub=e,this.fireChartEvent=i,this.mementoOriginatorKey="zoom",this.state={},this.axes=[],this.didLayoutAxes=!1,this.lastRestoredState={},this.independentAxes=!1,this.navigatorModule=!1,this.zoomModule=!1,this.pendingMemento=void 0,this.cleanup.register(e.on("layout:complete",()=>{this.didLayoutAxes=!0;const{pendingMemento:s}=this;s&&this.restoreMemento(s.version,s.mementoVersion,s.memento),this.updateZoom({source:"chart-update",sourceDetail:"unspecified"})}),t.addListener("update-complete",({wasShortcut:s})=>{if(!s&&this.pendingZoomEventSource){const n=this.pendingZoomEventSource;this.fireChartEvent({type:"zoom",source:n,...this.getMementoRanges()}),this.pendingZoomEventSource=void 0}}))}toCoreZoomState(e){const t={};let i;const{state:s}=this;if(this.independentAxes){const n=this.getPrimaryAxisId("x"),o=this.getPrimaryAxisId("y");i=[],n&&i.push(n),o&&i.push(o)}else i=To(s);for(const n of i){const{direction:o}=s[n]??{};if(o!=null){const a=e[o];if(a){const{min:r,max:l}=a;t[n]={min:r,max:l,direction:o}}}}return t}toAxisZoomState(e){let t,i;for(const s of To(e)){const{min:n,max:o,direction:a}=e[s];a==="x"?t??(t={min:n,max:o}):a==="y"&&(i??(i={min:n,max:o}))}if(t||i)return{x:t,y:i}}createMemento(){return this.getMementoRanges()}guardMemento(e,t){if(e==null)return!0;if(!fe(e))return!1;const i=this.getPrimaryAxis("x"),s=this.getPrimaryAxis("y"),n={rangeX:{start:cN(i),end:le},rangeY:{start:cN(s),end:le},ratioX:{start:le,end:le},ratioY:{start:le,end:le},autoScaledAxes:le},{invalid:o}=Ei(e,n);return o.length>0?(t.push(...o.map(String)),!1):!0}restoreMemento(e,t,i){if(!this.axes||!this.didLayoutAxes){this.pendingMemento={version:e,mementoVersion:t,memento:i};return}this.pendingMemento=void 0;const s=this.getDefinedZoom();i?.rangeX?s.x=this.rangeToRatioDirection("x",i.rangeX)??{min:0,max:1}:i?.ratioX?s.x={min:i.ratioX.start??0,max:i.ratioX.end??1}:s.x={min:0,max:1};const{navigatorModule:n,zoomModule:o}=this;this.eventsHub.emit("zoom:load-memento",{zoom:s,memento:i,navigatorModule:n,zoomModule:o});const a=this.toCoreZoomState(s);this.lastRestoredState=on(Re(a)),this.updateChanges({source:"state-change",sourceDetail:"internal-restoreMemento",changes:a,isReset:!1})}findAxis(e){for(const t of this.axes)if(t.id===e)return t}getAxes(){return this.axes}setAxes(e){const{axes:t}=this;t.length=0;for(const n of e)"range"in n&&t.push(n);const i=this.state,s=hN(e,i);this.state=s,this.lastRestoredState=hN(e,this.lastRestoredState),this.updateChanges({source:"chart-update",sourceDetail:"internal-setAxes",changes:s,isReset:!1})}setIndependentAxes(e=!0){this.independentAxes=e}setNavigatorEnabled(e=!0){this.navigatorModule=e}setZoomModuleEnabled(e=!0){this.zoomModule=e}isNavigatorEnabled(){return this.navigatorModule}isZoomEnabled(){return this.zoomModule}updateZoom({source:e,sourceDetail:t},i){const s=this.toCoreZoomState(i??{});return this.updateChanges({source:e,sourceDetail:t,changes:s,isReset:!1})}computeChangedAxesIds(e){const t=[],i=this.state;for(const s of To(e)){const n=e[s]??{min:0,max:1},o=i[s];(o==null||o.min!==n.min||o.max!==n.max)&&t.push(s)}return t}updateChanges(e){const{source:t,sourceDetail:i,isReset:s,changes:n}=e;c4(n);const o=this.computeChangedAxesIds(n),a=Re(this.state);for(const r of o){const l=a[r];l!=null&&(l.min=n[r]?.min??0,l.max=n[r]?.max??1)}return this.state=a,this.dispatch(t,i,o,s)}resetZoom({source:e,sourceDetail:t}){this.updateChanges({source:e,sourceDetail:t,changes:this.getRestoredZoom(),isReset:!0})}resetAxisZoom({source:e,sourceDetail:t},i){this.updateChanges({source:e,sourceDetail:t,changes:{[i]:this.getRestoredZoom()[i]},isReset:!0})}panToBBox(e,t){if(!this.isZoomEnabled()&&!this.isNavigatorEnabled())return!1;const i=this.getZoom();if(i===void 0||!i.x&&!i.y)return!1;if(!(e.width>0&&e.height>0&&Math.abs(t.width)<=Math.abs(e.width)&&Math.abs(t.height)<=Math.abs(e.height)))return j.warnOnce("cannot pan to target BBox - chart too small?"),!1;const n=l4(e,i,t),o=this.toCoreZoomState(n);return this.updateChanges({source:"user-interaction",sourceDetail:"internal-panToBBox",changes:o,isReset:!1})}fireZoomPanStartEvent(e){this.eventsHub.emit("zoom:pan-start",{callerId:e})}extendToEnd(e,t,i){return this.extendWith(e,t,s=>Number(s)-i)}extendWith({source:e,sourceDetail:t},i,s){const n=this.getPrimaryAxis(i);if(!n)return;const o=this.getDomainExtents(n);if(!o)return;const[,a]=o,r=s(a),l=this.rangeToRatioAxis(n,{start:r});l&&this.updateChanges({source:e,sourceDetail:t,changes:{[i]:l},isReset:!1})}updateWith({source:e,sourceDetail:t},i,s){const n=this.getPrimaryAxis(i);if(!n)return;const o=this.getDomainExtents(n);if(!o)return;let[a,r]=o;[a,r]=s(a,r);const l=this.rangeToRatioAxis(n,{start:a,end:r});l&&this.updateChanges({source:e,sourceDetail:t,changes:{[i]:l},isReset:!1})}getZoom(){return this.toAxisZoomState(this.state)}getAxisZoom(e){return this.state[e]??{min:0,max:1}}getAxisZooms(){return this.state}getCoreZoom(){return this.state}getRestoredZoom(){return this.lastRestoredState}getPrimaryAxisId(e){return this.getPrimaryAxis(e)?.id}getBoundSeries(){const e=this.getPrimaryAxis("x"),t=this.getPrimaryAxis("y");let i;if(this.independentAxes){const s=new Set(e?.boundSeries??[]),n=new Set(t?.boundSeries??[]);i=new Set;for(const o of s)n.has(o)&&i.add(o)}else i=new Set([...e?.boundSeries??[],...t?.boundSeries??[]]);return i}constrainZoomToItemCount(e,t,i){let s=[e.x.min,e.x.max],n=i?void 0:[e.y.min,e.y.max];for(const r of this.getBoundSeries()){const l=r.getZoomRangeFittingItems(s,n,t);l!=null&&(s=l.x,n=l.y)}const o={min:s[0],max:s[1]},a={min:n?.[0]??0,max:n?.[1]??1};return{x:o,y:a}}isVisibleItemsCountAtLeast(e,t,i){const s=this.getBoundSeries(),n=[e.x.min,e.x.max],o=!i.includeYVisibleRange&&i.autoScaleYAxis?void 0:[e.y.min,e.y.max];let a=0;for(const r of s){const l=t-(a??0),c=r.getVisibleItems(n,o,l);if(a+=c,a>=t)return!0}return s.size===0}getMementoRanges(){const e=this.getDefinedZoom(),t={rangeX:this.getRangeDirection("x",e.x),rangeY:this.getRangeDirection("y",e.y),ratioX:{start:e.x.min,end:e.x.max},ratioY:{start:e.y.min,end:e.y.max},autoScaledAxes:void 0};return this.eventsHub.emit("zoom:save-memento",{memento:t}),t}dispatch(e,t,i,s){const{x:n,y:o}=this.getZoom()??{},a=this.state;let r;const l=this,c={source:e,sourceDetail:t,isReset:s,changedAxes:i,state:a,x:n,y:o,stateAsDefinedZoom(){const{x:u={min:0,max:1},y:p={min:0,max:1}}=l.toAxisZoomState(c.state)??{};return{x:u,y:p}},constrainZoom(u){this.constrainChanges(l.toCoreZoomState(u))},constrainChanges(u){r??(r=Re(a));for(const p of To(u)){const f=u[p],y=r[p];f&&y&&(y.min=f.min,y.max=f.max)}c.state=r}};this.eventsHub.emit("zoom:change-request",c);let h;r&&!h4(a,r)?(h=!0,this.state=r):h=!1;const d=i.length>0||h;if(d){const u=this.getZoom()??{};this.eventsHub.emit("zoom:change-complete",{source:e,sourceDetail:t,x:u.x}),this.pendingZoomEventSource=e}return d}getRange(e,t){return this.getRangeAxis(this.findAxis(e),t)}getRangeDirection(e,t){return this.getRangeAxis(this.getPrimaryAxis(e),t)}getRangeAxis(e,t){if(!e||!t||!yt.is(e.scale)&&!Da.is(e.scale))return;const i=this.getDomainPixelExtents(e);if(!i)return;const[s,n]=i;let o,a;return s<=n?(o=e.scale.invert(0),a=e.scale.invert(s+(n-s)*t.max)):(o=e.scale.invert(s-(s-n)*t.min),a=e.scale.invert(0)),{start:o,end:a}}rangeToRatio(e,t){return this.rangeToRatioAxis(this.findAxis(e),t)}rangeToRatioDirection(e,t){return this.rangeToRatioAxis(this.getPrimaryAxis(e),t)}rangeToRatioAxis(e,t){if(!e)return;const i=this.getDomainPixelExtents(e);if(!i)return;const[s,n]=i,{scale:o}=e,{start:a,end:r}=t,[l=0,c=1]=lN(a,r),h=a==null?s:o.convert(a,{alignment:l}),d=r==null?n:o.convert(r,{alignment:c})+(o.bandwidth??0);if(!$e(h)||!$e(d))return;const[u,p]=[Math.min(s,n),Math.max(s,n)];if(h<u||h>p){j.warnOnce(`Invalid range start [${a}], expecting a value between [${o.invert(s)}] and [${o.invert(n)}], ignoring.`);return}if(d<u||d>p){j.warnOnce(`Invalid range end [${r}], expecting a value between [${o.invert(s)}] and [${o.invert(n)}], ignoring.`);return}const f=n-s;if(f===0)return;const y=Math.abs((h-s)/f),b=Math.abs((d-s)/f);if(!(y>=b))return{min:y,max:b}}getPrimaryAxis(e){return this.axes?.find(t=>t.direction===e)}getDomainExtents(e){const{domain:t}=e.scale,i=t.at(0),s=t.at(-1);if(!(i==null||s==null))return[i,s]}getDomainPixelExtents(e){const[t,i]=e.scale.range;if(!(!$e(t)||!$e(i)))return[t,i]}getDefinedZoom(){const e=this.getZoom();return{x:{min:e?.x?.min??0,max:e?.x?.max??1},y:{min:e?.y?.min??0,max:e?.y?.max??1}}}},QM=(e=>(e[e.Caption=0]="Caption",e[e.Legend=1]="Legend",e[e.ToolbarLeft=2]="ToolbarLeft",e[e.ToolbarBottom=3]="ToolbarBottom",e[e.Navigator=4]="Navigator",e[e.Overlay=5]="Overlay",e))(QM||{}),u4=class{constructor(e){this.eventsHub=e,this.elements=new Map}registerElement(e,t){return this.elements.has(e)?this.elements.get(e).add(t):this.elements.set(e,new Set([t])),()=>this.elements.get(e)?.delete(t)}createContext(e,t){const i={width:e,height:t,layoutBox:new re(0,0,e,t)};for(const s of Object.values(QM)){if(typeof s!="number")continue;const n=this.elements.get(s);if(n)for(const o of n)o(i)}return i}emitLayoutComplete({width:e,height:t},i){this.eventsHub.emit("layout:complete",{axes:i.axes??{},chart:{width:e,height:t},clipSeries:i.clipSeries??!1,series:i.series})}},p4=class{constructor(){this.labelData=new Map}updateLabels(e,t,i=re.zero){const s={x:-t.left,y:-t.top,width:i.width+t.left+t.right,height:i.height+t.top+t.bottom},n=new Set(e.map(a=>a.id));for(const a of this.labelData.keys())n.has(a)||this.labelData.delete(a);for(const a of e){const r=a.getLabelData();r.every(Q0)&&this.labelData.set(a.id,r)}const o=J0(this.labelData,s,5);for(const a of e)a.updatePlacedLabelData?.(o.get(a.id)??[])}},g4=class{constructor(e){this.eventsHub=e,this.mementoOriginatorKey="legend",this.legendDataMap=new Map}createMemento(){return this.getData().filter(({hideInLegend:e,isFixed:t})=>!e&&!t).map(({enabled:e,seriesId:t,itemId:i,legendItemName:s})=>({visible:e,seriesId:t,itemId:i,legendItemName:s}))}guardMemento(e){return e==null||Ce(e)}restoreMemento(e,t,i){if(i)for(const s of i){const{seriesId:n,data:o}=this.getRestoredData(s)??{};!n||!o||this.updateData(n,o)}this.update()}getRestoredData(e){const{seriesId:t,itemId:i,legendItemName:s,visible:n}=e;if(t){const a=(this.legendDataMap.get(t)??[]).map(r=>{const l=r.seriesId===t&&(!i||r.itemId===i);return l&&r.isFixed&&this.warnFixed(r.seriesId,r.itemId),!r.isFixed&&l?{...r,enabled:n}:r});return{seriesId:t,data:a}}if(!(i==null&&s==null))for(const o of this.getData()){if(i!=null&&o.itemId!==i||s!=null&&o.legendItemName!==s)continue;if(o.isFixed){this.warnFixed(o.seriesId,i);return}const a=(this.legendDataMap.get(o.seriesId)??[]).map(r=>r.itemId===i||r.legendItemName===s?{...r,enabled:n}:r);return{seriesId:o.seriesId,data:a}}}warnFixed(e,t){j.warnOnce(`The legend item with seriesId [${e}] and itemId [${t}] is not configurable, this series item cannot be toggled through the legend.`)}update(e){this.eventsHub.emit("legend:change",{legendData:e??this.getData()})}updateData(e,t=[]){this.eventsHub.emit("legend:change-partial",{seriesId:e,legendData:t}),this.legendDataMap.set(e,t)}clearData(){this.legendDataMap.clear()}toggleItem(e,t,i,s){if(s){for(const r of this.getData()){const l=(this.legendDataMap.get(r.seriesId)??[]).map(c=>c.legendItemName===s?{...c,enabled:e}:c);this.updateData(r.seriesId,l)}return}const n=this.getData(t),o=n.length===1,a=n.map(r=>i==null&&o||r.itemId===i?{...r,enabled:e}:r);this.updateData(t,a)}getData(e){return e?this.legendDataMap.get(e)??[]:[...this.legendDataMap].reduce((t,[i,s])=>t.concat(s),[])}getDatum({seriesId:e,itemId:t}={}){return this.getData(e).find(i=>i.itemId===t)}getSeriesEnabled(e){const t=this.getData(e);if(t.length>0)return t.some(i=>i.enabled)}getItemEnabled({seriesId:e,itemId:t}={}){return this.getDatum({seriesId:e,itemId:t})?.enabled??!0}},f4=class{updateCallback(e){this.resolvePartialCallback=e}resolvePartial(e,t,i){return this.resolvePartialCallback?.(e,t,i)}},m4=class{constructor(){this.groups=new Map}registerSeries({internalId:e,seriesGrouping:t,visible:i,type:s}){if(!t)return;let n=this.groups.get(s);n==null&&(n=new Map,this.groups.set(s,n)),n.set(e,{grouping:t,visible:i})}updateSeries({internalId:e,seriesGrouping:t,visible:i,type:s}){if(!t)return;const n=this.groups.get(s)?.get(e);n&&(n.grouping=t,n.visible=i)}deregisterSeries({internalId:e,type:t}){const i=this.groups.get(t);i!=null&&(i.delete(e),i.size===0&&this.groups.delete(t))}getVisiblePeerGroupIndex({type:e,seriesGrouping:t,visible:i}){if(!t)return{visibleGroupCount:i?1:0,visibleSameStackCount:i?1:0,index:0};const s=new Set,n=new Set,o=this.groups.get(e);for(const r of o?.values()??[])r.visible&&(s.add(r.grouping.groupIndex),r.grouping.groupIndex===t.groupIndex&&n.add(r.grouping.stackIndex));const a=Array.from(s);return a.sort((r,l)=>r-l),{visibleGroupCount:a.length,visibleSameStackCount:n.size,index:a.indexOf(t.groupIndex)}}},y4=class{constructor(e){this.updateCallback=e,this.events=new Sn}addListener(e,t){return this.events.on(e,t)}destroy(){this.events.clear()}update(e=0,t){this.updateCallback(e,t)}dispatchUpdateComplete(e,t){this.events.emit("update-complete",{type:"update-complete",apiUpdate:e,wasShortcut:t})}dispatchPreDomUpdate(){this.events.emit("pre-dom-update",{type:"pre-dom-update"})}dispatchPreSceneRender(){this.events.emit("pre-scene-render",{type:"pre-scene-render"})}dispatchProcessData({series:e}){this.events.emit("process-data",{type:"process-data",series:e})}},x4=class{constructor(e,t){this.eventsHub=new Sn,this.callbackCache=new o0,this.highlightManager=new YT(this.eventsHub),this.formatManager=new ru,this.layoutManager=new u4(this.eventsHub),this.localeManager=new NH(this.eventsHub),this.seriesStateManager=new m4,this.stateManager=new pH,this.seriesLabelLayoutManager=new p4,this.cleanup=new pt;const{scene:i,root:s,syncManager:n,container:o,fireEvent:a,updateCallback:r,updateMutex:l,styleContainer:c,chartType:h,domMode:d,withDragInterpretation:u}=t;this.chartService=e,this.syncManager=n,this.domManager=new yT(this.eventsHub,this.chartService,o,c,d),this.widgets=new o4(this.domManager,{withDragInterpretation:u});const p=this.domManager.addChild("canvas","scene-canvas",i?.canvas.element);this.scene=i??new Jy({canvasElement:p}),this.scene.setRoot(s),this.cleanup.register(this.scene.on("scene-changed",()=>{this.updateService.update(7)})),this.axisManager=new RH(this.eventsHub,s),this.legendManager=new g4(this.eventsHub),this.annotationManager=new PH(this.eventsHub,e.annotationRoot,a),this.chartTypeOriginator=new dH(e),this.interactionManager=new WT,this.contextMenuRegistry=new UT(this.eventsHub),this.optionsGraphService=new f4,this.updateService=new y4(r),this.proxyInteractionService=new LH(this.eventsHub,this.localeManager,this.domManager),this.fontManager=new FH(this.domManager,this.updateService),this.historyManager=new uH(this.eventsHub),this.animationManager=new Xj(this.interactionManager,l),this.dataService=new OM(this.eventsHub,e,this.animationManager),this.tooltipManager=new lx(this.eventsHub,this.localeManager,this.domManager,e.tooltip),this.zoomManager=new dN(this.eventsHub,this.updateService,a);for(const f of me.listModulesByType("plugin"))(!f.chartType||f.chartType===h)&&f.patchContext?.(this)}destroy(){this.animationManager.destroy(),this.axisManager.destroy(),this.callbackCache.invalidateCache(),this.domManager.destroy(),this.fontManager.destroy(),this.proxyInteractionService.destroy(),this.tooltipManager.destroy(),this.zoomManager.destroy(),this.widgets.destroy(),this.cleanup.flush()}},JM=class extends K{constructor(){super(...arguments),this.range="tooltip",this.drawingMode="cutout"}};g([m],JM.prototype,"range",2),g([m],JM.prototype,"drawingMode",2);function b4(e,t){if(e.size!==t.size)return!1;for(const i of e)if(!t.has(i))return!1;return!0}function v4(e,t){if(e==null||t==null)return e===t;if(e.size!==t.size)return!1;for(const[i,s]of e){const n=t.get(i);if(n==null||!b4(s,n))return!1}return!0}function S4(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i+=1){const{type:s,idsMap:n,scopes:o,data:a,...r}=e[i],{type:l,idsMap:c,scopes:h,data:d,...u}=t[i];if(s!==l||o&&h&&!vn(o,h)||a&&d&&a!==d||!ii(r,u)||!v4(n,c))return!1}return!0}function M4(e,t){const{props:i,...s}=e,{props:n,...o}=t;return ii(s,o)&&S4(i,n)}function D4(e,t,i,s){return t!==e.dataSet?!1:vn(i,e.ids)&&M4(s,e.opts)}function uN(e){return e.filter(t=>t.type==="key").map(t=>t.property).join(";")}var eD=class Ao{constructor(t,i,s){this.mode=t,this.suppressFieldDotNotation=i,this.eventsHub=s,this.debug=Me.create(!0,"data-model"),this.requested=[],this.status="setup"}async request(t,i,s){if(this.status!=="setup")throw new Error("AG Charts - data request after data setup phase.");return new Promise((n,o)=>{this.requested.push({id:t,opts:s,dataSet:i,resolve:n,reject:o})})}execute(t){if(this.status!=="setup")throw new Error("AG Charts - data request after data setup phase.");this.status="executed";const i=new Map;for(const r of this.requested)r.dataSet.hasPendingTransactions()&&i.set(r.dataSet,r.dataSet.getChangeDescription()),r.dataSet.commitPendingTransactions();this.debug("DataController.execute() - requested",this.requested);const s=this.validateRequests(this.requested);this.debug("DataController.execute() - validated",s);const n=this.mergeRequested(s);this.debug("DataController.execute() - merged",n),this.debug.check()&&(Ve().processedData=[]);const o=[];for(const{dataSet:r,ids:l,opts:c,resolves:h,rejects:d}of n){let u=function(S){return D4(S,r,l,c)};var a=u;const p=t?.find(u),f=(S,M)=>{if(this.debug.check()&&Ve("processedData").push(M),M==null){for(const D of d)D(new Error("AG Charts - no processed data generated"));return}o.push({opts:c,dataSet:r,dataLength:r.data.length,ids:l,dataModel:S,processedData:M});for(const D of h)D({dataModel:S,processedData:M})},y=()=>{try{const S=new HM(c,this.mode,this.suppressFieldDotNotation,this.eventsHub),M=new Map(s.map(k=>[k.id,k.dataSet])),D=S.processData(M);return f(S,D),S}catch(S){for(const M of d)M(S)}};if(p==null){y();continue}const{dataModel:b,processedData:x}=p,v=i.get(r);if(x&&v&&b.isReprocessingSupported(x)){if(this.debug("DataController.execute() - reprocessing data",x,r),b.reprocessData(x,i),Me.check("data-model:reprocess-diff")){const S=new HM(c,this.mode,this.suppressFieldDotNotation,this.eventsHub),M=new Map(s.map(C=>[C.id,C.dataSet])),D=S.processData(M),k=JSON.parse(JSON.stringify(x,Ao.jsonReplacer)),I=JSON.parse(JSON.stringify(D,Ao.jsonReplacer));delete k.time,delete k.optimizations,delete I.time,delete I.optimizations;const A=Ln(I,k);A?(j.log("\u26A0\uFE0F DATA-MODEL REPROCESS DIFF DETECTED \u26A0\uFE0F"),j.log("Difference between incremental update and full reprocess:"),j.log(""),j.log("BASELINE (full reprocess):"),j.log(JSON.stringify(I,null,2)),j.log(""),j.log("REPROCESSED (incremental update):"),j.log(JSON.stringify(k,null,2)),j.log(""),j.log("DIFF (what changed):"),j.log(JSON.stringify(A,null,2))):j.log("\u2705 Data-model reprocess matches baseline (no diff)")}f(b,x);continue}y()}return o}validateRequests(t){const i=[];for(const[s,n]of t.entries())s>0&&n.dataSet.data.length!==t[0].dataSet.data.length&&n.opts.groupByData===!1&&n.opts.groupByKeys===!1?n.reject(new Error("all series[].data arrays must be of the same length and have matching keys.")):i.push(n);return i}mergeRequested(t){const i=[];for(const s of t){const n=i.find(Ao.groupMatch(s));n?n.push(s):i.push([s])}return i.map(Ao.mergeRequests)}static groupMatch({dataSet:t,opts:i}){const{groupByData:s,groupByKeys:n=!1,groupByFn:o,props:a}=i,r=uN(a);return([l])=>(s===!1||l.dataSet===t)&&(l.opts.groupByKeys??!1)===n&&l.opts.groupByFn===o&&uN(l.opts.props)===r}static mergeRequests(t){const i={ids:[],rejects:[],resolves:[],dataSet:t[0].dataSet,opts:{...t[0].opts,props:[]}},s=new Map,n=new Map;let o=0;for(const a of t){const{id:r,dataSet:l,resolve:c,reject:h,opts:{props:d,...u}}=a;i.ids.push(r),i.rejects.push(h),i.resolves.push(c),i.dataSet??(i.dataSet=l),i.opts??(i.opts={...u,props:[]});for(const p of d){const f={...p,scopes:[r],data:l.data};Ao.createIdsMap(r,f);let y;Ao.crossScopeMergableTypes.has(f.type)?y=-1:n.has(l.data)?y=n.get(l.data):(y=o++,n.set(l.data,y));const b=`${f.type}-${y}-${f.groupId}`,x=s.get(b),v=x?.find(S=>Ao.deepEqual(S,f));if(x==null){i.opts.props.push(f),s.set(b,[f]);continue}else if(v==null){i.opts.props.push(f),x.push(f);continue}f.scopes!=null&&(v.scopes??(v.scopes=[]),v.scopes.push(...f.scopes)),(v.type==="key"||v.type==="value")&&f.idsMap?.size&&(v.idsMap??(v.idsMap=new Map),Ao.mergeIdsMap(f.idsMap,v.idsMap))}}return i}static mergeIdsMap(t,i){for(const[s,n]of t){const o=i.get(s);if(o==null)i.set(s,new Set(n));else for(const a of n)o.add(a)}}static createIdsMap(t,i){i.id!=null&&(i.idsMap??(i.idsMap=new Map),i.idsMap.has(t)?i.idsMap.get(t).add(i.id):i.idsMap.set(t,new Set([i.id])))}static deepEqual(t,i){if(t===i)return!0;if(t&&i&&typeof t=="object"&&typeof i=="object"){if(t.constructor!==i.constructor)return!1;let s,n;if(Array.isArray(t)){if(n=t.length,n!==i.length)return!1;for(s=n-1;s>=0;s--)if(!Ao.deepEqual(t[s],i[s]))return!1;return!0}const o=Object.keys(t);if(n=o.length,n!==Object.keys(i).length)return!1;for(s=n-1;s>=0;s--){const a=o[s];if(!Ao.skipKeys.has(a)&&(!Object.hasOwn(i,a)||!Ao.deepEqual(t[a],i[a])))return!1}return!0}return!1}static jsonReplacer(t,i){return i instanceof Map?{__type:"Map",value:Array.from(i.entries())}:i instanceof Set?{__type:"Set",value:Array.from(i)}:i}};eD.crossScopeMergableTypes=new Set(["key","group-value-processor"]),eD.skipKeys=new Set(["id","idsMap","type","scopes","data"]);var pN=eD,cu=class eS{constructor(t){this.data=t,this.pendingTransactions=[]}static empty(){return new eS([])}static wrap(t){return new eS(t)}netSize(){if(!this.hasPendingTransactions())return this.data.length;const t=this.getChangeDescription();return t?t.indexMap.finalLength:this.data.length}addTransaction(t){const i=this.normalizeTransaction(t);this.pendingTransactions.push(i),this.cachedChangeDescription=void 0}deepClone(){return new eS([...this.data])}normalizeTransaction(t){const{add:i,addIndex:s,prepend:n,append:o,remove:a,update:r}=t;if(i===void 0)return t;const l={remove:a,update:r};if(n&&(l.prepend=n),o&&(l.append=o),i&&i.length>0){const c=this.netSize();s===void 0||s>=c?l.append=o?[...o,...i]:i:s===0?l.prepend=n?[...i,...n]:i:l.insertions=[{index:s,items:i}]}return l}hasPendingTransactions(){return this.pendingTransactions.length>0}getPendingTransactionCount(){return this.pendingTransactions.length}commitPendingTransactions(){if(!this.hasPendingTransactions())return!1;const t=this.getChangeDescription();if(!t)return!1;const i=t.getPrependedValues(),s=t.getInsertionValues(),n=t.getAppendedValues(),o=[...i,...s,...n];let a=0;return t.applyToArray(this.data,function(l){if(a>=o.length)throw new Error(`AG Charts - Internal error: No insertion value found for index ${l}`);return o[a++]}),this.pendingTransactions=[],this.cachedChangeDescription=void 0,this.updateItemToIndexCache(t,n,i,s),!0}updateItemToIndexCache(t,i,s,n){if(!this.itemToIndexCache)return;const{indexMap:o}=t,{totalPrependCount:a,totalAppendCount:r,removedIndices:l}=o,c=l.size>0,h=n.length>0;if(!c&&a===0&&r===0&&!h)return;if(h){this.itemToIndexCache=void 0;return}let d=!1,u=0;if(c){const b=Array.from(l).sort((x,v)=>x-v);if(d=b[0]===0,d){for(let x=0;x<b.length;x++)if(b[x]!==x){d=!1;break}d&&(u=b.length)}}if(c&&!d){this.itemToIndexCache=void 0;return}const p=this.itemToIndexCache,f=a-u;if(f!==0)for(const[b,x]of p)l.has(x)?p.delete(b):p.set(b,x+f);else if(c)for(const[b,x]of p)l.has(x)&&p.delete(b);for(let b=0;b<s.length;b++){const x=s[b];p.has(x)||p.set(x,b)}const y=o.finalLength-r;for(let b=0;b<i.length;b++){const x=i[b];p.has(x)||p.set(x,y+b)}}clearPendingTransactions(){const t=this.pendingTransactions.length;return this.pendingTransactions=[],this.cachedChangeDescription=void 0,t}getPendingTransactions(){return[...this.pendingTransactions]}toJSON(){return this.data}getChangeDescription(){if(!this.hasPendingTransactions())return;if(this.cachedChangeDescription)return this.cachedChangeDescription;const{indexMap:t,prependValues:i,appendValues:s,insertionValues:n}=this.buildIndexMap(),o=new Cj(t,{prependValues:i,appendValues:s,insertionValues:n});return this.cachedChangeDescription=o,o}removeFromGroups(t,i){for(const s of t){let n=0;for(;n<s.length&&i.size>0;)i.has(s[n])?(i.delete(s[n]),s.splice(n,1)):n++;if(i.size===0)break}}buildIndexMap(){const t=this.data.length,i=this.collectTransactionEffects(),s=i.prependsList.flat(),n=i.appendsList.flat(),o=i.insertionsList.flat(),a=s.length,r=n.length,l=o.length,c=t-i.removedOriginalIndices.size,h=a+c+l+r,d=i.removedOriginalIndices.size>0?this.getSortedRemovedIndices(i.removedOriginalIndices):void 0,u=this.buildSpliceOperations(a,l,r,c,i.trackedInsertions,d?.desc,d?.asc),p=this.resolveUpdatedIndices(a,l,c,i.updateTracking,d?.asc,i.updatedOriginalIndices,i.trackedInsertions);return{indexMap:{originalLength:t,finalLength:h,spliceOps:u,removedIndices:i.removedOriginalIndices,updatedIndices:p,totalPrependCount:a,totalAppendCount:r},prependValues:s,appendValues:n,insertionValues:o}}getSortedRemovedIndices(t){const i=Array.from(t).sort((s,n)=>s-n);return{asc:i,desc:[...i].reverse()}}collectTransactionEffects(){const t={prependsList:[],appendsList:[],insertionsList:[],trackedInsertions:[],removedOriginalIndices:new Set,updatedOriginalIndices:new Set,virtualLength:this.data.length};for(const i of this.pendingTransactions){const{prepend:s,append:n,insertions:o,remove:a,update:r}=i;this.applyPrepends(s,t),this.applyInsertions(o,t),this.applyAppends(n,t),this.applyRemovals(a,t),this.applyUpdates(r,t)}return{prependsList:t.prependsList,appendsList:t.appendsList,insertionsList:t.insertionsList,trackedInsertions:t.trackedInsertions,removedOriginalIndices:t.removedOriginalIndices,updatedOriginalIndices:t.updatedOriginalIndices,updateTracking:t.updateTracking}}applyPrepends(t,i){!Array.isArray(t)||t.length===0||(i.prependsList.unshift([...t]),i.virtualLength+=t.length)}applyInsertions(t,i){if(Array.isArray(t))for(const{index:s,items:n}of t)s>=0&&s<=i.virtualLength&&n.length>0&&(i.trackedInsertions.push({virtualIndex:s,items:[...n]}),i.insertionsList.push([...n]),i.virtualLength+=n.length)}applyAppends(t,i){!Array.isArray(t)||t.length===0||(i.appendsList.push([...t]),i.virtualLength+=t.length)}applyRemovals(t,i){if(!Array.isArray(t)||t.length===0)return;const s=new Set(t);if(this.removeFromGroups(i.prependsList,s),s.size>0&&this.removeFromGroups(i.insertionsList,s),i.trackedInsertions.length>0&&this.removeFromTrackedInsertions(t,i),s.size>0&&this.removeFromGroups(i.appendsList,s),s.size>0)for(let n=0;n<this.data.length&&s.size>0;n++){const o=this.data[n];s.has(o)&&(i.removedOriginalIndices.add(n),s.delete(o),i.virtualLength--)}s.size>0&&j.warnOnce("applyTransaction() remove includes items not present in current data; ignoring missing items.")}applyUpdates(t,i){if(!Array.isArray(t)||t.length===0)return;const s=new Set(t),n=this.collectUpdatedIndicesFromGroups(i.prependsList,s),o=s.size>0?this.collectUpdatedIndicesFromGroups(i.insertionsList,s):[],a=s.size>0?this.collectUpdatedIndicesFromGroups(i.appendsList,s):[];s.size>0&&this.collectUpdatedOriginalIndices(s,i),i.updateTracking={updatedPrependsIndices:n,updatedAppendsIndices:a,updatedInsertionsIndices:o},s.size>0&&j.warnOnce("applyTransaction() update includes items not present in current data; ignoring missing items.")}collectUpdatedIndicesFromGroups(t,i){if(i.size===0||t.length===0)return[];const s=[];let n=0;for(const o of t){for(const a of o)i.has(a)&&(s.push(n),i.delete(a)),n++;if(i.size===0)break}return s}getItemToIndexMap(){if(this.itemToIndexCache===void 0){this.itemToIndexCache=new Map;for(let t=0;t<this.data.length;t++)this.itemToIndexCache.has(this.data[t])||this.itemToIndexCache.set(this.data[t],t)}return this.itemToIndexCache}collectUpdatedOriginalIndices(t,i){const s=this.getItemToIndexMap();for(const n of[...t]){const o=s.get(n);o!==void 0&&!i.removedOriginalIndices.has(o)&&(i.updatedOriginalIndices.add(o),t.delete(n))}}removeFromTrackedInsertions(t,i){for(let s=0;s<i.trackedInsertions.length;s++){const n=i.trackedInsertions[s],o=n.items.length,a=[];let r=0;for(;r<n.items.length;)t.includes(n.items[r])?(a.push(r+a.length),n.items.splice(r,1),i.virtualLength--):r++;a.length>0&&this.adjustLaterInsertionsAfterRemoval(i.trackedInsertions,s,n,o,a)}}adjustLaterInsertionsAfterRemoval(t,i,s,n,o){const a=o.length;for(let r=i+1;r<t.length;r++){const l=t[r];if(l.virtualIndex<=s.virtualIndex)continue;const c=Math.min(Math.max(l.virtualIndex-s.virtualIndex,0),n);let h=0;for(const d of o)if(d<c)h++;else break;c===n&&(h=a),h>0&&(l.virtualIndex-=h)}}buildSpliceOperations(t,i,s,n,o,a,r){const l=[];if(t>0&&l.push({index:0,deleteCount:0,insertCount:t}),a&&a.length>0){let c=a[0],h=1;for(let d=1;d<a.length;d++){const u=a[d];a[d-1]-u===1?h++:(l.push({index:c-h+1+t,deleteCount:h,insertCount:0}),c=u,h=1)}l.push({index:c-h+1+t,deleteCount:h,insertCount:0})}if(o.length>0)for(const c of o){const h=this.countRemovalsBeforeIndex(r,t,c.virtualIndex),d=c.virtualIndex-h;l.push({index:d,deleteCount:0,insertCount:c.items.length})}return s>0&&l.push({index:t+n+i,deleteCount:0,insertCount:s}),l}countRemovalsBeforeIndex(t,i,s){if(!t||t.length===0)return 0;let n=0;for(const o of t)if(o+i<s)n++;else break;return n}resolveUpdatedIndices(t,i,s,n,o,a,r){const l=new Set;if(n)for(const c of n.updatedPrependsIndices)l.add(c);if(a.size>0){const c=Array.from(a).sort((d,u)=>d-u);let h=0;for(const d of c){if(o)for(;h<o.length&&o[h]<d;)h++;const u=o?h:0,p=d+t;let f=0;for(const b of r)b.virtualIndex<=p&&(f+=b.items.length);const y=d+t-u+f;l.add(y)}}if(n){const c=t+s+i;for(const h of n.updatedAppendsIndices)l.add(c+h);if(n.updatedInsertionsIndices.length>0&&r.length>0){let h=0;for(const d of r){const u=this.countRemovalsBeforeIndex(o,t,d.virtualIndex),p=d.virtualIndex-u;for(let f=0;f<d.items.length;f++)n.updatedInsertionsIndices.includes(h)&&l.add(p+f),h++}}}return l}},tD=class el{constructor(t){this.chart=t}subscribe(t=el.DEFAULT_GROUP){let i=this.get(t);return i||(i={members:new Set},el.chartsGroups.set(t,i)),i.members.add(this.chart),this}unsubscribe(t=el.DEFAULT_GROUP){const i=this.get(t);return i?.members.delete(this.chart),delete i?.domains?.x?.sources?.[this.chart.id],delete i?.domains?.y?.sources?.[this.chart.id],this}getChart(){return this.chart}getGroupState(t=el.DEFAULT_GROUP){return this.get(t)}getGroupMembers(t=el.DEFAULT_GROUP){const i=this.get(t);return i?Array.from(i.members):[]}getGroupSiblings(t=el.DEFAULT_GROUP){return this.getGroupMembers(t).filter(i=>i!==this.chart)}getGroupSyncMode(t=el.DEFAULT_GROUP){return this.getGroupMembers(t).some(i=>i.series.length>1)?"multi-series":"single-series"}get(t){return el.chartsGroups.get(t)}};tD.chartsGroups=new Map,tD.DEFAULT_GROUP=Symbol("sync-group-default");var I4=tD,iD=class extends K{constructor(){super(...arguments),this.enabled=!1}};g([m],iD.prototype,"enabled",2),g([m],iD.prototype,"tabIndex",2);var gN={};Vs(gN,{NODE_UPDATE_STATE_TO_PHASE_MAPPING:()=>Ho,fromToMotion:()=>li,staticFromToMotion:()=>Nl});var Ho={added:"add",updated:"update",removed:"remove",unknown:"initial","no-op":"none"};function li(e,t,i,s,n,o,a){const{fromFn:r,toFn:l,applyFn:c=(f,y)=>f.setProperties(y)}=n,{nodes:h,selections:d}=PM(s),u=(f,y)=>{let b,x=0,v=0;for(const S of y){const M=f[x]===S,D={last:v>=y.length-1,lastLive:x>=f.length-1,prev:y[v-1],prevFromProps:b,prevLive:f[x-1],next:y[v+1],nextLive:f[x+(M?1:0)]},k=`${e}_${t}_${S.id}`;i.stopByAnimationId(k);let I="unknown";M?o&&a&&(I=k4(S,S.datum,o,a)):I="removed",S.transitionOut=I==="removed";const{phase:A,start:C,finish:w,delay:T,duration:O,...E}=r(S,S.datum,I,D),{phase:z,start:F,finish:_,delay:G,duration:B,...V}=l(S,S.datum,I,D),Y=w==null;i.animate({id:k,groupId:e,phase:A??z??"update",duration:O??B,delay:T??G,from:E,to:V,ease:xr,collapsable:Y,onPlay:()=>{const X={...C,...F,...E};c(S,X,"start")},onUpdate(X){c(S,X,"update")},onStop:()=>{const X={...C,...F,...E,...V,...w,..._};c(S,X,"end")}}),M&&x++,v++,b=E}};let p=0;for(const f of d){const y=f.nodes(),b=y.filter(x=>!f.isGarbage(x));u(b,y),i.animate({id:`${e}_${t}_selection_${p}`,groupId:e,phase:"end",from:0,to:1,ease:xr,onStop(){f.cleanup()}}),p++}u(h,h)}function Nl(e,t,i,s,n,o,a){const{nodes:r,selections:l}=PM(s),{start:c,finish:h,phase:d}=a;i.animate({id:`${e}_${t}`,groupId:e,phase:d??"update",from:n,to:o,ease:xr,onPlay:()=>{if(c){for(const u of r)u.setProperties(c);for(const u of l){const p=u.nodes();u.batchedUpdate(function(){for(const y of p)y.setProperties(c)})}}},onUpdate(u){for(const p of r)p.setProperties(u);for(const p of l){const f=p.nodes();p.batchedUpdate(function(){for(const b of f)b.setProperties(u)})}},onStop:()=>{for(const u of r)u.setProperties({...o,...h});for(const u of l){const p=u.nodes();u.batchedUpdate(function(){for(const y of p)y.setProperties({...o,...h});u.cleanup()})}}})}function k4(e,t,i,s){const n=i(e,t);return s.added.has(n)?"added":s.removed.has(n)?"removed":e.previousDatum==null&&e.datum!=null?"added":e.previousDatum!=null&&e.datum==null?"removed":"updated"}var fN={};Vs(fN,{resetMotion:()=>Ui});function Ui(e,t){const{nodes:i,selections:s}=PM(e);for(const n of s){const o=n.nodes();n.batchedUpdate(function(){for(const r of o){const l=t(r,r.datum);r.setProperties(l)}n.cleanup()})}for(const n of i){const o=t(n,n.datum);n.setProperties(o)}}var ci=class Kh{constructor(t,i,s=!0){this.parentNode=t,this.autoCleanup=s,this.garbageBin=new Set,this._nodesMap=new Map,this._nodes=[],this.data=[],this.debug=Me.create(!0,"scene","scene:selections"),this.nodeFactory=Object.prototype.isPrototypeOf.call(vr,i)?()=>new i:i}static select(t,i,s=!0){return new Kh(t,i,s)}static selectAll(t,i){const s=[],n=o=>{if(i(o)&&s.push(o),o instanceof Oe)for(const a of o.children())n(a)};return n(t),s}static selectByClass(t,...i){return Kh.selectAll(t,s=>i.some(n=>s instanceof n))}static selectByTag(t,i){return Kh.selectAll(t,s=>s.tag===i)}createNode(t,i,s){const n=this.nodeFactory(t);return n.datum=t,i?.(n),s==null?this._nodes.push(n):this._nodes.splice(s,0,n),this.parentNode.appendChild(n),n}update(t,i,s){if(this.garbageBin.size>0&&this.debug("Selection - update() called with pending garbage",t),s&&this._nodesMap.size===0&&this._nodes.length>0)for(const n of this._nodes)this.garbageBin.add(n);if(!s&&this._nodesMap.size>0&&this._nodesMap.clear(),s){const n=new Map,o=new Map;for(let a=0;a<t.length;a++){const r=t[a];let l=s(r);if(n.has(l)){const c=(o.get(l)??0)+1;o.set(l,c),l=`${l}:${c}`}n.set(l,a)}for(const[a,r]of this._nodesMap.entries()){const l=n.get(r);l==null?this.garbageBin.add(a):(a.datum=t[l],this.garbageBin.delete(a),n.delete(r))}for(const[a,r]of n.entries()){const l=t[r];this._nodesMap.set(this.createNode(l,i,r),a)}}else{const n=Math.max(t.length,this.data.length);for(let o=0;o<n;o++)o>=t.length?this.garbageBin.add(this._nodes[o]):o>=this._nodes.length?this.createNode(t[o],i):(this._nodes[o].datum=t[o],this.garbageBin.delete(this._nodes[o]))}return this.data=t.slice(),this.autoCleanup&&this.cleanup(),this}cleanup(){if(this.garbageBin.size===0)return this;const t=this;function i(s){return t.garbageBin.has(s)?(t._nodesMap.delete(s),t.garbageBin.delete(s),s.destroy(),!1):!0}return this._nodes=this._nodes.filter(i),this}clear(){this.update([]);for(const t of this._nodesMap.keys())this.garbageBin.add(t);return this._nodesMap.clear(),this}isGarbage(t){return this.garbageBin.has(t)}each(t){const i=this._nodes;return this.parentNode.batchedUpdate(function(){for(const n of i.entries())t(n[1],n[1].datum,n[0])}),this}*[Symbol.iterator](){for(let t=0;t<this._nodes.length;t++){const i=this._nodes[t];yield{node:i,datum:i.datum,index:t}}}select(t){return Kh.selectAll(this.parentNode,t)}selectByClass(t){return Kh.selectByClass(this.parentNode,t)}selectByTag(t){return Kh.selectByTag(this.parentNode,t)}nodes(){return this._nodes}at(t){return this._nodes.at(t)}get length(){return this._nodes.length}batchedUpdate(t){this.parentNode.batchedUpdate(t)}},En=class extends Hc{constructor(e={}){super(e),this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.fill=void 0,this.strokeWidth=1}set x(e){this.x1=e,this.x2=e}set y(e){this.y1=e,this.y2=e}get midPoint(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}}computeBBox(){return new re(Math.min(this.x1,this.x2),Math.min(this.y1,this.y2),Math.abs(this.x2-this.x1),Math.abs(this.y2-this.y1))}isPointInPath(e,t){return this.x1===this.x2||this.y1===this.y2?this.getBBox().clone().grow(this.strokeWidth/2).containsPoint(e,t):!1}distanceSquared(e,t){const{x1:i,y1:s,x2:n,y2:o}=this;return dr(e,t,i,s,n,o,1/0)}render(e){const{ctx:t,devicePixelRatio:i}=e;let{x1:s,y1:n,x2:o,y2:a}=this;if(s===o){const{strokeWidth:r}=this,l=Math.round(s*i)/i+Math.trunc(r*i)%2/(i*2);s=l,o=l}else if(n===a){const{strokeWidth:r}=this,l=Math.round(n*i)/i+Math.trunc(r*i)%2/(i*2);n=l,a=l}t.beginPath(),t.moveTo(s,n),t.lineTo(o,a),this.fillStroke(t),this.fillShadow?.markClean(),super.render(e)}toSVG(){if(!this.visible)return;const e=Pt("line");return e.setAttribute("x1",String(this.x1)),e.setAttribute("y1",String(this.y1)),e.setAttribute("x2",String(this.x2)),e.setAttribute("y2",String(this.y2)),this.applySvgStrokeAttributes(e),{elements:[e]}}};En.className="Line",g([U()],En.prototype,"x1",2),g([U()],En.prototype,"y1",2),g([U()],En.prototype,"x2",2),g([U()],En.prototype,"y2",2);var Yc=class{constructor(){this.enabled=!0}};g([m],Yc.prototype,"enabled",2),g([m],Yc.prototype,"stroke",2),g([m],Yc.prototype,"strokeWidth",2),g([m],Yc.prototype,"strokeOpacity",2);var Yt=class extends K{constructor(){super(...arguments),this.enabled=!1,this.border=new Yc,this._cachedFormatter=void 0}formatValue(e,t,i,s){const{formatter:n,format:o}=this;let a;if(n!=null&&(a??(a=e(n,s))),o!=null){let r=this._cachedFormatter;(r==null||r.type!==t||r.format!==o)&&(r={type:t,format:o,formatter:ru.getFormatter(t,o)},this._cachedFormatter=r),a??(a=r.formatter?.(i))}return a==null||Ce(a)?a:String(a)}};g([m],Yt.prototype,"enabled",2),g([m],Yt.prototype,"border",2),g([m],Yt.prototype,"color",2),g([m],Yt.prototype,"cornerRadius",2),g([m],Yt.prototype,"fill",2),g([m],Yt.prototype,"fillOpacity",2),g([m],Yt.prototype,"fontStyle",2),g([m],Yt.prototype,"fontWeight",2),g([m],Yt.prototype,"fontSize",2),g([m],Yt.prototype,"fontFamily",2),g([m],Yt.prototype,"formatter",2),g([m],Yt.prototype,"format",2),g([m],Yt.prototype,"padding",2),g([m],Yt.prototype,"itemStyler",2);function hu(e){const{enabled:t=!1,stroke:i}=e?.border??{},n=e?.fill!=null||t&&i!=null?e?.padding:null;if(n==null)return{bottom:0,left:0,right:0,top:0};if(typeof n=="number")return{bottom:n,left:n,right:n,top:n};{const{bottom:o=0,left:a=0,right:r=0,top:l=0}=n;return{bottom:o,left:a,right:r,top:l}}}var sD=class{constructor(){this.moduleMap=new Map}modules(){return this.moduleMap.values()}addModule(e,t){if(this.moduleMap.has(e))throw new Error(`AG Charts - module already initialised: ${e}`);this.moduleMap.set(e,t)}removeModule(e){this.moduleMap.get(e)?.destroy?.(),this.moduleMap.delete(e)}getModule(e){return this.moduleMap.get(e)}isEnabled(e){return this.moduleMap.has(e)}mapModules(e){return Array.from(this.moduleMap.values(),e)}destroy(){for(const e of this.moduleMap.values())e?.destroy?.();this.moduleMap.clear()}},Ia=class extends Hc{constructor(e={}){super(e),this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.startLine=!1,this.endLine=!1,this.horizontal=!1,this.strokeWidth=1}computeBBox(){return new re(this.x1,this.y1,this.x2-this.x1,this.y2-this.y1)}isPointInPath(e,t){return!1}render(e){const{ctx:t}=e;let{x1:i,y1:s,x2:n,y2:o}=this;i=this.align(i),s=this.align(s),n=this.align(n),o=this.align(o);const{fill:a,horizontal:r}=this,{globalAlpha:l}=t;a!=null&&(this.applyFillAndAlpha(t),t.beginPath(),t.moveTo(i,s),t.lineTo(n,s),t.lineTo(n,o),t.lineTo(i,o),t.closePath(),t.fill(),t.globalAlpha=l);const{stroke:c,strokeWidth:h,startLine:d,endLine:u}=this;if(!!((d||u)&&c&&h)){const{lineDash:f,lineDashOffset:y,lineCap:b,lineJoin:x}=this;this.applyStrokeAndAlpha(t),t.lineWidth=h,f&&t.setLineDash([...f]),y&&(t.lineDashOffset=y),b&&(t.lineCap=b),x&&(t.lineJoin=x),t.beginPath(),d&&(t.moveTo(i,s),r?t.lineTo(i,o):t.lineTo(n,s)),u&&(t.moveTo(n,o),r?t.lineTo(n,s):t.lineTo(i,o)),t.stroke(),t.globalAlpha=l}this.fillShadow?.markClean(),super.render(e)}};Ia.className="Range",g([U()],Ia.prototype,"x1",2),g([U()],Ia.prototype,"y1",2),g([U()],Ia.prototype,"x2",2),g([U()],Ia.prototype,"y2",2),g([U()],Ia.prototype,"startLine",2),g([U()],Ia.prototype,"endLine",2),g([U()],Ia.prototype,"horizontal",2);function mN(e){switch(e.type){case"line":return e.value;case"range":return e.range}}function yN(e,t){const i=mN(e);if(i==null)return!1;const s=yt.is(t)||Da.is(t),n=o=>U0(o,s)&&!Number.isNaN(t.convert(o,{clamp:!0}));if(e.type==="range"){const[o,a]=i;return n(o)&&n(a)}else return n(i)}var A4={top:{rangeH:0,rangeV:-1,labelH:0,labelV:1},"inside-top":{rangeH:0,rangeV:-1,labelH:0,labelV:1},"top-left":{rangeH:-1,rangeV:-1,labelH:-1,labelV:1},"inside-top-left":{rangeH:-1,rangeV:-1,labelH:-1,labelV:1},left:{rangeH:-1,rangeV:0,labelH:1,labelV:0},"inside-left":{rangeH:-1,rangeV:0,labelH:-1,labelV:0},"bottom-left":{rangeH:-1,rangeV:1,labelH:-1,labelV:-1},"inside-bottom-left":{rangeH:-1,rangeV:1,labelH:-1,labelV:-1},bottom:{rangeH:0,rangeV:1,labelH:0,labelV:-1},"inside-bottom":{rangeH:0,rangeV:1,labelH:0,labelV:-1},"bottom-right":{rangeH:1,rangeV:1,labelH:1,labelV:-1},"inside-bottom-right":{rangeH:1,rangeV:1,labelH:1,labelV:-1},right:{rangeH:1,rangeV:0,labelH:-1,labelV:0},"inside-right":{rangeH:1,rangeV:0,labelH:1,labelV:0},"top-right":{rangeH:1,rangeV:-1,labelH:1,labelV:1},"inside-top-right":{rangeH:1,rangeV:-1,labelH:1,labelV:1},inside:{rangeH:0,rangeV:0,labelH:0,labelV:0}},C4={top:{rangeH:0,rangeV:-1,labelH:0,labelV:1},"inside-top":{rangeH:0,rangeV:-1,labelH:0,labelV:-1},"top-left":{rangeH:-1,rangeV:-1,labelH:1,labelV:-1},"inside-top-left":{rangeH:-1,rangeV:-1,labelH:1,labelV:-1},left:{rangeH:-1,rangeV:0,labelH:1,labelV:0},"inside-left":{rangeH:-1,rangeV:0,labelH:1,labelV:0},"bottom-left":{rangeH:-1,rangeV:1,labelH:1,labelV:1},"inside-bottom-left":{rangeH:-1,rangeV:1,labelH:1,labelV:1},bottom:{rangeH:0,rangeV:1,labelH:0,labelV:-1},"inside-bottom":{rangeH:0,rangeV:1,labelH:0,labelV:1},"bottom-right":{rangeH:1,rangeV:1,labelH:-1,labelV:1},"inside-bottom-right":{rangeH:1,rangeV:1,labelH:-1,labelV:1},right:{rangeH:1,rangeV:0,labelH:-1,labelV:0},"inside-right":{rangeH:1,rangeV:0,labelH:-1,labelV:0},"top-right":{rangeH:1,rangeV:-1,labelH:-1,labelV:-1},"inside-top-right":{rangeH:-1,rangeV:-1,labelH:-1,labelV:-1},inside:{rangeH:0,rangeV:0,labelH:0,labelV:0}},L4={top:{rangeH:0,rangeV:-1,labelH:0,labelV:1},"inside-top":{rangeH:0,rangeV:-1,labelH:0,labelV:-1},"top-left":{rangeH:-1,rangeV:-1,labelH:-1,labelV:1},"inside-top-left":{rangeH:-1,rangeV:-1,labelH:-1,labelV:-1},left:{rangeH:-1,rangeV:0,labelH:1,labelV:0},"inside-left":{rangeH:-1,rangeV:0,labelH:-1,labelV:0},"bottom-left":{rangeH:-1,rangeV:1,labelH:-1,labelV:-1},"inside-bottom-left":{rangeH:-1,rangeV:1,labelH:-1,labelV:1},bottom:{rangeH:0,rangeV:1,labelH:0,labelV:-1},"inside-bottom":{rangeH:0,rangeV:1,labelH:0,labelV:1},"bottom-right":{rangeH:1,rangeV:1,labelH:1,labelV:-1},"inside-bottom-right":{rangeH:1,rangeV:1,labelH:1,labelV:1},right:{rangeH:1,rangeV:0,labelH:-1,labelV:0},"inside-right":{rangeH:1,rangeV:0,labelH:1,labelV:0},"top-right":{rangeH:1,rangeV:-1,labelH:1,labelV:1},"inside-top-right":{rangeH:1,rangeV:-1,labelH:1,labelV:-1},inside:{rangeH:0,rangeV:0,labelH:0,labelV:0}},w4={top:{rangeH:0,rangeV:-1,labelH:0,labelV:1},"inside-top":{rangeH:0,rangeV:-1,labelH:0,labelV:-1},"top-left":{rangeH:-1,rangeV:-1,labelH:1,labelV:-1},"inside-top-left":{rangeH:-1,rangeV:-1,labelH:-1,labelV:-1},left:{rangeH:-1,rangeV:0,labelH:1,labelV:0},"inside-left":{rangeH:-1,rangeV:0,labelH:-1,labelV:0},"bottom-left":{rangeH:-1,rangeV:1,labelH:1,labelV:1},"inside-bottom-left":{rangeH:-1,rangeV:1,labelH:-1,labelV:1},bottom:{rangeH:0,rangeV:1,labelH:0,labelV:-1},"inside-bottom":{rangeH:0,rangeV:1,labelH:0,labelV:1},"bottom-right":{rangeH:1,rangeV:1,labelH:-1,labelV:1},"inside-bottom-right":{rangeH:1,rangeV:1,labelH:1,labelV:1},right:{rangeH:1,rangeV:0,labelH:-1,labelV:0},"inside-right":{rangeH:1,rangeV:0,labelH:1,labelV:0},"top-right":{rangeH:1,rangeV:-1,labelH:-1,labelV:-1},"inside-top-right":{rangeH:1,rangeV:-1,labelH:1,labelV:-1},inside:{rangeH:0,rangeV:0,labelH:0,labelV:0}},co=class extends K{constructor(){super(...arguments),this.fontSize=14,this.fontFamily="Verdana, sans-serif",this.padding=5,this.color="rgba(87, 87, 87, 1)"}};g([m],co.prototype,"enabled",2),g([m],co.prototype,"text",2),g([m],co.prototype,"fontStyle",2),g([m],co.prototype,"fontWeight",2),g([m],co.prototype,"fontSize",2),g([m],co.prototype,"fontFamily",2),g([m],co.prototype,"padding",2),g([m],co.prototype,"color",2),g([m],co.prototype,"position",2),g([m],co.prototype,"rotation",2),g([m],co.prototype,"parallel",2);var ws=class extends K{constructor(){super(),this.id=Mi(this),this.defaultColorRange=[],this.fill="#c16068",this.label=new co,this.scale=void 0,this.clippedRange=[-1/0,1/0],this.gridLength=0,this.position="top",this.rangeGroup=new Oe({name:this.id}),this.lineGroup=new Oe({name:this.id}),this.labelGroup=new Oe({name:this.id}),this.crossLineRange=new Ia,this.crossLineLabel=new su,this.data=void 0,this.startLine=!1,this.endLine=!1,this._isRange=void 0,this.lineGroup.append(this.crossLineRange),this.labelGroup.append(this.crossLineLabel),this.crossLineRange.pointerEvents=1}get defaultLabelPosition(){return"top"}update(e){const{enabled:t,type:i,data:s,scale:n}=this;if(!n||!t||!e||!yN(this,n)||s==null){this.rangeGroup.visible=!1,this.lineGroup.visible=!1,this.labelGroup.visible=!1;return}this.rangeGroup.visible=e,this.lineGroup.visible=e,this.labelGroup.visible=e,this.updateNodes();const o=i==="range";o!==this._isRange&&(o?this.rangeGroup.appendChild(this.crossLineRange):this.lineGroup.appendChild(this.crossLineRange)),this._isRange=o}calculateLayout(e){if(this.data=void 0,!e)return;const{type:t,range:i,value:s,scale:n,clippedRange:o,strokeWidth:a=0}=this;if(!n)return;const r=n.bandwidth??0,l=n.step??0,c=n instanceof Ma?(l-r)/2:0;let[h,d]=Tt(o);h-=r,d+=r;let u,p,f,y;if(t==="line"){const b=r/2;if(u=n.convert(s)+b,p=Number.NaN,f=n.convert(s,{clamp:!0})+b,y=Number.NaN,f>=d||f<=h)return}else if(i){const[b,x]=i,[v,S]=lN(b,x);if(u=n.convert(b,{alignment:v}),p=n.convert(x,{alignment:S}),f=n.convert(b,{clamp:!0,alignment:v}),y=n.convert(x,{clamp:!0,alignment:S}),f>y&&([f,y]=[y,f],[u,p]=[p,u]),f>=d||y<=h)return;Number.isFinite(u)&&(f-=c),Number.isFinite(p)&&(p+=r,y+=r+c)}else return;f=Ac(f,o),y=Ac(y,o),u-c>=f&&(u-=c),p+c<=y&&(p+=c),this.startLine=a>0&&u>=f&&u<=f+c,this.endLine=a>0&&p>=y-r-c&&p<=y,this.data=[f,y],this.label.enabled===!1||this.label.text}updateNodes(){const{position:e,data:[t,i]=[0,0],gridLength:s}=this,n=Number.isFinite(i)?i-t:0;let o;switch(e){case"top":case"bottom":o=new re(t,e==="top"?0:-s,n,s);break;case"left":case"right":o=new re(e==="left"?0:-s,t,s,n)}this.updateRangeNode(o);const{label:a}=this;a.enabled!==!1&&a.text&&(this.updateLabel(),this.positionLabel(o))}updateRangeNode(e){const{type:t,position:i,crossLineRange:s,startLine:n,endLine:o,fill:a,fillOpacity:r,stroke:l,strokeWidth:c,strokeOpacity:h,lineDash:d}=this;s.x1=e.x,s.x2=e.x+e.width,s.y1=e.y,s.y2=e.y+e.height,s.horizontal=i==="top"||i==="bottom",s.startLine=n,s.endLine=o,s.fill=t==="range"?a:void 0,s.fillOpacity=r??1,s.stroke=l,s.strokeWidth=c??1,s.strokeOpacity=h??1,s.lineDash=d}updateLabel(){const{crossLineLabel:e,label:t}=this;t.text&&(e.fontStyle=t.fontStyle,e.fontWeight=t.fontWeight,e.fontSize=t.fontSize,e.fontFamily=t.fontFamily,e.fill=t.color,e.text=t.text)}get anchor(){const e=this.position==="left"||this.position==="right",t=this.type==="range",{position:i=this.defaultLabelPosition}=this.label;return t?(e?L4:w4)[i]:(e?A4:C4)[i]}positionLabel(e){const{crossLineLabel:t,label:i,anchor:s}=this;t.rotation=mt(i.rotation??0),t.textBaseline="middle",t.textAlign="center";const n=t.getBBox();if(!n)return;const{width:o,height:a}=n,r=i.padding+o/2,l=i.padding+a/2,c=e.x+e.width*(s.rangeH+1)/2-r*s.labelH,h=e.y+e.height*(s.rangeV+1)/2-l*s.labelV;t.x=c,t.y=h,t.rotationCenterX=c,t.rotationCenterY=h}computeLabelSize(){const{label:e}=this;if(e.enabled===!1||!e.text)return;const t=new su;t.fontFamily=e.fontFamily,t.fontSize=e.fontSize,t.fontStyle=e.fontStyle,t.fontWeight=e.fontWeight,t.text=e.text,t.rotation=mt(e.rotation??0),t.textBaseline="middle",t.textAlign="center";const i=t.getBBox();if(!i)return;const{width:s,height:n}=i;return{width:s,height:n}}calculatePadding(e){const{label:t,anchor:i}=this,s=this.computeLabelSize();if(!s)return;const{width:n,height:o}=s,a=t.padding+n,r=t.padding+o,l=this.position==="left"||this.position==="right";l&&(i.rangeH===-1&&i.labelH===1?e.left=Math.max(e.left??0,a):i.rangeH===1&&i.labelH===-1&&(e.right=Math.max(e.right??0,a))),l||(i.rangeV===-1&&i.labelV===1?e.top=Math.max(e.top??0,r):i.rangeV===1&&i.labelV===-1&&(e.bottom=Math.max(e.bottom??0,r)))}};ws.className="CrossLine",g([m],ws.prototype,"enabled",2),g([m],ws.prototype,"type",2),g([m],ws.prototype,"range",2),g([m],ws.prototype,"value",2),g([m],ws.prototype,"defaultColorRange",2),g([m],ws.prototype,"fill",2),g([m],ws.prototype,"fillOpacity",2),g([m],ws.prototype,"stroke",2),g([m],ws.prototype,"strokeWidth",2),g([m],ws.prototype,"strokeOpacity",2),g([m],ws.prototype,"lineDash",2),g([m],ws.prototype,"label",2);var hx=class{constructor(){this.enabled=!0,this.width=1,this.style=[{fill:void 0,fillOpacity:1,stroke:void 0,strokeWidth:void 0,lineDash:[]}]}};g([m],hx.prototype,"enabled",2),g([m],hx.prototype,"width",2),g([m],hx.prototype,"style",2);var Zc=class extends K{};g([m],Zc.prototype,"placement",2),g([m],Zc.prototype,"step",2),g([m],Zc.prototype,"values",2),g([m],Zc.prototype,"minSpacing",2),g([m],Zc.prototype,"maxSpacing",2);var Nt=class extends K{constructor(){super(...arguments),this.enabled=!0,this.border=new Yc,this.wrapping="never",this.truncate=!1,this.spacing=5,this.color="#575757",this.avoidCollisions=!0,this.mirrored=!1,this.parallel=!1,this._formatters={"component:year":void 0,"component:month":void 0,"component:day":void 0,"component:none":void 0,"long:year":void 0,"long:month":void 0,"long:day":void 0,"long:none":void 0}}getSideFlag(){return this.mirrored?1:-1}formatValue(e,t,i,s){const{formatter:n,format:o}=this,{type:a,value:r,domain:l,boundSeries:c}=t,h=t.type==="number"?t.fractionDigits:void 0,d=t.type==="date"?t.unit:void 0;let u;if(n!=null){const p=t.type==="date"?t.step:void 0;u=e(n,{value:r,index:i,domain:l,fractionDigits:h,unit:d,step:p,boundSeries:c})}if(o!=null&&u==null){const{specifier:p,dateStyle:f="long",truncateDate:y}=s??{},b=`${f}:${y??"none"}`;let x=this._formatters[b];const v=ru.mergeSpecifiers(p,o);(x==null||x.type!==a||x.unit!==d||!ii(x.mergedFormat,v))&&(x={type:a,mergedFormat:v,unit:d,formatter:ru.getFormatter(a,v,d,f,{truncateDate:y})},this._formatters[b]=x),u=x.formatter?.(r,h)}return u==null||Ce(u)?u:String(u)}};g([m],Nt.prototype,"enabled",2),g([m],Nt.prototype,"border",2),g([m],Nt.prototype,"cornerRadius",2),g([m],Nt.prototype,"fill",2),g([m],Nt.prototype,"fillOpacity",2),g([m],Nt.prototype,"fontStyle",2),g([m],Nt.prototype,"fontWeight",2),g([m],Nt.prototype,"fontSize",2),g([m],Nt.prototype,"fontFamily",2),g([m],Nt.prototype,"wrapping",2),g([m],Nt.prototype,"truncate",2),g([m],Nt.prototype,"spacing",2),g([m],Nt.prototype,"minSpacing",2),g([m],Nt.prototype,"color",2),g([m],Nt.prototype,"rotation",2),g([m],Nt.prototype,"avoidCollisions",2),g([m],Nt.prototype,"mirrored",2),g([m],Nt.prototype,"padding",2),g([m],Nt.prototype,"parallel",2),g([m],Nt.prototype,"itemStyler",2),g([m],Nt.prototype,"formatter",2),g([m],Nt.prototype,"format",2);var dx=class{constructor(){this.enabled=!0,this.width=1,this.stroke=void 0}};g([m],dx.prototype,"enabled",2),g([m],dx.prototype,"width",2),g([m],dx.prototype,"stroke",2);var Xc=class extends K{constructor(){super(...arguments),this.enabled=!0,this.width=1,this.size=6}};g([m],Xc.prototype,"enabled",2),g([m],Xc.prototype,"width",2),g([m],Xc.prototype,"size",2),g([m],Xc.prototype,"stroke",2);var jo=class extends K{constructor(){super(...arguments),this.caption=new Et,this.enabled=!1,this.spacing=Et.SMALL_PADDING,this.fontSize=10,this.fontFamily="sans-serif",this.wrapping="always"}};g([m],jo.prototype,"enabled",2),g([m],jo.prototype,"text",2),g([m],jo.prototype,"spacing",2),g([m],jo.prototype,"fontStyle",2),g([m],jo.prototype,"fontWeight",2),g([m],jo.prototype,"fontSize",2),g([m],jo.prototype,"fontFamily",2),g([m],jo.prototype,"color",2),g([m],jo.prototype,"wrapping",2),g([m],jo.prototype,"formatter",2);var xN=(e=>(e[e.TickAndDomain=0]="TickAndDomain",e[e.TicksOnly=1]="TicksOnly",e[e.Off=2]="Off",e))(xN||{});function T4(e){const[t,i]=Tt(e.range),s=Math.floor(t),n=Math.ceil(i);return{min:s,max:n,visible:s!==n}}var nD=Math.PI*2,N4=nD/2;function O4(e,t){return Math.abs(t-e)<N4?t:e>t?t+nD:t-nD}function E4(e){const{min:t,max:i}=e,s=l=>l<t||l>i;return{tick:{fromFn(l,c,h){let{x1:d,x2:u,y1:p,y2:f}=l,y=l.opacity;return(h==="added"||s(c.offset))&&({x1:d,x2:u,y1:p,y2:f}=c,y=0),{x1:d,x2:u,y1:p,y2:f,opacity:y,phase:Ho[h]}},toFn(l,c,h){const{x1:d,x2:u,y1:p,y2:f}=c;let y=1;return h==="removed"&&(y=0),{x1:d,x2:u,y1:p,y2:f,opacity:y}},applyFn(l,c){l.setProperties(c),l.visible=!s(l.y)}},line:{fromFn(l,c){const{x1:h,x2:d,y1:u,y2:p}=l.previousDatum??c;return{x1:h,x2:d,y1:u,y2:p,phase:Ho.updated}},toFn(l,c){const{x1:h,x2:d,y1:u,y2:p}=c;return{x1:h,x2:d,y1:u,y2:p}}},label:{fromFn(l,c,h){const d=l.previousDatum??c;let{x:u,y:p,rotationCenterX:f,rotationCenterY:y,rotation:b}=d,x=l.opacity;return h==="removed"||s(d.y)?b=c.rotation:(h==="added"||s(l.datum.y))&&({x:u,y:p,rotationCenterX:f,rotationCenterY:y,rotation:b}=c,x=0),{x:u,y:p,rotationCenterX:f,rotationCenterY:y,rotation:b,opacity:x,phase:Ho[h]}},toFn(l,c,h){const{x:d,y:u,rotationCenterX:p,rotationCenterY:f}=c;let y=0,b=1;return h==="added"?y=c.rotation:h==="removed"?(b=0,y=c.rotation):y=O4(l.previousDatum?.rotation??c.rotation,c.rotation),{x:d,y:u,rotationCenterX:p,rotationCenterY:f,rotation:y,opacity:b,finish:{rotation:c.rotation}}}},group:{fromFn(l,c){const{translationX:h,translationY:d}=l;return{translationX:h,translationY:d,phase:Ho.updated}},toFn(l,c){const{translationX:h,translationY:d}=c;return{translationX:h,translationY:d}}}}}function P4(){return(e,t)=>({translationX:t.translationX,translationY:t.translationY})}function ux(){return(e,t)=>({x:t.x,y:t.y,rotationCenterX:t.rotationCenterX,rotationCenterY:t.rotationCenterY,rotation:t.rotation})}function bN(){return(e,t)=>{const{x1:i,x2:s,y1:n,y2:o}=t;return{x1:i,x2:s,y1:n,y2:o}}}function R4(){return(e,t)=>{const{x1:i,x2:s,y1:n,y2:o}=t;return{x:i,y:n,width:s-i,height:o-n}}}var vN=(e=>(e[e.TickLines=0]="TickLines",e[e.AxisLine=1]="AxisLine",e[e.TickLabels=2]="TickLabels",e))(vN||{});function SN(e,t){return e.domain===t.domain&&e.rangeExtent===t.rangeExtent&&e.nice[0]===t.nice[0]&&e.nice[1]===t.nice[1]&&e.gridLength===t.gridLength&&e.visibleRange[0]===t.visibleRange[0]&&e.visibleRange[1]===t.visibleRange[1]&&e.initialPrimaryTickCount?.unzoomed===t.initialPrimaryTickCount?.unzoomed&&e.initialPrimaryTickCount?.zoomed===t.initialPrimaryTickCount?.zoomed}function MN(e,t,i){const s=e.bandwidth??0,o=((e.step??0)-s)/2,a=e.convert(i),r=a-o,l=a+s+o;return[a,Ac(r,t),Ac(l,t)]}var Ol=class GB{constructor(t,i){this.moduleCtx=t,this.scale=i,this.id="unknown",this._crossLines=[],this.nice=!0,this.reverse=!1,this.interval=new Zc,this.dataDomain={domain:[],clipped:!1},this.title=new jo,this.gridLength=0,this.gridPadding=0,this.seriesAreaPadding=0,this.layoutConstraints={stacked:!0,align:"start",width:100,unit:"percent"},this.boundSeries=[],this.includeInvisibleDomains=!1,this.interactionEnabled=!0,this.axisGroup=new Oe({name:`${this.id}-axis`}),this.tickLineGroup=this.axisGroup.appendChild(new eu({name:`${this.id}-Axis-tick-lines`,zIndex:0})),this.tickLabelGroup=this.axisGroup.appendChild(new eu({name:`${this.id}-Axis-tick-labels`,zIndex:2})),this.labelGroup=new Oe({name:`${this.id}-Labels`,zIndex:11}),this.gridGroup=new ls({name:`${this.id}-Axis-grid`,zIndex:2}),this.gridFillGroup=this.gridGroup.appendChild(new Oe({name:`${this.id}-gridFills`})),this.gridLineGroup=this.gridGroup.appendChild(new Oe({name:`${this.id}-gridLines`})),this.crossLineRangeGroup=new eu({name:`${this.id}-CrossLines-Range`,zIndex:6}),this.crossLineLineGroup=new eu({name:`${this.id}-CrossLines-Line`,zIndex:10}),this.crossLineLabelGroup=new eu({name:`${this.id}-CrossLines-Label`,zIndex:15}),this.tickLabelGroupSelection=ci.select(this.tickLabelGroup,su,!1),this.line=new dx,this.tick=new Xc,this.gridLine=new hx,this.label=this.createLabel(),this.defaultTickMinSpacing=GB.defaultTickMinSpacing,this.translation={x:0,y:0},this.layout={label:{fractionDigits:0,spacing:this.label.spacing,format:this.label.format}},this.axisContext=void 0,this.cleanup=new pt,this.isHovering=!1,this.range=[0,1],this.visibleRange=[0,1],this.animatable=!0,this.tickLayout=void 0,this.formatterBoundSeries=new m0(()=>{const{direction:s,boundSeries:n}=this;return on(n.flatMap(o=>o.getFormatterContext(s)))}),this.moduleMap=new sD,this.range=this.scale.range.slice();for(const s of this.crossLines)this.initCrossLine(s);this.cleanup.register(this.moduleCtx.widgets.containerWidget.addListener("mousemove",s=>this.onMouseMove(s)),this.moduleCtx.widgets.containerWidget.addListener("mouseleave",()=>this.endHovering()))}set crossLines(t){const{CrossLineConstructor:i}=this.constructor;for(const s of this._crossLines)this.detachCrossLine(s);this._crossLines=t.map(s=>{const n=new i;return n.set(s),n});for(const s of this._crossLines)this.attachCrossLine(s),this.initCrossLine(s)}get crossLines(){return this._crossLines}get type(){return this.constructor.type??""}get primaryLabel(){}get primaryTick(){}isCategoryLike(){return!1}resetAnimation(t){}onMouseMove(t){const s=this.tickLabelGroup.pickNode(t.currentX,t.currentY)?.datum,{textUntruncated:n=void 0}=s??{};n?(this.moduleCtx.tooltipManager.updateTooltip(this.id,{canvasX:t.currentX,canvasY:t.currentY,showArrow:!1},[{type:"structured",title:n}]),this.isHovering=!0):this.endHovering()}endHovering(){this.isHovering&&(this.moduleCtx.tooltipManager.removeTooltip(this.id,void 0,!0),this.isHovering=!1)}attachCrossLine(t){this.crossLineRangeGroup.appendChild(t.rangeGroup),this.crossLineLineGroup.appendChild(t.lineGroup),this.crossLineLabelGroup.appendChild(t.labelGroup)}detachCrossLine(t){t.rangeGroup.remove(),t.lineGroup.remove(),t.labelGroup.remove()}destroy(){this.moduleMap.destroy(),this.cleanup.flush()}setScaleRange(t){const{range:i,scale:s}=this,n=(i[1]-i[0])/(t[1]-t[0]),o=n*t[0],a=i[0]-o;s.range=[a,a+n]}updateScale(){const{range:[t,i]}=this;this.setScaleRange(this.visibleRange);for(const s of this.crossLines)s.clippedRange=[t,i]}setCrossLinesVisible(t){this.crossLineRangeGroup.visible=t,this.crossLineLineGroup.visible=t,this.crossLineLabelGroup.visible=t}attachAxis(t){t.gridNode.appendChild(this.gridGroup),t.axisNode.appendChild(this.axisGroup),t.labelNode.appendChild(this.labelGroup),t.crossLineRangeNode.appendChild(this.crossLineRangeGroup),t.crossLineLineNode.appendChild(this.crossLineLineGroup),t.crossLineLabelNode.appendChild(this.crossLineLabelGroup)}detachAxis(){this.gridGroup.remove(),this.axisGroup.remove(),this.labelGroup.remove(),this.crossLineRangeGroup.remove(),this.crossLineLineGroup.remove(),this.crossLineLabelGroup.remove()}attachLabel(t){this.labelGroup.append(t)}inRange(t,i=0){const[s,n]=Tt(this.range);return t>=s-i&&t<=n+i}getRangeOverflow(t){const{range:i,visibleRange:s}=this,n=(i[1]-i[0])/(s[1]-s[0]),[o,a]=Tt([i[0]-n*s[0],i[0]-n*s[0]+n]);return t<o?t-o:t>a?t-a:0}onGridLengthChange(t,i){i^t&&this.onGridVisibilityChange();for(const s of this.crossLines)this.initCrossLine(s)}onGridVisibilityChange(){}createLabel(){return new Nt}update(){this.formatterBoundSeries.clear(),this.updatePosition(),this.updateSelections(),this.gridLineGroup.visible=this.gridLine.enabled,this.updateLabels(),this.updateCrossLines()}getLabelStyles(t,i,s=this.label){const n={border:s.border,color:s.color,cornerRadius:s.cornerRadius,fill:s.fill,fillOpacity:s.fillOpacity,fontFamily:s.fontFamily,fontSize:s.fontSize,fontStyle:s.fontStyle,fontWeight:s.fontWeight,padding:s.padding,spacing:s.spacing};let o;s.itemStyler&&(o=this.cachedCallWithContext(s.itemStyler,{...t,...n}));const a=oe(o,i,n);return{border:a.border,color:a.color,cornerRadius:a.cornerRadius,fill:a.fill,fillOpacity:a.fillOpacity,fontFamily:a.fontFamily,fontSize:a.fontSize,fontStyle:a.fontStyle,fontWeight:a.fontWeight,padding:a.padding,spacing:a.spacing}}getTickSize(t=this.tick){return t.enabled?t.size:0}processData(){this.invalidateLayoutCache();const{includeInvisibleDomains:t,boundSeries:i,direction:s}=this,o=(t?i:i.filter(a=>a.isEnabled())).map(a=>a.getDomain(s));this.setDomains(...o)}getDomainExtentsNice(){return[this.nice,this.nice]}setDomains(...t){let i,s;if(t.length>0){const n=this.scale.normalizeDomains(...t);i={domain:n.domain,sortMetadata:{sortOrder:1}},s=n.animatable}else i={domain:[]},s=!0;this.dataDomain=this.normaliseDataDomain(i),this.reverse&&this.dataDomain.domain.reverse(),this.animatable=s}calculateDomain(t){const{dataDomain:{domain:i},range:s,scale:n,gridLength:o}=this,a=da(s),r=[0,1],l=this.getDomainExtentsNice();this.updateScale();const{unzoomedTickLayoutCache:c}=this;let h;if(c==null||!SN(c,{domain:i,rangeExtent:a,nice:l,gridLength:o,visibleRange:r,initialPrimaryTickCount:t})){const d=n.range;this.setScaleRange([0,1]);const u=l.map(p=>p?0:2);h=this.calculateTickLayout(i,u,[0,1],t),n.range=d,this.unzoomedTickLayoutCache={domain:i,rangeExtent:a,nice:l,gridLength:o,visibleRange:r,initialPrimaryTickCount:t,tickLayout:h}}else h=c.tickLayout;return this.updateScale(),n.domain=h.niceDomain,{unzoomedTickLayout:h,domain:n.domain}}calculateLayout(t,i){this.chartLayout=i;const{visibleRange:s}=this,n=s[0]===0&&s[1]===1,{unzoomedTickLayout:o,domain:a}=this.calculateDomain(t),r=this.getDomainExtentsNice();let l;if(n)l=o;else{const{range:f,gridLength:y}=this,b=da(f),x=r.map(S=>S?1:2),{tickLayoutCache:v}=this;v==null||!SN(v,{domain:a,rangeExtent:b,nice:r,gridLength:y,visibleRange:s,initialPrimaryTickCount:t})?(l=this.calculateTickLayout(a,x,s,t),this.tickLayoutCache={domain:a,rangeExtent:b,nice:r,gridLength:y,visibleRange:s,initialPrimaryTickCount:t,tickLayout:l}):l=v.tickLayout}const{rawTickCount:c=0,fractionDigits:h,bbox:d}=l,u=o.rawTickCount??0,p=c!==0&&u!==0?{zoomed:c,unzoomed:u}:void 0;return this.tickLayout=l.layout,this.layout.label={fractionDigits:h,spacing:this.label.spacing,format:this.label.format},this.layoutCrossLines(),{primaryTickCount:p,bbox:d}}invalidateLayoutCache(){this.unzoomedTickLayoutCache=void 0,this.tickLayoutCache=void 0,this.tickLayout=void 0}updateCrossLines(){const t=this.hasDefinedDomain()||this.hasVisibleSeries();for(const i of this.crossLines)i.update(t)}updatePosition(){const{crossLineRangeGroup:t,crossLineLineGroup:i,crossLineLabelGroup:s,gridGroup:n,translation:o}=this,a=Math.floor(o.x),r=Math.floor(o.y);n.setProperties({translationX:a,translationY:r}),t.setProperties({translationX:a,translationY:r}),i.setProperties({translationX:a,translationY:r}),s.setProperties({translationX:a,translationY:r})}tickFormatter(t,i,s,n,o,a="long"){const{moduleCtx:r,label:l}=this,{formatManager:c}=r,h=s?this.primaryLabel:void 0,d=this.tickFormatParams(t,i,n,o),u=this.formatterBoundSeries.get();let p,f,y;if(d.type==="number")p=d.fractionDigits;else if(d.type==="date"){const{unit:D,step:k,epoch:I}=d;f={unit:D,step:k,epoch:I},y=d.truncateDate}const b=this.uncachedCallWithContext.bind(this),x={datum:void 0,seriesId:void 0,legendItemName:void 0,key:void 0,source:"axis-label",property:this.getFormatterProperty(),domain:t,boundSeries:u},v=h??l,S=s?l.format:void 0,M={specifier:ru.mergeSpecifiers(h?.format,l.format),truncateDate:y};return(D,k)=>{const I=this.datumFormatParams(D,x,p,f,a);return I.value=D,v.formatValue(b,I,k,{specifier:S,dateStyle:a,truncateDate:y})??c.format(b,I,M)??c.defaultFormat(I,M)}}formatDatum(t,i,s,n,o,a,r,l,c,h){if(i==null)return"";const{moduleCtx:d,dataDomain:u}=this;l??(l=u.domain);const{formatManager:p}=d,f=this.formatterBoundSeries.get();let y;switch(s){case"crosshair":case"annotation-label":y=this.layout.label.fractionDigits+1;break;case"series-label":y=2;break;case"tooltip":y=3;break;case"legend-label":y=void 0;break}const b=this.datumFormatParams(i,{source:s,datum:a,seriesId:n,legendItemName:o,key:r,property:this.getFormatterProperty(),domain:l,boundSeries:f},y,void 0,"long"),{type:x,value:v}=b,S=this.createCallWithContext(t),M=c?.formatValue(S,x,v,h??b)??p.format(S,b)??this.label.formatValue(S,b,Number.NaN)??p.defaultFormat(b);return Ce(M)?M:String(M)}getBBox(){return this.axisGroup.getBBox()}initCrossLine(t){t.scale=this.scale,t.gridLength=this.gridLength}hasVisibleSeries(){return this.boundSeries.some(t=>t.isEnabled())}clipTickLines(t,i,s,n){this.tickLineGroup.setClipRect(new re(t,i,s,n))}clipGrid(t,i,s,n){this.gridGroup.setClipRect(new re(t,i,s,n))}getFormatterProperty(){const{direction:t,boundSeries:i}=this;let s=t;for(const n of i){const o=n.resolveKeyDirection(t);if(o!==t){s=o;break}}return s}getTitleFormatterParams(t){const{direction:i}=this,s=this.formatterBoundSeries.get();return{domain:t,direction:i,boundSeries:s,defaultValue:this.title?.text}}normaliseDataDomain(t){return{domain:[...t.domain],clipped:!1}}getLayoutState(){return{id:this.id,rect:this.getBBox(),gridPadding:this.gridPadding,seriesAreaPadding:this.seriesAreaPadding,tickSize:this.getTickSize(),direction:this.direction,domain:this.dataDomain.domain,scale:this.scale,...this.layout}}getModuleMap(){return this.moduleMap}createModuleContext(){return this.axisContext??(this.axisContext=this.createAxisContext()),{...this.moduleCtx,parent:this.axisContext}}createAxisContext(){const{scale:t}=this;return{axisId:this.id,scale:this.scale,direction:this.direction,continuous:yt.is(t)||Da.is(t),getCanvasBounds:()=>Kt.toCanvas(this.axisGroup),seriesKeyProperties:()=>this.boundSeries.reduce((i,s)=>{const n=s.getKeyProperties(this.direction);for(const o of n)i.add(o);return i},new Set),seriesIds:()=>this.boundSeries.map(i=>i.id),scaleInvert:i=>t.invert(i,!0),scaleInvertNearest:i=>t.invert(i,!0),formatScaleValue:(i,s,n)=>this.formatDatum(void 0,i,s,void 0,void 0,void 0,void 0,void 0,n),attachLabel:i=>this.attachLabel(i),inRange:(i,s)=>this.inRange(i,s),getRangeOverflow:i=>this.getRangeOverflow(i),pickBand:i=>this.pickBand(i),measureBand:i=>this.measureBand(i)}}pickBand(t){if(!Ma.is(this.scale))return;const{scale:i,range:s,id:n}=this,o=i.invert(this.isVertical()?t.y:t.x,!0),[a,r,l]=MN(i,s,o);return{id:n,value:o,band:[r,l],position:a}}measureBand(t){if(!Ma.is(this.scale))return;const[,i,s]=MN(this.scale,this.range,t);return{band:[i,s]}}isVertical(){return this.direction==="y"}isReversed(){return this.reverse}cachedCallWithContext(t,i){const{callbackCache:s,chartService:n}=this.moduleCtx;return s.call([this,n],t,i)}uncachedCallWithContext(t,i){const{chartService:s}=this.moduleCtx;return as([this,s],t,i)}createCallWithContext(t){const{chartService:i}=this.moduleCtx;return(s,n)=>as([t,this,i],s,n)}};Ol.defaultTickMinSpacing=50,Ol.CrossLineConstructor=ws,g([m],Ol.prototype,"nice",2),g([m],Ol.prototype,"reverse",2),g([m],Ol.prototype,"interval",2),g([m],Ol.prototype,"title",2),g([Wt((e,t,i)=>e.onGridLengthChange(t,i))],Ol.prototype,"gridLength",2);var oD=Ol,aD=class extends Nt{constructor(){super(...arguments),this.autoRotateAngle=335}};g([m],aD.prototype,"autoRotate",2),g([m],aD.prototype,"autoRotateAngle",2);var qc=class HB extends Ma{constructor(){super(...arguments),this.type="category",this.defaultTickCount=0,this.index=new Map,this.indexInitialized=!1,this._domain=[]}static is(t){return t instanceof HB}set domain(t){this._domain!==t&&(this.invalid=!0,this._domain=t,this.index.clear(),this.indexInitialized=!1)}get domain(){return this._domain}get bands(){return this._domain}normalizeDomains(...t){let i;const s=new Set;let n=!0;for(const o of t){const a=o.domain;s.has(a)||(s.add(a),i==null?i=DN(a):(n&&(n=F4(a,i)),i=DN([...i,...a])))}return i??(i=[]),{domain:i,animatable:n}}toDomain(t){}invert(t,i=!1){this.refresh();const s=i?this.bandwidth/2:0,n=this.invertNearestIndex(Math.max(0,t-s));return i||t===this.ordinalRange(n)?this.domain[n]:void 0}ticks(t,i=this.domain,s){const{bands:n}=this;let{tickCount:o}=t;if(o===0){const y=n.length>1?1:0;return{ticks:n[y]?[n[y]]:[],count:void 0,firstTickIndex:y}}let a=o!=null&&o!==0?Math.trunc(n.length/o):1;if(a=_m(a),a<=1)return jw(i,!1,s);o=Math.trunc(n.length/a);const r=a*o,l=_m(Math.trunc((n.length-r)/2)),c=ge(0,Math.floor((s?.[0]??0)*n.length),n.length),h=ge(0,Math.ceil((s?.[1]??1)*n.length),n.length),d=Math.floor((c-l)/a)*a+l,u=Math.ceil((h-l)/a)*a+l,p=[];for(let y=d;y<u;y+=a)y>=0&&y<n.length&&p.push(n[y]);let f=p.length>0?this.findIndex(p[0]):void 0;return f!=null&&(f=Math.floor((f-l)/a)),{ticks:p,count:void 0,firstTickIndex:f}}findIndex(t){const{index:i,indexInitialized:s}=this;if(!s){const{domain:n}=this;for(let o=0;o<n.length;o++)i.set(Wi(n[o]),o);this.indexInitialized=!0}return i.get(Wi(t))}};function DN(e){let t;const i=new Set;for(const s of e){const n=Wi(s),o=i.size;i.add(n),i.size!==o?t?.push(s):t??(t=e.slice(0,i.size))}return t??e}function F4(e,t){let i=-1;for(const s of e){const n=t.indexOf(s);if(n===-1)i=1/0;else{if(n<=i)return!1;i=n}}return!0}var px=new Date(1970,0,4),du=class jB extends yt{constructor(){super([],[0,1]),this.type="time"}static is(t){return t instanceof jB}toDomain(t){return new Date(t)}convert(t,i){return super.convert(typeof t=="number"?t:t?.valueOf()??Number.NaN,i)}invert(t){return new Date(super.invert(t))}niceDomain(t,i=this.domain){if(i.length<2)return[];let[s,n]=i;const o=4,a=this.getPixelRange();for(let r=0;r<o;r++){const[l,c]=B4(s,n,t,a);if(Wi(s)===Wi(l)&&Wi(n)===Wi(c))break;s=l,n=c}return[s,n]}ticks(t,i=this.domain,s=[0,1],{extend:n=!1}={}){const{nice:o,interval:a,tickCount:r=yt.defaultTickCount,minTickCount:l,maxTickCount:c}=t;if(i.length<2)return;const h=i.map(Wi),d=h[0],u=h.at(-1);if(a!=null){const b=this.getPixelRange();return{ticks:IN({start:d,stop:u,interval:a,availableRange:b,visibleRange:s,extend:n})??z4({start:d,stop:u,tickCount:r,minTickCount:l,maxTickCount:c,visibleRange:s,extend:n}),count:void 0}}else{if(o.every(Boolean)&&r===2)return{ticks:i,count:void 0};if(o.every(Boolean)&&r===1)return{ticks:i.slice(0,1),count:void 0}}const p=jd(d,u,r,l,c,{weekStart:px});if(p==null)return;const f=wn(p,new Date(d),new Date(u),{visibleRange:s,extend:n}),y=ky(p,new Date(d),new Date(u),{visibleRange:s,extend:n});return{ticks:f,count:void 0,firstTickIndex:y,timeInterval:p}}};function z4({start:e,stop:t,tickCount:i,minTickCount:s,maxTickCount:n,visibleRange:o,extend:a}){const r=jd(e,t,i,s,n,{weekStart:px});return r?wn(r,new Date(e),new Date(t),{visibleRange:o,extend:a}):[]}function IN({start:e,stop:t,interval:i,availableRange:s,visibleRange:n,extend:o}){if(!i)return[];if(st(i)||typeof i=="string"){const d=wn(i,new Date(e),new Date(t),{visibleRange:n,extend:o});return Ml(d.length,s)?void 0:d}const a=Math.abs(i);if(Ml(Math.abs(t-e)/a,s))return;const r=xg.findLast(d=>a%d.duration===0);if(r){const{timeInterval:d,step:u,duration:p}=r,f={...d,step:u*Fo(d)*Math.round(a/p),epoch:Ay(d,{weekStart:px})};return wn(f,new Date(e),new Date(t),{visibleRange:n,extend:o})}let l=new Date(Math.min(e,t));const c=new Date(Math.max(e,t)),h=[];for(;l<=c;)h.push(l),l=new Date(l),l.setMilliseconds(l.getMilliseconds()+a);return h}function B4(e,t,i,s){const{interval:n}=i,o=Math.min(Wi(e),Wi(t)),a=Math.max(Wi(e),Wi(t));let r;if(st(n)||typeof n=="string")r=n;else{let d;typeof n=="number"&&(d=(a-o)/Math.max(n,1),Ml(d,s)&&(d=void 0)),d??(d=i.tickCount??yt.defaultTickCount),r=jd(o,a,d,i.minTickCount,i.maxTickCount,{weekStart:px})}if(r==null)return[e,t];const l=wn(r,new Date(o),new Date(a),{extend:!0});if(l==null||l.length<2)return[e,t];const c=l[0],h=l.at(-1);return e<=t?[c,h]:[h,c]}var _4=1e3,El=class WB extends Da{constructor(){super(...arguments),this.type="ordinal-time",this.defaultTickCount=yt.defaultTickCount,this._domain=[],this.isReversed=!1}static is(t){return t instanceof WB}set domain(t){t!==this._domain&&(this.invalid=!0,this._domain=t,this._bands=void 0,this._numericBands=void 0,this._uniformityCache=void 0,this.isReversed=kN(t))}get domain(){return this._domain}get bands(){return this._bands??(this._bands=this.isReversed?this.domain.slice().reverse():this.domain),this._bands}get numericBands(){return this._numericBands??(this._numericBands=this.bands.map(t=>t.valueOf())),this._numericBands}getUniformityCache(t){const{bands:i}=this,s=i.length;if(!t||t[0]===0&&t[1]===1)return s>_4&&this._uniformityCache===void 0&&(this._uniformityCache=nN(i)),this._uniformityCache;const n=Math.floor(t[0]*s),o=Math.min(Math.ceil(t[1]*s),s-1);return nN(i,n,o)}normalizeDomains(...t){const i=t.filter(o=>o.domain.length>0);if(i.length===0)return{domain:[],animatable:!1};const s=i[0].domain,n=i.every(o=>o.domain===s);if(i.length===1||n){const o=i[0];let a=o.domain,r,l=!1;return o.sortMetadata?.sortOrder===void 0?r=ry(a):(r=o.sortMetadata.sortOrder,l=o.sortMetadata.isUnique??!1),r===-1?a=a.slice().reverse():r==null&&(a=l?a.slice().sort((c,h)=>c.valueOf()-h.valueOf()):ay(a.slice())),{domain:a,animatable:!0}}return{domain:ay(i.map(o=>o.domain).flat()),animatable:!0}}ticks(t,i,s=[0,1],{extend:n=!1,dropInitial:o=!1}={}){const{interval:a,maxTickCount:r,tickCount:l=r}=t,{bands:c}=this;if(!c.length)return;if(this.refresh(),a==null){const{ticks:v,tickOffset:S,tickEvery:M}=this.getDefaultTicks(i,l,s,n);let D=v.length>0?this.findIndex(v[0]):void 0;return D=D==null?void 0:Math.floor((D-S)/M),{ticks:v,count:void 0,firstTickIndex:D}}let h,d;i&&i.length>=2?(h=i[0].valueOf(),d=i.at(-1).valueOf()):(h=c[0].valueOf(),d=c.at(-1).valueOf());const[u,p]=this.range,f=Math.abs(p-u),y=IN({start:h,stop:d,interval:a,availableRange:f,visibleRange:s,extend:n})??this.getDefaultTicks(i,l,s,n).ticks,b=[];let x=-1;for(const v of y){const S=this.findIndex(v,1)??-1,M=S===x;x=S,!(o&&S===0)&&S!==-1&&!M&&b.push(c[S])}return{ticks:b,count:void 0,firstTickIndex:void 0}}stepTicks(t,i,s=[0,1],n=!0){const o=i?this.bandDomainIndices(i):void 0,a=this.ticksEvery(o,s,t,0,!1),r=a.at(-1),l=n&&t>1?o?.[1]:void 0,c=l!=null&&r!=null?this.findIndex(r):void 0;return c!=null&&l!=null&&l-c<t&&a.pop(),a}bandCount(t=[0,1]){const{domain:i}=this,s=Math.floor(t[0]*i.length);return Math.ceil(t[1]*i.length)-s}getDefaultTicks(t,i,s,n){const{bands:o}=this,a=Math.ceil(o.length/i),r=Math.floor(a/2),l=t?this.bandDomainIndices(t):void 0;return{ticks:this.ticksEvery(l,s,a,r,n),tickOffset:r,tickEvery:a}}bandDomainIndices(t){const i=kN(t),s=this.findIndex(t[i?t.length-1:0],1)??0,n=this.findIndex(t[i?0:t.length-1],1)??this.bands.length-1;return[s,n]}ticksEvery([t,i]=[0,this.bands.length],s,n,o,a){const{bands:r}=this,l=t,c=i-t+1;let h=l+Math.floor(s[0]*c),d=l+Math.ceil(s[1]*c);a&&(h-=n,d+=n),h=Math.max(h,0),d=Math.min(d,r.length);let u;if(n<=1)u=r.slice(h,d);else{u=[];for(let p=h;p<d;p+=1)(p-l+o)%n===0&&u.push(r[p])}return u}};function kN(e){return e.length>0&&e[0]>e.at(-1)}var V4=1e3,rD=5e7,Pl=class $B extends Da{constructor(){super(...arguments),this.type="unit-time",this.defaultTickCount=12,this._domain=[],this._bands=void 0}static is(t){return t instanceof $B}static supportsInterval(t,i){return AN(t,i)}set domain(t){t!==this._domain&&(this._domain=t,this._bands=void 0,this._numericBands=void 0,this._uniformityCache=void 0,this._domainBoundaries=void 0,this._bandRangeCache=void 0,this._encodedBands=void 0,this._encodingParams=void 0,this._linearParams=void 0)}get domain(){return this._domain}get interval(){return this._interval}set interval(t){this._interval!==t&&(this._interval=t,this._bands=void 0,this._numericBands=void 0,this._uniformityCache=void 0,this._domainBoundaries=void 0,this._bandRangeCache=void 0,this._encodedBands=void 0,this._encodingParams=void 0,this._linearParams=void 0)}get bands(){if(this._bands===void 0)if(this.ensureEncodedBands(),this._encodedBands!=null&&this._encodingParams!=null){const t=this._encodingParams;this._bands=this._encodedBands.map(i=>j0(i,t))}else this._bands=[];return this._bands}get numericBands(){if(this._numericBands===void 0)if(this.ensureEncodedBands(),this._encodedBands!=null&&this._encodingParams!=null){const t=this._encodingParams;this._numericBands=this._encodedBands.map(i=>mr(i,t))}else this._numericBands=[];return this._numericBands}ensureEncodedBands(){if(this._encodedBands!==void 0)return;const{domain:t,interval:i}=this;if(t.length<2||i==null){this._encodedBands=[];return}const s=this.getCachedBandRange();if(s==null){this._encodedBands=[];return}const[n,o]=s,a={visibleRange:[0,1],extend:!1};if(mg(i,n,o,a)>rD){j.warnOnce("the configured unit results in too many bands, ignoring. Supply a larger unit."),this._encodedBands=[];return}const{encodedValues:r,encodingParams:l}=H0(i,n,o,a);this._encodedBands=r,this._encodingParams=l}getBandCountForUpdate(){return this.ensureEncodedBands(),this._encodedBands?.length??0}getUniformityCache(t){const i=this.getBandCountForUpdate();if(!t||t[0]===0&&t[1]===1){if(i>V4&&this._uniformityCache===void 0)if(this.ensureEncodedBands(),this._encodingParams!=null&&this._encodedBands!=null&&this._encodedBands.length>=2){const s=mr(this._encodedBands[0],this._encodingParams),n=mr(this._encodedBands[1],this._encodingParams);this._uniformityCache={isUniform:!0,interval:n-s}}else this._uniformityCache={isUniform:!1};return this._uniformityCache}if(this.ensureEncodedBands(),this._encodingParams!=null&&this._encodedBands!=null&&this._encodedBands.length>=2){const s=mr(this._encodedBands[0],this._encodingParams);return{isUniform:!0,interval:mr(this._encodedBands[1],this._encodingParams)-s}}return{isUniform:!1}}normalizeDomains(...t){return iN(...t)}getCachedBandRange(){const{domain:t,interval:i}=this;if(!(t.length<2||i==null))return this._bandRangeCache??(this._bandRangeCache={start:Ys(i,t[0]),stop:Ys(i,t[1])}),[this._bandRangeCache.start,this._bandRangeCache.stop]}getDomainBoundaries(){const{interval:t}=this;if(t!=null){if(this._domainBoundaries===void 0){const i=this.getCachedBandRange();if(i==null)return;const[s,n]=i,o=Math.min(s.valueOf(),n.valueOf()),a=Math.max(s.valueOf(),n.valueOf()),r=Dy(t,new Date(a)).valueOf();this._domainBoundaries={d0:o,dNext:r}}return this._domainBoundaries}}getLinearParams(){if(this._linearParams===void 0&&(this.ensureEncodedBands(),this._encodedBands!=null&&this._encodingParams!=null&&this._encodedBands.length>=2)){const t=mr(this._encodedBands[0],this._encodingParams),i=mr(this._encodedBands[1],this._encodingParams);this._linearParams={firstBandTime:t,intervalMs:i-t}}return this._linearParams}isLinearUnit(){const t=this._encodingParams?.unit;return t==="millisecond"||t==="second"||t==="minute"||t==="hour"}findIndex(t,i=0){if(t==null)return;const s=this.getBandCountForUpdate();if(s===0)return;if(s===1)return 0;const n=this.getLinearParams();if(n==null||n.intervalMs===0)return super.findIndex(t,i);const{firstBandTime:o,intervalMs:a}=n,r=t.valueOf(),l=(r-o)/a;let c=i===1?Math.ceil(l):Math.floor(l);if(c=Math.max(0,Math.min(c,s-1)),this.isLinearUnit()){if(i===1){if(o+c*a<r&&c===s-1)return}else if(o+c*a>r&&c===0)return;return c}const h=this.numericBands;if(i===1){for(;c>0&&h[c-1]>=r;)c--;for(;c<s-1&&h[c]<r;)c++;if(h[c]<r)return}else{for(;c<s-1&&h[c+1]<=r;)c++;for(;c>0&&h[c]>r;)c--;if(h[c]>r)return}return c}convert(t,i){this.refresh(),t instanceof Date||(t=new Date(t));const{domain:s,interval:n}=this;if(s.length<2)return Number.NaN;if(i?.clamp!==!0&&n!=null){const o=this.getDomainBoundaries();if(o!=null){const a=t.valueOf();if(a<o.d0||a>=o.dNext)return Number.NaN}}return super.convert(t,i)}calculateBands(t,i,s=!1){if(t===this.domain&&i[0]===0&&i[1]===1&&!s&&this._bands!=null)return{bands:this._bands,firstBandIndex:0};if(t.length<2)return{bands:[],firstBandIndex:void 0};const{interval:n}=this;if(n==null)return{bands:[],firstBandIndex:void 0};const o={visibleRange:i,extend:s};if(!AN(t,n,o))return{bands:[],firstBandIndex:void 0};const a=t===this.domain?this.getCachedBandRange():lD(t,n);if(a==null)return{bands:[],firstBandIndex:void 0};const[r,l]=a;if(mg(n,r,l,o)>rD)return j.warnOnce("the configured unit results in too many bands, ignoring. Supply a larger unit."),{bands:[],firstBandIndex:void 0};const c=wn(n,r,l,o),h=ky(n,r,l,o);return{bands:c,firstBandIndex:h}}ticks({interval:t},i=this.domain,s=[0,1],{extend:n=!1}={}){if(i.length<2)return;let o,a,r;if(i===this.domain&&!n?({bands:o}=this.calculateBands(i,[0,1],!1),r=fG(o,!1,s),a=r[0]):{bands:o,firstBandIndex:a}=this.calculateBands(i,s,n),t==null)return{ticks:o,count:void 0,firstTickIndex:a};const l=this.interval?rs(this.interval):1/0,c=Math.min(i[0].valueOf(),i[1].valueOf()),h=Math.max(i[0].valueOf(),i[1].valueOf());let d,u,p;if(st(t)||typeof t=="string")d=wn(t,i[0],i[1],{extend:!0,visibleRange:s}),u=0,p=d.length-1;else{const M=r?r[0]:0,D=r?r[1]:o.length-1;d=o,u=hr(M,D,k=>o[k].valueOf()<=c)??M,p=hr(M,D,k=>o[k].valueOf()<=h)??D}const f=[];let y;for(let M=u;M<=p;M++){const D=d[M].valueOf(),k=hr(0,o.length-1,A=>o[A].valueOf()<=D),I=k!=null&&k!=y?o[k]:void 0;y=k,I!=null&&D-I.getTime()<=l&&f.push(I)}let b,x;if(this.interval){const M=lD([new Date(c),new Date(h)],this.interval);b=M[0].valueOf(),x=M[1].valueOf()}else b=c,x=h;let v=Nc(0,f.length-1,M=>f[M].valueOf()>=b)??0,S=hr(0,f.length-1,M=>f[M].valueOf()<=x)??f.length-1;return n&&(v=Math.max(v-1,0),S=Math.min(S+1,f.length-1)),{ticks:f.slice(v,S+1),count:f.length,firstTickIndex:a}}};function AN(e,t,i){const[s,n]=lD(e,t);return mg(t,s,n,i)<=rD}function lD(e,t){const i=Ys(t,e[0]),s=Ys(t,e[1]);return[i,s]}function G4(e,t,i,s,n){let[o,a]=Tt(t.map(Number));const r=Math.floor(i.unzoomed);if(r<=1){const[x,v]=H4(o,a),S=5*Math.pow(2,-Math.ceil(Math.log2(n[1]-n[0]))),{ticks:M}=Rc(x,v,S,void 0,void 0,n),D=[e.toDomain(x),e.toDomain(v)];return s&&D.reverse(),{domain:D,ticks:M}}if(o===a){const x=Math.floor(Math.log10(o)),v=Math.pow(10,x),S=Math.min(v,1),M=r-1;o-=S*Math.floor(M/2),a=o+S*M}let l=o,c=a;l=j4(l,c,r);const h=$4(l,c,r),d=r-1;c=l+d*h;const u=Math.floor(l/h)*h,p=Math.floor(c/h)*h;u<=o&&p>=a&&(l=u,c=p);const f=[e.toDomain(l),e.toDomain(c)];s&&f.reverse();const y=h*((i.unzoomed-1)/(i.zoomed-1)),b=W4(l,y,Math.floor(i.zoomed));return{domain:f,ticks:b}}function H4(e,t){let i=e,s=t,n=0;do{[i,s]=Ly(i,s);const{ticks:o}=Rc(i,s,5);if(o.length%2===1)return[i,s];i-=1,s+=1}while(n++<10);return[e,t]}function j4(e,t,i){e=Math.floor(e);const s=Math.abs(t-e)/(i-1),n=Math.floor(Math.log10(s)),o=Math.pow(10,n);return Math.floor(e/o)*o}function W4(e,t,i){const s=vc(t),n=Math.pow(10,s),o=[];for(let a=0;a<i;a++){const r=e+t*a;o.push(Math.round(r*n)/n)}return o}function $4(e,t,i){const s=i-1,n=(t-e)/s;return U4(n)}function U4(e){const t=Math.floor(Math.log10(e)),i=Math.pow(10,t),s=e/i;return s>0&&s<=1?i:s>1&&s<=2?2*i:s>2&&s<=5?5*i:s>5&&s<=10?10*i:e}var K4=18,Y4=[1,2,3,4,6,8,9,10,12];function CN(e,t=0){const i=[];for(const s of e){const{x:n,y:o,width:a,height:r}=s;if(i.some(l=>sy(l,n,o,a+t,r+t)))return!0;i.push(s)}return!1}function Z4(e,t,i,s){if(e==null)return t;if(typeof e!="number"){const r=t[0],l=typeof e=="string"?{unit:e,epoch:r}:{...e,epoch:r};return wn(l,t[0],t[1],{visibleRange:i,extend:s})}const n=[],o=t[0].valueOf(),a=t[1].valueOf();for(let r=o;r<=a;r+=e)n.push(new Date(r));return n}function LN(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i+=1)if(e[i]?.valueOf()!==t[i]?.valueOf())return!1;return!0}function X4(e){if(e.length<2)return 1/0;let t=0,i=e[0].translation;for(let s=1;s<e.length;s++){const n=e[s].translation,o=Math.abs(n-i);t=Math.max(t,o),i=n}return t}function q4(e,{niceDomain:t,rawTicks:i,rawFirstTickIndex:s=0,generatePrimaryTicks:n,primaryTicksIndices:o,alignment:a,fractionDigits:r,timeInterval:l}){const{scale:c,label:h,tickFormatter:d,inRange:u,isVertical:p,sizeLimit:f=1/0}=e,y=du.is(c)||Da.is(c),b=Ze(h),x=Sg(),v=[];return wN(c,t,()=>{const S=Ma.is(c)?c.bandwidth??1/0:1/0,M=(c.bandwidth??0)/2,D=Q4(h.enabled,n,t,i,r,l,d),k={font:h,maxWidth:p?f:S,maxHeight:p?S:f,overflow:h.truncate?"ellipsis":"hide",textWrap:h.wrapping};for(let I=0;I<i.length;I++){const A=i[I],C=c.convert(A,{alignment:a})+M;if(u&&!u(C))continue;const w=o?.has(I)??!1,T=D(w,A,I);let O=null;h.avoidCollisions&&(O=Rd(T,k)||null);const E=O??T,z=Ce(E),F=E!==T&&(!z||Op(E.at(-1)));let _;if(y){const G=A?.valueOf();Number.isFinite(G)&&(_=x(`v:${G}`))}_??(_=x(`l:${z?Pe(E.flat()):E}`)),v.push({tick:A,tickId:_,tickLabel:E,isPrimary:w,index:I+s,textUntruncated:F?Pe(T):void 0,textMetrics:z?Ks(E,h):b.measureLines(Dt(E)),translation:Math.floor(C)})}}),v}function wN(e,t,i){const s=e.domain;try{e.domain=t,i()}finally{e.domain=s}}function Q4(e,t,i,s,n,o,a){const r=t?"component":"long",l=t&&o?Hd(o):void 0,c=t?a(i,s,!0,n,l,r):null,h=e?a(i,s,!1,n,o,r):null;return(d,u,p)=>(d?c:h)?.(u,p)??String(u)}function J4(e,t,i,s,n,o,a,r){if(!du.is(e)&&!Da.is(e))return;const l=Hd(o);if(l==null)return;a&&(t=[1-t[1],1-t[0]]);const c=Math.min(e.domain[0].valueOf(),e.domain.at(-1).valueOf()),h=Math.max(e.domain[0].valueOf(),e.domain.at(-1).valueOf());let[d,u]=Iy(new Date(c),new Date(h),t);d=Ys(l,d),d.valueOf()>=c&&(d=G0(l,d)),u=V0(l,u),u.valueOf()<=h&&(u=Dy(l,u));const p=wn(l,d,u),f=rs(o),y=El.is(e),b={...n,interval:o},x=[];let v,S,M,D=0;if(El.is(e)){const k=ro(o);S=r!=null&&rs(r)>=rs(k)?2:3,M=1;const I=i/s,A=e.bandCount(t)/(I*K4);D=Y4.findLast(C=>A>=C)??1}else Pl.is(e)&&(e.interval==null||rs(e.interval)>=f)?S=1:(S=0,M=2);for(let k=0;k<p.length-1;k++){const I=p[k],A=p[k+1],C=k===0,w=k===p.length-2,T=A.valueOf()-I.valueOf(),O=[Math.max((c-I.valueOf())/T,0),Math.min((h-I.valueOf())/T,1)];let E;switch(S){case 0:E=Z4(b.interval,[I,A],O,!0);break;case 1:case 3:{E=e.ticks(b,[I,A],O,{extend:!0,dropInitial:!0})?.ticks??[];break}case 2:E=e.stepTicks(D,[I,A],void 0,!w);break}if(sS(E,G=>G.valueOf()<I.valueOf()),w||nS(E,G=>{switch(S){case 0:case 3:return G.valueOf()+f>A.valueOf();case 1:case 2:return G.valueOf()>=A.valueOf()}}),E.length===0)continue;const z=E[0],F=oy(z,I);(S===0?F===0:F<=f)&&(!y||!C)&&(v??(v=new Set),v.add(x.length)),x.push(...E)}return v?.size===1&&v.has(0)&&(v=void 0),{ticks:x,primaryTicksIndices:v,alignment:M}}function eW(e,t,i,s,n){const o=TN(e.format,s);if(o==null)return{width:0,height:0};const a=Sc(o),r=s?Hd(s):void 0,l=TN(t?.format,r),c=l?Sc(l):a,h=new Date(i[0]),d=new Date(i.at(-1)),u=r?wn(r,new Date(i[0]),new Date(i.at(-1)),{extend:!0}):void 0;let p=0,f=0;if(a!=null){const y=hu(e),b=y.left+y.right,x=y.top+y.bottom;let v,S;u!=null&&u.length>1?(v=u[0],S=u[1]):(v=h,S=d);const M=wn(s,v,S,{limit:50});for(const D of M){const k=a(D),{width:I,height:A}=n.measureLines(k);p=Math.max(p,I+b),f=Math.max(f,A+x)}}if(c!=null&&u!=null){const y=hu(t),b=y.left+y.right,x=y.top+y.bottom;for(const v of u){const S=c(v),{width:M,height:D}=n.measureLines(S);p=Math.max(p,M+b),f=Math.max(f,D+x)}}return{width:Math.ceil(p),height:Math.ceil(f)}}function tW(e,t,i,s){return e&&!t?i*s===-1?"top":"bottom":"middle"}function iW(e,t,i,s,n){const o=t>0&&t<=Math.PI,a=i>0&&i<=Math.PI,r=o||a?-1:1;if(e)if(t||i){if(s*r===-1)return"end"}else return"center";else if(s*n===-1)return"end";return"start"}function TN(e,t){if(e!=null){if(typeof e=="string")return e;if(st(e)&&t!=null)return e[ro(t)]}}function sW(e,t,i=0){const s=Po(e),n=!s&&i>=0&&i<=Math.PI?-1:1,o=!s&&i-Math.PI/2>=0&&i-Math.PI/2<=Math.PI?-1:1;let a=0;return t?a=n*(Math.PI/2):o===-1&&(a=Math.PI),{configuredRotation:s,defaultRotation:a,parallelFlipFlag:n,regularFlipFlag:o}}var nW=new Date(1970,0,4);function NN(e){const{label:t,domain:i,axisRotation:s,labelOffset:n,sideFlag:o}=e,{defaultRotation:a,configuredRotation:r,parallelFlipFlag:l,regularFlipFlag:c}=sW(t.rotation,t.parallel,s),h=r+a,d=(A,C=0)=>{const w=t.minSpacing??(r===0&&C===0?10:0),T=h+C,O=hu(t);return CN(rW(e,A,T),w)||CN(lW(A.ticks,n,T,O),w)},{maxTickCount:u}=ON(e),p=oW(e),f=t.enabled&&t.avoidCollisions,y=Number.isFinite(u)?u:10,b=f&&t.autoRotate&&t.rotation==null;let x=0,v=0,S=!0,M={tickDomain:[],niceDomain:i,ticks:[],rawTicks:[],rawTickCount:void 0,timeInterval:void 0,fractionDigits:0};for(;S&&x<=y;)({tickData:M,index:x}=aW(e,p,M,x)),v=b&&d(M,0)?Po(t.autoRotateAngle):0,S=f&&d(M,v);const D=iW(t.parallel,r,v,o,c),k=tW(t.parallel,r,o,l),I=r+v;return{tickData:M,textAlign:D,textBaseline:k,rotation:I}}function oW(e){return e.interval?.values?2:e.primaryTickCount!=null?1:0}function ON({scale:e,domain:t,range:i,visibleRange:s,label:n,defaultTickMinSpacing:o,interval:{minSpacing:a,maxSpacing:r}}){const{defaultTickCount:l}=e,c=da(i),h=da(s);if(qc.is(e)||El.is(e)&&t.length<1e3){const d=qc.is(e)?t.length:Math.min(t.length,Math.max(1,Math.floor(c/(h*o)))),u=Math.ceil(c/(h*n.fontSize));return{tickCount:Math.min(u,d),minTickCount:0,maxTickCount:d}}return wy(c,h,a,r,l,o)}function aW(e,t,i,s){const{step:n,values:o}=e.interval,{maxTickCount:a,minTickCount:r,tickCount:l}=ON(e),c=C=>Math.max(l-C,r),h=n==null&&o==null&&c(s)>r,d=i.rawTicks,u=l-r,p={minTickCount:r,maxTickCount:a,tickCount:c(s)};let f=EN(e,t,p);if(h&&LN(f.rawTicks,d)){let C=s,w=u;for(;C<=w;){s=Math.trunc((C+w)/2),p.tickCount=c(s);const T=EN(e,t,p);LN(T.rawTicks,d)?C=s+1:(f=T,w=s-1)}}const{tickDomain:y,niceDomain:b,rawTicks:x,rawTickCount:v,rawFirstTickIndex:S,generatePrimaryTicks:M,primaryTicksIndices:D,alignment:k,fractionDigits:I,timeInterval:A}=f;return{tickData:{tickDomain:y,niceDomain:b,rawTicks:x,rawTickCount:v,fractionDigits:I,timeInterval:A,ticks:q4(e,{niceDomain:b,rawTicks:x,rawFirstTickIndex:S,generatePrimaryTicks:M,primaryTicksIndices:D,alignment:k,fractionDigits:I,timeInterval:A})},index:s+1}}function EN(e,t,i){const{domain:s,reverse:n,visibleRange:o,scale:a,interval:r,primaryLabel:l,niceMode:c,primaryTickCount:h,minimumTimeGranularity:d}=e,u={nice:c.map(C=>C===0),interval:r.step,...i},p={...u,nice:c.map(C=>C===0||C===1)};let f;t===1&&h!=null&&yt.is(a)&&(f=G4(a,s,h,n,o));const y=c.includes(0)?f?.domain??a.niceDomain(u,s):s;let b=y,x,v,S,M,D,k;const I=l?.enabled===!0&&p.interval==null;wN(a,y,()=>{switch(t){case 2:if(b=r.values,x=r.values,v=x.length,El.is(a)?k=1:Pl.is(a)&&(k=2),yt.is(a)){const[C,w]=Tt(y.map(Number));x=x.filter(T=>Number(T)>=C&&Number(T)<=w).sort((T,O)=>Number(T)-Number(O))}break;case 1:if(f)x=f.ticks,v=f.ticks.length;else{const C=a.ticks(p,y,o);x=C?.ticks,v=C?.count}break;default:{const{tickCount:C,minTickCount:w,maxTickCount:T}=i;if(y.length>0&&p.interval==null&&(Pl.is(a)||I&&(du.is(a)||El.is(a)))){const z=y,F=Math.min(z[0].valueOf(),z.at(-1).valueOf()),_=Math.max(z[0].valueOf(),z.at(-1).valueOf());M=jd(F,_,C,w,T,{weekStart:l==null?nW:void 0,primaryOnly:!0})}let O;El.is(a)?O=d:Pl.is(a)&&(O=a.interval),O!=null&&M!=null&&rs(O)>=rs(M)&&(M=O);const E=M?J4(a,o,C,T,p,M,n,d):void 0;if(E)({ticks:x,primaryTicksIndices:D,alignment:k}=E);else{const z=Pl.is(a)&&p.interval==null&&M!=null?{...p,interval:M}:p,F=a.ticks(z,y,o);if(x=F?.ticks,v=F?.count,S=F?.firstTickIndex,du.is(a)||Da.is(a)){const _=typeof p.interval=="number"?Wd(p.interval):p.interval;M??(M=_??F?.timeInterval)}}}}}),x??(x=[]);let A=0;for(const C of x){if(typeof C!="number")continue;const w=vc(C);w>A&&(A=w)}return I||(D=void 0),{tickDomain:b,niceDomain:y,rawTicks:x,rawTickCount:v,rawFirstTickIndex:S,generatePrimaryTicks:I,primaryTicksIndices:D,alignment:k,fractionDigits:A,timeInterval:M}}function rW(e,t,i){const{niceDomain:s,ticks:n,timeInterval:o}=t;if(o==null)return[];const a=X4(n),{label:r,labelOffset:l,primaryLabel:c,domain:h}=e,{width:d,height:u}=eW(r,c,s??h,o,Ze(r)),p=[];for(const f of[0,a]){const{x:y,y:b}=ey(l,f,i);p.push({x:y,y:b,width:d,height:u})}return p}function lW(e,t,i,s){const n=[],o=s.left+s.right,a=s.top+s.bottom;for(const{tickLabel:r,textMetrics:l,translation:c}of e){if(!r)continue;const{x:h,y:d}=ey(t,c,i),u=l.width+o,p=l.height+a;n.push({x:h,y:d,width:u,height:p})}return n}var Bg=class UB extends oD{constructor(t,i){super(t,i),this.maxThicknessRatio=.3,this.crossAxisTranslation={x:0,y:0},this.minimumTimeGranularity=void 0,this.headingLabelGroup=this.axisGroup.appendChild(new ls({name:`${this.id}-Axis-heading`})),this.lineNodeGroup=this.axisGroup.appendChild(new ls({name:`${this.id}-Axis-line`})),this.lineNode=this.lineNodeGroup.appendChild(new En({zIndex:1})),this.tickLineGroupSelection=ci.select(this.tickLineGroup,En,!1),this.gridLineGroupSelection=ci.select(this.gridLineGroup,En,!1),this.gridFillGroupSelection=ci.select(this.gridFillGroup,Di,!1),this.tempText=new su({debugDirty:!1}),this.tempCaption=new Et,this.animationManager=t.animationManager,this.animationState=new he("empty",{empty:{update:{target:"ready",action:()=>this.resetSelectionNodes()},reset:"empty"},ready:{update:n=>this.animateReadyUpdate(n),resize:()=>this.resetSelectionNodes(),reset:"empty"}}),this.headingLabelGroup.appendChild(this.title.caption.node);let s;this.cleanup.register(t.eventsHub.on("layout:complete",n=>{const o=[n.chart.width,n.chart.height];s!=null&&!vn(o,s)&&this.animationState.transition("resize"),s=o}),this.title.caption.registerInteraction(this.moduleCtx,"afterend"))}static is(t){return t instanceof UB}get horizontal(){return this.position==="top"||this.position==="bottom"}onGridVisibilityChange(){}resetAnimation(t){t==="initial"&&this.animationState.transition("reset")}get direction(){return this.position==="top"||this.position==="bottom"?"x":"y"}createAxisContext(){return{...super.createAxisContext(),position:this.position}}createLabel(){return new aD}updateDirection(){switch(this.position){case"top":this.label.mirrored=!0,this.label.parallel=!0;break;case"right":this.label.mirrored=!0,this.label.parallel=!1;break;case"bottom":this.label.mirrored=!1,this.label.parallel=!0;break;case"left":this.label.mirrored=!1,this.label.parallel=!1;break}this.axisContext&&(this.axisContext.position=this.position,this.axisContext.direction=this.direction)}calculateLayout(t,i){return this.updateDirection(),super.calculateLayout(t,i)}layoutCrossLines(){const t=this.hasDefinedDomain()||this.hasVisibleSeries();for(const i of this.crossLines)i.calculateLayout?.(t)}calculateTickLayout(t,i,s,n){const o=this.label.getSideFlag(),a=o*(this.getTickSize()+this.label.spacing+this.seriesAreaPadding);if(i[0]===2&&i[1]===2&&this.label.enabled===!1&&this.tick.enabled===!1&&this.gridLine.enabled===!1){const{bbox:q,spacing:te}=this.tickBBox(t,[],[]);return{ticks:[],rawTickCount:0,tickDomain:t,niceDomain:t,fractionDigits:0,timeInterval:void 0,bbox:q,layout:{ticks:[],tickLines:[],gridLines:[],gridFills:[],labels:[],spacing:te}}}const{label:r,primaryLabel:l,scale:c,range:h,interval:d,reverse:u,defaultTickMinSpacing:p,minimumTimeGranularity:f}=this,y=NN({label:r,scale:c,interval:d,primaryLabel:l,domain:t,range:h,reverse:u,niceMode:i,visibleRange:s,defaultTickMinSpacing:p,minimumTimeGranularity:f,sideFlag:o,labelOffset:a,primaryTickCount:n,axisRotation:this.horizontal?-.5*Math.PI:0,isVertical:this.direction==="y",sizeLimit:this.chartLayout?.sizeLimit,inRange:q=>this.inRange(q,.001),tickFormatter:(...q)=>this.tickFormatter(...q)}),{tickData:b}=y;if(this.label.avoidCollisions&&this.horizontal&&b.ticks.length>2&&(yt.is(this.scale)||Da.is(this.scale))){const q=this.chartLayout?.padding.right??0,te=b.ticks.at(-1);te?.tickLabel!=null&&te.translation+te.textMetrics.width/2>h[1]+q&&(te.tickLabel=void 0,s[0]===0&&s[1]===1&&(b.ticks[0].tickLabel=void 0))}const{ticks:v,tickDomain:S,rawTicks:M,rawTickCount:D,fractionDigits:k,timeInterval:I,niceDomain:A}=b,C=v.map(q=>this.getTickLabelProps(q,y)),{position:w,gridPadding:T,gridLength:O}=this,E=w==="bottom"||w==="right"?-1:1,z=E*T,F=E*(O+T),_=this.calculateGridLines(v,z,F),G=this.calculateGridFills(v,z,F),B=this.calculateTickLines(v,E),{bbox:V,spacing:Y}=this.tickBBox(S,v,C);return{ticks:M,rawTickCount:D,tickDomain:S,niceDomain:A,fractionDigits:k,timeInterval:I,bbox:V,layout:{ticks:v,gridLines:_,gridFills:G,tickLines:B,labels:C,spacing:Y}}}calculateGridLines(t,i,s){return t.map((n,o)=>this.calculateGridLine(n,o,i,s,t))}calculateGridLine({index:t,tickId:i,translation:s},n,o,a,r){const{gridLine:l,horizontal:c}=this,[h,d,u,p]=c?[s,o,s,a]:[o,s,a,s],{style:f}=l,{stroke:y,strokeWidth:b=0,lineDash:x}=f[t%f.length]??{};return{tickId:i,offset:s,x1:h,y1:d,x2:u,y2:p,stroke:y,strokeWidth:b,lineDash:x}}calculateGridFills(t,i,s){const{horizontal:n,range:o,type:a}=this,r=[];if(t.length==0)return r;let l=0;const c=!n&&a==="unit-time";if(c&&t[0].translation<o[0]||!c&&t[0].translation>o[0]){const d={tickId:`before:${t[0].tickId}`,translation:o[0]};r.push(this.calculateGridFill(d,-1,t[0].index,i,s,t)),l=1}return r.push(...t.map((d,u)=>this.calculateGridFill(d,u,d.index+l,i,s,t))),r}calculateGridFill({tickId:t,translation:i},s,n,o,a,r){const{gridLine:l,horizontal:c,range:h}=this,d=r[s+1],u=i,p=d?d.translation:h[1],[f,y,b,x]=c?[u,Math.max(o,a),p,Math.min(o,a)]:[Math.min(o,a),Math.min(u,p),Math.max(o,a),Math.max(u,p)],{fill:v,fillOpacity:S}=l.style[n%l.style.length]??{};return{tickId:t,x1:f,y1:y,x2:b,y2:x,fill:v,fillOpacity:S}}calculateTickLines(t,i){return t.map(s=>this.calculateTickLine(s,s.index,i,t))}calculateTickLine({isPrimary:t,tickId:i,translation:s},n,o,a){const{horizontal:r,tick:l,primaryTick:c}=this,h=t&&c?c:l,d=-o*this.getTickSize(h),[u,p,f,y]=r?[s,0,s,d]:[0,s,d,s],{stroke:b,width:x}=h;return{tickId:i,offset:s,x1:u,y1:p,x2:f,y2:y,stroke:b,strokeWidth:x,lineDash:void 0}}update(){this.updateDirection();const t=Array.from(this.tickLabelGroupSelection.nodes(),a=>a.datum.tickId);super.update();const{tickLayout:i}=this;if(this.updateTitle(this.scale.domain,i?.spacing??0),this.animatable||this.moduleCtx.animationManager.skipCurrentBatch(),i){const{ticks:a}=i;if(this.animationManager.isSkipped())this.resetSelectionNodes();else{const r=a.map(c=>c.tickId),l=y0(t,r);this.animationState.transition("update",l)}}const{enabled:s,stroke:n,width:o}=this.line;this.lineNode.setProperties({stroke:n,strokeWidth:s?o:0}),this.updateTickLines(),this.updateGridLines(),this.updateGridFills()}getAxisTransform(){return{translationX:Math.floor(this.translation.x+this.crossAxisTranslation.x),translationY:Math.floor(this.translation.y+this.crossAxisTranslation.y)}}updatePosition(){super.updatePosition();const t=this.getAxisTransform();this.tickLineGroup.datum=t,this.tickLabelGroup.datum=t,this.lineNodeGroup.datum=t,this.headingLabelGroup.datum=t}setAxisVisible(t){this.tickLineGroup.visible=t&&(this.tick.enabled||(this.primaryTick?.enabled??!1)),this.tickLabelGroup.visible=t&&(this.label.enabled||(this.primaryTick?.enabled??!1)),this.lineNodeGroup.visible=t,this.headingLabelGroup.visible=t}getAxisLineCoordinates(){const{horizontal:t}=this,[i,s]=Tt(this.range);return t?{x1:i,x2:s,y1:0,y2:0}:{x1:0,x2:0,y1:i,y2:s}}getTickLineBBox(t){const{translation:i}=t,{position:s,primaryTick:n}=this;let o=this.getTickSize();switch(n?.enabled&&(o=Math.max(o,this.getTickSize(n))),s){case"top":return new re(i,-o,i,o);case"bottom":return new re(i,0,i,o);case"left":return new re(-o,i,o,i);case"right":return new re(0,i,o,i)}}lineNodeBBox(){const{position:t,seriesAreaPadding:i}=this,{y1:s,y2:n}=this.getAxisLineCoordinates(),o=n-s;switch(t){case"top":return new re(s,-i,o,i);case"bottom":return new re(s,0,o,i);case"left":return new re(-i,s,i,o);case"right":return new re(0,s,i,o)}}titleBBox(t,i){const{tempCaption:s}=this;return s.node.setProperties(this.titleProps(s,t,i)),s.node.getBBox()}tickBBox(t,i,s){const{tick:n,primaryTick:o,label:a,primaryLabel:r,title:l,position:c,horizontal:h,seriesAreaPadding:d}=this,u=[];if(u.push(this.lineNodeBBox()),n.enabled||o?.enabled)for(const b of i)u.push(this.getTickLineBBox(b));const{tempText:p}=this;if(a.enabled)for(const b of s){if(!b.visible)continue;p.setProperties(b);const x=p.getBBox();x&&u.push(x)}if(r?.enabled&&c==="bottom"&&(u.push(new re(0,Mn(a.fontSize)+2,1,this.getTickSize(n)+a.spacing+d)),r.format!=null)){const{format:x}=r,S=(st(x)?Object.values(x):[x]).reduce((M,D)=>Math.max(M,CS(D)),0);u.push(new re(0,this.getTickSize(o??n)+r.spacing+d,1,S*Mn(r.fontSize)+2))}let f=0;if(l.enabled){const b=re.merge(u);f=h?b.height:b.width,u.push(this.titleBBox(t,f))}return{bbox:re.merge(u),spacing:f}}titleProps(t,i,s){const{title:n}=this;if(!n.enabled)return t.enabled=!1,{visible:!1,text:"",textBaseline:"bottom",x:0,y:0,rotationCenterX:0,rotationCenterY:0,rotation:0};t.enabled=!0,t.color=n.color,t.fontFamily=n.fontFamily,t.fontSize=n.fontSize,t.fontStyle=n.fontStyle,t.fontWeight=n.fontWeight,t.wrapping=n.wrapping;const o=(n.spacing??0)+s,{range:a}=this,r=(a[0]+a[1])/2;let l,c,h,d;switch(this.position){case"top":l=r,c=-o,h=0,d="bottom";break;case"bottom":l=r,c=o,h=0,d="top";break;case"left":l=-o,c=r,h=-.5*Math.PI,d="bottom";break;case"right":l=o,c=r,h=.5*Math.PI,d="bottom";break}const{formatter:u=f=>f.defaultValue}=n,p=this.cachedCallWithContext(u,this.getTitleFormatterParams(i));return t.text=p,{visible:!0,text:p,textBaseline:d,x:l,y:c,rotationCenterX:l,rotationCenterY:c,rotation:h}}getTickLabelProps(t,i){const{horizontal:s,primaryLabel:n,primaryTick:o,seriesAreaPadding:a,scale:r}=this,{tickId:l,tickLabel:c="",translation:h,isPrimary:d,textUntruncated:u}=t,p=d&&n?.enabled?n:this.label,f=d&&o?.enabled?o:this.tick,{rotation:y,textBaseline:b,textAlign:x}=i,{range:v}=r,S=this.label.getSideFlag(),M=hu(p)[this.position],D=S*(this.getTickSize(f)+p.spacing+a)-M,k=c!=="",I=s?h:D,A=s?-D:h;return{...this.getLabelStyles({value:t.tick,formattedValue:c},void 0,p),tickId:l,rotation:y,text:c,textAlign:x,textBaseline:b,textUntruncated:u,visible:k,x:I,y:A,rotationCenterX:I,rotationCenterY:A,range:v}}updateSelections(){if(!this.tickLayout)return;const t=this.getAxisLineCoordinates(),{tickLines:i,gridLines:s,gridFills:n,labels:o}=this.tickLayout,a=r=>r.tickId;this.lineNode.datum=t,this.gridLineGroupSelection.update(this.gridLine.enabled?s:[],void 0,a),this.gridFillGroupSelection.update(this.gridLine.enabled?n:[],void 0,a),this.tickLineGroupSelection.update(i,void 0,a),this.tickLabelGroupSelection.update(o,void 0,a)}updateGridLines(){this.gridLineGroupSelection.each((t,i)=>{t.stroke=i.stroke,t.strokeWidth=i.strokeWidth,t.lineDash=i.lineDash})}updateGridFills(){this.gridFillGroupSelection.each((t,i)=>{t.fill=i.fill,t.fillOpacity=i.fillOpacity??1})}updateTickLines(){this.tickLineGroupSelection.each((t,i)=>{t.stroke=i.stroke,t.strokeWidth=i.strokeWidth,t.lineDash=i.lineDash})}updateTitle(t,i){const{caption:s}=this.title,n=this.titleProps(s,t,i);s.node.visible=n.visible,s.node.text=n.text,s.node.textBaseline=n.textBaseline,s.node.datum=n}updateLabels(){this.label.enabled&&this.tickLabelGroupSelection.each((t,i)=>{t.fill=i.color,t.text=i.text,t.textBaseline=i.textBaseline,t.textAlign=i.textAlign??"center",t.pointerEvents=i.textUntruncated==null?1:0,t.setFont(i),t.setBoxing(i)})}animateReadyUpdate(t){const{animationManager:i}=this.moduleCtx,s=T4(this),n=E4(s);li(this.id,"axis-group",i,[this.lineNodeGroup,this.tickLabelGroup,this.tickLineGroup,this.headingLabelGroup],n.group),li(this.id,"line",i,[this.lineNode],n.line),li(this.id,"line-paths",i,[this.gridLineGroupSelection,this.tickLineGroupSelection],n.tick,(o,a)=>a.tickId,t),li(this.id,"tick-labels",i,[this.tickLabelGroupSelection],n.label,(o,a)=>a.tickId,t),li(this.id,"title",i,[this.title.caption.node],n.label,(o,a)=>a.tickId,t)}resetSelectionNodes(){Ui([this.lineNodeGroup,this.tickLabelGroup,this.tickLineGroup,this.headingLabelGroup],P4()),Ui([this.gridLineGroupSelection,this.tickLineGroupSelection],bN()),Ui([this.gridFillGroupSelection],R4()),Ui([this.tickLabelGroupSelection],ux()),Ui([this.title.caption.node],ux()),Ui([this.lineNode],bN())}};g([m],Bg.prototype,"thickness",2),g([m],Bg.prototype,"maxThicknessRatio",2),g([m],Bg.prototype,"position",2),g([m],Bg.prototype,"crossAt",2);var _g=Bg,PN=["right","top","left","bottom"];function cW(e){return typeof e=="string"&&PN.includes(e)}function hW(e){const t=[],i=[],s=[...PN];for(const n of e)n instanceof _g&&(cW(n.position)?i.push(n.position):t.push(n));for(const n of t){let o;do o=s.pop();while(o&&i.includes(o));if(o==null)break;n.position=o}}var dW=["direction","xKey","yKey","sizeKey","angleKey","radiusKey","normalizedTo"];function uW(e,t,i){const s=(c,h,d)=>{const u=[c];for(const p of dW)p in h&&h[p]!=null&&u.push(`${p}=${h[p]}`);return d?.seriesGrouping&&u.push(`seriesGrouping.groupId=${d?.seriesGrouping.groupId}`),u.join(";")},n=new Map;let o=0;for(const c of e){const h=s(c.type,c.properties,i?.[o]);n.has(h)||n.set(h,[]),n.get(h)?.push([c,o++])}const a=new Map;o=0;for(const c of t){const h=s(c.type,c,c);a.has(h)||a.set(h,[]),a.get(h)?.push([c,o++])}if(![...n.keys()].some(c=>a.has(c)))return{status:"no-overlap",oldKeys:n.keys(),newKeys:a.keys()};const l=[];for(const[c,h]of a.entries())for(const[d,u]of h){const p=n.get(c);if(p==null||p.length<1){l.push({opts:d,targetIdx:u,idx:u,status:"add"}),n.delete(c);continue}const[f,y]=p.shift(),b=i?.[y]??{},x=Ln(b,d??{}),{groupIndex:v,stackIndex:S}=x?.seriesGrouping??{};v!=null||S!=null?l.push({opts:d,series:f,diff:x,targetIdx:u,idx:y,status:"series-grouping"}):x?l.push({opts:d,series:f,diff:x,targetIdx:u,idx:y,status:"update"}):l.push({opts:d,series:f,targetIdx:u,idx:y,status:"no-op"}),p.length===0&&n.delete(c)}for(const c of n.values())for(const[h,d]of c)l.push({series:h,idx:d,targetIdx:-1,status:"remove"});return{status:"overlap",changes:l}}var Rl=new Map([{type:"chart",name:"cartesian",moduleId:"CartesianChartModule"},{type:"chart",name:"standalone",moduleId:"StandaloneChartModule",enterprise:!0},{type:"chart",name:"polar",moduleId:"PolarChartModule"},{type:"chart",name:"topology",moduleId:"TopologyChartModule",enterprise:!0},{type:"axis",name:"number",chartType:"cartesian",moduleId:"NumberAxisModule"},{type:"axis",name:"log",chartType:"cartesian",moduleId:"LogAxisModule"},{type:"axis",name:"time",chartType:"cartesian",moduleId:"TimeAxisModule"},{type:"axis",name:"unit-time",chartType:"cartesian",moduleId:"UnitTimeAxisModule"},{type:"axis",name:"category",chartType:"cartesian",moduleId:"CategoryAxisModule"},{type:"axis",name:"grouped-category",chartType:"cartesian",moduleId:"GroupedCategoryAxisModule"},{type:"axis",name:"ordinal-time",chartType:"cartesian",enterprise:!0,moduleId:"OrdinalTimeAxisModule"},{type:"axis",name:"angle-category",chartType:"polar",enterprise:!0,moduleId:"AngleCategoryAxisModule"},{type:"axis",name:"angle-number",chartType:"polar",enterprise:!0,moduleId:"AngleNumberAxisModule"},{type:"axis",name:"radius-category",chartType:"polar",enterprise:!0,moduleId:"RadiusCategoryAxisModule"},{type:"axis",name:"radius-number",chartType:"polar",enterprise:!0,moduleId:"RadiusNumberAxisModule"},{type:"series",name:"bar",chartType:"cartesian",moduleId:"BarSeriesModule"},{type:"series",name:"scatter",chartType:"cartesian",moduleId:"ScatterSeriesModule"},{type:"series",name:"bubble",chartType:"cartesian",moduleId:"BubbleSeriesModule"},{type:"series",name:"line",chartType:"cartesian",moduleId:"LineSeriesModule"},{type:"series",name:"area",chartType:"cartesian",moduleId:"AreaSeriesModule"},{type:"series",name:"pie",chartType:"polar",moduleId:"PieSeriesModule"},{type:"series",name:"donut",chartType:"polar",moduleId:"DonutSeriesModule"},{type:"series",name:"box-plot",chartType:"cartesian",enterprise:!0,moduleId:"BoxPlotSeriesModule"},{type:"series",name:"candlestick",chartType:"cartesian",enterprise:!0,moduleId:"CandlestickSeriesModule"},{type:"series",name:"cone-funnel",chartType:"cartesian",enterprise:!0,moduleId:"ConeFunnelSeriesModule"},{type:"series",name:"funnel",chartType:"cartesian",enterprise:!0,moduleId:"FunnelSeriesModule"},{type:"series",name:"ohlc",chartType:"cartesian",enterprise:!0,moduleId:"OhlcSeriesModule"},{type:"series",name:"heatmap",chartType:"cartesian",enterprise:!0,moduleId:"HeatmapSeriesModule"},{type:"series",name:"histogram",chartType:"cartesian",moduleId:"HistogramSeriesModule"},{type:"series",name:"range-area",chartType:"cartesian",enterprise:!0,moduleId:"RangeAreaSeriesModule"},{type:"series",name:"range-bar",chartType:"cartesian",enterprise:!0,moduleId:"RangeBarSeriesModule"},{type:"series",name:"waterfall",chartType:"cartesian",enterprise:!0,moduleId:"WaterfallSeriesModule"},{type:"series",name:"nightingale",chartType:"polar",enterprise:!0,moduleId:"NightingaleSeriesModule"},{type:"series",name:"radar-area",chartType:"polar",enterprise:!0,moduleId:"RadarAreaSeriesModule"},{type:"series",name:"radar-line",chartType:"polar",enterprise:!0,moduleId:"RadarLineSeriesModule"},{type:"series",name:"radial-bar",chartType:"polar",enterprise:!0,moduleId:"RadialBarSeriesModule"},{type:"series",name:"radial-column",chartType:"polar",enterprise:!0,moduleId:"RadialColumnSeriesModule"},{type:"series",name:"map-shape",chartType:"topology",enterprise:!0,moduleId:"MapShapeSeriesModule"},{type:"series",name:"map-line",chartType:"topology",enterprise:!0,moduleId:"MapLineSeriesModule"},{type:"series",name:"map-marker",chartType:"topology",enterprise:!0,moduleId:"MapMarkerSeriesModule"},{type:"series",name:"map-shape-background",chartType:"topology",enterprise:!0,moduleId:"MapShapeBackgroundSeriesModule"},{type:"series",name:"map-line-background",chartType:"topology",enterprise:!0,moduleId:"MapLineBackgroundSeriesModule"},{type:"series",name:"pyramid",chartType:"standalone",enterprise:!0,moduleId:"PyramidSeriesModule"},{type:"series",name:"linear-gauge",chartType:"standalone",enterprise:!0,moduleId:"LinearGaugeModule"},{type:"series",name:"radial-gauge",chartType:"standalone",enterprise:!0,moduleId:"RadialGaugeModule"},{type:"series",name:"sunburst",chartType:"standalone",enterprise:!0,moduleId:"SunburstSeriesModule"},{type:"series",name:"treemap",chartType:"standalone",enterprise:!0,moduleId:"TreemapSeriesModule"},{type:"series",name:"chord",chartType:"standalone",enterprise:!0,moduleId:"ChordSeriesModule"},{type:"series",name:"sankey",chartType:"standalone",enterprise:!0,moduleId:"SankeySeriesModule"},{type:"plugin",name:"animation",enterprise:!0,moduleId:"AnimationModule"},{type:"plugin",name:"annotations",chartType:"cartesian",enterprise:!0,moduleId:"AnnotationsModule"},{type:"plugin",name:"legend",moduleId:"LegendModule"},{type:"plugin",name:"locale",moduleId:"LocaleModule"},{type:"plugin",name:"chartToolbar",chartType:"cartesian",enterprise:!0,moduleId:"ChartToolbarModule"},{type:"plugin",name:"contextMenu",enterprise:!0,moduleId:"ContextMenuModule"},{type:"plugin",name:"statusBar",chartType:"cartesian",enterprise:!0,moduleId:"StatusBarModule"},{type:"plugin",name:"dataSource",enterprise:!0,moduleId:"DataSourceModule"},{type:"plugin",name:"sync",chartType:"cartesian",enterprise:!0,moduleId:"SyncModule"},{type:"plugin",name:"ranges",chartType:"cartesian",enterprise:!0,moduleId:"RangesModule"},{type:"plugin",name:"zoom",enterprise:!0,moduleId:"ZoomModule"},{type:"plugin",name:"flashOnUpdate",enterprise:!0,moduleId:"FlashOnUpdateModule"},{type:"plugin",name:"gradientLegend",enterprise:!0,moduleId:"GradientLegendModule"},{type:"plugin",name:"navigator",chartType:"cartesian",enterprise:!0,moduleId:"NavigatorModule"},{type:"axis:plugin",name:"crosshair",chartType:"cartesian",enterprise:!0,moduleId:"CrosshairModule"},{type:"axis:plugin",name:"bandHighlight",chartType:"cartesian",enterprise:!0,moduleId:"BandHighlightModule"},{type:"series:plugin",name:"errorBar",chartType:"cartesian",enterprise:!0,moduleId:"ErrorBarsModule"},{type:"preset",name:"gauge-preset",chartType:"standalone",enterprise:!0,moduleId:"GaugePresetModule"},{type:"preset",name:"price-volume",chartType:"cartesian",enterprise:!0,moduleId:"PriceVolumePresetModule"},{type:"preset",name:"sparkline",moduleId:"SparklinePresetModule"}].map(e=>[e.name,e]));function pW(e){const t=Rl.get(e);return t?.type==="series"?t.chartType:void 0}function Vg(e){const t=e.series?.[0]?.type??"line";return me.getSeriesModule(t)?.chartType??pW(t)??"unknown"}function gW(e){return Vg(e)==="cartesian"}var fW=class extends sD{*legends(){for(const e of me.listModulesByType("plugin"))(e.name==="legend"||e.name==="gradientLegend")&&(yield{legendType:e.name==="legend"?"category":"gradient",legend:this.getModule(e.name)})}},cD="ag-charts-overlay",RN="ag-charts-dark-overlay",Qc=class extends K{constructor(e,t){super(),this.className=e,this.defaultMessageId=t,this.enabled=!0}getText(e){return Ce(this.text)?Pe(this.text):this.rendererAsText?this.rendererAsText:e.t(Dt(this.text)||this.defaultMessageId)}getElement(e,t,i,s){if(this.content?.remove(),this.rendererAsText=void 0,this.focusBox=s,this.renderer){const n={},o=as(e,this.renderer,n);if(o instanceof HTMLElement)this.content=o;else{const a=xe("div");a.innerHTML=o;const{firstElementChild:r}=a;r instanceof HTMLElement&&a.childElementCount===1?this.content=r:this.content=a}this.rendererAsText=this.content?.textContent?.trim()??void 0}else{const n=xe("div",{display:"flex",alignItems:"center",justifyContent:"center",boxSizing:"border-box",height:"100%",margin:"8px",fontFamily:"var(--ag-charts-font-family)",fontSize:"var(--ag-charts-font-size)",fontWeight:"var(--ag-charts-font-weight)"});if(Ce(this.text)){const o=xe("div");for(const a of this.text){const r=xe("span",{color:a.color,fontSize:`${a.fontSize}px`,fontFamily:a.fontFamily??"inherit",fontWeight:String(a.fontWeight),fontStyle:a.fontStyle});r.innerText=Dt(a.text),o.appendChild(r)}n.appendChild(o)}else n.innerText=this.getText(i);this.content=n,this.content.classList.add(this.className),t?.animate({from:0,to:1,id:"overlay",phase:"add",groupId:"opacity",onUpdate(o){n.style.opacity=String(o)},onStop(){n.style.opacity="1"}})}return this.content}removeElement(e=()=>this.content?.remove(),t){if(this.content){if(t){const{content:i}=this;t.animate({from:1,to:0,phase:"remove",id:"overlay",groupId:"opacity",onUpdate(s){i.style.opacity=String(s)},onStop(){e?.()}})}else e?.();this.content=void 0,this.focusBox=void 0}}};g([m],Qc.prototype,"enabled",2),g([m],Qc.prototype,"text",2),g([m],Qc.prototype,"renderer",2);var uu=class extends K{constructor(){super(...arguments),this.darkTheme=!1,this.loading=new Qc("ag-charts-loading-overlay","overlayLoadingData"),this.noData=new Qc("ag-charts-no-data-overlay","overlayNoData"),this.noVisibleSeries=new Qc("ag-charts-no-visible-series","overlayNoVisibleSeries"),this.unsupportedBrowser=new Qc("ag-charts-unsupported-browser","overlayUnsupportedBrowser")}getFocusInfo(e){for(const t of[this.loading,this.noData,this.noVisibleSeries,this.unsupportedBrowser])if(t.focusBox!==void 0)return{text:t.getText(e),rect:t.focusBox}}destroy(){this.loading.removeElement(),this.noData.removeElement(),this.noVisibleSeries.removeElement(),this.unsupportedBrowser.removeElement()}};g([m],uu.prototype,"darkTheme",2),g([m],uu.prototype,"loading",2),g([m],uu.prototype,"noData",2),g([m],uu.prototype,"noVisibleSeries",2),g([m],uu.prototype,"unsupportedBrowser",2);function mW(e,t){const{animationDuration:i}=ex.add,s=i*t,n=xe("div",`${cD}--loading`,{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",height:"100%",boxSizing:"border-box",font:"13px Verdana, sans-serif",userSelect:"none",animation:`ag-charts-loading ${s}ms linear 50ms both`}),o=xe("span",{width:"45px",height:"40px",backgroundImage:["linear-gradient(#0000 calc(1 * 100% / 6), #ccc 0 calc(3 * 100% / 6), #0000 0), ","linear-gradient(#0000 calc(2 * 100% / 6), #ccc 0 calc(4 * 100% / 6), #0000 0), ","linear-gradient(#0000 calc(3 * 100% / 6), #ccc 0 calc(5 * 100% / 6), #0000 0)"].join(""),backgroundSize:"10px 400%",backgroundRepeat:"no-repeat",animation:"ag-charts-loading-matrix 1s infinite linear"}),a=xe("p",{marginTop:"1em"});a.innerText=e;const r=xe("div",`${cD}__loading-background`,{position:"absolute",inset:"0",opacity:"0.5",zIndex:"-1"}),l=xe("style");return l.innerText=["@keyframes ag-charts-loading { from { opacity: 0 } to { opacity: 1 } }","@keyframes ag-charts-loading-matrix {","0% { background-position: 0% 0%, 50% 0%, 100% 0%; }","100% { background-position: 0% 100%, 50% 100%, 100% 100%; }","}"].join(" "),n.replaceChildren(l,o,a,r),n}var Gg=class extends K{constructor(e){super(),this.ctx=e,this.rectNode=new Di,this.border=new cr(this.rectNode),this.cornerRadius=0,this.padding=0,this.cleanup=new pt,this.node=this.createNode(),this.node.append([this.rectNode]),this.rectNode.fill=void 0,this.cleanup.register(e.scene.attachNode(this.node),e.eventsHub.on("layout:complete",t=>this.onLayoutComplete(t)))}destroy(){this.cleanup.flush()}getPadding(){const{border:e,padding:t}=this,i=e.enabled?e.strokeWidth:0;if(typeof t=="number"){const s=t+i;return{top:s,right:s,bottom:s,left:s}}return{top:(t.top??0)+i,right:(t.right??0)+i,bottom:(t.bottom??0)+i,left:(t.left??0)+i}}createNode(){return new Oe({name:"series-area-container",zIndex:4})}onLayoutComplete(e){const{x:t,y:i,width:s,height:n}=e.series.paddedRect;this.rectNode.x=t,this.rectNode.y=i,this.rectNode.width=s,this.rectNode.height=n}};g([m],Gg.prototype,"border",2),g([m],Gg.prototype,"clip",2),g([kt("rectNode","cornerRadius"),m],Gg.prototype,"cornerRadius",2),g([m],Gg.prototype,"padding",2);function FN(e,t,i,s){if(Ut(e))return{type:"gradient",gradient:e.gradient??t.gradient,colorStops:e.colorStops??t.colorStops,bounds:e.bounds??t.bounds,rotation:e.rotation??t.rotation,reverse:e.reverse??t.reverse,colorSpace:e.colorSpace??t.colorSpace};if(Tn(e)){const n=e.pattern??i.pattern;let o=e.strokeWidth;n==="backward-slanted-lines"||n==="forward-slanted-lines"||n==="horizontal-lines"||n==="vertical-lines"?o??(o=i.strokeWidth):o??(o=0);const a=e.width??e.height??i.width,r=e.height??e.width??i.height;return{type:"pattern",pattern:n,width:a,height:r,path:e.path,padding:e.padding??i.padding,fill:e.fill??i.fill,fillOpacity:e.fillOpacity??i.fillOpacity,backgroundFill:e.backgroundFill??i.backgroundFill,backgroundFillOpacity:e.backgroundFillOpacity??i.backgroundFillOpacity,stroke:e.stroke??i.stroke,strokeOpacity:e.strokeOpacity??i.strokeOpacity,strokeWidth:o,rotation:e.rotation??i.rotation,scale:e.scale??i.scale}}return zo(e)?{type:"image",url:e.url,width:e.width,height:e.height,backgroundFill:e.backgroundFill??s.backgroundFill,backgroundFillOpacity:e.backgroundFillOpacity??s.backgroundFillOpacity,rotation:e.rotation??s.rotation,repeat:e.repeat??s.repeat,fit:e.fit??s.fit}:e}function hD(e,t,i,s){return!Ut(e?.fill)&&!Tn(e?.fill)&&!zo(e?.fill)?e:{...e,fill:FN(e.fill,t,i,s)}}var zN=(e=>(e[e.EXACT_SHAPE_MATCH=0]="EXACT_SHAPE_MATCH",e[e.NEAREST_NODE=1]="NEAREST_NODE",e[e.AXIS_ALIGNED=2]="AXIS_ALIGNED",e))(zN||{}),yW=.25,xW=.125,gx=class{constructor(e,t,i,s){this.type=e,this.event=t,this.defaultPrevented=!1,this.datum=i.datum,this.seriesId=s.id}preventDefault(){this.defaultPrevented=!0}},dD=class{constructor(e,t){this.series=e,this.seriesGrouping=t,this.type="groupingChanged"}};function BN(e){switch(e){case"x":return"x";case"y":return"y";case"angle":return"angle";case"radius":return"radius"}}function uD(e){switch(e){case"x":return"x";case"y":return"y";case"angle":return"angle";case"radius":return"radius";default:return"x"}}var Hg=class extends iT{constructor(e){super(),this.cleanup=new pt,this.usesPlacedLabels=!1,this.alwaysClip=!1,this.hasChangesOnHighlight=!1,this.seriesGrouping=void 0,this.NodeEvent=gx,this.internalId=Mi(this),this.contentGroup=new ls({name:`${this.internalId}-content`,zIndex:1}),this.highlightGroup=new ls({name:`${this.internalId}-highlight`,zIndex:1}),this.highlightNodeGroup=this.highlightGroup.appendChild(new Oe({name:`${this.internalId}-highlight-node`})),this.highlightLabelGroup=this.highlightGroup.appendChild(new Oe({name:`${this.internalId}-highlight-label`,zIndex:2})),this.annotationGroup=new ls({name:`${this.internalId}-annotation`}),this.labelGroup=new ls({name:`${this.internalId}-series-labels`}),this.axes={},this.directions=["x","y"],this.nodeDataRefresh=!0,this.processedDataUpdated=!0,this.moduleMap=new sD,this.datumCallbackCache=new Map,this.connectsToYAxis=!1,this.declarationOrder=-1,this._broughtToFront=!1,this.events=new Sn,this._pickNodeCache=new wp(5),this.fireEventWrapper=l=>super.fireEvent(l);const{moduleCtx:t,pickModes:i,propertyKeys:s={},propertyNames:n={},canHaveAxes:o=!1,usesPlacedLabels:a=!1,alwaysClip:r=!1}=e;this.ctx=t,this.propertyKeys=s,this.propertyNames=n,this.canHaveAxes=o,this.usesPlacedLabels=a,this.pickModes=i,this.alwaysClip=r,this.highlightLabelGroup.pointerEvents=1,this.cleanup.register(this.ctx.eventsHub.on("data:update",l=>this.setChartData(l)),this.ctx.eventsHub.on("highlight:change",l=>this.onChangeHighlight(l)))}get pickModeAxis(){return"main"}get id(){return this.properties?.id??this.internalId}get type(){return this.constructor.type??""}get focusable(){return!0}get data(){return this._data??this._chartData}set visible(e){this.properties.visible=e,this.ctx.legendManager.toggleItem(e,this.id),this.ctx.legendManager.update(),this.visibleMaybeChanged()}get visible(){return this.ctx.legendManager.getSeriesEnabled(this.id)??this.properties.visible}get hasData(){const e=this.data;return e==null?!1:e.netSize()>0}get tooltipEnabled(){return this.properties.tooltip?.enabled}onDataChange(){this.nodeDataRefresh=!0,this.processedDataUpdated=!0,this._pickNodeCache.clear()}setOptionsData(e){this._data=e,this.onDataChange()}setChartData(e){this._chartData=e,this.data===e&&this.onDataChange()}onSeriesGroupingChange(e,t){const{internalId:i,type:s,visible:n}=this;e&&this.ctx.seriesStateManager.deregisterSeries(this),t&&this.ctx.seriesStateManager.registerSeries({internalId:i,type:s,visible:n,seriesGrouping:t}),this.fireEvent(new dD(this,t))}getBandScalePadding(){return{inner:1,outer:0}}attachSeries(e,t,i){e.appendChild(this.contentGroup),t.appendChild(this.highlightGroup),t.appendChild(this.labelGroup),i?.appendChild(this.annotationGroup)}detachSeries(e,t,i){this.contentGroup.remove(),this.highlightGroup.remove(),this.labelGroup.remove(),this.annotationGroup.remove()}setSeriesIndex(e,t=!1){const i=this.bringToFront();return!t&&e===this.declarationOrder&&i===this._broughtToFront?!1:(this.declarationOrder=e,this._broughtToFront=i,this.setZIndex(i?Number.MAX_VALUE:e),this.fireEvent(new dD(this,this.seriesGrouping)),!0)}setZIndex(e){this.contentGroup.zIndex=[1,e,0],this.highlightGroup.zIndex=[1,e,1],this.labelGroup.zIndex=[1,e,2],this.annotationGroup.zIndex=e}renderToOffscreenCanvas(){return!1}addEventListener(e,t){return super.addEventListener(e,t)}removeEventListener(e,t){return super.removeEventListener(e,t)}hasEventListener(e){return super.hasEventListener(e)}updatedDomains(){}destroy(){this.cleanup.flush(),this.resetDatumCallbackCache(),this.ctx.seriesStateManager.deregisterSeries(this)}getPropertyValues(e,t){const i=BN(e),s=i==null?e:uD(this.resolveKeyDirection(i)),n=t?.[s],o=[];if(!n)return o;const a=(...r)=>{for(const l of r)Array.isArray(l)?a(...l):typeof l=="object"?a(...Object.values(l)):o.push(l)};return a(...n.map(r=>this.properties[r])),o}getKeyAxis(e){}getKeys(e){return this.getPropertyValues(uD(e),this.propertyKeys)}getKeyProperties(e){return this.propertyKeys[this.resolveKeyDirection(e)]??[]}getNames(e){return this.getPropertyValues(uD(e),this.propertyNames)}getFormatterContext(e){const{id:t}=this,i=this.getPropertyValues(e,this.propertyKeys),s=this.getPropertyValues(e,this.propertyNames),n=[];for(let o=0;o<i.length;o++)n.push({seriesId:t,key:i[o],name:s[o]});return n}resolveKeyDirection(e){return e}getDomain(e){const t=this.getSeriesDomain(e),i=this.moduleMap.mapModules(s=>s.getDomain(e)).flat();return i.length===0?t:{domain:t.domain.concat(i)}}getRange(e,t){return this.getSeriesRange(e,t)}getZoomRangeFittingItems(e,t,i){}getVisibleItems(e,t,i){return 1/0}markNodeDataDirty(){this.nodeDataRefresh=!0,this._pickNodeCache.clear(),this.visibleMaybeChanged()}visibleMaybeChanged(){this.ctx.seriesStateManager.updateSeries(this)}getOpacity(){if(!this.properties.highlight)return 1;const{opacity:t=1}=this.getHighlightStyle();return t}getHighlightState(e,t,i,s){return t?1:e?.series==null?0:this.isSeriesHighlighted(e,s)?this.isItemHighlighted(e,i)==null?2:4:3}getHighlightStateString(e,t,i,s){return lu(this.getHighlightState(e,t,i,s))}onChangeHighlight(e){const t=e.previousHighlight,i=e.currentHighlight,s=this.getHighlightState(i),n=this.getHighlightState(t);this.setSeriesIndex(this.declarationOrder);const o=this.hasItemStylers();if(!o&&s===n){this.hasChangesOnHighlight=!1;return}const{highlightedSeries:a,unhighlightedItem:r,unhighlightedSeries:l}=this.properties.highlight;this.hasChangesOnHighlight=o||!id(a)||!id(r)||!id(l)}bringToFront(){return this.properties.highlight.bringToFront&&this.isSeriesHighlighted(this.ctx.highlightManager.getActiveHighlight())}isSeriesHighlighted(e,t){return e?.series===this}isItemHighlighted(e,t){if(!(e?.datumIndex==null||t==null))return e.datumIndex===t}getHighlightStyle(e,t,i,s){const n=this.ctx.highlightManager?.getActiveHighlight();return i??(i=this.getHighlightState(n,e,t,s)),this.properties.highlight.getStyle(i)}filterItemStylerFillParams(e){return Ut(e)?Q(e,["bounds","colorSpace","gradient","reverse"]):Tn(e)?Q(e,["padding"]):e}getModuleTooltipParams(){return this.moduleMap.mapModules(e=>e.getTooltipParams()).reduce((e,t)=>Object.assign(e,t),{})}pickNodes(e,t,i=!1){const{pickModes:s,pickModeAxis:n,visible:o,contentGroup:a}=this;if(!o||!a.visible||t==="highlight"&&!this.properties.highlight.enabled||t==="highlight-tooltip"&&!this.properties.highlight.enabled)return;let r=1/0;if(t==="tooltip"||t==="highlight-tooltip"){const{tooltip:u}=this.properties;r=typeof u.range=="number"?u.range:1/0,i||(i=u.range==="exact")}else if(t==="event"||t==="context-menu"){const{nodeClickRange:u}=this.properties;r=typeof u=="number"?u:1/0,i||(i=u==="exact")}const l=s.filter(u=>!i||u===0),{x:c,y:h}=e,d=JSON.stringify({x:c,y:h,maxDistance:r,selectedPickModes:l});if(this._pickNodeCache.has(d))return this._pickNodeCache.get(d);for(const u of l){let p;switch(u){case 0:{const f=this.pickNodesExactShape(e);p=f.length===0?void 0:{datums:f,distance:0};break}case 1:{const f=this.pickNodeClosestDatum(e),y=f?.distance===0?this.pickNodesExactShape(e):void 0;y!=null&&y.length!==0?p={datums:y,distance:0}:f?p={datums:[f.datum],distance:f.distance}:p=void 0;break}case 2:{const f=n==null?void 0:this.pickNodeMainAxisFirst(e,n==="main-category");p=f==null?void 0:{datums:[f.datum],distance:f.distance};break}}if(p&&p.distance<=r)return this._pickNodeCache.set(d,{pickMode:u,datums:p.datums,distance:p.distance})}return this._pickNodeCache.set(d,void 0)}pickNodesExactShape(e){const t=[];for(const i of this.contentGroup.pickNodes(e.x,e.y)){const s=i.closestDatum();s!=null&&s.missing!==!0&&t.push(s)}return t}pickNodeClosestDatum(e){throw new Error("AG Charts - Series.pickNodeClosestDatum() not implemented")}pickNodeNearestDistantObject(e,t){const i=Pd(e.x,e.y,t),s=i.nearest?.closestDatum();if(s!=null&&s.missing!==!0)return{datum:s,distance:Math.sqrt(i.distanceSquared)}}pickNodeMainAxisFirst(e,t){throw new Error("AG Charts - Series.pickNodeMainAxisFirst() not implemented")}getLabelData(){return[]}updatePlacedLabelData(e){}fireEvent(e){as([this.properties,this.ctx.chartService],this.fireEventWrapper,e)}fireNodeClickEvent(e,t){const i=new this.NodeEvent("seriesNodeClick",e,t,this);return this.fireEvent(i),!i.defaultPrevented}fireNodeDoubleClickEvent(e,t){const i=new this.NodeEvent("seriesNodeDoubleClick",e,t,this);return this.fireEvent(i),!i.defaultPrevented}createNodeContextMenuActionEvent(e,t){return new this.NodeEvent("nodeContextMenuAction",e,t,this)}onLegendInitialState(e,t){const{visible:i=!0,itemId:s,legendItemName:n}=t??{};this.toggleSeriesItem(i,e,s,n)}onLegendItemClick(e){const{enabled:t,itemId:i,series:s,legendType:n}=e,o="legendItemName"in this.properties?this.properties.legendItemName:void 0,a="legendItemKey"in this.properties?this.properties.legendItemKey:void 0,r=o!=null&&o===e.legendItemName;(s.id===this.id||r||a!=null)&&this.toggleSeriesItem(t,n,i,o,e)}onLegendItemDoubleClick(e){const{enabled:t,itemId:i,series:s,numVisibleItems:n,legendType:o}=e,a="legendItemName"in this.properties?this.properties.legendItemName:void 0,r="legendItemKey"in this.properties?this.properties.legendItemKey:void 0,l=a!=null&&a===e.legendItemName;s.id===this.id||l||r!=null?this.toggleSeriesItem(!0,o,i,a,e):t&&n===1?this.toggleSeriesItem(!0,o,void 0,a):this.toggleSeriesItem(!1,o,void 0,a)}toggleSeriesItem(e,t,i,s,n){const o=this.id;(e||t!=="category")&&(this.visible=e),this.nodeDataRefresh=!0,this._pickNodeCache.clear();const a={type:"seriesVisibilityChange",seriesId:o,itemId:i,legendItemName:n?.legendItemName??s,visible:e};this.fireEvent(a),this.ctx.legendManager.toggleItem(e,o,i,s)}isEnabled(){return this.visible}getModuleMap(){return this.moduleMap}createModuleContext(){return{...this.ctx,series:this}}getAxisValueText(e,t,i,s,n,o){const{id:a,properties:r}=this;return e.formatDatum(r,i,t,a,o,s,n)}getLabelText(e,t,i,s,n,o,a){if(e==null)return"";const{axes:r,canHaveAxes:l,ctx:c,id:h,properties:d}=this,u="series-label",p="legendItemName"in d?d.legendItemName:void 0,f={seriesId:this.id,...a},y=l?BN(s):void 0,b=y==null?void 0:r[this.resolveKeyDirection(y)];if(b!=null)return b.formatDatum(d,e,u,h,p,t,i,n,o,f);const{formatManager:x}=c,v=this.callWithContext.bind(this),S=D=>o.formatValue(v,D.type,D.value,f)??x.format(v,D)??String(e),M=this.getFormatterContext(s);switch(s){case"y":case"color":case"size":return S({type:"number",value:e,datum:t,seriesId:h,legendItemName:p,key:i,source:u,property:s,domain:n,boundSeries:M,fractionDigits:void 0});case"x":case"radius":case"angle":case"label":case"secondaryLabel":case"calloutLabel":case"sectorLabel":case"legendItem":return S({type:"category",value:e,datum:t,seriesId:h,legendItemName:p,key:i,source:u,property:s,domain:n,boundSeries:M})}}getMarkerStyle(e,{datumIndex:t,datum:i,point:s},n,o,a={size:s?.size??e.size??0},r){const{itemStyler:l}=e,{highlightState:c,isHighlight:h=!1,checkForHighlight:d=!0,resolveMarkerSubPath:u=["marker"],resolveStyler:p=!1}=o??{},f=["series",`${this.declarationOrder}`,...u];if(p){const v={permissivePath:!0},S=this.ctx.optionsGraphService.resolvePartial(f,a,v);S&&(a={...S,size:S.size??a.size})}const y=d?this.getHighlightStyle(h,t,c):void 0;let x=oe(y,a,e.getStyle(),r);if(l&&n){const v=this.ctx.highlightManager?.getActiveHighlight(),S=this.getHighlightStateString(v,h,t),M=this.filterItemStylerFillParams(x.fill),D=this.cachedCallWithContext(l,{seriesId:this.id,...x,fill:M,...n,highlightState:S,datum:i}),k=this.ctx.optionsGraphService.resolvePartial(f,D);x=oe(k,x)}return x}applyMarkerStyle(e,t,i,s,{applyTranslation:n=!0,selected:o=!0}={}){const{shape:a,size:r=0}=e,l=this.visible&&r>0&&i&&!Number.isNaN(i.x)&&!Number.isNaN(i.y);if(t.setStyleProperties(e,s),n?t.setProperties({visible:l,shape:a,size:r,x:i?.x,y:i?.y,scalingCenterX:i?.x,scalingCenterY:i?.y}):t.setProperties({visible:l,shape:a,size:r}),o||(t.fillOpacity*=yW,t.strokeOpacity*=xW),typeof a=="function"&&!t.dirtyPath){t.path.clear(!0),t.updatePath(),t.checkPathDirty();const c=t.getBBox();if(i!=null&&c.isFinite()){const h=c.computeCenter(),[d,u]=["x","y"].map(p=>(e.strokeWidth??0)+Math.abs(h[p]-i[p]));i.focusSize=Math.max(c.width+d,c.height+u)}}}get nodeDataDependencies(){return this._nodeDataDependencies??{seriesRectWidth:Number.NaN,seriesRectHeight:Number.NaN}}checkResize(e){const{width:t,height:i}=e??{width:Number.NaN,height:Number.NaN},s=e?{seriesRectWidth:t,seriesRectHeight:i}:void 0,n=Ln(this.nodeDataDependencies,s)!=null;return n&&(this._nodeDataDependencies=s,this.markNodeDataDirty()),n}pickFocus(e){}resetDatumCallbackCache(){this.datumCallbackCache.clear()}cachedDatumCallback(e,t){const{datumCallbackCache:i}=this,s=i.get(e);if(s!=null)return s;try{const n=t();return i.set(e,n),n}catch(n){j.error(String(n))}}cachedCallWithContext(e,t){return this.ctx.callbackCache.call([this.properties,this.ctx.chartService],e,t)}callWithContext(e,t){return as([this.properties,this.ctx.chartService],e,t)}formatTooltipWithContext(e,t,i){return e.formatTooltip([this.properties,this.ctx.chartService],t,i)}minTimeInterval(){}needsDataModelDiff(){return!this.ctx.animationManager.isSkipped()||!!this.chart?.flashOnUpdateEnabled}};Hg.className="Series",g([He({changeValue:function(e,t){this.onSeriesGroupingChange(t,e)}})],Hg.prototype,"seriesGrouping",2);var bW=class{constructor(e){this.swapChain=e,this.hasBeenActivated=!1,this.div=xe("div"),this.svg=Pt("svg"),this.outerPath=Pt("path"),this.innerPath=Pt("path"),this.svg.append(this.outerPath),this.svg.append(this.innerPath),this.outerPath.classList.add("ag-charts-focus-svg-outer-path"),this.innerPath.classList.add("ag-charts-focus-svg-inner-path"),this.element=xe("div","ag-charts-focus-indicator"),this.element.ariaHidden="true",this.element.append(this.svg),this.swapChain.addListener("swap",t=>this.onSwap(t))}clear(){}update(e,t,i){if(t!=null)if(e instanceof Fi){const s=(o,a)=>{let{x:r,y:l}=Kt.toCanvasPoint(e,o,a);return r-=t.x??0,l-=t.y??0,{x:r,y:l}},n=e.svgPathData(s);this.outerPath.setAttribute("d",n),this.innerPath.setAttribute("d",n),this.show(this.svg)}else{let s;if(i){const n=Math.max(e.x-t.x,0),o=Math.max(e.y-t.y,0),a=Math.min(e.x+e.width-t.x,t.width),r=Math.min(e.y+e.height-t.y,t.height);s=new re(n,o,a-n,r-o)}else s=new re(e.x-t.x,e.y-t.y,e.width,e.height);Cd(this.div,s),this.show(this.div)}}onSwap(e){e!==this.element.parentElement&&(this.element.remove(),e.appendChild(this.element),this.overrideFocusVisible(this.focusVisible))}show(e){this.hasBeenActivated=!0,this.element.innerHTML="",this.element.append(e)}overrideFocusVisible(e){this.focusVisible=e;const t={true:"1",false:"0",undefined:""};this.element.parentElement?.style.setProperty("opacity",t[`${e}`])}isFocusVisible(e=!1){if(!e&&!this.hasBeenActivated)return!1;const t=this.element.parentElement;return t!=null&&Ve().getComputedStyle(t).opacity==="1"}},vW=class{constructor(e,t,i,s){this.label1=e,this.label2=t,this.hasFocus=!1,this.skipDispatch=!1,this.listeners={blur:[],focus:[],swap:[]},this.onBlur=n=>(Cn(n.target,"pointer-events",void 0),!this.skipDispatch&&this.dispatch("blur",n)),this.onFocus=n=>(Cn(n.target,"pointer-events","auto"),!this.skipDispatch&&this.dispatch("focus",n)),Fe(this.label1,"id",ur()),Fe(this.label2,"id",ur()),Cn(this.label1,"display","none"),Cn(this.label2,"display","none"),this.label1.textContent=s,this.label2.textContent=s,this.activeAnnouncer=this.createAnnouncer(i),this.inactiveAnnouncer=this.createAnnouncer(i),Fe(this.activeAnnouncer,"tabindex",0),this.label2.insertAdjacentElement("afterend",this.activeAnnouncer),this.label2.insertAdjacentElement("afterend",this.inactiveAnnouncer),this.swap(s)}createAnnouncer(e){const t=xe("div");return t.role=e,t.className="ag-charts-swapchain",t.addEventListener("blur",this.onBlur),t.addEventListener("focus",this.onFocus),t}destroy(){for(const e of[this.activeAnnouncer,this.inactiveAnnouncer])e.removeEventListener("blur",this.onBlur),e.removeEventListener("focus",this.onFocus),e.remove()}focus(e){this.focusOptions=e,this.activeAnnouncer.focus(e),this.focusOptions=void 0}update(e){this.skipDispatch=!0,this.swap(e),this.hasFocus&&this.activeAnnouncer.focus(this.focusOptions),this.skipDispatch=!1}addListener(e,t){this.listeners[e].push(t),e==="swap"&&t(this.activeAnnouncer)}dispatch(e,t){e==="focus"?this.hasFocus=!0:e==="blur"&&(this.hasFocus=!1);for(const i of this.listeners[e])i(t)}swap(e){const t=this.activeAnnouncer.tabIndex;this.label2.textContent=e,[this.inactiveAnnouncer,this.activeAnnouncer]=[this.activeAnnouncer,this.inactiveAnnouncer],[this.label1,this.label2]=[this.label2,this.label1],oo(this.inactiveAnnouncer,{"aria-labelledby":this.label1.id,"aria-hidden":!0,tabindex:void 0}),oo(this.activeAnnouncer,{"aria-labelledby":this.label1.id,"aria-hidden":!1,tabindex:t}),this.dispatch("swap",this.activeAnnouncer)}},SW={arrowdown:{bindings:[{code:"ArrowDown"}]},arrowleft:{bindings:[{code:"ArrowLeft"}]},arrowright:{bindings:[{code:"ArrowRight"}]},arrowup:{bindings:[{code:"ArrowUp"}]},delete:{bindings:[{key:"Backspace"},{key:"Delete"}],activatesFocusIndicator:!1},redo:{bindings:[{key:"y",ctrlOrMeta:!0},{key:"z",ctrlOrMeta:!0,shift:!0}],activatesFocusIndicator:!1},undo:{bindings:[{key:"z",ctrlOrMeta:!0}],activatesFocusIndicator:!1},submit:{bindings:[{key:"Enter"},{code:"Enter"},{code:"Space"}]},zoomin:{bindings:[{key:"+"},{code:"ZoomIn"},{code:"Add"}],activatesFocusIndicator:!1},zoomout:{bindings:[{key:"-"},{code:"ZoomOut"},{code:"Substract"}],activatesFocusIndicator:!1}};function MW(e,t){for(const i of t)if("code"in i){if(i.code===e.code)return!0}else if(i.key===e.key&&(i.shift===void 0||i.shift===e.shiftKey)&&(i.ctrlOrMeta===void 0||i.ctrlOrMeta===e.ctrlKey||i.ctrlOrMeta===e.metaKey))return!0;return!1}function DW(e){for(const[t,{activatesFocusIndicator:i=!0,bindings:s}]of ht(SW))if(MW(e,s))return{name:t,activatesFocusIndicator:i}}function IW(e,t,i){const s=qT(e,i.datum,i.movedBounds);if(s!=null)return{x:s.canvasX,y:s.canvasY};const n=i.bounds;if(n!=null){if(n instanceof re){const{x:o,y:a}=n.computeCenter();return{x:t.x+o,y:t.y+a}}return Kt.toCanvas(n).computeCenter()}}function kW({bounds:e}){return e instanceof re?e:e!=null?Kt.toCanvas(e):re.NaN}function AW(e,t,i){const{x:s,y:n}=IW(e,t,i)??{};if(s!==void 0&&n!==void 0)return{type:"keyboard",canvasX:s,canvasY:n}}var _N=.1,VN=200,GN=12,CW=.5,LW=class{constructor(){this.events=new Sn,this.x1=Number.NaN,this.y1=Number.NaN,this.x=Number.NaN,this.y=Number.NaN,this.vx=0,this.vy=0,this.t0=Number.NaN,this.animationFrameHandle=void 0}reset(){this.x=Number.NaN,this.y=Number.NaN,this.animationFrameHandle!=null&&(cancelAnimationFrame(this.animationFrameHandle),this.animationFrameHandle=void 0)}update(e,t){if(Number.isNaN(this.x)||Number.isNaN(this.y)){this.x=e,this.y=t,this.vx=0,this.vy=0,this.emitUpdate(),this.animationFrameHandle!=null&&(cancelAnimationFrame(this.animationFrameHandle),this.animationFrameHandle=void 0);return}this.x1=e,this.y1=t,this.t0=Date.now(),this.animationFrameHandle??(this.animationFrameHandle=requestAnimationFrame(this.onFrame.bind(this)))}onFrame(){this.animationFrameHandle=void 0;const{x1:e,y1:t,t0:i}=this,s=Date.now(),n=s-i;this.t0=s;const o=.001,a=Math.trunc(Math.ceil(n/(o*1e3)));let{x:r,y:l,vx:c,vy:h}=this;for(let d=0;d<a;d+=1){const u=r-e,p=l-t,f=-(VN*u+GN*c)/_N,y=-(VN*p+GN*h)/_N;c+=f*o,h+=y*o,r+=c*o,l+=h*o}Math.hypot(r-e,l-t)<CW?(this.x=this.x1,this.y=this.y1,this.vx=0,this.vy=0):(this.x=r,this.y=l,this.vx=c,this.vy=h,this.animationFrameHandle=requestAnimationFrame(this.onFrame.bind(this))),this.emitUpdate()}emitUpdate(){this.events.emit("update",{x:this.x,y:this.y})}},fx=null;function pu(e){const t=Pe(e);return t===""?"":(fx??(fx=xe("div")),fx.textContent=t,fx.innerHTML.replaceAll(`
`,"<br>"))}function jg(e,t){const{path:i,size:s}=e,{x:n,y:o}=e;i.clear();let a=!1;for(const[r,l]of t){const c=n+(r-.5)*s,h=o+(l-.5)*s;a?i.lineTo(c,h):i.moveTo(c,h),a=!0}i.closePath()}var wW={circle({path:e,x:t,y:i,size:s}){const n=s/2;e.arc(t,i,n,0,Math.PI*2),e.closePath()},cross(e){jg(e,[[.25,0],[.5,.25],[.75,0],[1,.25],[.75,.5],[1,.75],[.75,1],[.5,.75],[.25,1],[0,.75],[.25,.5],[0,.25]])},diamond(e){jg(e,[[.5,0],[1,.5],[.5,1],[0,.5]])},heart({path:e,x:t,y:i,size:s}){const n=s/4;i=i+n/2,e.arc(t-n,i-n,n,mt(130),mt(330)),e.arc(t+n,i-n,n,mt(220),mt(50)),e.lineTo(t,i+n),e.closePath()},pin({path:e,x:t,y:i,size:s}){e.moveTo(t+(.891-.5)*s,i+(.391-.5)*s),e.cubicCurveTo(t+(.891-.5)*s,i+(.606-.5)*s,t+(.5-.5)*s,i+(1-.5)*s,t+(.5-.5)*s,i+(1-.5)*s),e.cubicCurveTo(t+(.5-.5)*s,i+(1-.5)*s,t+(.109-.5)*s,i+(.606-.5)*s,t+(.109-.5)*s,i+(.391-.5)*s),e.cubicCurveTo(t+(.109-.5)*s,i+(.175-.5)*s,t+(.284-.5)*s,i+(0-.5)*s,t+(.5-.5)*s,i+(0-.5)*s),e.cubicCurveTo(t+(.716-.5)*s,i+(0-.5)*s,t+(.891-.5)*s,i+(.175-.5)*s,t+(.891-.5)*s,i+(.391-.5)*s),e.closePath()},plus(e){jg(e,[[1/3,0],[2/3,0],[2/3,1/3],[1,1/3],[1,2/3],[2/3,2/3],[2/3,1],[1/3,1],[1/3,2/3],[0,2/3],[0,1/3],[1/3,1/3]])},square({path:e,x:t,y:i,size:s,pixelRatio:n}){const o=s/2;e.moveTo(Ri(n,t-o),Ri(n,i-o)),e.lineTo(Ri(n,t+o),Ri(n,i-o)),e.lineTo(Ri(n,t+o),Ri(n,i+o)),e.lineTo(Ri(n,t-o),Ri(n,i+o)),e.closePath()},star({path:e,x:t,y:i,size:s}){const o=s/2,a=o/2,r=Math.PI/2;for(let l=0;l<5*2;l++){const c=l%2===0?o:a,h=l*Math.PI/5-r,d=t+Math.cos(h)*c,u=i+Math.sin(h)*c;e.lineTo(d,u)}e.closePath()},triangle(e){jg(e,[[.5,0],[1,.87],[0,.87]])}},Wg=class extends Fi{constructor(){super(...arguments),this.shape="square",this.x=0,this.y=0,this.size=12}isPointInPath(e,t){return this.distanceSquared(e,t)<=0}get midPoint(){return{x:this.x,y:this.y}}distanceSquared(e,t){const i=ki.anchor(this.shape),s=e-this.x+(i.x-.5)*this.size,n=t-this.y+(i.y-.5)*this.size,o=this.size/2;return Math.max(s*s+n*n-o*o,0)}updatePath(){const{path:e,shape:t,x:i,y:s,size:n}=this,o=this.layerManager?.canvas?.pixelRatio??1,a=ki.anchor(t),r={path:e,x:i-(a.x-.5)*n,y:s-(a.y-.5)*n,size:n,pixelRatio:o};e.clear(),typeof t=="string"?wW[t](r):typeof t=="function"&&t(r)}computeBBox(){const{x:e,y:t,size:i}=this,s=ki.anchor(this.shape);return new re(e-i*s.x,t-i*s.y,i,i)}executeFill(e,t){if(t)return super.executeFill(e,t)}executeStroke(e,t){if(t)return super.executeStroke(e,t)}};g([Zd({equals:Vc})],Wg.prototype,"shape",2),g([_e()],Wg.prototype,"x",2),g([_e()],Wg.prototype,"y",2),g([_e({convertor:Math.abs})],Wg.prototype,"size",2);var ki=class extends Qd(Hy(Jd(Wg))){static anchor(e){return e==="pin"?{x:.5,y:1}:typeof e=="function"&&"anchor"in e?e.anchor:{x:.5,y:.5}}constructor(e){super(e),e?.shape!=null&&(this.shape=e.shape)}resetAnimationProperties(e,t,i,s,n,o){this.__x=e,this.__y=t,this.__size=i,this.__opacity=s,this.resetScalingProperties(n,o,e,t),this.dirtyPath=!0,this.markDirty()}};function TW(e,t,i=t*(5/3)){const s=new Oe,n=Math.min(e.marker.strokeWidth??1,2),o=e.line?.enabled?Math.min(e.line.strokeWidth,2):0,a=Math.max(e.marker.enabled===!1?0:t,e.line==null?0:i),r=Math.max(e.marker.enabled===!1?0:t,o);if(e.line?.enabled){const{stroke:l,strokeOpacity:c,lineDash:h}=e.line,d=new En;d.x1=0,d.y1=r/2,d.x2=a,d.y2=r/2,d.stroke=l,d.strokeOpacity=c,d.strokeWidth=o,d.lineDash=h,s.append(d)}if(e.marker.enabled!==!1){const{shape:l,fill:c,fillOpacity:h,stroke:d,strokeOpacity:u,lineDash:p,lineDashOffset:f}=e.marker,y=new ki;y.shape=l??"square",y.size=t,y.fill=c,y.fillOpacity=h??1,y.stroke=d,y.strokeOpacity=u??1,y.strokeWidth=n,y.lineDash=p,y.lineDashOffset=f??0;const b=ki.anchor(l),x=a/2+(b.x-.5)*t,v=r/2+(b.y-.5)*t,S=t/(t+n);y.x=x,y.y=v,y.scalingCenterX=x,y.scalingCenterY=v,y.scalingX=S,y.scalingY=S,s.append(y)}return Oe.toSVG(s,a,r)}var Ki="ag-charts-tooltip",NW="ag-charts-tooltip--dark";function Ir(e){return e==null?!1:Array.isArray(e)?e.some(t=>Ir(t.text)):Dt(e).trim()!==""}function Jc(e){return e==null||typeof e=="number"&&!Number.isFinite(e)}function OW(e){return e.type==="raw"||!e.data||e.data.length===0?!1:e.data.every(t=>t.missing===!0)}function HN(e){const t=[],i=new Map;for(const s of e)if(!OW(s))if(s.type==="structured"){const{heading:n}=s,o=Ir(n)?i.get(n):void 0,a={type:"structured",heading:n,items:[s]};o==null?(i.set(n,a),t.push(a)):o.items.push(s)}else t.push(s);return t}function EW(e){const t=HN(e),i=[];for(const s of t)if(s.type!=="raw"){Ir(s.heading)&&i.push(Pe(s.heading));for(const n of s.items)if(Ir(n.title)&&i.push(Pe(n.title)),n.data)for(const o of n.data)o.missing!==!0&&i.push(o.label??o.fallbackLabel,Pe(o.value))}return i.filter(s=>s!=="").join("; ")}function jN(e,t,i){let s="";Ir(e)?(s+=`<span class="${Ki}-label">${pu(e)}</span>`,s+=" ",s+=`<span class="${Ki}-value">${pu(t)}</span>`):s+=`<span class="${Ki}-label">${pu(t)}</span>`;const n=[`${Ki}-row`];return i&&n.push(`${Ki}-row--inline`),s=`<div class="${n.join(" ")}">${s}</div>`,s}function PW(e){let t="";if(e.data?.length&&e.data.every(o=>o.missing===!0))return t;const i=Ir(e.title),s=!i&&e.data?.length===1,n=e.symbol==null?void 0:TW(e.symbol,12);if(n!=null&&(i||e.data?.length)&&(t+=`<span class="${Ki}-symbol">${n}</span>`),i&&(t+=`<span class="${Ki}-title">${pu(e.title)}</span>`,t+=" "),e.data)for(const o of e.data)o.missing!==!0&&(t+=jN(o.label??o.fallbackLabel,Pe(o.value),s),t+=" ");return t}function WN(e,t){if(e==null||t.length===1)return;const i=e?.t("tooltipPaginationStatus",{index:t.index+1,count:t.length});return`<div class="${Ki}-footer">${i}</div>`}function $N(e,t,i,s){const n=t.items.length===1?t.items[0]:void 0;let o,a,r;switch(i){case"compact":o=!0,a=Pe(n?.title);break;case"single":const h=Ir(t.heading);o=n!=null&&(!h||n.title==null)&&n.data?.length===1&&n.data[0].label==null&&n.data[0].value!=null,r=Pe(h?t.heading:n?.title);break;case"shared":o=!1}let l="";if(o&&n!=null){if(Ir(a)&&(l+=`<span class="${Ki}-title">${pu(a)}</span>`),n.data)for(const h of n.data)h.missing!==!0&&(l+=jN(h.label??r,Pe(h.value),!1),l+=" ")}else{Ir(t.heading)&&(l+=`<span class="${Ki}-heading">${pu(Pe(t.heading))}</span>`,l+=" ");for(const h of t.items)l+=PW(h)}if(l.length===0)return;const c=i!=="compact"&&s!=null?WN(e,s):void 0;return c+null&&(l+=c),l=`<div class="${Ki}-content">${l.trimEnd()}</div>`,l}function RW(e,t){const i=t==null?void 0:WN(e,t);return i==null?"":`<div class="${Ki}-content">${i}</div>`}function FW(e,t,i,s){const n=HN(t);if(n.length!==0){if(n.length===1&&n[0].type==="structured")return $N(e,n[0],i,s);{const o=n.map(a=>a.type==="structured"?$N(e,a,i):a.rawHtmlString);return s!=null&&o.push(RW(e,s)??""),o.join("")}}}var zW={left:-1,"top-left":-1,"bottom-left":-1,top:0,center:0,bottom:0,right:1,"top-right":1,"bottom-right":1},BW={"top-left":-1,top:-1,"top-right":-1,left:0,center:0,right:0,"bottom-left":1,bottom:1,"bottom-right":1},_W={left:3,"top-left":void 0,"bottom-left":void 0,top:2,center:void 0,bottom:1,right:0,"top-right":void 0,"bottom-right":void 0},UN={top:2,bottom:2,left:1,right:1,"top-right":3,"top-left":3,"bottom-right":3,"bottom-left":3,center:0},VW={pointer:"top",node:"top",chart:"top-left"},gu=class extends K{constructor(){super(...arguments),this.xOffset=0,this.yOffset=0}};g([m],gu.prototype,"xOffset",2),g([m],gu.prototype,"yOffset",2),g([m],gu.prototype,"anchorTo",2),g([m],gu.prototype,"placement",2);var Wo=class extends K{constructor(){super(),this.enabled=!0,this.mode="single",this.delay=0,this.range=void 0,this.wrapping="hyphenate",this.position=new gu,this.pagination=!1,this.darkTheme=!1,this.bounds="extended",this.cleanup=new pt,this.springAnimation=new LW,this.enableInteraction=!1,this.wrapTypes=["always","hyphenate","on-space","never"],this.sizeMonitor=new pT,this._elementSize=void 0,this._showTimeout=void 0,this.arrowPosition=void 0,this._visible=!1,this.positionParams=void 0,this.localeManager=void 0,this.cleanup.register(this.springAnimation.events.on("update",this.updateTooltipPosition.bind(this)))}get interactive(){return this.enableInteraction}setup(e,t){return"togglePopover"in Ve().HTMLElement.prototype&&(this.element=t.addChild("tooltip-container",Ki),this.element.setAttribute("popover","manual"),this.element.className=Ki,this.element.style.positionAnchor=t.anchorName,this.sizeMonitor.observe(this.element,i=>{this._elementSize=i,this.updateTooltipPosition()})),this.localeManager=e,()=>{t.removeChild("tooltip-container",Ki),this.cleanup.flush(),this.element&&this.sizeMonitor.unobserve(this.element)}}isVisible(){return this._visible}contains(e){return this.element?.contains(e)??!1}updateTooltipPosition(){const{element:e,_elementSize:t,positionParams:i}=this;if(e==null||t==null||i==null)return;const{canvasRect:s,relativeRect:n,meta:o}=i,{x:a,y:r}=this.springAnimation,l=o.position?.anchorTo??"pointer";let c=o.position?.placement??VW[l];Array.isArray(c)||(c=[c]);const h=o.position?.xOffset??0,d=o.position?.yOffset??0,u=n.x,p=n.y,f=n.width-t.width-1+u,y=n.height-t.height+p;let b=0,x,v,S=!1;do{x=c[b],b+=1;const A=this.getTooltipBounds({elementSize:t,placement:x,anchorTo:l,canvasX:a,canvasY:r,yOffset:d,xOffset:h,canvasRect:s});v=my(t.width,t.height,n,A),S=!1,UN[x]&1&&(S||(S=v.x<u||v.x>f)),UN[x]&2&&(S||(S=v.y<p||v.y>y))}while(b<c.length&&S);const M=ge(u,v.x,f),D=ge(p,v.y,y);S||(S=M!==v.x||D!==v.y);const k=l!=="chart"&&!S&&!h&&!d,I=o.showArrow??this.showArrow??k;this.arrowPosition=I?_W[x]:void 0,this.updateClassModifiers(),e.style.translate=`${M}px ${D}px`}show(e,t,i,s,n,o=!1){const{element:a}=this;if(a!=null&&s!=null&&s.length!==0){const c=FW(this.localeManager,s,this.mode,this.pagination?n:void 0);if(c==null){this.toggle(!1);return}a.innerHTML=c}else if(a==null||a.innerHTML===""){this.toggle(!1);return}const r={x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height};switch(this.positionParams={canvasRect:t,relativeRect:r,meta:i},i.position?.anchorTo??"pointer"){case"node":this.springAnimation.update(i.nodeCanvasX??i.canvasX,i.nodeCanvasY??i.canvasY);break;case"pointer":this.springAnimation.update(i.canvasX,i.canvasY);break;case"chart":this.springAnimation.reset()}i.enableInteraction?(this.enableInteraction=!0,a.style.pointerEvents="auto",a.removeAttribute("aria-hidden"),a.tabIndex=-1):(this.enableInteraction=!1,a.style.pointerEvents="none",a.setAttribute("aria-hidden","true"),a.removeAttribute("tabindex")),a.style.setProperty("--top",`${t.top}px`),a.style.setProperty("--left",`${t.left}px`),this.updateClassModifiers(),this.toggle(!0,o)}hide(){this.toggle(!1)}maybeEnterInteractiveTooltip({relatedTarget:e},t){const{interactive:i,interactiveLeave:s,enabled:n,element:o}=this;if(o==null)return!1;if(s)return!0;const a=i&&n&&this.isVisible()&&e instanceof Node&&this.contains(e);return a&&(this.interactiveLeave={callback:t,listener:r=>{(r.relatedTarget==null||r.relatedTarget instanceof Node&&!this.contains(r.relatedTarget))&&this.popInteractiveLeaveCallback()}},o.addEventListener("focusout",this.interactiveLeave.listener),o.addEventListener("mouseout",this.interactiveLeave.listener)),a}popInteractiveLeaveCallback(){const{interactiveLeave:e,element:t}=this;this.interactiveLeave=void 0,e&&(t&&(t.removeEventListener("focusout",e.listener),t.removeEventListener("mouseout",e.listener)),e.callback())}toggle(e,t=!1){const{delay:i}=this;e&&i>0&&!t?this._showTimeout??(this._showTimeout=setTimeout(()=>{this._showTimeout=void 0,this.toggleCallback(!0)},i)):(clearTimeout(this._showTimeout),this._showTimeout=void 0,this.toggleCallback(e))}toggleCallback(e){this.element?.isConnected&&this._visible!==e&&(this._visible=e,this.element.togglePopover(e),e?this.updateTooltipPosition():(this.springAnimation.reset(),this.popInteractiveLeaveCallback()))}updateClassModifiers(){if(!this.element?.isConnected)return;const{classList:e}=this.element,t=(i,s)=>e.toggle(`${Ki}--${i}`,s);t("no-interaction",!this.enableInteraction),t("arrow-top",this.arrowPosition===1),t("arrow-right",this.arrowPosition===3),t("arrow-bottom",this.arrowPosition===2),t("arrow-left",this.arrowPosition===0),t("compact",this.mode==="compact"),e.toggle(NW,this.darkTheme);for(const i of this.wrapTypes)e.toggle(`${Ki}--wrap-${i}`,i===this.wrapping)}getTooltipBounds(e){const{elementSize:t,anchorTo:i,placement:s,canvasX:n,canvasY:o,yOffset:a,xOffset:r,canvasRect:l}=e,{width:c,height:h}=t,d={width:c,height:h};if(i==="node"||i==="pointer"){const u=zW[s],p=BW[s];return d.top=o+a+h*(p-1)/2+8*p,d.left=n+r+c*(u-1)/2+8*u,d}switch(s){case"top":return d.top=a,d.left=l.width/2-c/2+r,d;case"right":return d.top=l.height/2-h/2+a,d.left=l.width-c+r,d;case"left":return d.top=l.height/2-h/2+a,d.left=r,d;case"bottom":return d.top=l.height-h+a,d.left=l.width/2-c/2+r,d;case"top-left":return d.top=a,d.left=r,d;case"top-right":return d.top=a,d.left=l.width-c+r,d;case"bottom-right":return d.top=l.height-h+a,d.left=l.width-c+r,d;case"bottom-left":return d.top=l.height-h+a,d.left=r,d}return d}};g([m],Wo.prototype,"enabled",2),g([m],Wo.prototype,"mode",2),g([m],Wo.prototype,"showArrow",2),g([m],Wo.prototype,"delay",2),g([m],Wo.prototype,"range",2),g([m],Wo.prototype,"wrapping",2),g([m],Wo.prototype,"position",2),g([m],Wo.prototype,"pagination",2),g([m],Wo.prototype,"darkTheme",2),g([m],Wo.prototype,"bounds",2);function pD(e,t){return e.series===t.series&&ii(e.datumIndex,t.datumIndex)}var GW=class{constructor(){this.candidates=[]}get current(){return this.active}reset(){this.candidates.length=0,this.active=void 0}update(e,t){this.candidates=e;let i=t==null?-1:e.findIndex(s=>pD(s,t));return i===-1&&(i=0),this.active=e[i],{current:this.active,index:i,length:e.length}}next(){const{candidates:e,active:t}=this,i=t==null?-1:e.findIndex(n=>pD(n,t));if(i===-1)return;let s=i+1;return s>=e.length&&(s=0),this.active=e[s],{current:this.active,index:s,length:this.candidates.length}}},KN=class extends AM{constructor(e){super(),this.chart=e,this.id=Mi(this),this.series=[],this.announceMode="when-changed",this.highlight={pendingHoverEvent:void 0,appliedHoverEvent:void 0,stashedHoverEvent:void 0},this.tooltip={lastHover:void 0},this.hoverDevice="pointer",this.previousInputDevice="keyboard",this.focus={sortedSeries:[],series:void 0,seriesIndex:0,datumIndex:0,datum:void 0},this.cachedTooltipContent=void 0,this.hoverScheduler=BG(()=>{if(!(!this.tooltip.lastHover&&!this.highlight.pendingHoverEvent)){if(this.chart.getUpdateType()<=5){this.hoverScheduler.schedule();return}this.highlight.pendingHoverEvent&&this.handleHoverHighlight(!1),this.tooltip.lastHover&&this.handleHoverTooltip(this.tooltip.lastHover,!1)}}),this.tooltipCandidates=new GW;const t=e.ctx.localeManager.t("ariaInitSeriesArea"),i=e.ctx.domManager.addChild("series-area","series-area-aria-label1"),s=e.ctx.domManager.addChild("series-area","series-area-aria-label2");this.swapChain=new vW(i,s,"img",t),this.swapChain.addListener("blur",r=>this.onBlur(r)),this.swapChain.addListener("focus",()=>this.onFocus()),e.ctx.domManager.mode==="normal"&&(this.focusIndicator=new bW(this.swapChain),this.focusIndicator.overrideFocusVisible(e.mode==="integrated"?!1:void 0));const{seriesDragInterpreter:n,seriesWidget:o,containerWidget:a}=e.ctx.widgets;o.setTabIndex(-1),this.cleanup.register(()=>e.ctx.domManager.removeChild("series-area","series-area-aria-label1"),()=>e.ctx.domManager.removeChild("series-area","series-area-aria-label2"),o.addListener("focus",()=>this.swapChain.focus({preventScroll:!0})),o.addListener("mousemove",r=>this.onHover(r,o)),o.addListener("wheel",r=>this.onWheel(r)),o.addListener("mouseleave",r=>this.onLeave(r)),o.addListener("keydown",r=>this.onKeyDown(r)),o.addListener("contextmenu",(r,l)=>this.onContextMenu(r,l)),a.addListener("contextmenu",(r,l)=>this.onContextMenu(r,l)),a.addListener("click",(r,l)=>this.onClick(r,l)),a.addListener("dblclick",(r,l)=>this.onClick(r,l)),e.ctx.animationManager.addListener("animation-start",()=>this.clearAll()),e.ctx.eventsHub.on("dom:resize",()=>this.clearAll()),e.ctx.eventsHub.on("highlight:change",r=>this.changeHighlightDatum(r)),e.ctx.eventsHub.on("layout:complete",r=>this.layoutComplete(r)),e.ctx.updateService.addListener("pre-scene-render",()=>this.preSceneRender()),e.ctx.updateService.addListener("update-complete",()=>this.updateComplete()),e.ctx.eventsHub.on("zoom:change-complete",()=>this.clearAll()),e.ctx.eventsHub.on("zoom:pan-start",()=>this.clearAll())),n&&this.cleanup.register(n.events.on("drag-move",r=>this.onDragMove(r,o)),n.events.on("click",r=>this.onClick(r,o)),n.events.on("dblclick",r=>this.onClick(r,o)))}get bbox(){return(this.seriesRect??re.zero).clone()}isState(e){return this.chart.ctx.interactionManager.isState(e)}isIgnoredTouch(e){return!(e.device!=="touch"||e.type==="click"||this.chart.ctx.chartService.touch.dragAction==="hover"||this.chart.ctx.chartService.touch.dragAction==="drag"&&this.isState(9))}dataChanged(){var e;this.cachedTooltipContent=void 0,this.highlight.appliedHoverEvent&&((e=this.highlight).stashedHoverEvent??(e.stashedHoverEvent=this.highlight.appliedHoverEvent),this.clearHighlight()),this.chart.ctx.tooltipManager.removeTooltip(this.id),this.focusIndicator?.clear()}preSceneRender(){this.highlight.stashedHoverEvent!=null&&(this.highlight.pendingHoverEvent=this.tooltip.lastHover??this.highlight.stashedHoverEvent,this.highlight.stashedHoverEvent=void 0,this.handleHoverHighlight(!0)),this.tooltip.lastHover!=null&&this.handleHoverTooltip(this.tooltip.lastHover,!0)}updateComplete(){this.isState(34)&&this.focusIndicator?.isFocusVisible()&&(this.announceMode!=="always"&&(this.announceMode="never"),this.handleFocus(0,0))}update(e,t){this.chart.ctx.updateService.update(e,t)}seriesChanged(e){this.focus.sortedSeries=[...e].sort((t,i)=>{let s=t.properties.focusPriority??1/0,n=i.properties.focusPriority??1/0;return s===n&&([s,n]=[t.declarationOrder,i.declarationOrder]),s<n?-1:s>n?1:0}),this.series=e}layoutComplete(e){this.seriesRect=e.series.rect,this.hoverRect=e.series.rect,this.chart.ctx.widgets.seriesWidget.setBounds(e.series.rect),this.chart.ctx.domManager.mode==="normal"&&this.chart.ctx.widgets.chartWidget.setBounds(e.chart)}onContextMenu(e,t){const{sourceEvent:i}=e;if(i.currentTarget!=t.getElement())return;if(t!==this.chart.ctx.widgets.seriesWidget){if(this.isState(36)){const{currentX:c,currentY:h}=e;this.chart.ctx.contextMenuRegistry.dispatchContext("always",{widgetEvent:e,canvasX:c,canvasY:h},void 0)}return}let s,n;if(this.focusIndicator?.isFocusVisible())s=this.chart.ctx.highlightManager.getActiveHighlight(),s&&this.seriesRect&&s.midPoint&&(n=Kt.toCanvasPoint(s.series.contentGroup,s.midPoint.x,s.midPoint.y));else if(this.isState(36)){const c=this.pickNodes({x:e.currentX,y:e.currentY},"context-menu");c&&(this.chart.ctx.highlightManager.updateHighlight(this.id),s=c.matches[0].datum)}const o=s?.series;this.clearAll();const a=e.currentX+t.cssLeft(),r=e.currentY+t.cssTop(),{datumIndex:l}=s??{};o&&s&&l!=null?this.chart.ctx.contextMenuRegistry.dispatchContext("series-node",{widgetEvent:e,canvasX:a,canvasY:r},{pickedSeries:o,pickedNode:{...s,datumIndex:l}},n):this.chart.ctx.contextMenuRegistry.dispatchContext("series-area",{widgetEvent:e,canvasX:a,canvasY:r},void 0,n)}onLeave(e){!this.isState(41)||e.sourceEvent.relatedTarget?.className==="ag-charts-text-input__textarea"||this.maybeEnterInteractiveTooltip(e.sourceEvent)||(this.chart.ctx.domManager.updateCursor(this.id),this.hoverDevice!=="keyboard"&&this.clearAll(!0))}onWheel(e){this.isState(41)&&(this.focusIndicator?.overrideFocusVisible(!1),this.previousInputDevice="pointer")}onDragMove(e,t){this.isState(41)&&(this.focusIndicator?.overrideFocusVisible(!1),this.onHoverLikeEvent(e,t))}onHover(e,t){this.isState(41)&&this.onHoverLikeEvent(e,t)}onHoverLikeEvent(e,t){if(this.isIgnoredTouch(e)||(e.device==="touch"&&this.chart.ctx.chartService.touch.dragAction==="hover"&&e.sourceEvent.preventDefault(),t!==this.chart.ctx.widgets.seriesWidget))return;(e.device==="touch"||HW(e,"drag-move"))&&(this.tooltip.lastHover=e),this.hoverDevice="pointer",this.previousInputDevice="pointer",this.highlight.pendingHoverEvent=e,this.hoverScheduler.schedule();let i;if(this.isState(32)){const{currentX:n,currentY:o}=e;i=this.pickNodes({x:n,y:o},"event");const a=i?.matches,r=a?.[0];r?.series.hasEventListener("seriesNodeClick")||r?.series.hasEventListener("seriesNodeDoubleClick")||a!=null&&a.length>1&&this.chart.tooltip.pagination?this.chart.ctx.domManager.updateCursor(this.id,"pointer"):this.chart.ctx.domManager.updateCursor(this.id)}const s=!!i?.matches.length;this.emitSeriesAreaHoverEvent(e,s)}onClick(e,t){if(e.device==="keyboard"||(t===this.chart.ctx.widgets.seriesWidget&&this.chart.ctx.animationManager.isActive()&&this.chart.ctx.animationManager.skipCurrentBatch(),e.device==="touch"&&t===this.chart.ctx.widgets.seriesWidget&&this.swapChain.focus({preventScroll:!0}),!this.isState(41)))return;if(t===this.chart.ctx.widgets.seriesWidget){if(!t.getElement().contains(e.sourceEvent.target))return}else if(e.sourceEvent.target!=t.getElement())return;this.focusIndicator?.overrideFocusVisible(!1),this.onHoverLikeEvent(e,t);const i=t===this.chart.ctx.widgets.seriesWidget;if(!this.isState(32)){i&&this.emitSeriesAreaClickEvent(e,!1);return}if(i){if(!!this.checkSeriesNodeClick(e)){this.emitSeriesAreaClickEvent(e,!0),this.update(5),e.sourceEvent.preventDefault();return}this.emitSeriesAreaClickEvent(e,!1)}const s={type:e.type==="click"?"click":"doubleClick",event:e.sourceEvent};this.chart.fireEvent(s)}emitSeriesAreaHoverEvent(e,t){const i=this.toCanvasCoordinates(e.currentX,e.currentY);if(i==null)return;const s={x:i.x,y:i.y,consumed:t,sourceEvent:e.sourceEvent};this.chart.ctx.eventsHub.emit("series-area:hover",s)}emitSeriesAreaClickEvent(e,t){if(!("currentX"in e))return;const i=this.toCanvasCoordinates(e.currentX,e.currentY);if(i==null)return;const s={x:i.x,y:i.y,consumed:t,sourceEvent:e.sourceEvent};this.chart.ctx.eventsHub.emit("series-area:click",s)}toCanvasCoordinates(e,t){const i=this.hoverRect?.x??this.seriesRect?.x??0,s=this.hoverRect?.y??this.seriesRect?.y??0;return{x:e+i,y:t+s}}onFocus(){this.isState(34)&&(this.hoverDevice=this.focusIndicator?.isFocusVisible(!0)?"keyboard":"pointer",this.handleFocus(0,0))}onBlur(e){this.isState(34)&&(this.hoverDevice="pointer",this.maybeEnterInteractiveTooltip(e)||this.clearAll(!0),this.focusIndicator?.overrideFocusVisible(void 0))}onKeyDown(e){if(!this.isState(43))return;const t=DW(e.sourceEvent);switch(t?.activatesFocusIndicator===!1&&this.focusIndicator?.overrideFocusVisible(this.previousInputDevice==="keyboard"),t?.name){case"redo":return this.chart.ctx.eventsHub.emit("series:redo",null);case"undo":return this.chart.ctx.eventsHub.emit("series:undo",null);case"zoomin":return this.chart.ctx.eventsHub.emit("series:keynav-zoom",{delta:1,widgetEvent:e});case"zoomout":return this.chart.ctx.eventsHub.emit("series:keynav-zoom",{delta:-1,widgetEvent:e});case"arrowup":return this.onArrow(-1,0,e);case"arrowdown":return this.onArrow(1,0,e);case"arrowleft":return this.onArrow(0,-1,e);case"arrowright":return this.onArrow(0,1,e);case"submit":return this.onSubmit(e)}}onArrow(e,t,i){this.isState(34)&&(this.hoverDevice="keyboard",this.previousInputDevice="keyboard",this.focusIndicator?.overrideFocusVisible(!0),this.focus.seriesIndex+=e,this.focus.datumIndex+=t,this.handleFocus(e,t),i.sourceEvent.preventDefault(),this.chart.ctx.eventsHub.emit("series:focus-change",null))}onSubmit(e){if(!this.isState(34))return;const{series:t,datum:i}=this.focus,s=e.sourceEvent;t!=null&&i!=null?t.fireNodeClickEvent(s,i):this.chart.fireEvent({type:"click",event:s}),s.preventDefault()}checkSeriesNodeClick(e){var t;const i=this.pickNodes({x:e.currentX,y:e.currentY},"event");if(i==null||i.matches.length===0)return;const s=this.chart.tooltip.pagination?this.tooltipCandidates.update(i.matches,this.tooltipCandidates.current)?.current:void 0,{series:n,datum:o}=s??i.matches[0],a=s==null?i.distance:0;if(e.type==="click"){const l=n.fireNodeClickEvent(e.sourceEvent,o)&&this.chart.tooltip.pagination?this.tooltipCandidates.next():void 0;if(l!=null){e.sourceEvent.preventDefault();const{currentX:c,currentY:h}=e,d=c+(this.hoverRect?.x??0),u=h+(this.hoverRect?.y??0);(t=this.highlight).pendingHoverEvent??(t.pendingHoverEvent=this.highlight.appliedHoverEvent),this.handleHoverHighlight(!1),this.showTooltip(l.current,d,u,{index:l.index,length:l.length})}return!0}return e.type==="dblclick"?(e.preventZoomDblClick=a===0,n.fireNodeDoubleClickEvent(e.sourceEvent,o),!0):!1}handleFocus(e,t){const i=this.chart.overlays.getFocusInfo(this.chart.ctx.localeManager);i==null?this.handleSeriesFocus(e,t)===0?this.announceMode="when-changed":this.announceMode="always":(this.focusIndicator?.update(i.rect,this.seriesRect,!1),this.swapChain.update(i.text),this.announceMode="always")}handleSeriesFocus(e,t){if(this.chart.chartType==="standalone")return this.handleSoloSeriesFocus(e,t);const{focus:i}=this,s=i.sortedSeries.filter(l=>l.visible&&l.focusable);if(s.length===0)return 1;const n=i.datumIndex-t,o=i.seriesIndex-e;i.seriesIndex=ge(0,i.seriesIndex,s.length-1),i.series=s[i.seriesIndex];const a=this.focus.datumIndex,r=this.focus.seriesIndex;return this.updatePickedFocus(a,t,n,r,e,o)}handleSoloSeriesFocus(e,t){this.focus.series=this.focus.sortedSeries[0];const i=this.focus.datumIndex,s=this.focus.seriesIndex,n=this.focus.datumIndex-t,o=this.focus.seriesIndex-e;return this.updatePickedFocus(i,t,n,s,e,o)}updatePickedFocus(e,t,i,s,n,o){const{focus:a,hoverRect:r,seriesRect:l}=this;if(a.series==null||r==null)return 1;const c=a?.series?.pickFocus({datumIndex:e,datumIndexDelta:t,otherIndex:s,otherIndexDelta:n,seriesRect:l});if(!c)return 2;const{datum:h}=c;if(a.datum=h,a.datumIndex=c.datumIndex,c.otherIndex!=null&&(a.seriesIndex=c.otherIndex),this.focusIndicator?.isFocusVisible()){this.chart.ctx.animationManager.reset();const p=kW(c),{x:f,y}=p.computeCenter();if(!r.containsPoint(f,y)&&this.chart.ctx.zoomManager.panToBBox(r,p))return 3;const{x1:b,x2:x,y1:v,y2:S}=ke.from(p),M=r.containsPoint(b,v),D=r.containsPoint(x,v),k=r.containsPoint(b,S),I=r.containsPoint(x,S);if(!(M||D||k||I)){const A=ke.from(r);c.movedBounds=p.clone(),b<A.x1&&x<A.x1?(c.movedBounds.x=A.x1-2,c.movedBounds.width=4):b>A.x2&&x>A.x2&&(c.movedBounds.x=A.x2-2,c.movedBounds.width=4),v<A.y1&&S<A.y1?(c.movedBounds.y=A.y1-2,c.movedBounds.height=4):v>A.y2&&S>A.y2&&(c.movedBounds.y=A.y2-2,c.movedBounds.height=4)}}this.focusIndicator?.update(c.movedBounds??c.bounds,this.seriesRect,c.clipFocusBox);const d=this.getTooltipContent(a.series,h.datumIndex,h,"aria-label"),u=AW(a.series,r,c);if(u!=null&&this.hoverDevice==="keyboard"){this.tooltip.lastHover=void 0,this.highlight.appliedHoverEvent=void 0,this.highlight.pendingHoverEvent=void 0,this.highlight.stashedHoverEvent=void 0;const p=lx.makeTooltipMeta(u,a.series,h,c.movedBounds);this.chart.ctx.highlightManager.updateHighlight(this.id,h),this.isTooltipEnabled(a.series)&&this.chart.ctx.tooltipManager.updateTooltip(this.id,p,d)}return this.maybeAnnouncePickedFocus(t,i,n,o,c,d),0}maybeAnnouncePickedFocus(e,t,i,s,n,o){const{focus:a}=this;let r;this.announceMode==="when-changed"?e===0&&i===0||t!==n.datumIndex||s!==(n.otherIndex??a.seriesIndex)?r="always":r="never":r=this.announceMode,r==="always"&&this.swapChain.update(this.getDatumAriaText(n.datum,o))}getDatumAriaText(e,t){const i=t==null?"":EW(t);return this.chart.ctx.localeManager.t("ariaAnnounceHoverDatum",{datum:e.series.getDatumAriaText?.(e,i)??i})}clearHighlight(e=!1){this.highlight.pendingHoverEvent=void 0,this.highlight.appliedHoverEvent=void 0,this.chart.ctx.highlightManager.updateHighlight(this.id,void 0,e)}clearTooltip(e=!1){this.chart.ctx.tooltipManager.removeTooltip(this.id,void 0,e),this.tooltip.lastHover=void 0}clearAll(e=!1){this.clearHighlight(e),this.clearTooltip(e),this.focusIndicator?.clear()}handleHoverHighlight(e){this.highlight.appliedHoverEvent=this.highlight.pendingHoverEvent,this.highlight.pendingHoverEvent=void 0;const t=this.highlight.appliedHoverEvent;if(!t||!this.isState(41))return;const{currentX:i,currentY:s}=t,n=t.currentX+(this.hoverRect?.x??0),o=t.currentY+(this.hoverRect?.y??0);if(e?this.chart.ctx.animationManager.isActive():!this.hoverRect?.containsPoint(n,o)){this.clearHighlight();return}const{range:a}=this.chart.highlight,r=a==="tooltip"?"highlight-tooltip":"highlight",l=this.pickNodes({x:i,y:s},r);if(!l||l.matches.length===0){this.chart.ctx.highlightManager.updateHighlight(this.id,void 0,!0);return}const{current:c}=this.tooltipCandidates,d=(c==null?void 0:l.matches.find(u=>pD(u,c)))?.datum??l.matches[0].datum;this.chart.ctx.highlightManager.updateHighlight(this.id,d),this.hoverDevice="pointer"}handleHoverTooltip(e,t){const{current:i}=this.tooltipCandidates;if(this.tooltipCandidates.reset(),!this.isState(41))return;const{currentX:s,currentY:n}=e,o=s+(this.hoverRect?.x??0),a=n+(this.hoverRect?.y??0),r=e.sourceEvent.target;if(t?this.chart.ctx.animationManager.isActive():!this.hoverRect?.containsPoint(o,a)){this.hoverDevice=="pointer"&&this.clearTooltip();return}if(r&&this.chart.tooltip.interactive&&this.chart.ctx.domManager.isManagedChildDOMElement(r,"canvas-overlay",Ki))return;const l=this.pickNodes({x:e.currentX,y:e.currentY},"tooltip");if(!l||l.matches.length===0){this.hoverDevice=="pointer"&&this.clearTooltip(!0);return}if(this.hoverDevice="pointer",l.distance===0){const{current:c,index:h,length:d}=this.tooltipCandidates.update(l.matches,this.chart.tooltip.pagination?i:void 0);this.showTooltip(c,o,a,{index:h,length:d})}else this.showTooltip(l.matches[0],o,a)}showTooltip({series:e,datum:t,datumIndex:i},s,n,o){const a=this.getTooltipContent(e,i,t,"tooltip");if(a!=null){const l=lx.makeTooltipMeta({type:"pointermove",canvasX:s,canvasY:n},e,t,void 0);this.chart.ctx.tooltipManager.updateTooltip(this.id,l,a,o)}else this.chart.ctx.tooltipManager.removeTooltip(this.id,void 0,!0)}maybeEnterInteractiveTooltip(e){return this.chart.tooltip.maybeEnterInteractiveTooltip(e,()=>{this.tooltip.lastHover=void 0,this.chart.ctx.tooltipManager.removeTooltip(this.id),this.chart.ctx.highlightManager.updateHighlight(this.id,void 0,!0)})}changeHighlightDatum(e){const t=e.previousHighlight?.series,i=e.currentHighlight?.series;t?.properties.cursor&&e.previousHighlight?.datum&&this.chart.ctx.domManager.updateCursor(t.id),i?.properties.cursor&&i.properties.cursor!=="default"&&e.currentHighlight?.datum&&this.chart.ctx.domManager.updateCursor(i.id,i.properties.cursor),i==null||t==null?this.update(5,{clearCallbackCache:!0}):this.update(5,{seriesToUpdate:new Set([t,i].filter(Boolean)),clearCallbackCache:!0})}pickNodes(e,t,i){const s=[...this.series].reverse();let n;for(const o of s){if(!o.visible||!o.contentGroup.visible)continue;const a=o.pickNodes(e,t,i);if(a==null||a.datums.length===0)continue;const{datums:r,distance:l}=a;if(a.datums.length!==0){if(l===0){n?.distance!==0&&(n={matches:[],distance:0});for(const c of r){const{datumIndex:h}=c;n.matches.push({series:o,datum:c,datumIndex:h})}}else if(n==null||n.distance>l){const[c]=r,{datumIndex:h}=c;n={matches:[{series:o,datum:c,datumIndex:h}],distance:l}}}}return n}isTooltipEnabled(e){return e.tooltipEnabled??this.chart.tooltip.enabled}getTooltipContent(e,t,i,s){let n;if(s==="aria-label"||this.isTooltipEnabled(e)){const{cachedTooltipContent:o}=this;if(o!=null&&o.series===e&&o.datumIndex===t)n=o.content;else{const a=this.chart.getTooltipContent(e,t,i,s);this.cachedTooltipContent={series:e,datumIndex:t,content:a},n=a}}else this.cachedTooltipContent=void 0;return n}};KN.className="SeriesAreaManager";function HW(e,t){return e.type!==t}var YN=30,jW=class{constructor(e){this.seriesRoot=e,this.groups=new Map,this.series=new Map,this.expectedSeriesCount=1,this.mode="normal"}setSeriesCount(e){this.expectedSeriesCount=e}getGroupIndex(e){const{internalId:t,seriesGrouping:i}=e;return i?.groupIndex??t}getGroupType(e,t){return t?"top":e.type}requestGroup(e){const{internalId:t,contentGroup:i}=e,s=e.bringToFront(),n=this.getGroupType(e,s),o=this.getGroupIndex(e),a=this.series.get(t);if(a!=null)throw new Error(`AG Charts - series already has an allocated layer: ${JSON.stringify(a)}`);this.series.size===0&&(this.mode=this.expectedSeriesCount>=YN?"aggressive-grouping":"normal");let r=this.groups.get(n);r==null&&(r=new Map,this.groups.set(n,r));const l=this.lookupIdx(o);let c=r.get(l);return c==null&&(c={type:n,id:l,seriesIds:[],group:this.seriesRoot.appendChild(new Oe({name:`${e.contentGroup.name??n}-managed-layer`,zIndex:e.contentGroup.zIndex,renderToOffscreenCanvas:!1}))},r.set(l,c)),this.series.set(t,{layerState:c,seriesConfig:e,bringToFront:s}),c.seriesIds.push(t),c.group.appendChild(i),c.group}changeGroup(e){const{internalId:t,contentGroup:i}=e,s=e.bringToFront(),n=this.getGroupType(e,s),o=this.series.get(t),a=o?this.getGroupType(o.seriesConfig,o.bringToFront):void 0,r=this.getGroupIndex(e),l=this.lookupIdx(r),c=this.groups.get(n)?.get(l);if(!(a===n&&c?.seriesIds.includes(t)===!0))return this.series.has(t)&&this._releaseGroup({internalId:t,contentGroup:i,type:a}),this.requestGroup(e)}releaseGroup(e){const{internalId:t,contentGroup:i}=e,s=this.getGroupType(e,e.bringToFront());this._releaseGroup({internalId:t,contentGroup:i,type:s})}_releaseGroup(e){const{internalId:t,contentGroup:i,type:s}=e;if(!this.series.has(t))throw new Error(`AG Charts - series doesn't have an allocated layer: ${t}`);const n=this.series.get(t)?.layerState;n&&(n.seriesIds=n.seriesIds.filter(o=>o!==t),i.remove()),n?.seriesIds.length===0?(n.group.remove(),this.groups.get(n.type)?.delete(n.id),this.groups.get(s)?.delete(t)):n!=null&&n.seriesIds.length>0&&(n.group.zIndex=this.getLowestSeriesZIndex(n.seriesIds)),this.series.delete(t)}updateLayerCompositing(){for(const e of this.groups.values())for(const t of e.values()){const{group:i,seriesIds:s}=t;let n;s.length===0?n=!1:s.length>1?n=!0:n=this.series.get(s[0])?.seriesConfig.renderToOffscreenCanvas()===!0,i.renderToOffscreenCanvas=n,i.zIndex=this.getLowestSeriesZIndex(s)}}lookupIdx(e){return this.mode==="normal"?e:typeof e=="string"&&(e=Number(e.split("-").at(-1)),!Number.isFinite(e))?0:Math.floor(ge(0,e/this.expectedSeriesCount,1)*YN)}destroy(){for(const e of this.groups.values())for(const t of e.values())t.group.remove();this.groups.clear(),this.series.clear()}getLowestSeriesZIndex(e){let t;for(const i of e){const n=this.series.get(i)?.seriesConfig.contentGroup.zIndex??1;if(t==null||n==null){t=n;continue}t=Vw(t,n)<=0?t:n}return t??1}},ZN=class extends K{constructor(){super(...arguments),this.dragAction="drag"}};g([m],ZN.prototype,"dragAction",2);var WW=class{constructor(e,t,i,s,n,o){this.chart=e,this.eventsHub=t,this.dataService=i,this.updateService=s,this.zoomManager=n,this.animationManager=o,this.dirtyZoom=!1,this.dirtyDataSource=!1,this.lastAxisZooms=new Map,this.cleanup=new pt,this.cleanup.register(this.eventsHub.on("data:source-change",()=>this.onDataSourceChange()),this.eventsHub.on("data:load",()=>this.onDataLoad()),this.eventsHub.on("data:error",()=>this.onDataError()),this.updateService.addListener("update-complete",a=>this.onUpdateComplete(a)),this.eventsHub.on("zoom:change-complete",()=>this.onZoomChange()))}destroy(){this.cleanup.flush()}onDataLoad(){this.animationManager.skip(),this.updateService.update(1)}onDataError(){this.updateService.update(4)}onDataSourceChange(){this.dirtyDataSource=!0}onUpdateComplete(e){!e.apiUpdate&&!this.dirtyZoom&&!this.dirtyDataSource||e.wasShortcut||this.updateWindow(e)}onZoomChange(){this.dirtyZoom=!0}updateWindow(e){if(!this.dataService.isLazy())return;const t=this.getValidAxis();let i,s=!0;if(t){const n=this.zoomManager.getAxisZoom(t.id);i=this.getAxisWindow(t,n),s=this.shouldRefresh(e,t,n)}this.dirtyZoom=!1,this.dirtyDataSource=!1,s&&this.dataService.load({windowStart:i?.min,windowEnd:i?.max})}getValidAxis(){return this.chart.axes.find(e=>e.type==="time")}shouldRefresh(e,t,i){if(e.apiUpdate||this.dirtyDataSource)return!0;if(!this.dirtyZoom)return!1;const s=this.lastAxisZooms.get(t.id);return s&&i.min===s.min&&i.max===s.max?!1:(this.lastAxisZooms.set(t.id,i),!0)}getAxisWindow(e,t){const{domain:i}=e.scale;if(!t||i.length===0||Number.isNaN(Number(i[0])))return;const s=Number(i[1])-Number(i[0]),n=new Date(Number(i[0])+s*t.min),o=new Date(Number(i[0])+s*t.max);return{min:n,max:o}}},$W=/^((?!chrome|android).)*safari/i,UW=/Version\/(\d+(\.\d+)?)/,KW=/Chrome/,YW=/Chrome\/(\d+)/,ZW=/Edg/,XW=/OPR/;function qW(){const{userAgent:e}=Ve("navigator");if($W.test(e)){const t=UW.exec(e);if(t==null)return!1;const i=Number.parseFloat(t[1]),s=Math.floor(i)>16;return s||j.warnOnce(`Unsupported Safari version: ${i}; ${e}`),!s}else if(KW.test(e)&&!ZW.test(e)&&!XW.test(e)){const t=YW.exec(e);if(t==null)return!1;const i=Number.parseInt(t[1],10),s=i>126;return s||j.warnOnce(`Unsupported Chrome version: ${i}; ${e}`),!s}return!1}var QW=new Set(["map-shape-background","map-line-background"]),JW=class{constructor(e,t,i,s,n,o,a){this.chartLike=e,this.overlays=t,this.eventsHub=i,this.dataService=s,this.localeManager=n,this.animationManager=o,this.domManager=a,this.cleanup=new pt,this.overlayElem=this.domManager.addChild("canvas-overlay","overlay"),this.overlayElem.role="status",this.overlayElem.ariaAtomic="false",this.overlayElem.ariaLive="polite",this.overlayElem.classList.toggle(cD),this.cleanup.register(this.eventsHub.on("layout:complete",r=>this.onLayoutComplete(r)))}destroy(){this.cleanup.flush(),this.domManager.removeChild("canvas-overlay","overlay")}onLayoutComplete({series:{rect:e}}){const t=this.dataService.isLoading(),i=this.chartLike.series.some(c=>c.hasData),s=this.chartLike.series.some(c=>c.visible&&!QW.has(c.type));this.overlays.darkTheme?this.overlayElem.classList.add(RN):this.overlayElem.classList.remove(RN),this.overlayElem.style.left=`${e.x}px`,this.overlayElem.style.top=`${e.y}px`,this.overlayElem.style.width=`${e.width}px`,this.overlayElem.style.height=`${e.height}px`;const n=t,o=!t&&!i,a=i&&!s,r=this.overlays.unsupportedBrowser.enabled&&qW();n?this.showOverlay(this.overlays.loading,e):this.hideOverlay(this.overlays.loading),o?this.showOverlay(this.overlays.noData,e):this.hideOverlay(this.overlays.noData),a?this.showOverlay(this.overlays.noVisibleSeries,e):this.hideOverlay(this.overlays.noVisibleSeries),r?this.showOverlay(this.overlays.unsupportedBrowser,e):this.hideOverlay(this.overlays.unsupportedBrowser);const l=n||o||a||r;Fe(this.overlayElem,"aria-hidden",!l)}showOverlay(e,t){if(!e.enabled)return;const i=e.getElement(this.chartLike,this.animationManager,this.localeManager,t);this.overlayElem.appendChild(i)}hideOverlay(e){e.removeElement(()=>{this.overlayElem.innerText="\xA0"},this.animationManager)}},ho=Me.create(!0,"opts"),_t=class KB extends iT{constructor(t,i){var s;super(),this.id=Mi(this),this.seriesRoot=new ls({name:`${this.id}-series-root`,zIndex:7}),this.annotationRoot=new ls({name:`${this.id}-annotation-root`,zIndex:11}),this.titleGroup=new Oe({name:"titles",zIndex:15}),this.debug=Me.create(),this.extraDebugStats={},this.data=cu.empty(),this._firstAutoSize=!0,this._autoSizeNotify=new rg,this.chartCaptions=new Yy,this.padding=new gr(20),this.keyboard=new iD,this.touch=new ZN,this.mode="standalone",this.styleNonce=void 0,this.formatter=void 0,this.suppressFieldDotNotation=!1,this.loadGoogleFonts=!1,this.destroyed=!1,this.cleanup=new pt,this.chartAnimationPhase="initial",this.modulesManager=new fW,this.processors=[],this.queuedUserOptions=[],this.queuedChartOptions=[],this.firstApply=!0,this.syncStatus="init",this.fireEventWrapper=h=>super.fireEvent(h),this.apiUpdate=!1,this._pendingFactoryUpdatesCount=0,this._performUpdateSkipAnimations=!1,this._performUpdateNotify=new rg,this.performUpdateType=8,this.runningUpdateType=8,this.updateShortcutCount=0,this.seriesToUpdate=new Set,this.updateMutex=new zG,this.clearCallbackCacheOnUpdate=!1,this.updateRequestors={},this.performUpdateTrigger=SM(({count:h})=>{this.destroyed||this.updateMutex.acquire(this.tryPerformUpdate.bind(this,h)).catch(d=>j.errorOnce(d))}),this._performUpdateSplits={},this._previousSplit=0,this.axes=this.createChartAxes(),this.series=[],this._cachedData=void 0,this.onSeriesNodeClick=h=>{this.fireEvent(h)},this.onSeriesNodeDoubleClick=h=>{this.fireEvent(h)},this.onSeriesVisibilityChange=h=>{this.fireEvent(h)},this.seriesGroupingChanged=h=>{if(!(h instanceof dD))return;const{series:d,seriesGrouping:u}=h;if(d.contentGroup.isRoot())return;const p=this.seriesLayerManager.changeGroup({internalId:d.internalId,type:d.type,contentGroup:d.contentGroup,bringToFront:()=>d.bringToFront(),renderToOffscreenCanvas:()=>d.renderToOffscreenCanvas(),seriesGrouping:u});p!=null&&d.attachSeries(p,this.seriesRoot,this.annotationRoot)},this.chartOptions=t;const n=i?.scene,o=i?.container??t.processedOptions.container??void 0,a=i?.styleContainer??t.specialOverrides.styleContainer;n&&(this._firstAutoSize=!1,this._lastAutoSize=[n.width,n.height,n.pixelRatio]);const r=new Oe({name:"root"});r.visible=!1,r.append(this.seriesRoot),r.append(this.annotationRoot),r.append(this.titleGroup),this.titleGroup.append(this.title.node),this.titleGroup.append(this.subtitle.node),this.titleGroup.append(this.footnote.node),this.tooltip=new Wo,this.seriesLayerManager=new jW(this.seriesRoot),this.mode=t.userOptions.mode??this.mode,this.styleNonce=t.processedOptions.styleNonce;const l=this.ctx=new x4(this,{chartType:this.getChartType(),scene:n,root:r,container:o,styleContainer:a,domMode:t.optionMetadata.domMode,withDragInterpretation:t.optionMetadata.withDragInterpretation??!0,syncManager:new I4(this),fireEvent:h=>this.fireEvent(h),updateCallback:(h,d)=>this.update(h,d),updateMutex:this.updateMutex});t.optionMetadata.presetType==="sparkline"&&(l.highlightManager.unhighlightDelay=0,l.tooltipManager.removeDelay=0),this.cleanup.register(l.eventsHub.on("dom:resize",()=>this.parentResize(l.domManager.containerSize))),this.overlays=new uu,(s=this.overlays.loading).renderer??(s.renderer=()=>mW(this.overlays.loading.getText(l.localeManager),l.animationManager.defaultDuration)),this.processors=[new WW(this,l.eventsHub,l.dataService,l.updateService,l.zoomManager,l.animationManager),new JW(this,this.overlays,l.eventsHub,l.dataService,l.localeManager,l.animationManager,l.domManager)],this.highlight=new JM,this.container=o;const c=this.getModuleContext();this.background=Oi.createBackground?.(c)??new nu(c),this.foreground=Oi.createForeground?.(c),this.seriesArea=new Gg(c),l.domManager.setDataBoolean("animating",!1),l.domManager.setDataNumber("animationTimeMs",0),this.seriesAreaManager=new KN(this.initSeriesAreaDependencies()),this.cleanup.register(l.layoutManager.registerElement(0,h=>{h.layoutBox.shrink(this.padding.toJson()),this.chartCaptions.positionCaptions(h)}),l.eventsHub.on("layout:complete",h=>this.chartCaptions.positionAbsoluteCaptions(h)),l.eventsHub.on("data:load",h=>{this.data=new cu(h.data)}),this.title.registerInteraction(c,"beforebegin"),this.subtitle.registerInteraction(c,"beforebegin"),this.footnote.registerInteraction(c,"afterend"),()=>this.title.destroy(),()=>this.subtitle.destroy(),()=>this.footnote.destroy(),Sr.addWindowEvent("page-left",()=>this.destroy()),l.animationManager.addListener("animation-frame",()=>{this.update(7),l.domManager.setDataNumber("animationTimeMs",l.animationManager.getCumulativeAnimationTime())}),l.animationManager.addListener("animation-start",()=>l.domManager.setDataBoolean("animating",!0)),l.animationManager.addListener("animation-stop",()=>{l.domManager.setDataBoolean("animating",!1),l.domManager.setDataNumber("animationTimeMs",l.animationManager.getCumulativeAnimationTime())}),l.eventsHub.on("zoom:change-complete",()=>{for(const d of this.series)d.animationState?.transition("updateData");const h=this.chartAnimationPhase!=="initial";this.update(4,{forceNodeDataRefresh:!0,skipAnimations:h})})),this.parentResize(l.domManager.containerSize)}static getInstance(t){return KB.chartsInstances.get(t)}get canvasElement(){return this.ctx.scene.canvas.element}download(t,i){this.ctx.scene.download(t,i)}getCanvasDataURL(t){return this.ctx.scene.getDataURL(t)}toSVG(){return this.ctx.scene.toSVG()}get seriesAreaBoundingBox(){return this.seriesAreaManager.bbox}getOptions(){return this.queuedUserOptions.at(-1)??this.chartOptions.userOptions}getChartOptions(){return this.queuedChartOptions.at(-1)??this.chartOptions}isDataTransactionSupported(){return!0}overrideFocusVisible(t){this.seriesAreaManager.focusIndicator?.overrideFocusVisible(t)}fireEvent(t){as(this,this.fireEventWrapper,t)}initSeriesAreaDependencies(){const{ctx:t,tooltip:i,highlight:s,overlays:n,seriesRoot:o,mode:a}=this,r=this.getChartType();return{fireEvent:this.fireEvent.bind(this),getUpdateType:()=>this.performUpdateType,getTooltipContent:(d,u,p,f)=>this.getTooltipContent(d,u,p,f),chartType:r,ctx:t,tooltip:i,highlight:s,overlays:n,seriesRoot:o,mode:a}}getModuleContext(){return this.ctx}getTooltipContent(t,i,s,n){const a=n==="aria-label"||t.properties.tooltip.enabled!==!1?t.getTooltipContent(i,s):void 0,r=a==null?[]:[a];if(this.tooltip.mode!=="shared"||this.series.length===1)return r;const l=t.getCategoryValue(i);return l==null?r:this.series.flatMap(c=>{if(c===t)return r;if(!c.isEnabled()||c.properties.tooltip.enabled===!1)return[];const h=c.datumIndexForCategoryValue(l),d=h==null?void 0:c.getTooltipContent(h,void 0);return d==null?[]:[d]})}getCaptionText(){return[this.title,this.subtitle,this.footnote].filter(t=>t.enabled&&t.text).map(t=>t.text).join(". ")}getAriaLabel(){return this.ctx.localeManager.t("ariaAnnounceChart",{seriesCount:this.series.length})}refreshSeriesUserVisibility(t,i){for(let s=0;s<this.series.length;s++){const n=this.series[s],o=t.processedOptions.series?.[s];(i.identifiers.has(n.id)||i.indices.has(s))&&o!==void 0&&"visible"in o&&(o.visible=n.visible)}}resetAnimations(){this.chartAnimationPhase="initial";for(const t of this.series)t.resetAnimation(this.chartAnimationPhase);for(const t of this.axes)t.resetAnimation(this.chartAnimationPhase);this.animationRect=void 0,this.ctx.animationManager.reset()}skipAnimations(){this.ctx.animationManager.skipCurrentBatch(),this._performUpdateSkipAnimations=!0}detachAndClear(){this.container=void 0,this.ctx.scene.clearCanvas()}destroy(t){if(this.destroyed)return;const i=t?.keepTransferableResources;let s;this.performUpdateType=8,this.cleanup.flush();for(const n of this.processors)n.destroy();return this.overlays.destroy(),this.modulesManager.destroy(),this.background.destroy(),this.foreground?.destroy(),this.seriesArea.destroy(),i?(this.ctx.scene.strip(),s={container:this.container,scene:this.ctx.scene}):(this.ctx.scene.destroy(),this.container=void 0),this.destroySeries(this.series),this.seriesLayerManager.destroy(),this.axes.destroy(),this.animationRect=void 0,this.ctx.destroy(),this.destroyed=!0,Object.freeze(this),s}requestFactoryUpdate(t){this.destroyed||(this._pendingFactoryUpdatesCount++,this.updateMutex.acquire(async()=>{if(!this.destroyed)try{await t(this)}finally{this.destroyed||this._pendingFactoryUpdatesCount--}}).catch(i=>j.errorOnce(i)))}clearCallbackCache(){this.ctx.callbackCache.invalidateCache();for(const t of this.series)t.resetDatumCallbackCache()}update(t=0,i){if(this.destroyed)return;const{forceNodeDataRefresh:s=!1,skipAnimations:n,seriesToUpdate:o=this.series,newAnimationBatch:a,apiUpdate:r=!1,clearCallbackCache:l=!1}=i??{};if(this.apiUpdate=r,this.ctx.widgets.seriesWidget.setDragTouchEnabled(this.touch.dragAction!=="none"),s)for(const c of this.series)c.markNodeDataDirty();for(const c of o)this.seriesToUpdate.add(c);if(n&&(this.ctx.animationManager.skipCurrentBatch(),this._performUpdateSkipAnimations=!0),a&&this.ctx.animationManager.isActive()&&(this._performUpdateSkipAnimations=!0),(t===0||l)&&(this.clearCallbackCacheOnUpdate=!0),this.debug.check()){let c=new Error("Stack trace for update tracking").stack??"<unknown>";c=c.replaceAll(/\([^)]*/g,""),this.updateRequestors[c]=t}t<this.performUpdateType&&(this.performUpdateType=t,this.ctx.domManager.setDataBoolean("updatePending",!0),this.performUpdateTrigger.schedule(i?.backOffMs))}updateSplits(t){const i=this._performUpdateSplits;i[t]??(i[t]=0),i[t]+=performance.now()-this._previousSplit,this._previousSplit=performance.now()}async tryPerformUpdate(t){try{await this.performUpdate(t)}catch(i){j.error("update error",i,i.stack)}}async performUpdate(t){const{performUpdateType:i,extraDebugStats:s,_performUpdateSplits:n,ctx:o}=this,a=[...this.seriesToUpdate];switch(this.clearCallbackCacheOnUpdate&&(this.clearCallbackCacheOnUpdate=!1,this.clearCallbackCache()),this.performUpdateType=8,this.seriesToUpdate.clear(),this.runningUpdateType=i,this.updateShortcutCount===0&&i<7&&(o.animationManager.startBatch(this._performUpdateSkipAnimations),o.animationManager.onBatchStop(()=>this.chartAnimationPhase="ready")),this.ctx.scene.updateDebugFlags(),this.debug("Chart.performUpdate() - start",kc[i]),this._previousSplit=performance.now(),n.start??(n.start=this._previousSplit),i){case 0:if(this.checkUpdateShortcut(0))break;this.ctx.updateService.dispatchPreDomUpdate(),this.updateDOM();case 1:if(this.checkUpdateShortcut(1))break;this.updateData(),this.updateSplits("\u2B07\uFE0F");case 2:if(this.checkUpdateShortcut(2))break;await this.processData(),this.seriesAreaManager.dataChanged(),this.updateSplits("\u{1F4CA}");case 3:if(this.checkUpdateShortcut(3))break;await this.processDomains(),this.updateSplits("\u26F0\uFE0F");case 4:if(await this.checkFirstAutoSize(),this.checkUpdateShortcut(4))break;await this.processLayout(),this.updateSplits("\u2316");case 5:{if(this.checkUpdateShortcut(5))break;this.seriesRoot.renderToOffscreenCanvas=this.highlight.drawingMode==="cutout",await this.updateSeries(a),this.updateAriaLabels(),this.seriesLayerManager.updateLayerCompositing(),this.updateSplits("\u{1F914}")}case 6:if(this.checkUpdateShortcut(6))break;o.updateService.dispatchPreSceneRender(),this.updateSplits("\u2196");case 7:if(this.checkUpdateShortcut(7))break;o.animationManager.endBatch(),s.updateShortcutCount=this.updateShortcutCount,o.scene.render({debugSplitTimes:n,extraDebugStats:s,seriesRect:this.seriesRect}),this.extraDebugStats={};for(const l of Object.keys(n))delete n[l];this.ctx.domManager.incrementDataCounter("sceneRenders"),this.ctx.domManager.postRenderUpdate();case 8:this.updateShortcutCount=0,this.updateRequestors={},this._performUpdateSkipAnimations=!1,o.animationManager.endBatch()}this.destroyed||(o.updateService.dispatchUpdateComplete(this.apiUpdate,this.updateShortcutCount>0),this.apiUpdate=!1,this.ctx.domManager.setDataBoolean("updatePending",!1),this.runningUpdateType=8,this.syncStatus="ready"),this._performUpdateNotify.notify();const r=performance.now();this.debug("Chart.performUpdate() - end",{chart:this,durationMs:ed(r-n.start),count:t,performUpdateType:kc[i]})}updateThemeClassName(){const t="ag-charts-theme-",i=[`${t}default`,`${t}default-dark`];let s=i[0],n=!1,{theme:o}=this.chartOptions.processedOptions;for(;typeof o!="string"&&o!=null;)o=o.baseTheme;typeof o=="string"&&(s=o.replace("ag-",t),n=o.includes("-dark")),i.includes(s)||(s=n?i[1]:i[0]),this.ctx.domManager.setThemeClass(s)}updateDOM(){this.updateThemeClassName();const{enabled:t,tabIndex:i}=this.keyboard;this.ctx.domManager.setTabGuardIndex(t?i??0:-1),this.ctx.domManager.setThemeParameters(this.chartOptions.themeParameters)}updateAriaLabels(){this.ctx.domManager.updateCanvasLabel(this.getAriaLabel())}checkUpdateShortcut(t){return this.destroyed?!0:this.updateShortcutCount>3?(j.warn("exceeded the maximum number of simultaneous updates (4), discarding changes and rendering",this.updateRequestors),!1):this.performUpdateType<=t?(this.updateShortcutCount++,!0):!1}async checkFirstAutoSize(){this.width!=null&&this.height!=null||this._lastAutoSize||await this._autoSizeNotify.waitForCompletion(500)||this.debug("Chart.checkFirstAutoSize() - timeout for first size update.")}createChartAxes(){return new Ky}onAxisChange(t,i){i==null&&t.length===0||this.ctx.axisManager.updateAxes(i??[],t)}onSeriesChange(t,i){const s=i?.filter(n=>!t.includes(n))??[];this.destroySeries(s),this.seriesLayerManager?.setSeriesCount(t.length);for(const n of t){if(i?.includes(n))continue;const o=this.seriesLayerManager.requestGroup(n);n.attachSeries(o,this.seriesRoot,this.annotationRoot),n.chart={},Object.defineProperty(n.chart,"mode",{get:()=>this.mode}),Object.defineProperty(n.chart,"isMiniChart",{get:()=>!1}),Object.defineProperty(n.chart,"flashOnUpdateEnabled",{get:()=>!!this.modulesManager.getModule("flashOnUpdate")?.enabled}),Object.defineProperty(n.chart,"seriesRect",{get:()=>this.seriesRect}),n.resetAnimation(this.chartAnimationPhase),this.addSeriesListeners(n)}this.seriesAreaManager?.seriesChanged(t)}destroySeries(t){if(t)for(const i of t)i.removeEventListener("seriesNodeClick",this.onSeriesNodeClick),i.removeEventListener("seriesNodeDoubleClick",this.onSeriesNodeDoubleClick),i.removeEventListener("groupingChanged",this.seriesGroupingChanged),i.destroy(),this.seriesLayerManager.releaseGroup(i),i.detachSeries(void 0,this.seriesRoot,this.annotationRoot),i.chart=void 0}addSeriesListeners(t){this.hasEventListener("seriesNodeClick")&&t.addEventListener("seriesNodeClick",this.onSeriesNodeClick),this.hasEventListener("seriesNodeDoubleClick")&&t.addEventListener("seriesNodeDoubleClick",this.onSeriesNodeDoubleClick),this.hasEventListener("seriesVisibilityChange")&&t.addEventListener("seriesVisibilityChange",this.onSeriesVisibilityChange),t.addEventListener("groupingChanged",this.seriesGroupingChanged)}assignSeriesToAxes(){for(const i of this.axes){let s=function(n){return n.axes[i.direction]===i};var t=s;i.boundSeries=this.series.filter(s)}}assignAxesToSeries(){for(const t of this.series)for(const i of t.directions){const s=t.getKeyAxis(i)??i,n=this.axes.findById(s);if(!n){j.warnOnce(`no matching axis for direction [${i}] and id [${s}]; check series and axes configuration.`);return}t.axes[i]=n}}parentResize(t){if(t==null||this.width!=null&&this.height!=null)return;let{width:i,height:s}=t;const{pixelRatio:n}=t;if(i=Math.floor(i),s=Math.floor(s),i===0&&s===0)return;const[o=0,a=0,r=1]=this._lastAutoSize??[];o===i&&a===s&&r===n||(this._lastAutoSize=[i,s,n],this.resize("SizeMonitor",{}))}resize(t,i){const{scene:s,animationManager:n}=this.ctx,{inWidth:o,inHeight:a,inMinWidth:r,inMinHeight:l,inOverrideDevicePixelRatio:c}=i;this.ctx.domManager.setSizeOptions(r??this.minWidth,l??this.minHeight,o??this.width,a??this.height);const h=o??this.width??this._lastAutoSize?.[0],d=a??this.height??this._lastAutoSize?.[1],u=c??this.overrideDevicePixelRatio??this._lastAutoSize?.[2];if(this.debug(`Chart.resize() from ${t}`,{width:h,height:d,pixelRatio:u,stack:new Error("Stack trace for resize tracking").stack}),!(h==null||d==null||!$e(h)||!$e(d))&&s.resize(h,d,u)){n.reset();let p=!0;(this.width==null||this.height==null)&&this._firstAutoSize&&(p=!1,this._firstAutoSize=!1),this.update(4,{forceNodeDataRefresh:!0,skipAnimations:p}),this._autoSizeNotify.notify()}}updateData(){this.ctx.eventsHub.emit("data:update",this.data)}async processData(){this.series.some(s=>s.canHaveAxes)&&(this.assignAxesToSeries(),this.assignSeriesToAxes());const t=new pN(this.mode,this.suppressFieldDotNotation,this.ctx.eventsHub),i=[];for(const s of this.series)i.push(s.processData(t)??Promise.resolve());for(const s of this.modulesManager.modules())s?.processData&&i.push(s.processData(t)??Promise.resolve());this._cachedData=t.execute(this._cachedData),this.updateSplits("\u{1F3ED}"),await Promise.all(i),this.updateLegends()}async processDomains(){for(const t of this.axes)t.processData();for(const t of this.series)t.updatedDomains()}updateLegends(t){for(const i of me.listModulesByType("plugin"))switch(i.name){case"legend":this.setCategoryLegendData(t);break;case"gradientLegend":const s=this.modulesManager.getModule("gradientLegend");s.data=this.series.filter(n=>n.properties.showInLegend).flatMap(n=>n.getLegendData("gradient"));break}}setCategoryLegendData(t){const{legendManager:i,stateManager:s}=this.ctx;if(t)for(const o of this.series){const a=t.find(r=>r.seriesId===o.id);o.onLegendInitialState("category",a)}const n=this.series.flatMap(o=>{const a=o.getLegendData("category");return i.updateData(o.id,a),a});if(t){s.setStateAndRestore(i,t);return}if(this.mode!=="integrated"){const o={},a=new Map(this.series.map(r=>[r.id,r]));for(const{seriesId:r,symbol:{marker:l},label:c}of n.filter(h=>!h.hideInLegend)){if(l.fill==null)continue;const h=a.get(r);if(!h?.hasData)continue;const d=h.type,u=o[d]??(o[d]=new Map);u.has(c.text)?u.get(c.text)!==l.fill&&j.warnOnce(`legend item '${Pe(c.text)}' has multiple fill colors, this may cause unexpected behaviour.`):u.set(c.text,l.fill)}}i.update()}async processLayout(){const t=this.animationRect,{width:i,height:s}=this.ctx.scene,n=this.ctx.layoutManager.createContext(i,s);await this.performLayout(n),t&&!this.animationRect?.equals(t)&&this.ctx.animationManager.skipCurrentBatch(),this.debug("Chart.performUpdate() - seriesRect",this.seriesRect)}async updateSeries(t){const{seriesRect:i}=this;function s(n){return n.update({seriesRect:i})}await Promise.all(t.map(s).filter(n=>n!=null)),this.ctx.seriesLabelLayoutManager.updateLabels(this.series.filter(n=>n.visible&&n.usesPlacedLabels),this.padding,this.seriesRect)}async waitForUpdate(t,i){const s=Ve("agChartsDebugTimeout");s==null?(t??(t=1e4),i??(i=!1)):(t=s,i??(i=!0));const n=performance.now();for(;(this._pendingFactoryUpdatesCount>0||this.performUpdateType!==8||this.runningUpdateType!==8||this.ctx.scene.waitingForUpdate()||this.data.hasPendingTransactions())&&!this.destroyed;){if(this._pendingFactoryUpdatesCount>0&&await this.updateMutex.waitForClearAcquireQueue(),(this.performUpdateType!==8||this.runningUpdateType!==8||this.data.hasPendingTransactions())&&await this._performUpdateNotify.waitForCompletion(),performance.now()-n>t){const o=`Chart.waitForUpdate() timeout of ${t} reached - first chart update taking too long.`;if(i)throw new Error(o);j.warnOnce(o)}r0()&&await iy(),this.ctx.scene.waitingForUpdate()&&await iy(50)}}filterMiniChartSeries(t){return t?.filter(i=>i.showInMiniChart!==!1)}applyOptions(t){t.seriesWithUserVisibility&&this.refreshSeriesUserVisibility(this.chartOptions,t.seriesWithUserVisibility);const i=4,s=this.firstApply?t.processedOptions:t.diffOptions(this.chartOptions);if(s==null||Object.keys(s).length===0){ho("Chart.applyOptions() - no delta, forcing re-layout",s),this.update(i,{apiUpdate:!0,newAnimationBatch:!0});return}const n=this.firstApply?{}:this.chartOptions.processedOptions,o=t.processedOptions;ho("Chart.applyOptions() - applying delta",s);const a=this.applyModules(),r=["type","data","series","listeners","preset","theme","legend.listeners","navigator.miniChart.series","navigator.miniChart.label","locale.localeText","axes","topology","nodes","initialState","styleContainer","formatter"];"listeners"in s&&this.registerListeners(this,s.listeners),wd(this,s,{skip:r});let l=!1,c="no-op";s.series!=null&&(c=this.applySeries(this,s.series,n?.series),l=!0),c==="replaced"&&this.resetAnimations(),this.applyAxes(this,o,n,c,[])&&(l=!0);const{userDeltaKeys:h}=t,d=h===void 0||h.has("data");if(s.data&&d){const v=s.data,S=t.userOptions.data,D=Array.isArray(v)&&v!==S?v.slice():v;this.data=new cu(D)}if("legend"in s&&s.legend&&"listeners"in s.legend&&this.modulesManager.isEnabled("legend")){const v=s.legend.listeners;v?Object.assign(this.legend.listeners,v):this.legend.listeners.clear()}if(s.locale?.localeText){const v=this.modulesManager.getModule("locale");v.localeText=s.locale?.localeText}this.chartOptions=t;const u=this.modulesManager.getModule("navigator"),p=this.modulesManager.getModule("zoom");!u?.enabled&&!p?.enabled&&this.ctx.zoomManager.updateZoom({source:"chart-update",sourceDetail:"internal-applyOptions"},{x:{min:0,max:1}});const f=u?.miniChart,y=o.navigator?.miniChart?.series??o.series;f?.enabled===!0&&y!=null?this.applyMiniChartOptions(f,y,o,n):f?.enabled===!1&&(f.series=[],f.axes=[]),this.ctx.annotationManager.setAnnotationStyles(t.annotationThemes),l||(l=this.shouldForceNodeDataRefresh(s,c));const x=l||a?0:i;if(this.maybeResetAnimations(c),this.shouldClearLegendData(o,n,c)&&this.ctx.legendManager.clearData(),this.applyInitialState(o),this.ctx.formatManager.setFormatter(o.formatter),ho("Chart.applyOptions() - update type",kc[x],{seriesStatus:c,forceNodeDataRefresh:l}),t.optionsProcessingTime!==void 0){this._performUpdateSplits["\u2699\uFE0F"]=t.optionsProcessingTime;const v=performance.now()-t.optionsProcessingTime;this._performUpdateSplits.start=v}this.update(x,{apiUpdate:!0,forceNodeDataRefresh:l,newAnimationBatch:!0,clearCallbackCache:!0}),this.firstApply=!1}applyInitialState(t){const{annotationManager:i,chartTypeOriginator:s,historyManager:n,stateManager:o,zoomManager:a}=this.ctx,{initialState:r}=t;if("annotations"in t&&t.annotations?.enabled&&r?.annotations!=null){const l=r.annotations.map(c=>{const h=i.getAnnotationTypeStyles(c.type);return oe(c,h)});o.setState(i,l)}r?.chartType!=null&&o.setState(s,r.chartType),(t.navigator?.enabled||t.zoom?.enabled)&&r?.zoom!=null&&o.setState(a,r.zoom),r?.legend!=null&&this.updateLegends(r.legend),r!=null&&n.clear()}maybeResetAnimations(t){if(this.mode==="standalone")switch(t){case"series-grouping-change":case"replaced":this.resetAnimations();break;default:}}shouldForceNodeDataRefresh(t,i){const s=!!t.data||i==="data-change"||i==="replaced",n=["legend","gradientLegend"].some(a=>t[a]!=null),o=t.title!=null&&t.subtitle!=null||t.formatter!=null;return s||n||o}shouldClearLegendData(t,i,s){const n=s==="replaced"||s==="series-grouping-change"||s==="updated"&&(t.series?.length!==i.series?.length||!t.series?.every((a,r)=>a.type===i.series?.[r].type)),o=i.legend!=null&&i.legend.enabled!==!1&&(t.legend==null||t.legend.enabled===!1);return n||o}applyMiniChartOptions(t,i,s,n){const o=n?.navigator?.miniChart?.series??n?.series,a=this.applySeries(t,this.filterMiniChartSeries(i),this.filterMiniChartSeries(o));this.applyAxes(t,s,n,a,["tick","thickness","title","crosshair","gridLine","label"]);const r=t.series;for(const h of r)h.properties.id=void 0;const l=t.axes,c=l.find(h=>h.direction==="x");for(const h of l)h.nice=!1,h.gridLine.enabled=!1,h.label.enabled=h===c,h.tick.enabled=!1,h.interactionEnabled=!1;if(c!=null){const h=s.navigator?.miniChart,d=h?.label,u=h?.label?.interval;if(c.line.enabled=!1,c.label.set(Q(d,["interval","autoRotate","autoRotateAngle","itemStyler","minSpacing","rotation"])),c.type==="grouped-category"){c.label.enabled=!1,c.label.rotation=0;const{depthOptions:p}=c;if(p.length===0)p.set([{label:{enabled:!0}}]);else for(let f=1;f<p.length;f++)p[f].label.enabled=!1}else(c.type==="time"||c.type==="unit-time"||c.type==="ordinal-time")&&(c.parentLevel.enabled=!1);c.interval.step=u?.step,c.interval.values=u?.values,c.interval.minSpacing=u?.minSpacing,c.interval.maxSpacing=u?.maxSpacing}}applyModules(){const{type:t}=this.constructor;let i=!1;for(const s of me.listModulesByType("plugin")){const n=!s.chartType||s.chartType===t;if(n!==this.modulesManager.isEnabled(s.name)){if(n){const o=s.create(this.getModuleContext());this.modulesManager.addModule(s.name,o),this[s.name]=o}else this.modulesManager.removeModule(s.name),delete this[s.name];i=!0}}return i}initSeriesDeclarationOrder(t){for(let i=0;i<t.length;i++)t[i].setSeriesIndex(i)}applySeries(t,i,s){if(!i)return"no-change";const n=uW(t.series,i,s);if(n.status==="no-overlap"){ho(`Chart.applySeries() - creating new series instances, status: ${n.status}`,n);const h=i.map(d=>this.createSeries(d));return this.initSeriesDeclarationOrder(h),t.series=h,"replaced"}ho("Chart.applySeries() - matchResult",n);const o=[];let a=!1,r=!1,l=!1;const c=n.changes.toSorted((h,d)=>h.targetIdx-d.targetIdx);for(const h of c)switch(r||(r=h.status==="series-grouping"),a||(a=h.diff?.data!=null),l||(l=h.status!=="no-op"),h.status){case"add":{const d=this.createSeries(h.opts);o.push(d),ho("Chart.applySeries() - created new series",d);break}case"remove":ho(`Chart.applySeries() - removing series at previous idx ${h.idx}`,h.series);break;case"no-op":o.push(h.series),ho(`Chart.applySeries() - no change to series at previous idx ${h.idx}`,h.series);break;case"series-grouping":case"update":default:{const{series:d,diff:u,idx:p}=h;ho(`Chart.applySeries() - applying series diff previous idx ${p}`,u,d),this.applySeriesValues(d,u),d.markNodeDataDirty(),o.push(d)}}return this.initSeriesDeclarationOrder(o),ho("Chart.applySeries() - final series instances",o),t.series=o,r?"series-grouping-change":a?"data-change":l?"updated":"no-op"}applyAxes(t,i,s,n,o=[]){if(!("axes"in i)||!i.axes)return!1;o=["type",...o];const a=i.axes;if(!(n==="replaced")&&t.axes.matches(a)&&gW(s)){for(const c of t.axes){const h=s.axes?.[c.id]??{},d=Ln(h,a[c.id]);ho(`Chart.applyAxes() - applying axis diff idx ${c.id}`,d),wd(c,d,{skip:o})}return!0}return ho(`Chart.applyAxes() - creating new axes instances; seriesStatus: ${n}`),t.axes=this.createAxes(a,o),!0}createSeries(t){const s=me.getSeriesModule(t.type).create(this.getModuleContext());return this.applySeriesOptionModules(s,t),this.applySeriesValues(s,t),s}applySeriesOptionModules(t,i){const s=t.createModuleContext(),n=t.getModuleMap();for(const o of me.listModulesByType("series:plugin"))o.name in i&&(o.seriesTypes?.includes(t.type)??!0)&&n.addModule(o.name,o.create(s))}applySeriesValues(t,i){const s=t.getModuleMap(),{type:n,data:o,listeners:a,seriesGrouping:r,showInMiniChart:l,...c}=i;for(const h of me.listModulesByType("series:plugin"))if(h.name in c){const d=s.getModule(h.name);if(d){const u=c[h.name];d.properties.set(u),delete c[h.name]}}c.visible!=null&&(t.visible=c.visible),t.properties.set(c),"data"in i&&t.setOptionsData(o==null?void 0:cu.wrap(o)),"listeners"in i&&(this.registerListeners(t,a),this.series.includes(t)&&this.addSeriesListeners(t)),"seriesGrouping"in i&&(r==null?t.seriesGrouping=void 0:t.seriesGrouping={...t.seriesGrouping,...r})}createAxes(t,i){const s=this.createChartAxes(),n=this.getModuleContext();for(const[o,a]of ht(t)){const r=me.getAxisModule(a.type).create(n);r.id=o,this.applyAxisModules(r,a),wd(r,a,{skip:i}),s.push(r)}return hW(s),s}applyAxisModules(t,i){const s=t.createModuleContext(),n=t.getModuleMap();for(const o of me.listModulesByType("axis:plugin")){const a=i[o.name]!=null;a!==n.isEnabled(o.name)&&(a?(n.addModule(o.name,o.create(s)),t[o.name]=n.getModule(o.name)):(n.removeModule(o.name),delete t[o.name]))}}registerListeners(t,i){if(t.clearEventListeners(),i&&typeof i=="object")for(const[s,n]of ht(i))n!=null&&t.addEventListener(s,n)}async applyTransaction(t){await this.updateMutex.acquire(()=>{this.data.addTransaction(t),this.update(1,{apiUpdate:!0,skipAnimations:!0})}),await this.waitForUpdate()}};_t.className="Chart",_t.chartsInstances=new WeakMap,g([He({newValue(e){this.destroyed||(this.ctx.domManager.setContainer(e),_t.chartsInstances.set(e,this))},oldValue(e){_t.chartsInstances.delete(e)}})],_t.prototype,"container",2),g([He({newValue(e){this.resize("width option",{inWidth:e})}})],_t.prototype,"width",2),g([He({newValue(e){this.resize("height option",{inHeight:e})}})],_t.prototype,"height",2),g([He({newValue(e){this.resize("minWidth option",{inMinWidth:e})}})],_t.prototype,"minWidth",2),g([He({newValue(e){this.resize("minHeight option",{inMinHeight:e})}})],_t.prototype,"minHeight",2),g([He({newValue(e){this.resize("overrideDevicePixelRatio option",{inOverrideDevicePixelRatio:e})}})],_t.prototype,"overrideDevicePixelRatio",2),g([m],_t.prototype,"padding",2),g([m],_t.prototype,"keyboard",2),g([m],_t.prototype,"touch",2),g([m],_t.prototype,"mode",2),g([m],_t.prototype,"styleNonce",2),g([Bt("chartCaptions.title")],_t.prototype,"title",2),g([Bt("chartCaptions.subtitle")],_t.prototype,"subtitle",2),g([Bt("chartCaptions.footnote")],_t.prototype,"footnote",2),g([m],_t.prototype,"formatter",2),g([m],_t.prototype,"suppressFieldDotNotation",2),g([m],_t.prototype,"loadGoogleFonts",2),g([He({changeValue(e,t){this.onAxisChange(e,t)}})],_t.prototype,"axes",2),g([He({changeValue(e,t){this.onSeriesChange(e,t)}})],_t.prototype,"series",2);var mx=_t;function XN(e){return e?.up||e?.down||e?.neutral?"user-full":e?.fills||e?.strokes?"user-indexed":"inbuilt"}var hi={BLUE:"#5090dc",ORANGE:"#ffa03a",GREEN:"#459d55",CYAN:"#34bfe1",YELLOW:"#e1cc00",VIOLET:"#9669cb",GRAY:"#b5b5b5",MAGENTA:"#bd5aa7",BROWN:"#8a6224",RED:"#ef5452"},kr={BLUE:"#2b5c95",ORANGE:"#cc6f10",GREEN:"#1e652e",CYAN:"#18859e",YELLOW:"#a69400",VIOLET:"#603c88",GRAY:"#575757",MAGENTA:"#7d2f6d",BROWN:"#4f3508",RED:"#a82529"},qN={x:{position:"bottom",type:{$if:[{$eq:[{$path:["/series/0/direction",void 0]},"horizontal"]},"number","category"]}},y:{position:"left",type:{$if:[{$eq:[{$path:["/series/0/direction",void 0]},"horizontal"]},"category","number"]}}},e$={$if:[{$or:[{$isGradient:{$palette:"fill"}},{$isPattern:{$palette:"fill"}},{$isImage:{$value:"$1"}}]},{$palette:"fillFallback"},{$palette:"fill"}]},t$={$if:[{$or:[{$isGradient:{$palette:"fill"}},{$isPattern:{$palette:"fill"}},{$isImage:{$value:"$1"}}]},{$palette:"fillsFallback"},{$palette:"fills"}]},gD={$if:[{$isGradient:{$palette:"fill"}},{$palette:"fillFallback"},{$if:[{$isPattern:{$palette:"fill"}},{$path:["/stroke",{$palette:"fillFallback"},{$palette:"fill"}]},{$palette:"fill"}]}]},i$={$if:[{$or:[{$isGradient:{$palette:"fill"}},{$isPattern:{$palette:"fill"}},{$isImage:{$value:"$1"}}]},[{$palette:"fillFallback"},{$palette:"fillFallback"}],{$palette:"range2"}]},s$={type:"gradient",gradient:"linear",bounds:"item",colorStops:[{color:"black"}],rotation:0,reverse:!1,colorSpace:"rgb"},Fl={type:"gradient",gradient:"linear",bounds:"item",colorStops:{$shallow:{$map:[{color:{$value:"$1"}},{$palette:"gradient"}]}},rotation:0,reverse:!1,colorSpace:"rgb"},n$={...Fl,colorStops:{$shallow:[{color:{$mix:[{$path:["/1",{$palette:"fill"},{$palette:"hierarchyColors"}]},"black",.15]}},{color:{$mix:[{$path:["/1",{$palette:"fill"},{$palette:"hierarchyColors"}]},"white",.15]}}]}},o$={...Fl,colorStops:{$map:[{color:{$value:"$1"}},{$path:["/0",void 0,{$palette:"gradients"}]}]}},a$=e=>({...Fl,colorStops:{$shallow:{$if:[{$or:[{$isGradient:{$palette:`${e}.fill`}},{$isPattern:{$palette:`${e}.fill`}},{$isImage:{$palette:`${e}.fill`}}]},{$path:["/colorStops",void 0,{$palette:`${e}.fill`}]},[{color:{$mix:[{$palette:`${e}.fill`},"black",.15]}},{color:{$mix:[{$palette:`${e}.fill`},"white",.15]}}]]}}}),fD={type:"gradient",gradient:"radial",bounds:"item",colorStops:{$shallow:{$map:[{color:{$value:"$1"}},{$palette:"gradient"}]}},rotation:0,reverse:!1,colorSpace:"rgb"},$g={...fD,reverse:!0},r$={...fD,bounds:"series"},QN={...fD,bounds:"series",reverse:!0},l$={type:"gradient",gradient:"conic",bounds:"series",colorStops:{$map:[{color:{$value:"$1"}},{$palette:"gradient"}]},rotation:0,reverse:!1,colorSpace:"rgb"},Pn={type:"pattern",pattern:"forward-slanted-lines",width:{$isUserOption:["./height",{$path:"./height"},10]},height:{$isUserOption:["./width",{$path:"./width"},10]},padding:2,fill:{$if:[{$or:[{$isGradient:{$palette:"fill"}},{$isImage:{$palette:"fill"}}]},{$palette:"fillFallback"},{$if:[{$isPattern:{$palette:"fill"}},{$path:["/fill",{$palette:"fillFallback"},{$palette:"fill"}]},{$palette:"fill"}]}]},fillOpacity:1,stroke:gD,strokeOpacity:1,strokeWidth:{$switch:[{$path:"./pattern"},0,[["backward-slanted-lines","forward-slanted-lines","horizontal-lines","vertical-lines"],4]]},backgroundFill:"none",backgroundFillOpacity:1,rotation:0,scale:1},c$={...Pn,stroke:{$if:[{$isGradient:{$palette:"fill"}},{$path:["/0",void 0,{$palette:"fillsFallback"}]},{$if:[{$isPattern:{$palette:"fill"}},{$path:["/stroke",{$path:["/0",void 0,{$palette:"fillsFallback"}]},{$path:["/0",void 0,{$palette:"fills"}]}]},{$path:["/0",void 0,{$palette:"fills"}]}]}]},fill:{$if:[{$or:[{$isGradient:{$palette:"fill"}},{$isImage:{$palette:"fill"}}]},{$path:["/0",void 0,{$palette:"fillsFallback"}]},{$if:[{$isPattern:{$palette:"fill"}},{$path:["/fill",{$path:["/0",void 0,{$palette:"fillsFallback"}]},{$path:["/0",void 0,{$palette:"fills"}]}]},{$path:["/0",void 0,{$palette:"fills"}]}]}]}},h$={type:"pattern",pattern:"forward-slanted-lines",width:8,height:8,padding:1,fill:"black",fillOpacity:1,backgroundFill:"white",backgroundFillOpacity:1,stroke:"black",strokeOpacity:1,strokeWidth:1,rotation:0,scale:1},d$={...Pn,fill:{$path:["/1",{$palette:"fill"},{$palette:"hierarchyColors"}]},stroke:{$path:["/1",{$palette:"fill"},{$palette:"hierarchyColors"}]}},u$=e=>({...Pn,stroke:{$if:[{$isGradient:{$palette:`${e}.fill`}},{$palette:"fillFallback"},{$if:[{$isPattern:{$palette:`${e}.fill`}},{$path:["/stroke",{$palette:"fillFallback"},{$palette:`${e}.fill`}]},{$palette:`${e}.fill`}]}]}}),Ar={type:"image",backgroundFill:{$palette:"fillFallback"},backgroundFillOpacity:1,repeat:"no-repeat",fit:"contain",rotation:0},p$={type:"image",backgroundFill:"black",backgroundFillOpacity:1,rotation:0,repeat:"no-repeat",fit:"contain",width:8,height:8};function uo(e){return Dc(e,t=>{const i=Be.fromString(t);return[Be.darken(i,.15).toString(),t,Be.lighten(i,.15).toString()]})}var ka={padding:8,cornerRadius:4,fill:{$if:[{$and:[{$eq:[{$path:"./fill/type"},"image"]},{$isUserOption:["./fill/backgroundFill",!1,!0]}]},{backgroundFill:"transparent"},void 0]},border:{enabled:{$isUserOption:["../border",!0,!1]},strokeWidth:1,stroke:{$foregroundOpacity:.08}}};function Ug(){return{enabled:!0,unhighlightedItem:{opacity:.6},unhighlightedSeries:{opacity:.2}}}function mD(){return{enabled:!0,unhighlightedSeries:{opacity:.2}}}function JN(){return{enabled:!0,unhighlightedItem:{opacity:.2},unhighlightedSeries:{opacity:.2}}}function g$(){return{enabled:!0,unhighlightedItem:{opacity:.2}}}var e1={border:{enabled:!1,stroke:{$foregroundBackgroundMix:.25},strokeOpacity:1,strokeWidth:1},cornerRadius:4,fillOpacity:1,padding:{$if:[{$eq:[{$path:"./border/enabled"},!0]},5,{$isUserOption:["./fill",5,0]}]}},yx={enabled:!1,key:"x",segments:{$apply:{fill:{$applySwitch:[{$path:"type"},{$path:"../../../fill"},["gradient",Fl],["image",Ar],["pattern",Pn]]},stroke:{$path:"../../../stroke"},fillOpacity:{$path:"../../../fillOpacity"},strokeWidth:{$isUserOption:["./stroke",{$isUserOption:["../../../strokeWidth",{$path:"../../../strokeWidth"},{$if:[{$greaterThan:[{$path:"../../../strokeWidth"},0]},{$path:"../../../strokeWidth"},2]}]},{$path:"../../../strokeWidth"}]},strokeOpacity:{$path:"../../../strokeOpacity"},lineDash:{$path:"../../../lineDash"},lineDashOffset:{$path:"../../../lineDashOffset"}}}},yD="white",f$={"radial-gauge":!0,"linear-gauge":!0};function m$(e){return f$[e]===!0}var Rn=class sm{static getDefaultColors(){return{fills:hi,fillsFallback:Object.values(hi),strokes:kr,sequentialColors:uo(hi),divergingColors:[hi.ORANGE,hi.YELLOW,hi.GREEN],hierarchyColors:["#fff","#e0e5ea","#c1ccd5","#a3b4c1","#859cad"],secondSequentialColors:Be.interpolate([Be.fromHexString(hi.BLUE),Be.fromHexString("#cbdef5")],8).map(t=>t.toString()),secondDivergingColors:[hi.GREEN,hi.YELLOW,hi.RED],secondHierarchyColors:["#fff","#c5cbd1","#a4b1bd","#8498a9","#648096"],up:{fill:hi.GREEN,stroke:kr.GREEN},down:{fill:hi.RED,stroke:kr.RED},neutral:{fill:hi.GRAY,stroke:kr.GRAY},altUp:{fill:hi.BLUE,stroke:kr.BLUE},altDown:{fill:hi.ORANGE,stroke:kr.ORANGE},altNeutral:{fill:hi.GRAY,stroke:kr.GRAY}}}static getDefaultPublicParameters(){return{accentColor:"#2196f3",axisColor:{$foregroundBackgroundMix:.325},backgroundColor:yD,borderColor:{$foregroundOpacity:.15},borderRadius:4,chartBackgroundColor:{$ref:"backgroundColor"},chartPadding:20,focusShadow:"0 0 0 3px var(--ag-charts-accent-color)",foregroundColor:"#181d1f",fontFamily:"Verdana, sans-serif",fontSize:Oo,fontWeight:400,gridLineColor:{$foregroundBackgroundMix:.1},popupShadow:"0 0 16px rgba(0, 0, 0, 0.15)",subtleTextColor:{$mix:[{$ref:"textColor"},{$ref:"chartBackgroundColor"},.38]},textColor:{$ref:"foregroundColor"},separationLinesColor:{$foregroundBackgroundMix:.17},chromeBackgroundColor:{$foregroundBackgroundMix:.02},chromeFontFamily:{$ref:"fontFamily"},chromeFontSize:{$ref:"fontSize"},chromeFontWeight:{$ref:"fontWeight"},chromeTextColor:{$ref:"foregroundColor"},chromeSubtleTextColor:{$mix:[{$ref:"chromeTextColor"},{$ref:"backgroundColor"},.38]},buttonBackgroundColor:{$ref:"backgroundColor"},buttonBorder:!0,buttonFontWeight:400,buttonTextColor:{$ref:"textColor"},inputBackgroundColor:{$ref:"backgroundColor"},inputBorder:!0,inputTextColor:{$ref:"textColor"},menuBackgroundColor:{$ref:"chromeBackgroundColor"},menuBorder:!0,menuTextColor:{$ref:"chromeTextColor"},panelBackgroundColor:{$ref:"chromeBackgroundColor"},panelSubtleTextColor:{$ref:"chromeSubtleTextColor"},tooltipBackgroundColor:{$ref:"chromeBackgroundColor"},tooltipBorder:!0,tooltipTextColor:{$ref:"chromeTextColor"},tooltipSubtleTextColor:{$ref:"chromeSubtleTextColor"},crosshairLabelBackgroundColor:{$ref:"foregroundColor"},crosshairLabelTextColor:{$ref:"chartBackgroundColor"}}}static getAxisDefaults({title:t,time:i}){return oe(t&&{title:{enabled:!1,text:"Axis Title",spacing:25,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:Si.MEDIUM},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"}}},i&&{parentLevel:{enabled:!1,label:{enabled:{$path:"../../label/enabled"},border:{enabled:{$or:[{$isUserOption:["../border",!0,!1]},{$path:"../../../label/border/enabled"}]},strokeWidth:{$path:"../../../label/border/strokeWidth"},stroke:{$path:"../../../label/border/stroke"}},fill:{$path:"../../label/fill"},fontSize:{$path:"../../label/fontSize"},fontFamily:{$path:"../../label/fontFamily"},fontWeight:"bold",spacing:{$path:"../../label/spacing"},color:{$path:"../../label/color"},cornerRadius:{$path:"../../label/cornerRadius"},padding:{$path:"../../label/padding"},avoidCollisions:{$path:"../../label/avoidCollisions"}},tick:{enabled:{$path:"../../tick/enabled"},width:{$path:"../../tick/width"},size:{$path:"../../tick/size"},stroke:{$path:"../../tick/stroke"}}}},{label:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},spacing:11,color:{$ref:"textColor"},avoidCollisions:!0,cornerRadius:4,border:{enabled:{$isUserOption:["../border",!0,!1]},strokeWidth:1,stroke:{$foregroundOpacity:.08}},padding:{$if:[{$eq:[{$path:"./border/enabled"},!0]},{left:12,right:12,top:8,bottom:8},void 0]}},line:{enabled:!0,width:1,stroke:{$ref:"axisColor"}},tick:{enabled:!1,size:6,width:1,stroke:{$ref:"axisColor"}},gridLine:{enabled:!0,width:1,style:{$apply:[{fillOpacity:1,stroke:{$ref:"gridLineColor"},strokeWidth:{$path:"../../width"},lineDash:[]},[{fillOpacity:1,stroke:{$ref:"gridLineColor"},strokeWidth:{$path:"../../width"},lineDash:[]}]]}},crossLines:{$apply:[{enabled:!0,fill:{$ref:"foregroundColor"},stroke:{$ref:"foregroundColor"},fillOpacity:.08,strokeWidth:1,label:{fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},padding:5,color:{$ref:"textColor"}}},void 0,{$pathString:["/common/axes/$axisType/crossLines",{axisType:{$path:["../type"]}}]},{$pathString:["/$seriesType/axes/$axisType/crossLines",{seriesType:{$path:["/series/0/type","line"]},axisType:{$path:["../type"]}}]}]}})}getChartDefaults(){return{minHeight:300,minWidth:300,background:{visible:!0,fill:{$ref:"chartBackgroundColor"}},padding:{top:{$ref:"chartPadding"},right:{$ref:"chartPadding"},bottom:{$ref:"chartPadding"},left:{$ref:"chartPadding"}},seriesArea:{border:{enabled:!1,stroke:{$ref:"foregroundColor"},strokeOpacity:1,strokeWidth:1},cornerRadius:4,padding:{$if:[{$eq:[{$path:"./border/enabled"},!0]},5,0]}},keyboard:{enabled:!0},title:{enabled:!1,text:"Title",spacing:{$if:[{$path:"../subtitle/enabled"},10,20]},fontWeight:{$ref:"fontWeight"},fontSize:{$rem:Si.LARGEST},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},wrapping:"hyphenate",layoutStyle:ma,textAlign:lr},subtitle:{enabled:!1,text:"Subtitle",spacing:20,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:Si.MEDIUM},fontFamily:{$ref:"fontFamily"},color:{$ref:"subtleTextColor"},wrapping:"hyphenate",layoutStyle:ma,textAlign:lr},footnote:{enabled:!1,text:"Footnote",spacing:20,fontSize:{$rem:Si.MEDIUM},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"subtleTextColor"},wrapping:"hyphenate",layoutStyle:ma,textAlign:lr},tooltip:{enabled:!0,darkTheme:ul,delay:0,pagination:!1,mode:{$if:[{$or:[{$and:[{$isChartType:"cartesian"},{$not:{$hasSeriesType:"bubble"}},{$not:{$hasSeriesType:"scatter"}},{$greaterThan:[{$size:{$path:"/series"}},1]},{$lessThan:[{$size:{$path:"/series"}},4]}]},{$and:[{$isChartType:"polar"},{$greaterThan:[{$size:{$path:"/series"}},1]},{$lessThan:[{$size:{$path:"/series"}},4]}]}]},"shared","single"]}},overlays:{darkTheme:ul},listeners:{},series:{tooltip:{range:{$path:["/tooltip/range","exact"]},position:{anchorTo:{$path:["/tooltip/position/anchorTo","pointer"]},placement:{$path:["/tooltip/position/placement",void 0]},xOffset:{$path:["/tooltip/position/xOffset",0]},yOffset:{$path:["/tooltip/position/yOffset",0]}}}}}}constructor(t={}){const{overrides:i,palette:s,params:n}=Re(t),o=this.createChartConfigPerChartType(this.getDefaults()),a={};i&&this.processOverrides(a,i);const{fills:r,strokes:l,sequentialColors:c,...h}=this.getDefaultColors();this.palette=on(oe(s,{fills:Object.values(r),strokes:Object.values(l),sequentialColors:Object.values(c),...h})),this.paletteType=XN(s),this.params=oe(n,this.getPublicParameters()),this.config=on(Re(o)),this.overrides=on(i),this.presets=on(a)}processOverrides(t,i){for(const s of me.listModulesByType("series")){const n=s.name,o=i[n];m$(n)&&(t[n]=o,delete i[n])}}createChartConfigPerChartType(t){var i;for(const s of me.listModulesByType("chart"))for(const n of me.listModulesByType("series"))n.chartType===s.name&&(t[i=n.name]??(t[i]=s.themeTemplate));return t}getDefaults(){const t=(n,o)=>{const a={},r=oe({axes:{}},...Array.from(me.listModulesByType("plugin"),l=>({[l.name]:l.themeTemplate})),me.getChartModule(n)?.themeTemplate,this.getChartDefaults());for(const l of o){a[l]=oe(x$(l),a[l]??r);const{axes:c}=a[l];for(const h of me.listModulesByType("axis"))c[h.name]=oe(c[h.name],!h.chartType||h.chartType===n?y$(h.name):null,sm.axisDefault[h.name]);(l==="map-shape-background"||l==="map-line-background")&&delete a[l].series.tooltip}return a},i=[...me.listModulesByType("series")],s=Zh(i,n=>n.chartType||"unknown");return oe(...Object.keys(s).map(n=>t(n,s[n]?.map(o=>o.name)??[])))}static applyTemplateTheme(t,i,s){if(Ce(t))for(let n=0;n<t.length;n++){const o=t[n];typeof o=="symbol"&&s?.has(o)&&(t[n]=s.get(o))}else for(const n of Object.keys(t)){const o=t[n];typeof o=="symbol"&&s?.has(o)&&(t[n]=s.get(o))}}templateTheme(t,i=!0){const s=i?Re(t):t,n=this.getTemplateParameters();return ya(s,sm.applyTemplateTheme,void 0,void 0,n),s}getDefaultColors(){return sm.getDefaultColors()}getPublicParameters(){return sm.getDefaultPublicParameters()}getTemplateParameters(){const t=new Map;t.set(ul,!1),t.set(fa,"#00000080"),t.set(sg,"#aaa"),t.set(ma,"block"),t.set(lr,"center"),t.set(fd,["#797b86","#e24c4a","#f49d2d","#65ab58","#409682","#4db9d2","#5090dc","#3068f9","#e24c4a","#913aac","#d93e64"]),t.set(ig,yD),t.set(As,hi.BLUE),t.set(os,hi.BLUE),t.set(ng,hi.BLUE),t.set(md,yD),t.set(yd,"#fafafa"),t.set(xd,"#ddd"),t.set(bd,"#000"),t.set(vd,"#181d1f"),t.set(Sd,"#e35c5c"),t.set(Md,"#e35c5c"),t.set(Dd,"#fafafa"),t.set(Id,"#ddd"),t.set(kd,"#000"),t.set(Ad,"top");const i=this.getDefaultColors();return t.set(Vm,this.palette.up?.stroke??i.up.stroke),t.set(Hm,this.palette.up?.fill??i.up.fill),t.set(Gm,this.palette.down?.stroke??i.down.stroke),t.set(jm,this.palette.down?.fill??i.down.fill),t.set(Wm,this.palette.neutral?.stroke??i.neutral.stroke),t.set($m,this.palette.neutral?.fill??i.neutral.fill),t.set(Um,this.palette.altUp?.stroke??i.up.stroke),t.set(Ym,this.palette.altUp?.fill??i.up.fill),t.set(Km,this.palette.altDown?.stroke??i.down.stroke),t.set(Zm,this.palette.altDown?.fill??i.down.fill),t.set(Xm,this.palette.altNeutral?.fill??i.altNeutral.fill),t.set(qm,this.palette.altNeutral?.stroke??i.altNeutral.stroke),t}};Rn.axisDefault={number:Rn.getAxisDefaults({title:!0,time:!1}),log:Rn.getAxisDefaults({title:!0,time:!1}),category:Rn.getAxisDefaults({title:!0,time:!1}),"grouped-category":Rn.getAxisDefaults({title:!0,time:!1}),time:Rn.getAxisDefaults({title:!0,time:!0}),"unit-time":Rn.getAxisDefaults({title:!0,time:!0}),"ordinal-time":Rn.getAxisDefaults({title:!0,time:!0}),"angle-category":Rn.getAxisDefaults({title:!1,time:!1}),"angle-number":Rn.getAxisDefaults({title:!1,time:!1}),"radius-category":Rn.getAxisDefaults({title:!0,time:!1}),"radius-number":Rn.getAxisDefaults({title:!0,time:!1})};var $o=Rn;function y$(e){let t=me.getAxisModule(e)?.themeTemplate??{};for(const i of me.listModulesByType("axis:plugin"))(i.axisTypes?.includes(e)??!0)&&(t=oe({[i.name]:i.themeTemplate},t));return t}function x$(e){let t=me.getSeriesModule(e)?.themeTemplate??{};for(const i of me.listModulesByType("series:plugin"))(i.seriesTypes?.includes(e)??!0)&&(t=oe({series:{[i.name]:i.themeTemplate}},t));return t}var b$=new Set(["foreground"]);function t1(e){const t=new Map;for(const[h,{type:d}]of Rl)me.hasModule(h)||(t.has(d)?t.get(d).add(h):t.set(d,new Set([h])));if(t.size===0)return e;function i(h){const d=t.get("plugin");if(!(!fe(h)||!d))for(const u of d)u in h&&h[u].enabled!==!0&&delete h[u]}function s(h){const d=t.get("series:plugin");if(!(!fe(h)||!d))for(const u of d)u in h&&delete h[u]}function n(h){const d=t.get("axis:plugin");if(!(!fe(h)||!d))for(const u of d)u in h&&h[u].enabled!==!0&&delete h[u]}function o(h){if(fe(h))for(const d of Object.keys(h)){if(t.get("axis")?.has(d)){delete h[d];continue}n(h[d])}}function a(h){fe(h)&&(o(h.axes),i(h),s(h.series))}const r=Re(e.config),l=Re(e.overrides),c=Re(e.presets);for(const h of Object.keys(r)){if(t.get("series")?.has(h)){delete r[h];continue}a(r[h])}if(fe(l)){const h=l;fe(h.common)&&(o(h.common.axes),i(h.common));for(const d of Object.keys(h))if(d!=="common"){if(t.get("series")?.has(d)){delete h[d];continue}a(h[d])}}if(fe(c)){const h=c;for(const d of Object.keys(h)){if(t.get("preset")?.has(d)||t.get("series")?.has(d)){delete h[d];continue}i(h[d]),o(h[d]?.axes)}}return Object.create(e,{config:{value:on(r),enumerable:!0},overrides:{value:fe(l)?on(l):l,enumerable:!0},presets:{value:fe(c)?on(c):c,enumerable:!0}})}function v$(e,t,i){const s=Ap(I$(e,t).concat(i));if(!s.length)return;const n=me.isIntegrated()?"https://www.ag-grid.com/data-grid/integrated-charts-installation/":"https://www.ag-grid.com/charts/r/module-registry/",o=Zh(s,a=>a.enterprise?"enterprise":"community");if(s.length){const a=me.isEnterprise()||o.enterprise?.length?"enterprise":"community";j.errorOnce(["required modules are not registered. Check if you have registered the modules:","",me.isUmd()?"Install and register 'ag-charts-enterprise' before creating the chart.":D$(s.map(S$),a),"",`See ${n} for more details.`].join(`
`))}}function S$(e){return e.moduleId??e.name}function i1(e){return`    ${e},`}function M$(e,t){return e.length?`import {
${e.map(i1).join(`
`)}
} from 'ag-charts-${t}';`:null}function D$(e,t){const i=M$(["ModuleRegistry"].concat(e),t),s=e.map(i1).join(`
`);return`${i}

ModuleRegistry.registerModules([
${s}
]);`}function I$(e,t){const i=new Map,s="axes"in t&&fe(t.axes)?t.axes:{},n=new Set(Object.values(s).map(r=>r?.type).filter(St)),o=new Set(t.series?.map(r=>r.type).filter(St));function a(r){i.set(r.name,r)}for(const r of Rl.values())if(!me.hasModule(r.name)&&!b$.has(r.name)&&!(e&&r.chartType&&e!==r.chartType))switch(r.type){case"chart":break;case"axis":if(n.has(r.name)){for(const h of Object.keys(s))s?.[h].type===r.name&&delete s[h];a(r)}break;case"series":o.has(r.name)&&(t.series=t.series.filter(h=>h.type!==r.name),a(r));break;case"plugin":const l=r.name,c=t[l];fe(c)&&(c.enabled!==!1&&a(r),delete t[l]);break;case"axis:plugin":for(const h of Object.values(s)){const d=r.name;h?.[d]&&(h[d].enabled!==!1&&a(r),delete h[d])}break;case"series:plugin":for(const h of t.series??[])h[r.name]&&(delete h[r.name],a(r));break}for(const r of o){const l=Rl.get(r);l?.type==="series"&&!me.hasModule(l.name)&&!i.has(l.name)&&(t.series=t.series.filter(c=>c.type!==l.name),a(l))}return Array.from(i.values())}function s1(e,t){const i="axes"in t&&fe(t.axes),s="series"in t&&Ce(t.series),n=a=>e==null||!a.chartType||a.chartType===e,o=[];for(const a of me.listModules())if(me.isModuleType("plugin",a))n(a)||(delete t[a.name],o.push(a.name));else if(me.isModuleType("axis:plugin",a)){if(i&&!n(a)){for(const r of Object.values(t.axes))delete r[a.name];o.push(a.name)}}else if(me.isModuleType("series:plugin",a)&&s&&!n(a)){for(const r of t.series)delete r[a.name];o.push(a.name)}return o}var xD="#192232",hs={BLUE:"#5090dc",ORANGE:"#ffa03a",GREEN:"#459d55",CYAN:"#34bfe1",YELLOW:"#e1cc00",VIOLET:"#9669cb",GRAY:"#b5b5b5",MAGENTA:"#bd5aa7",BROWN:"#8a6224",RED:"#ef5452"},eh={BLUE:"#74a8e6",ORANGE:"#ffbe70",GREEN:"#6cb176",CYAN:"#75d4ef",YELLOW:"#f6e559",VIOLET:"#aa86d8",GRAY:"#a1a1a1",MAGENTA:"#ce7ab9",BROWN:"#997b52",RED:"#ff7872"},fu=class extends $o{getDefaultColors(){return{fills:hs,fillsFallback:Object.values(hs),strokes:eh,sequentialColors:uo(hs),divergingColors:[hs.ORANGE,hs.YELLOW,hs.GREEN],hierarchyColors:["#192834","#253746","#324859","#3f596c","#4d6a80"],secondSequentialColors:["#5090dc","#4882c6","#4073b0","#38659a","#305684","#28486e","#203a58","#182b42"],secondDivergingColors:[hs.GREEN,hs.YELLOW,hs.RED],secondHierarchyColors:["#192834","#3b5164","#496275","#577287","#668399"],up:{fill:hs.GREEN,stroke:eh.GREEN},down:{fill:hs.RED,stroke:eh.RED},neutral:{fill:hs.GRAY,stroke:eh.GRAY},altUp:{fill:hs.BLUE,stroke:eh.BLUE},altDown:{fill:hs.ORANGE,stroke:eh.ORANGE},altNeutral:{fill:hs.GRAY,stroke:eh.GRAY}}}getPublicParameters(){return{...super.getPublicParameters(),axisColor:{$foregroundBackgroundMix:.737},backgroundColor:xD,borderColor:{$foregroundBackgroundMix:.216},chromeBackgroundColor:{$foregroundBackgroundMix:.07},foregroundColor:"#fff",gridLineColor:{$foregroundBackgroundMix:.257},popupShadow:"0 0 16px rgba(0, 0, 0, 0.33)",subtleTextColor:{$mix:[{$ref:"textColor"},{$ref:"chartBackgroundColor"},.57]},separationLinesColor:{$foregroundBackgroundMix:.44},crosshairLabelBackgroundColor:{$foregroundBackgroundMix:.65}}}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(ul,!0),e.set(ig,xD),e.set(As,hs.BLUE),e.set(ng,"#fff"),e.set(os,hs.BLUE),e.set(md,xD),e.set(yd,"#28313e"),e.set(xd,"#4b525d"),e.set(bd,"#fff"),e.set(vd,"#fff"),e.set(Dd,"#28313e"),e.set(Id,"#4b525d"),e.set(kd,"#fff"),e}constructor(e){super(e)}},cn={GREEN:"#089981",RED:"#F23645",BLUE:"#5090dc",GRAY:"#A9A9A9"},th={GREEN:"#089981",RED:"#F23645",BLUE:"#5090dc",GRAY:"#909090"},k$=class extends fu{getDefaultColors(){return{...super.getDefaultColors(),fills:{...cn},fillsFallback:Object.values({...cn}),strokes:{...th},sequentialColors:uo(cn),divergingColors:[cn.GREEN,cn.BLUE,cn.RED],secondSequentialColors:["#5090dc","#4882c6","#4073b0","#38659a","#305684","#28486e","#203a58","#182b42"],up:{fill:cn.GREEN,stroke:th.GREEN},down:{fill:cn.RED,stroke:th.RED},neutral:{fill:cn.BLUE,stroke:th.BLUE},altUp:{fill:cn.GREEN,stroke:th.GREEN},altDown:{fill:cn.RED,stroke:th.RED},altNeutral:{fill:cn.GRAY,stroke:th.GRAY}}}getPublicParameters(){return{...super.getPublicParameters(),chartPadding:0,gridLineColor:{$foregroundBackgroundMix:.12}}}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(As,cn.BLUE),e.set(os,cn.BLUE),e.set(ma,"overlay"),e.set(lr,"left"),e.set(Ad,"bottom"),e}},hn={GREEN:"#089981",RED:"#F23645",BLUE:"#5090dc",GRAY:"#A9A9A9"},ih={GREEN:"#089981",RED:"#F23645",BLUE:"#5090dc",GRAY:"#909090"},A$=class extends $o{getDefaultColors(){return{...super.getDefaultColors(),fills:{...hn},fillsFallback:Object.values({...hn}),strokes:{...ih},sequentialColors:uo(hn),divergingColors:[hn.GREEN,hn.BLUE,hn.RED],up:{fill:hn.GREEN,stroke:ih.GREEN},down:{fill:hn.RED,stroke:ih.RED},neutral:{fill:hn.BLUE,stroke:ih.BLUE},altUp:{fill:hn.GREEN,stroke:ih.GREEN},altDown:{fill:hn.RED,stroke:ih.RED},altNeutral:{fill:hn.GRAY,stroke:ih.GRAY}}}getPublicParameters(){return{...super.getPublicParameters(),chartPadding:0,gridLineColor:{$foregroundBackgroundMix:.06}}}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(As,hn.BLUE),e.set(os,hn.BLUE),e.set(ma,"overlay"),e.set(lr,"left"),e.set(Ad,"bottom"),e}},ds={BLUE:"#2196F3",ORANGE:"#FF9800",GREEN:"#4CAF50",CYAN:"#00BCD4",YELLOW:"#FFEB3B",VIOLET:"#7E57C2",GRAY:"#9E9E9E",MAGENTA:"#F06292",BROWN:"#795548",RED:"#F44336"},sh={BLUE:"#90CAF9",ORANGE:"#FFCC80",GREEN:"#A5D6A7",CYAN:"#80DEEA",YELLOW:"#FFF9C4",VIOLET:"#B39DDB",GRAY:"#E0E0E0",MAGENTA:"#F48FB1",BROWN:"#A1887F",RED:"#EF9A9A"},C$=class extends fu{getDefaultColors(){return{...super.getDefaultColors(),fills:ds,fillsFallback:Object.values(ds),strokes:sh,sequentialColors:uo(ds),divergingColors:[ds.ORANGE,ds.YELLOW,ds.GREEN],secondSequentialColors:["#2196f3","#208FEC","#1E88E5","#1C7FDC","#1976d2","#176EC9","#1565c0"],secondDivergingColors:[ds.GREEN,ds.YELLOW,ds.RED],up:{fill:ds.GREEN,stroke:sh.GREEN},down:{fill:ds.RED,stroke:sh.RED},neutral:{fill:ds.GRAY,stroke:sh.GRAY},altUp:{fill:ds.BLUE,stroke:sh.BLUE},altDown:{fill:ds.RED,stroke:sh.RED},altNeutral:{fill:ds.GRAY,stroke:sh.GRAY}}}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(As,ds.BLUE),e.set(os,ds.BLUE),e}},us={BLUE:"#2196F3",ORANGE:"#FF9800",GREEN:"#4CAF50",CYAN:"#00BCD4",YELLOW:"#FFEB3B",VIOLET:"#7E57C2",GRAY:"#9E9E9E",MAGENTA:"#F06292",BROWN:"#795548",RED:"#F44336"},nh={BLUE:"#1565C0",ORANGE:"#E65100",GREEN:"#2E7D32",CYAN:"#00838F",YELLOW:"#F9A825",VIOLET:"#4527A0",GRAY:"#616161",MAGENTA:"#C2185B",BROWN:"#4E342E",RED:"#B71C1C"},L$=class extends $o{getDefaultColors(){return{...super.getDefaultColors(),fills:us,fillsFallback:Object.values(us),strokes:nh,sequentialColors:uo(us),divergingColors:[us.ORANGE,us.YELLOW,us.GREEN],secondSequentialColors:["#2196f3","#329EF4","#42a5f5","#53ADF6","#64b5f6","#7AC0F8","#90caf9"],secondDivergingColors:[us.GREEN,us.YELLOW,us.RED],up:{fill:us.GREEN,stroke:nh.GREEN},down:{fill:us.RED,stroke:nh.RED},neutral:{fill:us.GRAY,stroke:nh.GRAY},altUp:{fill:us.BLUE,stroke:nh.BLUE},altDown:{fill:us.RED,stroke:nh.RED},altNeutral:{fill:us.GRAY,stroke:nh.GRAY}}}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(As,us.BLUE),e.set(os,us.BLUE),e}},Zt={BLUE:"#436ff4",PURPLE:"#9a7bff",MAGENTA:"#d165d2",PINK:"#f0598b",RED:"#f47348",ORANGE:"#f2a602",YELLOW:"#e9e201",GREEN:"#21b448",CYAN:"#00b9a2",MODERATE_BLUE:"#00aee4",GRAY:"#bbbbbb"},oh={BLUE:"#6698ff",PURPLE:"#c0a3ff",MAGENTA:"#fc8dfc",PINK:"#ff82b1",RED:"#ff9b70",ORANGE:"#ffcf4e",YELLOW:"#ffff58",GREEN:"#58dd70",CYAN:"#51e2c9",MODERATE_BLUE:"#4fd7ff",GRAY:"#eeeeee"},w$=class extends fu{getDefaultColors(){return{fills:Zt,fillsFallback:Object.values(Zt),strokes:oh,sequentialColors:uo(Zt),divergingColors:[Zt.BLUE,Zt.RED],hierarchyColors:[],secondSequentialColors:[Zt.BLUE,Zt.PURPLE,Zt.MAGENTA,Zt.PINK,Zt.RED,Zt.ORANGE,Zt.YELLOW,Zt.GREEN],secondDivergingColors:[Zt.BLUE,Zt.RED],secondHierarchyColors:[],up:{fill:Zt.GREEN,stroke:oh.GREEN},down:{fill:Zt.RED,stroke:oh.RED},neutral:{fill:Zt.GRAY,stroke:oh.GRAY},altUp:{fill:Zt.BLUE,stroke:oh.BLUE},altDown:{fill:Zt.RED,stroke:oh.RED},altNeutral:{fill:Zt.GRAY,stroke:oh.GRAY}}}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(As,Zt.BLUE),e.set(os,Zt.BLUE),e}},Xt={BLUE:"#436ff4",PURPLE:"#9a7bff",MAGENTA:"#d165d2",PINK:"#f0598b",RED:"#f47348",ORANGE:"#f2a602",YELLOW:"#e9e201",GREEN:"#21b448",CYAN:"#00b9a2",MODERATE_BLUE:"#00aee4",GRAY:"#bbbbbb"},ah={BLUE:"#2346c9",PURPLE:"#7653d4",MAGENTA:"#a73da9",PINK:"#c32d66",RED:"#c84b1c",ORANGE:"#c87f00",YELLOW:"#c1b900",GREEN:"#008c1c",CYAN:"#00927c",MODERATE_BLUE:"#0087bb",GRAY:"#888888"},T$=class extends $o{getDefaultColors(){return{...super.getDefaultColors(),fills:Xt,fillsFallback:Object.values(Xt),strokes:ah,sequentialColors:uo(Xt),divergingColors:[Xt.BLUE,Xt.RED],hierarchyColors:[],secondSequentialColors:[Xt.BLUE,Xt.PURPLE,Xt.MAGENTA,Xt.PINK,Xt.RED,Xt.ORANGE,Xt.YELLOW,Xt.GREEN],secondDivergingColors:[Xt.BLUE,Xt.RED],secondHierarchyColors:[],up:{fill:Xt.GREEN,stroke:ah.GREEN},down:{fill:Xt.RED,stroke:ah.RED},neutral:{fill:Xt.GRAY,stroke:ah.GRAY},altUp:{fill:Xt.BLUE,stroke:ah.BLUE},altDown:{fill:Xt.RED,stroke:ah.RED},altNeutral:{fill:Xt.GRAY,stroke:ah.GRAY}}}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(As,Xt.BLUE),e.set(os,Xt.BLUE),e}},Ai={BLUE:"#4472C4",ORANGE:"#ED7D31",GRAY:"#A5A5A5",YELLOW:"#FFC000",MODERATE_BLUE:"#5B9BD5",GREEN:"#70AD47",DARK_GRAY:"#7B7B7B",DARK_BLUE:"#264478",VERY_DARK_GRAY:"#636363",DARK_YELLOW:"#997300"},zl={BLUE:"#6899ee",ORANGE:"#ffa55d",GRAY:"#cdcdcd",YELLOW:"#ffea53",MODERATE_BLUE:"#82c3ff",GREEN:"#96d56f",DARK_GRAY:"#a1a1a1",DARK_BLUE:"#47689f",VERY_DARK_GRAY:"#878787",DARK_YELLOW:"#c0993d"},N$=class extends fu{getDefaultColors(){return{...super.getDefaultColors(),fills:{...Ai,RED:Ai.ORANGE},fillsFallback:Object.values({...Ai,RED:Ai.ORANGE}),strokes:{...zl,RED:zl.ORANGE},sequentialColors:uo({...Ai,RED:Ai.ORANGE}),divergingColors:[Ai.ORANGE,Ai.YELLOW,Ai.GREEN],secondSequentialColors:["#5090dc","#4882c6","#4073b0","#38659a","#305684","#28486e","#203a58","#182b42"],secondDivergingColors:[Ai.GREEN,Ai.YELLOW,Ai.ORANGE],up:{fill:Ai.GREEN,stroke:zl.GREEN},down:{fill:Ai.ORANGE,stroke:zl.ORANGE},neutral:{fill:Ai.GRAY,stroke:zl.GRAY},altUp:{fill:Ai.BLUE,stroke:zl.BLUE},altDown:{fill:Ai.ORANGE,stroke:zl.ORANGE},altNeutral:{fill:Ai.GRAY,stroke:zl.GRAY}}}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(As,Ai.BLUE),e.set(os,Ai.BLUE),e}},zi={BLUE:"#5281d5",ORANGE:"#ff8d44",GRAY:"#b5b5b5",YELLOW:"#ffd02f",MODERATE_BLUE:"#6aabe6",GREEN:"#7fbd57",DARK_GRAY:"#8a8a8a",DARK_BLUE:"#335287",VERY_DARK_GRAY:"#717171",DARK_YELLOW:"#a98220"},Cr={BLUE:"#214d9b",ORANGE:"#c25600",GRAY:"#7f7f7f",YELLOW:"#d59800",MODERATE_BLUE:"#3575ac",GREEN:"#4b861a",DARK_GRAY:"#575757",DARK_BLUE:"#062253",VERY_DARK_GRAY:"#414141",DARK_YELLOW:"#734f00"},O$=class extends $o{getDefaultColors(){return{...super.getDefaultColors(),fills:{...zi,RED:zi.ORANGE},fillsFallback:Object.values({...zi,RED:zi.ORANGE}),strokes:{...Cr,RED:Cr.ORANGE},sequentialColors:uo({...zi,RED:zi.ORANGE}),divergingColors:[zi.ORANGE,zi.YELLOW,zi.GREEN],secondSequentialColors:["#5090dc","#629be0","#73a6e3","#85b1e7","#96bcea","#a8c8ee","#b9d3f1","#cbdef5"],secondDivergingColors:[zi.GREEN,zi.YELLOW,zi.ORANGE],secondHierarchyColors:[],up:{fill:zi.GREEN,stroke:Cr.GREEN},down:{fill:zi.ORANGE,stroke:Cr.ORANGE},neutral:{fill:Cr.GRAY,stroke:Cr.GRAY},altUp:{fill:zi.BLUE,stroke:Cr.BLUE},altDown:{fill:zi.ORANGE,stroke:Cr.ORANGE},altNeutral:{fill:zi.GRAY,stroke:Cr.GRAY}}}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(As,zi.BLUE),e.set(os,zi.BLUE),e}},xx=Z("millisecond","second","minute","hour","day","month","year"),n1={unit:$(xx),step:Mc,epoch:is,utc:R};n1.every=ct;var bD=Ot(n1,"a time interval object"),mu={enabled:R,text:N,padding:W,...Ke},Lr=Ge({enabled:R,type:$(Z("line","range")),range:Ue(Ge((e,{options:t})=>t.type==="range","crossLine type to be 'range'"),be(le),qa(2,2)),value:Ue(Ge((e,{options:t})=>t.type==="line","crossLine type to be 'line'"),le),label:mu,fill:ie,fillOpacity:ce,...J,...ne},"cross-line options"),o1={...Lr,label:{...mu,position:Z("top","left","right","bottom","top-left","top-right","bottom-left","bottom-right","inside","inside-left","inside-right","inside-top","inside-bottom","inside-top-left","inside-bottom-left","inside-top-right","inside-bottom-right"),rotation:W}},Bl={enabled:R,rotation:W,avoidCollisions:R,minSpacing:P,spacing:P,formatter:vi(Hi),itemStyler:Qe({...Ke,...Dn,spacing:W}),...Ke,...Dn},bx={autoRotate:R,autoRotateAngle:W,wrapping:Z("never","always","hyphenate","on-space"),truncate:R,...Bl},a1={format:nn,...bx},vx={format:Ae(N,Xa),...bx},r1={enabled:R,width:P,size:P,stroke:ie},vD={enabled:R,label:vx,tick:r1},l1={values:be(le),minSpacing:P},yu={reverse:R,gridLine:{enabled:R,width:P,style:Ft({fill:ie,fillOpacity:P,stroke:Ae(ie,hd),strokeWidth:P,lineDash:be(P)},"a grid-line style object array")},interval:l1,label:Bl,line:{enabled:R,width:P,stroke:ie},tick:r1,context:()=>!0};yu.layoutConstraints=ee({stacked:$(R),align:$(Z("start","end")),unit:$(Z("percent","px")),width:$(P)});var _l={...yu,crossAt:{value:$(Ae(W,is,N,be(N))),sticky:R},crossLines:Ft(o1,"a cross-line options array"),position:Z("top","right","bottom","left"),thickness:P,maxThicknessRatio:ce,title:{enabled:R,text:Hi,spacing:P,formatter:vi(Hi),...Ke}};_l.title._enabledFromTheme=ee(R);var Sx={enabled:R,...se,...J,...ne};function rh(e,t){const i={enabled:R,xOffset:W,yOffset:W,formatter:vi(N),renderer:vi(Ae(N,Ot({text:N,color:ie,backgroundColor:ie,opacity:ce},"crosshair label renderer result object")))};let s;return e&&(s={...i,format:t?Ae(N,Ot({millisecond:N,second:N,hour:N,day:N,month:N,year:N})):N}),{enabled:R,snap:R,label:s??i,...J,...ne}}function Kg(e,t){return{min:Ue(e,ss("max")),max:Ue(e,ns("min")),preferredMin:Ue(e,ss("preferredMax"),ss("max")),preferredMax:Ue(e,ns("preferredMin"),ns("min")),nice:R,interval:{step:t?Ae(Mc,xx,bD):Mc,values:be(e),minSpacing:Ue(P,ss("maxSpacing")),maxSpacing:Ue(P,ns("minSpacing"))}}}var c1={step:Ae(Mc,xx,bD),values:be(Ae(W,is)),minSpacing:Ue(P,ss("maxSpacing")),maxSpacing:Ue(P,ns("minSpacing")),placement:Z("on","between")},xu={..._l,type:Le("category"),label:bx,paddingInner:ce,paddingOuter:ce,groupPaddingInner:ce,crosshair:rh(),bandHighlight:Sx,interval:{...l1,placement:Z("on","between")}},bu={..._l,type:Le("grouped-category"),label:bx,crosshair:rh(),bandHighlight:Sx,paddingInner:ce,groupPaddingInner:ce,depthOptions:Ft({label:{enabled:R,avoidCollisions:R,wrapping:Z("never","always","hyphenate","on-space"),truncate:R,rotation:W,spacing:W,...Ke,...Dn},tick:{enabled:R,stroke:ie,width:P}},"depth options objects array")},vu={..._l,...Kg(W),type:Le("number"),label:a1,crosshair:rh(!0)},Su={..._l,...Kg(W),type:Le("log"),base:Ue(Mc,Ge(e=>e!==1,"not equal to 1")),label:a1,crosshair:rh(!0)},Mu={..._l,...Kg(Ae(W,is),!0),type:Le("time"),label:vx,parentLevel:vD,crosshair:rh(!0,!0)},Du={..._l,type:Le("unit-time"),unit:Ae(bD,xx),label:vx,parentLevel:vD,paddingInner:ce,paddingOuter:ce,groupPaddingInner:ce,crosshair:rh(!0,!0),bandHighlight:Sx,min:Ue(Ae(W,is),ss("max")),max:Ue(Ae(W,is),ns("min")),preferredMin:Ue(Ae(W,is),ss("preferredMax"),ss("max")),preferredMax:Ue(Ae(W,is),ns("preferredMin"),ns("min")),interval:c1},Iu={..._l,type:Le("ordinal-time"),paddingInner:ce,paddingOuter:ce,groupPaddingInner:ce,label:vx,parentLevel:vD,interval:c1,crosshair:rh(!0,!0),bandHighlight:Sx},h1={...yu,...Kg(W),type:Le("angle-number"),crossLines:Ft(Lr),startAngle:W,endAngle:W,label:{...Bl,orientation:Z("fixed","parallel","perpendicular"),format:nn}},SD={...yu,type:Le("angle-category"),shape:Z("polygon","circle"),crossLines:Ft(Lr),startAngle:W,endAngle:W,paddingInner:ce,groupPaddingInner:ce,label:{...Bl,orientation:Z("fixed","parallel","perpendicular")}};SD.innerRadiusRatio=ce;var d1={...yu,...Kg(W),type:Le("radius-number"),shape:Z("polygon","circle"),positionAngle:W,innerRadiusRatio:ce,crossLines:Ft({...Lr,label:{...mu,positionAngle:W}},"cross-line options"),title:{enabled:R,text:Hi,spacing:P,formatter:vi(Hi),...Ke},label:{...Bl,format:nn}},u1={...yu,type:Le("radius-category"),positionAngle:W,innerRadiusRatio:ce,paddingInner:ce,paddingOuter:ce,groupPaddingInner:ce,label:Bl,crossLines:Ft({...Lr,label:{...mu,positionAngle:W}},"cross-line options"),title:{enabled:R,text:Hi,spacing:P,formatter:vi(Hi),...Ke}},p1=zt(It,It),E$=Qe({...J,...se,...ne,marker:tr}),g1={showInMiniChart:R,connectMissingData:R,interpolation:jp,label:ft,styler:E$,marker:so,tooltip:Ye,shadow:wo,...Je,...se,...J,...ne,highlight:p1,segmentation:ca},MD={...g1,...et,highlight:p1,type:$(Le("area")),xKey:$(N),yKey:$(N),xKeyAxis:N,yKeyAxis:N,xName:N,yName:N,legendItemName:N,stacked:R,stackGroup:N,normalizedTo:W};MD.yFilterKey=ee(N);var f1=zt(io,io),m1=Qe({...se,...J,...ne,cornerRadius:P}),DD={direction:Z("horizontal","vertical"),showInMiniChart:R,cornerRadius:P,styler:m1,itemStyler:m1,crisp:R,label:{...ft,placement:Z("inside-center","inside-start","inside-end","outside-start","outside-end"),spacing:P},errorBar:ud,shadow:wo,tooltip:Ye,...Je,highlight:f1,...se,...J,...ne,segmentation:ca};DD.sparklineMode=ee(R);var ku={...DD,...et,highlight:f1,type:$(Le("bar")),xKey:$(N),yKey:$(N),xKeyAxis:N,yKeyAxis:N,xName:N,yName:N,direction:Z("horizontal","vertical"),grouped:R,stacked:R,stackGroup:N,normalizedTo:W,legendItemName:N,errorBar:pd};ku.yFilterKey=ee(N),ku.pickOutsideVisibleMinorAxis=ee(R),ku.focusPriority=ee(W),ku.simpleItemStyler=ee(ct);var y1={title:N,domain:be(W),maxSize:P,showInMiniChart:R,label:{placement:Z("top","right","bottom","left"),...ft},tooltip:Ye,styler:Qe({...so,maxSize:P}),maxRenderedItems:W,...Je,...Q(so,["enabled"]),highlight:zt(It,It)},Mx={...y1,...et,type:$(Le("bubble")),xKey:$(N),yKey:$(N),sizeKey:$(N),labelKey:N,xName:N,yName:N,sizeName:N,labelName:N,legendItemName:N,xKeyAxis:N,yKeyAxis:N,highlight:zt(It,It)};Mx.xFilterKey=ee(N),Mx.yFilterKey=ee(N),Mx.sizeFilterKey=ee(N);var x1={showInMiniChart:R,cornerRadius:P,label:ft,tooltip:Ye,shadow:wo,...Je,...se,...J,...ne,highlight:zt(It,It),areaPlot:R,aggregation:Z("count","sum","mean"),bins:be(be(W)),binCount:P},P$={...et,...x1,type:$(Le("histogram")),xKey:$(N),yKey:N,xKeyAxis:N,yKeyAxis:N,xName:N,yName:N},b1=zt(It,Qa),R$=Qe({...J,...ne,marker:tr}),ID={title:N,showInMiniChart:R,connectMissingData:R,interpolation:jp,label:ft,styler:R$,marker:so,tooltip:Ye,errorBar:ud,...Je,...J,...ne,highlight:b1,segmentation:FS};ID.sparklineMode=ee(R);var Yg={...ID,...et,highlight:b1,type:$(Le("line")),xKey:$(N),yKey:$(N),xKeyAxis:N,yKeyAxis:N,xName:N,yName:N,stacked:R,stackGroup:N,normalizedTo:W,legendItemName:N,errorBar:pd};Yg.yFilterKey=ee(N),Yg.pickOutsideVisibleMinorAxis=ee(R),Yg.focusPriority=ee(W);var v1={title:N,showInMiniChart:R,label:{placement:Z("top","right","bottom","left"),...ft},tooltip:Ye,errorBar:ud,styler:Qe(so),maxRenderedItems:W,...Je,...Q(so,["enabled"]),highlight:zt(It,It)},Dx={...v1,...et,type:$(Le("scatter")),xKey:$(N),yKey:$(N),labelKey:N,xName:N,yName:N,labelName:N,legendItemName:N,xKeyAxis:N,yKeyAxis:N,errorBar:pd,highlight:zt(It,It)};Dx.xFilterKey=ee(N),Dx.yFilterKey=ee(N),Dx.sizeFilterKey=ee(N);var S1=zt(It,It),kD={...Je,radiusMin:P,radiusMax:P,rotation:W,outerRadiusOffset:W,outerRadiusRatio:ce,hideZeroValueSectorsInLegend:R,sectorSpacing:P,cornerRadius:P,itemStyler:Qe({...se,...J,...ne,cornerRadius:P}),title:{enabled:R,text:N,showInLegend:R,spacing:P,...Ke},calloutLabel:{enabled:R,offset:W,minAngle:P,avoidCollisions:R,formatter:vi(Hi),format:N,itemStyler:Qe({enabled:R,...Dn,...Ke}),...Dn,...Ke},sectorLabel:{enabled:R,positionOffset:W,positionRatio:ce,formatter:vi(Hi),format:N,itemStyler:Qe({enabled:R,...Dn,...Ke}),...Dn,...Ke},calloutLine:{colors:be(ie),length:P,strokeWidth:P,itemStyler:Qe({color:ie,length:P,strokeWidth:P})},fills:be(ks),strokes:be(ie),tooltip:Ye,shadow:wo,highlight:S1,...ne,...Q(se,["fill"]),...Q(J,["stroke"])},Aa={...kD,...et,type:$(Le("pie")),angleKey:$(N),radiusKey:N,calloutLabelKey:N,sectorLabelKey:N,legendItemKey:N,angleName:N,radiusName:N,calloutLabelName:N,sectorLabelName:N,highlight:S1};Aa.angleFilterKey=ee(N),Aa.defaultColorRange=ee(be(be(ie))),Aa.defaultPatternFills=ee(be(ie)),Aa.title._enabledFromTheme=ee(R),Aa.calloutLabel._enabledFromTheme=ee(R),Aa.sectorLabel._enabledFromTheme=ee(R),Aa.angleKeyAxis=ee(N),Aa.radiusKeyAxis=ee(N);var M1={...kD,innerRadiusOffset:W,innerRadiusRatio:ce,innerCircle:{fill:N,fillOpacity:ce},innerLabels:{spacing:P,...Ke,...Dn}},D1={...M1,...Aa,type:$(Le("donut")),innerLabels:Ft({text:$(N),spacing:P,...Ke,...Dn},"inner label options array")};D1.angleFilterKey=ee(N);var Au={lineStyle:Z("solid","dashed","dotted"),...ne},lh={...se,...J,...ne},Zg={visible:R,locked:R,readOnly:R,handle:lh,...Ke},Ix={position:Z("top","center","bottom"),alignment:Z("left","center","right"),...Ke},I1={position:Z("top","inside","bottom"),alignment:Z("left","center","right"),...Ke},F$={enabled:R,cornerRadius:P,formatter:ct,...Ke,...se,...J,...ne},z$={visible:R,...Au,...J},k1={divider:J,...se,...J,...Ke},A1={handle:lh,statistics:k1,...Au,...se,...J},kx={visible:R,locked:R,readOnly:R,extendStart:R,extendEnd:R,handle:lh,text:Ix,...Au,...J},AD={visible:R,locked:R,readOnly:R,axisLabel:F$,handle:lh,text:Ix,...Au,...J},C1={visible:R,locked:R,readOnly:R,extendStart:R,extendEnd:R,handle:lh,text:I1,background:se,...Au,...J},L1={...C1},w1={...C1,middle:z$},CD={label:Ke,showFill:R,isMultiColor:R,strokes:be(ie),rangeStroke:ie,bands:Z(4,6,10),...kx},T1={...se,...J,...Zg},N1={...se,...J,...Zg},O1={...se,...J,...Zg,background:{...se,...J}},LD={visible:R,locked:R,readOnly:R,handle:lh,...se},Ax={visible:R,locked:R,readOnly:R,extendStart:R,extendEnd:R,handle:lh,text:Ix,background:se,statistics:k1,...Au,...J},E1={visible:R,up:A1,down:A1},Cu={enabled:R,axesButtons:{enabled:R,axes:Z("x","y","xy")},toolbar:{enabled:R,padding:P,buttons:Ft({...er,value:Z("line-menu","fibonacci-menu","text-menu","shape-menu","measurer-menu","line","horizontal-line","vertical-line","parallel-channel","disjoint-channel","fibonacci-retracement","fibonacci-retracement-trend-based","text","comment","callout","note","clear")},"annotation toolbar buttons array")},optionsToolbar:{enabled:R,buttons:be(Ae(Ot({...er,value:$(Z("line-stroke-width","line-style-type","line-color","fill-color","text-color","text-size","delete","settings"))}),Ot({...er,value:$(Z("lock")),checkedOverrides:er})))}};Cu.data=ee(sn),Cu.xKey=ee(N),Cu.volumeKey=ee(N),Cu.snap=ee(R);var Ca={...se,...J,opacity:ce},P1={...se,...J,...ne,cornerRadius:P,whisker:{...J,...ne},cap:{lengthRatio:ce}},R1={...P1,opacity:ce},F1=Qe({...se,...J,...ne,cornerRadius:P,whisker:{...J,...ne},cap:{lengthRatio:ce}}),z1={direction:Z("horizontal","vertical"),showInMiniChart:R,styler:F1,itemStyler:F1,tooltip:Ye,...Je,...P1,highlight:zt(R1,R1),segmentation:ca},wD={cornerRadius:P,wick:{...J,...ne},...se,...J,...ne},B1={...wD,opacity:ce},_1={item:{up:wD,down:wD},itemStyler:Qe({...se,...J,...ne,cornerRadius:P,wick:{...J,...ne}}),showInMiniChart:R,tooltip:Ye,...Je,highlight:zt(B1,B1)},V1={fills:be(ks),strokes:be(ie),label:{spacing:P,maxWidth:P,...ft},link:{tension:ce,itemStyler:Qe({...se,...J,...ne,tension:ce}),...se,...J,...ne},node:{width:P,spacing:P,itemStyler:Qe({...se,...J,...ne}),...se,...J,...ne},tooltip:Ye,...Je},G1={direction:Z("horizontal","vertical"),fills:be(ks),strokes:be(ie),label:{spacing:P,placement:Z("before","middle","after"),...ft},stageLabel:{placement:Z("before","after"),format:nn,...Bl},tooltip:Ye,...Q(Je,["showInLegend"]),...Q(se,["fill"]),...Q(J,["stroke"]),...ne,highlight:Im(Qa)},H1={direction:Z("horizontal","vertical"),fills:be(ks),strokes:be(ie),itemStyler:Qe({...se,...J,...ne}),spacingRatio:ce,crisp:R,dropOff:{enabled:R,...se,...J,...ne},stageLabel:{placement:Z("before","after"),format:nn,...Bl},label:ft,tooltip:Ye,shadow:wo,...Q(Je,["showInLegend"]),...Q(se,["fill"]),...Q(J,["stroke"]),...ne},j1={title:N,textAlign:Z("left","center","right"),verticalAlign:Z("top","middle","bottom"),itemPadding:P,itemStyler:Qe({...se,...J}),showInMiniChart:R,label:ir,tooltip:Ye,...Je,...J},W1={showInMiniChart:R,itemStyler:Qe({...J,...ne}),item:{up:{...J,...ne},down:{...J,...ne}},tooltip:Ye,...Je,highlight:zt(Qa,Qa)},$1={maxStrokeWidth:P,itemStyler:Qe({...J,...ne}),sizeDomain:be(P),label:ft,tooltip:Ye,...Je,...J,...ne,highlight:zt(Qa,Qa)},U1={...J,...ne},K1={colorRange:be(ie),maxSize:P,sizeDomain:be(P),label:{placement:Z("top","bottom","left","right"),...ft},tooltip:Ye,...Je,...Q(so,["enabled"]),highlight:zt(It,It)},Y1={colorRange:be(ie),padding:P,itemStyler:Qe({...se,...J,...ne}),label:ir,tooltip:Ye,...Je,...se,...J,...ne,highlight:zt(It,It)},Z1={...Je,...se,...J,...ne},Lu=Qe({...se,...J,...ne,cornerRadius:P}),X1={cornerRadius:P,styler:Lu,itemStyler:Lu,label:ft,tooltip:Ye,...Je,...se,...J,...ne,highlight:zt(io,io)},q1={direction:Z("horizontal","vertical"),aspectRatio:P,spacing:P,reverse:R,itemStyler:Qe({...se,...J,...ne}),fills:be(ks),strokes:be(ie),label:ft,stageLabel:{spacing:P,placement:Z("before","after"),...ft},tooltip:Ye,shadow:wo,...Je,...Q(se,["fill"]),...Q(J,["stroke"]),...ne},Q1={connectMissingData:R,marker:so,styler:Qe({marker:tr,...se,...J,...ne}),label:ft,tooltip:Ye,...Je,...se,...J,...ne,highlight:zt(It,It)},J1={connectMissingData:R,marker:so,styler:Qe({marker:tr,...J,...ne}),label:ft,tooltip:Ye,...Je,...J,...ne,highlight:zt(It,Qa)},eO={cornerRadius:P,styler:Lu,itemStyler:Lu,label:ft,tooltip:Ye,...Je,...se,...J,...ne,highlight:zt(io,io)},tO={cornerRadius:P,columnWidthRatio:ce,maxColumnWidthRatio:ce,styler:Lu,itemStyler:Lu,label:ft,tooltip:Ye,...Je,...se,...J,...ne,highlight:zt(io,io)},B$={marker:so,...J,...ne},iO={marker:{enabled:R,...tr},...J,...ne},sO={marker:tr,...J,...ne},nO={showInMiniChart:R,connectMissingData:R,interpolation:jp,label:{...ft,placement:Z("inside","outside"),spacing:P},tooltip:Ye,shadow:wo,...Je,...se,...B$,item:{low:{...iO},high:{...iO}},styler:Qe({...se,item:{low:{...sO},high:{...sO}}}),highlight:zt(It,It),segmentation:ca,invertedStyle:{enabled:R,...se}},oO=Qe({...se,...J,...ne,cornerRadius:P}),aO={direction:Z("horizontal","vertical"),grouped:R,showInMiniChart:R,cornerRadius:P,styler:oO,itemStyler:oO,label:{...ft,placement:Z("inside","outside"),spacing:P},tooltip:Ye,shadow:wo,...Je,...se,...J,...ne,highlight:zt(io,io),segmentation:ca},rO={fills:be(ks),strokes:be(ie),label:{...ft,spacing:P,placement:Z("left","right","center"),edgePlacement:Z("inside","outside")},link:{itemStyler:Qe({...se,...J,...ne}),...se,...J,...ne},node:{width:P,spacing:P,minSpacing:Ue(P,OS("spacing")),alignment:Z("left","center","right","justify"),verticalAlignment:Z("top","bottom","center"),sort:Z("data","ascending","descending","auto"),itemStyler:Qe({...se,...J,...ne}),...se,...J,...ne},tooltip:Ye,...Je},lO={fills:be(ks),strokes:be(ie),colorRange:be(ie),sectorSpacing:P,cornerRadius:P,padding:P,itemStyler:Qe({...se,...J}),label:{spacing:P,...ir},secondaryLabel:ir,tooltip:Ye,...Q(Je,["highlight","showInLegend"]),...Q(se,["fill"]),...Q(J,["stroke"]),highlight:{highlightedItem:Ca,highlightedBranch:Ca,unhighlightedItem:Ca,unhighlightedBranch:Ca}},cO={fills:be(ks),strokes:be(ie),colorRange:be(ie),itemStyler:Qe({...se,...J}),group:{gap:P,padding:P,cornerRadius:P,textAlign:Z("left","center","right"),interactive:R,highlight:{highlightedItem:Ca,unhighlightedItem:Ca},label:{...ft,spacing:P},...se,...J},tile:{gap:P,padding:P,cornerRadius:P,textAlign:Z("left","center","right"),verticalAlign:Z("top","middle","bottom"),label:{...ft,spacing:P,lineHeight:P,minimumFontSize:P,wrapping:Z("never","always","hyphenate","on-space"),overflowStrategy:Z("ellipsis","hide")},secondaryLabel:{...ft,lineHeight:P,minimumFontSize:P,wrapping:Z("never","always","hyphenate","on-space"),overflowStrategy:Z("ellipsis","hide")},highlight:{highlightedItem:Ca,highlightedBranch:Ca,unhighlightedItem:Ca,unhighlightedBranch:Ca},...se,...J},tooltip:Ye,...Q(Je,["highlight","showInLegend"])},TD={name:N,cornerRadius:P,itemStyler:Qe({...se,...J,...ne,cornerRadius:P}),label:{...ft,placement:Z("inside-start","inside-center","inside-end","outside-start","outside-end"),spacing:P},tooltip:Ye,shadow:wo,...se,...J,...ne},hO={direction:Z("horizontal","vertical"),showInMiniChart:R,item:{positive:TD,negative:TD,total:TD},line:{enabled:R,...J,...ne},tooltip:Ye,...Je},Cx=Ot({__type:$(Le("date")),value:Ae(N,W)},"a serializable date object"),dO={width:P,height:P,grip:R,fill:ie,stroke:ie,strokeWidth:P,cornerRadius:P},at={enabled:R,height:P,spacing:P,cornerRadius:W,mask:{fill:ie,fillOpacity:ce,stroke:ie,strokeWidth:P},minHandle:dO,maxHandle:dO,miniChart:{enabled:R,padding:{top:P,bottom:P},label:{enabled:R,avoidCollisions:R,spacing:P,format:nn,formatter:vi(Hi),interval:{minSpacing:P,maxSpacing:P,values:sn,step:W},...Ke},series:le}},ch=Q(o1,["type","value","range"]),Ts={number:{...Q(vu,["type","crossLines"]),top:Q(vu,["type","crossLines","position"]),right:Q(vu,["type","crossLines","position"]),bottom:Q(vu,["type","crossLines","position"]),left:Q(vu,["type","crossLines","position"]),crossLines:ch},log:{...Q(Su,["type","crossLines"]),top:Q(Su,["type","crossLines","position"]),right:Q(Su,["type","crossLines","position"]),bottom:Q(Su,["type","crossLines","position"]),left:Q(Su,["type","crossLines","position"]),crossLines:ch},category:{...Q(xu,["type","crossLines"]),top:Q(xu,["type","crossLines","position"]),right:Q(xu,["type","crossLines","position"]),bottom:Q(xu,["type","crossLines","position"]),left:Q(xu,["type","crossLines","position"]),crossLines:ch},time:{...Q(Mu,["type","crossLines"]),top:Q(Mu,["type","crossLines","position"]),right:Q(Mu,["type","crossLines","position"]),bottom:Q(Mu,["type","crossLines","position"]),left:Q(Mu,["type","crossLines","position"]),crossLines:ch},"unit-time":{...Q(Du,["type","crossLines"]),top:Q(Du,["type","crossLines","position"]),right:Q(Du,["type","crossLines","position"]),bottom:Q(Du,["type","crossLines","position"]),left:Q(Du,["type","crossLines","position"]),crossLines:ch},"grouped-category":{...Q(bu,["type"]),top:Q(bu,["type","position"]),right:Q(bu,["type","position"]),bottom:Q(bu,["type","position"]),left:Q(bu,["type","position"]),crossLines:ch},"ordinal-time":{...Q(Iu,["type","crossLines"]),top:Q(Iu,["type","crossLines","position"]),right:Q(Iu,["type","crossLines","position"]),bottom:Q(Iu,["type","crossLines","position"]),left:Q(Iu,["type","crossLines","position"]),crossLines:ch}},wu={"angle-category":{...Q(SD,["type","crossLines"]),crossLines:Q(Lr,["type"])},"angle-number":{...Q(h1,["type","crossLines"]),crossLines:Q(Lr,["type"])},"radius-category":{...Q(u1,["type","crossLines"]),crossLines:{...Q(Lr,["type"]),label:{...mu,positionAngle:W}}},"radius-number":{...Q(d1,["type","crossLines"]),crossLines:{...Q(Lr,["type"]),label:{...mu,positionAngle:W}}}},dt={visible:ee(R)},_$={common:{...we,navigator:at,axes:{...Ts,...wu},annotations:{...Cu,line:kx,"horizontal-line":AD,"vertical-line":AD,"disjoint-channel":L1,"parallel-channel":w1,"fibonacci-retracement":CD,"fibonacci-retracement-trend-based":CD,callout:T1,comment:N1,note:O1,text:Zg,arrow:kx,"arrow-up":LD,"arrow-down":LD,"date-range":Ax,"price-range":Ax,"date-price-range":Ax,"quick-date-price-range":E1},chartToolbar:{enabled:R},initialState:{legend:Ft({visible:R,seriesId:N,itemId:N,legendItemName:N},"legend state array"),zoom:{rangeX:{start:Ae(W,Cx),end:Ae(W,Cx)},rangeY:{start:Ae(W,Cx),end:Ae(W,Cx)},ratioX:{start:ce,end:ce},ratioY:{start:ce,end:ce},autoScaledAxes:be(Le("y"))}}},line:{...we,axes:Ts,series:ID,navigator:at,...dt},scatter:{...we,axes:Ts,series:v1,navigator:at,...dt,paired:ee(R)},bubble:{...we,axes:Ts,series:y1,navigator:at,...dt},area:{...we,axes:Ts,series:g1,navigator:at,...dt},bar:{...we,axes:Ts,series:DD,navigator:at,...dt},"box-plot":{...we,axes:Ts,series:z1,navigator:at,...dt},candlestick:{...we,axes:Ts,series:_1,navigator:at,...dt},"cone-funnel":{...we,axes:Ts,series:G1,navigator:at,...dt},funnel:{...we,axes:Ts,series:H1,navigator:at,...dt},ohlc:{...we,axes:Ts,series:W1,navigator:at,...dt},histogram:{...we,axes:Q(Ts,["category","grouped-category","unit-time","ordinal-time"]),series:x1,navigator:at,...dt},heatmap:{...we,axes:Ts,series:j1,navigator:at,...dt},waterfall:{...we,axes:Ts,series:hO,navigator:at,...dt},"range-bar":{...we,axes:Ts,series:aO,navigator:at,...dt},"range-area":{...we,axes:Ts,series:nO,navigator:at,...dt},donut:{...we,series:M1,navigator:at,...dt},pie:{...we,series:kD,navigator:at,...dt},"radar-line":{...we,axes:wu,series:J1,navigator:at,...dt},"radar-area":{...we,axes:wu,series:Q1,navigator:at,...dt},"radial-bar":{...we,axes:wu,series:eO,navigator:at,...dt},"radial-column":{...we,axes:wu,series:tO,navigator:at,...dt},nightingale:{...we,axes:wu,series:X1,navigator:at,...dt},sunburst:{...we,series:lO,navigator:at,...dt},treemap:{...we,series:cO,navigator:at,...dt},"map-shape":{...we,series:Y1,navigator:at,...dt},"map-line":{...we,series:$1,navigator:at,...dt},"map-marker":{...we,series:K1,navigator:at,...dt},"map-shape-background":{...we,series:Z1,navigator:at,...dt},"map-line-background":{...we,series:U1,navigator:at,...dt},sankey:{...we,series:rO,navigator:at,...dt},chord:{...we,series:V1,navigator:at,...dt},pyramid:{...we,series:q1,navigator:at,...dt},"radial-gauge":{...we,...Qp,targets:Q(Xp,["value"]),tooltip:{...Qp.tooltip,...we.tooltip}},"linear-gauge":{...we,...qp,targets:Q(Zp,["value"]),tooltip:{...qp.tooltip,...we.tooltip}}};function Lx(e,t){const i={};for(const s of Reflect.ownKeys(e))i[s]=t(e[s],s,e);return i}var V$=Lx(_$,function e(t,i){if(sd(i))return t;if(Co(t))return Ae(t,hd,sd);if(fe(t))return Ae(Ot(ld in t?Lx(t,s=>fe(s)?Lx(s,e):s):Lx(t,e)),hd,sd);throw new Error(`Invalid theme override value: ${String(t)}`)}),ps={BLUE:"#0083ff",ORANGE:"#ff6600",GREEN:"#00af00",CYAN:"#00ccff",YELLOW:"#f7c700",VIOLET:"#ac26ff",GRAY:"#a7a7b7",MAGENTA:"#e800c5",BROWN:"#b54300",RED:"#ff0000"},hh={BLUE:"#67b7ff",ORANGE:"#ffc24d",GREEN:"#5cc86f",CYAN:"#54ebff",VIOLET:"#fff653",YELLOW:"#c18aff",GRAY:"#aeaeae",MAGENTA:"#f078d4",BROWN:"#ba8438",RED:"#ff726e"},G$=class extends fu{getDefaultColors(){return{fills:ps,fillsFallback:Object.values(ps),strokes:hh,sequentialColors:uo(ps),divergingColors:[ps.ORANGE,ps.YELLOW,ps.GREEN],hierarchyColors:[],secondSequentialColors:["#0083ff","#0076e6","#0069cc","#005cb3","#004f99","#004280","#003466","#00274c"],secondDivergingColors:[ps.GREEN,ps.YELLOW,ps.RED],secondHierarchyColors:[],up:{fill:ps.GREEN,stroke:hh.GREEN},down:{fill:ps.RED,stroke:hh.RED},neutral:{fill:ps.GRAY,stroke:hh.GRAY},altUp:{fill:ps.BLUE,stroke:hh.BLUE},altDown:{fill:ps.ORANGE,stroke:hh.ORANGE},altNeutral:{fill:ps.GRAY,stroke:hh.GRAY}}}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(As,ps.BLUE),e.set(os,ps.BLUE),e}},gs={BLUE:"#0083ff",ORANGE:"#ff6600",GREEN:"#00af00",CYAN:"#00ccff",YELLOW:"#f7c700",VIOLET:"#ac26ff",GRAY:"#a7a7b7",MAGENTA:"#e800c5",BROWN:"#b54300",RED:"#ff0000"},dh={BLUE:"#0f68c0",ORANGE:"#d47100",GREEN:"#007922",CYAN:"#009ac2",VIOLET:"#bca400",YELLOW:"#753cac",GRAY:"#646464",MAGENTA:"#9b2685",BROWN:"#6c3b00",RED:"#cb0021"},H$=class extends $o{getDefaultColors(){return{...super.getDefaultColors(),fills:gs,fillsFallback:Object.values(gs),strokes:dh,sequentialColors:uo(gs),divergingColors:[gs.ORANGE,gs.YELLOW,gs.GREEN],hierarchyColors:[],secondSequentialColors:["#0083ff","#1a8fff","#339cff","#4da8ff","#66b5ff","#80c1ff","#99cdff","#b3daff"],secondDivergingColors:[gs.GREEN,gs.YELLOW,gs.RED],secondHierarchyColors:[],up:{fill:gs.GREEN,stroke:dh.GREEN},down:{fill:gs.RED,stroke:dh.RED},neutral:{fill:gs.GRAY,stroke:dh.GRAY},altUp:{fill:gs.BLUE,stroke:dh.BLUE},altDown:{fill:gs.ORANGE,stroke:dh.ORANGE},altNeutral:{fill:gs.GRAY,stroke:dh.GRAY}}}getTemplateParameters(){const e=super.getTemplateParameters();return e.set(As,gs.BLUE),e.set(os,gs.BLUE),e}},ND=ji(()=>new $o),j$=Me.create(!0,"perf"),Uo=(e,t,i)=>{j$("[CACHE] ChartTheme",e,t.name,i)},OD={"ag-default-dark":ji(()=>new fu),"ag-sheets-dark":ji(()=>new N$,Uo),"ag-polychroma-dark":ji(()=>new w$,Uo),"ag-vivid-dark":ji(()=>new G$,Uo),"ag-material-dark":ji(()=>new C$,Uo),"ag-financial-dark":ji(()=>new k$,Uo),"ag-default":ND,"ag-sheets":ji(()=>new O$,Uo),"ag-polychroma":ji(()=>new T$,Uo),"ag-vivid":ji(()=>new H$,Uo),"ag-material":ji(()=>new L$,Uo),"ag-financial":ji(()=>new A$,Uo)},wx=ji(W$,Uo);function W$(e){if(e instanceof $o)return e;if(!Y$(e))return ND();if(e==null||typeof e=="string"){const n=OD[e??"ag-default"];if(n)return n();throw new Error(`Cannot find theme \`${e}\`.`)}const{cleared:t,invalid:i}=Ei($$(e),U$,"theme");for(const n of i)j.warnOnce(String(n));const s=t?.baseTheme?wx(t.baseTheme):ND();return t?new s.constructor(t):s}function $$(e){if(!fe(e)||!fe(e.baseTheme))return e;let t=e,i,s;const n=[];for(;typeof t=="object";)i??(i=t.palette),s??(s=t.params),t.overrides&&n.push(t.overrides),t=t.baseTheme;return{baseTheme:t,overrides:oe(...n),params:s,palette:i}}var U$={baseTheme:Ae(N,Xa),overrides:V$,params:{accentColor:ie,axisColor:ie,backgroundColor:ie,borderColor:ie,borderRadius:W,chartBackgroundColor:ie,chartPadding:W,focusShadow:N,foregroundColor:ie,fontFamily:Vp,fontSize:W,fontWeight:Ae(N,W),gridLineColor:ie,popupShadow:N,subtleTextColor:ie,textColor:ie,separationLinesColor:ie,chromeBackgroundColor:ie,chromeFontFamily:Vp,chromeFontSize:W,chromeFontWeight:Ae(N,W),chromeSubtleTextColor:ie,chromeTextColor:ie,buttonBackgroundColor:ie,buttonBorder:R,buttonFontWeight:W,buttonTextColor:ie,inputBackgroundColor:ie,inputBorder:R,inputTextColor:ie,menuBackgroundColor:ie,menuBorder:R,menuTextColor:ie,panelBackgroundColor:ie,panelSubtleTextColor:ie,tooltipBackgroundColor:ie,tooltipBorder:R,tooltipTextColor:ie,tooltipSubtleTextColor:ie,crosshairLabelBackgroundColor:ie,crosshairLabelTextColor:ie},palette:{fills:be(ks),strokes:be(ie),up:{fill:Ae(ie,Fp),stroke:ie},down:{fill:Ae(ie,Fp),stroke:ie},neutral:{fill:Ae(ie,Fp),stroke:ie}}},K$=Z("ag-default","ag-default-dark","ag-sheets","ag-sheets-dark","ag-polychroma","ag-polychroma-dark","ag-vivid","ag-vivid-dark","ag-material","ag-material-dark","ag-financial","ag-financial-dark");function Y$(e){const{invalid:t}=Ei({theme:e},{theme:Ae(K$,Xa)});for(const i of t)j.warnOnce(String(i));return t.length===0}var ni="path",po="pathArray",di="default",go="override",Ko="user",Vl="userPartial",Tu="operation",Nu="operationValue",ED="dependency",PD="autoEnable",uO="autoEnableValue",pO="prune",gO="childrenSource";function RD(e){return gt(e)&&e>=0&&e<=1}function Xg(e,t){let i=e;for(const s of t){if(!(typeof s=="string"&&i!=null&&(typeof i=="object"||Array.isArray(i))&&s in i))return!1;i=i[s]}return!0}function Ns(e,t){let i=e;for(const s of t){if(!(typeof s=="string"&&i!=null&&(typeof i=="object"||Array.isArray(i))&&s in i))return;i=i[s]}return i}function Ou(e,t,i){const s=t.length;if(s===0)return;let n=e;const o=s-1,a=t[o];for(let r=0;r<o;r++){const l=t[r],c=t[r+1];let h=n[l];(h==null||!td(h))&&(h=Number.isNaN(Number(c))?{}:[],n[l]=h),n=h}n[a]=i}var Z$=/^\d+$/;function X$(e,t=0){let i=0;for(let s=e.length-1;s>=0;s--){const n=e[s];if(Z$.test(n)&&(i++,i>t))return s}return-1}function Eu(e,t=0){const i=X$(e,t);return Number(e[i])}function Gl(e,t,i){const s=t.split("/");let n=[...e];t.startsWith("/")&&(n=[],s.shift());let o=!1;for(const a of s){if(a==="..")n.pop(),o||n.pop();else if(a===".")n.pop();else if(a==="$index"){const r=Eu(e);if(Number.isNaN(r))return Yo;n.push(`${r}`)}else if(a==="$prevIndex"){const r=Eu(e);if(Number.isNaN(r)||Number(r)<=0)return Yo;n.push(`${Number(r)-1}`)}else if(a.startsWith("$")){const r=i?.[a.slice(1)];if(r==null)return Yo;n.push(r)}else a.length!==0&&n.push(a);o=a===".."}return n}var Yo=Symbol("unresolvable-path"),Fn=Symbol("resolved-to-branch");function qg(e,t){if(e==null||typeof e!="object"||Array.isArray(e)||(t??(t=Object.keys(e)),t.length===0))return;const i=t[0];if(xO.has(i))return{operation:i,values:Array.isArray(e[i])?e[i]:[e[i]]}}function q$(e,t,i){const s=qg(e.getVertexValue(i));switch(s?.operation){case"$path":{const[n]=s.values,o=e.getPathArray(t),a=Gl(o,n);return a===Yo?void 0:e.findVertexAtPath(a)}case"$value":return t}}var Q$={$cacheMax:J$};function J$(e,t,i){const[s]=i,n=e.getPathArray(t),o=e.getCachedValue(n,"$cacheMax"),a=e.resolveVertexValue(t,s);if(typeof a!="number")return o;if(typeof o!="number")return e.setCachedValue(n,"$cacheMax",a),a;const r=Math.max(o,a);return e.setCachedValue(n,"$cacheMax",r),r}var eU={$hasSeriesType:{dependencies:FD,resolve:tU},$isChartType:{dependencies:FD,resolve:sU},$isSeriesType:{dependencies:FD,resolve:iU}};function FD(e,t,i){const s=e.findVertexAtPath(["series","0","type"]);s&&e.addEdge(t,s,ED)}function tU(e,t,i){const[s]=i,n=e.resolveVertexValue(t,s),o=e.getResolvedPath(["series"]);if(!Array.isArray(o))return!1;for(const a of o)if(a.type===n)return!0;return!1}function iU(e,t,i){const[s]=i,n=e.resolveVertexValue(t,s);return e.getResolvedPath(["series","0","type"])===n}function sU(e,t,i){const[s]=i,n=e.resolveVertexValue(t,s),o=e.getResolvedPath(["series","0","type"]);if(typeof o!="string")return!1;const a=me.getSeriesModule(o);if(a==null)return!1;switch(n){case"cartesian":return a.chartType==="cartesian";case"polar":return a.chartType==="polar";case"standalone":return a.chartType==="standalone"}return!1}var nU={$foregroundBackgroundMix:oU,$foregroundOpacity:aU,$interpolate:rU,$isGradient:lU,$isImage:cU,$isPattern:hU,$mix:dU};function oU(e,t,i){const[s]=i,n=e.resolveVertexValue(t,s),o=e.getParamValue("foregroundColor"),a=e.getParamValue("backgroundColor");if(typeof o=="string"&&typeof a=="string"&&RD(n))return Be.mix(Be.fromString(o),Be.fromString(a),1-n).toString();Me.inDevelopmentMode(()=>j.warnOnce(`\`$foregroundBackgroundMix\` json operation failed on [${String(n)}}}] at [${e.getPathArray(t).join(".")}], expecting a number between 0 and 1.`))}function aU(e,t,i){const[s]=i,n=e.resolveVertexValue(t,s),o=e.getParamValue("foregroundColor");if(typeof o=="string"&&RD(n)){const a=Be.fromString(o);return new Be(a.r,a.g,a.b,n).toString()}Me.inDevelopmentMode(()=>j.warnOnce(`\`$foregroundOpacity\` json operation failed on [${String(n)}}}] at [${e.getPathArray(t).join(".")}], expecting a number between 0 and 1.`))}function rU(e,t,i){const[s,n]=i,o=e.resolveVertexValue(t,s),a=e.resolveVertexValue(t,n);if(!(!Ce(o)||!gt(a)))return Be.interpolate(o.map(r=>Be.fromString(r)),a).map(r=>r.toString())}function lU(e,t,i){const[s]=i,n=e.resolveVertexValue(t,s);return Ut(n)}function cU(e,t,i){const[s]=i,n=e.resolveVertexValue(t,s);return zo(n)}function hU(e,t,i){const[s]=i,n=e.resolveVertexValue(t,s);return Tn(n)}function dU(e,t,i){const[s,n,o]=i,a=e.resolveVertexValue(t,s),r=e.resolveVertexValue(t,n),l=e.resolveVertexValue(t,o),c=e.getPathArray(t),h=`\`$mix\` json operation failed on [${String(a)}, ${String(r)}, ${String(l)}] at [${c.join(".")}], expecting`,d=`${h} two colors and a number between 0 and 1.`;if(typeof r!="string"||!RD(l)){Me.inDevelopmentMode(()=>j.warnOnce(d));return}if(typeof a=="string")try{return Be.mix(Be.fromString(a),Be.fromString(r),l).toString()}catch{Me.inDevelopmentMode(()=>j.warnOnce(d));return}if(!Ut(a)){Me.inDevelopmentMode(()=>j.warnOnce(d));return}let u=a.colorStops;try{u=u?.map(p=>{let f;return typeof p.color=="string"&&(f=Be.mix(Be.fromString(p.color),Be.fromString(r),l).toString()),{...p,color:f}})}catch{Me.inDevelopmentMode(()=>j.warnOnce(`${h} a gradient, a color and a number between 0 and 1.`));return}return{...a,colorStops:u}}var uU={$rem:pU};function pU(e,t,i){const[s]=i,n=e.getVertexValue(s),o=e.getParamValue("fontSize");if(typeof o=="number"&&typeof n=="number")return Math.round(n*o);Me.inDevelopmentMode(()=>j.warnOnce(`\`$rem\` json operation failed on [${String(n)}] at [${e.getPathArray(t).join(".")}], expecting a number.`))}var gU={$and:fU,$eq:mU,$greaterThan:yU,$if:xU,$lessThan:bU,$not:vU,$or:SU,$switch:MU};function fU(e,t,i){for(const s of i)if(!e.resolveVertexValue(t,s))return!1;return!0}function mU(e,t,i){let s,n=!0;for(const o of i){const a=e.resolveVertexValue(t,o);if(n)s=a,n=!1;else if(a!==s)return!1}return!0}function yU(e,t,i){const[s,n]=i;return e.resolveVertexValue(t,s)>e.resolveVertexValue(t,n)}function xU(e,t,i){const[s,n,o]=i,r=e.resolveVertexValue(t,s)?n:o,l=e.neighboursWithEdgeValue(r,ni);if(l)for(const c of l)e.addEdge(t,c,ni);return e.resolveVertexValue(t,r)}function bU(e,t,i){const[s,n]=i;return e.resolveVertexValue(t,s)<e.resolveVertexValue(t,n)}function vU(e,t,i){const[s]=i;if(s)return!e.resolveVertexValue(t,s)}function SU(e,t,i){for(const s of i)if(e.resolveVertexValue(t,s))return!0;return!1}function MU(e,t,i){const[s,n,...o]=i,a=e.resolveVertexValue(t,s);for(const r of o){const l=e.getVertexValue(r);if(!Array.isArray(l))continue;const[c,h]=l;if(a===c||Array.isArray(c)&&c.includes(a))return h}return e.resolveVertexValue(t,n)}var DU={$isUserOption:IU,$isThemeOverride:kU,$palette:AU,$mapPalette:CU,$path:{dependencies:yO,resolve:LU},$pathString:{dependencies:yO,resolve:wU},$ref:TU};function IU(e,t,i){const[s,n,o]=i,a=e.neighboursWithEdgeValue(s,ni);if(a)for(const r of a){const l=e.findNeighbour(r,di);if(l&&fO(e,t,l))return e.resolveVertexValue(t,n)}else if(fO(e,t,s))return e.resolveVertexValue(t,n);return e.resolveVertexValue(t,o)}function fO(e,t,i){const s=e.resolveVertexValue(t,i);if(!Rt(s))throw new Error(`\`$isUserOption\` json operation failed on [${String(s)}], expecting a string.`);const n=e.getPathArray(t),o=Gl(n,s);return o===Yo?!1:e.hasUserOption(o)}function kU(e,t,i){const[s,n,o]=i,a=e.resolveVertexValue(t,s);if(!Rt(a))throw new Error(`\`$isThemeOverride\` json operation failed on [${String(a)}], expecting a string.`);const r=e.getPathArray(t),l=Gl(r,a);if(l!==Yo)return e.hasThemeOverride(l)?e.resolveVertexValue(t,n):e.resolveVertexValue(t,o)}var mO=new Set(["fill","fillFallback","stroke","gradient","range2"]);function AU(e,t,i){const[s]=i,n=e.resolveVertexValue(t,s);if(!Rt(n))return;if(mO.has(n)){const a=e.getPathArray(t),r=Eu(a);if(Number.isNaN(r))return;switch(n){case"fill":return qn(e.palette.fills,1,r)[0];case"fillFallback":return qn(e.palette.fillsFallback,1,r)[0];case"stroke":return qn(e.palette.strokes,1,r)[0];case"gradient":return qn(e.palette.sequentialColors,1,r)[0];case"range2":return qn(e.palette.fills,2,r)}return}if(n==="gradients")return e.palette.sequentialColors;if(n==="type")return e.paletteType;const o=Ns(e.palette,n.split("."));return Array.isArray(o)?[...o]:typeof o=="object"?{...o}:o}function CU(e,t,i){const[s]=i,n=e.resolveVertexValue(t,s);if(!Rt(n))return;if(mO.has(n)){const a=e.getPathArray(t);let r=Eu(a),l=0;const c=["series","0","type"];for(let h=0;h<r;h++){c[1]=`${h}`;const d=e.getResolvedPath(c);(d==="map-shape-background"||d==="map-line-background")&&l++}if(r-=l,Number.isNaN(r))return;switch(n){case"fill":return qn(e.palette.fills,1,r)[0];case"fillFallback":return qn(e.palette.fillsFallback,1,r)[0];case"stroke":return qn(e.palette.strokes,1,r)[0];case"gradient":return qn(e.palette.sequentialColors,1,r)[0];case"range2":return qn(e.palette.fills,2,r)}return}if(n==="gradients")return e.palette.sequentialColors;if(n==="type")return e.paletteType;const o=Ns(e.palette,n.split("."));return Array.isArray(o)?[...o]:typeof o=="object"?{...o}:o}function yO(e,t,i){const[s]=i,n=e.getVertexValue(s);if(Rt(n)){const o=e.getPathArray(t),a=Gl(o,n);if(a===Yo)return;const r=e.findVertexAtPath(a);r&&e.addEdge(t,r,ED)}}function LU(e,t,i){const s=i.length>1,n=i.length>2,[o,a,r]=i,l=e.resolveVertexValue(t,o),c=n?e.resolveVertexValue(t,r):null;if(!Rt(l))throw new Error(`\`$path\` json operation failed on [${String(l)}], expecting a string.`);const h=e.getPathArray(t),d=Gl(h,l);if(d===Yo)return;const u=c?Ns(c,d):e.getResolvedPath(d);if(u!=null)return u;if(s)return e.resolveVertexValue(t,a)}function wU(e,t,i){const[s,n]=i,o=e.resolveVertexValue(t,s);if(!Rt(o))throw new Error(`\`$path\` json operation failed on [${String(o)}], expecting a string.`);let a;n&&(a=e.graftAndResolveOrphan(t,n));const r=e.getPathArray(t),l=Gl(r,o,a);if(l===Yo)throw new Error(`Unresolvable path [${o}] at [${r.join(".")}]`);return l}function TU(e,t,i){const[s]=i,n=e.getVertexValue(s);return e.getParamValue(n)}var NU={$apply:OU,$applyCycle:EU,$applySwitch:PU,$applyTheme:RU,$findFirstSiblingNotOperation:FU,$map:zU,$merge:BU,$omit:_U,$size:VU,$shallow:HU,$shallowSimple:GU,$value:jU};function OU(e,t,i){const[s,n,o,a]=i,r=e.getVertexValue(s);if(!st(r))return;const l=n?e.getVertexValue(n):void 0,c=e.neighboursWithEdgeValue(t,ni),h=c&&c.length>0;if(!h&&l==null)return Fn;const d=o?e.resolveVertexValue(t,o):void 0,u=a?e.resolveVertexValue(t,a):void 0;if(!h&&l!=null)if(qg(l)){const p=e.resolveVertexValue(t,n);st(p)&&e.graftObject(t,p,[d,u])}else e.graftObject(t,l,[d,u]);if(!h)return Fn;for(const p of c){const f=e.neighboursWithEdgeValue(p,ni);if(!f||f.length===0){const y=e.addVertex({});e.addEdge(p,y,di)}else e.graftObject(p,r,[d,u])}return Fn}function EU(e,t,i){const[s,n,o]=i,a=e.resolveVertexValue(t,s);if(typeof a!="number")return;const r=e.getPathArray(t),l=e.dangerouslyGetUserOption(r),c=e.hasThemeOverride(r),h=l==null?void 0:Ko,d=l??e.resolveVertexValue(t,n);if(!Array.isArray(d))return;const u=o?e.getVertexValue(o):void 0;for(let p=0;p<a;p++){const f=d[p%d.length];f!=null&&((l||!c)&&e.graftValue(t,`${p}`,f,void 0,h),u&&e.graftValue(t,`${p}`,u,f,h))}return Fn}function PU(e,t,i){const[s,n,...o]=i,a=e.resolveVertexValue(t,s);for(const r of o){const l=e.getVertexValue(r);if(!Array.isArray(l))continue;const[c,h]=l;if(a===c||Array.isArray(c)&&c.includes(a))return e.graftObject(t,h,[],di),Fn}return e.resolveVertexValue(t,n)}function RU(e,t,i){const[s,n,o]=i;let a=e.getVertexValue(s);if(typeof a=="string"&&(a=[a]),!Array.isArray(a))return;const r=e.neighboursWithEdgeValue(t,ni),l=o?e.getVertexValue(o):[],c=Array.isArray(l)?new Set(l):new Set;if(!r)return Fn;for(const h of r){const d=e.graftAndResolveOrphan(h,n);for(const u of a){const p=Gl([],u,d);p!==Yo&&e.graftConfig(h,p,c)}}return Fn}function FU(e,t,i){const[s]=i,n=e.getPathArray(t),o=Gl(n,"..");if(o===Yo)return;const a=e.findVertexAtPath(o);if(!a)return e.resolveVertexValue(t,s);const r=e.neighboursWithEdgeValue(a,ni);if(r)for(let l=0;l<r.length;l++){const c=e.getPathArray(r[l]);if(c[o.length]===n[o.length])continue;const h=c.concat(n.slice(o.length+1)),d=e.findVertexAtPath(h);if(!d)continue;const u=e.findNeighbourValue(d,Ko);if(u!=null)return u;const p=e.findNeighbourValue(d,go);if(p!=null)return p}return e.resolveVertexValue(t,s)}function zU(e,t,i){const[s,n]=i,o=e.getVertexValue(s),a=e.resolveVertexValue(t,n);if(!Array.isArray(a))return;const r=e.neighboursWithEdgeValue(t,ni);if(r&&r.length>0)return;let l=0;for(const c of a)e.graftValue(t,`${l}`,o,c),l++;return Fn}function BU(e,t,i){for(const s of i){const n=e.resolveVertexValue(t,s);st(n)&&e.graftObject(t,n)}return Fn}function _U(e,t,i){const[s,n]=i;let o=e.getVertexValue(s);if(!Array.isArray(o)){const r=q$(e,t,n);if(!r)return;o=e.resolveVertexValue(r,s)}const a=e.resolveVertexValue(t,n);if(!(!Array.isArray(o)||!st(a)))return Q(a,o)}function VU(e,t,i){const[s]=i,n=e.resolveVertexValue(t,s);return td(n)?"length"in n?n.length:Object.keys(n).length:0}function GU(e,t,i){const s=[];for(const n of i)s.push(e.getVertexValue(n));return s}function HU(e,t,i){const s=e.getPathArray(t),n=e.hasUserOption(s);if(!n&&i.length===1)return e.resolveVertexValue(t,i[0]);const o=[];for(const a of i)o.push(e.getVertexValue(a));return n?(e.prune(t,[go,di]),Fn):(e.graftObject(t,o),Fn)}function jU(e,t,i){const[s]=i,n=e.getVertexValue(s),o=e.getPathArray(t);if(n==="$index")return Eu(o);if(n==="$parentIndex")return Eu(o,1);if(n==="$1")return e.resolveValue$1(o)}var WU={$isEven:$U,$mul:UU,$round:KU};function $U(e,t,i){const[s]=i,n=e.resolveVertexValue(t,s);return Number.isNaN(Number(n))?!1:Number(n)%2===0}function UU(e,t,i){let s;for(const n of i){const o=e.resolveVertexValue(t,n);s==null?s=Number(o):s*=Number(o)}return s}function KU(e,t,i){const[s]=i;if(s)return Math.round(Number(e.resolveVertexValue(t,s)))}var Qg={...Q$,...eU,...nU,...uU,...DU,...gU,...WU,...NU},xO=new Set(Object.keys(Qg));function Jg(e){return xO.has(e)}var Mt=Me.create("opts","options-graph"),YU=ji(ZU);function ZU(e,t){return Mt.group("OptionsGraph.constructor()",()=>new bO(e.config,t,e.params,e.palette,e.overrides,e.getTemplateParameters()))}var Hl=class es extends v0{constructor(t={},i={},s=void 0,n={},o=void 0,a=new Map){super(ni,Tu,new Set([Vl,Ko])),this.config=t,this.userOptions=i,this.palette=n,this.overrides=o,this.internalParams=a,this.edgePriority=[...es.EDGE_PRIORITY],this.graftEdge=es.GRAFT_EDGE,this.resolvedParams={},this.resolvedAnnotations={},this.value$1=new Map,this.cachedPathVertices=new Map,this.hasUnsafeClearKeys=!1,this.rollbackVertices=[],this.rollbackEdgesFrom=[],this.rollbackEdgesTo=[],this.rollbackEdgesValue=[],this.isRollingBack=!1,this.EMPTY_PATH_ARRAY_VERTEX=this.addVertex([]),this.root=this.addVertex("root"),this.params=this.addVertex("params"),this.annotations=this.addVertex("annotations"),this.paletteType=fe(i?.theme)?XN(i.theme?.palette):"inbuilt";const r=i.series?.[0]?.type??"line";Mt("build user"),this.buildGraphFromObject(this.root,Ko,Q(i,["theme"])),Mt("build defaults"),this.buildGraphFromObject(this.root,di,Q(t[r],es.COMPLEX_KEYS));const l=o?Q(o[r],es.COMPLEX_KEYS):{};Object.keys(l).length>0&&(Mt("build series overrides"),this.buildGraphFromObject(this.root,go,l));const c=o?Q(o.common,es.COMPLEX_KEYS):{};Object.keys(c).length>0&&(Mt("build common overrides"),this.buildGraphFromObject(this.root,go,me.getSeriesModule(r)?.chartType==="cartesian"?c:Q(c,["zoom","navigator"]))),s&&(Mt("build params"),this.buildGraphFromObject(this.params,di,s));const h=this.findNeighbourWithValue(this.root,"axes",ni),d=this.findNeighbourWithValue(this.root,"series",ni);h&&(Mt("build axes"),this.buildGraphFromObject(h,di,{$applyTheme:[["/$seriesType/axes/$axisType/$position","/$seriesType/axes/$axisType"],{seriesType:{$path:["/series/0/type","line"]},axisType:{$path:["./type","category"]},position:{$path:["./position"]}},["top","right","bottom","left"]]})),d&&(Mt("build series"),this.buildGraphFromObject(d,di,{$applyTheme:["/$seriesType/series",{seriesType:{$path:["./type","line"]}}]}));const u=Q(t[r]?.annotations??{},es.ANNOTATIONS_OPTIONS_KEYS);Object.keys(u).length>0&&(Mt("build annotations type config"),this.buildGraphFromObject(this.annotations,di,u));const p=Q(o?.common?.annotations??{},es.ANNOTATIONS_OPTIONS_KEYS);Object.keys(p).length>0&&(Mt("build annotations type overrides"),this.buildGraphFromObject(this.annotations,go,p));const f=Kp(t[r]?.annotations??{},es.ANNOTATIONS_OPTIONS_KEYS);Object.keys(f).length>0&&(Mt("build annotations config"),this.buildGraphFromObject(this.root,di,{annotations:f}));const y=Kp(o?.common?.annotations??{},es.ANNOTATIONS_OPTIONS_KEYS);Object.keys(y).length>0&&(Mt("build annotations overrides"),this.buildGraphFromObject(this.root,go,{annotations:y})),this.buildDependencyGraph()}static clearValueCache(){es.valueCache.clear()}clear(){Mt.group("OptionsGraph.clear()",()=>{super.clear(),this.cachedPathVertices.clear(),this.root=void 0,this.params=void 0,this.annotations=void 0,Mt("cleared")})}clearSafe(){this.hasUnsafeClearKeys||this.clear()}resolve(){return Mt.group("OptionsGraph.resolve()",()=>(this.resolved={},this.resolvedParams={},this.resolvedAnnotations={},Mt("resolve params"),this.resolveVertex(this.params,this.resolvedParams),Mt("resolve annotations"),this.resolveVertex(this.annotations,this.resolvedAnnotations),Mt("resolve root"),this.resolveVertex(this.root),Mt("resolved root",this.resolved),Mt("vertex count",this.getVertexCount()),Mt("edge count",this.getEdgeCount()),this.resolved))}resolveParams(){return this.resolvedParams}resolveAnnotationThemes(){return this.resolvedAnnotations}addVertex(t){const i=super.addVertex(t);return this.isRollingBack&&this.rollbackVertices.push(i),i}addEdge(t,i,s){const n=(this.neighboursWithEdgeValue(t,s)?.indexOf(i)??-1)!==-1;this.isRollingBack&&!n&&(this.rollbackEdgesFrom.push(t),this.rollbackEdgesTo.push(i),this.rollbackEdgesValue.push(s)),super.addEdge(t,i,s)}resolvePartial(t,i,s){if(!i||!this.root)return;const{permissivePath:n,proxyPaths:o}=s??{},a=Object.keys(i);if(Mt.check()&&console.groupCollapsed(`OptionsGraph.resolvePartial() - ${t.join(".")} [${a}]`),a.length===0)return{};const r=this.findVertexAtPath(t);if(!r){if(n)return;throw new Error(`Could not find vertex in OptionsGraph at path [${t.join(".")}].`)}const l=this.findNeighbour(r,po);if(this.userPartialOptions={},Ou(this.userPartialOptions,t,i),o)for(const p of Object.keys(o)){const f=o[p],y=Ns(i,[p]);y!=null&&(Ou(i,f,y),Ou(this.userPartialOptions,[...t,...f],y),delete i[p],delete this.userPartialOptions[p])}this.graftEdge=Vl,this.edgePriority=[Vl,...es.EDGE_PRIORITY],this.snapshot(),this.buildGraphFromObject(r,Vl,i,l);for(const p of a){const f=o?.[p]?this.findVertexAtPath([...t,...o[p]]):this.findNeighbourWithValue(r,p,ni);f&&this.refreshPendingProcessingEdges(f)}this.buildDependencyGraph();const c={};if(this.resolveVertex(r,c),this.rollback(),this.graftEdge=es.GRAFT_EDGE,this.edgePriority=es.EDGE_PRIORITY,this.userPartialOptions=void 0,o)for(const p of Object.keys(o)){const f=o[p],y=Ns(c,[...t,...f]);Ou(c,[...t,p],y)}const h=Ns(c,t),u=s?.pick??!0?Kp(Ns(c,t),a):h;return Mt("vertex count",this.getVertexCount()),Mt("edge count",this.getEdgeCount()),Mt("resolved partial",u),Mt.check()&&console.groupEnd(),u}findVertexAtPath(t){const i=t.join(".");if(this.cachedPathVertices.has(i))return this.cachedPathVertices.get(i);const s=this.findVertexAlongEdge(this.root,t,ni);if(s)return this.cachedPathVertices.set(i,s),s}hasUserOption(t){if(Xg(this.userOptions,t))return!0;const s=this.findVertexAtPath(t);if(s){if(this.findNeighbour(s,Ko)!=null||this.findNeighbour(s,Vl)!=null)return!0;const n=this.findNeighbourValue(s,gO);return n===Ko||n===Vl}return!1}dangerouslyGetUserOption(t){if(this.userPartialOptions){const i=Ns(this.userPartialOptions,t);if(i!=null)return i}return Ns(this.userOptions,t)}hasThemeOverride(t){if(this.overrides==null)return!1;if(t[0]==="axes"&&t.length>1){const i=this.getResolvedPath(["axes",t[1],"type"]);if(Xg(this.overrides,["common","axes",i,...t.slice(2)]))return!0;const s=this.getResolvedPath(["series","0","type"]);return Xg(this.overrides,[s,"axes",i,...t.slice(2)])}if(t[0]==="series"&&t.length>1){const i=this.getResolvedPath(["series",t[1],"type"]);return Xg(this.overrides,[i,"series",...t.slice(2)])}return Xg(this.overrides,t)}getParamValue(t){if(this.resolvedParams[t]!=null)return this.resolvedParams[t];const i=this.findVertexAlongEdge(this.params,[t],ni);if(!i)return;const s=this.findNeighbour(i,di);if(!s)return;const n=this.resolveVertexValue(i,s);return this.resolvedParams[t]=n,n}getPathArray(t){return this.findNeighbourValue(t,po)??[]}getResolvedPath(t){return Ns(this.resolved,t)}getCachedValue(t,i){const s=[...t,i].join(".");return es.valueCache.get(s)}setCachedValue(t,i,s){const n=[...t,i].join(".");es.valueCache.set(n,s)}prune(t,i){this.addEdge(t,this.addVertex(i),pO)}resolveVertexValue(t,i){this.resolveVertexDependencies(i);const s=this.findNeighbourValue(i,Tu);if(s&&Jg(s)){const o=this.neighboursWithEdgeValue(i,Nu),a=Qg[s],l=(typeof a=="function"?a:a.resolve)?.(this,t,o??[]);return l===Fn?void 0:l}let n=this.getVertexValue(i);if(Array.isArray(n)){const o={};this.resolveVertexChildren(i,o),n=Ns(o,this.getPathArray(t))}return this.resolveValueOrSymbol(n)}resolveValue$1(t){for(let i=t.length;i>=0;i--){const s=t.slice(0,i).join("."),n=this.value$1.get(s);if(n!=null)return n}}graftConfig(t,i,s){const n=Ns(this.config,i),o=this.findNeighbour(t,po);if(fe(n)&&this.buildGraphFromObject(t,di,n,o,void 0,s),this.overrides){const a=Ns(this.overrides,i);fe(a)&&this.buildGraphFromObject(t,go,a,o,void 0,s);const r=Ns(this.overrides,["common",...i.slice(1)]);fe(r)&&this.buildGraphFromObject(t,go,r,o,void 0,s)}this.buildDependencyGraph()}graftObject(t,i,s,n=this.graftEdge){const o=this.findNeighbour(t,po);if(this.buildGraphFromObject(t,n,i,o),this.overrides&&s)for(const a of s){if(a==null)continue;const r=Ns(this.overrides,a);r&&this.buildGraphFromObject(t,go,r,o)}this.buildDependencyGraph()}graftValue(t,i,s,n,o=this.graftEdge){const a=[...this.getPathArray(t),i];this.value$1.set(a.join("."),n);const r=this.findVertexAtPath(a)??this.addVertex(i);this.buildGraphFromValue(t,r,o,a,s),this.buildDependencyGraph()}graftAndResolveOrphan(t,i){const s={},n=this.addVertex(s),o=this.getPathArray(t);return this.graftAndResolveChildren(i,n,o,[]),this.resolveVertex(n,s),Ns(s,o)}buildGraphFromObject(t,i,s,n,o=es.SHALLOW_KEYS,a){const r=Object.keys(s),l=qg(s,r);if(l){const f=this.addVertex(s);this.addEdge(t,f,i),this.buildGraphFromOperation(f,i,l,n);return}if(r.length===0){this.addEdge(t,this.addVertex(Array.isArray(s)?[]:{}),i),this.buildGraphAutoEnable(t,i,s,void 0);return}const c=this.getVertexChildrenByKey(t),h=n?this.getVertexValue(n):[];let d;Array.isArray(s)&&this.addEdge(t,this.addVertex(i),gO);const u=[...h],p=h.length;for(const f of r){if(a?.has(f))continue;const y=c?.get(f)??this.addVertex(f);u[p]=f,o?.has(f)?this.buildShallowGraphFromValue(t,y,i,u,s[f]):this.buildGraphFromValue(t,y,i,u,s[f],o),f==="enabled"&&(d=y)}this.buildGraphAutoEnable(t,i,s,d)}buildGraphAutoEnable(t,i,s,n){if(i===di&&!n||i===Ko&&n||i!==di&&i!==Ko&&i!==Vl&&i!==go)return;let o=this.findNeighbour(t,PD);o||(o=this.addVertex(PD),this.addEdge(t,o,PD)),n&&this.addEdge(n,o,uO);const{enabled:a,_enabledFromTheme:r}=s;this.addEdge(o,this.addVertex({enabled:a,_enabledFromTheme:r,keys:Object.keys(s).length}),i)}getVertexChildrenByKey(t){const i=this.neighboursWithEdgeValue(t,ni);if(!i)return;const s=new Map;for(const n of i)s.set(this.getVertexValue(n),n);return s}buildGraphFromValue(t,i,s,n,o,a){this.addEdge(t,i,ni);let r=this.findNeighbour(i,po);r||(r=this.addVertex([...n]),this.addEdge(i,r,po));const l=qg(o);if(l){const c=this.addVertex(o);this.addEdge(i,c,s),this.addEdge(c,r,po),this.buildGraphFromOperation(c,s,l,r)}else if(td(o))this.buildGraphFromObject(i,s,o,r,a);else{const c=this.findNeighbour(i,s);if(c&&this.getVertexValue(c)===o)return;const h=this.addVertex(o);this.addEdge(i,h,s)}}buildShallowGraphFromValue(t,i,s,n,o){this.addEdge(t,i,ni);let a=this.findNeighbour(i,po);a||(a=this.addVertex([...n]),this.addEdge(i,a,po));const r=this.addVertex(o);this.addEdge(i,r,s)}buildGraphFromOperation(t,i,s,n){const o=this.addVertex(s.operation);this.addEdge(t,o,Tu);for(const a of s.values)this.buildGraphFromOperationValue(t,a,i,n)}buildGraphFromOperationValue(t,i,s,n=this.EMPTY_PATH_ARRAY_VERTEX){const o=this.addVertex(i);this.addEdge(t,n,po),this.addEdge(t,o,Nu);const a=qg(i);a?this.buildGraphFromOperation(o,s,a,n):td(i)&&this.buildGraphFromObject(o,s,i,n)}buildDependencyGraph(){for(let t=0;t<this.pendingProcessingEdgesFrom.length;t++){const i=this.pendingProcessingEdgesFrom[t],s=this.pendingProcessingEdgesTo[t],n=this.getVertexValue(s);if(!Jg(n))continue;const o=this.neighboursWithEdgeValue(i,Nu),a=Qg[n];(typeof a=="function"?void 0:a.dependencies)?.(this,i,o??[])}this.pendingProcessingEdgesFrom=[],this.pendingProcessingEdgesTo=[]}refreshPendingProcessingEdges(t){const s=this.findNeighbour(t,di)??t,n=this.findNeighbour(s,Tu);if(n){this.pendingProcessingEdgesFrom.push(s),this.pendingProcessingEdgesTo.push(n);const a=this.neighboursWithEdgeValue(s,Nu);if(a)for(const r of a)this.refreshPendingProcessingEdges(r)}const o=this.neighboursWithEdgeValue(t,ni);if(o)for(const a of o)this.refreshPendingProcessingEdges(a)}resolveVertex(t,i=this.resolved,s){const n=this.getPathArray(t);this.resolveVertexInEdgePriority(t,i,n,s),this.resolveVertexAutoEnable(t,i,n),this.resolveVertexChildren(t,i,s)}resolveVertexInEdgePriority(t,i,s,n){const o=this.neighboursWithEdgeValue(t,ni),[a]=this.edgePriority;for(const r of this.edgePriority){const l=this.findNeighbour(t,r);if(l==null)continue;const c=this.resolveVertexValueInternal(t,l);if(!(c==null&&r!==a)&&!(o&&o.length>0&&r!==a)&&!(Array.isArray(n)&&n.includes(r))){if(this.hasUnsafeClearKeys||(this.hasUnsafeClearKeys=c!=null&&es.UNSAFE_CLEAR_KEYS.has(s.at(-1))),s.length===0){if(c==null)continue;this.resolved=c}else Ou(i,s,c);break}}}resolveVertexValueInternal(t,i){this.resolveVertexDependencies(i);const s=this.findNeighbourValue(i,Tu);if(s&&Jg(s)){const n=this.neighboursWithEdgeValue(i,Nu),o=Qg[s],r=(typeof o=="function"?o:o.resolve)?.(this,t,n??[]);return r===Fn?void 0:r}return this.resolveValueOrSymbol(this.getVertexValue(i))}resolveVertexAutoEnable(t,i,s){const n=this.neighboursWithEdgeValue(t,uO)?.[0];if(!n)return;const o=this.findVertexAtPath(s),a=this.findNeighbourValue(n,di),r=this.findNeighbourValue(n,go),l=this.findNeighbourValue(n,Ko),h=o&&this.findNeighbour(o,Ko)!=null?void 0:this.findNeighbourValue(n,Vl);(l!=null&&l.enabled==null||h!=null&&h.enabled==null)&&!a?._enabledFromTheme&&!r?._enabledFromTheme&&Ou(i,s,!0)}resolveVertexChildren(t,i,s){const n=this.neighboursWithEdgeValue(t,ni);if(n){s??(s=this.findNeighbourValue(t,pO));for(const o of n){const a=this.getVertexValue(o);n.length>1&&Jg(a)||a!=="_enabledFromTheme"&&this.resolveVertex(o,i,s)}}}resolveVertexDependencies(t){const i=this.neighboursWithEdgeValue(t,ED);if(i)for(const s of i)this.resolveVertex(s)}graftAndResolveChildren(t,i,s,n){const o=this.neighboursWithEdgeValue(t,ni);if(o)for(const a of o){const r=this.getVertexValue(a),l=[...s,r],c=[...n,r],h=this.addVertex(r),d=this.findNeighbourValue(a,di);this.addEdge(i,h,ni);const u=this.addVertex(l);if(this.addEdge(h,u,po),fe(d)){this.buildGraphFromObject(h,di,d,u);const p=this.findNeighbour(h,di);this.addEdge(p,this.addVertex(l),po);const f=this.findNeighbourValue(p,Tu);if(Jg(f)){const y=this.neighboursWithEdgeValue(p,Nu),b=Qg[f];(typeof b=="function"?void 0:b.dependencies)?.(this,p,y??[])}}this.graftAndResolveChildren(a,h,l,c)}}resolveValueOrSymbol(t){return typeof t=="symbol"&&this.internalParams?.has(t)?this.internalParams.get(t):t}snapshot(){Mt("snapshot"),this.isRollingBack=!0}rollback(){Mt(`rollback ${this.rollbackEdgesFrom.length} edges and ${this.rollbackVertices.length} vertices`);for(let t=0;t<this.rollbackEdgesFrom.length;t++){const i=this.rollbackEdgesFrom[t],s=this.rollbackEdgesTo[t],n=this.rollbackEdgesValue[t];this.removeEdge(i,s,n)}for(const t of this.rollbackVertices)this.removeVertex(t);this.cachedPathVertices.clear(),this.rollbackVertices=[],this.rollbackEdgesFrom=[],this.rollbackEdgesTo=[],this.rollbackEdgesValue=[],this.isRollingBack=!1}};Hl.EDGE_PRIORITY=[Ko,go,di],Hl.GRAFT_EDGE=di,Hl.SHALLOW_KEYS=new Set(["context","data","topology"]),Hl.COMPLEX_KEYS=["annotations","axes","series"],Hl.ANNOTATIONS_OPTIONS_KEYS=["axesButtons","data","enabled","optionsToolbar","snap","toolbar","xKey","volumeKey"],Hl.UNSAFE_CLEAR_KEYS=new Set(["itemStyler","styler"]),Hl.valueCache=new Map;var bO=Hl,vO=e=>`'${e}'`,zD="__AXIS_ID_",uh={top:"x",bottom:"x",left:"y",right:"y"},ph=class Gi{constructor(t,i,s,n,o,a,r=!1,l){this.themeParameters={},this.optionMetadata=o??{},this.processedOverrides=s??{};let c=null;t instanceof Gi?(c=t,this.specialOverrides=c.specialOverrides,a&&(this.userDeltaKeys=new Set(Object.keys(a))),a??(a=Ln(c.userOptions,i,Gi.JSON_DIFF_OPTS)),this.userOptions=Re(gd(a,c.userOptions),{...Gi.OPTIONS_CLONE_OPTS_SLOW,seen:[]})):(this.userOptions=Re(t??i,{...Gi.OPTIONS_CLONE_OPTS_SLOW,seen:[]}),this.specialOverrides=this.specialOverridesDefaults({...n})),this.findSeriesWithUserVisiblity(i,a),r&&this.removeLeftoverSymbols(this.userOptions);const h=t instanceof Gi&&a?.data!==void 0&&a?.data?.length!==t.userOptions.data?.length;let d,u,p,f,y,b,x;if(!r&&this.seriesWithUserVisibility==null&&a!==void 0&&Gi.isFastPathDelta(a)&&c!=null&&!h?({activeTheme:d,processedOptions:u,fastDelta:p}=this.fastSetup(a,c),f=c.themeParameters,y=c.annotationThemes):(Gi.perfDebug("ChartOptions.slowSetup()"),{activeTheme:d,processedOptions:u,themeParameters:f,annotationThemes:y,googleFonts:b,optionsGraph:x}=this.slowSetup(s,a,r)),this.activeTheme=d,this.processedOptions=u,this.fastDelta=p??void 0,this.themeParameters=f,this.annotationThemes=y,this.googleFonts=b,this.optionsGraph=x,l!==void 0&&typeof l=="number"&&!Number.isNaN(l)){const v=performance.now();this.optionsProcessingTime=v-l}Me.inDevelopmentMode(()=>on(this))}static isFastPathDelta(t){for(const i of Object.keys(t??{}))if(!this.FAST_PATH_OPTIONS.has(i))return Gi.perfDebug("ChartOptions.isFastPathDelta() - slow path required due to presence of: ",i),!1;return Gi.perfDebug("ChartOptions.isFastPathDelta() - fast path possible."),!0}findSeriesWithUserVisiblity(t,i){for(const s of[t,i]){const n=s?.series;if(Array.isArray(n))for(let o=0;o<n.length;o++){const a=n[o];"visible"in a&&(this.seriesWithUserVisibility??(this.seriesWithUserVisibility={identifiers:new Set,indices:new Set}),a.id?this.seriesWithUserVisibility.identifiers.add(a.id):this.seriesWithUserVisibility.indices.add(o))}}}fastSetup(t,i){const{activeTheme:s,processedOptions:n}=i,{presetType:o}=this.optionMetadata;if(o!=null&&t?.data!=null){const r=me.getPresetModule(o);if(r?.processData){const{series:l,data:c}=r.processData(t.data);t=oe({series:l,data:c},t)}}this.fastSeriesSetup(t,n);const a=oe(t,n);return Gi.debug("ChartOptions.fastSetup() - processed options",a),{activeTheme:s,processedOptions:a,fastDelta:t}}fastSeriesSetup(t,i){t?.series&&(t.series?.every((s,n)=>D0(s,i.series?.[n]??{}))?delete t.series:t.series=t.series.map((s,n)=>gd(s,i.series?.[n]??{})))}slowSetup(t,i,s=!1){let n=Re(this.userOptions,Gi.OPTIONS_CLONE_OPTS_FAST);i&&(n=oe(i,n),s&&this.removeLeftoverSymbols(n));let o=t1(wx(n.theme));const{presetType:a}=this.optionMetadata;if(a!=null){const b=me.getPresetModule(a);if(b){const{validate:x=Ei}=b,v=n,S=n.type,M=S==null?void 0:o.presets[S],{cleared:D,invalid:k}=x(v,b.options,"");for(const I of k)j.warn(I);ol(k,"")?n={}:(Gi.debug(">>> AgCharts.createOrUpdate() - applying preset",D),n=b.create(D,M,()=>this.activeTheme),o=t1(wx(n.theme)))}}this.soloSeriesIntegrity(n),a!=null&&o.templateTheme(n,!1),s1(void 0,n);const r=this.validateSeriesOptions(n),l=Vg(n);if(this.chartDef=me.getChartModule(l),!this.chartDef.placeholder){const{validate:b=Ei}=this.chartDef,{cleared:x,invalid:v}=b(n,this.chartDef.options,"");for(const S of v)j.warn(S);n=x}this.validateAxesOptions(n),this.removeDisabledOptions(n);let c=this.processFonts(o.params);c=this.processFonts(n,c),this.processSeriesOptions(n);const h=this.processAxesOptions(n,l),d=YU(o,n),u=d.resolve(),p=d.resolveParams(),f=d.resolveAnnotationThemes();d.clearSafe();const y=oe(t,u);return s1(this.chartDef.name,y),v$(this.chartDef.name,y,r),this.validateSeriesOptions(y),this.validateAxesOptions(y,h),this.validatePluginOptions(y),this.processMiniChartSeriesOptions(y),y.loadGoogleFonts||c.clear(),Gi.debug(()=>["ChartOptions.slowSetup() - processed options",Re(y)]),{activeTheme:o,processedOptions:y,themeParameters:p,annotationThemes:f,googleFonts:c,optionsGraph:d}}validatePluginOptions(t){for(const i of me.listModulesByType("plugin")){const s=i.name;if(s in t&&i.options!=null&&(!i.chartType||i.chartType===this.chartDef?.name)){const{cleared:n,invalid:o}=Ei(t[s],i.options,i.name);for(const a of o)j.warn(a);t[s]=n}}}validateSeriesOptions(t){const i=this.chartDef?.name,s=[],n=t.series?.length??0,o=[];let a;for(let r=0;r<n;r++){const l=`series[${r}]`,c=t.series[r],h=me.getSeriesModule(c.type);if(h==null){const f=me.isEnterprise();a??(a=Za(Array.from(Rl.values()).filter(b=>b.type==="series"&&(f||!b.enterprise)&&(!i||b.chartType===i)).map(b=>b.name),"or",vO));const y=Rl.get(c.type);if(c.type!=null&&y?.type==="series"){o.push(y);continue}j.warn(c.type==null?`Option \`${l}.type\` is required and has not been provided; expecting ${a}, ignoring.`:`Unknown type \`${c.type}\` at \`${l}.type\`; expecting ${a}, ignoring.`);continue}else if(i&&h.chartType!==i){j.warn(`Series type \`${h.name}\` at \`${l}.type\` is not supported by chart type \`${i}\`, ignoring.`);continue}if(h.options==null){s.push(c);continue}const{validate:d=Ei}=h,{cleared:u,invalid:p}=d(c,h.options,l);for(const f of p)j.warn(f);ol(p,l)||s.push(u)}return t.series=s,o}validateAxesOptions(t,i){if(!("axes"in t)||!t.axes)return;const s=this.chartDef?.name,n={};let o;for(const[a,r]of ht(t.axes)){if(!r)continue;if(r.type==null){n[a]=r;continue}const l=`axes.${i?.get(a)??a}`,c=me.getAxisModule(r.type);if(c==null){const p=me.isEnterprise();o??(o=Za(Array.from(Rl.values()).filter(y=>y.type==="axis"&&(p||!y.enterprise)&&y.chartType===s).map(y=>y.name),"or",vO)),Rl.get(r.type)?.type!=="axis"&&j.warn(`Unknown type \`${r.type}\` at \`${l}.type\`; expecting one of ${o}, ignoring.`);continue}else if(c.chartType!==s){j.warn(`Axis type \`${c.name}\` at  \`${l}.type\` is not supported by chart type \`${s}\`, ignoring.`);break}const{validate:h=Ei}=c,{cleared:d,invalid:u}=h(r,c.options,l);for(const p of u)j.warn(p);ol(u,l)||(n[a]=d)}t.axes=n}diffOptions(t){return this===t?{}:t==null?this.processedOptions:this.fastDelta??Ln(t.processedOptions,this.processedOptions,Gi.JSON_DIFF_OPTS)}optionsType(t){return t.series?.[0]?.type??"line"}processSeriesOptions(t){const i=t.series?.map(s=>{const o=!!me.getSeriesModule(s.type)?.options?.visible;return oe(this.getSeriesGroupingOptions(s),s,o&&{visible:!0})});t.series=this.setSeriesGroupingOptions(i??[])}processAxesOptions(t,i){const s=i==="polar"?["angle","radius"]:["x","y"],n="axes"in t&&Object.keys(t.axes??{}).length>0,o=this.countNonDefaultSeriesAxisKeys(t,s),a=o>0,r=a&&o<(t?.series?.length??0),l=t.series?.[0],c=this.optionsType(t),h=this.predictAxes(c,s,l,t.data)??this.cloneDefaultAxes(c),d=fe(l)&&"direction"in l&&l.direction==="horizontal"&&me.getSeriesModule(l.type)?.axisKeysFlipped!=null;if(!n&&!a&&!d){t.axes=h;return}const u="axes"in t?new Set(Object.keys(t.axes??{})):new Set,p=this.getPrimaryAxisKeys(t,s,u,a),f=this.getRemappedAxisKeys(u,p,s,r),y={},b=new Map;for(const[x,v]of f)y[v]="axes"in t?yl(t.axes?.[x]):void 0,b.set(v,x);return this.remapSeriesAxisKeys(t,s,y,f,h,r),this.predictAxesMissingTypesAndPositions(t,s,y,h),this.alternateSecondaryAxisPositions(t,y,b),t.axes=y,b}getSeriesDirectionAxisKey(t,i){const s=me.getSeriesModule(t.type);return s?"direction"in t&&t.direction==="horizontal"&&s.axisKeysFlipped?s.axisKeysFlipped[i]:s.axisKeys?.[i]:void 0}countNonDefaultSeriesAxisKeys(t,i){let s=0;for(const n of t.series??[])for(const o of i){const a=this.getSeriesDirectionAxisKey(n,o);!a||!il(a,n)||n[a]!==o&&s++}return s}getPrimaryAxisKeys(t,i,s,n){const o=new Map;for(const a of i){let r=!1;if("axes"in t&&t.axes&&!(a in t.axes&&fe(t.axes[a])&&!("position"in t.axes[a]))){for(const[l,c]of ht(t.axes))if("position"in c&&c.position&&a===uh[c.position]){o.set(a,l),r=!0;break}}if(!r&&n)for(const l of t.series??[]){const c=this.getSeriesDirectionAxisKey(l,a);if(!c)continue;const h=l[c];if(!s.has(h)){if(!h){o.set(a,a);break}o.set(a,h);break}}}if(s.size===0||!("axes"in t)||!t.axes)return o;if(o.size===0)for(const a of i)a in t.axes&&o.set(a,a);if(o.size===0){for(const a of i)for(const[r,l]of ht(t.axes))if(l.type?.startsWith(a)){o.set(a,r);break}}if(o.size===0&&(t.series?.length??0)>0)for(const a of i)for(const r of t.series){const l=this.getSeriesDirectionAxisKey(r,a);if(!l)continue;const c=r[l];if(s.has(c)){o.set(a,c);break}}if(o.size<2){const a=new Set(o.values());for(const[r,l]of ht(t.axes))if(!(a.has(r)||"position"in l)){for(const c of i)if(!o.has(c)){o.set(c,r),a.add(r);break}if(o.size===2)break}}return o}getRemappedAxisKeys(t,i,s,n){const o=new Map;for(const[a,r]of i)o.set(r,a);for(const a of t)o.has(a)||o.set(a,`${zD}${o.size}`);if(n)for(const a of s)o.has(a)||o.set(a,`${zD}${o.size}`);return o}remapSeriesAxisKeys(t,i,s,n,o,a){for(const r of t.series??[])for(const l of i){const c=this.getSeriesDirectionAxisKey(r,l);if(!c)continue;s[l]??(s[l]=yl(o[l]));let h=l;if(c in r){const d=r[c];n.has(d)?h=n.get(d):(h=`${zD}${n.size}`,n.set(d,h),s[h]=yl(o[l]))}else n.has(l)&&a&&(h=n.get(l),s[h]??(s[h]=yl(o[l])));r[c]=h}}predictAxes(t,i,s,n){if(!s)return;const o=s?.data??n;if(!o?.length)return;const a=me.getSeriesModule(t)?.predictAxis;if(!a)return;const r=new Map,l=oS(0,o.length-1,5);for(const c of l){const h=o[c];for(const d of i){const u=a(d,h,s);if(!r.has(d)){r.set(d,u);continue}const p=r.get(d);if(!(!u&&!p)){if(!u||!p)return;for(const f of Object.keys(p))if(p[f]!==u[f])return}}}for(const[c,h]of r)h||r.delete(c);if(r.size!==0){if(r.size===1){const[c]=r.values(),h=this.cloneDefaultAxes(t);return"position"in c?Dc(h,d=>"position"in d&&d.position===c.position?c:d):void 0}return Object.fromEntries(r)}}cloneDefaultAxes(t){const i=me.getSeriesModule(t);return i?.defaultAxes?Re(i.defaultAxes):{}}predictAxesMissingTypesAndPositions(t,i,s,n){for(const[o,a]of ht(s)){if(!st(a)||"type"in a&&"position"in a)continue;if(o in n){a.type??(a.type=n[o].type),a.position??(a.position=n[o].position);continue}this.predictAxisMissingTypeFromPosition(a,n)||(this.predictAxisMissingTypeAndPositionFromSeries(t,i,o,a,n),"type"in a||delete s[o])}}predictAxisMissingTypeFromPosition(t,i){if(!("position"in t)||!il(t.position,uh))return!1;for(const s of Object.values(i))if(il(s.position,uh)&&uh[t.position]===uh[s.position])return t.type=s.type,!0;for(const[s,n]of ht(uh))if(t.position!==s&&n===uh[t.position])return t.type=i[n].type,!0;return!1}predictAxisMissingTypeAndPositionFromSeries(t,i,s,n,o){for(const a of t.series??[])for(const r of i){const l=this.getSeriesDirectionAxisKey(a,r);if(!(!l||!il(l,a))&&a[l]===s)return n.type??(n.type=o[r].type),n.position??(n.position=o[r].position),r==="y"}return!1}alternateSecondaryAxisPositions(t,i,s){let n=0,o=0;for(const[a,r]of ht(i)){if(!st(r)||!("position"in r))continue;const l=s.get(a),c="axes"in t&&t.axes&&l&&l in t.axes?t.axes[l]:void 0,h=c&&"position"in c?c.position:void 0;if(r.position==="top"||r.position==="bottom"?(n+=1,n===2&&h==null&&(r.position="top")):(r.position==="left"||r.position==="right")&&(o+=1,o===2&&h==null&&(r.position="right")),n>1&&o>1)break}}processMiniChartSeriesOptions(t){const i=t.navigator?.miniChart?.series;i!=null&&(t.navigator.miniChart.series=this.setSeriesGroupingOptions(i))}getSeriesGroupingOptions(t){const{groupable:i,stackable:s,stackedByDefault:n=!1}=me.getSeriesModule(t.type);t.grouped&&!i&&j.warnOnce(`unsupported grouping of series type "${t.type}".`),(t.stacked||t.stackGroup)&&!s&&j.warnOnce(`unsupported stacking of series type "${t.type}".`);let{grouped:o,stacked:a}=t;return a??(a=(n||t.stackGroup!=null)&&!(i&&o)),o??(o=!0),{stacked:s&&a,grouped:i&&o&&!(s&&a)}}setSeriesGroupingOptions(t){const i=this.getSeriesGrouping(t);Gi.debug("ChartOptions.setSeriesGroupingOptions() - series grouping: ",i);const s={},n=i.reduce((o,a)=>{var r;return a.groupType==="default"||(o[r=a.seriesType]??(o[r]=0),o[a.seriesType]+=a.groupType==="stack"?1:a.series.length),o},{});return i.flatMap(o=>{var a;switch(s[a=o.seriesType]??(s[a]=0),o.groupType){case"stack":{const r=s[o.seriesType]++;return o.series.map((l,c)=>Object.assign(l,{seriesGrouping:{groupId:o.groupId,groupIndex:r,groupCount:n[o.seriesType],stackIndex:c,stackCount:o.series.length}}))}case"group":return o.series.map(r=>Object.assign(r,{seriesGrouping:{groupId:o.groupId,groupIndex:s[o.seriesType]++,groupCount:n[o.seriesType],stackIndex:0,stackCount:0}}))}return o.series}).map(({stacked:o,grouped:a,...r})=>r)}getSeriesGroupId(t){return[t.type,t.xKey,t.stacked?t.stackGroup??"stacked":"grouped"].filter(Boolean).join("-")}getSeriesGrouping(t){const i=new Map;return t.reduce((s,n)=>{const o=n.type;if(!n.stacked&&!n.grouped)s.push({groupType:"default",seriesType:o,series:[n],groupId:"__default__"});else{const a=this.getSeriesGroupId(n);if(!i.has(a)){const l={groupType:n.stacked?"stack":"group",seriesType:o,series:[],groupId:a};i.set(a,l),s.push(l)}i.get(a).series.push(n)}return s},[])}soloSeriesIntegrity(t){if(!Ce(t.series))return;const i=n=>me.getSeriesModule(n)?.solo??!1,s=t.series;if(s&&s.length>1&&s.some(n=>i(n.type))){const n=this.optionsType(t);if(i(n))j.warn(`series[0] of type '${n}' is incompatible with other series types. Only processing series[0]`),t.series=s.slice(0,1);else{const{solo:o,nonSolo:a}=Zh(s,l=>i(l.type)?"solo":"nonSolo"),r=Ap(o.map(l=>l.type)).join(", ");j.warn(`Unable to mix these series types with the lead series type: ${r}`),t.series=a}}}static processFontOptions(t,i,s,n=new Set){if(typeof t=="object"&&"fontFamily"in t)if(Array.isArray(t.fontFamily)){const o=[];for(const a of t.fontFamily)typeof a=="object"&&"googleFont"in a?(o.push(a.googleFont),n?.add(a.googleFont)):o.push(a);t.fontFamily=o.join(", ")}else typeof t.fontFamily=="object"&&"googleFont"in t.fontFamily&&(t.fontFamily=t.fontFamily.googleFont,n?.add(t.fontFamily));return n}processFonts(t,i=new Set){return ya(t,Gi.processFontOptions,new Set(["data","theme"]),void 0,void 0,i)}static removeDisabledOptionJson(t){if("enabled"in t&&t.enabled===!1)for(const i of Object.keys(t))i!=="enabled"&&delete t[i]}removeDisabledOptions(t){ya(t,Gi.removeDisabledOptionJson,new Set(["data","theme","contextMenu"]))}static removeLeftoverSymbolsJson(t){if(!(!t||!fe(t)))for(const i of Object.keys(t)){const s=t[i];sd(s)&&delete t[i]}}removeLeftoverSymbols(t){ya(t,Gi.removeLeftoverSymbolsJson,new Set(["data"]))}specialOverridesDefaults(t){if(t.window==null?t.window=Ve():rS(t.window),t.document==null?t.document=Qn():aS(t.document),t.window==null)throw new Error("AG Charts - unable to resolve global window");if(t.document==null)throw new Error("AG Charts - unable to resolve global document");return t}};ph.OPTIONS_CLONE_OPTS_SLOW={shallow:new Set(["data","container"]),assign:new Set(["context","theme"])},ph.OPTIONS_CLONE_OPTS_FAST={shallow:new Set(["container"]),assign:new Set(["data","context","theme"])},ph.JSON_DIFF_OPTS=new Set(["data"]),ph.perfDebug=Me.create(!0,"perf"),ph.FAST_PATH_OPTIONS=new Set(["data","width","height","container"]),ph.debug=Me.create(!0,"opts");var ef=ph,Tx=Me.create(!0,"opts"),jl="AG Charts - Chart was destroyed, cannot perform request.",tf=class{constructor(t,i,s){this.factoryApi=i,this.licenseManager=s,this.chart=t}async update(t){if(!this.chart)throw new Error(jl);return Tx.group("AgChartInstance.update()",async()=>{const i=Me.check("scene:stats","scene:stats:verbose")?performance.now():void 0;this.factoryApi.update(t,this,void 0,i),await this.chart?.waitForUpdate()})}async updateDelta(t){if(!this.chart)throw new Error(jl);return Tx.group("AgChartInstance.updateDelta()",async()=>{const i=Me.check("scene:stats","scene:stats:verbose")?performance.now():void 0;this.factoryApi.updateUserDelta(this,t,i),await this.chart?.waitForUpdate()})}getOptions(){if(!this.chart)throw new Error(jl);const t=Re(this.chart.getOptions(),ef.OPTIONS_CLONE_OPTS_FAST);for(const i of Object.keys(t))i.startsWith("_")&&delete t[i];return t}waitForUpdate(){if(!this.chart)throw new Error(jl);return this.chart.waitForUpdate()}applyTransaction(t){const{chart:i}=this;if(!i)throw new Error(jl);if(t==null||typeof t!="object")throw new Error("AG Charts - applyTransaction expects a transaction object.");const{add:s,addIndex:n,remove:o,update:a}=t;if(s!=null&&!Array.isArray(s))throw new Error('AG Charts - transaction "add" must be an array.');if(n!=null){if(typeof n!="number"||!Number.isSafeInteger(n)||n<0)throw new Error('AG Charts - transaction "addIndex" must be a safe non-negative integer (0 to 9007199254740991).');if(s==null||s.length===0)throw new Error('AG Charts - transaction "addIndex" requires a non-empty "add" array.')}if(o!=null&&!Array.isArray(o))throw new Error('AG Charts - transaction "remove" must be an array.');if(a!=null&&!Array.isArray(a))throw new Error('AG Charts - transaction "update" must be an array.');return Tx.group("AgChartInstance.applyTransaction()",async()=>{if(!i.isDataTransactionSupported()){const r=i.data.deepClone();return r.addTransaction(t),r.commitPendingTransactions(),this.updateDelta({data:r.data})}return Tx("transaction",t),await this.chart?.applyTransaction(t)})}async download(t){if(!this.chart)throw new Error(jl);const i=await this.prepareResizedChart(this,this.chart,t);try{i.chart?.download(t?.fileName,t?.fileFormat)}finally{i.destroy()}}async __toSVG(t){if(!this.chart)throw new Error(jl);const i=await this.prepareResizedChart(this,this.chart,{width:600,height:300,...t});try{return i?.chart?.toSVG()}finally{i?.destroy()}}async getImageDataURL(t){if(!this.chart)throw new Error(jl);const i=await this.prepareResizedChart(this,this.chart,t);try{return i.chart.getCanvasDataURL(t?.fileFormat)}finally{i.destroy()}}getState(){return this.factoryApi.caretaker.save(...this.getEnabledOriginators())}async setState(t){const{chart:i}=this;if(!i)return;const s=this.getEnabledOriginators();if(!s.includes(i.ctx.legendManager)){await this.setStateOriginators(t,s);return}await this.setStateOriginators(t,s.filter(n=>n!==i.ctx.zoomManager)),await this.setStateOriginators(t,[i.ctx.zoomManager])}resetAnimations(){this.chart?.resetAnimations()}skipAnimations(){this.chart?.skipAnimations()}destroy(){this.releaseChart?(this.releaseChart(),this.releaseChart=void 0):this.chart&&(this.chart.publicApi=void 0,this.chart.destroy()),this.chart=void 0}async prepareResizedChart(t,i,s={}){const n=s.width??i.width??i.ctx.scene.canvas.width,o=s.height??i.height??i.ctx.scene.canvas.height,a=t.getState(),r={...i.chartOptions.processedOverrides,container:document.createElement("div"),width:n,height:o};s.width!=null&&s.height!=null&&(r.overrideDevicePixelRatio=1);const l=i.getOptions();me.isEnterprise()&&(r.animation={enabled:!1},this.licenseManager?.isDisplayWatermark()&&(r.foreground={text:this.licenseManager.getWatermarkMessage(),image:{url:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU4IiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMjU4IDQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMjUuNzc5IDI4LjY1N0gxMy4zNTlMMTEuMTczIDM0LjAxMkg1LjY3Mjk3TDE3LjE4MiA3LjA1OTk5SDIxLjk1M0wzMy40NjIgMzQuMDEySDI3Ljk2MkwyNS43NzYgMjguNjU3SDI1Ljc3OVpNMjQuMDY4IDI0LjM5N0wxOS41ODggMTMuNDM0TDE1LjEwNyAyNC4zOTdIMjQuMDY4Wk02Mi4wOTIgMTguODIzSDQ5LjgxN1YyMy4wODZINTYuNzc1QzU2LjU1NSAyNS4yMjIgNTUuNzU1IDI2LjkyNyA1NC4zNzIgMjguMjAyQzUyLjk4OSAyOS40NzYgNTEuMTY2IDMwLjExNSA0OC45MDkgMzAuMTE1QzQ3LjYyMiAzMC4xMTUgNDYuNDUgMjkuODg1IDQ1LjM5MyAyOS40MjNDNDQuMzU4MyAyOC45NzgxIDQzLjQzMjYgMjguMzEzOCA0Mi42OCAyNy40NzZDNDEuOTI3IDI2LjYzOSA0MS4zNDQgMjUuNjMxIDQwLjkzMSAyNC40NTNDNDAuNTE5IDIzLjI3NSA0MC4zMTEgMjEuOTcgNDAuMzExIDIwLjUzN0M0MC4zMTEgMTkuMTA1IDQwLjUxNiAxNy44IDQwLjkzMSAxNi42MjFDNDEuMzQ0IDE1LjQ0MyA0MS45MjcgMTQuNDM2IDQyLjY4IDEzLjU5OEM0My40Mzc2IDEyLjc1NzcgNDQuMzY5NiAxMi4wOTMyIDQ1LjQxMSAxMS42NTFDNDYuNDc4IDExLjE4OSA0Ny42NTYgMTAuOTYgNDguOTQ2IDEwLjk2QzUxLjYxMiAxMC45NiA1My42MzcgMTEuNjAyIDU1LjAyIDEyLjg4NUw1OC4zIDkuNjA0OTlDNTUuODE3IDcuNjY5OTkgNTIuNjc2IDYuNjk5OTkgNDguODcyIDYuNjk5OTlDNDYuNzYgNi42OTk5OSA0NC44NTMgNy4wMzQ5OSA0My4xNTQgNy43MDA5OUM0MS40NTUgOC4zNjc5OSAzOS45OTggOS4zMDM5OSAzOC43ODMgMTAuNTA0QzM3LjU2NyAxMS43MDcgMzYuNjM0IDEzLjE1OCAzNS45NzcgMTQuODU3QzM1LjMxOSAxNi41NTYgMzQuOTk0IDE4LjQ1MSAzNC45OTQgMjAuNTRDMzQuOTk0IDIyLjYzIDM1LjMyOSAyNC40OTQgMzUuOTk1IDI2LjIwNUMzNi42NjIgMjcuOTE2IDM3LjYwNSAyOS4zNzQgMzguODE3IDMwLjU3N0M0MC4wMzIgMzEuNzggNDEuNDg2IDMyLjcxMyA0My4xODggMzMuMzgzQzQ0Ljg4OCAzNC4wNDkgNDYuNzgyIDM0LjM4NCA0OC44NzIgMzQuMzg0QzUwLjk2MSAzNC4zODQgNTIuNzUgMzQuMDQ5IDU0LjM5IDMzLjM4M0M1Ni4wMzEgMzIuNzE2IDU3LjQyNiAzMS43OCA1OC41NzkgMzAuNTc3QzU5LjczMyAyOS4zNzQgNjAuNjE5IDI3LjkxNiA2MS4yMzkgMjYuMjA1QzYxLjg2IDI0LjQ5NCA2Mi4xNyAyMi42MDUgNjIuMTcgMjAuNTRDNjIuMTY5NiAxOS45Njg4IDYyLjE0NDUgMTkuMzk4IDYyLjA5NSAxOC44MjlMNjIuMDkyIDE4LjgyM1pNMTUxLjgxIDE2Ljk4MUMxNTMuNDEgMTQuNjA5IDE1Ny40MTkgMTQuMzU4IDE1OS4wMjIgMTQuMzU4VjE4LjkxQzE1Ni45NTcgMTguOTEgMTU0Ljk4NSAxOC45OTYgMTUzLjc1NyAxOS44OTJDMTUyLjUyOSAyMC43OTIgMTUxLjkxOSAyMS45ODIgMTUxLjkxOSAyMy40NjRWMzMuOTlIMTQ2Ljk2NFYxNC4zNThIMTUxLjczNkwxNTEuODEgMTYuOTgxWk0xNDMuMDExIDE0LjM2MVYzNC4wMzFIMTM4LjI0TDEzOC4xMzEgMzEuMDQ1QzEzNy40NjYgMzIuMDc2IDEzNi41NTEgMzIuOTIxOSAxMzUuNDcxIDMzLjUwNEMxMzQuMzc2IDM0LjA5OSAxMzMuMDY4IDM0LjM5NiAxMzEuNTM2IDM0LjM5NkMxMzAuMiAzNC4zOTYgMTI4Ljk2MyAzNC4xNTIgMTI3LjgyMiAzMy42NjhDMTI2LjcgMzMuMTk2NCAxMjUuNjg5IDMyLjQ5NSAxMjQuODU1IDMxLjYwOUMxMjQuMDE4IDMwLjcyMiAxMjMuMzU0IDI5LjY2MiAxMjIuODcxIDI4LjQyMkMxMjIuMzg0IDI3LjE4NSAxMjIuMTQyIDI1LjgxMSAxMjIuMTQyIDI0LjMwNEMxMjIuMTQyIDIyLjc5OCAxMjIuMzg0IDIxLjM3OCAxMjIuODcxIDIwLjExNkMxMjMuMzU3IDE4Ljg1NCAxMjQuMDE4IDE3Ljc3MiAxMjQuODU1IDE2Ljg3M0MxMjUuNjg4IDE1Ljk3NjQgMTI2LjY5OCAxNS4yNjM2IDEyNy44MjIgMTQuNzhDMTI4Ljk2MyAxNC4yODEgMTMwLjIwMyAxNC4wMzMgMTMxLjUzNiAxNC4wMzNDMTMzLjA0MyAxNC4wMzMgMTM0LjMzIDE0LjMxOCAxMzUuMzk3IDE0Ljg4OEMxMzYuNDYyIDE1LjQ1ODkgMTM3LjM3NSAxNi4yNzggMTM4LjA1NyAxNy4yNzZWMTQuMzYxSDE0My4wMTFaTTEzMi42MzEgMzAuMTMzQzEzNC4yNTYgMzAuMTMzIDEzNS41NjcgMjkuNTk0IDEzNi41NjUgMjguNTEyQzEzNy41NjEgMjcuNDMgMTM4LjA2IDI1Ljk5MSAxMzguMDYgMjQuMTk2QzEzOC4wNiAyMi40MDEgMTM3LjU2MSAyMC45OSAxMzYuNTY1IDE5Ljg5OUMxMzUuNTcgMTguODA3IDEzNC4yNTkgMTguMjU4IDEzMi42MzEgMTguMjU4QzEzMS4wMDMgMTguMjU4IDEyOS43MjkgMTguODA0IDEyOC43MzQgMTkuODk5QzEyNy43MzggMjAuOTkzIDEyNy4yMzkgMjIuNDM4IDEyNy4yMzkgMjQuMjMzQzEyNy4yMzkgMjYuMDI4IDEyNy43MzUgMjcuNDMzIDEyOC43MzQgMjguNTE1QzEyOS43MjkgMjkuNTk0IDEzMS4wMjggMzAuMTM2IDEzMi42MzEgMzAuMTM2VjMwLjEzM1pNOTMuNjk4IDI3Ljg3NkM5My41Nzk1IDI4LjAwMjUgOTMuNDU2NCAyOC4xMjQ2IDkzLjMyOSAyOC4yNDJDOTEuOTQ3IDI5LjUxNiA5MC4xMjMgMzAuMTU1IDg3Ljg2NiAzMC4xNTVDODYuNTggMzAuMTU1IDg1LjQwOCAyOS45MjYgODQuMzUgMjkuNDY0QzgzLjMxNTUgMjkuMDE4OSA4Mi4zODk4IDI4LjM1NDYgODEuNjM3IDI3LjUxN0M4MC44ODQgMjYuNjc5IDgwLjMwMSAyNS42NzIgNzkuODg5IDI0LjQ5NEM3OS40NzYgMjMuMzE1IDc5LjI2OSAyMi4wMSA3OS4yNjkgMjAuNTc4Qzc5LjI2OSAxOS4xNDUgNzkuNDczIDE3Ljg0IDc5Ljg4OSAxNi42NjJDODAuMzAxIDE1LjQ4NCA4MC44ODQgMTQuNDc2IDgxLjYzNyAxMy42MzlDODIuMzk0OSAxMi43OTg3IDgzLjMyNzMgMTIuMTM0MiA4NC4zNjkgMTEuNjkyQzg1LjQzNiAxMS4yMyA4Ni42MTQgMTEgODcuOTAzIDExQzkwLjU3IDExIDkyLjU5NSAxMS42NDIgOTMuOTc3IDEyLjkyNkw5Ny4yNTggOS42NDQ5OUM5NC43NzQgNy43MTA5OSA5MS42MzMgNi43Mzk5OSA4Ny44MjkgNi43Mzk5OUM4NS43MTggNi43Mzk5OSA4My44MTEgNy4wNzQ5OSA4Mi4xMTIgNy43NDE5OUM4MC40MTMgOC40MDc5OSA3OC45NTYgOS4zNDQ5OSA3Ny43NCAxMC41NDVDNzYuNTI1IDExLjc0NyA3NS41OTIgMTMuMTk5IDc0LjkzNCAxNC44OThDNzQuMjc3IDE2LjU5NyA3My45NTEgMTguNDkxIDczLjk1MSAyMC41ODFDNzMuOTUxIDIyLjY3IDc0LjI4NiAyNC41MzQgNzQuOTUzIDI2LjI0NUM3NS42MTkgMjcuOTU3IDc2LjU2MiAyOS40MTQgNzcuNzc0IDMwLjYxN0M3OC45OSAzMS44MiA4MC40NDQgMzIuNzUzIDgyLjE0NiAzMy40MjNDODMuODQ1IDM0LjA5IDg1LjczOSAzNC40MjQgODcuODI5IDM0LjQyNEM4OS45MTkgMzQuNDI0IDkxLjcwOCAzNC4wOSA5My4zNDggMzMuNDIzQzk0LjcxOCAzMi44NjUgOTUuOTE4IDMyLjEyMSA5Ni45NDggMzEuMTkxQzk3LjE0OSAzMS4wMDggOTcuMzQ4IDMwLjgxNSA5Ny41MzcgMzAuNjJMOTMuNzAxIDI3Ljg4NUw5My42OTggMjcuODc2Wk0xMTAuODAyIDE0LjAxNUMxMDkuMTk5IDE0LjAxNSAxMDYuODM2IDE0LjQ3MSAxMDUuNjExIDE2LjE1OEwxMDUuNTM3IDYuMDE1OTlIMTAwLjc2NVYzMy45MzlIMTA1LjcyVjIyLjY0MUMxMDUuNzcxIDIxLjQ2MDcgMTA2LjI4OCAyMC4zNDg4IDEwNy4xNTcgMTkuNTQ4OUMxMDguMDI3IDE4Ljc0OTEgMTA5LjE3OCAxOC4zMjY2IDExMC4zNTggMTguMzc0QzExMy4zOTcgMTguMzc0IDExNC4yNjggMjEuMTU5IDExNC4yNjggMjIuNjQxVjMzLjkzOUgxMTkuMjIzVjIxLjA1OUMxMTkuMjIzIDIxLjA1OSAxMTkuMTQyIDE0LjAxNSAxMTAuODAyIDE0LjAxNVpNMTczLjc2MyAxNC4zNThIMTY5Ljk5OVY4LjcxNDk5SDE2NS4wNDhWMTQuMzU4SDE2MS4yODRWMTguOTE2SDE2NS4wNDhWMzQuMDAzSDE2OS45OTlWMTguOTE2SDE3My43NjNWMTQuMzU4Wk0xOTAuNzg3IDI1LjI2MkMxOTAuMTI5IDI0LjUwMTQgMTg5LjMwNyAyMy44OTk0IDE4OC4zODQgMjMuNTAxQzE4Ny40ODggMjMuMTE3IDE4Ni4zMzEgMjIuNzMyIDE4NC45NDggMjIuMzY0QzE4NC4xNjUgMjIuMTQzOSAxODMuMzkgMjEuODk3OCAxODIuNjIzIDIxLjYyNkMxODIuMTYzIDIxLjQ2MjEgMTgxLjc0MSAyMS4yMDY2IDE4MS4zODMgMjAuODc1QzE4MS4yMzUgMjAuNzQyMSAxODEuMTE4IDIwLjU3ODkgMTgxLjAzOSAyMC4zOTY0QzE4MC45NjEgMjAuMjE0IDE4MC45MjIgMjAuMDE2NiAxODAuOTI3IDE5LjgxOEMxODAuOTI3IDE5LjI3MiAxODEuMTU2IDE4Ljg0NCAxODEuNjI1IDE4LjUxQzE4Mi4xMjEgMTguMTU2IDE4Mi44NjIgMTcuOTc2IDE4My44MjYgMTcuOTc2QzE4NC43OSAxNy45NzYgMTg1LjU4NyAxOC4yMDkgMTg2LjE0OCAxOC42NjhDMTg2LjcwNiAxOS4xMjQgMTg3LjAwNyAxOS43MjUgMTg3LjA3MiAyMC41TDE4Ny4wOTQgMjAuNzgySDE5MS42MzNMMTkxLjYxNyAyMC40NkMxOTEuNTIxIDE4LjQ4NSAxOTAuNzcxIDE2LjkgMTg5LjM4NSAxNS43NUMxODguMDEyIDE0LjYxMiAxODYuMTg1IDE0LjAzMyAxODMuOTYyIDE0LjAzM0MxODIuNDc3IDE0LjAzMyAxODEuMTQxIDE0LjI4NyAxNzkuOTk0IDE0Ljc4NkMxNzguODMxIDE1LjI5MSAxNzcuOTI2IDE1Ljk5NSAxNzcuMjk2IDE2Ljg4MkMxNzYuNjczIDE3Ljc0NTUgMTc2LjMzOCAxOC43ODQgMTc2LjM0MSAxOS44NDlDMTc2LjM0MSAyMS4xNjcgMTc2LjY5OCAyMi4yNDkgMTc3LjM5OSAyMy4wNjRDMTc4LjA2IDIzLjg0MzIgMTc4Ljg5OCAyNC40NTM0IDE3OS44NDIgMjQuODQ0QzE4MC43NDQgMjUuMjE2IDE4MS45MjggMjUuNjA3IDE4My4zNjEgMjZDMTg0LjgwNiAyNi40MSAxODUuODcyIDI2Ljc4NSAxODYuNTMgMjcuMTIzQzE4Ny4xIDI3LjQxNCAxODcuMzc5IDI3Ljg0NSAxODcuMzc5IDI4LjQ0NEMxODcuMzc5IDI5LjA0MiAxODcuMTIyIDI5LjQ2NyAxODYuNTk1IDI5LjgzOUMxODYuMDQzIDMwLjIyNiAxODUuMjM3IDMwLjQyNSAxODQuMjAxIDMwLjQyNUMxODMuMTY2IDMwLjQyNSAxODIuMzk0IDMwLjE3NCAxODEuNzQ5IDI5LjY3NEMxODEuMTEzIDI5LjE4MSAxODAuNzcyIDI4LjU4OSAxODAuNzEgMjcuODY0TDE4MC42ODUgMjcuNTgySDE3Ni4wMTNMMTc2LjAyNSAyNy45MDFDMTc2LjA2NyAyOS4wOTU1IDE3Ni40NzIgMzAuMjQ4NyAxNzcuMTg4IDMxLjIwNkMxNzcuOTA3IDMyLjE4IDE3OC44OTMgMzIuOTU4IDE4MC4xMTggMzMuNTE5QzE4MS4zMzYgMzQuMDc3IDE4Mi43MzIgMzQuMzYyIDE4NC4yNjYgMzQuMzYyQzE4NS44MDEgMzQuMzYyIDE4Ny4xMDkgMzQuMTA4IDE4OC4yMzggMzMuNjA5QzE4OS4zNzYgMzMuMTA0IDE5MC4yNzIgMzIuMzk0IDE5MC45MDEgMzEuNDk0QzE5MS41MzQgMzAuNTkyIDE5MS44NTMgMjkuNTU0IDE5MS44NTMgMjguNDAzQzE5MS44MjggMjcuMTEgMTkxLjQ2NiAyNi4wNTMgMTkwLjc3NyAyNS4yNjJIMTkwLjc4N1oiIGZpbGw9IiM5QjlCOUIiLz4KPHBhdGggZD0iTTI0MS45ODIgMjUuNjU4MlYxNy43MTE3SDIyOC40NDFMMjIwLjQ5NCAyNS42NTgySDI0MS45ODJaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNTcuMjM5IDUuOTUwODFIMjQwLjI2NUwyMzIuMjU1IDEzLjg5NzNIMjU3LjIzOVY1Ljk1MDgxWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjEyLjYxMSAzMy42MDQ4TDIxNi42OCAyOS41MzYxSDIzMC40MTJWMzcuNDgyN0gyMTIuNjExVjMzLjYwNDhaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yMTUuNTk5IDIxLjc4MDNIMjI0LjM3MkwyMzIuMzgyIDEzLjgzMzdIMjE1LjU5OVYyMS43ODAzWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjA2IDMzLjYwNDdIMjEyLjYxMUwyMjAuNDk0IDI1LjY1ODJIMjA2VjMzLjYwNDdaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNDAuMjY1IDUuOTUwODFMMjM2LjE5NyAxMC4wMTk0SDIxMC4yNTlWMi4wNzI4OEgyNDAuMjY1VjUuOTUwODFaIiBmaWxsPSIjOUI5QjlCIi8+Cjwvc3ZnPgo=",width:170,height:25,right:25,bottom:50,opacity:.7}}));const c={...i.chartOptions.specialOverrides},h={...i.chartOptions.optionMetadata},d=await this.chart?.ctx.dataService.getData(),u=this.factoryApi.create(l,r,c,h,d);await u.setState(a);const p={source:"chart-update",sourceDetail:"internal-prepareResizedChart"};u.chart?.ctx.zoomManager.updateZoom(p,i.ctx.zoomManager.getZoom()),u.chart?.ctx.legendManager.clearData(),u.chart?.ctx.legendManager.update(i.ctx.legendManager.getData());for(const[y,b]of i.series.entries())u.chart.series[y].visible=b.visible;const f=[];for(const y of i.modulesManager.legends())f.push(y.legend.pagination?.currentPage??0);for(const y of u.chart.modulesManager.legends()){const b=f.shift()??0;y.legend.pagination&&y.legend.pagination.setPage(b)}return u.chart?.update(0,{forceNodeDataRefresh:!0}),await u.waitForUpdate(),u}getEnabledOriginators(){if(!this.chart)return[];const{chartOptions:{processedOptions:t,optionMetadata:i},ctx:{annotationManager:s,chartTypeOriginator:n,zoomManager:o,legendManager:a},modulesManager:r}=this.chart,l=[];return"annotations"in t&&t.annotations?.enabled&&l.push(s),i.presetType==="price-volume"&&l.push(n),(t.navigator?.enabled||t.zoom?.enabled)&&l.push(o),r.isEnabled("legend")&&t.legend?.enabled!==!1&&l.push(a),l}async setStateOriginators(t,i){this.factoryApi.caretaker.restore(t,...i),this.chart?.ctx.updateService.update(2,{forceNodeDataRefresh:!0}),await this.chart?.waitForUpdate()}};tf.chartInstances=new WeakMap,g([He({oldValue(e){e.destroyed||(e.publicApi=void 0),tf.chartInstances.delete(e)},newValue(e){e&&(e.publicApi=this,tf.chartInstances.set(e,this))}})],tf.prototype,"chart",2);var SO=tf,XU=1e3,BD=class xc{constructor(t,i,s,n,o,a=XU){this.name=t,this.buildItem=i,this.releaseItem=s,this.destroyItem=n,this.maxPoolSize=o,this.cleanupTimeMs=a,this.freePool=[],this.busyPool=new Set}static getPool(t,i,s,n,o){return this.pools.has(t)||this.pools.set(t,new xc(t,i,s,n,o)),this.pools.get(t)}isFull(){return this.freePool.length+this.busyPool.size>=this.maxPoolSize}hasFree(){return this.freePool.length>0}obtain(t){if(!this.hasFree()&&this.isFull())throw new Error("AG Charts - pool exhausted");let i=this.freePool.pop();return i==null?(i=this.buildItem(t),xc.debug(()=>[`Pool[name=${this.name}]: Created instance (${this.freePool.length} / ${this.busyPool.size+1} / ${this.maxPoolSize})`,i])):xc.debug(()=>[`Pool[name=${this.name}]: Re-used instance (${this.freePool.length} / ${this.busyPool.size+1} / ${this.maxPoolSize})`,i]),this.busyPool.add(i),{item:i,release:()=>this.release(i)}}obtainFree(){const t=this.freePool.pop();if(t==null)throw new Error("AG Charts - pool has no free instances");return xc.debug(()=>[`Pool[name=${this.name}]: Re-used instance (${this.freePool.length} / ${this.busyPool.size+1} / ${this.maxPoolSize})`,t]),this.busyPool.add(t),{item:t,release:()=>this.release(t)}}release(t){if(!this.busyPool.has(t))throw new Error("AG Charts - cannot free item from pool which is not tracked as busy.");xc.debug(()=>[`Pool[name=${this.name}]: Releasing instance (${this.freePool.length} / ${this.busyPool.size} / ${this.maxPoolSize})`,t]),this.releaseItem(t),this.busyPool.delete(t),this.freePool.push(t),xc.debug(()=>[`Pool[name=${this.name}]: Returned instance to free pool (${this.freePool.length} / ${this.busyPool.size} / ${this.maxPoolSize})`,t]);const i=Date.now(),s=i+this.cleanupTimeMs*.5;this.cleanPoolTimer&&(this.cleanPoolDue??1/0)<s&&(clearTimeout(this.cleanPoolTimer),this.cleanPoolTimer=void 0),this.cleanPoolTimer||(this.cleanPoolDue=i+this.cleanupTimeMs,this.cleanPoolTimer=setTimeout(this.cleanPool.bind(this),this.cleanupTimeMs))}cleanPool(){const t=this.freePool.splice(0);for(const i of t)this.destroyItem(i);xc.debug(()=>[`Pool[name=${this.name}]: Cleaned pool of ${t.length} items (${this.freePool.length} / ${this.busyPool.size} / ${this.maxPoolSize})`])}destroy(){this.cleanPool();for(const t of this.busyPool.values())this.destroyItem(t);this.busyPool.clear()}};BD.pools=new Map,BD.debug=Me.create(!0,"pool");var qU=BD,wr=Me.create(!0,"opts"),fo=class{static licenseCheck(e){this.licenseChecked||(this.licenseManager=Oi.licenseManager?.(e),this.licenseManager?.validateLicense(),this.licenseChecked=!0)}static getLicenseDetails(e){return Oi.licenseManager?.({}).getLicenseDetails(e)}static getInstance(e){return MO.getInstance(e)}static create(e,t){const i=Me.check("scene:stats","scene:stats:verbose")?performance.now():void 0;return wr.group("AgCharts.create()",()=>{e=Me.inDevelopmentMode(()=>on(Re(e)))??e,this.licenseCheck(e);const s=MO.createOrUpdate({userOptions:e,licenseManager:this.licenseManager,optionsMetadata:t,apiStartTime:i});return this.licenseManager?.isDisplayWatermark()&&this.licenseManager&&Oi.injectWatermark?.(s.chart.ctx.domManager,this.licenseManager.getWatermarkMessage()),s})}static createFinancialChart(e){return wr.group("AgCharts.createFinancialChart()",()=>this.create(e,{presetType:"price-volume"}))}static createGauge(e){return wr.group("AgCharts.createGauge()",()=>this.create(e,{presetType:"gauge-preset"}))}static __createSparkline(e){return wr.group("AgCharts.__createSparkline()",()=>{const{pool:t,...i}=e;return this.create(i,{presetType:"sparkline",pool:t??!0,domMode:"minimal",withDragInterpretation:!1})})}};fo.licenseChecked=!1;var La=class nm{static getInstance(t){const i=mx.getInstance(t);return i?SO.chartInstances.get(i):void 0}static createOrUpdate(t){let{proxy:i}=t;const{userOptions:s,licenseManager:n,processedOverrides:o=i?.chart?.chartOptions.processedOverrides??{},specialOverrides:a=i?.chart?.chartOptions.specialOverrides??{},optionsMetadata:r=i?.chart?.chartOptions.optionMetadata??{},deltaOptions:l,data:c,stripSymbols:h=!1,apiStartTime:d}=t,u=Oi.styles==null?[]:[["ag-charts-enterprise",Oi.styles]];if(me.listModules().next().done)throw new Error(["AG Charts - No modules have been registered.","","Call ModuleRegistry.registerModules(...) with the modules you need before using AgCharts.create().","","See https://www.ag-grid.com/charts/r/module-registry/ for more details."].join(`
`));wr(()=>[">>> AgCharts.createOrUpdate() user options",Re(s)]);const{presetType:p}=r;let f=s;fo.optionsMutationFn&&f&&(f=fo.optionsMutationFn(Re(f,ef.OPTIONS_CLONE_OPTS_FAST),p),wr(()=>[">>> AgCharts.createOrUpdate() MUTATED user options",Re(f)]));const y=this.getPool(r);let b=!1,x,v=i?.chart;v==null&&y?.hasFree()&&(x=y.obtainFree(),v=x.item);const{document:S,window:M,styleContainer:D,...k}=f??{},I=v?.getChartOptions(),A=new ef(I,k,o,{...a,document:S,window:M,styleContainer:D},r,l,h,d);(v==null||Vg(A.processedOptions)!==Vg(v.chartOptions.processedOptions))&&(x?.release(),x=this.getPool(A.optionMetadata)?.obtain(A),x?v=x.item:(b=!0,v=nm.createChartInstance(A,v))),A.optionsGraph&&v.ctx.optionsGraphService.updateCallback((C,w,T)=>A.optionsGraph?.resolvePartial(C,w,T));for(const[C,w]of u)v.ctx.domManager.addStyles(C,w);return v.ctx.fontManager.updateFonts(A.googleFonts),c!=null&&v.ctx.dataService.restoreData(c),i==null?(i=new SO(v,nm.callbackApi,n),i.releaseChart=x?.release):(x||b)&&(i.releaseChart?.(),i.chart=v,i.releaseChart=x?.release),wr.check()&&typeof globalThis.window<"u"&&(globalThis.agChartInstances??(globalThis.agChartInstances={}),globalThis.agChartInstances[v.id]=v),v.queuedUserOptions.push(A.userOptions),v.queuedChartOptions.push(A),v.requestFactoryUpdate(C=>{wr.group(">>>> Chart.applyOptions()",()=>{C.applyOptions(A);const w=C.queuedUserOptions.indexOf(A.userOptions)+1;C.queuedUserOptions.splice(0,w),C.queuedChartOptions.splice(0,w)})}),i}static updateUserDelta(t,i,s){i=Re(i,ef.OPTIONS_CLONE_OPTS_FAST);const n=ya(i,nm.markRemovedProperties,new Set(["data"]),void 0,void 0,!1);wr(()=>[">>> AgCharts.updateUserDelta() user delta",Re(i)]),nm.createOrUpdate({proxy:t,deltaOptions:i,stripSymbols:n,apiStartTime:s})}static createChartInstance(t,i){const s=i?.destroy({keepTransferableResources:!0}),n=Vg(t.processedOptions);return me.getChartModule(n).create(t,s)}static getPool(t){if(t.pool===!0)return qU.getPool(t.presetType??"default",this.createChartInstance,this.detachAndClear,this.destroy,1/0)}};La.caretaker=new Bm(ue),La.callbackApi={caretaker:La.caretaker,create(e,t,i,s,n){return La.createOrUpdate({userOptions:e,processedOverrides:t,specialOverrides:i,optionsMetadata:s,data:n})},update(e,t,i,s){return La.createOrUpdate({userOptions:e,proxy:t,specialOverrides:i,apiStartTime:s})},updateUserDelta(e,t,i){return La.updateUserDelta(e,t,i)}},La.markRemovedProperties=(e,t,i,s)=>{let n=s??!1;if(typeof e!="object"||e==null)return n;for(const o of To(e))e[o]===void 0&&(Object.assign(e,{[o]:Symbol("UNSET")}),n||(n=!0));return n},La.detachAndClear=e=>e.detachAndClear(),La.destroy=e=>e.destroy();var MO=La,L={};Vs(L,{APPROXIMATE_THRESHOLD:()=>a4,AbstractBarSeries:()=>VO,AbstractBarSeriesProperties:()=>YD,AggregationManager:()=>Kx,AnchoredPopover:()=>C2,ApproximateOrdinalTimeScale:()=>s3,Arc:()=>Na,Axis:()=>oD,AxisGroupZIndexMap:()=>vN,AxisInterval:()=>Zc,AxisLabel:()=>Nt,AxisTick:()=>Xc,BBox:()=>re,Background:()=>nu,BandScale:()=>Ma,BaseToolbar:()=>yI,Caption:()=>Et,CartesianAxis:()=>_g,CartesianCrossLine:()=>ws,CartesianSeries:()=>Wl,CartesianSeriesNodeEvent:()=>$D,CartesianSeriesProperties:()=>Zo,CategoryAxis:()=>nf,CategoryScale:()=>qc,Chart:()=>mx,ChartAxes:()=>Ky,ChartOptions:()=>ef,CollapseMode:()=>ZO,ColorScale:()=>Xd,ContextMenuRegistry:()=>UT,ContinuousScale:()=>yt,DEFAULT_CARTESIAN_DIRECTION_KEYS:()=>Fu,DEFAULT_CARTESIAN_DIRECTION_NAMES:()=>zu,DEFAULT_POLAR_DIRECTION_KEYS:()=>u2,DEFAULT_POLAR_DIRECTION_NAMES:()=>p2,DIRECTION_SWAP_AXES:()=>qN,DOMManager:()=>yT,DataController:()=>pN,DataModel:()=>HM,DataModelSeries:()=>WD,DataSet:()=>cu,DiscreteTimeAxis:()=>m2,DraggablePopover:()=>L2,DropShadow:()=>Ta,ExtendedPath2D:()=>qd,FILL_GRADIENT_BLANK_DEFAULTS:()=>s$,FILL_GRADIENT_CONIC_SERIES_DEFAULTS:()=>l$,FILL_GRADIENT_LINEAR_DEFAULTS:()=>Fl,FILL_GRADIENT_LINEAR_HIERARCHY_DEFAULTS:()=>n$,FILL_GRADIENT_LINEAR_KEYED_DEFAULTS:()=>a$,FILL_GRADIENT_LINEAR_SINGLE_DEFAULTS:()=>o$,FILL_GRADIENT_RADIAL_REVERSED_DEFAULTS:()=>$g,FILL_GRADIENT_RADIAL_REVERSED_SERIES_DEFAULTS:()=>QN,FILL_GRADIENT_RADIAL_SERIES_DEFAULTS:()=>r$,FILL_IMAGE_BLANK_DEFAULTS:()=>p$,FILL_IMAGE_DEFAULTS:()=>Ar,FILL_PATTERN_BLANK_DEFAULTS:()=>h$,FILL_PATTERN_DEFAULTS:()=>Pn,FILL_PATTERN_HIERARCHY_DEFAULTS:()=>d$,FILL_PATTERN_KEYED_DEFAULTS:()=>u$,FILL_PATTERN_SINGLE_DEFAULTS:()=>c$,FillGradientDefaults:()=>Tl,FillImageDefaults:()=>Dr,FillPatternDefaults:()=>Ii,FloatingToolbar:()=>h3,FormatManager:()=>ru,Group:()=>Oe,HierarchyHighlightState:()=>g2,HierarchyNode:()=>UK,HierarchySeries:()=>KK,HierarchySeriesProperties:()=>$l,HighlightManager:()=>YT,HighlightProperties:()=>Mr,HighlightState:()=>ZT,Image:()=>_u,InteractionManager:()=>WT,InteractionState:()=>jT,LABEL_BOXING_DEFAULTS:()=>ka,LARGEST_KEY_INTERVAL:()=>VT,LEGEND_CONTAINER_THEME:()=>e1,Label:()=>Yt,LayoutElement:()=>QM,Line:()=>En,LinearScale:()=>gh,LogScale:()=>HD,Marker:()=>ki,Menu:()=>o3,MercatorScale:()=>YK,NODE_UPDATE_STATE_TO_PHASE_MAPPING:()=>Ho,NativeWidget:()=>ou,NiceMode:()=>xN,Node:()=>vr,OrdinalTimeScale:()=>El,Path:()=>Fi,PointerEvents:()=>Gw,PolarAxis:()=>pI,PolarSeries:()=>lI,QuadtreeNearest:()=>LO,RadialColumnShape:()=>Xo,Range:()=>Ia,Rect:()=>Di,Rotatable:()=>Qd,RotatableText:()=>dT,SAFE_FILLS_OPERATION:()=>t$,SAFE_FILL_OPERATION:()=>e$,SAFE_RANGE2_OPERATION:()=>i$,SAFE_STROKE_FILL_OPERATION:()=>gD,SEGMENTATION_DEFAULTS:()=>yx,SMALLEST_KEY_INTERVAL:()=>_T,Scalable:()=>Hy,ScalableGroup:()=>FG,Scene:()=>Jy,Sector:()=>ms,SectorBox:()=>S2,SegmentedPath:()=>jD,Selection:()=>ci,Series:()=>Hg,SeriesItemHighlightStyle:()=>wl,SeriesMarker:()=>Xs,SeriesNodeEvent:()=>gx,SeriesNodePickMode:()=>zN,SeriesProperties:()=>Go,SeriesTooltip:()=>Tr,Shape:()=>Hc,SliderWidget:()=>TM,StopProperties:()=>yM,SvgPath:()=>v2,Text:()=>rn,TimeAxisParentLevel:()=>Ru,TimeScale:()=>du,Toolbar:()=>l3,ToolbarButtonWidget:()=>w2,ToolbarWidget:()=>Qy,TooltipManager:()=>lx,Transformable:()=>Kt,TransformableGroup:()=>eu,TransformableText:()=>su,Translatable:()=>Jd,TranslatableGroup:()=>ls,TranslatableSvgPath:()=>i3,UnitTimeScale:()=>Pl,ZoomManager:()=>dN,accumulativeValueProperty:()=>jM,addHitTestersToQuadtree:()=>Fx,adjustLabelPlacement:()=>EO,angleCategoryAxisOptionsDefs:()=>SD,angleNumberAxisOptionsDefs:()=>h1,animationValidation:()=>Fg,annotationCalloutStylesDefs:()=>T1,annotationChannelTextDefs:()=>I1,annotationCommentStylesDefs:()=>N1,annotationCrossLineStyleDefs:()=>AD,annotationDisjointChannelStyleDefs:()=>L1,annotationFibonacciStylesDefs:()=>CD,annotationLineStyleDefs:()=>kx,annotationLineTextDefs:()=>Ix,annotationMeasurerStylesDefs:()=>Ax,annotationNoteStylesDefs:()=>O1,annotationOptionsDef:()=>Cu,annotationParallelChannelStyleDefs:()=>w1,annotationQuickMeasurerStylesDefs:()=>E1,annotationShapeStylesDefs:()=>LD,annotationTextStylesDef:()=>Zg,boxPlotSeriesThemeableOptionsDef:()=>z1,buildResetPathFn:()=>rI,calculateDataDiff:()=>h2,calculateLabelTranslation:()=>QK,calculateSegments:()=>Ox,candlestickSeriesThemeableOptionsDef:()=>_1,checkCrisp:()=>r2,chordSeriesThemeableOptionsDef:()=>V1,clippedRoundRect:()=>$y,collapsedStartingBarPosition:()=>cf,computeBarFocusBounds:()=>tI,computeMarkerFocusBounds:()=>Gx,coneFunnelSeriesThemeableOptionsDef:()=>G1,createDatumId:()=>cs,diff:()=>ax,drawCorner:()=>Lg,drawMarkerUnitPolygon:()=>jg,findQuadtreeMatch:()=>zx,fixNumericExtent:()=>ln,fromToMotion:()=>li,funnelSeriesThemeableOptionsDef:()=>H1,generateTicks:()=>NN,getColorStops:()=>Kw,getCrossLineValue:()=>mN,getItemStyles:()=>YM,getItemStylesPerItemId:()=>t4,getLabelStyles:()=>fh,getMarkerStyles:()=>Hx,getMissCount:()=>LT,getRadialColumnWidth:()=>M2,getShapeFill:()=>FN,getShapeStyle:()=>hD,groupAccumulativeValueProperty:()=>Pg,heatmapSeriesThemeableOptionsDef:()=>j1,interpolatePoints:()=>lf,isTooltipValueMissing:()=>Jc,keyProperty:()=>Ll,makeSeriesTooltip:()=>yh,mapLineBackgroundSeriesThemeableOptionsDef:()=>U1,mapLineSeriesThemeableOptionsDef:()=>$1,mapMarkerSeriesThemeableOptionsDef:()=>K1,mapShapeBackgroundSeriesThemeableOptionsDef:()=>Z1,mapShapeSeriesThemeableOptionsDef:()=>Y1,markerEnabled:()=>oI,markerFadeInAnimation:()=>uf,markerSeriesHighlightStyle:()=>mD,markerSwipeScaleInAnimation:()=>sI,midpointStartingBarPosition:()=>GK,minimumTimeAxisDatumGranularity:()=>wO,motion:()=>u3,multiSeriesHighlightStyle:()=>Ug,nightingaleSeriesThemeableOptionsDef:()=>X1,normaliseGroupTo:()=>nx,ohlcSeriesThemeableOptionsDef:()=>W1,ordinalTimeAxisOptionsDefs:()=>Iu,pairUpSpans:()=>rf,pathFadeInAnimation:()=>jx,pathMotion:()=>Yx,pathSwipeInAnimation:()=>aI,plotAreaPathFill:()=>l2,plotInterpolatedLinePathStroke:()=>_x,plotLinePathStroke:()=>qD,predictCartesianFinancialAxis:()=>iK,predictCartesianNonPrimitiveAxis:()=>sf,prepareAreaFillAnimationFns:()=>c2,prepareBarAnimationFunctions:()=>hf,prepareLinePathPropertyAnimation:()=>QD,processedDataIsAnimatable:()=>lo,pyramidSeriesThemeableOptionsDef:()=>q1,radarAreaSeriesThemeableOptionsDef:()=>Q1,radarLineSeriesThemeableOptionsDef:()=>J1,radialBarSeriesThemeableOptionsDef:()=>eO,radialColumnSeriesThemeableOptionsDef:()=>tO,radiusCategoryAxisOptionsDefs:()=>u1,radiusNumberAxisOptionsDefs:()=>d1,rangeAreaSeriesThemeableOptionsDef:()=>nO,rangeBarSeriesThemeableOptionsDef:()=>aO,resetAxisLabelSelectionFn:()=>ux,resetBarSelectionsDirect:()=>eI,resetBarSelectionsFn:()=>df,resetLabelFn:()=>mh,resetMarkerFn:()=>Vx,resetMarkerPositionFn:()=>pf,resetMarkerSelectionsDirect:()=>nI,resetMotion:()=>Ui,sankeySeriesThemeableOptionsDef:()=>rO,sectorBox:()=>y2,seriesLabelFadeInAnimation:()=>qt,seriesLabelFadeOutAnimation:()=>Ex,singleSeriesHighlightStyle:()=>g$,stackCartesianSeries:()=>NO,standaloneChartOptionsDefs:()=>tK,sunburstSeriesThemeableOptionsDef:()=>lO,toHierarchyHighlightString:()=>$x,toHighlightString:()=>lu,topologyChartOptionsDefs:()=>eK,trailingAccumulatedValueProperty:()=>_j,treemapSeriesThemeableOptionsDef:()=>cO,updateClipPath:()=>Wx,updateLabelNode:()=>OO,userInteraction:()=>d4,validateCrossLineValue:()=>yN,valueProperty:()=>Ct,visibleRangeIndices:()=>zg,waterfallSeriesThemeableOptionsDef:()=>hO});var Nx={mode:ee(Z("integrated","standalone")),container:bm,context:()=>!0,theme:le,series:sn,annotations:le,navigator:le,initialState:{chartType:N,annotations:le,legend:Ft({visible:R,seriesId:N,itemId:N,legendItemName:N},"legend state array"),zoom:le}},QU={...we,...Nx,axes:Xa,data:sn},JU={...we,...Nx,axes:Xa,data:sn},eK={...we,...Nx,data:sn,topology:ml},tK={...we,...Nx,data:sn};function DO(e){return e.isReversed()!==e.range[1]<e.range[0]}function Ox(e,t,i,s,n,o=!0){if(t.scale.domain.length===0||i.scale.domain.length===0)return;const a=e.key==="x"?t:i,{scale:r,direction:l}=a,c=l==="x",h=r.bandwidth??0,d=o?((r.step??0)-h)/2:0,u=Math.max(s.x,n.width-(s.x+s.width)),p=Math.max(s.y,n.height-(s.y+s.height)),f=()=>DO(c?t:i)?c?s.width+u:s.height+p:c?-u:-p,y=()=>DO(c?t:i)?c?-u:-p:c?s.width+u:s.height+p;return(x=>{const v=[];let S=-1;for(let M=0;M<x.length;M++){const D=x[M];if(id(D))continue;const{start:k,stop:I,...A}=x[M],C=x[S]?.stop,w=x.slice(M+1).find(F=>F.start!=null)?.start;let T=r.convert(k??C)-d,O=r.convert(I??w)+2*d;const E=k!=null&&Number.isNaN(T),z=I!=null&&Number.isNaN(O);E||z||(Number.isNaN(T)&&(T=f()),Number.isNaN(O)&&(O=y()),I!=null&&(S=M),v.push({start:T,stop:O,...A}))}return v})(e.segments).map(({stop:x,start:v,...S})=>{const M=c?v:-u,D=c?-p:v,k=c?x+h:s.width+u,I=c?s.height+p:x+h;return{clipRect:{x0:M,y0:D,x1:k,y1:I},...S}})}var IO=new Set(["time","timestamp","date","datetime"]);function _D(e,t,i,{allowPrimitiveTypes:s=!0}={}){if(e!=="x"&&e!=="y"||!fe(t))return;const n=kO(e,i);if(n==null||!(n in t))return;const o=t[n],a=AO(e,i),r=sK(o);if(r)return{type:r,position:a};const l=nK(n,o);if(l)return{type:l,position:a};if(s)return typeof o=="number"?{type:"number",position:a}:{type:"category",position:a}}function sf(e,t,i){return _D(e,t,i,{allowPrimitiveTypes:!1})}function iK(e,t,i){if(e!=="x"||!fe(t))return;const s=kO(e,i);if(s==null||!(s in t))return;const n=t[s],o=AO(e,i),a=oK(s,n);if(a)return{type:a,position:o};if(Rt(n))return{type:"category",position:o}}function sK(e){if(Ce(e)&&e.every(Rt))return"grouped-category"}function nK(e,t){if(Is(t)||IO.has(e)&&gt(t))return"time"}function oK(e,t){if(Is(t)||IO.has(e)&&gt(t))return"ordinal-time"}function kO(e,t){if(e==="x"&&"xKey"in t)return t.xKey;if(e==="y"&&"yKey"in t)return t.yKey}function AO(e,t){return"direction"in t&&t.direction==="horizontal"?e==="x"?"left":"bottom":e==="x"?"bottom":"left"}var aK={2:(e,t)=>Math.log2(t),[Math.E]:(e,t)=>Math.log(t),10:(e,t)=>Math.log10(t)},rK=(e,t)=>Math.log(t)/Math.log(e);function VD(e,t,i){const s=Math.min(...t),n=aK[e]??rK;return s>=0?n(e,i):-n(e,-i)}var lK={[Math.E]:(e,t)=>Math.exp(t),10:(e,t)=>t>=0?10**t:1/10**-t},cK=(e,t)=>e**t;function GD(e,t,i){const s=Math.min(...t),n=lK[e]??cK;return s>=0?n(e,i):-n(e,-i)}var HD=class YB extends yt{constructor(t=[1,10],i=[0,1]){super(t,i),this.type="log",this.defaultClamp=!0,this.base=10,this.log=s=>VD(this.base,this.domain,s),this.pow=s=>GD(this.base,this.domain,s)}static is(t){return t instanceof YB}transform(t){const[i,s]=Tt(this.domain);return i>=0!=s>=0?Number.NaN:i>=0?Math.log(t):-Math.log(-t)}transformInvert(t){const[i,s]=Tt(this.domain);return i>=0!=s>=0?Number.NaN:i>=0?Math.exp(t):-Math.exp(-t)}toDomain(t){return t}niceDomain(t,i=this.domain){if(i.length<2)return[];const{base:s}=this,[n,o]=i,a=n>o?Math.ceil:Math.floor,r=n>o?Math.floor:Math.ceil,l=GD(s,i,a(VD(s,i,n))),c=GD(s,i,r(VD(s,i,o)));return[t.nice[0]?l:i[0],t.nice[1]?c:i[1]]}ticks({interval:t,tickCount:i=yt.defaultTickCount},s=this.domain,n){if(!s||s.length<2||i<1)return;const o=this.base,[a,r]=s,l=Math.min(a,r),c=Math.max(a,r);let h=this.log(l),d=this.log(c);if(t){const b=k=>k>=l&&k<=c,x=Math.min(Math.abs(t),Math.abs(d-h)),{ticks:v,count:S,firstTickIndex:M}=zc(h,d,x,n),D=v.map(this.pow).filter(b);if(!Ml(D.length,this.getPixelRange()))return{ticks:D,count:S,firstTickIndex:M}}if(!mS(o)||d-h>=i){const b=Math.min(d-h,i),{ticks:x,count:v,firstTickIndex:S}=Rc(h,d,b,void 0,void 0,n);return{ticks:x.map(this.pow),count:v,firstTickIndex:S}}const u=[],p=l>0;h=Math.floor(h)-1,d=Math.round(d)+1;const f=da(this.range)/i;let y=1/0;for(let b=h;b<=d;b++){const x=this.convert(this.pow(b+1));for(let v=1;v<o;v++){const S=p?v:o-v+1,M=this.pow(b)*S,D=this.convert(M),k=Math.abs(y-D),I=Math.abs(D-x),A=k>=f&&I>=f;M>=l&&M<=c&&(v===1||A||u.length===0)&&(u.push(M),y=D)}}return jw(u,p,n)}},jD=class extends Fi{constructor(){super(...arguments),this.segmentPath=new Fi}drawPath(e){if(!this.segments||this.segments.length===0){super.drawPath(e);return}e.save();const t=new Path2D;Pu(t,{x0:0,y0:0,x1:e.canvas.width,y1:e.canvas.height},!1);for(const s of this.segments)Pu(t,s.clipRect);e.clip(t),super.drawPath(e),e.restore();const{segmentPath:i}=this;i.setProperties({opacity:this.opacity,visible:this.visible,lineCap:this.lineCap,lineJoin:this.lineJoin,pointerEvents:this.pointerEvents});for(const{clipRect:s,fill:n,stroke:o,...a}of this.segments){e.save(),i.path=this.path,i.setProperties(a),i.fill=this.fill==null?"none":n,i.stroke=this.stroke==null?"none":o;const r=new Path2D;Pu(r,s),e.clip(r),i.drawPath(e),e.restore()}}};g([Ig()],jD.prototype,"segments",2);function Pu(e,{x0:t,y0:i,x1:s,y1:n},o=!0){const a=Math.min(t,s),r=Math.min(i,n),l=Math.max(t,s),c=Math.max(i,n);e.moveTo(a,r),o?(e.lineTo(l,r),e.lineTo(l,c),e.lineTo(a,c)):(e.lineTo(a,c),e.lineTo(l,c),e.lineTo(l,r)),e.closePath()}var CO=class extends ls{constructor(){super(...arguments),this.segments=[],this.scalablePath=new(Hy(Fi))}renderInContext(e){if(!this.visible)return;const{ctx:t}=e;if(!this.segments||this.segments?.length===0)return super.renderInContext(e);t.save();const i=new Path2D;Pu(i,{x0:0,y0:0,x1:t.canvas.width,y1:t.canvas.height},!1);for(const n of this.segments)Pu(i,n.clipRect);t.clip(i);for(const n of this.children())n.visible&&n.render(e);t.restore();const{scalablePath:s}=this;for(const{clipRect:n,...o}of this.segments){t.save();const a=new Path2D;Pu(a,n),t.clip(a),s.setProperties(o);for(const r of this.children())!r.visible||!(r instanceof Fi)||(s.path=r.path,s.setProperties({opacity:r.opacity,lineCap:r.lineCap,lineJoin:r.lineJoin,...RG(r)&&{scalingX:r.scalingX,scalingY:r.scalingY,scalingCenterX:r.scalingCenterX,scalingCenterY:r.scalingCenterY}}),s.render(e));t.restore()}}};g([Ig()],CO.prototype,"segments",2);var LO=class{constructor(e,t,i){this.root=new uK(e,t,i)}clear(e){this.root.clear(e)}addValue(e,t){const i={hitTester:e,value:t,distanceSquared:(s,n)=>e.distanceSquared(s,n)};this.root.addElem(i)}find(e,t){const i={best:{nearest:void 0,distanceSquared:1/0}};return this.root.find(e,t,i),i.best}},hK=class{constructor(e,t,i,s){this.nw=e,this.ne=t,this.sw=i,this.se=s}addElem(e){this.nw.addElem(e),this.ne.addElem(e),this.sw.addElem(e),this.se.addElem(e)}find(e,t,i){this.nw.find(e,t,i),this.ne.find(e,t,i),this.sw.find(e,t,i),this.se.find(e,t,i)}},dK=class{constructor(e,t,i){this.capacity=e,this.maxdepth=t,this.boundary=i??re.NaN,this.elems=[],this.subdivisions=void 0}clear(e){this.elems.length=0,this.boundary=e,this.subdivisions=void 0}addElem(e){this.addCondition(e)&&(this.subdivisions===void 0?this.maxdepth===0||this.elems.length<this.capacity?this.elems.push(e):this.subdivide(e):this.subdivisions.addElem(e))}find(e,t,i){this.findCondition(e,t,i)&&(this.subdivisions===void 0?this.findAction(e,t,i):this.subdivisions.find(e,t,i))}subdivide(e){this.subdivisions=this.makeSubdivisions();for(const t of this.elems)this.subdivisions.addElem(t);this.subdivisions.addElem(e),this.elems.length=0}makeSubdivisions(){const{x:e,y:t,width:i,height:s}=this.boundary,{capacity:n}=this,o=this.maxdepth-1,a=i/2,r=s/2,l=new re(e,t,a,r),c=new re(e+a,t,a,r),h=new re(e,t+r,a,r),d=new re(e+a,t+r,a,r);return new hK(this.child(n,o,l),this.child(n,o,c),this.child(n,o,h),this.child(n,o,d))}},uK=class ZB extends dK{addCondition(t){const{x:i,y:s}=t.hitTester.midPoint;return this.boundary.containsPoint(i,s)}findCondition(t,i,s){const{best:n}=s;return n.distanceSquared!==0&&this.boundary.distanceSquared(t,i)<n.distanceSquared}findAction(t,i,s){const n=Pd(t,i,this.elems,s.best.distanceSquared);n.nearest!==void 0&&n.distanceSquared<s.best.distanceSquared&&(s.best=n)}child(t,i,s){return new ZB(t,i,s)}},gh=class hL extends yt{constructor(){super([0,1],[0,1]),this.type="number"}static is(t){return t instanceof hL}static getTickStep(t,i,s){const{interval:n,tickCount:o=yt.defaultTickCount,minTickCount:a,maxTickCount:r}=s;return n??Fc(t,i,o,a,r)}toDomain(t){return t}ticks({interval:t,tickCount:i=yt.defaultTickCount,minTickCount:s,maxTickCount:n},o=this.domain,a){if(!o||o.length<2||i<1||!o.every(Number.isFinite))return{ticks:[],count:0,firstTickIndex:0};const[r,l]=o;if(t){const c=Math.abs(t);if(!Ml((l-r)/c,this.getPixelRange()))return zc(r,l,c,a)}return Rc(r,l,i,s,n,a)}niceDomain(t,i=this.domain){if(i.length<2)return[];const{tickCount:s=yt.defaultTickCount}=t;let[n,o]=i;if(s===1)[n,o]=Ly(n,o);else if(s>1){const a=n>o?Math.ceil:Math.floor,r=n>o?Math.floor:Math.ceil,l=4;for(let c=0;c<l;c++){const h=n,d=o,u=hL.getTickStep(n,o,t),[p,f]=i;if(n=a(p/u)*u,o=r(f/u)*u,n===h&&o===d)break}}return[t.nice[0]?n:i[0],t.nice[1]?o:i[1]]}},zn=class extends _g{constructor(e,t=new gh){super(e,t)}hasDefinedDomain(){const{min:e,max:t}=this;return e!=null&&t!=null&&e<t}normaliseDataDomain(e){const{min:t,max:i,preferredMin:s,preferredMax:n}=this,{extent:o,clipped:a}=Ec(e.domain,t,i,s,n,void 0,e.sortMetadata?.sortOrder);return{domain:o,clipped:a}}getDomainExtentsNice(){return[this.min==null&&this.nice,this.max==null&&this.nice]}tickFormatParams(e,t,i){return{type:"number",fractionDigits:i}}datumFormatParams(e,t,i){const{datum:s,seriesId:n,legendItemName:o,key:a,source:r,property:l,domain:c,boundSeries:h}=t;return{type:"number",value:e,datum:s,seriesId:n,legendItemName:o,key:a,source:r,property:l,domain:c,boundSeries:h,fractionDigits:i}}};zn.className="NumberAxis",zn.type="number",g([m],zn.prototype,"min",2),g([m],zn.prototype,"max",2),g([m],zn.prototype,"preferredMin",2),g([m],zn.prototype,"preferredMax",2);var Ru=class extends K{constructor(){super(...arguments),this.enabled=!1,this.label=new Nt,this.tick=new Xc}};g([m],Ru.prototype,"enabled",2),g([m],Ru.prototype,"label",2),g([m],Ru.prototype,"tick",2);var wa=class extends _g{constructor(e){super(e,new du),this.parentLevel=new Ru,this.min=void 0,this.max=void 0,this.preferredMin=void 0,this.preferredMax=void 0}get _unit(){}set _unit(e){j.warnOnce("To use 'unit', use an axis with type 'unit-time' instead of 'time'.")}hasDefinedDomain(){const{min:e,max:t}=this;return e!=null&&t!=null&&e<t}isCategoryLike(){return!1}get primaryLabel(){return this.parentLevel.enabled?this.parentLevel.label:void 0}get primaryTick(){return this.parentLevel.enabled?this.parentLevel.tick:void 0}normaliseDataDomain(e){const{extent:t,clipped:i}=dg(e,this.min,this.max,this.preferredMin,this.preferredMax);return{domain:t,clipped:i}}processData(){super.processData();const{boundSeries:e,direction:t,min:i,max:s}=this;this.minimumTimeGranularity=wO(e,t,i,s)}tickFormatParams(e,t,i,s){s??(s=bg(t));const n=vg(e),o=ro(s),a=Fo(s),r=Sl(s);return{type:"date",unit:o,step:a,epoch:r,truncateDate:n}}datumFormatParams(e,t,i,s,n){if(typeof e=="number"&&(e=new Date(e)),s==null){const{minimumTimeGranularity:b}=this,x=$d(e);b!=null&&rs(b)<rs(x)?s=b:s=x}const{datum:o,seriesId:a,legendItemName:r,key:l,source:c,property:h,domain:d,boundSeries:u}=t,p=ro(s),f=Fo(s),y=Sl(s);return{type:"date",value:e,datum:o,seriesId:a,legendItemName:r,key:l,source:c,property:h,domain:d,boundSeries:u,unit:p,step:f,epoch:y,style:n}}};wa.className="TimeAxis",wa.type="time",g([m],wa.prototype,"parentLevel",2),g([m],wa.prototype,"min",2),g([m],wa.prototype,"max",2),g([m],wa.prototype,"preferredMin",2),g([m],wa.prototype,"preferredMax",2),g([m,kt("_unit")],wa.prototype,"unit",2);function wO(e,t,i,s){const n=e.reduce((o,a)=>Math.min(a.minTimeInterval()??1/0,o),1/0);return Number.isFinite(n)?Wd(n):TO(e,t,i,s)?.unit}function TO(e,t,i,s){let n=1/0,o=-1/0,a,r=0;const l=[];for(const u of e){if(!u.visible)continue;const{extent:p}=dg(u.getDomain(t));if(p.length===0)continue;const f=p[0].valueOf(),y=p.at(-1).valueOf();l.push(f,y),n=Math.min(n??1/0,f,y),o=Math.max(o??-1/0,f,y);const b=Math.abs(y-f);if(b===0)continue;const x=u.dataCount();if(r=Math.max(r,x),x<=1)continue;const v=b/(x-1);a=Math.min(a??1/0,v)}if(n=Math.min(n,i?.valueOf()??1/0,s?.valueOf()??1/0),o=Math.max(o,i?.valueOf()??-1/0,s?.valueOf()??-1/0),!Number.isFinite(n)||!Number.isFinite(o))return;a??(a=Math.abs(o-n)),a=Math.min(a,pK(l));const c=Wd(a);let h=a/rs(c);r<=2?h=Math.floor(h):h=Math.round(h),h=Math.max(h,1);const d=h===1?void 0:Ys(c,n);return{unit:c,step:h,epoch:d}}function pK(e){e.sort((i,s)=>i-s);let t=1/0;for(let i=1;i<e.length;i++){const s=e[i-1],n=e[i];n-s>0&&(t=Math.min(t,Math.abs(n-s)))}return t}var WD=class extends Hg{constructor({clipFocusBox:e,categoryKey:t,...i}){super(i),this.categoryKey=t,this.clipFocusBox=e??!0}dataCount(){return this.processedData?.dataSources?.get(this.id)?.data?.length??0}invalidDataCount(){return this.processedData?.invalidDataCount?.get(this.id)??0}missingDataCount(){return this.dataModel?.resolveMissingDataCount(this)??0}get hasData(){return Math.max(0,this.dataCount()-this.invalidDataCount()-this.missingDataCount())>0}getScaleInformation({xScale:e,yScale:t}){const i=yt.is(e),s=yt.is(t);return{isContinuousX:i,isContinuousY:s,xScaleType:e?.type,yScaleType:t?.type}}getModulePropertyDefinitions(){const e=this.axes.x?.scale,t=this.axes.y?.scale;return this.moduleMap.mapModules(i=>i.getPropertyDefinitions(this.getScaleInformation({xScale:e,yScale:t}))).flat()}async requestDataModel(e,t,i){i.props.push(...this.getModulePropertyDefinitions());const{dataModel:s,processedData:n}=await e.request(this.id,t??cu.empty(),i);return this.dataModel=s,this.processedData=n,this.events.emit("data-processed",{dataModel:s,processedData:n}),{dataModel:s,processedData:n}}isProcessedDataAnimatable(){const{processedData:e,ctx:t}=this;if(!e)return!1;const i=this.getNodeData();if(i!=null&&i.length>t.animationManager.maxAnimatableItems)return!1;const s=e.reduced?.animationValidation;if(!s)return!0;const{orderedKeys:n,uniqueKeys:o}=s;return n&&o}checkProcessedDataAnimatable(){this.isProcessedDataAnimatable()||this.ctx.animationManager.skipCurrentBatch()}pickFocus(e){const t=this.getNodeData();if(t===void 0||t.length===0)return;const i=this.computeFocusDatumIndex(e,t);if(i===void 0)return;const{clipFocusBox:s}=this,n=t[i],o={...e,datumIndex:i},a=this.computeFocusBounds(o);if(a!==void 0)return{bounds:a,clipFocusBox:s,datum:n,datumIndex:i}}pickNodesExactShape(e){const t=super.pickNodesExactShape(e);return t.sort((i,s)=>i.datumIndex-s.datumIndex),t}isDatumEnabled(e,t){const{missing:i=!1,enabled:s=!0,focusable:n=!0}=e[t];return!i&&s&&n}computeFocusDatumIndex(e,t){const i=(a,r)=>{for(;a>=0&&!this.isDatumEnabled(t,a);)a+=r;return a===-1?void 0:a},s=(a,r)=>{for(;a<t.length&&!this.isDatumEnabled(t,a);)a+=r;return a===t.length?void 0:a};let n;const o=ge(0,e.datumIndex,t.length-1);return e.datumIndexDelta<0?n=i(o,e.datumIndexDelta):e.datumIndexDelta>0?n=s(o,e.datumIndexDelta):n=s(o,1)??i(o,-1),n===void 0?e.datumIndexDelta===0?void 0:e.datumIndex-e.datumIndexDelta:n}dataModelPropertyIsKey(e){const{processedData:t}=this;return t?t.defs.keys.some(i=>i.id===e&&i.idsMap?.get(this.id)?.has(e)===!0):!1}keysOrValues(e){const{dataModel:t,processedData:i}=this;return!t||!i?[]:this.dataModelPropertyIsKey(e)?t.resolveKeysById(this,e,i):t.resolveColumnById(this,e,i)}sortOrder(e){const{dataModel:t,processedData:i}=this;if(!(!t||!i))return this.dataModelPropertyIsKey(e)?t.getKeySortOrder(this,e,i):t.getColumnSortOrder(this,e,i)}getCategoryKey(){return this.categoryKey}getCategoryValue(e){const{processedData:t,dataModel:i}=this,s=this.getCategoryKey();return!t||!i||!s||(t.invalidData?.get(this.id)?.[e]??!1)?void 0:this.keysOrValues(s)[e]}datumIndexForCategoryValue(e){const{processedData:t,dataModel:i}=this,s=this.getCategoryKey();if(!t||!i||!s)return;e=e.valueOf();const n=t.invalidData?.get(this.id),o=this.keysOrValues(s);for(let a=0;a<o.length;a+=1){if(n?.[a]===!0)continue;const r=o[a]?.valueOf();if(ii(e,r))return a}}},Fu={x:["xKey"],y:["yKey"]},zu={x:["xName"],y:["yName"]},$D=class extends gx{constructor(e,t,i,s){super(e,t,i,s),this.xKey=s.properties.xKey,this.yKey=s.properties.yKey}},Zo=class extends Go{constructor(){super(...arguments),this.xKeyAxis="x",this.yKeyAxis="y",this.pickOutsideVisibleMinorAxis=!1,this.segmentation=new rx}};g([m],Zo.prototype,"xKeyAxis",2),g([m],Zo.prototype,"yKeyAxis",2),g([m],Zo.prototype,"legendItemName",2),g([m],Zo.prototype,"pickOutsideVisibleMinorAxis",2),g([m],Zo.prototype,"segmentation",2);var UD=100,Wl=class extends WD{constructor({pathsPerSeries:e=["path"],pathsZIndexSubOrderOffset:t=[],datumSelectionGarbageCollection:i=!0,animationAlwaysUpdateSelections:s=!1,segmentedDataNodes:n=!0,animationResetFns:o,propertyKeys:a,propertyNames:r,...l}){if(super({propertyKeys:a,propertyNames:r,canHaveAxes:!0,...l}),this.NodeEvent=$D,this.dataNodeGroup=this.contentGroup.appendChild(new CO({name:`${this.id}-series-dataNodes`,zIndex:1})),this.labelGroup=this.contentGroup.appendChild(new ls({name:`${this.id}-series-labels`})),this.labelSelection=ci.select(this.labelGroup,rn),this.highlightSelection=ci.select(this.highlightNodeGroup,()=>this.nodeFactory()),this.highlightLabelSelection=ci.select(this.highlightLabelGroup,rn),this.annotationSelections=new Set,this.seriesBelowStackContext=void 0,this.debug=Me.create(),!a||!r)throw new Error(`Unable to initialise series type ${this.type}`);this.opts={pathsPerSeries:e,pathsZIndexSubOrderOffset:t,propertyKeys:a,propertyNames:r,animationResetFns:o,animationAlwaysUpdateSelections:s,datumSelectionGarbageCollection:i,segmentedDataNodes:n},this.paths=e.map(c=>new jD({name:`${this.id}-${c}`})),this.datumSelection=ci.select(this.dataNodeGroup,()=>this.nodeFactory(),i),this.animationState=new he("empty",{empty:{update:{target:"ready",action:c=>this.animateEmptyUpdateReady(c)},reset:"empty",skip:"ready",disable:"disabled"},ready:{updateData:"waiting",clear:"clearing",highlight:c=>this.animateReadyHighlight(c),resize:c=>this.animateReadyResize(c),reset:"empty",skip:"ready",disable:"disabled"},waiting:{update:{target:"ready",action:c=>{this.ctx.animationManager.isSkipped()?this.resetAllAnimation(c):this.animateWaitingUpdateReady(c)}},reset:"empty",skip:"ready",disable:"disabled"},disabled:{update:c=>this.resetAllAnimation(c),reset:"empty"},clearing:{update:{target:"empty",action:c=>this.animateClearingUpdateEmpty(c)},reset:"empty",skip:"ready"}},this.checkProcessedDataAnimatable.bind(this)),this.cleanup.register(this.ctx.eventsHub.on("legend:item-click",c=>this.onLegendItemClick(c)),this.ctx.eventsHub.on("legend:item-double-click",c=>this.onLegendItemDoubleClick(c)))}get contextNodeData(){return this._contextNodeData}getNodeData(){return this.contextNodeData?.nodeData}getKeyAxis(e){if(this.shouldFlipXY()){if(e==="x")return this.properties.yKeyAxis;if(e==="y")return this.properties.xKeyAxis}if(e==="x")return this.properties.xKeyAxis;if(e==="y")return this.properties.yKeyAxis}attachSeries(e,t,i){super.attachSeries(e,t,i),this.attachPaths(this.paths)}detachSeries(e,t,i){super.detachSeries(e,t,i),this.detachPaths(this.paths)}updatedDomains(){this.animationState.transition("updateData")}attachPaths(e){for(const t of e)this.contentGroup.appendChild(t)}detachPaths(e){for(const t of e)t.remove()}renderToOffscreenCanvas(){const e=this.getNodeData();return e!=null&&e.length>UD}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"?this.animationState.transition("skip"):e==="disabled"&&this.animationState.transition("disable")}destroy(){super.destroy(),this._contextNodeData=void 0}isSeriesHighlighted(e){const{series:t,legendItemName:i}=e??{},{legendItemName:s}=this.properties;return t===this||s!=null&&s===i}strokewidthChange(){const e=("strokeWidth"in this.properties&&this.properties.strokeWidth)??0,t=this.properties.highlight.highlightedSeries.strokeWidth??e,i=this.properties.highlight.highlightedItem?.strokeWidth??e;return e>i||t>i}update({seriesRect:e}){const{_contextNodeData:t}=this,i=this.checkResize(e),s=this.updateHighlightSelection(),n=this;this.contentGroup.batchedUpdate(function(){const r=n.updateSelections(),l=n.contextNodeData?.segments;n.opts.segmentedDataNodes?n.dataNodeGroup.segments=l??n.dataNodeGroup.segments:n.dataNodeGroup.segments=void 0,n.updateNodes(s,i||r)});const o=this.getAnimationData(e,t);o&&(i&&this.animationState.transition("resize",o),this.animationState.transition("update",o),this.processedDataUpdated=!1)}createStackContext(){}updateSelections(){var e;const t=!this.opts.animationAlwaysUpdateSelections&&this.ctx.animationManager.isSkipped();if(!this.visible&&t)return!1;const{nodeDataRefresh:i}=this;if(!i&&!this.isPathOrSelectionDirty())return!1;if(i){this.nodeDataRefresh=!1,this.debug("CartesianSeries.updateSelections() - calling createNodeData() for",this.id),this.markQuadtreeDirty(),this._contextNodeData=this.createNodeData();const s=this.isProcessedDataAnimatable();if(this._contextNodeData){(e=this._contextNodeData).animationValid??(e.animationValid=s);const a=this._contextNodeData.nodeData?.length;a!=null&&Jn.record(`${this.type}:nodeData`,a)}const{dataModel:n,processedData:o}=this;n!==void 0&&o!==void 0&&this.events.emit("data-update",{dataModel:n,processedData:o}),this.updateSeriesSelections()}return i}updateSeriesSelections(){const{datumSelection:e,labelSelection:t,paths:i}=this,s=this._contextNodeData;if(!s)return;const{nodeData:n,labelData:o,itemId:a}=s;this.updatePaths({itemId:a,contextData:s,paths:i}),this.datumSelection=this.updateDatumSelection({nodeData:n,datumSelection:e}),this.labelGroup.batchedUpdate(()=>{this.labelSelection=this.updateLabelSelection({labelData:o,labelSelection:t})??t})}getShapeFillBBox(){const{axes:e}=this,t=e.x,i=e.y,[s,n]=Tt(t?.range??[0,1]),[o,a]=Tt(i?.range??[0,1]),r=Jh(this.getSeriesDomain("x")),l=[t?.scale.convert(r.at(0)),t?.scale.convert(r.at(-1))],c=Jh(this.getSeriesDomain("y")),h=[i?.scale.convert(c.at(0)),i?.scale.convert(c.at(-1))],[d,u]=Tt(l),[p,f]=Tt(h);return{axis:new re(s,o,n-s,a-o),series:new re(d,p,u-d,f-p)}}updateNodes(e,t){const{highlightSelection:i,datumSelection:s}=this,n=!this.ctx.animationManager.isSkipped(),o=this.visible&&this._contextNodeData!=null;this.contentGroup.visible=n||o,this.highlightGroup.visible=(n||o)&&e,this.updateDatumStyles({datumSelection:i,isHighlight:!0});const a=this.ctx.chartService.highlight?.drawingMode??"overlay";this.updateDatumNodes({datumSelection:i,isHighlight:!0,drawingMode:a}),this.highlightLabelGroup.batchedUpdate(()=>{this.updateLabelNodes({labelSelection:this.highlightLabelSelection,isHighlight:!0})}),this.animationState.transition("highlight",i);const{dataNodeGroup:r,labelSelection:l,paths:c,labelGroup:h}=this,{itemId:d}=this.contextNodeData??{};if(this.updatePathNodes({itemId:d,paths:c,visible:o,animationEnabled:n}),r.visible=n||o,h.visible=o,!r.visible)return;this.hasItemStylers()&&this.updateDatumStyles({datumSelection:s,isHighlight:!1});const u=this.strokewidthChange()||this.hasChangesOnHighlight;(t||u)&&(this.updateDatumNodes({datumSelection:s,isHighlight:!1,drawingMode:"overlay"}),this.usesPlacedLabels||this.labelGroup.batchedUpdate(()=>{this.updateLabelNodes({labelSelection:l,isHighlight:!1})}))}getHighlightData(e,t){return t?[{...t}]:void 0}getHighlightLabelData(e,t){const i=e.filter(s=>s.datum===t.datum&&s.itemId===t.itemId);return i.length===0?void 0:i}updateHighlightSelection(){const{highlightSelection:e,highlightLabelSelection:t,_contextNodeData:i}=this;if(!i)return!1;const s=this.ctx.highlightManager?.getActiveHighlight(),o=this.isSeriesHighlighted(s)&&s?.datum?s:void 0;if(o==null)return!1;const{nodeData:a,labelData:r}=i,l=this.getHighlightData(a,o);this.highlightSelection=this.updateHighlightSelectionItem({items:l,highlightSelection:e});const c=this.getHighlightLabelData(r,o)??[];return this.highlightLabelSelection=this.updateLabelSelection({labelData:c,labelSelection:t})??t,!0}markQuadtreeDirty(){this.quadtree=void 0}*datumNodesIter(){for(const{node:e}of this.datumSelection)e.datum.missing!==!0&&(yield e)}getQuadTree(){if(this.quadtree===void 0){const{width:e,height:t}=this.ctx.scene.canvas,i=new re(0,0,e,t);this.quadtree=new LO(100,10,i),this.initQuadTree(this.quadtree)}return this.quadtree}initQuadTree(e){}pickNodeDataExactShape(e){const{x:t,y:i}=e,{dataNodeGroup:s}=this,n=s.pickNodes(t,i).filter(o=>o.datum.missing!==!0);if(n.length!==0)return n.map(a=>a.datum)}pickModulesExactShape(e){for(const t of this.moduleMap.modules()){const{datum:i}=t.pickNodeExact(e)??{};if(i!=null&&i?.missing!==!0)return[i]}}pickNodesExactShape(e){const t=super.pickNodesExactShape(e);return t.length!==0?t:this.pickNodeDataExactShape(e)??this.pickModulesExactShape(e)??[]}pickNodeDataClosestDatum(e){const{x:t,y:i}=e,{axes:s,_contextNodeData:n}=this;if(!n)return;const o=s.x,a=s.y,r={x:t,y:i};let l=1/0,c;for(const h of n.nodeData){const{point:{x:d=Number.NaN,y:u=Number.NaN}={}}=h;if(Number.isNaN(d)||Number.isNaN(u)||!(o?.inRange(d)&&a?.inRange(u)))continue;const f=Math.max((r.x-d)**2+(r.y-u)**2,0);f<l&&(l=f,c=h)}if(l!=null)return{datum:c,distance:Math.sqrt(l)}}pickModulesClosestDatum(e){let t=1/0,i;for(const s of this.moduleMap.modules()){const n=s.pickNodeNearest(e);n!==void 0&&n.distanceSquared<t&&(t=n.distanceSquared,i=n.datum)}if(t!=null)return{datum:i,distance:Math.sqrt(t)}}pickNodeClosestDatum(e){let t=1/0,i;const s=this.pickNodeDataClosestDatum(e);s!=null&&s.distance<t&&(t=s.distance,i=s.datum);const n=this.pickModulesClosestDatum(e);if(n!=null&&n.distance<t&&(t=n.distance,i=n.datum),i){const o=Math.max(t-(i.point?.size??0)/2,0);return{datum:i,distance:o}}}pickNodeMainAxisFirst(e,t){const{x:i,y:s}=e,{axes:n,_contextNodeData:o}=this,{pickOutsideVisibleMinorAxis:a}=this.properties;if(!o)return;const r=n.x,l=n.y;if(r==null||l==null)return;const c=[r,l].filter(f=>f.isCategoryLike()).map(f=>f.direction);if(t&&c.length===0)return;const[h="x"]=c,d=[i,s];h!=="x"&&d.reverse();const u=[1/0,1/0];let p;for(const f of o.nodeData){const{x:y=Number.NaN,y:b=Number.NaN}=f.point??f.midPoint??{};if(Number.isNaN(y)||Number.isNaN(b)||f.missing===!0)continue;const x=[r?.inRange(y,1),l?.inRange(b,1)];if(h!=="x"&&x.reverse(),!x[0]||!a&&!x[1])continue;const v=[y,b];h!=="x"&&v.reverse();let S=!0;for(let M=0;M<v.length;M++){const D=Math.abs(v[M]-d[M]);if(D>u[M]){S=!1;break}else D<u[M]&&(u[M]=D,u.fill(1/0,M+1,u.length))}S&&(p=f)}if(p){let f=Math.max(u[0]**2+u[1]**2-(p.point?.size??0),0);for(const y of this.moduleMap.modules()){const b=y.pickNodeMainAxisFirst(e,h);if(b!=null&&b.distanceSquared<f){p=b.datum,f=b.distanceSquared;break}}return{datum:p,distance:Math.sqrt(f)}}}isPathOrSelectionDirty(){return!1}shouldFlipXY(){return!1}visibleRangeIndices(e,t,i,s){let n;if(s==null){const{processedData:c,dataModel:h}=this;n=h.getColumnSortOrder(this,e,c)??1}else n=s.sortOrder;const o=this.keysOrValues(e),a=0,[r,l]=zg(n,i?.length??o.length,t,c=>{const h=i?.[c]??c;return this.xCoordinateRange(o[h],a,h)});return r<l?[r,l]:[l,r]}domainForVisibleRange(e,t,i,s,n){const{processedData:o,dataModel:a}=this,[r,l]=s,c=this.keysOrValues(i),h=this.sortOrder(i);if(h!=null){const f=this.visibleRangeIndices(i,s,n,{sortOrder:h});return a.getDomainBetweenRange(this,t,f,o)}const d=t.map(f=>this.keysOrValues(f));let u=1/0,p=-1/0;for(const[f,y]of c.entries()){const[b,x]=this.xCoordinateRange(y,0,f);if(!(x<r||b>l))for(let v=0;v<t.length;v++){const S=d[v][f];u=Math.min(u,S),p=Math.max(p,S)}}return u>p?[Number.NaN,Number.NaN]:[u,p]}domainForClippedRange(e,t,i){const{processedData:s,dataModel:n,axes:o}=this,r=gK(o[e==="x"?"y":"x"]);if(!r)return t.flatMap(f=>n.getDomain(this,f,"value",s).domain);const l=this.keysOrValues(i),c=n.getColumnSortOrder(this,i,s);if(c!=null){const f=fK(c,l.length,r,y=>l[y]);return n.getDomainBetweenRange(this,t,f,s)}const h=t.map(f=>this.keysOrValues(f)),d=r[0].valueOf(),u=r[1].valueOf(),p=[];for(const[f,y]of l.entries()){const b=y.valueOf();if(b<d||b>u)continue;const x=h.map(v=>v[f]);b>=d&&p.push(...x),b<=u&&p.push(...x)}return p}zoomFittingVisibleItems(e,t,i,s,n){const{dataModel:o,processedData:a}=this;if(!o||!a)return;const r=this.axes.x;if(s!=null)return;const l=this.sortOrder(e);if(l==null)return;const c=this.keysOrValues(e);if(n>c.length)return{x:[0,1],y:void 0};const h=r.scale,d=h.range;h.range=[0,1];let[u,p]=this.visibleRangeIndices(e,i,void 0,{sortOrder:l});p-=1;const f=0;this.xCoordinateRange(c[u],f,u)[0]<i[0]&&(u+=1),this.xCoordinateRange(c[p],f,p)[1]>i[1]&&(p-=1);let y;if(Math.abs(p-u)>=n-1)y=i;else{const b=(i[0]+i[1])/2;for(;Math.abs(p-u)<n-1&&(u>0||p<c.length-1);)if(u===0)p+=1;else if(p===c.length-1)u-=1;else{const S=this.xCoordinateRange(c[u-1],f,u-1)[0],M=this.xCoordinateRange(c[p+1],f,p+1)[1];Math.abs(S-b)<Math.abs(M-b)?u-=1:p+=1}const x=this.xCoordinateRange(c[u],f,u)[0],v=this.xCoordinateRange(c[p],f,p)[1];y=[Math.min(i[0],x),Math.max(i[1],v)]}return h.range=d,{x:y,y:void 0}}countVisibleItems(e,t,i,s,n){const{dataModel:o,processedData:a}=this;if(!o||!a)return 1/0;const r=this.keysOrValues(e),l=t.map(I=>o.resolveColumnById(this,I,a)),c=this.shouldFlipXY(),h=c?this.axes.y:this.axes.x,d=c?this.axes.x:this.axes.y,u=c?s??[0,1]:i,p=c?i:s??[0,1];if(s==null){const I=this.sortOrder(e);if(I!=null){const A=h.scale,C=A.range;A.range=[0,1];const w=this.keysOrValues(e);let[T,O]=this.visibleRangeIndices(e,u,void 0,{sortOrder:I});if(O-=1,O<T)return 0;const E=0;this.xCoordinateRange(w[T],E,T)[0]<u[0]&&(T+=1),this.xCoordinateRange(w[O],E,O)[1]>u[1]&&(O-=1);const z=Math.abs(O-T)+1;return A.range=C,z}}const f=(I,A,C)=>I[0]+(C-A[0])/(A[1]-A[0])*(I[1]-I[0]),y=h.range.toSorted(),b=d.range.toSorted(),x=f(y,h.visibleRange,u[0]),v=f(y,h.visibleRange,u[1]),S=f(b,d.visibleRange,Math.min(...p)),M=f(b,d.visibleRange,Math.max(...p)),D=Math.round((u[0]+(u[1]-u[0])/2)*r.length),k=0;return e4(0,r.length-1,D,n,I=>{const[A,C]=this.xCoordinateRange(r[I],k,I),[w,T]=this.yCoordinateRange(l.map(O=>O[I]),k,I);return!$e(A)||!$e(C)||!$e(w)||!$e(T)?!1:A>=x&&C<=v&&w>=S&&T<=M})}minTimeInterval(){let e;try{e=this.keysOrValues("xValue")}catch{}if(e==null||e.length>1e3)return;let t=1/0,i=e[0],s;for(let n=1;n<e.length;n++){const o=e[n];if(o!=null&&i!=null){const a=o.valueOf()-i.valueOf(),r=Math.sign(a);if(r===0)continue;if(s!==void 0&&r!==s)return;t=Math.min(t,Math.abs(a)),s=r}i=o}if(Number.isFinite(t))return t}updateHighlightSelectionItem(e){const{items:t,highlightSelection:i}=e,s=t??[];return this.updateDatumSelection({nodeData:s,datumSelection:i})}updateDatumSelection(e){return e.datumSelection}updateDatumNodes(e){}updateDatumStyles(e){}updatePaths(e){for(const t of e.paths)t.visible=!1}updatePathNodes(e){const{paths:t,visible:i}=e;for(const s of t)s.visible=i}resetPathAnimation(e){const{path:t}=this.opts?.animationResetFns??{};if(t)for(const i of e.paths)Ui([i],t)}resetDatumAnimation(e){const{datum:t}=this.opts?.animationResetFns??{};t&&Ui([e.datumSelection],t)}resetLabelAnimation(e){const{label:t}=this.opts?.animationResetFns??{};t&&Ui([e.labelSelection],t)}resetAllAnimation(e){this.ctx.animationManager.stopByAnimationGroupId(this.id),this.resetPathAnimation(e),this.resetDatumAnimation(e),this.resetLabelAnimation(e),e.contextData?.animationValid===!1&&this.ctx.animationManager.skipCurrentBatch()}animateEmptyUpdateReady(e){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(e)}animateWaitingUpdateReady(e){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(e)}animateReadyHighlight(e){const{datum:t}=this.opts?.animationResetFns??{};t&&Ui([e],t)}animateReadyResize(e){this.resetAllAnimation(e)}animateClearingUpdateEmpty(e){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(e)}getAnimationData(e,t){const{_contextNodeData:i}=this;return i?{datumSelection:this.datumSelection,labelSelection:this.labelSelection,annotationSelections:[...this.annotationSelections],contextData:i,previousContextData:t,paths:this.paths,seriesRect:e}:void 0}updateLabelSelection(e){return e.labelSelection}getScaling(e){if(e instanceof HD){const{range:t,domain:i}=e;return{type:"log",convert:s=>e.convert(s),domain:[i[0],i[1]],range:[t[0],t[1]]}}else if(e instanceof yt){const{range:t,domain:i}=e;return{type:"continuous",domain:[i[0],i[1]],range:[t[0],t[1]]}}else if(e instanceof Ma){if(e instanceof Pl){const t=e.getLinearParams(),i=e.getBandCountForUpdate();if(t!=null&&i>0)return{type:"category",variant:"unit-time",firstBandTime:t.firstBandTime,lastBandTime:t.firstBandTime+(i-1)*t.intervalMs,bandCount:i,intervalMs:t.intervalMs,inset:e.inset,step:e.step}}return{type:"category",domain:e.domain,inset:e.inset,step:e.step}}}calculateScaling(){const e={};for(const t of Object.values(Jp)){const i=this.axes[t];if(!i)continue;const s=this.getScaling(i.scale);s!=null&&(e[t]=s)}return e}};function gK(e){let t,i;if((e instanceof zn||e instanceof wa)&&({min:t,max:i}=e),!(t==null&&i==null))return t??(t=-1/0),i??(i=1/0),[t,i]}function fK(e,t,i,s){const n=i[0].valueOf(),o=i[1].valueOf();let a=Nc(0,t-1,l=>{const c=e===1?l:t-l,h=s(c)?.valueOf();return!Number.isFinite(h)||h>=n}),r=hr(0,t-1,l=>{const c=e===1?l:t-l,h=s(c)?.valueOf();return!Number.isFinite(h)||h<=o});return a==null||r==null?[0,0]:(e===-1&&([a,r]=[t-r,t-a]),a=Math.max(a,0),r=Math.min(r+1,t),[a,r])}function NO(e){const t=new Map;for(const i of e){if(!(i instanceof Wl))continue;const n=(i.seriesGrouping?.stackCount??0)>0?i.seriesGrouping?.groupIndex:void 0;if(n==null){i.seriesBelowStackContext=void 0,i.createStackContext();continue}const o=`${i.type}-${n}`;let a=t.get(o);a==null&&(a=[],t.set(o,a)),a.push(i)}for(const i of t.values()){i.sort((n,o)=>(n.seriesGrouping?.stackIndex??0)-(o.seriesGrouping?.stackIndex??0));let s;for(const n of i)n.seriesBelowStackContext=s,s=n.createStackContext()}}function fh(e,t,i,s,n,o,a=["series",`${e.declarationOrder}`,"label"]){if(e.visible&&s.itemStyler){const r=e.getHighlightStateString(o,n||t!=null&&o?.series===t.series&&o?.datumIndex===t.datumIndex,t?.datumIndex),l={border:s.border,color:s.color,cornerRadius:s.cornerRadius,datum:t?.datum,enabled:s.enabled,fill:s.fill,fillOpacity:s.fillOpacity,fontFamily:s.fontFamily,fontSize:s.fontSize,fontStyle:s.fontStyle,fontWeight:s.fontWeight,itemId:t?.itemId,itemType:t?.itemType,seriesId:e.id,padding:s.padding,highlightState:r},c=e.ctx.optionsGraphService.resolvePartial(a,e.cachedCallWithContext(s.itemStyler,{...i,...l}),{pick:!1})??{};return oe(c,l)}return s}function OO(e,t,i,s,n,o,a){if(e.visible&&s.enabled&&n){const r=fh(e,t.datum,i,s,o,a);t.visible=!0,t.x=n.x,t.y=n.y,t.text=n.text,t.fill=r.color,t.setAlign(n),t.setFont(r),t.setBoxing(r)}else t.visible=!1}var mK={"inside-start":{inside:!0,direction:-1,textAlignment:1},"inside-end":{inside:!0,direction:1,textAlignment:-1},"outside-start":{inside:!1,direction:-1,textAlignment:-1},"outside-end":{inside:!1,direction:1,textAlignment:1}};function EO({isUpward:e,isVertical:t,placement:i,spacing:s=0,rect:n}){let o=n.x+n.width/2,a=n.y+n.height/2,r="center",l="middle";if(i!=="inside-center"){const c=(e?1:-1)*(t?-1:1),{direction:h,textAlignment:d}=mK[i],u=(h+1)*.5;if(t){const p=e?n.y+n.height:n.y,f=n.height*c;a=p+f*u+s*d*c,l=d===c?"top":"bottom"}else{const p=e?n.x:n.x+n.width,f=n.width*c;o=p+f*u+s*d*c,r=d===c?"left":"right"}}return{x:o,y:a,textAlign:r,textBaseline:l}}function qt({id:e},t,i,...s){for(const n of s)n.cleanup();Nl(e,t,i,s,{opacity:0},{opacity:1},{phase:"trailing"})}function Ex({id:e},t,i,...s){Nl(e,t,i,s,{opacity:1},{opacity:0},{phase:"remove"})}function mh(e){return{opacity:1}}var Xs=class extends Ry{constructor(){super(...arguments),this.enabled=!0,this.shape="circle",this.size=0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}getStyle(){const{size:e,shape:t,fill:i,fillOpacity:s,stroke:n,strokeWidth:o,strokeOpacity:a,lineDash:r,lineDashOffset:l}=this;return{size:e,shape:t,fill:i,fillOpacity:s,stroke:n,strokeWidth:o,strokeOpacity:a,lineDash:r,lineDashOffset:l}}getDiameter(){return this.size+this.strokeWidth}};g([m,U()],Xs.prototype,"enabled",2),g([m,br({equals:Vc})],Xs.prototype,"shape",2),g([m,U()],Xs.prototype,"size",2),g([m,br({equals:ii})],Xs.prototype,"fill",2),g([m,U()],Xs.prototype,"fillOpacity",2),g([m,U()],Xs.prototype,"stroke",2),g([m,U()],Xs.prototype,"strokeWidth",2),g([m,U()],Xs.prototype,"strokeOpacity",2),g([m],Xs.prototype,"lineDash",2),g([m],Xs.prototype,"lineDashOffset",2),g([m,br({equals:Vc})],Xs.prototype,"itemStyler",2);function yK(e,t){if(e!=null)return{enabled:e.enabled??!0,stroke:e.stroke??t?.stroke??"transparent",strokeWidth:e.strokeWidth??t?.strokeWidth??1,strokeOpacity:e.strokeOpacity??t?.strokeOpacity??1,lineDash:e.lineDash??t?.lineDash??[]}}var PO=class extends K{constructor(){super(...arguments),this.enabled=!1}};g([m],PO.prototype,"enabled",2);var Tr=class extends K{constructor(){super(...arguments),this.interaction=new PO,this.position=new gu,this.range=void 0,this.class=void 0}formatTooltip(e,t,i){const s=this.renderer==null?void 0:as(e,this.renderer,i);if(Rt(s)||gt(s)||Is(s))return{type:"raw",rawHtmlString:Dt(s)};if(s!=null){const n=oe(s.symbol?.marker,t.symbol?.marker),o=s.symbol?.line??t.symbol?.line?oe(s.symbol?.line,t.symbol?.line):void 0,a=t.symbol||s.symbol?{marker:n,line:yK(o,n)}:void 0;return{type:"structured",...t,...s,symbol:a}}return{type:"structured",...t}}};g([m],Tr.prototype,"enabled",2),g([m],Tr.prototype,"showArrow",2),g([m],Tr.prototype,"renderer",2),g([m],Tr.prototype,"interaction",2),g([m],Tr.prototype,"position",2),g([m],Tr.prototype,"range",2),g([m],Tr.prototype,"class",2);function yh(){return new Tr}var Bu=class XB extends _g{constructor(t,i=new qc,s=!0){super(t,i),this.groupPaddingInner=.1,this.includeInvisibleDomains=s,this.nice=!1}static is(t){return t instanceof XB}isCategoryLike(){return!0}hasDefinedDomain(){return!1}normaliseDataDomain(t){return{domain:t.domain,clipped:!1}}updateScale(){super.updateScale();let{paddingInner:t,paddingOuter:i}=this;if(!$e(t)||!$e(i)){const s=this.reduceBandScalePadding();t??(t=s.inner),i??(i=s.outer)}this.scale.paddingInner=t??0,this.scale.paddingOuter=i??0}calculateGridLines(t,i,s){const n=super.calculateGridLines(t,i,s);return this.interval.placement==="between"&&t.length>0&&n.push(super.calculateGridLine({index:t.at(-1).index+1,tickId:`after:${t.at(-1).tickId}`,translation:this.range[1]},t.length,i,s,t)),n}calculateGridLine({index:t,tickId:i,translation:s},n,o,a,r){const{gridLine:l,horizontal:c,interval:h,scale:d}=this;if(h.placement!=="between")return super.calculateGridLine({index:t,tickId:i,translation:s},n,o,a,r);const u=s<d.step?Math.floor(d.step/2):d.step/2,p=s-u,[f,y,b,x]=c?[p,Math.max(o,a),p,Math.min(o,a)]:[Math.min(o,a),p,Math.max(o,a),p],{style:v}=l,{stroke:S,strokeWidth:M=0,lineDash:D}=v[t%v.length]??{};return{tickId:i,offset:p,x1:f,y1:y,x2:b,y2:x,stroke:S,strokeWidth:M,lineDash:D}}calculateGridFills(t,i,s){const{horizontal:n,range:o,scale:a}=this;if(this.interval.placement!=="between")return super.calculateGridFills(t,i,s);const r=[];if(t.length==0)return r;const l=t[0],c=l.translation>o[0]+a.step/2,h=t.at(-1),d=n&&h.translation<o[1]-a.step/2;if(c){const u={tickId:`before:${l.tickId}`,translation:l.translation-a.step};r.push(this.calculateGridFill(u,-1,l.index-1,i,s,t))}if(r.push(...t.map((u,p)=>this.calculateGridFill(u,p,u.index,i,s,t))),d){const u={tickId:`after:${h.tickId}`,translation:h.translation+a.step};r.push(this.calculateGridFill(u,t.length,h.index+1,i,s,t))}return r}calculateGridFill({tickId:t,translation:i},s,n,o,a,r){const{gridLine:l,horizontal:c,interval:h,scale:d}=this;if(h.placement!=="between")return super.calculateGridFill({tickId:t,translation:i},s,n,o,a,r);const u=i-d.step/2,p=i+d.step/2,[f,y,b,x]=c?[u,Math.max(o,a),p,Math.min(o,a)]:[Math.min(o,a),u,Math.max(o,a),p],{fill:v,fillOpacity:S}=l.style[n%l.style.length]??{};return{tickId:t,x1:f,y1:y,x2:b,y2:x,fill:v,fillOpacity:S}}calculateTickLines(t,i){const s=super.calculateTickLines(t,i);return this.interval.placement==="between"&&t.length>0&&s.push(super.calculateTickLine({isPrimary:!1,tickId:`after:${t.at(-1)?.tickId}`,translation:this.range[1]},t.length,i,t)),s}calculateTickLine({isPrimary:t,tickId:i,translation:s},n,o,a){const{horizontal:r,interval:l,primaryTick:c,scale:h,tick:d}=this;if(l.placement!=="between")return super.calculateTickLine({isPrimary:t,tickId:i,translation:s},n,o,a);const u=t&&c?.enabled?c:d,p=-o*this.getTickSize(u),f=s<h.step?Math.floor(h.step/2):h.step/2,y=s-f,[b,x,v,S]=r?[y,0,y,p]:[0,y,p,y],{stroke:M,width:D}=u;return{tickId:i,offset:y,x1:b,y1:x,x2:v,y2:S,stroke:M,strokeWidth:D,lineDash:void 0}}reduceBandScalePadding(){return this.boundSeries.reduce((t,i)=>{const s=i.getBandScalePadding?.();return s&&(t.inner>s.inner&&(t.inner=s.inner),t.outer<s.outer&&(t.outer=s.outer)),t},{inner:1/0,outer:-1/0})}tickFormatParams(t,i,s,n){return{type:"category"}}datumFormatParams(t,i,s,n,o){const{datum:a,seriesId:r,legendItemName:l,key:c,source:h,property:d,domain:u,boundSeries:p}=i;return Array.isArray(t)&&t.some(f=>typeof f!="string")?t=t.map(String):!Array.isArray(t)&&typeof t!="string"&&typeof t!="number"&&!(t instanceof Date)&&(t=String(t)),{type:"category",value:t,datum:a,seriesId:r,legendItemName:l,key:c,source:h,property:d,domain:u,boundSeries:p}}};Bu.className="CategoryAxis",Bu.type="category",g([m],Bu.prototype,"groupPaddingInner",2),g([m],Bu.prototype,"paddingInner",2),g([m],Bu.prototype,"paddingOuter",2);var nf=Bu,xK=1e3,RO=class qB extends qc{constructor(){super(...arguments),this.previousDomainJson=void 0,this.animatable=!0}static is(t){return t instanceof qB}set domain(t){if(t.length<=xK){const i=JSON.stringify(t);this.animatable=this.previousDomainJson===void 0||this.previousDomainJson===i,this.previousDomainJson=i}else this.animatable=this.previousDomainJson===void 0,this.previousDomainJson="";super.domain=t}get domain(){return super.domain}normalizeDomains(...t){const{domain:i}=super.normalizeDomains(...t);return{domain:i,animatable:!1}}findIndex(t){return super.findIndex(t)??this.getMatchIndex(t)}getMatchIndex(t){const i=JSON.stringify(t),s=this._domain.find(n=>JSON.stringify(n)===i);if(s!=null)return super.findIndex(s)}},bK=class{constructor(){this.top=1/0,this.right=-1/0,this.bottom=-1/0,this.left=1/0}update(e,t){e>this.right&&(this.right=e),e<this.left&&(this.left=e),t>this.bottom&&(this.bottom=t),t<this.top&&(this.top=t)}},vK=class QB{constructor(t="",i,s){this.label=t,this.parent=i,this.refId=s,this.position=0,this.subtreeLeft=Number.NaN,this.subtreeRight=Number.NaN,this.children=[],this.leafCount=0,this.prelim=0,this.mod=0,this.ancestor=this,this.change=0,this.shift=0,this.index=0,this.screen=0,this.depth=i?i.depth+1:0}insertTick(t,i){let s=this,n;for(let o=0;o<t.length;o++){const a=t[o],r=o!==t.length-1,{children:l}=s,c=l.find(h=>h.label===a);if(c&&r)s=c,n=c;else{const h=new QB(a,s,i);h.index=l.length,l.push(h),r&&(s=h),n=h}}return n}getLeftSibling(){return this.index>0?this.parent?.children[this.index-1]:void 0}getLeftmostSibling(){return this.index>0?this.parent?.children[0]:void 0}nextLeft(){return this.children[0]}nextRight(){return this.children.at(-1)}getSiblings(){return this.parent?.children.filter((t,i)=>i!==this.index)??[]}};function SK(e){const t=e.reduce((n,o)=>Math.max(n,o.length),0),i=new vK,s=new Map;for(let n=0;n<e.length;n++){const o=e[n];for(;o.length<t;)o.push("");const a=i.insertTick(o,n);a!=null&&s.set(o,a)}return{root:i,tickNodes:s}}function MK(e,t,i){const s=t.index-e.index,n=i/s;t.change-=n,t.shift+=i,e.change+=n,t.prelim+=i,t.mod+=i}function DK(e,t,i){return t.getSiblings().includes(e.ancestor)?e.ancestor:i}function IK({children:e}){let t=0,i=0;for(let s=e.length-1;s>=0;s--){const n=e[s];n.prelim+=t,n.mod+=t,i+=n.change,t+=n.shift+i}}function kK(e,t){const i=e.getLeftSibling();if(i){let s=e,n=e,o=i,a=n.getLeftmostSibling(),r=n.mod,l=s.mod,c=o.mod,h=a.mod;for(;o.nextRight()&&n.nextLeft();){o=o.nextRight(),n=n.nextLeft(),a=a.nextLeft(),s=s.nextRight(),s.ancestor=e;const d=o.prelim+c-(n.prelim+r)+1;d>0&&(MK(DK(o,e,t),e,d),r+=d,l+=d),c+=o.mod,r+=n.mod,h+=a.mod,l+=s.mod}o.nextRight()&&!s.nextRight()?s.mod+=c-l:(n.nextLeft()&&!a.nextLeft()&&(a.mod+=r-h),t=e)}return t}function FO(e){const{children:t}=e;if(t.length){let[i]=t;for(const o of t)FO(o),i=kK(o,i);IK(e);const s=(t[0].prelim+t.at(-1).prelim)/2,n=e.getLeftSibling();n?(e.prelim=n.prelim+1,e.mod=e.prelim-s):e.prelim=s}else{const i=e.getLeftSibling();e.prelim=i?i.prelim+1:0}}function zO(e,t,i){e.position=e.prelim+t,i.insertNode(e);for(const s of e.children)zO(s,t+e.mod,i)}function BO(e){const{children:t}=e;let i=0;for(const s of t)BO(s),s.children.length?i+=s.leafCount:i++;e.leafCount=i,t.length?(e.subtreeLeft=t[0].subtreeLeft,e.subtreeRight=t.at(-1).subtreeRight,e.position=(e.subtreeLeft+e.subtreeRight)/2):(e.subtreeLeft=e.position,e.subtreeRight=e.position)}function AK(e){const t=new CK,{root:i,tickNodes:s}=SK(e);return FO(i),zO(i,-i.prelim,t),BO(i),{layout:t,tickNodes:s}}var CK=class{constructor(){this.dimensions=new bK,this.nodes=[],this.depth=0}insertNode(e){this.depth<e.depth&&(this.depth=e.depth),this.dimensions.update(e.position,e.depth),this.nodes.push(e)}scaling(e,t){let i=1;if(e>0){const{left:s,right:n}=this.dimensions;n!==s&&(i=e/(n-s))}return t&&(i*=-1),i}},Px=5,Os=class extends K{constructor(){super(...arguments),this.enabled=!0,this.border=new Yc}};g([m],Os.prototype,"enabled",2),g([m],Os.prototype,"avoidCollisions",2),g([m],Os.prototype,"border",2),g([m],Os.prototype,"color",2),g([m],Os.prototype,"cornerRadius",2),g([m],Os.prototype,"spacing",2),g([m],Os.prototype,"rotation",2),g([m],Os.prototype,"wrapping",2),g([m],Os.prototype,"truncate",2),g([m],Os.prototype,"fill",2),g([m],Os.prototype,"fontStyle",2),g([m],Os.prototype,"fontWeight",2),g([m],Os.prototype,"fontSize",2),g([m],Os.prototype,"fontFamily",2),g([m],Os.prototype,"padding",2);var Rx=class extends K{constructor(){super(...arguments),this.enabled=!0}};g([m],Rx.prototype,"enabled",2),g([m],Rx.prototype,"width",2),g([m],Rx.prototype,"stroke",2);var KD=class extends K{constructor(){super(...arguments),this.label=new Os,this.tick=new Rx}};g([m],KD.prototype,"label",2),g([m],KD.prototype,"tick",2);var of=class extends nf{constructor(e){super(e,new RO),this.tickScale=new RO,this.computedLayout=void 0,this.tickTreeLayout=void 0,this.tickNodes=void 0,this.depthOptions=new Pi(KD),this.includeInvisibleDomains=!0,this.tickScale.paddingInner=1,this.tickScale.paddingOuter=0}resizeTickTree(){if(!this.tickTreeLayout)return;const{nodes:e}=this.tickTreeLayout,{range:t,step:i,inset:s,bandwidth:n}=this.scale,o=Math.abs(t[1]-t[0])-i,a=this.tickTreeLayout.scaling(o,t[0]>t[1]),r=s+n/2;let l=0;for(const c of e){const h=c.position*a;l>h&&(l=h),c.screen=h+r}for(const c of e)c.screen-=l}getDepthOptionsMap(e){const t=[],{depthOptions:i,label:s}=this,n=this.horizontal?0:-90;for(let o=0;o<e;o++)t.push(i[o]?.label.enabled??s.enabled?{enabled:!0,spacing:i[o]?.label.spacing??s.spacing,wrapping:i[o]?.label.wrapping??s.wrapping,truncate:i[o]?.label.truncate??s.truncate,rotation:i[o]?.label.rotation??(o?n:s.rotation),avoidCollisions:i[o]?.label.avoidCollisions??s.avoidCollisions}:{enabled:!1,spacing:0,rotation:0,avoidCollisions:!1});return t}updateCategoryLabels(){this.computedLayout&&this.tickLabelGroupSelection.update(this.computedLayout.tickLabelLayout).each((e,t)=>{e.fill=t.color,e.text=t.text,e.textBaseline=t.textBaseline,e.textAlign=t.textAlign??"center",e.pointerEvents=t.textUntruncated==null?1:0,e.setFont(t),e.setBoxing(t)})}updateAxisLine(){this.computedLayout&&(this.lineNode.visible=this.line.enabled,this.lineNode.stroke=this.line.stroke,this.lineNode.strokeWidth=this.line.width)}computeLayout(){this.updateDirection(),this.updateScale();const{step:e}=this.scale,{title:t,label:i,range:s,depthOptions:n,horizontal:o,line:a}=this;if(this.lineNode.datum=o?{x1:s[0],x2:s[1],y1:0,y2:0}:{x1:0,x2:0,y1:s[0],y2:s[1]},this.lineNode.setProperties({stroke:a.stroke,strokeWidth:a.enabled?a.width:0}),this.resizeTickTree(),!this.tickTreeLayout?.depth)return{bbox:re.zero,spacing:0,depthLabelMaxSize:{},tickLabelLayout:[]};const{depth:r,nodes:l}=this.tickTreeLayout,c=o?-i.getSideFlag():i.getSideFlag(),h=[],d=new Map,u=new Map,p=new su,f=this.getDepthOptionsMap(r),y=c*f[0].spacing,b=this.tickFormatter(this.scale.domain,this.scale.domain,!1),x=(C,w)=>{const T=r-C.depth;if(!f[T]?.enabled||!fS(C.screen,s))return!1;let O=(C.leafCount||1)*e;if(O<Px)return!1;const E=b(C.label,w-1);let z=E;const F=this.getLabelStyles({value:C.index,formattedValue:z,depth:T},n[T]?.label);if(i.avoidCollisions){const _=f[T].rotation;let G=this.thickness;if(_!=null){const V=l0(_,O,G);O=V.width,G=V.height}const B={font:F,textWrap:f[T].wrapping,overflow:f[T].truncate?"ellipsis":"hide",maxWidth:O,maxHeight:G};z=Rd(z,B)||z}return z!==E&&AS(z)?u.set(w,Pe(E)):u.delete(w),p.x=o?C.screen:y,p.y=o?y:C.screen,p.rotation=0,p.fill=F.color,p.text=z,p.textAlign="center",p.textBaseline=i.parallel?"top":"bottom",p.setFont(F),p.setBoxing(F),!0},v={};for(const[C,w]of l.entries()){const T=r-w.depth;if(v[T]??(v[T]=0),!w.children.length&&e<Px||!x(w,C)||!p.getBBox())continue;d.set(C,p.getBBox()),p.rotation=Po(f[T]?.rotation);const{width:z,height:F}=p.getBBox(),_=o?F:z;v[T]<_&&(v[T]=_)}const S=Sg(),M=C=>{if(C===0)return 0;let w=v[0];for(let T=1;T<=C;T++)w+=f[T].spacing,T!==C&&(w+=v[T]);return w};for(const[C,w]of l.entries()){if(C===0)continue;const T=x(w,C),O=!w.children.length,E=r-w.depth;if(O&&e<Px||!T)continue;const z=Po(f[E].rotation),F=d.get(C);if(!F)continue;const{width:_,height:G}=F,B=M(E);if(p.textAlign="center",p.textBaseline="middle",p.rotation=z,o?(p.y+=(B+ty(_/2,G/2,z))*c,p.rotationCenterX=w.screen,p.rotationCenterY=p.y):(p.x+=B*c+ty((f[E].spacing*c+_)/2,i.mirrored?_:0,z)-_/2,p.rotationCenterX=p.x,p.rotationCenterY=w.screen),f[E].avoidCollisions){const{width:X,height:q}=p.getBBox(),te=o?X:q,pe=O?e:w.leafCount*e;if(te>pe){d.delete(C);continue}}const V=p.getPlainText(),Y=p.getBoxingProperties();h.push({text:V,textUntruncated:u.get(C),visible:!0,tickId:S(V),range:this.scale.range,border:Y.border,color:p.fill,cornerRadius:Y.cornerRadius,fill:Y.fill,fontFamily:p.fontFamily,fontSize:p.fontSize,fontStyle:p.fontStyle,fontWeight:p.fontWeight,padding:Y.padding,rotation:p.rotation,rotationCenterX:p.rotationCenterX,rotationCenterY:p.rotationCenterY,textAlign:p.textAlign,textBaseline:p.textBaseline,x:p.x,y:p.y}),d.set(C,Kt.toCanvas(p))}let D=v[0];for(let C=0;C<r;C++)D+=f[C].spacing,C!==0&&(D+=v[C]);const k=[this.lineNodeBBox(),re.merge(d.values()),new re(0,0,D*c,0)];let I=0;if(t.enabled){const C=re.merge(k);I=o?C.height:C.width,k.push(this.titleBBox(this.scale.domain,I))}const A=re.merge(k);return this.layoutCrossLines(),{bbox:A,spacing:I,depthLabelMaxSize:v,tickLabelLayout:h}}update(){if(!this.computedLayout)return;this.scale.animatable||this.moduleCtx.animationManager.skipCurrentBatch();const{tickScale:e,tick:t,gridLine:i,gridLength:s,visibleRange:n,tickTreeLayout:o}=this;if(!o)return;const{depthLabelMaxSize:a,spacing:r}=this.computedLayout,{depth:l}=o,c=this.getDepthOptionsMap(l),{position:h,horizontal:d,gridPadding:u}=this,p=h==="bottom"||h==="right"?-1:1,f=u,y=p*s-u;let b;if(e.step>Px){const v={nice:[!1,!1],interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0};b=e.ticks(v,void 0,n).ticks}else b=[];const x=b.map((v,S)=>({index:e.findIndex(v),tickId:cs(S,...v),translation:Math.round(e.convert(v))}));this.gridLineGroupSelection.update(i.enabled&&s?this.calculateGridLines(x,f,y):[]),this.gridFillGroupSelection.update(i.enabled&&s?this.calculateGridFills(x,f,y):[]),this.tickLineGroupSelection.update(t.enabled?b.map((v,S)=>{const{tickId:M,translation:D}=x[S],k=this.tickNodes?.get(v),I=k==null?l-1:Math.min(LK(k),l-1),A=this.depthOptions[I]?.tick;let C=a[0];for(let B=0;B<=I;B++)C+=c[B].spacing,B!==0&&(C+=a[B]);const w=A?.stroke??t.stroke,T=A?.enabled===!1?0:A?.width??t.width,O=-p*C,[E,z,F,_]=d?[D,D,0,O]:[0,O,D,D];return{tickId:M,offset:D,x1:E,y1:F,x2:z,y2:_,stroke:w,strokeWidth:T,lineDash:void 0}}):[]),this.updatePosition(),this.updateCategoryLabels(),this.updateAxisLine(),this.updateGridLines(),this.updateGridFills(),this.updateTickLines(),this.updateTitle(this.scale.domain,r),this.updateCrossLines(),this.resetSelectionNodes()}calculateLayout(){const{depthLabelMaxSize:e,tickLabelLayout:t,spacing:i,bbox:s}=this.computeLayout();return this.computedLayout={depthLabelMaxSize:e,tickLabelLayout:t,spacing:i},{bbox:s,niceDomain:this.scale.domain}}onGridVisibilityChange(){super.onGridVisibilityChange(),this.tickLabelGroupSelection.clear()}updateScale(){super.updateScale(),this.tickScale.range=this.scale.range,this.scale.paddingOuter=this.scale.paddingInner/2}processData(){const{direction:e}=this,t=this.boundSeries.filter(l=>l.visible).flatMap(l=>Jh(l.getDomain(e)));this.dataDomain={domain:Ro(t)??this.filterDuplicateArrays(t),clipped:!1},this.isReversed()&&this.dataDomain.domain.reverse();const i=this.dataDomain.domain.map(_O),{layout:s,tickNodes:n}=AK(i);this.tickTreeLayout=s,this.tickNodes=n;const o=[];for(const l of this.tickTreeLayout.nodes)l.leafCount||l.refId==null||o.push(this.dataDomain.domain[l.refId]);const a=iS(this.dataDomain.domain,o);this.scale.domain=a;const r=a.map(_O);r.push([""]),this.tickScale.domain=r}filterDuplicateArrays(e){const t=new Set;return e.filter(i=>{const s=Ce(i)?JSON.stringify(i):i;return t.has(s)?!1:(t.add(s),!0)})}};of.className="GroupedCategoryAxis",of.type="grouped-category",g([m],of.prototype,"depthOptions",2);function LK(e){let t=0,i=e;for(;i?.index===0;)t+=1,i=i.parent;return t}function _O(e){return Yh(fe(e)&&"value"in e?e.value:e)}function Fx(e,t){for(const i of t){const s=i.datum;s===void 0?j.error("undefined datum"):e.addValue(i,s)}}function zx(e,t){const{x:i,y:s}=t,{nearest:n,distanceSquared:o}=e.getQuadTree().find(i,s);if(n!==void 0)return{datum:n.value,distance:Math.sqrt(o)}}var YD=class extends Zo{constructor(){super(...arguments),this.direction="vertical"}};g([m],YD.prototype,"direction",2);var VO=class extends Wl{constructor(){super(...arguments),this.groupScale=new qc,this.smallestDataInterval=void 0,this.largestDataInterval=void 0}padBandExtent(e,t){const i=typeof t=="boolean"?1:.5,s=$e(this.smallestDataInterval)?this.smallestDataInterval*i:0,n=Ro(e)??[Number.NaN,Number.NaN];return typeof t=="boolean"?n[t?0:1]-=(t?1:-1)*s:(n[0]-=s,n[1]+=s),ln(n)}getBandScalePadding(){return{inner:.3,outer:.15}}shouldFlipXY(){return!this.isVertical()}isVertical(){return this.properties.direction==="vertical"}getBarDirection(){return this.shouldFlipXY()?"x":"y"}getCategoryDirection(){return this.shouldFlipXY()?"y":"x"}getValueAxis(){const e=this.getBarDirection();return this.axes[e]}getCategoryAxis(){const e=this.getCategoryDirection();return this.axes[e]}getBandwidth(e,t){return yt.is(e.scale)?e.scale.calcBandwidth(this.smallestDataInterval,t):e.scale.bandwidth}xCoordinateRange(e){const t=this.axes[this.getCategoryDirection()],i=t.scale,s=this.getBandwidth(t,0)??0,n=yt.is(i)?s*-.5:0,o=i.convert(e)+n;return[o,o+s]}yCoordinateRange(e){const i=this.axes[this.getBarDirection()].scale,s=e.map(n=>i.convert(n));if(s.length===1){const n=i.convert(0);return[Math.min(s[0],n),Math.max(s[0],n)]}return[Math.min(...s),Math.max(...s)]}updateGroupScale(e){const t=[],{groupScale:i}=this,s=this.getBandwidth(e),{index:n,visibleGroupCount:o}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);for(let r=0;r<o;r++)t.push(String(r));return i.domain=t,i.range=[0,s??0],e instanceof of?i.paddingInner=e.groupPaddingInner:e instanceof nf?(i.paddingInner=e.groupPaddingInner,i.round=i.padding!==0):i.padding=0,{barWidth:i.bandwidth>=1?i.bandwidth:i.rawBandwidth,groupIndex:n}}resolveKeyDirection(e){return this.getBarDirection()==="x"?e==="x"?"y":"x":e}initQuadTree(e){Fx(e,this.datumNodesIter())}pickNodeClosestDatum(e){return zx(this,e)}};function Ci(e,t,i){return(t-e)*i+e}function GO(e,t){const{x0:i,y0:s,x1:n,y1:o}=e,r=(o-s)/(n-i)*(t-i)+s;return{leftCp1x:i,leftCp1y:s,leftCp2x:t,leftCp2y:r,stepX:t,stepY0:r,stepY1:r,rightCp1x:t,rightCp1y:r,rightCp2x:n,rightCp2y:o}}function wK(e,t){const{cp0x:i,cp0y:s,cp1x:n,cp1y:o,cp2x:a,cp2y:r,cp3x:l,cp3y:c}=e,h=Dg(i,n,a,l,t),[d,u]=Ud(i,s,n,o,a,r,l,c,h),p=d[3].y;return{leftCp1x:d[1].x,leftCp1y:d[1].y,leftCp2x:d[2].x,leftCp2y:d[2].y,stepX:t,stepY0:p,stepY1:p,rightCp1x:u[1].x,rightCp1y:u[1].y,rightCp2x:u[2].x,rightCp2y:u[2].y}}function TK(e){const{x0:t,y0:i,x1:s,y1:n,stepX:o}=e;return{leftCp1x:(t+o)/2,leftCp1y:i,leftCp2x:(t+o)/2,leftCp2y:i,stepX:o,stepY0:i,stepY1:n,rightCp1x:(o+s)/2,rightCp1y:n,rightCp2x:(o+s)/2,rightCp2y:n}}function HO(e,t){return e.type==="linear"?GO(e,t):e.type==="cubic"?wK(e,t):e.type==="step"?TK(e):GO(e,t)}function jO(e,t,i,s,n,o,a){switch(t){case 0:a?e.moveTo(n,o):e.moveTo(i,s);break;case 1:a?e.lineTo(n,o):e.lineTo(i,s);break;case 2:break}}function WO(e,t,i,s,n,o){o?e.lineTo(t,i):e.lineTo(s,n)}function $O(e,t,i,s,n,o,a,r,l,c){c?e.cubicCurveTo(o,a,s,n,t,i):e.cubicCurveTo(s,n,o,a,r,l)}function UO(e,t,i,s,n,o,a){a?(e.lineTo(o,n),e.lineTo(o,i),e.lineTo(t,i)):(e.lineTo(o,i),e.lineTo(o,n),e.lineTo(s,n))}function NK(e,t,i,s,n,o,a){if(a){for(let r=o.length-1;r>=0;r--){const{x:l,y:c}=o[r];e.lineTo(l,c)}e.lineTo(t,i)}else{for(const{x:r,y:l}of o)e.lineTo(r,l);e.lineTo(s,n)}}function af(e,t,i,s){const[n,o]=Zs(t);switch(jO(e,i,n.x,n.y,o.x,o.y,s),t.type){case"linear":WO(e,t.x0,t.y0,t.x1,t.y1,s);break;case"cubic":$O(e,t.cp0x,t.cp0y,t.cp1x,t.cp1y,t.cp2x,t.cp2y,t.cp3x,t.cp3y,s);break;case"step":UO(e,t.x0,t.y0,t.x1,t.y1,t.stepX,s);break;case"multi-line":NK(e,t.x0,t.y0,t.x1,t.y1,t.midPoints,s);break}}function KO(e,t,i){const[s,n]=Zs(e),[o,a]=Zs(t),r=Ci(s.x,o.x,i),l=Ci(s.y,o.y,i),c=Ci(n.x,a.x,i),h=Ci(n.y,a.y,i);return[{x:r,y:l},{x:c,y:h}]}function ZD(e,t,i,s,n,o){const[{x:a,y:r},{x:l,y:c}]=KO(t,i,s);if(jO(e,n,a,r,l,c,o),t.type==="cubic"&&i.type==="cubic"){const h=Ci(t.cp1x,i.cp1x,s),d=Ci(t.cp1y,i.cp1y,s),u=Ci(t.cp2x,i.cp2x,s),p=Ci(t.cp2y,i.cp2y,s);$O(e,a,r,h,d,u,p,l,c,o)}else if(t.type==="step"&&i.type==="step"){const h=Ci(t.stepX,i.stepX,s);UO(e,a,r,l,c,h,o)}else if(t.type==="linear"&&i.type==="linear")WO(e,a,r,l,c,o);else{let h;t.type==="step"?h=t.stepX:i.type==="step"?h=i.stepX:h=(a+l)/2;const d=HO(t,h),u=HO(i,h),p=Ci(d.leftCp1x,u.leftCp1x,s),f=Ci(d.leftCp1y,u.leftCp1y,s),y=Ci(d.leftCp2x,u.leftCp2x,s),b=Ci(d.leftCp2y,u.leftCp2y,s),x=Ci(d.stepX,u.stepX,s),v=Ci(d.stepY0,u.stepY0,s),S=Ci(d.stepY1,u.stepY1,s),M=Ci(d.rightCp1x,u.rightCp1x,s),D=Ci(d.rightCp1y,u.rightCp1y,s),k=Ci(d.rightCp2x,u.rightCp2x,s),I=Ci(d.rightCp2y,u.rightCp2y,s);o?(e.cubicCurveTo(k,I,M,D,x,S),e.lineTo(x,v),e.cubicCurveTo(y,b,p,f,a,r)):(e.cubicCurveTo(p,f,y,b,x,v),e.lineTo(x,S),e.cubicCurveTo(M,D,k,I,l,c))}}var YO=1e3,ZO=(e=>(e[e.Zero=0]="Zero",e[e.Split=1]="Split",e))(ZO||{});function OK(e,t){return e==null||t==null||typeof e!="object"||typeof t!="object"?!1:"id"in e&&"id"in t?e.id===t.id:e.toString()===t.toString()}function Es(e){return Mg(e).valueOf()}function fs(e,t){if(!t)return Number.NaN;if(e instanceof Date&&(e=e.getTime()),t.type==="continuous"&&typeof e=="number")return(e-t.domain[0])/(t.domain[1]-t.domain[0])*(t.range[1]-t.range[0])+t.range[0];if(t.type==="log"&&typeof e=="number")return t.convert(e);if(t.type!=="category")return Number.NaN;if(yr(t)){if(typeof e=="number"){const{firstBandTime:n,intervalMs:o,bandCount:a,inset:r,step:l}=t,c=Math.round((e-n)/o);if(c>=0&&c<a)return r+l*c}return Number.NaN}const i=Es(e);let s=t.domain.findIndex(n=>Es(n)===i);return s===-1&&(s=t.domain.findIndex(n=>OK(e,n))),s>=0?t.inset+t.step*s:Number.NaN}function XO({data:e},t){return e.map((i,s)=>({xValue0Index:t.indexOf(Es(i.xValue0)),xValue1Index:t.indexOf(Es(i.xValue1)),datumIndex:s}))}function qO(e){return Object.values(e.scales).every(t=>t.type==="category"?yr(t)?t.bandCount<YO:t.domain.length<YO:!0)}function EK(e,t){const i=t.scales.x,s=e.scales.x;if(i?.type!=="category"||s?.type!=="category"||yr(i)||yr(s))return!0;let n=-1/0;for(const o of i.domain){const a=fs(o,s);if(Number.isFinite(a)){if(a<n)return!1;n=a}}return!0}function PK(e,t){let i=-1/0;for(const s of e){const n=fs(s.value,t.scales.x);if(Number.isFinite(n)){if(n<i)return!1;i=n}}return!0}function RK(e,t){const i=new Map;for(const{xValue0:h,xValue1:d}of e.data){const u=Es(h),p=Es(d);i.set(u,h).set(p,d)}const s=Array.from(i,([h,d])=>({axisValue:h,value:d}));s.sort((h,d)=>fs(h.value,e.scales.x)-fs(d.value,e.scales.x));const n=[];for(const{xValue0:h,xValue1:d}of t.data){const u=Es(h),p=Es(d);i.has(u)||(i.set(u,h),n.push({axisValue:u,value:h})),i.has(p)||(i.set(p,d),n.push({axisValue:p,value:d}))}n.sort((h,d)=>fs(h.value,t.scales.x)-fs(d.value,t.scales.x));const o=s;let a=0;for(const h of n){for(let d=o.length-1;d>=a;d-=1){const u=fs(h.value,t.scales.x),p=fs(o[d].value,t.scales.x);if(u>p){a=d+1;break}}o.splice(a,0,h),a+=1}if(!PK(o,t))return;const r=o.map(h=>h.axisValue),l=XO(t,r),c=XO(e,r);return{axisValues:r,oldDataAxisIndices:l,newDataAxisIndices:c}}function QO(e,t,i,s,n){if(n.xValue1Index===n.xValue0Index+1)return e;const o=Zs(e);let a,r;if(t.scales.x?.type==="category"){const l=(o[1].x-o[0].x)/(n.xValue1Index-n.xValue0Index);a=o[0].x+(s-n.xValue0Index)*l,r=a+l}else{const l=i[s],c=i[s+1];a=fs(l,t.scales.x),r=fs(c,t.scales.x)}return Py(e,a,r)}function JO(e,t){const[i,s]=Zs(e),n=fs(0,t.scales.y);return _c(e,{x:i.x,y:n},{x:s.x,y:n})}function e2(e){const[t,i]=Zs(e);return eM(e,{x:(t.x+i.x)/2,y:(t.y+i.y)/2})}function t2(e,t,i,s,n,o){let a,r;if(n.xValue0Index>=o.xValue1Index){const d=s.findLast(p=>p.xValue1Index<=o.xValue1Index)?.datumIndex,u=d==null?void 0:i.data[d];a=u?.xValue1,r=u?.yValue1}else if(n.xValue0Index<=o.xValue0Index){const d=s.find(p=>p.xValue0Index>=o.xValue0Index)?.datumIndex,u=d==null?void 0:i.data[d];a=u?.xValue0,r=u?.yValue0}if(a==null||r==null)switch(t){case 0:return JO(e,i);case 1:return e2(e)}const l=fs(a,i.scales.x),c=fs(r,i.scales.y),h={x:l,y:c};return _c(e,h,h)}function XD(e,t){if(t==null)return;const i=Es(e.xValue0),s=Es(e.xValue1);return t.find(n=>Es(n.xValue0)===i&&Es(n.xValue1)===s)?.span}function i2(e,t,i,s,n,o,a){const r=e.data[s.datumIndex],l=r.span,c=XD(r,n);if(c==null){const h=t2(l,t,e,i,s,o);a.added.push({from:h,to:l})}else a.removed.push({from:c,to:c}),a.moved.push({from:c,to:l}),a.added.push({from:l,to:l})}function s2(e,t,i,s,n,o,a){const r=e.data[s.datumIndex],l=r.span,c=XD(r,n);if(c==null){const h=t2(l,t,e,i,s,o);a.removed.push({from:l,to:h})}else a.removed.push({from:l,to:l}),a.moved.push({from:l,to:c}),a.added.push({from:c,to:c})}function n2(e,t,i,s,n){const o=s.scales.x,a=t[n.xValue0Index],r=t[n.xValue1Index];let l,c;if(o?.type==="continuous"||o?.type==="log"?(l=i.data.findLast(x=>Es(x.xValue0)<=a),c=i.data.find(x=>Es(x.xValue1)>=r)):(l=i.data.find(x=>Es(x.xValue0)===a),c=i.data.find(x=>Es(x.xValue1)===r)),l==null||c==null)return;const[{x:h},{x:d}]=Zs(e),u=fs(l.xValue0,i.scales.x),p=fs(l.yValue0,i.scales.y),f=fs(c.xValue1,i.scales.x),y=fs(c.yValue1,i.scales.y);let b=s.data[n.datumIndex].span;return b=_c(b,{x:u,y:p},{x:f,y}),b=Py(b,h,d),b}function FK(e,t,i,s,n,o,a,r,l){const c=n+1,h=a.find(S=>S.xValue0Index<=n&&S.xValue1Index>=c),d=o.find(S=>S.xValue0Index<=n&&S.xValue1Index>=c),u=t.zeroData,p=e.zeroData;if(h==null&&d!=null){i2(e,i,o,d,u,r,l);return}else if(h!=null&&d==null){s2(t,i,a,h,p,r,l);return}else if(h==null||d==null)return;let f;h.xValue0Index===d.xValue0Index&&h.xValue1Index===d.xValue1Index?f=0:h.xValue0Index<=d.xValue0Index&&h.xValue1Index>=d.xValue1Index?f=-1:h.xValue0Index>=d.xValue0Index&&h.xValue1Index<=d.xValue1Index?f=1:f=0;const y=t.data[h.datumIndex],b=QO(y.span,t,s,n,h),x=e.data[d.datumIndex],v=QO(x.span,e,s,n,d);if(f===1){const S=n2(b,s,t,e,d);S==null?s2(t,i,a,h,p,r,l):(l.removed.push({from:b,to:S}),l.moved.push({from:S,to:v}),l.added.push({from:v,to:v}))}else if(f===-1){const S=n2(v,s,e,t,h);S==null?i2(e,i,o,d,u,r,l):(l.removed.push({from:b,to:b}),l.moved.push({from:b,to:S}),l.added.push({from:S,to:v}))}else l.removed.push({from:b,to:b}),l.moved.push({from:b,to:v}),l.added.push({from:v,to:v})}function zK(e,t,i,s){const n={removed:[],moved:[],added:[]},{axisValues:o,oldDataAxisIndices:a,newDataAxisIndices:r}=e,l={xValue0Index:Math.max(a.at(0)?.xValue0Index??-1/0,r.at(0)?.xValue0Index??-1/0),xValue1Index:Math.min(a.at(-1)?.xValue1Index??1/0,r.at(-1)?.xValue1Index??1/0)};for(let c=0;c<o.length-1;c+=1)FK(t,i,s,o,c,r,a,l,n);return n}function BK(e,t){const i=[],s=[],n=[];for(let o=0;o<t.data.length;o+=1){const a=t.data[o].span,r=e.data[o].span;i.push({from:a,to:a}),s.push({from:a,to:r}),n.push({from:r,to:r})}return{removed:i,moved:s,added:n}}function o2(e,t,i){const{span:s}=t;switch(i){case 0:return XD(t,e.zeroData)??JO(s,e);case 1:return e2(s)}}function _K(e,t,i){const s=[],n=[];for(const o of t.data){const a=o.span,r=o2(t,o,i);n.push({from:a,to:r})}for(const o of e.data){const a=o.span,r=o2(e,o,i);s.push({from:r,to:a})}return{removed:n,moved:[],added:s}}function rf(e,t,i){if(!qO(e)||!qO(t)||!EK(e,t))return;const s=RK(e,t);return s==null?_K(e,t,i):s.axisValues.length===s.oldDataAxisIndices.length+s.newDataAxisIndices.length+2?BK(e,t):zK(s,e,t,i)}function lf(e,t){const i=e.map(n=>n.point);let s=iM(i);switch(t.type){case"linear":break;case"smooth":s=nM(i,t.tension);break;case"step":s=sM(i,t.position);break}return s.map(function(o,a){return{span:o,xValue0:e[a].xDatum,yValue0:e[a].yDatum,xValue1:e[a+1].xDatum,yValue1:e[a+1].yDatum}})}function Bx(e,t,i=.001){return Math.abs(e.x-t.x)<i&&Math.abs(e.y-t.y)<i}function qD({path:e},t){let i;for(const{span:s}of t){const[n,o]=Zs(s),a=i!=null&&Bx(i,n)?2:0;af(e,s,a,!1),i=o}}function _x(e,t,i){let s;for(const n of i){const[o,a]=KO(n.from,n.to,e),r=s!=null&&Bx(s,o)?2:0;ZD(t.path,n.from,n.to,e,r,!1),s=a}}function a2(e,t,i){const s=(r,l)=>_x(r,l,t.removed),n=(r,l)=>_x(r,l,t.moved),o=(r,l)=>_x(r,l,t.added),a=QD(e,i);return{status:e,path:{addPhaseFn:o,updatePhaseFn:n,removePhaseFn:s},pathProperties:a}}function QD(e,t){const i=t==="none"?"updated":e,s={fromFn(n,o){const a={phase:Ho[i]},r=n.previousDatum??o;return r!=null&&(a.segments=r),e==="removed"?a.finish={visible:!1}:e==="added"&&(a.start={visible:!0}),a},toFn(n,o){const a={phase:Ho[i]},r=o;return r!=null&&(a.segments=r),a}};return t==="fade"?{fromFn(n,o){const a=e==="added"?0:n.opacity,r=e==="removed"?n.previousDatum??o:o;return{...s.fromFn(n,o),opacity:a,segments:r}},toFn(n,o){const a=e==="removed"?0:1,r=e==="removed"?n.previousDatum??o:o;return{...s.toFn(n,o),opacity:a,segments:r}}}:s}function VK(e,t,i){const s=e.scales.x?.type==="category",n=t.scales.x?.type==="category";if(s!==n||!Dl(e.scales.x)||!Dl(t.scales.x)||e.strokeData==null||t.strokeData==null)return;let o="updated";t.visible&&!e.visible?o="removed":!t.visible&&e.visible&&(o="added");const a=rf({scales:e.scales,data:e.strokeData.spans},{scales:t.scales,data:t.strokeData.spans},1);if(a==null)return;const r=a2(o,a,"fade"),l=(i?.changed??!0)||!_o(e.scales.x,t.scales.x)||!_o(e.scales.y,t.scales.y)||o!=="updated";return{status:o,stroke:r,hasMotion:l}}function r2(e,t,i,s){if(t!=null){const[n,o]=t;if(n!==0||o!==1)return!1}if(yt.is(e)){const n=e.calcBandwidth(s)-e.calcBandwidth(i);if(n>0&&n<1)return!1}if(Ma.is(e)){const{bandwidth:n,step:o}=e;if(n>0&&n<1)return!1;const a=o-n;if(a>0&&a<1)return!1}return!0}var JD=e=>bc(e.yValue??0);function cf(e,t,i){const{startingX:s,startingY:n}=HK(e,t);return{isVertical:e,calculate:(a,r)=>{let l=e?a.x:s,c=e?n:a.y,h=e?a.width:0,d=e?0:a.height;const{opacity:u=1}=a;r&&(Number.isNaN(l)||Number.isNaN(c))&&({x:l,y:c}=r,h=e?r.width:0,d=e?0:r.height,e&&!JD(r)?c+=r.height:!e&&JD(r)&&(l+=r.width));let p;return a.clipBBox==null?p=void 0:JD(a)?p=e?new re(l,c-d,h,d):new re(l-h,c,h,d):p=new re(l,c,h,d),{x:l,y:c,width:h,height:d,clipBBox:p,opacity:u}},mode:i}}function GK(e,t){return{isVertical:e,calculate:i=>({x:e?i.x:i.x+i.width/2,y:e?i.y+i.height/2:i.y,width:e?i.width:0,height:e?0:i.height,clipBBox:i.clipBBox,opacity:i.opacity??1}),mode:t}}function hf(e,t){const i=a=>a==null||Number.isNaN(a.x)||Number.isNaN(a.y);return{toFn:(a,r,l)=>l==="removed"&&a.datum==null&&e.mode==="fade"?{...df(a,r),opacity:0}:l==="removed"||i(r)?e.calculate(r,a.previousDatum):{x:r.x,y:r.y,width:r.width,height:r.height,clipBBox:r.clipBBox,opacity:r.opacity??1},fromFn:(a,r,l)=>{l==="updated"&&i(r)?l="removed":l==="updated"&&i(a.previousDatum)&&(l="added");let c;l==="unknown"||l==="added"?(a.previousDatum==null&&e.mode==="fade"?c={...df(a,r),opacity:0}:c=e.calculate(r,a.previousDatum),l==="unknown"&&(l=t)):c={x:a.x,y:a.y,width:a.width,height:a.height,clipBBox:a.clipBBox,opacity:a.opacity??1};const h=Ho[l];return{...c,phase:h}},applyFn:(a,r,l)=>{a.resetAnimationProperties(r.x,r.y,r.width,r.height,r.opacity??1,r.clipBBox),a.crisp=l==="end"&&(a.datum?.crisp??!1)}}}function HK(e,t){const i=t[e?"y":"x"];let s=1/0,n=0;return i?(e?n=i.scale.convert(yt.is(i.scale)?0:Math.max(...i.range)):s=i.scale.convert(yt.is(i.scale)?0:Math.min(...i.range)),{startingX:s,startingY:n}):{startingX:s,startingY:n}}function df(e,{x:t,y:i,width:s,height:n,clipBBox:o,opacity:a=1}){return{x:t,y:i,width:s,height:n,clipBBox:o,opacity:a,crisp:e.datum?.crisp??!1}}function eI(e){for(const t of e){const i=t.nodes();t.batchedUpdate(function(){for(const n of i){const o=n.datum;o!=null&&(n.resetAnimationProperties(o.x,o.y,o.width,o.height,o.opacity??1,o.clipBBox),n.crisp=o.crisp??!1)}t.cleanup()})}}function tI(e,t){if(t===void 0)return;const{x:i,y:s,width:n,height:o}=t;return Kt.toCanvas(e.contentGroup,new re(i,s,n,o))}function l2({path:e},{spans:t,phantomSpans:i}){let s=0,n={x:Number.NaN,y:Number.NaN},o={x:Number.NaN,y:Number.NaN};for(let a=0;a<t.length;a+=1){const{span:r}=t[a],{span:l}=i[a],{0:c,1:h}=Zs(r),{0:d,1:u}=Zs(l);if(Bx(n,c)&&Bx(o,d))af(e,r,2,!1);else{for(let p=a-1;p>=s;p-=1)af(e,i[p].span,1,!0);e.closePath(),af(e,r,0,!1),s=a}n=h,o=u}for(let a=t.length-1;a>=s;a-=1)af(e,i[a].span,1,!0);e.closePath()}function iI(e,{path:t},i,s){for(let n=0;n<i.length;n+=1){const o=i[n],a=s[n];ZD(t,o.from,o.to,e,0,!1),ZD(t,a.from,a.to,e,1,!0),t.closePath()}}function c2(e,t,i,s){const n=(l,c)=>iI(l,c,t.removed,i.removed),o=(l,c)=>iI(l,c,t.moved,i.moved),a=(l,c)=>iI(l,c,t.added,i.added),r=QD(e,s);return{status:e,path:{addPhaseFn:a,updatePhaseFn:o,removePhaseFn:n},pathProperties:r}}function jK(e,t){const i=e.scales.x?.type==="category",s=t.scales.x?.type==="category";if(i!==s||!Dl(e.scales.x)||!Dl(t.scales.x))return;let n="updated";t.visible&&!e.visible?n="removed":!t.visible&&e.visible&&(n="added");const o=rf({scales:e.scales,data:e.fillData.spans},{scales:t.scales,data:t.fillData.spans},0);if(o==null)return;const a=rf({scales:e.scales,data:e.fillData.phantomSpans},{scales:t.scales,data:t.fillData.phantomSpans},0);if(a==null)return;const r=rf({scales:e.scales,data:e.strokeData.spans,zeroData:e.fillData.phantomSpans},{scales:t.scales,data:t.strokeData.spans,zeroData:t.fillData.phantomSpans},0);if(r==null)return;const l="none",c=c2(n,o,a,l),h=a2(n,r,l);return{status:n,fill:c,stroke:h}}function h2(e,t,i,s,n,o,a){let r=o?.reduced?.diff?.[e];if(r?.changed)return r;if(!a)return{changed:!1,added:new Set,updated:new Set,removed:new Set,moved:new Set};const l=WK(s,n);return r==null&&o?.reduced?.diff!=null?(r={changed:!0,added:new Set,updated:new Set,removed:new Set,moved:new Set},l?r.updated=new Set(Array.from(t,({datum:c})=>i(c))):r.added=new Set(Array.from(t,({datum:c})=>i(c)))):l&&(r={changed:!0,added:new Set,updated:new Set(Array.from(t,({datum:c})=>i(c))),removed:new Set,moved:new Set}),r}function d2(e){return typeof e=="object"&&e!==null&&"groupScale"in e}function WK(e,t){if(!t)return!1;const i=e.scales,s=t.scales;if(!_o(i.x,s.x)||!_o(i.y,s.y))return!0;if(!d2(e)||!d2(t))return!1;const n=e.groupScale,o=t.groupScale;return!_o(n,o)}function uf({id:e},t,i,...s){const n={phase:i?Ho[i]:"trailing"};Nl(e,"markers",t,s,{opacity:0},{opacity:1},n);for(const o of s)o.cleanup()}function $K({id:e},t,...i){Nl(e,"markers",t,i,{scalingX:0,scalingY:0},{scalingX:1,scalingY:1},{phase:"initial"});for(const s of i)s.cleanup()}function sI({id:e,nodeDataDependencies:t},i,...s){const n=t.seriesRectWidth;li(e,"markers",i,s,{fromFn:(r,l)=>{const c=l.midPoint?.x??n;let h=ge(0,hM(c/n),1);return Number.isNaN(h)&&(h=0),{scalingX:0,scalingY:0,delay:h,duration:EM,phase:"initial"}},toFn:()=>({scalingX:1,scalingY:1})})}function Vx(e){return{opacity:1,scalingX:1,scalingY:1}}function nI(e){for(const t of e){const i=t.nodes();t.batchedUpdate(function(){for(const n of i){const o=n.datum;if(o?.point==null)continue;const{x:a,y:r}=o.point;!Number.isFinite(a)||!Number.isFinite(r)||n.resetAnimationProperties(a,r,n.size,1,1,1)}t.cleanup()})}}function pf(e,t){return{x:t.point?.x??Number.NaN,y:t.point?.y??Number.NaN,scalingCenterX:t.point?.x??Number.NaN,scalingCenterY:t.point?.y??Number.NaN}}function Gx(e,{datumIndex:t}){const i=e.getNodeData();if(i===void 0)return;const s=i[t],{point:n}=s??{};if(s==null||n==null)return;const o=e.getFormattedMarkerStyle(s),a=ki.anchor(o.shape),r=n.focusSize??o.size,l=4+r,c=l/2,h=(a.x-.5)*r,d=(a.y-.5)*r,u=s.point.x-c-h,p=s.point.y-c-d;return Kt.toCanvas(e.contentGroup,new re(u,p,l,l))}function oI(e,t,i,s=i){if(!(s.enabled??i.enabled))return!1;const o=1;return(t.step??da(t.range)/Math.max(1,e))>o}function Hx(e,t,i,s){return s??(s={stroke:t.stroke,strokeOpacity:t.strokeOpacity,strokeWidth:t.strokeWidth}),UM.reduce((n,o)=>(n[o]=e.getMarkerStyle(i,{},void 0,{highlightState:o},void 0,s),n),{})}function aI({id:e,visible:t,nodeDataDependencies:i},s,...n){const{seriesRectWidth:o,seriesRectHeight:a}=i;Nl(e,"path_properties",s,n,{clipX:0},{clipX:o},{phase:"initial",start:{clip:!0,clipY:a,visible:t},finish:{clip:!1,visible:t}})}function jx({id:e},t,i,s="add",...n){Nl(e,t,i,n,{opacity:0},{opacity:1},{phase:s})}function rI(e){return t=>({visible:e.getVisible(),opacity:e.getOpacity(),clipScalingX:1,clip:!1})}function Wx({nodeDataDependencies:e},t){const i=s=>Number.isFinite(s)?s:0;t.clipX=i(e.seriesRectWidth),t.clipY=i(e.seriesRectHeight)}var u2={angle:["angleKey"],radius:["radiusKey"]},p2={angle:["angleName"],radius:["radiusName"]},lI=class extends WD{constructor({categoryKey:e,pickModes:t=[1,0],canHaveAxes:i=!1,animationResetFns:s,...n}){super({...n,categoryKey:e,pickModes:t,canHaveAxes:i}),this.directions=["angle","radius"],this.itemGroup=this.contentGroup.appendChild(new Oe({name:"items"})),this.nodeData=[],this.itemSelection=ci.select(this.itemGroup,()=>this.nodeFactory(),!1),this.labelSelection=ci.select(this.labelGroup,()=>this.labelFactory(),!1),this.highlightSelection=ci.select(this.highlightNodeGroup,()=>this.nodeFactory()),this.highlightLabelSelection=ci.select(this.highlightLabelGroup,()=>this.labelFactory()),this.centerX=0,this.centerY=0,this.radius=0,this.maxChartMarkerSize=0,this.animationResetFns=s,this.animationState=new he("empty",{empty:{update:{target:"ready",action:o=>this.animateEmptyUpdateReady(o)},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",highlight:o=>this.animateReadyHighlight(o),highlightMarkers:o=>this.animateReadyHighlightMarkers(o),resize:o=>this.animateReadyResize(o),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:o=>this.animateWaitingUpdateReady(o)},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:o=>this.animateClearingUpdateEmpty(o)},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable()),this.cleanup.register(this.ctx.eventsHub.on("legend:item-click",o=>this.onLegendItemClick(o)),this.ctx.eventsHub.on("legend:item-double-click",o=>this.onLegendItemDoubleClick(o)))}getItemNodes(){return[...this.itemGroup.children()]}getNodeData(){return this.nodeData}getKeyAxis(e){if(e==="angle")return this.properties.angleKeyAxis;if(e==="radius")return this.properties.radiusKeyAxis}setZIndex(e){super.setZIndex(e),this.contentGroup.zIndex=[e,1],this.highlightGroup.zIndex=[e,2],this.labelGroup.zIndex=[e,3]}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"&&this.animationState.transition("skip")}labelFactory(){const e=new rn;return e.pointerEvents=1,e}getInnerRadius(){return 0}computeLabelsBBox(e,t){return null}getShapeFillBBox(){const e=this.radius;return{series:new re(-e,-e,e*2,e*2),axis:new re(-e,-e,e*2,e*2)}}resetAllAnimation(){const{item:e,label:t}=this.animationResetFns??{};this.ctx.animationManager.stopByAnimationGroupId(this.id),e&&Ui([this.itemSelection,this.highlightSelection],e),t&&Ui([this.labelSelection,this.highlightLabelSelection],t),this.itemSelection.cleanup(),this.labelSelection.cleanup(),this.highlightSelection.cleanup(),this.highlightLabelSelection.cleanup()}animateEmptyUpdateReady(e){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation()}animateWaitingUpdateReady(e){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation()}animateReadyHighlight(e){const{item:t,label:i}=this.animationResetFns??{};t&&Ui([this.highlightSelection],t),i&&Ui([this.highlightLabelSelection],i)}animateReadyHighlightMarkers(e){}animateReadyResize(e){this.resetAllAnimation()}animateClearingUpdateEmpty(e){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation()}computeFocusBounds(e){const t=this.getNodeData()?.[e.datumIndex];if(t!==void 0)return this.itemSelection.select(i=>i instanceof Fi&&i.datum===t)[0]}getSeriesRange(){return[Number.NaN,Number.NaN]}isSeriesHighlighted(e,t){const{series:i,legendItemName:s,itemId:n}=e??{},o=typeof n=="number"?t?.[n]:void 0;return i===this||o!=null&&o===s}},g2=(e=>(e[e.None=0]="None",e[e.Item=1]="Item",e[e.OtherItem=2]="OtherItem",e[e.Branch=3]="Branch",e[e.OtherBranch=4]="OtherBranch",e))(g2||{});function $x(e){const t=i=>i;switch(e){case 1:return"highlighted-item";case 2:return"unhighlighted-item";case 3:return"highlighted-branch";case 4:return"unhighlighted-branch";case 0:return"none";default:return t(e)}}var $l=class extends Go{constructor(){super(...arguments),this.childrenKey="children",this.fills=Object.values(hi),this.strokes=Object.values(kr)}};g([m],$l.prototype,"childrenKey",2),g([m],$l.prototype,"sizeKey",2),g([m],$l.prototype,"colorKey",2),g([m],$l.prototype,"colorName",2),g([m],$l.prototype,"fills",2),g([m],$l.prototype,"strokes",2),g([m],$l.prototype,"colorRange",2);var f2=class tS{constructor(t,i,s,n,o,a,r,l,c,h){this.series=t,this.datumIndex=i,this.datum=s,this.sizeValue=n,this.colorValue=o,this.sumSize=a,this.depth=r,this.parent=l,this.children=c,this.style=h,this.midPoint={x:0,y:0}}get hasChildren(){return this.children.length>0}walk(t,i=tS.Walk.PreOrder){i===tS.Walk.PreOrder&&t(this);for(const s of this.children)s.walk(t,i);i===tS.Walk.PostOrder&&t(this)}*[Symbol.iterator](){yield this;for(const t of this.children)yield*t}};f2.Walk={PreOrder:0,PostOrder:1};var UK=f2,KK=class extends Hg{constructor(e){super({moduleCtx:e,pickModes:[1,0]}),this.colorDomain=[0,0],this.maxDepth=0,this.colorScale=new Xd,this.animationState=new he("empty",{empty:{update:{target:"ready",action:t=>this.animateEmptyUpdateReady(t)},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",highlight:t=>this.animateReadyHighlight(t),resize:t=>this.animateReadyResize(t),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:t=>this.animateWaitingUpdateReady(t)},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:t=>this.animateClearingUpdateEmpty(t)},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"&&this.animationState.transition("skip")}processData(){const{NodeClass:e}=this,{childrenKey:t,sizeKey:i,colorKey:s,colorRange:n}=this.properties;let o=0,a=1/0,r=-1/0;const l=(u,p,f)=>{const y=f.depth==null?0:f.depth+1,b=t==null?void 0:u[t],x=b==null||b.length===0;let v=i==null?void 0:u[i];Number.isFinite(v)?v=Math.max(v,0):v=x?1:0;const S=v;o=Math.max(o,y);const M=s==null?void 0:u[s];typeof M=="number"&&(a=Math.min(a,M),r=Math.max(r,M));const D=this.getItemStyle({datumIndex:p,datum:u,depth:y,colorValue:M},x,!1);return c(new e(this,p,u,v,M,S,y,f,[],D),b)},c=(u,p)=>{const{datumIndex:f}=u;if(p)for(const[y,b]of p.entries()){const x=l(b,f.concat(y),u);u.children.push(x),u.sumSize+=x.sumSize}return u},h=c(new e(this,[],void 0,0,void 0,0,void 0,void 0,[],{}),this.data?.data),d=[a,r];this.colorScale.domain=a<r?[a,r]:[0,1],this.colorScale.range=n??["black"],this.colorScale.update(),this.rootNode=h,this.maxDepth=o,this.colorDomain=d}update({seriesRect:e}){this.updateSelections(),this.updateNodes();const t=this.getAnimationData();this.checkResize(e)&&this.animationState.transition("resize",t),this.animationState.transition("update",t)}resetAllAnimation(e){this.ctx.animationManager.stopByAnimationGroupId(this.id)}animateEmptyUpdateReady(e){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(e)}animateWaitingUpdateReady(e){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(e)}animateReadyHighlight(e){}animateReadyResize(e){this.resetAllAnimation(e)}animateClearingUpdateEmpty(e){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(e)}getAnimationData(){return{}}isProcessedDataAnimatable(){return!0}checkProcessedDataAnimatable(){this.isProcessedDataAnimatable()||this.ctx.animationManager.skipCurrentBatch()}dataCount(){return Number.NaN}getSeriesDomain(){return{domain:[Number.NaN,Number.NaN]}}getSeriesRange(){return[Number.NaN,Number.NaN]}getLegendData(e){const{colorKey:t,colorRange:i}=this.properties,{id:s,ctx:{legendManager:n},visible:o}=this;return e==="gradient"&&t!=null&&i!=null?[{legendType:"gradient",enabled:o&&n.getItemEnabled({seriesId:s}),seriesId:s,series:this.getFormatterContext("color"),colorRange:i,colorDomain:this.colorDomain}]:[]}getDatumIdFromData(e){return e.datumIndex.join(":")}getDatumId(e){return this.getDatumIdFromData(e)}removeMeIndexPathForIndex(e){return this.datumSelection.at(e+1)?.datum.datumIndex??[]}removeMeIndexForIndexPath(e){for(const{index:t,datum:i}of this.datumSelection)if(vn(i.datumIndex,e))return t-1;return 0}pickFocus(e){if(!this.rootNode?.children.length)return;const t=ge(0,e.datumIndex-e.datumIndexDelta,this.datumSelection.length-1),{datumIndexDelta:i,otherIndexDelta:s}=e;let n=this.removeMeIndexPathForIndex(t);const o=n.reduce((l,c)=>l.children[c],this.rootNode);if(s>0&&o.hasChildren)n=[...n,0];else if(s<0&&n.length>1)n=n.slice(0,-1);else if(s===0&&i!==0){const l=o.parent.children.length-1;n=n.slice(),n[n.length-1]=ge(0,n.at(-1)+i,l)}const a=n.reduce((l,c)=>l.children[c],this.rootNode),r=this.computeFocusBounds(this.datumSelection.at(t+1));if(r!=null)return{datum:a,datumIndex:this.removeMeIndexForIndexPath(n),otherIndex:a.depth,bounds:r,clipFocusBox:!0}}getDatumAriaText(e,t){if(!(e instanceof this.NodeClass)){j.error(`datum is not HierarchyNode: ${JSON.stringify(e)}`);return}return this.ctx.localeManager.t("ariaAnnounceHierarchyDatum",{level:(e.depth??-1)+1,count:e.children.length,description:t})}getCategoryValue(e){}datumIndexForCategoryValue(e){}getActiveHighlightNode(){const e=this.ctx.highlightManager?.getActiveHighlight();if(!(e==null||e.series!==this))return e}getHierarchyHighlightState(e,t,i){if(e)return 1;if(t==null)return 0;const s=i.datumIndex?.[0],n=t.datumIndex?.[0];return s==null||n==null?0:s===n?3:4}getHierarchyHighlightStyles(e,t){switch(e){case 1:return oe(t.highlightedItem,t.highlightedBranch);case 3:return oe(t.unhighlightedItem,t.highlightedBranch);case 4:return t.unhighlightedBranch;default:return}}getHighlightStateString(e,t,i,s){if(i==null)return $x(0);const n=i.reduce((r,l)=>r?.children[l],this.rootNode),o=this.getActiveHighlightNode();if(n==null)return $x(0);const a=this.getHierarchyHighlightState(t??!1,o,n);return $x(a)}},Ux=Math.PI/180,cI=e=>e*Ux,hI=e=>-Math.log(Math.tan(Math.PI*.25+e*Ux*.5)),dI=e=>e/Ux,uI=e=>(Math.atan(Math.exp(-e))-Math.PI*.25)/(Ux*.5),YK=class dL extends _y{constructor(t,i){super(),this.domain=t,this.range=i,this.type="mercator",this.defaultTickCount=0,this.bounds=dL.bounds(t)}static bounds(t){const[[i,s],[n,o]]=t,a=cI(i),r=hI(s),l=cI(n),c=hI(o);return new re(Math.min(a,l),Math.min(r,c),Math.abs(l-a),Math.abs(c-r))}static fixedScale(){return new dL([[dI(0),uI(0)],[dI(1),uI(1)]],[[0,0],[1,1]])}toDomain(){}normalizeDomains(...t){let i=-1/0,s=1/0,n=-1/0,o=1/0;for(const a of t){const r=a.domain;for(const[l,c]of r)i=Math.min(l,i),s=Math.max(l,s),n=Math.min(c,n),o=Math.max(c,o)}return{domain:[[i,n],[s,o]],animatable:!0}}convert([t,i]){const[[s,n],[o,a]]=this.range,r=(o-s)/this.bounds.width,l=(a-n)/this.bounds.height;return[(cI(t)-this.bounds.x)*r+s,(hI(i)-this.bounds.y)*l+n]}invert([t,i]){const[[s,n],[o,a]]=this.range,r=(o-s)/this.bounds.width,l=(a-n)/this.bounds.height;return[dI((t-s)/r+this.bounds.x),uI((i-n)/l+this.bounds.y)]}getDomainMinMax(){return Gy(this.domain)}},ZK=class{constructor(e){this.minimumDelay=e?.minimumDelay??50,this.timeout=e?.timeout??100}schedule(e,t){this.cancel(),this.pending={computation:e,onComplete:t},this.minimumDelay>0?this.delayTimeoutId=setTimeout(()=>{this.delayTimeoutId=void 0,this.scheduleIdleCallback()},this.minimumDelay):this.scheduleIdleCallback()}demand(){if(this.pending)return this.cancelScheduled(),this.execute()}cancel(){this.cancelScheduled(),this.pending=void 0}isPending(){return this.pending!=null}scheduleIdleCallback(){const e=Ve(),t=Math.max(0,this.timeout-this.minimumDelay);typeof e.requestIdleCallback=="function"?this.idleCallbackId=e.requestIdleCallback(this.execute.bind(this),{timeout:t}):this.idleCallbackId=setTimeout(()=>this.execute(),t)}cancelScheduled(){if(this.delayTimeoutId!=null&&(clearTimeout(this.delayTimeoutId),this.delayTimeoutId=void 0),this.idleCallbackId==null)return;const e=Ve();typeof e.cancelIdleCallback=="function"?e.cancelIdleCallback(this.idleCallbackId):clearTimeout(this.idleCallbackId),this.idleCallbackId=void 0}execute(){const e=this.pending;if(!e)return;this.pending=void 0,this.delayTimeoutId=void 0,this.idleCallbackId=void 0;const t=e.computation();return e.onComplete(t),t}},Kx=class{constructor(){this.executor=new ZK}get filters(){return this._filters}aggregate(e){if(this.executor.cancel(),e.targetRange>1&&e.computePartial){const t=e.computePartial(this._filters);if(t){const{immediate:i,computeRemaining:s}=t;return s&&this.executor.schedule(s,n=>{this.mergeFilters(n)}),this._filters=i,i}}return this._filters=e.computeFull(this._filters),this._filters}ensureLevelForRange(e){if(!this._filters?.some(i=>i.maxRange>e)&&this.executor.isPending()){const i=this.executor.demand();i&&this.mergeFilters(i)}}getFilterForRange(e){return this._filters?.find(t=>t.maxRange>e)}cancel(){this.executor.cancel()}markStale(){if(this._filters)for(const e of this._filters)e.stale=!0;this.executor.cancel()}mergeFilters(e){if(!this._filters||e.length===0)return;const t=[...this._filters,...e];t.sort((i,s)=>i.maxRange-s.maxRange),this._filters=t}},pI=class extends oD{constructor(){super(...arguments),this.shape="polygon",this.innerRadiusRatio=0,this.defaultTickMinSpacing=20}update(){super.update(),this.tickLineGroup.visible=this.tick.enabled,this.tickLabelGroup.visible=this.label.enabled}layoutCrossLines(){const e=this.label.getSideFlag(),t=this.hasDefinedDomain()||this.hasVisibleSeries(),{rotation:i,parallelFlipRotation:s,regularFlipRotation:n}=this.calculateRotations();for(const o of this.crossLines)o.sideFlag=-e,o.direction=i===-Math.PI/2?"angle":"radius",o.parallelFlipRotation=s,o.regularFlipRotation=n,o.calculateLayout?.(t,this.reverse)}updatePosition(){super.updatePosition();const e=Math.floor(this.translation.x),t=Math.floor(this.translation.y);this.tickLineGroup.translationX=e,this.tickLineGroup.translationY=t,this.tickLabelGroup.translationX=e,this.tickLabelGroup.translationY=t,this.crossLineRangeGroup.translationX=e,this.crossLineRangeGroup.translationY=t,this.crossLineLineGroup.translationX=e,this.crossLineLineGroup.translationY=t,this.crossLineLabelGroup.translationX=e,this.crossLineLabelGroup.translationY=t,this.tickLabelGroupSelection.each(ux())}computeLabelsBBox(e,t){return null}computeRange(){}getAxisLinePoints(){}};g([m],pI.prototype,"shape",2),g([m],pI.prototype,"innerRadiusRatio",2);var m2=class extends nf{calculateGridLine({index:e,tickId:t,translation:i},s,n,o,a){const{gridLine:r,horizontal:l,interval:c,range:h}=this;if(c.placement!=="between")return super.calculateGridLine({index:e,tickId:t,translation:i},s,n,o,a);const d=a[s-1],u=d?i-(i-d.translation)/2:h[0],[p,f,y,b]=l?[u,Math.max(n,o),u,Math.min(n,o)]:[Math.min(n,o),u,Math.max(n,o),u],{style:x}=r,{stroke:v,strokeWidth:S=0,lineDash:M}=x[e%x.length]??{};return{tickId:t,offset:u,x1:p,y1:f,x2:y,y2:b,stroke:v,strokeWidth:S,lineDash:M}}calculateGridFills(e,t,i){return this.interval.placement!=="between"?super.calculateGridFills(e,t,i):e.map((s,n)=>this.calculateGridFill(s,n,s.index,t,i,e))}calculateGridFill({tickId:e,translation:t},i,s,n,o,a){const{gridLine:r,horizontal:l,interval:c,range:h}=this;if(c.placement!=="between")return super.calculateGridFill({tickId:e,translation:t},i,s,n,o,a);const d=a[i-1],u=a[i+1],p=d?t-(t-d.translation)/2:h[0],f=u?t+(u.translation-t)/2:h[1],[y,b,x,v]=l?[p,Math.max(n,o),f,Math.min(n,o)]:[Math.min(n,o),p,Math.max(n,o),f],{fill:S,fillOpacity:M}=r.style[s%r.style.length]??{};return{tickId:e,x1:y,y1:b,x2:x,y2:v,fill:S,fillOpacity:M}}calculateTickLine({isPrimary:e,tickId:t,translation:i},s,n,o){const{horizontal:a,interval:r,primaryTick:l,range:c,tick:h}=this;if(r.placement!=="between")return super.calculateTickLine({isPrimary:e,tickId:t,translation:i},s,n,o);const d=e&&l?.enabled?l:h,u=-n*this.getTickSize(d),p=o[s-1],f=p?i-(i-p.translation)/2:c[0],[y,b,x,v]=a?[f,0,f,u]:[0,f,u,f],{stroke:S,width:M}=d;return{tickId:t,offset:f,x1:y,y1:b,x2:x,y2:v,stroke:S,strokeWidth:M,lineDash:void 0}}},XK={top:{xTranslationDirection:0,yTranslationDirection:-1},bottom:{xTranslationDirection:0,yTranslationDirection:1},left:{xTranslationDirection:-1,yTranslationDirection:0},right:{xTranslationDirection:1,yTranslationDirection:0},"top-left":{xTranslationDirection:1,yTranslationDirection:-1},"top-right":{xTranslationDirection:-1,yTranslationDirection:-1},"bottom-left":{xTranslationDirection:1,yTranslationDirection:1},"bottom-right":{xTranslationDirection:-1,yTranslationDirection:1},inside:{xTranslationDirection:0,yTranslationDirection:0},"inside-left":{xTranslationDirection:1,yTranslationDirection:0},"inside-right":{xTranslationDirection:-1,yTranslationDirection:0},"inside-top":{xTranslationDirection:0,yTranslationDirection:1},"inside-bottom":{xTranslationDirection:0,yTranslationDirection:-1},"inside-top-left":{xTranslationDirection:1,yTranslationDirection:1},"inside-bottom-left":{xTranslationDirection:1,yTranslationDirection:-1},"inside-top-right":{xTranslationDirection:-1,yTranslationDirection:1},"inside-bottom-right":{xTranslationDirection:-1,yTranslationDirection:-1}},qK={top:{xTranslationDirection:1,yTranslationDirection:0},bottom:{xTranslationDirection:-1,yTranslationDirection:0},left:{xTranslationDirection:0,yTranslationDirection:-1},right:{xTranslationDirection:0,yTranslationDirection:1},"top-left":{xTranslationDirection:-1,yTranslationDirection:-1},"top-right":{xTranslationDirection:-1,yTranslationDirection:1},"bottom-left":{xTranslationDirection:1,yTranslationDirection:-1},"bottom-right":{xTranslationDirection:1,yTranslationDirection:1},inside:{xTranslationDirection:0,yTranslationDirection:0},"inside-left":{xTranslationDirection:0,yTranslationDirection:1},"inside-right":{xTranslationDirection:0,yTranslationDirection:-1},"inside-top":{xTranslationDirection:-1,yTranslationDirection:0},"inside-bottom":{xTranslationDirection:1,yTranslationDirection:0},"inside-top-left":{xTranslationDirection:-1,yTranslationDirection:1},"inside-bottom-left":{xTranslationDirection:1,yTranslationDirection:1},"inside-top-right":{xTranslationDirection:-1,yTranslationDirection:-1},"inside-bottom-right":{xTranslationDirection:1,yTranslationDirection:-1}};function QK({yDirection:e,padding:t=0,position:i="top",bbox:s}){const n=e?XK:qK,{xTranslationDirection:o,yTranslationDirection:a}=n[i],r=o*(t+s.width/2),l=a*(t+s.height/2);return{xTranslation:r,yTranslation:l}}function Yx(e,t,i,s,n){const o=(d,u,p,f)=>{i.animate({id:`${e}_${t}_${u.id}_${d}`,groupId:e,from:p?1:0,to:1,ease:xr,collapsable:p,onUpdate(y,b){b&&d!=="removed"||(u.path.clear(!0),f(y,u),u.checkPathDirty())},onStop(){d==="added"&&(u.path.clear(!0),f(1,u),u.checkPathDirty())},phase:Ho[d]})},a=new Fi,r=d=>(a.resetPathDirty(),d(0,a),a.resetPathDirty(),d(1,a),a.checkPathDirty(),a.isPathDirty()),{addPhaseFn:l,updatePhaseFn:c,removePhaseFn:h}=n;for(const d of s)i.isSkipped()||(o("removed",d,!r(h),h),o("updated",d,!r(c),c)),o("added",d,!r(l),l)}var Ta=class extends Ry{constructor(){super(...arguments),this.enabled=!0,this.color="rgba(0, 0, 0, 0.5)",this.xOffset=0,this.yOffset=0,this.blur=5}};g([m,U()],Ta.prototype,"enabled",2),g([m,U()],Ta.prototype,"color",2),g([m,U()],Ta.prototype,"xOffset",2),g([m,U()],Ta.prototype,"yOffset",2),g([m,U()],Ta.prototype,"blur",2);function y2({startAngle:e,endAngle:t,innerRadius:i,outerRadius:s}){let n=1/0,o=1/0,a=-1/0,r=-1/0;const l=(c,h)=>{n=Math.min(c,n),o=Math.min(h,o),a=Math.max(c,a),r=Math.max(h,r)};return l(i*Math.cos(e),i*Math.sin(e)),l(i*Math.cos(t),i*Math.sin(t)),l(s*Math.cos(e),s*Math.sin(e)),l(s*Math.cos(t),s*Math.sin(t)),Us(0,e,t)&&l(s,0),Us(Math.PI*.5,e,t)&&l(0,s),Us(Math.PI,e,t)&&l(-s,0),Us(Math.PI*1.5,e,t)&&l(0,-s),new re(n,o,a-n,r-o)}function gI(e,t,i){const s=Math.sqrt(Math.pow(e,2)+Math.pow(t,2)),{innerRadius:n,outerRadius:o}=i;if(i.startAngle===i.endAngle||s<Math.min(n,o)||s>Math.max(n,o))return!1;const a=ag(i.startAngle),r=ag(i.endAngle),l=Math.atan2(t,e);return a<r?l<=r&&l>=a:l<=r&&l>=-Math.PI||l>=a&&l<=Math.PI}function JK(e,t,i,s,n,o,a,r,l,c){if(Number.isNaN(e)||Number.isNaN(t))return 0;o&&([n,s]=[s,n]);const h=(c-r)/(l-a),d=r-h*a,u=Math.pow(h,2)+1,p=2*(h*(d-t)-e),f=Math.pow(e,2)+Math.pow(d-t,2)-Math.pow(i,2),y=Math.pow(p,2)-4*u*f;if(y<0)return 0;const b=(-p+Math.sqrt(y))/2/u,x=(-p-Math.sqrt(y))/2/u;let v=0;for(const S of[b,x]){if(!(S>=Math.min(a,l)&&S<=Math.max(a,l)))continue;const D=h*S+d,k=S-e,I=D-t,A=Math.atan2(I,k);Us(A,s,n)&&v++}return v}function x2(e,t){const{startAngle:i,endAngle:s,innerRadius:n,outerRadius:o}=t,a={x:o*Math.cos(i),y:o*Math.sin(i)},r={x:o*Math.cos(s),y:o*Math.sin(s)},l=n===0?{x:0,y:0}:{x:n*Math.cos(i),y:n*Math.sin(i)},c=n===0?{x:0,y:0}:{x:n*Math.cos(s),y:n*Math.sin(s)};return Ag(e.start.x,e.start.y,e.end.x,e.end.y,a.x,a.y,l.x,l.y)||Ag(e.start.x,e.start.y,e.end.x,e.end.y,r.x,r.y,c.x,c.y)||JK(0,0,o,i,s,!0,e.start.x,e.start.y,e.end.x,e.end.y)}function e3(e,t){const i={x:e.x,y:e.y},s={x:e.x+e.width,y:e.y},n={x:e.x,y:e.y+e.height},o={x:e.x+e.width,y:e.y+e.height};return x2({start:i,end:s},t)||x2({start:n,end:o},t)}function b2(e,t,i,s){if(i===0&&s===0)return 0;if(Math.asin(Math.abs(1*i)/(e+1*i))+Math.asin(Math.abs(1*s)/(e+1*s))-t<0)return 1;let o=0,a=1;for(let r=0;r<8;r+=1){const l=(o+a)/2;Math.asin(Math.abs(l*i)/(e+l*i))+Math.asin(Math.abs(l*s)/(e+l*s))-t<0?o=l:a=l}return o}var t3=1e-6;function Ul(e,t){return Eo(e,t)<t3?t:tt(e-t)+t}function Zx(e,t,i=0){const n=Math.abs(t-e)>=2*Math.PI?2*Math.PI:tt(t-e);return e=Ul(e,i),t=e+n,{startAngle:e,endAngle:t}}function Xx(e,t,i,s,n,o){const a=Math.sin(o),r=Math.cos(o),l=e**2+t**2-i**2;let c,h,d,u;if(r>.5){const S=a/r,M=1+S**2,D=-2*(e+t*S),k=D**2-4*M*l;if(k<0)return;const I=(-D+Math.sqrt(k))/(2*M),A=(-D-Math.sqrt(k))/(2*M);c=I,h=I*S,d=A,u=A*S}else{const S=r/a,M=1+S**2,D=-2*(t+e*S),k=D**2-4*M*l;if(k<0)return;const I=(-D+Math.sqrt(k))/(2*M),A=(-D-Math.sqrt(k))/(2*M);c=I*S,h=I,d=A*S,u=A}const p=r,f=a,y=c*p+h*f,b=d*p+u*f,x=y>0?Ul(Math.atan2(h-t,c-e),s):Number.NaN,v=b>0?Ul(Math.atan2(u-t,d-e),s):Number.NaN;if(x>=s&&x<=n)return x;if(v>=s&&v<=n)return v}function qx(e,t,i,s,n,o){const a=Math.hypot(e,t),r=(a**2-i**2+o**2)/(2*a),l=a-r,c=Math.atan2(t,e),h=Math.acos(-l/i),d=Ul(c+h,s),u=Ul(c-h,s);if(d>=s&&d<=n)return d;if(u>=s&&u<=n)return u}var v2=class extends Fi{constructor(e=""){super(),this._d="",this.d=e}get d(){return this._d}set d(e){e!==this._d&&(this._d=e,this.path.clear(),this.path.appendSvg(e),this.checkPathDirty())}},i3=class extends Jd(v2){isPointInPath(e,t){return super.isPointInPath(e-this.translationX,t-this.translationY)}},s3=class JB extends El{static is(t){return t instanceof JB}setSourceScale(t){this._sourceScale=t;const i=n=>{Object.defineProperty(this,n,{get:()=>t[n],set:o=>{t[n]=o},configurable:!0})};i("domain"),i("range"),i("paddingInner"),i("paddingOuter"),i("round");const s=n=>{Object.defineProperty(this,n,{get:()=>t[n],configurable:!0})};s("bandwidth"),s("step"),s("inset"),s("rawBandwidth")}get bands(){return this._sourceScale?.bands??super.bands}refresh(){this._sourceScale?.refresh?.()}ordinalRange(t){return this._sourceScale?this._sourceScale.ordinalRange(t):super.ordinalRange(t)}convert(t,i){this.refresh();const s=this.findIndex(t,i?.alignment);return s==null||s<0||s>=this.bands.length?Number.NaN:this.ordinalRange(s)}findIndex(t,i=0){if(t==null)return;const{bands:s,reversed:n}=this,o=s.length;if(o===0)return;if(o===1)return 0;const a=s[0],r=s[o-1];if(a==null||r==null)return this._sourceScale?.findIndex(t,i);const l=t.valueOf(),c=a.valueOf(),h=r.valueOf(),d=(l-c)/(h-c),u=n?(1-d)*(o-1):d*(o-1);return i===0?Math.max(0,Math.min(o-1,Math.floor(u))):Math.max(0,Math.min(o-1,Math.ceil(u)))}},S2=class uL{constructor(t,i,s,n){this.startAngle=t,this.endAngle=i,this.innerRadius=s,this.outerRadius=n}clone(){const{startAngle:t,endAngle:i,innerRadius:s,outerRadius:n}=this;return new uL(t,i,s,n)}equals(t){return this.startAngle===t.startAngle&&this.endAngle===t.endAngle&&this.innerRadius===t.innerRadius&&this.outerRadius===t.outerRadius}[zy](t,i){return new uL(this.startAngle*(1-i)+t.startAngle*i,this.endAngle*(1-i)+t.endAngle*i,this.innerRadius*(1-i)+t.innerRadius*i,this.outerRadius*(1-i)+t.outerRadius*i)}},_u=class extends vr{constructor(e){super(),this.sourceImage=e,this.x=0,this.y=0,this.width=0,this.height=0,this.opacity=1}render(e){const{ctx:t}=e,i=this.sourceImage;i&&(t.globalAlpha=this.opacity,t.drawImage(i,0,0,i.width,i.height,this.x,this.y,this.width,this.height)),super.render(e)}};g([U()],_u.prototype,"x",2),g([U()],_u.prototype,"y",2),g([U()],_u.prototype,"width",2),g([U()],_u.prototype,"height",2),g([U()],_u.prototype,"opacity",2);var Na=class extends Fi{constructor(){super(...arguments),this.centerX=0,this.centerY=0,this.radius=10,this.startAngle=0,this.endAngle=Math.PI*2,this.counterClockwise=!1,this.type=0}get fullPie(){return qe(tt(this.startAngle),tt(this.endAngle))}updatePath(){const e=this.path;e.clear(),e.arc(this.centerX,this.centerY,this.radius,this.startAngle,this.endAngle,this.counterClockwise),this.type===1?e.closePath():this.type===2&&!this.fullPie&&(e.lineTo(this.centerX,this.centerY),e.closePath())}computeBBox(){return new re(this.centerX-this.radius,this.centerY-this.radius,this.radius*2,this.radius*2)}isPointInPath(e,t){const i=this.getBBox();return this.type!==0&&i.containsPoint(e,t)&&this.path.isPointInPath(e,t)}};Na.className="Arc",g([U()],Na.prototype,"centerX",2),g([U()],Na.prototype,"centerY",2),g([U()],Na.prototype,"radius",2),g([U()],Na.prototype,"startAngle",2),g([U()],Na.prototype,"endAngle",2),g([U()],Na.prototype,"counterClockwise",2),g([U()],Na.prototype,"type",2);function Qx(e,t,i){const s=Math.hypot(e,t),o=Math.atan2(t,e)+i;return{x:Math.cos(o)*s,y:Math.sin(o)*s}}var Xo=class extends Fi{constructor(){super(...arguments),this.isBeveled=!0,this.columnWidth=0,this.startAngle=0,this.endAngle=0,this.outerRadius=0,this.innerRadius=0,this.axisInnerRadius=0,this.axisOuterRadius=0}set cornerRadius(e){}computeBBox(){const{columnWidth:e}=this,[t,i]=this.normalizeRadii(this.innerRadius,this.outerRadius),s=this.getRotation(),n=-e/2,o=e/2,a=-i,r=-t;let l=1/0,c=1/0,h=-1/0,d=-1/0;for(let u=0;u<4;u+=1){const{x:p,y:f}=Qx(u%2===0?n:o,u<2?a:r,s);l=Math.min(p,l),c=Math.min(f,c),h=Math.max(p,h),d=Math.max(f,d)}return new re(l,c,h-l,d-c)}getRotation(){const{startAngle:e,endAngle:t}=this,i=Eo(e,t);return tt(e+i/2+Math.PI/2)}normalizeRadii(e,t){return e>t?[t,e]:[e,t]}updatePath(){const{isBeveled:e}=this;e?this.updateBeveledPath():this.updateRectangularPath(),this.checkPathDirty()}updateRectangularPath(){const{columnWidth:e,path:t}=this,[i,s]=this.normalizeRadii(this.innerRadius,this.outerRadius),n=-e/2,o=e/2,a=-s,r=-i,l=this.getRotation(),c=[[n,r],[n,a],[o,a],[o,r]].map(([h,d])=>Qx(h,d,l));t.clear(!0),t.moveTo(c[0].x,c[0].y),t.lineTo(c[1].x,c[1].y),t.lineTo(c[2].x,c[2].y),t.lineTo(c[3].x,c[3].y),t.closePath()}calculateCircleIntersection(e,t){const i=e*e;if(t<i)return null;const s=-Math.sqrt(t-i),n=Math.atan2(s,e);return{y:s,angle:n}}calculateBothIntersections(e,t,i){const s=i*i,n=this.calculateCircleIntersection(e,s),o=this.calculateCircleIntersection(t,s);return!n||!o?null:{left:n,right:o}}calculateAxisOuterIntersections(e,t,i){const s=i*i,n=this.calculateCircleIntersection(e,s),o=this.calculateCircleIntersection(t,s);return!n||!o?null:{left:n,right:o,radiusSquared:s}}moveToRotated(e,t,i){const s=Qx(e,t,i);this.path.moveTo(s.x,s.y)}lineToRotated(e,t,i){const s=Qx(e,t,i);this.path.lineTo(s.x,s.y)}renderTopWithCornerClipping(e,t,i){const{path:s}=this,{right:n,top:o,rotation:a}=i,r=o*o,l=t.radiusSquared-r;if(l<=0)this.lineToRotated(n,t.right.y,a),s.arc(0,0,e,a+t.right.angle,a+t.left.angle,!0);else{const c=Math.sqrt(l),h=Math.atan2(o,c),d=Math.atan2(o,-c);this.lineToRotated(n,t.right.y,a),s.arc(0,0,e,a+t.right.angle,a+h,!0),this.lineToRotated(-c,o,a),s.arc(0,0,e,a+d,a+t.left.angle,!0)}}updateBeveledPath(){const{columnWidth:e,path:t,axisInnerRadius:i,axisOuterRadius:s}=this,[n,o]=this.normalizeRadii(this.innerRadius,this.outerRadius),a=-e/2,r=e/2,l=-o,c=-n,h=this.getRotation(),d=qe(n,i),u=qe(o,s),p=Math.hypot(a,l)>s||Math.hypot(r,l)>s;if(!d&&!u&&!p){this.updateRectangularPath();return}const f=d?this.calculateBothIntersections(a,r,n):null,y=u?this.calculateBothIntersections(a,r,o):null,b=p?this.calculateAxisOuterIntersections(a,r,s):null;if(d&&!f||u&&!y||p&&!b){this.updateRectangularPath();return}t.clear(!0);const x={left:a,right:r,top:l,bottom:c,rotation:h};f?this.moveToRotated(a,f.left.y,h):this.moveToRotated(a,c,h),f?t.arc(0,0,n,h+f.left.angle,h+f.right.angle,!1):this.lineToRotated(r,c,h),y?(this.lineToRotated(r,y.right.y,h),t.arc(0,0,o,h+y.right.angle,h+y.left.angle,!0)):b?this.renderTopWithCornerClipping(s,b,x):(this.lineToRotated(r,l,h),this.lineToRotated(a,l,h)),t.closePath()}};Xo.className="RadialColumnShape",g([U()],Xo.prototype,"isBeveled",2),g([U()],Xo.prototype,"columnWidth",2),g([U()],Xo.prototype,"startAngle",2),g([U()],Xo.prototype,"endAngle",2),g([U()],Xo.prototype,"outerRadius",2),g([U()],Xo.prototype,"innerRadius",2),g([U()],Xo.prototype,"axisInnerRadius",2),g([U()],Xo.prototype,"axisOuterRadius",2);function M2(e,t,i,s,n){const o=Eo(e,t),a=o*(1-s)/2;if(e+=a,t-=a,o<.001)return 2*i*n;if(o>=2*Math.PI){const p=e+o/2;e=p-Math.PI,t=p+Math.PI}const r=i*Math.cos(e),l=i*Math.sin(e),c=i*Math.cos(t),h=i*Math.sin(t),d=Math.floor(Math.hypot(r-c,l-h)),u=2*i*n;return Math.max(1,Math.min(u,d))}var fI=class{constructor(e,t,i,s,n){this.cx=e,this.cy=t,this.r=i,this.a0=s,this.a1=n,this.a0>=this.a1&&(this.a0=Number.NaN,this.a1=Number.NaN)}isValid(){return Number.isFinite(this.a0)&&Number.isFinite(this.a1)}pointAt(e){return{x:this.cx+this.r*Math.cos(e),y:this.cy+this.r*Math.sin(e)}}clipStart(e){e==null||!this.isValid()||e<this.a0||(this.a0=e,(Number.isNaN(e)||this.a0>=this.a1)&&(this.a0=Number.NaN,this.a1=Number.NaN))}clipEnd(e){e==null||!this.isValid()||e>this.a1||(this.a1=e,(Number.isNaN(e)||this.a0>=this.a1)&&(this.a0=Number.NaN,this.a1=Number.NaN))}},ms=class extends Fi{constructor(){super(...arguments),this.centerX=0,this.centerY=0,this.innerRadius=10,this.outerRadius=20,this.startAngle=0,this.endAngle=Math.PI*2,this.clipSector=void 0,this.concentricEdgeInset=0,this.radialEdgeInset=0,this.startOuterCornerRadius=0,this.endOuterCornerRadius=0,this.startInnerCornerRadius=0,this.endInnerCornerRadius=0}set inset(e){this.concentricEdgeInset=e,this.radialEdgeInset=e}set cornerRadius(e){this.startOuterCornerRadius=e,this.endOuterCornerRadius=e,this.startInnerCornerRadius=e,this.endInnerCornerRadius=e}computeBBox(){return y2(this).translate(this.centerX,this.centerY)}normalizedRadii(){const{concentricEdgeInset:e}=this;let{innerRadius:t,outerRadius:i}=this;return t=t>0?t+e:0,i=Math.max(i-e,0),{innerRadius:t,outerRadius:i}}normalizedClipSector(){const{clipSector:e}=this;if(e==null)return;const{startAngle:t,endAngle:i}=Zx(this.startAngle,this.endAngle),{innerRadius:s,outerRadius:n}=this.normalizedRadii(),o=Zx(e.startAngle,e.endAngle,t);return new S2(Math.max(t,o.startAngle),Math.min(i,o.endAngle),Math.max(s,e.innerRadius),Math.min(n,e.outerRadius))}getAngleOffset(e){return e>0?this.radialEdgeInset/e:0}arc(e,t,i,s,n,o,a,r){if(e<=0)return;const{startAngle:l,endAngle:c}=Zx(this.startAngle,this.endAngle),{innerRadius:h,outerRadius:d}=this.normalizedRadii(),u=this.normalizedClipSector();if(r&&h<=0)return;const p=r?this.getAngleOffset(h+e):this.getAngleOffset(d-e),f=a?l+p+t:c-p-t,y=r?h+e:d-e,b=y*Math.cos(f),x=y*Math.sin(f);if(u!=null&&(!a&&!(f>=l-1e-6&&f<=u.endAngle-1e-6)||a&&!(f>=u.startAngle+1e-6&&f<=c-1e-6)||r&&y<u.innerRadius-1e-6||!r&&y>u.outerRadius+1e-6))return;const v=new fI(b,x,e,i,s);if(u!=null){r?(v.clipStart(Xx(b,x,e,i,s,u.endAngle)),v.clipEnd(Xx(b,x,e,i,s,u.startAngle))):(v.clipStart(Xx(b,x,e,i,s,u.startAngle)),v.clipEnd(Xx(b,x,e,i,s,u.endAngle)));let I,A;if(a?(I=qx(b,x,e,i,s,u.innerRadius),A=qx(b,x,e,i,s,u.outerRadius)):(I=qx(b,x,e,i,s,u.outerRadius),A=qx(b,x,e,i,s,u.innerRadius)),v.clipStart(I),v.clipEnd(A),I!=null){const{x:C,y:w}=v.pointAt(I),T=Ul(Math.atan2(w,C),l);a?o?.clipStart(T):n.clipEnd(T)}if(A!=null){const{x:C,y:w}=v.pointAt(A),T=Ul(Math.atan2(w,C),l);a?n.clipStart(T):o?.clipEnd(T)}}if(u!=null){const{x:I,y:A}=v.pointAt((v.a0+v.a1)/2);if(!gI(I,A,u))return}const{x:S,y:M}=v.pointAt(a===r?v.a0:v.a1),D=Ul(Math.atan2(M,S),l),k=r?o:n;return a?k?.clipStart(D):k?.clipEnd(D),v}updatePath(){const{path:t,centerX:i,centerY:s,concentricEdgeInset:n,radialEdgeInset:o}=this;let{startOuterCornerRadius:a,endOuterCornerRadius:r,startInnerCornerRadius:l,endInnerCornerRadius:c}=this;const{startAngle:h,endAngle:d}=Zx(this.startAngle,this.endAngle),{innerRadius:u,outerRadius:p}=this.normalizedRadii(),f=this.normalizedClipSector(),y=d-h,b=y>=2*Math.PI-1e-6;t.clear();const x=this.getAngleOffset(u),v=y-2*x,S=p-u,M=u>0&&v>0?2*u*Math.sin(v/2):0,D=p>0&&v>0?2*p*Math.sin(v/2):0;if(a=Math.floor(Math.max(0,Math.min(a,D/2,S/2))),r=Math.floor(Math.max(0,Math.min(r,D/2,S/2))),l=Math.floor(Math.max(0,Math.min(l,M/2,S/2))),c=Math.floor(Math.max(0,Math.min(c,M/2,S/2))),u===0&&p===0||u>p||M<0||D<=0)return;if((f?.startAngle??h)===(f?.endAngle??d))return;if(b&&this.clipSector==null&&a===0&&r===0&&l===0&&c===0){t.moveTo(i+p*Math.cos(h),s+p*Math.sin(h)),t.arc(i,s,p,h,d),u>n&&(t.moveTo(i+u*Math.cos(d),s+u*Math.sin(d)),t.arc(i,s,u,d,h,!0)),t.closePath();return}else if(this.clipSector==null&&Math.abs(u-p)<1e-6){t.arc(i,s,p,h,d,!1),t.arc(i,s,p,d,h,!0),t.closePath();return}const I=this.getAngleOffset(p);if(y<2*I)return;const C=(f?.innerRadius??u)>n,w=u<n||y<2*x,T=Math.max(a,l,r,c),O=T>0?Math.min(S/T,1):1;a*=O,r*=O,l*=O,c*=O;const E=b2(p,y-2*I,-a,-r);if(a*=E,r*=E,!w&&C){const de=b2(u,y-2*x,l,c);l*=de,c*=de}else l=0,c=0;const z=Math.max(a+l,r+c),F=z>0?Math.min(S/z,1):1;a*=F,r*=F,l*=F,c*=F;let _=0,G=0;const B=a/(p-a),V=r/(p-r);if(B>=0&&B<1-1e-6)_=Math.asin(B);else{_=y/2;const de=p/(1/Math.sin(_)+1);a=Math.min(de,a)}if(V>=0&&V<1-1e-6)G=Math.asin(V);else{G=y/2;const de=p/(1/Math.sin(G)+1);r=Math.min(de,r)}const Y=Math.asin(l/(u+l)),X=Math.asin(c/(u+c)),q=f?.outerRadius??p,te=this.getAngleOffset(q),pe=new fI(0,0,q,h+te,d-te),Se=f?.innerRadius??u,ve=this.getAngleOffset(Se),ae=C?new fI(0,0,Se,h+ve,d-ve):void 0;f!=null&&(pe.clipStart(f.startAngle),pe.clipEnd(f.endAngle),ae?.clipStart(f.startAngle),ae?.clipEnd(f.endAngle));const Ie=this.arc(a,_,h-Math.PI*.5,h+_,pe,ae,!0,!1),ze=this.arc(r,G,d-G,d+Math.PI*.5,pe,ae,!1,!1),Xe=this.arc(c,X,d+Math.PI*.5,d+Math.PI-X,pe,ae,!1,!0),Te=this.arc(l,Y,h+Math.PI+Y,h+Math.PI*1.5,pe,ae,!0,!0);if(!(w&&C)){if(w){const de=y<Math.PI*.5?o*(1+Math.cos(y))/Math.sin(y):Number.NaN;let De;de>0&&de<p?De=Math.max(Math.hypot(o,de),u):De=o,De=Math.max(De,u);const ye=h+y*.5;t.moveTo(i+De*Math.cos(ye),s+De*Math.sin(ye))}else if(!(Te?.isValid()===!0||ae?.isValid()===!0)){const de=h+y/2,De=u*Math.cos(de),ye=u*Math.sin(de);t.moveTo(i+De,s+ye)}}if(Ie?.isValid()===!0){const{cx:de,cy:De,r:ye,a0:Ee,a1:Ne}=Ie;t.arc(i+de,s+De,ye,Ee,Ne)}if(pe.isValid()){const{r:de,a0:De,a1:ye}=pe;t.arc(i,s,de,De,ye)}if(ze?.isValid()===!0){const{cx:de,cy:De,r:ye,a0:Ee,a1:Ne}=ze;t.arc(i+de,s+De,ye,Ee,Ne)}if(!w){if(Xe?.isValid()===!0){const{cx:de,cy:De,r:ye,a0:Ee,a1:Ne}=Xe;t.arc(i+de,s+De,ye,Ee,Ne)}if(ae?.isValid()===!0){const{r:de,a0:De,a1:ye}=ae;t.arc(i,s,de,ye,De,!0)}if(Te?.isValid()===!0){const{cx:de,cy:De,r:ye,a0:Ee,a1:Ne}=Te;t.arc(i+de,s+De,ye,Ee,Ne)}}t.closePath()}isPointInPath(e,t){const{startAngle:i,endAngle:s,innerRadius:n,outerRadius:o}=this.clipSector??this;return gI(e-this.centerX,t-this.centerY,{startAngle:i,endAngle:s,innerRadius:Math.min(n,o),outerRadius:Math.max(n,o)})}};ms.className="Sector",g([U()],ms.prototype,"centerX",2),g([U()],ms.prototype,"centerY",2),g([U()],ms.prototype,"innerRadius",2),g([U()],ms.prototype,"outerRadius",2),g([U()],ms.prototype,"startAngle",2),g([U()],ms.prototype,"endAngle",2),g([br({equals:(e,t)=>e.equals(t)})],ms.prototype,"clipSector",2),g([U()],ms.prototype,"concentricEdgeInset",2),g([U()],ms.prototype,"radialEdgeInset",2),g([U()],ms.prototype,"startOuterCornerRadius",2),g([U()],ms.prototype,"endOuterCornerRadius",2),g([U()],ms.prototype,"startInnerCornerRadius",2),g([U()],ms.prototype,"endInnerCornerRadius",2);var mI=class extends CM{constructor(){super(xe("div"),"menuitem")}},D2=class extends CM{constructor(){super(xe("div"),"menuitemradio")}setChecked(e){Fe(this.elem,"aria-checked",e)}},n3=["Escape","ArrowLeft"],I2=class e_ extends LM{constructor(t="vertical"){super(t,"menu"),this.handleMouseEnter=(i,s)=>{s.hasPopup()||this.expandSubMenu(i,void 0)},this.handleMouseMove=(i,s)=>{s.focus({preventScroll:!0})}}destructor(){this.collapse({mode:"2"})}addSeparator(){const t=Qn().createElement("div");return Fe(t,"role","separator"),this.elem.appendChild(t),t}onChildAdded(t){super.onChildAdded(t),t.addListener("mouseenter",this.handleMouseEnter),t.addListener("mousemove",this.handleMouseMove)}onChildRemoved(t){super.onChildRemoved(t),t.removeListener("mouseenter",this.handleMouseEnter),t.removeListener("mousemove",this.handleMouseMove)}addSubMenu(){const t=new mI,i=new e_(this.orientation);i.id=ur();const s=()=>{this.collapseExpandedSubMenu(i),t.expandControlled()},n=o=>{Td(o.sourceEvent)&&o.sourceEvent.code==="ArrowRight"&&(this.collapseExpandedSubMenu(i),t.expandControlled())};return t.setControlled(i),t.setAriaHasPopup("menu"),t.addListener("click",s),t.addListener("mouseenter",s),t.addListener("keydown",n),this.addChild(t),{subMenuButton:t,subMenu:i}}expandSubMenu(t,i){const{expansionScope:s}=this;s&&(this.collapseExpandedSubMenu(i),i?.expand(t))}collapseExpandedSubMenu(t){const{expansionScope:i}=this;i&&(i.expandedSubMenu?.collapse({mode:"4"}),i.expandedSubMenu=t)}expand(t){if(this.expansionScope!=null)return;this.expansionScope={lastFocus:gy(t.sourceEvent),expandedSubMenu:void 0,abort:()=>this.collapse({mode:"1"}),close:()=>this.collapse({mode:"0"}),removers:new pt};const i=this.expansionScope,s=this.children.map(n=>n.getElement());Fe(i.lastFocus,"aria-expanded",!0),i.removers.register(k0(this.elem,i.abort),A0(this.elem,i.abort),...this.children.map(n=>hy(n.getElement(),i.close,n3)),t?.overrideFocusVisible&&C0(this.elem,s,t.overrideFocusVisible)),this.internalListener?.dispatch("expand-widget",this,{type:"expand-widget"}),this.children[0]?.focus({preventScroll:!0})}collapse(t){const{mode:i="0"}=t??{};if(this.expansionScope===void 0)return;const{lastFocus:s,removers:n,expandedSubMenu:o}=this.expansionScope;this.expansionScope=void 0,o?.collapse({mode:"3"}),Fe(s,"aria-expanded",!1),i==="0"&&s?.focus({preventScroll:!0}),n.flush(),this.internalListener?.dispatch("collapse-widget",this,{type:"collapse-widget",mode:i})}},k2="canvas-overlay",A2=class extends bi{constructor(e,t,i){super(),this.ctx=e,this.hideFns=[],this.setOwnedWidget=(()=>{let s;return n=>{s?.destroy(),s=n}})(),this.moduleId=`popover-${t}`,i?.detached?this.element=xe("div"):this.element=e.domManager.addChild(k2,this.moduleId),this.element.setAttribute("role","presentation"),this.hideFns.push(()=>this.setOwnedWidget(void 0)),this.cleanup.register(()=>e.domManager.removeChild(k2,this.moduleId))}attachTo(e){this.element.parentElement||e.element.append(this.element)}hide(e){const{lastFocus:t=this.lastFocus}=e??{};if(this.element.children.length!==0){for(const i of this.hideFns)i();t?.focus(),this.lastFocus=void 0}}removeChildren(){this.element.replaceChildren()}initPopoverElement(e,t){if(!this.element.parentElement)throw new Error("Can not show popover that has not been attached to a parent.");return e??(e=xe("div","ag-charts-popover")),e.classList.toggle("ag-charts-popover",!0),t.ariaLabel!=null&&e.setAttribute("aria-label",t.ariaLabel),t.class!=null&&e.classList.add(t.class),this.element.replaceChildren(e),e}showWidget(e,t,i){this.setOwnedWidget(t),this.initPopoverElement(t.getElement(),i),t.addListener("collapse-widget",()=>{e.setControlled(void 0),this.setOwnedWidget(void 0)}),e.setControlled(t),e.expandControlled()}showWithChildren(e,t){const i=this.initPopoverElement(void 0,t);if(i.replaceChildren(...e),this.hideFns.push(()=>this.removeChildren()),t.onHide&&this.hideFns.push(t.onHide),t.initialFocus&&t.sourceEvent){const s=gy(t.sourceEvent);s!==void 0&&(this.lastFocus=s,this.initialFocus=t.initialFocus)}return i}getPopoverElement(){return this.element.firstElementChild}updatePosition(e){const t=this.getPopoverElement();t&&(t.style.setProperty("right","unset"),t.style.setProperty("bottom","unset"),e.x!=null&&t.style.setProperty("left",`${Math.floor(e.x)}px`),e.y!=null&&t.style.setProperty("top",`${Math.floor(e.y)}px`),this.initialFocus?.focus(),this.initialFocus=void 0)}},C2=class extends A2{setAnchor(e,t){this.anchor=e,this.fallbackAnchor=t,this.updatePosition(e),this.repositionWithinBounds()}updateAnchor(e){const t=e.anchor??this.anchor,i=e.fallbackAnchor??this.fallbackAnchor;t&&this.setAnchor(t,i)}showWidget(e,t,i){super.showWidget(e,t,i),this.updateAnchor(i)}showWithChildren(e,t){const i=super.showWithChildren(e,t);return this.updateAnchor(t),Ve().requestAnimationFrame(()=>{this.repositionWithinBounds()}),i}repositionWithinBounds(){const{anchor:e,ctx:t,fallbackAnchor:i}=this,s=this.getPopoverElement();if(!e||!s)return;const n=t.domManager.getBoundingClientRect(),{offsetWidth:o,offsetHeight:a}=s;let r=ge(0,e.x,n.width-o),l=ge(0,e.y,n.height-a);r!==e.x&&i?.x!=null&&(r=ge(0,i.x-o,n.width-o)),l!==e.y&&i?.y!=null&&(l=ge(0,i.y-a,n.height-a)),this.updatePosition({x:r,y:l})}},o3=class extends C2{show(e,t){const i=new I2("vertical");for(const s of t.items)i.addChild(this.createRow(t,s,i));i.addClass("ag-charts-menu"),this.showWidget(e,i,t)}allocRow(e,t){if(e.menuItemRole==null||e.menuItemRole==="menuitem")return new mI;{e.menuItemRole;const i=new D2;return i.setChecked(e.value===t.value),i}}createRow(e,t,i){const s=t.value===e.value,n=this.allocRow(e,t);if(n.addClass("ag-charts-menu__row"),n.toggleClass("ag-charts-menu__row--active",s),typeof t.value=="string"&&(n.getElement().dataset.popoverId=t.value),t.icon!=null){const a=xe("span",`ag-charts-menu__icon ${pl(t.icon)}`);n.getElement().appendChild(a)}const o=t.strokeWidth!=null;if(o&&(n.toggleClass("ag-charts-menu__row--stroke-width-visible",o),n.setCSSVariable("--strokeWidth",o?`${t.strokeWidth}px`:null)),t.label!=null){const a=xe("span","ag-charts-menu__label");a.textContent=this.ctx.localeManager.t(t.label),n.getElement().appendChild(a)}return"altText"in t&&n.setAriaLabel(this.ctx.localeManager.t(t.altText)),n.addListener("click",({sourceEvent:a})=>{e.onPress?.(t),a.preventDefault(),a.stopPropagation(),i.collapse()}),n}},L2=class extends A2{constructor(){super(...arguments),this.dragged=!1}setDragHandle(e){e.addListener("drag-start",t=>{e.addClass(this.dragHandleDraggingClass),this.onDragStart(t)}),e.addListener("drag-move",this.onDragMove.bind(this)),e.addListener("drag-end",()=>{e.removeClass(this.dragHandleDraggingClass),this.onDragEnd.bind(this)})}onDragStart(e){const t=this.getPopoverElement();t&&(e.sourceEvent.preventDefault(),this.dragged=!0,this.dragStartState={client:H.from(e.clientX,e.clientY),position:H.from(Number(t.style.getPropertyValue("left").replace("px","")),Number(t.style.getPropertyValue("top").replace("px","")))})}onDragMove(e){const{dragStartState:t}=this,i=this.getPopoverElement();if(!t||!i)return;const s=H.sub(H.from(e.clientX,e.clientY),t.client),n=H.add(t.position,s),o=this.ctx.domManager.getBoundingClientRect(),a={};n.x>=0&&n.x+i.offsetWidth<=o.width&&(a.x=n.x),n.y>=0&&n.y+i.offsetHeight<=o.height&&(a.y=n.y),this.updatePosition(a)}onDragEnd(){this.dragStartState=void 0}},a3={"disjoint-channel":"false","fibonacci-menu":"menu","fibonacci-retracement":"false","fibonacci-retracement-trend-based":"false","fill-color":"dialog","horizontal-line":"false","line-color":"dialog","line-menu":"menu","line-stroke-width":"menu","line-style-type":"menu","measurer-menu":"menu","pan-end":"false","pan-left":"false","pan-right":"false","pan-start":"false","parallel-channel":"false","shape-menu":"menu","text-color":"dialog","text-menu":"menu","text-size":"menu","vertical-line":"false","zoom-in":"false","zoom-out":"false",callout:"false",clear:"false",comment:"false",delete:"false",line:"false",lock:"false",menu:"menu",note:"false",reset:"false",settings:"dialog",text:"false"};function r3(e){return typeof e!="string"?"false":a3[e]}var w2=class extends qy{constructor(e){super(),this.localeManager=e}update(e){const{localeManager:t}=this;if(e.tooltip){const n=t.t(e.tooltip);n!==this.lastTooltip&&(this.elem.title=n,this.lastTooltip=n)}let i="";if(e.icon!=null&&(i=`<span class="${pl(e.icon)} ag-charts-toolbar__icon"></span>`),e.label!=null){const n=t.t(e.label);i=`${i}<span class="ag-charts-toolbar__label">${n}</span>`}const s=r3(e.value);s=="false"?(this.setAriaHasPopup(void 0),this.setAriaExpanded(void 0)):(this.setAriaHasPopup(s),this.setAriaExpanded(!1)),i!==this.lastInnerHTML&&(this.elem.innerHTML=i,this.lastInnerHTML=i)}setChecked(e){Fe(this.elem,"aria-checked",e)}},T2="ag-charts-toolbar__button--active",yI=class extends Qy{constructor({eventsHub:e,localeManager:t},i,s){super(s),this.ariaLabelId=i,this.horizontalSpacing=10,this.verticalSpacing=10,this.events=new vT,this.hasPrefix=!1,this.buttonWidgets=[],this.updateAriaLabel=()=>this.setAriaLabel(this.localeManager.t(this.ariaLabelId)),this.eventsHub=e,this.localeManager=t,this.addClass("ag-charts-toolbar"),this.toggleClass("ag-charts-toolbar--horizontal",s==="horizontal"),this.toggleClass("ag-charts-toolbar--vertical",s==="vertical"),this.eventsHub.on("locale:change",this.updateAriaLabel),this.updateAriaLabel()}setAriaLabelId(e){this.ariaLabelId=e,this.updateAriaLabel()}addToolbarListener(e,t){return this.events.addListener(e,t)}clearButtons(){this.expanded?.collapse({mode:"2"});for(const e of this.buttonWidgets)e.destroy();this.buttonWidgets.splice(0)}updateButtons(e){const{buttonWidgets:t}=this;for(const[i,s]of e.entries())(this.buttonWidgets.at(i)??this.createButton(i,s)).update(s);for(let i=e.length;i<t.length;i++)this.buttonWidgets.at(i)?.destroy();this.buttonWidgets.splice(e.length),this.refreshButtonClasses()}updateButtonByIndex(e,t){this.buttonWidgets.at(e)?.update(t)}clearActiveButton(){for(const e of this.buttonWidgets)e.toggleClass(T2,!1)}toggleActiveButtonByIndex(e){if(e!==-1)for(const[t,i]of this.buttonWidgets.entries())i.toggleClass(T2,e!=null&&e===t)}toggleButtonEnabledByIndex(e,t){e!==-1&&this.buttonWidgets.at(e)?.setEnabled(t)}toggleSwitchCheckedByIndex(e,t){e!==-1&&this.buttonWidgets.at(e)?.setChecked(t)}getButtonBounds(){return this.buttonWidgets.map(e=>this.getButtonWidgetBounds(e))}setButtonHiddenByIndex(e,t){this.buttonWidgets.at(e)?.setHidden(t)}getButtonWidgetBounds(e){const t=this.getBounds(),i=e.getBounds();return new re(i.x+t.x,i.y+t.y,i.width,i.height)}refreshButtonClasses(){const{buttonWidgets:e,hasPrefix:t}=this;let i,s,n;for(const[o,a]of e.entries())i=!t&&o===0||n!=a.section,s=o===e.length-1||a.section!=e.at(o+1)?.section,a.toggleClass("ag-charts-toolbar__button--first",i),a.toggleClass("ag-charts-toolbar__button--last",s),a.toggleClass("ag-charts-toolbar__button--gap",o>0&&i),n=a.section}createButton(e,t){const i=this.createButtonWidget();return i.addClass("ag-charts-toolbar__button"),i.addListener("click",s=>{const n={index:e,...t instanceof K?t.toJson():t},o=this.getButtonWidgetBounds(i),a={event:s,button:n,buttonBounds:o,buttonWidget:i};this.events.dispatch("button-pressed",a)}),i.addListener("focus",()=>{const s={button:{index:e}};this.events.dispatch("button-focused",s)}),i.addListener("expand-controlled-widget",s=>{this.expanded?.collapse({mode:"4"}),this.expanded=s.controlled;const n=this.expanded.addListener("collapse-widget",()=>{this.expanded=void 0,n()})}),t.section&&(i.section=t.section),this.buttonWidgets.push(i),this.addChild(i),i}},l3=class extends yI{createButtonWidget(){return new w2(this.localeManager)}},c3=class extends L2{constructor(e,t,i){super(e,t),this.onPopoverMoved=i,this.dragHandleDraggingClass="ag-charts-floating-toolbar__drag-handle--dragging"}show(e,t={}){this.showWithChildren(e,{...t,class:"ag-charts-floating-toolbar"})}hide(){this.dragged=!1,super.hide()}getBounds(){const e=this.getPopoverElement();return new re(e?.offsetLeft??0,e?.offsetTop??0,e?.offsetWidth??0,e?.offsetHeight??0)}hasBeenDragged(){return this.dragged}setAnchor(e,t,i){const s=this.getPopoverElement();if(!s)return;const n=e.position??"above",{offsetWidth:o,offsetHeight:a}=s;let r=e.y-a-i,l=e.x-o/2;n==="below"?r=e.y+i:n==="right"?(r=e.y-a/2,l=e.x+t):n==="above-left"&&(l=e.x),this.updatePosition({x:l,y:r})}ignorePointerEvents(){const e=this.getPopoverElement();e&&(e.style.pointerEvents="none")}capturePointerEvents(){const e=this.getPopoverElement();e&&(e.style.pointerEvents="unset")}updatePosition(e){const t=this.getBounds(),i=this.ctx.domManager.getBoundingClientRect();e.x=Math.floor(ge(0,e.x,i.width-t.width)),e.y=Math.floor(ge(0,e.y,i.height-t.height)),super.updatePosition(e),this.onPopoverMoved()}},h3=class extends yI{constructor(e,t,i){super(e,t,"horizontal"),this.hasPrefix=!0,this.popover=new c3(e,i,this.onPopoverMoved.bind(this)),this.dragHandle=new d3(e.localeManager.t("toolbarAnnotationsDragHandle")),this.popover.setDragHandle(this.dragHandle)}destroy(){super.destroy(),this.popover.destroy()}show(e={}){this.popover.show([this.dragHandle.getElement(),this.getElement()],e)}hide(){this.popover.hide()}setAnchor(e){this.popover.setAnchor(e,this.horizontalSpacing,this.verticalSpacing)}hasBeenDragged(){return this.popover.hasBeenDragged()}ignorePointerEvents(){this.popover.ignorePointerEvents()}capturePointerEvents(){this.popover.capturePointerEvents()}onPopoverMoved(){const e=this.popover.getBounds();if(this.popoverBounds?.equals(e))return;this.popoverBounds=e.clone();const t=this.getButtonBounds();this.events.dispatch("toolbar-moved",{popoverBounds:e,buttonBounds:t})}getButtonWidgetBounds(e){const t=this.popover.getBounds(),i=super.getButtonWidgetBounds(e),s=this.dragHandle.getBounds();return new re(i.x+t.x-s.width,i.y+t.y,i.width,i.height)}},d3=class extends ou{constructor(e){super(xe("div","ag-charts-floating-toolbar__drag-handle"));const t=new ou(xe("span",`${pl("drag-handle")} ag-charts-toolbar__icon`));t.setAriaHidden(!0),this.addChild(t),this.elem.title=e}},u3={...gN,...fN},gf={};Vs(gf,{ButtonWidget:()=>qy,MenuItemRadioWidget:()=>D2,MenuItemWidget:()=>mI,MenuWidget:()=>I2,NativeWidget:()=>ou,SliderWidget:()=>TM,ToolbarWidget:()=>Qy,WIDGET_HTML_EVENTS:()=>nT,Widget:()=>Sr,WidgetEventUtil:()=>kl});var N2={title:{enabled:!1},label:{enabled:!1},line:{enabled:!1},gridLine:{enabled:!1},crosshair:{enabled:!1,stroke:sg,lineDash:[0],label:{enabled:!1}}},xI={...N2,nice:!1},Jx={mode:"compact",position:{anchorTo:"node",placement:["right","left"]},showArrow:!1},bI={style:[{stroke:{$ref:"gridLineColor"}}],width:2},p3={number:{gridLine:bI},time:{gridLine:bI},category:{gridLine:bI}},g3={overrides:{common:{animation:{enabled:!1},contextMenu:{enabled:!1},keyboard:{enabled:!1},background:{visible:!1},navigator:{enabled:!1},padding:{top:0,right:0,bottom:0,left:0},axes:{number:{...xI,interval:{values:[0]}},log:{...xI},time:{...xI},category:{...N2}}},bar:{series:{crisp:!1,label:{placement:"inside-end",padding:4},sparklineMode:!0},tooltip:{...Jx,position:{...Jx.position,anchorTo:"pointer"},range:"nearest"},axes:p3},line:{seriesArea:{padding:{top:2,right:2,bottom:2,left:2}},series:{sparklineMode:!0,strokeWidth:1,marker:{enabled:!1,size:3}},tooltip:Jx},area:{seriesArea:{padding:{top:1,right:0,bottom:1,left:0}},series:{strokeWidth:1,fillOpacity:.4},tooltip:Jx}}},O2=ji(f3);function f3(e,t){return typeof e=="string"?{...t,baseTheme:e}:e!=null?{...e,baseTheme:O2(e.baseTheme,t)}:t}function E2(e){if(Array.isArray(e)&&e.length!==0){const t=e.find(i=>i!=null);if(typeof t=="number")return{data:e.map((s,n)=>({x:n,y:s})),series:[{xKey:"x",yKey:"y"}],datumKey:"y"};if(Array.isArray(t))return{data:e.map(s=>({x:s?.[0],y:s?.[1],datum:s})),series:[{xKey:"x",yKey:"y"}],datumKey:"datum"}}else if(e?.length===0)return{data:e,series:[{xKey:"x",yKey:"y"}],datumKey:"y"};return{data:e}}function m3(e){switch(e?.type){case"number":{const{reverse:t,min:i,max:s}=e??{};return{type:"number",reverse:t,min:i,max:s}}case"time":{const{reverse:t,min:i,max:s}=e??{};return{type:"time",reverse:t,min:i,max:s}}case"category":default:{if(e==null)return{type:"category"};const{reverse:t,paddingInner:i,paddingOuter:s}=e;return{type:"category",reverse:t,paddingInner:i,paddingOuter:s}}}}function y3(e,t,i){const s={};return e?.stroke!=null&&(s.style=[{stroke:e?.stroke}],s.enabled??(s.enabled=!0)),e?.strokeWidth!=null&&(s.width=e?.strokeWidth,s.enabled??(s.enabled=!0)),i.type==="bar"&&i.direction!=="horizontal"&&(s.enabled??(s.enabled=!0)),e?.visible!=null&&(s.enabled=e.visible),s.enabled??(s.enabled=t),s}var x3=ji((e,t,i)=>s=>{const n=s.datum[s.xKey],o=s.datum[s.yKey],a=i==null?s.datum:s.datum[i],r=t?.renderer?.({context:e,datum:a,xValue:n,yValue:o});if(Rt(r)||gt(r)||Is(r))return Dt(r);const l=r?.content??o.toFixed(2);return r?.title?{heading:void 0,title:void 0,data:[{label:r.title,value:l}]}:{heading:void 0,title:l,data:[]}});function b3(e){const{background:t,container:i,height:s,listeners:n,locale:o,minHeight:a,minWidth:r,overrideDevicePixelRatio:l,padding:c,width:h,theme:d,data:u,crosshair:p,axis:f,min:y,max:b,tooltip:x,context:v,styleNonce:S,...M}=e,D={background:t,container:i,height:s,listeners:n,locale:o,minHeight:a,minWidth:r,overrideDevicePixelRatio:l,padding:c,width:h,styleNonce:S},{data:k,series:[I]=[],datumKey:A}=E2(u),C=M;I!=null&&Object.assign(C,I),C.tooltip={...x,renderer:x3(v,x,A)},D.theme=O2(d,g3),D.data=k,D.series=[C];const w=C.type==="bar"&&C.direction==="horizontal",[T,O]=w?["left","bottom"]:["bottom","left"],E={...m3(f),position:T,...p==null?{}:{crosshair:p}},z={type:"number",gridLine:y3(f,!1,e),position:O,...y==null?{}:{min:y},...b==null?{}:{max:b}};return D.axes=w?{x:z,y:E}:{x:E,y:z},D}var vI=["showInLegend","showInMiniChart","grouped","stacked","stackGroup","tooltip","listeners","errorBar","xKey","yKey","type"],SI={visible:R,reverse:R,stroke:ie,strokeWidth:P},eb={context:()=>!0,tooltip:le,theme:le,background:le,container:le,width:le,height:le,minWidth:le,minHeight:le,padding:le,listeners:le,locale:le,data:le,styleNonce:N,axis:nl({number:{...SI,min:Ue(W,ss("max")),max:Ue(W,ns("min"))},category:{...SI,paddingInner:ce,paddingOuter:ce},time:{...SI,min:Ue(Ae(W,is),ss("max")),max:Ue(Ae(W,is),ns("min"))}},"axis options","category"),min:Ue(W,ss("max")),max:Ue(W,ns("min")),crosshair:{enabled:R,snap:R,...J,...ne},xKey:N,yKey:N};eb.overrideDevicePixelRatio=ee(W);var P2={type:"preset",name:"sparkline",version:ue,options:nl({area:{...eb,...Q(MD,vI)},bar:{...eb,...Q(ku,vI)},line:{...eb,...Q(Yg,vI)}},"sparkline options"),create:b3,processData:E2},v3=["top","right","bottom","left"],ff=class t_ extends mx{constructor(t,i){super(t,i),this.paired=!0,this.axes=this.createChartAxes(),this.lastUpdateClipRect=void 0,this.lastLayoutWidth=Number.NaN,this.lastLayoutHeight=Number.NaN}createChartAxes(){return new lH}onAxisChange(t,i){super.onAxisChange(t,i),this.syncAxisChanges(t,i),this.ctx!=null&&this.ctx.zoomManager.setAxes(t)}destroySeries(t){super.destroySeries(t),this.lastLayoutWidth=Number.NaN,this.lastLayoutHeight=Number.NaN}getChartType(){return"cartesian"}setRootClipRects(t){const{seriesRoot:i,annotationRoot:s}=this;i.setClipRect(t),s.setClipRect(t)}async processData(){await super.processData(),this.syncStatus==="init"&&(this.syncStatus="domains-calculated"),this.ctx.updateService.dispatchProcessData({series:{shouldFlipXY:this.shouldFlipXY()}})}async processDomains(){await super.processDomains();for(const t of this.axes){const i=await this.getSyncedDomain(t);i!=null&&t.setDomains({domain:i})}}performLayout(t){const{seriesRoot:i,annotationRoot:s}=this,{clipSeries:n,seriesRect:o,visible:a}=this.updateAxes(t.layoutBox);this.seriesRoot.visible=a,this.seriesRect=o,this.animationRect=t.layoutBox;const{x:r,y:l}=o;if(t.width!==this.lastLayoutWidth||t.height!==this.lastLayoutHeight)for(const f of[i,s])f.translationX=Math.floor(r),f.translationY=Math.floor(l);else{const{translationX:f,translationY:y}=i;Nl(this.id,"seriesRect",this.ctx.animationManager,[i,s],{translationX:f,translationY:y},{translationX:Math.floor(r),translationY:Math.floor(l)},{phase:"update"})}this.lastLayoutWidth=t.width,this.lastLayoutHeight=t.height;const c=o.clone().grow(this.seriesArea.getPadding()),u=this.series.some(f=>f.alwaysClip)||(this.seriesArea.clip??!1)||n?c:void 0,{lastUpdateClipRect:p}=this;this.lastUpdateClipRect=u,this.ctx.animationManager.isActive()&&p!=null?this.ctx.animationManager.animate({id:this.id,groupId:"clip-rect",phase:"update",from:p,to:c,onUpdate:f=>this.setRootClipRects(f),onComplete:()=>this.setRootClipRects(u)}):this.setRootClipRects(u),this.ctx.layoutManager.emitLayoutComplete(t,{axes:$S(this.axes.map(f=>[f.id,f.getLayoutState()])),series:{visible:a,rect:o,paddedRect:c},clipSeries:n}),NO(this.series)}updateAxes(t){const{clipSeries:i,seriesRect:s,overflows:n}=this.resolveAxesLayout(t);for(const o of this.axes)o.update(),o.setCrossLinesVisible(!n),this.clipAxis(o,s,t);return{clipSeries:i,seriesRect:s,visible:!n}}resolveAxesLayout(t){let i,s,n=0;const o=10,a=this.axes.filter(r=>r.crossAt?.value!=null);do if(s=i??this.getDefaultState(),i=this.updateAxesPass(new Map(s.axisAreaWidths),t.clone(),a),n++>o){j.warn("Max iterations reached. Unable to stabilize axes layout.");break}while(!this.isLayoutStable(i,s));return this.lastAreaWidths=i.axisAreaWidths,i}updateAxesPass(t,i,s){const n=new Map,o={};let a=!1,r=!1;const l=this.seriesArea.getPadding();for(const M of v3){const D=l[M]??0,k=this.axes.findLast(I=>I.position===M);k?k.seriesAreaPadding=D:i.shrink(D,M)}const c=(t.get("left")??0)+(t.get("right")??0),h=(t.get("top")??0)+(t.get("bottom")??0),d=this.buildCrossLinePadding(t),u=d.left+d.right,p=d.top+d.bottom;i.width<=c+u||i.height<=h+p?a=!0:i.shrink(d);const{scene:f}=this.ctx,y=i.clone().shrink(Object.fromEntries(t));for(const M of this.axes){const{position:D="left",direction:k}=M,I=k==="y";let A;this.sizeAxis(M,y,D),M.thickness==null?A=MI(I,f)*(M.maxThicknessRatio??1):A=M.thickness;const{primaryTickCount:C,bbox:w}=M.calculateLayout(M.nice?o[k]:void 0,{sizeLimit:A-M.label.spacing,padding:this.padding});o[k]??(o[k]=C),r||(r=M.dataDomain.clipped||M.visibleRange[0]>0||M.visibleRange[1]<1),M.thickness==null&&(A=Math.min(MI(I,w)??0,A)),n.set(M.id,Math.ceil(A))}let b;s.length>0&&(b=this.calculateAxesCrossPositions(n,y,s));const x=Zh(this.axes,M=>M.position??"left"),v=new Map,S=new Map;for(const[M,D]of ht(x)){let k=MI(M!=="left"&&M!=="right",f)%f.pixelRatio,I=0;for(const A of D??[]){S.set(A.id,k);const C=n.get(A.id)??0;I=Math.max(I,k+C),A.layoutConstraints.stacked&&(k+=C+t_.AxesPadding)}v.set(M,Math.ceil(I))}for(const[M,D]of ht(x))this.positionAxes({axes:D??[],position:M,axisWidths:n,axisOffsets:S,axisAreaWidths:v,axisBound:i,seriesRect:y});return b!=null&&this.applyAxisCrossing(y,b),{clipSeries:r,seriesRect:y,axisAreaWidths:v,overflows:a}}calculateAxesCrossPositions(t,i,s){const n=new Map;for(const o of s){const{crossPosition:a,visible:r}=this.calculateAxisCrossPosition(o);o.setAxisVisible(r),this.adjustAxisWidth(o,t,a,i,r),a!=null&&n.set(o.id,a)}return n}calculateAxisCrossPosition(t){const i=this.axes.perpendicular(t),{scale:{domain:s,bandwidth:n},range:o}=i,a=(n??0)/2,r=i.scale.convert(t.crossAt?.value,{clamp:!1})+a;return i.inRange(r)?{crossPosition:r,visible:!0}:t.crossAt?.sticky===!1?{crossPosition:void 0,visible:!1}:{crossPosition:Number.isNaN(r)?o[s[0]]:Ac(r,o),visible:!0}}adjustAxisWidth(t,i,s,n,o){if(t.getModuleMap().getModule("crosshair")?.enabled||this.modulesManager.getModule("annotations")?.enabled===!0||this.ctx.annotationManager.createMemento().some(d=>{switch(d.type){case"vertical-line":return t.direction==="x";case"horizontal-line":return t.direction==="y"}}))return;const c=i.get(t.id)??0,h=o?this.calculateAxisBleedingWidth(t,c,s,n):0;i.set(t.id,h)}calculateAxisBleedingWidth(t,i,s,n){if(s==null)return i;switch(t.position){case"left":case"top":return Math.max(0,i-s);case"right":return Math.max(0,s+i-n.width);case"bottom":return Math.max(0,s+i-n.height);default:return i}}applyAxisCrossing(t,i){for(const s of this.axes){const n=i.get(s.id);if(n==null){s.crossAxisTranslation.x=0,s.crossAxisTranslation.y=0;continue}const o=s.direction==="x";s.crossAxisTranslation.x=o?0:t.x+n-s.translation.x,s.crossAxisTranslation.y=o?t.y+n-s.translation.y:0}}buildCrossLinePadding(t){var i;const s={top:0,right:0,bottom:0,left:0};for(const n of this.axes){const{position:o,label:a}=n;if(n.crossLines)for(const r of n.crossLines)r instanceof ws&&(r.position=o??"top",(i=r.label).parallel??(i.parallel=a.parallel)),r.calculatePadding?.(s)}for(const[n,o=0]of ht(s))s[n]=Math.max(o-(t.get(n)??0),0);return s}clampToOutsideSeriesRect(t,i,s,n){const o=s==="x"?t.x:t.y,a=s==="x"?t.width:t.height;return n===1?Math.min(i,o+a):Math.max(i,o)}async getSyncedDomain(t){const i=this.modulesManager.getModule("sync");if(i?.enabled)return await i.getSyncedDomain(t)}syncAxisChanges(t,i){const s=this.modulesManager.getModule("sync");if(!s?.enabled)return;const n=new Set(i??[]);for(const o of t)n.delete(o);for(const o of n)s.removeAxis(o)}sizeAxis(t,i,s){const n=t instanceof zn,o=s==="left"||s==="right",{width:a,height:r}=i,l=o?r:a;let c=0,h=l,{min:d,max:u}=this.ctx.zoomManager.getAxisZoom(t.id);const{width:p,unit:f,align:y}=t.layoutConstraints;f==="px"?h=c+p:h=h*p/100,y==="end"&&(c=l-(h-c),h=l),o&&(n?[c,h]=[h,c]:[d,u]=[1-u,1-d]),t.range=[c,h],t.visibleRange=[d,u],t.gridLength=o?a:r}positionAxes(t){const{axes:i,axisBound:s,axisWidths:n,axisOffsets:o,axisAreaWidths:a,seriesRect:r,position:l}=t,c=a.get(l)??0;let h="x",d="y",u=1;(l==="top"||l==="bottom")&&(h="y",d="x");let p=s[h];(l==="right"||l==="bottom")&&(u=-1,p+=h==="x"?s.width:s.height);for(const f of i){const y=a.get(d==="x"?"left":"top")??0,b=n.get(f.id)??0,x=o.get(f.id)??0;f.gridPadding=c-x-b,f.translation[d]=s[d]+y,f.translation[h]=this.clampToOutsideSeriesRect(r,p+u*(x+b),h,u)}}shouldFlipXY(){return this.series.every(t=>t instanceof Wl&&t.shouldFlipXY())}getDefaultState(){const t=new Map;if(this.lastAreaWidths)for(const{position:i="left"}of this.axes){const s=this.lastAreaWidths.get(i);s!=null&&t.set(i,s)}return{axisAreaWidths:t,clipSeries:!1,overflows:!1}}isLayoutStable(t,i){if(i.overflows!==t.overflows||i.clipSeries!==t.clipSeries)return!1;for(const s of t.axisAreaWidths.keys())if(!i.axisAreaWidths.has(s))return!1;for(const[s,n]of i.axisAreaWidths.entries()){const o=t.axisAreaWidths.get(s);if((n!=null||o!=null)&&n!==o)return!1}return!0}clipAxis(t,i,s){const n=Math.ceil(t.gridLine?.width??0),o=Math.ceil(t.line?.width??0);let{width:a,height:r}=i;switch(a+=t.direction==="x"?n:o,r+=t.direction==="y"?n:o,t.clipGrid(i.x,i.y,a,r),t.position){case"left":case"right":t.clipTickLines(s.x,i.y-n,s.width+n,i.height+n*2);break;case"top":case"bottom":t.clipTickLines(i.x-n,s.y,i.width+n*2,s.height+n);break}}};ff.className="CartesianChart",ff.type="cartesian",ff.AxesPadding=15,g([He({changeValue(e,t){this.onAxisChange(e,t)}})],ff.prototype,"axes",2);var S3=ff;function MI(e,t){return e?t?.width:t?.height}var M3=new Set(["number","log","time"]),D3=e=>fe(e)&&e.type!=null&&!M3.has(e.type),oi={type:"chart",name:"cartesian",version:ue,options:QU,create(e,t){return new S3(e,t)},validate(e,t,i){const s=[];e?.series?.[0]?.type==="histogram"&&Object.values(e?.axes??{}).some(D3)&&(s.push(new la("invalid","only continuous axis types when histogram series is used",e.axes,i,"axes")),e=Q(e,["axes"]));const n=Ei(e,t,i);return n.invalid.push(...s),n}},DI=class extends mx{constructor(e,t){super(e,t),this.axes=this.createChartAxes(),this.padding=new gr(40),this.ctx.axisManager.axisGroup.zIndex=8}createChartAxes(){return new cH}getChartType(){return"polar"}isDataTransactionSupported(){return!this.series.some(e=>e.type==="pie"||e.type==="donut")}async performLayout(e){const t=e.layoutBox.clone().shrink(this.seriesArea.getPadding());this.seriesRect=t,this.animationRect=t,this.seriesRoot.translationX=t.x,this.seriesRoot.translationY=t.y,await this.computeCircle(t);for(const s of this.axes)s.update();let i=0;for(const s of this.series)i=Math.max(i,s.properties.marker?.size??0);for(const s of this.series.filter(R2))s.maxChartMarkerSize=i;this.ctx.layoutManager.emitLayoutComplete(e,{series:{visible:!0,rect:t,paddedRect:e.layoutBox}})}updateAxes(e,t,i,s){if(this.axes.length===0)return;const n=this.axes.angle,o=this.axes.radius,a=n.scale,r=o.innerRadiusRatio;n.innerRadiusRatio=r,n.computeRange(),n.gridLength=s,o.gridAngles=a.ticks({nice:[n.nice,n.nice],interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0})?.ticks?.map(l=>a.convert(l)),o.gridRange=n.range,o.range=[s,s*r];for(const l of[n,o])l.translation.x=e.x+t,l.translation.y=e.y+i,l.calculateLayout()}async computeCircle(e){const t=this.series.filter(R2),i=(l,c,h)=>{this.updateAxes(e,l,c,h);for(const u of t)u.centerX=l,u.centerY=c,u.radius=h;const d=t.filter(u=>u.type==="donut"||u.type==="pie");if(d.length>1){const u=d.map(p=>{const f=p.getInnerRadius();return{series:p,innerRadius:f}}).sort((p,f)=>p.innerRadius-f.innerRadius);u.at(-1).series.surroundingRadius=void 0;for(let p=0;p<u.length-1;p++)u[p].series.surroundingRadius=u[p+1].innerRadius}},s=e.width/2,n=e.height/2,o=Math.max(0,Math.min(e.width,e.height)/2);let a=o;i(s,n,a);const r=async({hideWhenNecessary:l=!1}={})=>{const c=[];for(const u of or(this.axes,t)){const p=await u.computeLabelsBBox({hideWhenNecessary:l},e);p&&c.push(p)}if(c.length===0){i(s,n,o);return}const h=re.merge(c),d=this.refineCircle(h,a,e);i(d.centerX,d.centerY,d.radius),a=d.radius};await r(),await r(),await r(),await r({hideWhenNecessary:!0}),await r({hideWhenNecessary:!0});for(const l of or(this.axes,t))await l.computeLabelsBBox({hideWhenNecessary:!0},e);return{radius:a,centerX:s,centerY:n}}refineCircle(e,t,i){const n=-t,o=-t,a=t,r=t;let l=Math.max(0,n-e.x),c=Math.max(0,o-e.y),h=Math.max(0,e.x+e.width-a),d=Math.max(0,e.y+e.height-r);l=h=Math.max(l,h),c=d=Math.max(c,d);const u=i.width-l-h,p=i.height-c-d;let f=Math.min(u,p)/2;const y=.5*i.width/2,b=.5*i.height/2,x=Math.min(y,b);if(f<x){f=x;const M=l+h,D=c+d;if(2*f+D>i.height){const k=i.height-2*f;Math.min(c,d)*2>k?(c=k/2,d=k/2):c>d?c=k-d:d=k-c}if(2*f+M>i.width){const k=i.width-2*f;Math.min(l,h)*2>k?(l=k/2,h=k/2):l>h?l=k-h:h=k-l}}const v=l+2*f+h,S=c+2*f+d;return{centerX:(i.width-v)/2+l+f,centerY:(i.height-S)/2+c+f,radius:f}}};DI.className="PolarChart",DI.type="polar";function R2(e){return e instanceof lI}var Nr={type:"chart",name:"polar",version:ue,options:JU,create(e,t){return new DI(e,t)},validate(e,t,i){const s=[],n=e?.series?.[0]?.type;(n==="pie"||n==="donut")&&e?.axes&&(s.push(new Pp([],e.axes,i,"axes")),e=Q(e,["axes"]));const o=Ei(e,t,i);return o.invalid.push(...s),o}};function I3({orientation:e,bboxes:t,maxHeight:i,maxWidth:s,itemPaddingY:n=0,itemPaddingX:o=0,forceResult:a=!1}){const r=e==="horizontal",l={max:r?s:i,fn:r?u=>u.width:u=>u.height,padding:r?o:n},c={max:r?i:s,fn:r?u=>u.height:u=>u.width,padding:r?n:o};let h=0;const d=[];for(;h<t.length;){const u=t.slice(h),p=k3(u,h,l,c,a);if(!p)return;h+=p.processedBBoxCount,d.push(p.pageIndices)}return C3(d,e,t,n,o)}function k3(e,t,i,s,n){let a=w3(e,i);if(a<1){if(!n)return;a=1}let r=a;for(;r>=1;){const l=A3(e,t,r,i,s,n);if(l==null&&r<=1)return;if(l==null){r--;continue}if(typeof l=="number"){if(l<=1)return;r=l<r&&l>1?l:r,r--;continue}return{processedBBoxCount:l.length*l[0].length,pageIndices:l}}}function A3(e,t,i,s,n,o){const a=[];let r=0,l=0,c=[];const h=[];for(let d=0;d<e.length;d++){const u=(d+i)%i;u===0&&(r+=l,l=0,c.length>0&&a.push(c),c=[]);const p=s.fn(e[d])+s.padding;h[u]=Math.max(h[u]??0,p),l=Math.max(l,n.fn(e[d])+n.padding);const f=r+l,y=!o||a.length>0;if(f>n.max&&y){c=[];break}if(h.reduce((x,v)=>x+v,0)>s.max&&!o)return h.length<i?h.length:void 0;c.push(d+t)}return c.length>0&&a.push(c),a.length>0?a:void 0}function C3(e,t,i,s,n){let o=0,a=0;return{pages:e.map(l=>{t==="horizontal"&&(l=L3(l));let c=0;const h=l.map(p=>{const f=p.map(x=>(c=Math.max(x,c),i[x]));let y=0,b=0;for(const x of f)y+=x.height+s,b=Math.max(b,x.width+n);return{indices:p,bboxes:f,columnHeight:Math.ceil(y),columnWidth:Math.ceil(b)}});let d=0,u=0;for(const p of h)d+=p.columnWidth,u=Math.max(u,p.columnHeight);return o=Math.max(d,o),a=Math.max(u,a),{columns:h,startIndex:l[0][0],endIndex:c,pageWidth:d,pageHeight:u}}),maxPageWidth:o,maxPageHeight:a}}function L3(e){const t=[];for(const i of e[0])t.push([]);for(const[i,s]of e.entries())for(const[n,o]of s.entries())t[n][i]=o;return t}function w3(e,t){const i=e.length;let s=0;for(let n=0;n<i;n++)if(s+=t.fn(e[n])+t.padding,s>t.max)return i/n<2?Math.ceil(i/2):n;return i}var Vu=class extends K{constructor(){super(...arguments),this.color="black",this.fontStyle=void 0,this.fontWeight=void 0,this.fontSize=12,this.fontFamily="Verdana, sans-serif"}};g([m],Vu.prototype,"color",2),g([m],Vu.prototype,"fontStyle",2),g([m],Vu.prototype,"fontWeight",2),g([m],Vu.prototype,"fontSize",2),g([m],Vu.prototype,"fontFamily",2);var Or=class extends K{constructor(){super(...arguments),this.size=15,this.fill=void 0,this.fillOpacity=void 0,this.stroke=void 0,this.strokeWidth=1,this.strokeOpacity=1}};g([m],Or.prototype,"size",2),g([m],Or.prototype,"fill",2),g([m],Or.prototype,"fillOpacity",2),g([m],Or.prototype,"stroke",2),g([m],Or.prototype,"strokeWidth",2),g([m],Or.prototype,"strokeOpacity",2);var tb=class extends K{constructor(e){super(),this.parent=e,this.shape="triangle",this.size=15,this.padding=8}};g([He({changeValue(){this.parent.marker===this&&this.parent.onMarkerShapeChange()}})],tb.prototype,"shape",2),g([m],tb.prototype,"size",2),g([m],tb.prototype,"padding",2);var xh=class extends K{constructor(e,t){super(),this.chartUpdateCallback=e,this.pageUpdateCallback=t,this.id=Mi(this),this.marker=new tb(this),this.activeStyle=new Or,this.inactiveStyle=new Or,this.highlightStyle=new Or,this.label=new Vu,this.group=new ls({name:"pagination"}),this.labelNode=new rn,this.totalPages=0,this.currentPage=0,this.translationX=0,this.translationY=0,this.nextButtonDisabled=!1,this.previousButtonDisabled=!1,this._visible=!0,this._enabled=!0,this._orientation="vertical",this.nextButton=new ki,this.previousButton=new ki,this.labelNode.setProperties({textBaseline:"middle",fontSize:12,fontFamily:"Verdana, sans-serif",fill:"black",y:1}),this.group.append([this.nextButton,this.previousButton,this.labelNode]),this.update(),this.updateMarkers()}set visible(e){this._visible=e,this.updateGroupVisibility()}get visible(){return this._visible}set enabled(e){this._enabled=e,this.updateGroupVisibility()}get enabled(){return this._enabled}updateGroupVisibility(){this.group.visible=this.enabled&&this.visible}set orientation(e){switch(this._orientation=e,e){case"horizontal":{this.previousButton.rotation=-Math.PI/2,this.nextButton.rotation=Math.PI/2;break}case"vertical":default:this.previousButton.rotation=0,this.nextButton.rotation=Math.PI}}get orientation(){return this._orientation}update(){this.updateLabel(),this.updatePositions(),this.enableOrDisableButtons()}updatePositions(){this.group.translationX=this.translationX,this.group.translationY=this.translationY,this.updateLabelPosition(),this.updateNextButtonPosition()}updateLabelPosition(){const{size:e,padding:t}=this.marker;this.nextButton.size=e,this.previousButton.size=e,this.labelNode.x=e/2+t}updateNextButtonPosition(){const e=this.labelNode.getBBox();this.nextButton.translationX=e.width+(this.marker.size/2+this.marker.padding)*2}updateLabel(){const{currentPage:e,totalPages:t,labelNode:i,label:{color:s,fontStyle:n,fontWeight:o,fontSize:a,fontFamily:r}}=this;i.text=`${e+1} / ${t}`,i.fill=s,i.fontStyle=n,i.fontWeight=o,i.fontSize=a,i.fontFamily=r}updateMarkers(){const{nextButton:e,previousButton:t,nextButtonDisabled:i,previousButtonDisabled:s,activeStyle:n,inactiveStyle:o,highlightStyle:a,highlightActive:r}=this,l=(c,h)=>h?o:c===r?a:n;this.updateMarker(e,l("next",i)),this.updateMarker(t,l("previous",s))}updateMarker(e,t){const{shape:i,size:s}=this.marker;e.shape=i,e.size=s,e.fill=t.fill,e.fillOpacity=t.fillOpacity??1,e.stroke=t.stroke,e.strokeWidth=t.strokeWidth,e.strokeOpacity=t.strokeOpacity}enableOrDisableButtons(){const{currentPage:e,totalPages:t}=this,i=t===0,s=e===t-1,n=e===0;this.nextButtonDisabled=s||i,this.previousButtonDisabled=n||i}setPage(e){e=ge(0,e,Math.max(0,this.totalPages-1)),this.currentPage!==e&&(this.currentPage=e,this.onPaginationChanged())}getCursor(e){return{previous:this.previousButtonDisabled,next:this.nextButtonDisabled}[e]?void 0:"pointer"}onClick(e,t){e.preventDefault(),t==="next"&&!this.nextButtonDisabled?(this.incrementPage(),this.onPaginationChanged()):t==="previous"&&!this.previousButtonDisabled&&(this.decrementPage(),this.onPaginationChanged())}onMouseHover(e){this.highlightActive=e,this.updateMarkers(),this.chartUpdateCallback(7)}onPaginationChanged(){this.pageUpdateCallback(this.currentPage)}incrementPage(){this.currentPage=Math.min(this.currentPage+1,this.totalPages-1)}decrementPage(){this.currentPage=Math.max(this.currentPage-1,0)}onMarkerShapeChange(){this.updatePositions(),this.updateMarkers(),this.chartUpdateCallback(7)}attachPagination(e){e.append(this.group)}getBBox(){return this.group.getBBox()}computeCSSBounds(){const e=Kt.toCanvas(this.previousButton),t=Kt.toCanvas(this.nextButton);return{prev:e,next:t}}};xh.className="Pagination",g([m],xh.prototype,"marker",2),g([m],xh.prototype,"activeStyle",2),g([m],xh.prototype,"inactiveStyle",2),g([m],xh.prototype,"highlightStyle",2),g([m],xh.prototype,"label",2);var T3=class{constructor(e,t){this.dirty=!0,this.itemList=e.proxyInteractionService.createProxyContainer({type:"list",domManagerId:`${t}-toolbar`,classList:["ag-charts-proxy-legend-toolbar"],ariaLabel:{id:"ariaLabelLegend"}}),this.paginationGroup=e.proxyInteractionService.createProxyContainer({type:"group",domManagerId:`${t}-pagination`,classList:["ag-charts-proxy-legend-pagination"],ariaLabel:{id:"ariaLabelLegendPagination"}}),this.itemDescription=xe("p"),this.itemDescription.style.display="none",this.itemDescription.id=ur(),this.itemDescription.textContent=this.getItemAriaDescription(e.localeManager),this.itemList.getElement().append(this.itemDescription)}initLegendList(e){if(!this.dirty)return;const{ctx:t,itemSelection:i,datumReader:s,itemListener:n}=e,o=t.localeManager,a=i.length;i.each((r,l,c)=>{r.proxyButton?.destroy(),r.proxyButton=t.proxyInteractionService.createProxyElement({type:"listswitch",textContent:this.getItemAriaText(o,Pe(s.getItemLabel(l)),c,a),ariaChecked:!!r.datum.enabled,ariaDescribedBy:this.itemDescription.id,parent:this.itemList});const h=r.proxyButton;h.addListener("click",d=>n.onClick(d.sourceEvent,r.datum,h)),h.addListener("dblclick",d=>n.onDoubleClick(d.sourceEvent,r.datum)),h.addListener("mouseenter",d=>n.onHover(d.sourceEvent,r)),h.addListener("mouseleave",()=>n.onLeave()),h.addListener("contextmenu",d=>n.onContextClick(d,r)),h.addListener("blur",()=>n.onLeave()),h.addListener("focus",d=>n.onHover(d.sourceEvent,r)),h.addListener("drag-start",()=>{})}),this.dirty=!1}update(e){e.visible&&(this.initLegendList(e),this.updateItemProxyButtons(e),this.updatePaginationProxyButtons(e,!0)),this.updateVisibility(e.visible)}updateVisibility(e){this.itemList.setHidden(!e),this.paginationGroup.setHidden(!e)}updateItemProxyButtons({itemSelection:e,group:t,pagination:i,interactive:s}){const n=Kt.toCanvas(t);this.itemList.setBounds(n);const o=Math.max(...e.nodes().map(a=>a.getBBox().height));e.each((a,r)=>{if(a.proxyButton){const l=a.pageIndex===i.currentPage,{x:c,y:h,height:d,width:u}=Kt.toCanvas(a),p=(o-d)/2,f={x:c-n.x,y:h-p-n.y,height:o,width:u},y=s&&l;a.proxyButton.setCursor("pointer"),a.proxyButton.setEnabled(y),a.proxyButton.setPointerEvents(y?void 0:"none"),a.proxyButton.setBounds(f)}})}updatePaginationProxyButtons(e,t){const{pagination:i}=e;if(this.paginationGroup.setHidden(!i.visible),t&&"ctx"in e){const{oldPages:s,newPages:n}=e,o=(s?.length??n.length)>1,a=n.length>1;o!==a&&(a?this.createPaginationButtons(e):this.destroyPaginationButtons()),this.paginationGroup.setAriaHidden(a?void 0:!0)}if(this.prevButton&&this.nextButton){const{prev:s,next:n}=i.computeCSSBounds(),o=re.merge([s,n]);s.x-=o.x,s.y-=o.y,n.x-=o.x,n.y-=o.y,this.paginationGroup.setBounds(o),this.prevButton.setBounds(s),this.nextButton.setBounds(n),this.prevButton.setEnabled(i.currentPage!==0),this.nextButton.setEnabled(i.currentPage!==i.totalPages-1),this.nextButton.setCursor(i.getCursor("next")),this.prevButton.setCursor(i.getCursor("previous"))}}createPaginationButtons(e){const{ctx:t,pagination:i}=e;this.prevButton||(this.prevButton=t.proxyInteractionService.createProxyElement({type:"button",textContent:{id:"ariaLabelLegendPagePrevious"},tabIndex:0,parent:this.paginationGroup}),this.prevButton.addListener("click",s=>this.onPageButton(e,s,"previous")),this.prevButton.addListener("mouseenter",()=>i.onMouseHover("previous")),this.prevButton.addListener("mouseleave",()=>i.onMouseHover(void 0))),this.nextButton||(this.nextButton=t.proxyInteractionService.createProxyElement({type:"button",textContent:{id:"ariaLabelLegendPageNext"},tabIndex:0,parent:this.paginationGroup}),this.nextButton.addListener("click",s=>this.onPageButton(e,s,"next")),this.nextButton.addListener("mouseenter",()=>i.onMouseHover("next")),this.nextButton.addListener("mouseleave",()=>i.onMouseHover(void 0)))}destroyPaginationButtons(){this.nextButton?.destroy(),this.prevButton?.destroy(),this.nextButton=void 0,this.prevButton=void 0}onPageButton(e,t,i){e.pagination.onClick(t.sourceEvent,i),this.updatePaginationProxyButtons(e,!1)}onDataUpdate(e,t){this.dirty=e.length!==t.length||e.some((i,s,n)=>{const[o,a]=[t[s],e[s]];return o.id!==a.id})}onLocaleChanged(e,t,i){const s=t.length;t.each(({proxyButton:n},o,a)=>{const r=n?.getElement();if(r!=null){const l=Pe(i.getItemLabel(o));r.textContent=this.getItemAriaText(e,l,a,s)}}),this.itemDescription.textContent=this.getItemAriaDescription(e)}onPageChange(e){this.updateItemProxyButtons(e),this.updatePaginationProxyButtons(e,!1)}getItemAriaText(e,t,i,s){return i>=0&&t?(i++,e.t("ariaLabelLegendItem",{label:t,index:i,count:s})):e.t("ariaLabelLegendItemUnknown")}getItemAriaDescription(e){return e.t("ariaDescriptionLegendItem")}};function F2(e,{itemId:t,seriesId:i,label:{text:s}},n){const o={defaultPrevented:!1,apiEvent:{type:e,itemId:t,seriesId:i,event:n,text:Pe(s),preventDefault:()=>o.defaultPrevented=!0}};return o}var qo=class extends ls{constructor(){super({name:"markerLabelGroup"}),this.symbolsGroup=this.appendChild(new Oe({name:"legend-markerLabel-symbols",renderToOffscreenCanvas:!0,optimizeForInfrequentRedraws:!0})),this.label=this.appendChild(new rn),this.enabled=!0,this.pageIndex=Number.NaN,this.spacing=0,this.length=0,this.isCustomMarker=!1,this.marker=this.symbolsGroup.appendChild(new ki({zIndex:1})),this.line=this.symbolsGroup.appendChild(new En({zIndex:0})),this.line.visible=!1,this.label.textBaseline="middle",this.label.y=1}destroy(){super.destroy(),this.proxyButton?.destroy()}setEnabled(e){this.enabled=e,this.refreshVisibilities()}getTextMeasureBBox(){return this.layout(),re.merge([this.symbolsGroup.getBBox(),this.label.getTextMeasureBBox()])}refreshVisibilities(){const e=this.enabled?1:.5;this.label.opacity=e,this.opacity=e}layout(){const{marker:e,line:t,length:i,isCustomMarker:s}=this;let n=0,o=0;if(e.visible){const{size:a}=e,r=ki.anchor(e.shape);n=(r.x-.5)*a+i/2,o=(r.y-.5)*a,s?(e.x=0,e.y=0,e.translationX=n,e.translationY=o):(e.x=n,e.y=o,e.translationX=0,e.translationY=0)}t.visible&&(t.x1=0,t.x2=i,t.y1=0,t.y2=0)}preRender(e){const t=super.preRender(e);return this.layout(),t}layoutLabel(){const{length:e,spacing:t}=this;this.label.x=e+t}computeBBox(){return this.layout(),super.computeBBox()}};qo.className="MarkerLabel",g([kt("label")],qo.prototype,"text",2),g([kt("label")],qo.prototype,"fontStyle",2),g([kt("label")],qo.prototype,"fontWeight",2),g([kt("label")],qo.prototype,"fontSize",2),g([kt("label")],qo.prototype,"fontFamily",2),g([kt("label","fill")],qo.prototype,"color",2),g([Wt(e=>e.layoutLabel())],qo.prototype,"spacing",2),g([Wt(e=>e.layoutLabel())],qo.prototype,"length",2),g([U()],qo.prototype,"isCustomMarker",2);var Kl=class extends K{constructor(){super(...arguments),this.maxLength=void 0,this.color="black",this.fontStyle=void 0,this.fontWeight=void 0,this.fontSize=12,this.fontFamily="Verdana, sans-serif"}};g([m],Kl.prototype,"maxLength",2),g([m],Kl.prototype,"color",2),g([m],Kl.prototype,"fontStyle",2),g([m],Kl.prototype,"fontWeight",2),g([m],Kl.prototype,"fontSize",2),g([m],Kl.prototype,"fontFamily",2),g([m],Kl.prototype,"formatter",2);var Gu=class extends K{constructor(){super(...arguments),this.shape=void 0,this.size=15,this.padding=8}};g([m],Gu.prototype,"shape",2),g([m],Gu.prototype,"size",2),g([m],Gu.prototype,"padding",2),g([m],Gu.prototype,"strokeWidth",2),g([m],Gu.prototype,"enabled",2);var II=class extends K{};g([m],II.prototype,"strokeWidth",2),g([m],II.prototype,"length",2);var Yl=class extends K{constructor(){super(...arguments),this.paddingX=16,this.paddingY=8,this.showSeriesStroke=!1,this.marker=new Gu,this.label=new Kl,this.line=new II}};g([m],Yl.prototype,"maxWidth",2),g([m],Yl.prototype,"paddingX",2),g([m],Yl.prototype,"paddingY",2),g([m],Yl.prototype,"showSeriesStroke",2),g([m],Yl.prototype,"marker",2),g([m],Yl.prototype,"label",2),g([m],Yl.prototype,"line",2);var kI=class extends K{};g([m],kI.prototype,"legendItemClick",2),g([m],kI.prototype,"legendItemDoubleClick",2);var z2={type:"gradient",bounds:"item",gradient:"linear",colorStops:[{color:"black"}],rotation:0,reverse:!1,colorSpace:"rgb"},B2={type:"pattern",pattern:"forward-slanted-lines",width:8,height:8,padding:1,fill:"black",fillOpacity:1,backgroundFill:"white",backgroundFillOpacity:1,stroke:"black",strokeOpacity:1,strokeWidth:1,rotation:0,scale:1},_2={type:"image",backgroundFill:"black",backgroundFillOpacity:1,rotation:0,repeat:"no-repeat",fit:"contain",width:8,height:8},ui=class extends K{constructor(e){super(),this.ctx=e,this.id=Mi(this),this.group=new ls({name:"legend",zIndex:16}),this.itemSelection=ci.select(this.group,qo),this.containerNode=this.group.appendChild(new Di({name:"legend-container"})),this.oldSize=[0,0],this.pages=[],this.maxPageSize=[0,0],this.paginationTrackingIndex=0,this.truncatedItems=new Set,this._data=[],this.toggleSeries=!0,this.item=new Yl,this.listeners=new kI,this.enabled=!1,this.position="bottom",this.border=new cr(this.containerNode),this.cornerRadius=0,this.fillOpacity=1,this.padding=4,this.spacing=0,this.cleanup=new pt,this.size=[0,0],this._visible=!0,this.pagination=new xh(i=>e.updateService.update(i),i=>this.updatePageNumber(i)),this.pagination.attachPagination(this.group);const{items:t}=e.contextMenuRegistry.builtins;t["toggle-series-visibility"].action=i=>this.contextToggleVisibility(i),t["toggle-other-series"].action=i=>this.contextToggleOtherSeries(i),this.cleanup.register(e.eventsHub.on("legend:change",this.onLegendDataChange.bind(this)),e.eventsHub.on("legend:change-partial",this.onLegendDataChangePartial.bind(this)),e.layoutManager.registerElement(1,i=>this.positionLegend(i)),e.eventsHub.on("locale:change",()=>this.onLocaleChanged()),()=>delete t["toggle-series-visibility"].action,()=>delete t["toggle-other-series"].action,()=>this.group.remove()),this.domProxy=new T3(this.ctx,this.id),this.ctx.historyManager.addMementoOriginator(e.legendManager)}set data(e){ii(e,this._data)||(this.domProxy.onDataUpdate(this._data,e),this._data=e,this.updateGroupVisibility())}get data(){return this._data}onLegendDataChange({legendData:e=[]}){this.enabled&&(this.data=e.filter(t=>!t.hideInLegend))}onLegendDataChangePartial(e){this.itemSelection.each(({proxyButton:t},{itemId:i})=>{if(t!=null)for(const s of e.legendData)s.itemId===i&&t.setChecked(s.enabled)})}destroy(){this.ctx.domManager.removeChild("canvas-overlay",`${this.id}-toolbar`),this.ctx.domManager.removeChild("canvas-overlay",`${this.id}-pagination`),this.cleanup.flush(),this.itemSelection.clear()}getOrientation(){return this.orientation??"horizontal"}set visible(e){this._visible=e,this.updateGroupVisibility()}get visible(){return this._visible}updateGroupVisibility(){this.group.visible=this.enabled&&this.visible&&this.data.length>0}isInteractive(){const{toggleSeries:e,listeners:{legendItemClick:t,legendItemDoubleClick:i}}=this;return e||i!=null||t!=null}attachLegend(e){e.appendChild(this.group)}getItemLabel(e){const{formatter:t}=this.item.label;if(t){const i=e.datum;return this.cachedCallWithContext(t,{itemId:e.itemId,value:e.label.text,seriesId:e.seriesId,...i&&{datum:i}})}return e.label.text}calcLayout(e,t){const{paddingX:i,paddingY:s,label:n,maxWidth:o,label:{maxLength:a=1/0,fontStyle:r,fontWeight:l,fontSize:c,fontFamily:h}}=this.item,d=[...this.data];this.reverseOrder&&d.reverse(),this.itemSelection.update(d);const u=[],p=Ze(n),y=o??e*.8,{markerWidth:b,anyLineEnabled:x}=this.calculateMarkerWidth();if(this.itemSelection.each((w,T)=>{w.fontStyle=r,w.fontWeight=l,w.fontSize=c,w.fontFamily=h;const O=this.updateMarkerLabel(w,T,b,x),E=T.itemId??T.id,z=this.getItemLabel(T),F=Pe(z,"<unknown>").replace(Ya," ");w.text=this.truncate(F,a,y,O,p,E),u.push(w.getTextMeasureBBox())}),e=Math.max(1,e),t=Math.max(1,t),!Number.isFinite(e))return{};[e,t]=this.updateContainer(e,t);const v=this.size,S=this.oldSize;v[0]=e,v[1]=t,(v[0]!==S[0]||v[1]!==S[1])&&(S[0]=v[0],S[1]=v[1]);const{pages:M,maxPageHeight:D,maxPageWidth:k}=this.updatePagination(u,e,t),I=this.pages;this.pages=M,this.maxPageSize=[k-i,D-s];const A=this.pagination.currentPage,C=this.pages[A];return this.pages.length<1||!C?(this.visible=!1,{oldPages:I}):(this.visible=!0,this.updatePositions(A),this.update(),{oldPages:I})}isCustomMarker(e,t){return e&&t!==void 0&&typeof t!="string"}calcSymbolsEnabled(e){const{showSeriesStroke:t,marker:i}=this.item,s=!!i.enabled||!t||(e.marker.enabled??!0),n=!!(e.line&&t),o=this.isCustomMarker(s,e.marker.shape);return{markerEnabled:s,lineEnabled:n,isCustomMarker:o}}calcSymbolsLengths(e,t,i){const{marker:s,line:n}=this.item;let o;const{shape:a}=e.marker;if(this.isCustomMarker(t,a)){const c=new ki;c.shape=a,c.updatePath();const h=c.getBBox();o=Math.max(h.width,h.height)}const r=t?s.size:0,l=i?n.length??25:0;return{markerLength:r,lineLength:l,customMarkerSize:o}}calculateMarkerWidth(){let e=0,t=!1;return this.itemSelection.each((i,s)=>{const{symbol:n}=s,{lineEnabled:o,markerEnabled:a}=this.calcSymbolsEnabled(n),{markerLength:r,lineLength:l,customMarkerSize:c=-1/0}=this.calcSymbolsLengths(n,a,o);e=Math.max(e,l,c,r),t||(t=o)}),{markerWidth:e,anyLineEnabled:t}}updateMarkerLabel(e,t,i,s){const{marker:n,paddingX:o}=this.item,{symbol:a}=t;let r=o;const{markerEnabled:l,isCustomMarker:c}=this.calcSymbolsEnabled(a),h=n.padding;(l||s)&&(r+=h+i);const{marker:d,line:u}=e;return d.visible=l,d.visible&&(d.shape=n.shape??a.marker.shape??"square",d.size=n.size,d.setStyleProperties(this.getMarkerStyles(Re(a)))),u.visible=s,u.visible&&u.setStyleProperties(this.getLineStyles(a)),e.length=i,e.spacing=h,e.isCustomMarker=c,r}updateContainer(e,t){const i=this.getContainerStyles();return this.containerNode.width=0,this.containerNode.height=0,this.containerNode.setStyleProperties(i),this.containerNode.cornerRadius=i.cornerRadius,e-=i.strokeWidth*2+i.padding.left+i.padding.right,t-=i.strokeWidth*2+i.padding.top+i.padding.bottom,[e,t]}truncate(e,t,i,s,n,o){let a=!1;e.length>t&&(e=e.substring(0,t),a=!0);const r=xl(e,n,i-s,a);return sl(r)?this.truncatedItems.add(o):this.truncatedItems.delete(o),r}updatePagination(e,t,i){const s=this.getOrientation(),n=Math.min(this.paginationTrackingIndex,e.length);this.pagination.orientation=s,this.pagination.translationX=0,this.pagination.translationY=0;const{pages:o,maxPageHeight:a,maxPageWidth:r,paginationBBox:l,paginationVertical:c}=this.calculatePagination(e,t,i),h=o.findIndex(S=>S.endIndex>=n);this.pagination.currentPage=ge(0,h,o.length-1);const{paddingX:d,paddingY:u}=this.item,p=8,f=r-d,y=a-u;let b=0,x=-l.y-this.item.marker.size/2;c?x+=y+p:(b+=-l.x+f+p,x+=(y-l.height)/2),this.pagination.translationX=b,this.pagination.translationY=x,this.pagination.update(),this.pagination.updateMarkers();let v=0;return this.itemSelection.each((S,M,D)=>{D>(o[v]?.endIndex??1/0)&&v++,S.pageIndex=v}),{maxPageHeight:a,maxPageWidth:r,pages:o}}calculatePagination(e,t,i){const{paddingX:s,paddingY:n}=this.item,o=["left","left-top","left-bottom","right","right-top","right-bottom"],{placement:a}=ll(this.position),r=this.getOrientation(),l=o.includes(a);let c=this.pagination.getBBox(),h=new re(0,0,0,0),d=[],u=0,p=0,f=0;const y=x=>x.width===c.width&&x.height===c.height,b=this.maxWidth!==void 0&&this.maxHeight!==void 0;do{if(f++>10){j.warn("unable to find stable legend layout.");break}c=h;const x=t-(l?0:c.width),v=i-(l?c.height:0),S=I3({orientation:r,bboxes:e,maxHeight:v,maxWidth:x,itemPaddingY:n,itemPaddingX:s,forceResult:b});d=S?.pages??[],u=S?.maxPageWidth??0,p=S?.maxPageHeight??0;const M=d.length;if(this.pagination.visible=M>1,this.pagination.totalPages=M,this.pagination.update(),this.pagination.updateMarkers(),h=this.pagination.getBBox(),!this.pagination.visible)break}while(!y(h));return{maxPageWidth:u,maxPageHeight:p,pages:d,paginationBBox:h,paginationVertical:l}}updatePositions(e=0){const{item:{paddingY:t},itemSelection:i,pages:s}=this;if(s.length<1||!s[e])return;const{columns:n,startIndex:o,endIndex:a}=s[e];let r=0,l=0;const c=n.length,h=n[0].indices.length,d=this.getOrientation()==="horizontal",u=n[0].bboxes[0].height+t,p=[];i.each((f,y,b)=>{if(b<o||b>a){f.visible=!1;return}const x=b-o;let v,S;d?(v=x%c,S=Math.floor(x/c)):(v=Math.floor(x/h),S=x%h),f.visible=!0;const M=n[v];M&&(l=Math.floor(u*S),r=Math.floor(p[S]??0),p[S]=(p[S]??0)+M.columnWidth,f.translationX=r,f.translationY=l)})}updatePageNumber(e){const{itemSelection:t,group:i,pagination:s,pages:n}=this,{startIndex:o,endIndex:a}=n[e];o===0?this.paginationTrackingIndex=0:e===n.length-1?this.paginationTrackingIndex=a:this.paginationTrackingIndex=Math.floor((o+a)/2),this.pagination.update(),this.pagination.updateMarkers(),this.updatePositions(e),this.domProxy.onPageChange({itemSelection:t,group:i,pagination:s,interactive:this.isInteractive()}),this.ctx.updateService.update(7)}update(){const{label:{color:e}}=this.item;this.itemSelection.each((t,i)=>{t.setEnabled(i.enabled),t.color=e}),this.updateContextMenu()}updateContextMenu(){const e=this.toggleSeries?"show":"hide";this.ctx.contextMenuRegistry.toggle("toggle-series-visibility",e),this.ctx.contextMenuRegistry.toggle("toggle-other-series",e)}getLineStyles(e){const{stroke:t,strokeOpacity:i=1,strokeWidth:s,lineDash:n}=e.line??{},o=Math.min(2,s??1);return{stroke:t,strokeOpacity:i,strokeWidth:this.item.line.strokeWidth??o,lineDash:n}}getMarkerStyles({marker:e}){const{fill:t,stroke:i,strokeOpacity:s=1,fillOpacity:n=1,strokeWidth:o,lineDash:a,lineDashOffset:r}=e,l=Math.min(2,o??1);return Tn(t)&&(t.width=8,t.height=8,t.padding=1,t.strokeWidth=Math.min(2,t.strokeWidth??2)),zo(t)&&(t.fit="contain",t.width=void 0,t.height=void 0,t.repeat="no-repeat"),hD({fill:t,stroke:i,strokeOpacity:s,fillOpacity:n,strokeWidth:this.item.marker.strokeWidth??l,lineDash:a,lineDashOffset:r},z2,B2,_2)}getContainerStyles(){const{stroke:e,strokeOpacity:t,strokeWidth:i}=this.border,{cornerRadius:s,fill:n,fillOpacity:o,padding:a}=this,r=typeof a=="number";return hD({cornerRadius:s,fill:n,fillOpacity:o,padding:{top:r?a:a.top??0,right:r?a:a.right??0,bottom:r?a:a.bottom??0,left:r?a:a.left??0},stroke:e,strokeOpacity:t,strokeWidth:this.border.enabled?i:0},z2,B2,_2)}computePagedBBox(){const e=Oe.computeChildrenBBox(this.group.excludeChildren({name:"legend-container"}));if(this.pages.length>1){const[s,n]=this.maxPageSize;e.height=Math.max(n,e.height),e.width=Math.max(s,e.width)}const{strokeWidth:t,padding:i}=this.getContainerStyles();return e.grow(i).grow(t),e}findNode(e){const{datum:t,proxyButton:i}=this.itemSelection.select(s=>s.datum?.itemId===e.itemId)[0]??{};if(t===void 0||i===void 0)throw new Error(`AG Charts - Missing required properties { datum: ${t}, proxyButton: ${JSON.stringify(i)} }`);return{datum:t,proxyButton:i}}contextToggleVisibility(e){const{datum:t,proxyButton:i}=this.findNode(e);this.doClick(e.event,t,i),this.updateHighlight()}contextToggleOtherSeries(e){this.doDoubleClick(e.event,this.findNode(e).datum),this.updateHighlight()}onContextClick(e,t){const{sourceEvent:i}=e,s=t.datum;this.updateHighlight(),this.preventHidingAll&&this.contextMenuDatum?.enabled&&this.getVisibleItemCount()<=1?this.ctx.contextMenuRegistry.builtins.items["toggle-series-visibility"].enabled=!1:this.ctx.contextMenuRegistry.builtins.items["toggle-series-visibility"].enabled=!0;const o=this.ctx.chartService.series.length>1&&this.ctx.chartService.series[0]?.getLegendData("category")[0]?.hideToggleOtherSeries!==!0?"show":"hide";this.ctx.contextMenuRegistry.toggle("toggle-other-series",o);const{offsetX:a,offsetY:r}=i,{x:l,y:c}=Kt.toCanvasPoint(t,a,r);this.ctx.contextMenuRegistry.dispatchContext("legend-item",{widgetEvent:e,canvasX:l,canvasY:c},{legendItem:s})}onClick(e,t,i){this.doClick(e,t,i)&&e.preventDefault()}getVisibleItemCount(){return this.ctx.chartService.series.flatMap(e=>e.getLegendData("category")).filter(e=>e.enabled).length}doClick(e,t,i){const{listeners:{legendItemClick:s},ctx:{chartService:n,highlightManager:o},preventHidingAll:a,toggleSeries:r}=this;if(!t)return!1;const{legendType:l,seriesId:c,itemId:h,enabled:d,legendItemName:u}=t,p=n.series.find(b=>b.id===c);if(!p)return!1;let f=d;const y=F2("click",t,e);return s&&as([p.properties,this.ctx.chartService],s,y.apiEvent),y.defaultPrevented||(r&&(f=!d,a&&!f&&this.getVisibleItemCount()<2&&(f=!0),i.setChecked(f),this.ctx.eventsHub.emit("legend:item-click",{legendType:l,series:p,itemId:h,enabled:f,legendItemName:u})),f?o.updateHighlight(this.id,{series:p,itemId:h,datum:void 0,datumIndex:typeof h=="number"?h:void 0,legendItemName:u}):o.updateHighlight(this.id),this.ctx.legendManager.update(),this.ctx.updateService.update(2,{forceNodeDataRefresh:!0,skipAnimations:t.skipAnimations??!1})),!0}onDoubleClick(e,t){this.doDoubleClick(e,t)&&e.preventDefault()}doDoubleClick(e,t){const{listeners:{legendItemDoubleClick:i},ctx:{chartService:s},toggleSeries:n}=this;if(!t)return!1;const{legendType:o,id:a,itemId:r,seriesId:l}=t,c=s.series.find(d=>d.id===a);if(!c)return!1;const h=F2("dblclick",t,e);if(i&&as([c.properties,this.ctx.chartService],i,h.apiEvent),h.defaultPrevented)return!0;if(n){const d=s.series.flatMap(y=>y.getLegendData("category"));let u=0;const p=new Set;for(const y of d)y.enabled&&(u+=1,y.legendItemName!=null&&p.add(y.legendItemName));p.size>0&&(u=p.size);const f=d.find(y=>y.itemId===r&&y.seriesId===l);this.ctx.eventsHub.emit("legend:item-double-click",{legendType:o,series:c,itemId:r,numVisibleItems:u,enabled:f?.enabled??!1,legendItemName:f?.legendItemName})}return this.ctx.legendManager.update(),this.ctx.updateService.update(2,{forceNodeDataRefresh:!0}),!0}toTooltipMeta(e,t){let i;return e instanceof FocusEvent?i=Kt.toCanvas(t).computeCenter():(e.preventDefault(),i=Kt.toCanvasPoint(t,e.offsetX,e.offsetY)),{canvasX:i.x,canvasY:i.y,showArrow:!1}}onHover(e,t){if(!this.enabled)throw new Error("AG Charts - onHover handler called on disabled legend");this.pagination.setPage(t.pageIndex);const i=t.datum,s=i?this.ctx.chartService.series.find(n=>n.id===i?.id):void 0;if(i&&this.truncatedItems.has(i.itemId??i.id)){const n=this.toTooltipMeta(e,t);this.ctx.tooltipManager.updateTooltip(this.id,n,[{type:"structured",title:this.getItemLabel(i)}])}else this.ctx.tooltipManager.removeTooltip(this.id,void 0,!0);i?.enabled&&s?this.updateHighlight({series:s,itemId:i?.itemId,datum:void 0,datumIndex:typeof i?.itemId=="number"?i.itemId:void 0,legendItemName:i?.legendItemName}):this.updateHighlight()}onLeave(){this.ctx.tooltipManager.removeTooltip(this.id,void 0,!0),this.updateHighlight()}updateHighlight(e){this.ctx.interactionManager.isState(32)||e==null?this.ctx.highlightManager.updateHighlight(this.id,e):this.ctx.interactionManager.isState(2)&&(this.pendingHighlightDatum=e,this.ctx.animationManager.onBatchStop(()=>{this.ctx.highlightManager.updateHighlight(this.id,this.pendingHighlightDatum)}))}onLocaleChanged(){this.domProxy.onLocaleChanged(this.ctx.localeManager,this.itemSelection,this)}positionLegend(e){const t=this.positionLegendScene(e);this.positionLegendDOM(t)}positionLegendScene(e){if(!this.enabled||!this.data.length)return;const{placement:t,floating:i,xOffset:s,yOffset:n}=ll(this.position),o=i?new re(0,0,e.width,e.height):e.layoutBox,{x:a,y:r,width:l,height:c}=o,[h,d]=this.calculateLegendDimensions(o),{oldPages:u}=this.calcLayout(h,d),p=this.computePagedBBox();if(this.visible){let y=function(S){};var f=y;const b=this.spacing;let x,v;switch(t){case"top":x=(l-p.width)/2,v=0;break;case"bottom":x=(l-p.width)/2,v=c-p.height;break;case"right":x=l-p.width,v=(c-p.height)/2;break;case"left":x=0,v=(c-p.height)/2;break;case"top-right":case"right-top":x=l-p.width,v=0;break;case"top-left":case"left-top":x=0,v=0;break;case"bottom-right":case"right-bottom":x=l-p.width,v=c-p.height;break;case"bottom-left":case"left-bottom":x=0,v=c-p.height;break;default:y(t)}if(!i){let S,M;switch(t){case"top":case"top-right":case"top-left":S=p.height+b,M="top";break;case"bottom":case"bottom-right":case"bottom-left":S=p.height+b,M="bottom";break;case"left":case"left-top":case"left-bottom":S=p.width+b,M="left";break;case"right":case"right-top":case"right-bottom":S=p.width+b,M="right";break;default:y(t)}o.shrink(S,M)}x+=s,v+=n,this.group.translationX=Math.floor(a+x-p.x),this.group.translationY=Math.floor(r+v-p.y),this.containerNode.x=p.x,this.containerNode.y=p.y,this.containerNode.width=p.width,this.containerNode.height=p.height}return u}positionLegendDOM(e){const{ctx:t,itemSelection:i,pagination:s,pages:n,group:o}=this,a=this.visible&&this.enabled,r=this.isInteractive();this.domProxy.update({visible:a,interactive:r,ctx:t,itemSelection:i,group:o,pagination:s,oldPages:e,newPages:n,datumReader:this,itemListener:this})}calculateLegendDimensions(e){const{width:t,height:i}=e,{placement:s}=ll(this.position),n=t/i,o=.5,a=.2,r=.25;let l,c;function h(d){}switch(s){case"top":case"top-left":case"top-right":case"bottom":case"bottom-left":case"bottom-right":{const d=n<1?Math.min(o,a*(1/n)):a;l=this.maxWidth?Math.min(this.maxWidth,t):t,c=this.maxHeight?Math.min(this.maxHeight,i):Math.round(i*d);break}case"left":case"left-top":case"left-bottom":case"right":case"right-top":case"right-bottom":{const d=n>1?Math.min(o,r*n):r;l=this.maxWidth?Math.min(this.maxWidth,t):Math.round(t*d),c=this.maxHeight?Math.min(this.maxHeight,i):i;break}default:}return[l,c]}cachedCallWithContext(e,t){const{callbackCache:i,chartService:s}=this.ctx;return i.call([this,s],e,t)}};ui.className="Legend",g([m],ui.prototype,"toggleSeries",2),g([m],ui.prototype,"pagination",2),g([m],ui.prototype,"item",2),g([m],ui.prototype,"listeners",2),g([Wt((e,t,i)=>{if(e.updateGroupVisibility(),t===i)return;const{ctx:{legendManager:s,stateManager:n}}=e;i===!1&&t===!0&&n.restoreState(s)}),m],ui.prototype,"enabled",2),g([m],ui.prototype,"position",2),g([m],ui.prototype,"maxWidth",2),g([m],ui.prototype,"maxHeight",2),g([m],ui.prototype,"reverseOrder",2),g([m],ui.prototype,"orientation",2),g([m],ui.prototype,"preventHidingAll",2),g([m],ui.prototype,"border",2),g([m],ui.prototype,"cornerRadius",2),g([m],ui.prototype,"fill",2),g([m],ui.prototype,"fillOpacity",2),g([m],ui.prototype,"padding",2),g([m],ui.prototype,"spacing",2),g([m],ui.prototype,"xOffset",2),g([m],ui.prototype,"yOffset",2);var AI={type:"plugin",name:"legend",version:ue,options:{enabled:R,position:dd,orientation:Z("horizontal","vertical"),maxWidth:P,maxHeight:P,spacing:P,border:rl,cornerRadius:W,padding:al,fill:ks,fillOpacity:ce,preventHidingAll:R,reverseOrder:R,toggleSeries:R,item:{marker:{size:P,shape:Ja,padding:P,strokeWidth:P},line:{length:P,strokeWidth:P},label:{maxLength:P,formatter:ct,...Ke},maxWidth:P,paddingX:P,paddingY:P,showSeriesStroke:R},pagination:{marker:{size:P,shape:Ja,padding:P},activeStyle:{...se,...J},inactiveStyle:{...se,...J},highlightStyle:{...se,...J},label:Ke},listeners:{legendItemClick:ct,legendItemDoubleClick:ct}},themeTemplate:{...e1,enabled:{$and:[{$greaterThan:[{$size:{$path:"/series"}},1]},{$or:[{$isChartType:"cartesian"},{$isChartType:"standalone"},{$and:[{$isChartType:"polar"},{$not:{$isSeriesType:"pie"}},{$not:{$isSeriesType:"donut"}}]}]}]},position:"bottom",orientation:{$if:[{$or:[{$eq:[{$path:"./position"},"left"]},{$eq:[{$path:"./position"},"left-top"]},{$eq:[{$path:"./position"},"left-bottom"]},{$eq:[{$path:"./position"},"right"]},{$eq:[{$path:"./position"},"right-top"]},{$eq:[{$path:"./position"},"right-bottom"]},{$eq:[{$path:"./position/placement"},"left"]},{$eq:[{$path:"./position/placement"},"left-top"]},{$eq:[{$path:"./position/placement"},"left-bottom"]},{$eq:[{$path:"./position/placement"},"right"]},{$eq:[{$path:"./position/placement"},"right-top"]},{$eq:[{$path:"./position/placement"},"right-bottom"]}]},"vertical","horizontal"]},spacing:30,listeners:{},toggleSeries:!0,item:{paddingX:16,paddingY:8,marker:{size:15,padding:8},showSeriesStroke:!0,label:{color:{$ref:"textColor"},fontSize:{$rem:Si.SMALL},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"}}},reverseOrder:!1,pagination:{marker:{size:12},activeStyle:{fill:{$ref:"foregroundColor"}},inactiveStyle:{fill:{$ref:"subtleTextColor"}},highlightStyle:{fill:{$ref:"foregroundColor"}},label:{color:{$ref:"textColor"}}},fill:{$if:[{$path:["./position/floating",!1]},{$ref:"chartBackgroundColor"},"transparent"]}},create:e=>{const t=new ui(e);return t.attachLegend(e.scene),t}},Hu=class extends zn{normaliseDataDomain(e){const{min:t,max:i,preferredMin:s,preferredMax:n}=this,{extent:o,clipped:a}=Ec(e.domain,t,i,s,n,void 0,e.sortMetadata?.sortOrder);return o[0]<0&&o[1]>0||e.domain[0]<0&&e.domain[1]>0?(j.warn("The log axis domain crosses zero, the chart data cannot be rendered. See log axis documentation for more information."),{domain:[],clipped:a}):o[0]===0||o[1]===0||e.domain[0]===0||e.domain[1]===0?(j.warn("The log axis domain contains a value of 0, the chart data cannot be rendered. See log axis documentation for more information."),{domain:[],clipped:a}):{domain:o,clipped:a}}set base(e){this.scale.base=e}get base(){return this.scale.base}constructor(e){super(e,new HD)}};Hu.className="LogAxis",Hu.type="log";var N3=10;function ib(e,t,i,s,n,o,a){const r=e[o];if(r==null)return-1;const l=Number.isFinite(t)?kn(r,t,i,a):Lc(o,e.length),c=eg(l,n);return o===s[c+Hs]||o===s[c+js]||o===s[c+Ws]||o===s[c+$s]?c:-1}function V2(e,t,i,s,n,o,a,r,l){let c=0,h=0,d=-1;for(let b=0;b<a;b++){const x=ib(e,t,i,s,n,b,o);x!==-1&&(c++,x!==d&&(h++,d=x))}h++;const u=r?.length===c?r:new Uint32Array(c),p=l?.length===h?l:new Uint32Array(h);let f=0,y=0;d=-1;for(let b=0;b<a;b++){const x=ib(e,t,i,s,n,b,o);x!==-1&&(x!==d&&(p[y++]=f,d=x),u[f++]=b)}return p[y]=c-1,{indices:u,metaIndices:p}}function CI(e,t,i,s){const n=t.length;if(n<ua)return;const[o,a]=e,{xNeedsValueOf:r,yNeedsValueOf:l,existingFilters:c}=s;let h=pa(t,o,a,{xNeedsValueOf:r});const d=c?.find(x=>x.maxRange===h);let{indexData:u,valueData:p}=ga(t,i,i,o,a,h,{xNeedsValueOf:r,yNeedsValueOf:l,reuseIndexData:d?.indexData,reuseValueData:d?.valueData}),{indices:f,metaIndices:y}=V2(t,o,a,u,h,r,n,d?.indices,d?.metaIndices);const b=[{maxRange:h,metaIndices:y,indices:f,indexData:u,valueData:p}];for(;f.length>N3&&h>ar;){const x=h,v=Math.trunc(x/2),S=c?.find(E=>E.maxRange===v),M=hl(u,p,x,{reuseIndexData:S?.indexData,reuseValueData:S?.valueData});h=M.maxRange,u=M.indexData,p=M.valueData;const D=f;let k=0,I=0,A=-1;for(let E=0;E<D.length;E++){const z=D[E],F=ib(t,o,a,u,h,z,r);F!==-1&&(k++,F!==A&&(I++,A=F))}I++;const C=S?.indices?.length===k?S.indices:new Uint32Array(k),w=S?.metaIndices?.length===I?S.metaIndices:new Uint32Array(I);let T=0,O=0;A=-1;for(let E=0;E<D.length;E++){const z=D[E],F=ib(t,o,a,u,h,z,r);F!==-1&&(F!==A&&(w[O++]=T,A=F),C[T++]=z)}w[O]=k-1,f=C,y=w,b.push({maxRange:h,metaIndices:y,indices:f,indexData:u,valueData:p})}return b.reverse(),b}function O3(e,t,i,s){const n=t.length;if(n<ua)return;const[o,a]=e,{xNeedsValueOf:r,yNeedsValueOf:l,targetRange:c,existingFilters:h}=s,d=pa(t,o,a,{xNeedsValueOf:r}),u=Math.min(d,Cc(Math.max(c,ar))),p=h?.find(M=>M.maxRange===u),{indexData:f,valueData:y}=ga(t,i,i,o,a,u,{xNeedsValueOf:r,yNeedsValueOf:l,reuseIndexData:p?.indexData,reuseValueData:p?.valueData}),{indices:b,metaIndices:x}=V2(t,o,a,f,u,r,n,p?.indices,p?.metaIndices),v={maxRange:u,indices:b,metaIndices:x,indexData:f,valueData:y};function S(){return CI([o,a],t,i,{xNeedsValueOf:r,yNeedsValueOf:l,existingFilters:h})?.filter(D=>D.maxRange!==u)??[]}return{immediate:[v],computeRemaining:S}}function E3(e,t,i,s,n,o){const[a,r]=si(e,s);return CI([a,r],t,i,{xNeedsValueOf:n,yNeedsValueOf:o})}var P3=pr(E3);function R3(e,t,i,s,n,o){const a=t.resolveKeysById(n,"xValue",i),r=t.resolveColumnById(n,s,i),l=t.getDomain(n,"xValue","key",i),c=t.resolveColumnNeedsValueOf(n,"xValue",i),h=t.resolveColumnNeedsValueOf(n,s,i);if(o){const[d,u]=si(e,l);return CI([d,u],a,r,{xNeedsValueOf:c,yNeedsValueOf:h,existingFilters:o})}return P3(e,a,r,l,c,h)}function F3(e,t,i,s,n,o,a){const r=t.resolveKeysById(n,"xValue",i),l=t.resolveColumnById(n,s,i),c=t.getDomain(n,"xValue","key",i),h=t.resolveColumnNeedsValueOf(n,"xValue",i),d=t.resolveColumnNeedsValueOf(n,s,i),[u,p]=si(e,c);return O3([u,p],r,l,{xNeedsValueOf:h,yNeedsValueOf:d,targetRange:o,existingFilters:a})}var pi=class extends Zo{constructor(){super(...arguments),this.xName=void 0,this.fill="#c16068",this.fillOpacity=1,this.stroke="#874349",this.strokeWidth=2,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.interpolation=new dl,this.shadow=new Ta,this.marker=new Xs,this.label=new Yt,this.tooltip=yh(),this.connectMissingData=!1}};g([m],pi.prototype,"xKey",2),g([m],pi.prototype,"xName",2),g([m],pi.prototype,"yKey",2),g([m],pi.prototype,"yName",2),g([m],pi.prototype,"yFilterKey",2),g([m],pi.prototype,"normalizedTo",2),g([m],pi.prototype,"fill",2),g([m],pi.prototype,"fillOpacity",2),g([m],pi.prototype,"stroke",2),g([m],pi.prototype,"strokeWidth",2),g([m],pi.prototype,"strokeOpacity",2),g([m],pi.prototype,"lineDash",2),g([m],pi.prototype,"lineDashOffset",2),g([m],pi.prototype,"interpolation",2),g([m],pi.prototype,"styler",2),g([m],pi.prototype,"shadow",2),g([m],pi.prototype,"marker",2),g([m],pi.prototype,"label",2),g([m],pi.prototype,"tooltip",2),g([m],pi.prototype,"connectMissingData",2);var z3=.125,B3=.25,LI=class extends Wl{constructor(e){super({moduleCtx:e,propertyKeys:Fu,propertyNames:zu,categoryKey:"xValue",pathsPerSeries:["fill","stroke"],pathsZIndexSubOrderOffset:[0,1e3],datumSelectionGarbageCollection:!1,segmentedDataNodes:!1,pickModes:[2,0],animationResetFns:{path:rI({getVisible:()=>this.visible,getOpacity:()=>this.getOpacity()}),label:mh,datum:(t,i)=>({...Vx(t),...pf(t,i)})},clipFocusBox:!1}),this.properties=new pi,this.connectsToYAxis=!0,this.aggregationManager=new Kx,this.backgroundGroup=new Oe({name:`${this.id}-background`,zIndex:0}),this._isStacked=void 0,this.fillSpans=[],this.phantomSpans=[],this.strokeSpans=[]}get pickModeAxis(){return"main"}renderToOffscreenCanvas(){return super.renderToOffscreenCanvas()||this.contextNodeData!=null&&(this.contextNodeData.fillData.spans.length>UD||this.contextNodeData.strokeData.spans.length>UD)}attachSeries(e,t,i){super.attachSeries(e,t,i),e.appendChild(this.backgroundGroup)}detachSeries(e,t,i){super.detachSeries(e,t,i),this.backgroundGroup.remove()}attachPaths([e,t]){this.backgroundGroup.appendChild(e),this.contentGroup.appendChild(t),t.zIndex=-1}detachPaths([e,t]){e.remove(),t.remove()}isStacked(){return(this.seriesGrouping?.stackCount??1)>1}isNormalized(){return this.properties.normalizedTo!=null}setSeriesIndex(e){const i=this.isStacked()===this._isStacked;return this._isStacked=i,super.setSeriesIndex(e,i)}setZIndex(e){super.setZIndex(e),this.isStacked()?(this.backgroundGroup.zIndex=[0,e],this.contentGroup.zIndex=[1,e,0]):(this.backgroundGroup.zIndex=[1,e,0,0],this.contentGroup.zIndex=[1,e,0,1])}async processData(e){if(this.data==null)return;const{data:t,visible:i,seriesGrouping:{groupIndex:s=this.id,stackCount:n=1}={}}=this,{xKey:o,yKey:a,yFilterKey:r,connectMissingData:l,normalizedTo:c}=this.properties,h=!this.ctx.animationManager.isSkipped(),d=this.axes.x?.scale,u=this.axes.y?.scale,{xScaleType:p,yScaleType:f}=this.getScaleInformation({xScale:d,yScale:u}),y=n>1||c!=null,b={value:`area-stack-${s}-yValue`,marker:`area-stack-${s}-yValues-marker`},x={invalidValue:null};(St(c)||l)&&n>1&&(x.invalidValue=0),i||(x.forceValue=0);const v=[Ll(o,p,{id:"xValue"}),Ct(a,f,{id:"yValueRaw",...x}),...r==null?[]:[Ct(r,f,{id:"yFilterRaw"})]];y&&v.push(...Pg(a,"normal",{id:"yValueCumulative",...x,groupId:b.marker},f)),St(c)&&v.push(Ct(a,f,{id:"yValue",...x,groupId:b.value}),nx(Object.values(b),c)),h&&v.push(Fg());const{dataModel:S,processedData:M}=await this.requestDataModel(e,t,{props:v,groupByKeys:y,groupByData:!y});this.aggregateData(S,M),this.animationState.transition("updateData")}xCoordinateRange(e,t){const{marker:i}=this.properties,s=this.axes.x.scale.convert(e),n=i.enabled?.5*i.size*t:0;return[s-n,s+n]}yCoordinateRange(e,t){const{marker:i}=this.properties,s=this.axes.y.scale.convert(e[0]),n=i.enabled?.5*i.size*t:0;return[s-n,s+n]}yValueKey(){return this.isNormalized()?"yValue":"yValueRaw"}yCumulativeKey(e){return e.type==="grouped"?"yValueCumulative":this.yValueKey()}getSeriesDomain(e){const{dataModel:t,processedData:i,axes:s}=this;if(!t||!i)return{domain:[]};const n=s.y;if(e==="x"){const a=t.resolveProcessedDataDefById(this,"xValue"),r=t.getDomain(this,"xValue","key",i);return a?.def.type==="key"&&a.def.valueType==="category"?r:{domain:ln(Ro(r.domain))}}const o=this.domainForClippedRange("y",[this.yCumulativeKey(i)],"xValue");if(n instanceof zn&&!(n instanceof Hu)){const a=Number.isFinite(o[1]-o[0])?[Math.min(o[0],0),Math.max(o[1],0)]:[];return{domain:ln(a)}}else return{domain:ln(o)}}getSeriesRange(e,t){const[i,s]=this.domainForVisibleRange("y",[this.yCumulativeKey(this.processedData)],"xValue",t);return[Math.min(i,0),Math.max(s,0)]}getZoomRangeFittingItems(e,t,i){return this.zoomFittingVisibleItems("xValue",[this.yCumulativeKey(this.processedData)],e,t,i)}getVisibleItems(e,t,i){return this.countVisibleItems("xValue",[this.yCumulativeKey(this.processedData)],e,t,i)}aggregateData(e,t){if(this.aggregationManager.markStale(),lo(t))return;const i=this.axes.x;if(i==null)return;const s=this.estimateTargetRange();this.aggregationManager.aggregate({computePartial:o=>F3(i.scale.type,e,t,this.yCumulativeKey(t),this,s,o),computeFull:o=>R3(i.scale.type,e,t,this.yCumulativeKey(t),this,o),targetRange:s});const n=this.aggregationManager.filters;n&&n.length>0&&Jn.record(`${this.type}:aggregation`,n.map(o=>o.maxRange))}estimateTargetRange(){const e=this.axes.x;if(e?.scale?.range){const[t,i]=e.scale.range;return Math.abs(i-t)}return this.ctx.scene?.canvas?.width??800}stackAggregatedData(e){const{indices:t,metaIndices:i}=e,{visible:s,axes:n,dataModel:o,processedData:a,seriesBelowStackContext:r}=this,l=n.x,c=n.y;if(!s)return this.phantomSpans=[],this.fillSpans=[],this.strokeSpans=[],r;if(l==null||c==null||o==null||a==null)return;const{scale:h}=l,{scale:d}=c,u=(h.bandwidth??0)/2,p=!this.isStacked()&&this.properties.connectMissingData,f=a.invalidData?.get(this.id),y=o.resolveKeysById(this,"xValue",a),b=o.resolveColumnById(this,this.yCumulativeKey(a),a);let[x,v]=zg(1,i.length-1,l.range,I=>{const A=i[I],C=i[I+1],w=t[A],T=t[C],O=y[w],E=y[T],{0:z}=this.xCoordinateRange(O,0),{1:F}=this.xCoordinateRange(E,0);return[z,F]});x=Math.max(x-1,0),v=Math.min(v+1,i.length-1);let S=[];if(r?.fillSpans)S=r?.fillSpans;else for(let I=x;I<v;I+=1){const A=i[I],C=i[I+1],w=t[A],T=t[C],O=y[w],E=y[T],z={type:"linear",moveTo:!1,x0:h.convert(O)+u,y0:d.convert(0),x1:h.convert(E)+u,y1:d.convert(0)};S.push({span:z,xValue0:O,xValue1:E,yValue0:0,yValue1:0})}this.phantomSpans=S;const M=[],D=[];let k=0;for(let I=x;I<v;I+=1){const A=i[I],C=i[I+1],w=t[A],T=t[C],O=!p&&this.hasInvalidDatumsInRange(f,b,w,T),E=S[k++];if(O){M.push(E),D.push(E);continue}const z=[];for(let Y=A;Y<=C;Y++){const X=t[Y];if(f?.[X])continue;const q=b[X];if(!Number.isFinite(q))continue;const te=y[X];z.push({point:{x:h.convert(te)+u,y:d.convert(q)},xDatum:te,yDatum:q})}if(z.length<2){M.push(E),D.push(E);continue}const F=z[0],_=z.at(-1),G=z.slice(1,-1).map(Y=>Y.point),V={span:{type:"multi-line",moveTo:!1,x0:F.point.x,y0:F.point.y,x1:_.point.x,y1:_.point.y,midPoints:G},xValue0:F.xDatum,xValue1:_.xDatum,yValue0:F.yDatum,yValue1:_.yDatum};M.push(V),D.push(V)}return this.fillSpans=M,this.strokeSpans=D,{stack:[],fillSpans:M,strokeSpans:D}}hasInvalidDatumsInRange(e,t,i,s){const n=Math.min(i,s),o=Math.max(i,s);for(let a=n;a<=o;a++){if(e?.[a])return!0;const r=t[a];if(!Number.isFinite(r))return!0}return!1}stackYValueData(){const{visible:e,axes:t,dataModel:i,processedData:s,seriesBelowStackContext:n,properties:o}=this,a=t.x,r=t.y;if(a==null||r==null||i==null||s==null)return;const{interpolation:l}=o,{scale:c}=a,{scale:h}=r,d=(c.bandwidth??0)/2;let u=i.resolveKeysById(this,"xValue",s),p=i.resolveColumnById(this,this.yValueKey(),s);const f=!this.isStacked()&&this.properties.connectMissingData,y=s.invalidKeys?.get(this.id),x=(f?s.invalidData?.get(this.id):void 0)??y;x!=null&&(u=u.filter((T,O)=>x[O]===!1),p=p.filter((T,O)=>x[O]===!1));let[v,S]=zg(1,u.length,a.range,T=>this.xCoordinateRange(u[T],0));v=Math.max(v-2,0),S=Math.min(S+2,u.length);let M;if(n?.fillSpans)M=n?.fillSpans;else{const T=[];for(let O=v;O<S;O+=1){const E=u[O];T.push({point:{x:c.convert(E)+d,y:h.convert(0)},xDatum:E,yDatum:0})}M=lf(T,{type:"linear"})}if(this.phantomSpans=M,!e)return this.fillSpans=M,this.strokeSpans=[],n;let D=n?.stack;if(D==null){D=[];for(let T=v;T<S-1;T+=1)D.push({leading:0,trailing:0,dataValid:!0,breakBefore:!1})}const k=D.slice();let I=!1;for(let T=0;T<k.length;T+=1){const O=v+T,E=v+T+1;let{leading:z,trailing:F,breakBefore:_}=D[T];const G=p[O],B=p[E],V=!Number.isFinite(G),Y=!Number.isFinite(B),X=!V&&!Y;X&&(z+=G,F+=B),T!==0&&X!==I&&(_=!0),I=X,k[T]={leading:z,trailing:F,dataValid:X,breakBefore:_}}const A=[],C=[],w=[];for(let T=0;T<k.length;T+=1){const{leading:O,dataValid:E,breakBefore:z}=k[T],F=v+T;if(z){if(w.length!==0){const _=k[T-1],G={point:{x:c.convert(u[F])+d,y:h.convert(_.trailing)},xDatum:u[F],yDatum:_.trailing};w.push(G);const B=lf(w,l);A.push(...B),C.push(...B)}w.length=0}if(E){const _={point:{x:c.convert(u[F])+d,y:h.convert(O)},xDatum:u[F],yDatum:O};w.push(_)}else A.push(M[T])}if(w.length!==0){const T=k.at(-1),O=v+k.length,E={point:{x:c.convert(u[O])+d,y:h.convert(T.trailing)},xDatum:u[O],yDatum:T.trailing};w.push(E);const z=lf(w,l);A.push(...z),C.push(...z),w.length=0}return this.fillSpans=A,this.strokeSpans=C,{stack:k,fillSpans:A,strokeSpans:C}}createStackContext(){const e=this.axes.x;if(e==null)return;const{scale:t}=e,[i,s]=t.range,n=Math.abs(s-i);this.aggregationManager.ensureLevelForRange(n);const o=this.aggregationManager.getFilterForRange(n);return o?this.stackAggregatedData(o):this.stackYValueData()}createNodeDatumContext(e,t){const{dataModel:i,processedData:s}=this;if(!i||!s)return;const{xKey:n,xName:o,yFilterKey:a,yKey:r,yName:l,legendItemName:c,marker:h,label:d,fill:u,stroke:p,normalizedTo:f}=this.properties,y=e.scale,b=t.scale,{isContinuousY:x}=this.getScaleInformation({xScale:y,yScale:b}),v=s.type==="grouped",[S,M]=y.range,D=Math.abs(M-S);this.aggregationManager.ensureLevelForRange(D);const k=this.aggregationManager.getFilterForRange(D),I=this.contextNodeData?.nodeData,A=I!=null&&(s.changeDescription!=null||!lo(s)||k!=null);return{rawData:s.dataSources.get(this.id)?.data??[],xValues:i.resolveKeysById(this,"xValue",s),yRawValues:i.resolveColumnById(this,"yValueRaw",s),yCumulativeValues:v?i.resolveColumnById(this,"yValueCumulative",s):i.resolveColumnById(this,"yValueRaw",s),yFilterValues:a==null?void 0:i.resolveColumnById(this,"yFilterRaw",s),invalidData:s.invalidData?.get(this.id),xScale:y,yScale:b,xOffset:(y.bandwidth??0)/2,indices:k?.indices,isContinuousY:x,labelsEnabled:d.enabled,normalizedTo:f,canIncrementallyUpdate:A,xKey:n,yKey:r,xName:o,yName:l,legendItemName:c,markerSize:h.size,markerFill:h.fill??u,markerStroke:h.stroke??p,markerStrokeWidth:h.strokeWidth??this.properties.strokeWidth,yDomain:this.getSeriesDomain("y").domain,markerData:A?I:[],labelData:[],nodeIndex:0,crossFiltering:!1}}computeMarkerCoordinate(e,t){let i;(St(e.normalizedTo)?e.isContinuousY&&Bc(t.yDatum):!Number.isNaN(t.yDatum))&&(i=t.yCumulative),t.x=e.xScale.convert(t.xDatum)+e.xOffset,t.y=e.yScale.convert(i)}handleDatum(e,t,i){if(t.xDatum=e.xValues[i],t.xDatum!=null){if(t.datum=e.rawData[i],t.yDatum=e.yRawValues[i],t.yCumulative=+e.yCumulativeValues[i],t.validPoint=Number.isFinite(t.yDatum)&&e.invalidData?.[i]!==!0,this.computeMarkerCoordinate(e,t),t.selected=e.yFilterValues==null?void 0:e.yFilterValues[i]===t.yDatum,t.selected===!1&&(e.crossFiltering=!0),t.validPoint){if(e.canIncrementallyUpdate&&e.nodeIndex<e.markerData.length){const n=e.markerData[e.nodeIndex];n.datum=t.datum,n.datumIndex=i,n.midPoint={x:t.x,y:t.y},n.cumulativeValue=t.yCumulative,n.yValue=t.yDatum,n.xValue=t.xDatum,n.point={x:t.x,y:t.y,size:e.markerSize},n.selected=t.selected}else e.markerData.push({series:this,itemId:e.yKey,datum:t.datum,datumIndex:i,midPoint:{x:t.x,y:t.y},cumulativeValue:t.yCumulative,yValue:t.yDatum,xValue:t.xDatum,yKey:e.yKey,xKey:e.xKey,point:{x:t.x,y:t.y,size:e.markerSize},fill:e.markerFill,stroke:e.markerStroke,strokeWidth:e.markerStrokeWidth,selected:t.selected});e.nodeIndex++}if(e.labelsEnabled&&t.validPoint){const s=this.getLabelText(t.yDatum,t.datum,e.yKey,"y",e.yDomain,this.properties.label,{value:t.yDatum,datum:t.datum,xKey:e.xKey,yKey:e.yKey,xName:e.xName,yName:e.yName,legendItemName:e.legendItemName});e.labelData.push({series:this,itemId:e.yKey,datum:t.datum,datumIndex:i,x:t.x,y:t.y,labelText:s})}}}createNodeData(){const{axes:e,data:t,processedData:i}=this,s=e.x,n=e.y;if(!s||!n||!t||!i)return;const o=this.createNodeDatumContext(s,n);if(!o)return;const a={datum:void 0,xDatum:void 0,yDatum:void 0,yCumulative:0,selected:void 0,x:0,y:0,validPoint:!1};let[r,l]=this.visibleRangeIndices("xValue",s.range,o.indices);r=Math.max(r-2,0),l=Math.min(l+2,o.indices?.length??o.xValues.length),i.input.count<1e3&&(r=0,l=i.input.count);for(let u=r;u<l;u+=1){const p=o.indices?.[u]??u;this.handleDatum(o,a,p)}o.canIncrementallyUpdate&&o.nodeIndex<o.markerData.length&&(o.markerData.length=o.nodeIndex);const{visibleSameStackCount:c}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this),h=Ox(this.properties.segmentation,s,n,this.chart.seriesRect,this.ctx.scene,!1);return{itemId:o.yKey,fillData:{spans:this.fillSpans,phantomSpans:this.phantomSpans},strokeData:{spans:this.strokeSpans},labelData:o.labelData,nodeData:o.markerData,scales:this.calculateScaling(),visible:this.visible,stackVisible:c>0,crossFiltering:o.crossFiltering,styles:Hx(this,this.properties,this.properties.marker),segments:h}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}updatePathNodes(e){const{paths:[t,i],visible:s,animationEnabled:n}=e,o=this.contextNodeData?.crossFiltering===!0,a=this.contextNodeData?.segments,r=oe(this.getHighlightStyle(),this.getStyle()),{strokeWidth:l,stroke:c,strokeOpacity:h,lineDash:d,lineDashOffset:u,fill:p,fillOpacity:f,opacity:y}=r;i.setProperties({segments:a,fill:void 0,lineCap:"round",lineJoin:"round",pointerEvents:1,stroke:c,strokeWidth:l,strokeOpacity:h*(o?B3:1),lineDash:d,lineDashOffset:u,opacity:y,visible:s||n}),i.datum=a,t.setStyleProperties({fill:p,stroke:void 0,fillOpacity:f*(o?z3:1)},this.getShapeFillBBox()),t.setProperties({segments:a,lineJoin:"round",pointerEvents:1,fillShadow:this.properties.shadow,opacity:y,visible:s||n}),t.datum=a,Wx(this,i),Wx(this,t)}updatePaths(e){this.updateAreaPaths(e.paths,e.contextData)}updateAreaPaths(e,t){for(const i of e)i.visible=t.visible;if(t.visible)this.updateFillPath(e,t),this.updateStrokePath(e,t);else for(const i of e)i.path.clear(),i.markDirty("AreaSeries")}updateFillPath(e,t){const[i]=e;i.path.clear(),l2(i,t.fillData),i.markDirty("AreaSeries")}updateStrokePath(e,t){const{spans:i}=t.strokeData,[,s]=e;s.path.clear(),qD(s,i),s.markDirty("AreaSeries")}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e,{contextNodeData:s,processedData:n,axes:o,properties:a}=this,{marker:r,styler:l}=a,c=l?this.getStyle().marker:void 0,h=s?.crossFiltering===!0||oI(n.input.count,o.x.scale,r,c);r.isDirty()&&(i.clear(),i.cleanup());const d=h?t:[];return lo(this.processedData)?i.update(d,void 0,u=>cs(u.xValue)):i.update(d)}updateDatumStyles(e){const{datumSelection:t,isHighlight:i}=e,{marker:s}=this.properties,n=this.ctx.highlightManager.getActiveHighlight();t.each((o,a)=>{if(!t.isGarbage(o)){const r=this.getHighlightState(n,e.isHighlight,a.datumIndex),l=this.getStyle(r),{stroke:c,strokeWidth:h,strokeOpacity:d}=l,u=this.makeItemStylerParams(this.dataModel,this.processedData,a.datumIndex,l.marker);a.style=this.getMarkerStyle(s,a,u,{isHighlight:i,highlightState:r},l.marker,{stroke:c,strokeWidth:h,strokeOpacity:d})}})}updateDatumNodes(e){const{contextNodeData:t}=this;if(!t)return;const{datumSelection:i,isHighlight:s}=e,n=this.getShapeFillBBox(),o=this.ctx.highlightManager.getActiveHighlight();i.each((a,r)=>{const l=r.style??t.styles[this.getHighlightState(o,s,r.datumIndex)];this.applyMarkerStyle(l,a,r.point,n,{selected:r.selected})}),s||this.properties.marker.markClean()}updateLabelSelection(e){return e.labelSelection.update(this.isLabelEnabled()?e.labelData:[])}updateLabelNodes(e){const{isHighlight:t=!1}=e,i=this.ctx.highlightManager?.getActiveHighlight(),s=this.makeLabelFormatterParams();e.labelSelection.each((n,o)=>{const a=fh(this,o,s,this.properties.label,t,i),{enabled:r,fontStyle:l,fontWeight:c,fontSize:h,fontFamily:d,color:u}=a;r&&o?.labelText?(n.fontStyle=l,n.fontWeight=c,n.fontSize=h,n.fontFamily=d,n.textAlign="center",n.textBaseline="bottom",n.text=o.labelText,n.x=o.x,n.y=o.y-10,n.fill=u,n.visible=!0,n.fillOpacity=this.getHighlightStyle(t,o.datumIndex).opacity??1,n.setBoxing(a)):n.visible=!1})}makeStylerParams(e){const{id:t}=this,{marker:i,fill:s,fillOpacity:n,lineDash:o,lineDashOffset:a,stroke:r,strokeOpacity:l,strokeWidth:c,xKey:h,yKey:d}=this.properties,u=lu(e??0);return{marker:{fill:i.fill,fillOpacity:i.fillOpacity,size:i.size,shape:i.shape,stroke:i.stroke,strokeOpacity:i.strokeOpacity,strokeWidth:i.strokeWidth,lineDash:i.lineDash,lineDashOffset:i.lineDashOffset},highlightState:u,fill:s,fillOpacity:n,lineDash:o,lineDashOffset:a,seriesId:t,stroke:r,strokeOpacity:l,strokeWidth:c,xKey:h,yKey:d}}makeItemStylerParams(e,t,i,s){const{xKey:n,yKey:o}=this.properties,a=e.resolveKeysById(this,"xValue",t)[i],r=e.resolveColumnById(this,"yValueRaw",t)[i],l=e.getDomain(this,"xValue","key",t).domain,c=e.getDomain(this,this.yCumulativeKey(t),"value",t).domain,h=this.filterItemStylerFillParams(s.fill)??s.fill;return{...KM(a,r,n,o,l,c),xValue:a,yValue:r,...s,fill:h}}makeLabelFormatterParams(){const{xKey:e,xName:t,yKey:i,yName:s,legendItemName:n}=this.properties;return{xKey:e,xName:t,yKey:i,yName:s,legendItemName:n}}getTooltipContent(e){const{id:t,dataModel:i,processedData:s,axes:n,properties:o}=this,{xKey:a,xName:r,yKey:l,yName:c,tooltip:h,legendItemName:d}=o,u=n.x,p=n.y;if(!i||!s||!u||!p)return;const f=s.dataSources.get(this.id)?.data?.[e],y=i.resolveKeysById(this,"xValue",s)[e],b=i.resolveColumnById(this,"yValueRaw",s)[e];if(y==null)return;const x=this.getStyle(),v=this.makeItemStylerParams(i,s,e,x.marker),S=this.getMarkerStyle(this.properties.marker,{datumIndex:e,datum:f},v,{isHighlight:!1},x.marker);return this.formatTooltipWithContext(h,{heading:this.getAxisValueText(u,"tooltip",y,f,a,d),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:l,value:this.getAxisValueText(p,"tooltip",b,f,l,d),missing:Jc(b)}]},{seriesId:t,datum:f,title:c,xKey:a,xName:r,yKey:l,yName:c,...S,...this.getModuleTooltipParams()})}legendItemSymbol(){const{fill:e,stroke:t,fillOpacity:i,strokeOpacity:s,strokeWidth:n,lineDash:o,marker:a}=this.getStyle(),r=!a.enabled||a.fill==null,l=r?e:a.fill;return{marker:{...this.getMarkerStyle(this.properties.marker,{},void 0,{isHighlight:!1,checkForHighlight:!1},{size:a.size,shape:a.shape,fill:l,fillOpacity:r?i:a.fillOpacity,stroke:a.stroke}),enabled:a.enabled||n<=0},line:{enabled:!0,stroke:t,strokeOpacity:s,strokeWidth:n,lineDash:o}}}getLegendData(e){if(e!=="category")return[];const{id:t,ctx:{legendManager:i},visible:s}=this,{yKey:n,yName:o,legendItemName:a,showInLegend:r}=this.properties;return[{legendType:e,id:t,itemId:n,legendItemName:a,seriesId:t,enabled:s&&i.getItemEnabled({seriesId:t,itemId:n}),label:{text:a??o??n},symbol:this.legendItemSymbol(),hideInLegend:!r}]}resetDatumAnimation(e){nI([e.datumSelection])}animateEmptyUpdateReady(e){const{datumSelection:t,labelSelection:i,contextData:s,paths:n}=e,{animationManager:o}=this.ctx;this.updateAreaPaths(n,s),aI(this,o,...n),Ui([t],pf),sI(this,o,t),qt(this,"labels",o,i)}animateReadyResize(e){const{contextData:t,paths:i}=e;this.updateAreaPaths(i,t),super.animateReadyResize(e)}animateWaitingUpdateReady(e){const{animationManager:t}=this.ctx,{datumSelection:i,labelSelection:s,contextData:n,paths:o,previousContextData:a}=e,[r,l]=o;if(n.visible===!1&&a?.visible===!1||r==null&&l==null)return;this.resetDatumAnimation(e),this.resetLabelAnimation(e);const c=()=>{this.resetPathAnimation(e),this.updateAreaPaths(o,n)},h=()=>{t.skipCurrentBatch(),c()};if(n==null||a==null){c(),uf(this,t,"added",i),jx(this,"fill_path_properties",t,"add",r),jx(this,"stroke_path_properties",t,"add",l),qt(this,"labels",t,s);return}if(n.crossFiltering!==a.crossFiltering){h();return}const d=jK(n,a);if(d===void 0){h();return}else if(d.status==="no-op")return;uf(this,t,void 0,i),li(this.id,"fill_path_properties",t,[r],d.fill.pathProperties),Yx(this.id,"fill_path_update",t,[r],d.fill.path),li(this.id,"stroke_path_properties",t,[l],d.stroke.pathProperties),Yx(this.id,"stroke_path_update",t,[l],d.stroke.path),qt(this,"labels",t,s),this.ctx.animationManager.animate({id:this.id,groupId:"reset_after_animation",phase:"trailing",from:{},to:{},onComplete:()=>this.updateAreaPaths(o,n)})}isLabelEnabled(){return this.properties.label.enabled}nodeFactory(){return new ki}getStyle(e){const{styler:t,marker:i,fill:s,fillOpacity:n,lineDash:o,lineDashOffset:a,stroke:r,strokeOpacity:l,strokeWidth:c}=this.properties,{size:h,shape:d,fill:u="transparent",fillOpacity:p}=i;let f={};if(t){const y=this.makeStylerParams(e),b=this.cachedCallWithContext(t,y)??{};f=this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],b,{pick:!1})??{}}return f.marker??(f.marker={}),{fill:f.fill??s,fillOpacity:f.fillOpacity??n,lineDash:f.lineDash??o,lineDashOffset:f.lineDashOffset??a,stroke:f.stroke??r,strokeOpacity:f.strokeOpacity??l,strokeWidth:f.strokeWidth??c,marker:{enabled:f.marker.enabled??i.enabled,fill:f.marker.fill??u,fillOpacity:f.marker.fillOpacity??p,shape:f.marker.shape??d,size:f.marker.size??h,lineDash:f.marker.lineDash??i.lineDash??o,lineDashOffset:f.marker.lineDashOffset??i.lineDashOffset??a,stroke:f.marker.stroke??i.stroke??r,strokeOpacity:f.marker.strokeOpacity??i.strokeOpacity??l,strokeWidth:f.marker.strokeWidth??i.strokeWidth??c}}}getFormattedMarkerStyle(e){const t=this.getStyle(),i=this.makeItemStylerParams(this.dataModel,this.processedData,e.datumIndex,t.marker);return this.getMarkerStyle(this.properties.marker,e,i,{isHighlight:!0},void 0,t)}computeFocusBounds(e){return Gx(this,e)}hasItemStylers(){return this.properties.styler!=null||this.properties.marker.itemStyler!=null||this.properties.label.itemStyler!=null}};LI.className="AreaSeries",LI.type="area";var _3={series:{nodeClickRange:"nearest",fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",Fl],["image",Ar],["pattern",Pn]]},stroke:{$palette:"stroke"},fillOpacity:.8,strokeOpacity:1,strokeWidth:{$isUserOption:["./stroke",2,0]},lineDash:[0],lineDashOffset:0,shadow:{enabled:!1,color:fa,xOffset:3,yOffset:3,blur:5},interpolation:{type:"linear"},marker:{enabled:!1,shape:"circle",size:7,strokeWidth:{$isUserOption:["./stroke",1,0]},fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",$g],["pattern",Pn]]},stroke:{$palette:"stroke"}},label:{...ka,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},tooltip:{range:{$path:["/tooltip/range","nearest"]},position:{anchorTo:{$path:["/tooltip/position/anchorTo","node"]}}},highlight:mD(),segmentation:yx}},wI={type:"series",name:"area",chartType:"cartesian",stackable:!0,version:ue,dependencies:[oi],options:MD,predictAxis:sf,defaultAxes:{y:{type:"number",position:"left"},x:{type:"category",position:"bottom"}},axisKeys:{x:"xKeyAxis",y:"yKeyAxis"},themeTemplate:_3,create:e=>new LI(e)},V3=.001,TI=class extends Di{constructor(){super(...arguments),this.direction="x",this.featherRatio=0}setStaticProperties(e,t,i,s,n,o,a,r,l,c){this.__direction=l??"x",this.__featherRatio=c??0,super.setStaticProperties(e,t,i,s,n,o,a,r)}get feathered(){return Math.abs(this.featherRatio)>V3}isPointInPath(e,t){return this.feathered?this.getBBox().containsPoint(e,t):super.isPointInPath(e,t)}updatePath(){if(!this.feathered){super.updatePath();return}const{path:e,borderPath:t,__direction:i,__featherRatio:s,__x:n,__y:o,__width:a,__height:r}=this;if(e.clear(),t.clear(),i==="x"){const l=Math.abs(s)*a;s>0?(e.moveTo(n,o),e.lineTo(n+a-l,o),e.lineTo(n+a,o+r/2),e.lineTo(n+a-l,o+r),e.lineTo(n,o+r),e.closePath()):(e.moveTo(n+l,o),e.lineTo(n+a,o),e.lineTo(n+a,o+r),e.lineTo(n+l,o+r),e.lineTo(n,o+r/2),e.closePath())}else{const l=Math.abs(s)*r;s>0?(e.moveTo(n,o+l),e.lineTo(n+a/2,o),e.lineTo(n+a,o+l),e.lineTo(n+a,o+r),e.lineTo(n,o+r),e.closePath()):(e.moveTo(n,o),e.lineTo(n+a,o),e.lineTo(n+a,o+r-l),e.lineTo(n+a/2,o+r),e.lineTo(n,o+r-l),e.closePath())}}renderStroke(e){if(!this.feathered){super.renderStroke(e);return}const{__stroke:t,__strokeWidth:i,__lineDash:s,__lineDashOffset:n,__lineCap:o,__lineJoin:a,path:r}=this;if(t&&i){const{globalAlpha:l}=e;this.applyStrokeAndAlpha(e),e.lineWidth=i,s&&e.setLineDash(s),n&&(e.lineDashOffset=n),o&&(e.lineCap=o),a&&(e.lineJoin=a),e.stroke(r.getPath2D()),e.globalAlpha=l}}};g([_e()],TI.prototype,"direction",2),g([_e()],TI.prototype,"featherRatio",2);function NI(e,t,i,s,n){if(t.length<ua)return;const[o,a]=e,{smallestKeyInterval:r,xNeedsValueOf:l,yNeedsValueOf:c,existingFilters:h}=n;let d=pa(t,o,a,{smallestKeyInterval:r,xNeedsValueOf:l});const u=h?.find(M=>M.maxRange===d);let{indexData:p,valueData:f,negativeIndexData:y,negativeValueData:b}=ga(t,s,i??s,o,a,d,{split:!0,xNeedsValueOf:l,yNeedsValueOf:c,reuseIndexData:u?.positiveIndexData,reuseValueData:u?.positiveValueData,reuseNegativeIndexData:u?.negativeIndexData,reuseNegativeValueData:u?.negativeValueData});if(!y||!b)throw new Error("Negative aggregation data missing in split mode");let x=No(d,p,u?.positiveIndices),v=No(d,y,u?.negativeIndices);const S=[{maxRange:d,positiveIndices:x,positiveIndexData:p,positiveValueData:f,negativeIndices:v,negativeIndexData:y,negativeValueData:b}];for(;d>64;){const M=d,D=Math.trunc(M/2),k=h?.find(C=>C.maxRange===D),I=hl(p,f,M,{reuseIndexData:k?.positiveIndexData,reuseValueData:k?.positiveValueData}),A=hl(y,b,M,{reuseIndexData:k?.negativeIndexData,reuseValueData:k?.negativeValueData});d=I.maxRange,p=I.indexData,f=I.valueData,x=I.midpointData??No(d,p,k?.positiveIndices),y=A.indexData,b=A.valueData,v=A.midpointData??No(d,y,k?.negativeIndices),S.push({maxRange:d,positiveIndices:x,positiveIndexData:p,positiveValueData:f,negativeIndices:v,negativeIndexData:y,negativeValueData:b})}return S.reverse(),S}function G3(e,t,i,s,n){if(t.length<ua)return;const[o,a]=e,{smallestKeyInterval:r,xNeedsValueOf:l,yNeedsValueOf:c,targetRange:h,existingFilters:d}=n,u=pa(t,o,a,{smallestKeyInterval:r,xNeedsValueOf:l}),p=Math.min(u,Cc(Math.max(h,ar))),f=d?.find(D=>D.maxRange===p),{indexData:y,valueData:b,negativeIndexData:x,negativeValueData:v}=ga(t,s,i??s,o,a,p,{split:!0,xNeedsValueOf:l,yNeedsValueOf:c,reuseIndexData:f?.positiveIndexData,reuseValueData:f?.positiveValueData,reuseNegativeIndexData:f?.negativeIndexData,reuseNegativeValueData:f?.negativeValueData});if(!x||!v)throw new Error("Negative aggregation data missing in split mode");const S={maxRange:p,positiveIndices:No(p,y,f?.positiveIndices),positiveIndexData:y,positiveValueData:b,negativeIndices:No(p,x,f?.negativeIndices),negativeIndexData:x,negativeValueData:v};function M(){return NI([o,a],t,i,s,{smallestKeyInterval:r,xNeedsValueOf:l,yNeedsValueOf:c,existingFilters:d})?.filter(k=>k.maxRange!==p)??[]}return{immediate:[S],computeRemaining:M}}function H3(e,t,i,s,n,o,a,r){const[l,c]=si(e,n);return NI([l,c],t,i,s,{smallestKeyInterval:o,xNeedsValueOf:a,yNeedsValueOf:r})}var j3=pr(H3);function W3(e,t,i,s,n){const o=t.resolveKeysById(s,"xValue",i),a=t.hasColumnById(s,"yValue-start"),r=a?t.resolveColumnById(s,"yValue-start",i):void 0,l=a?t.resolveColumnById(s,"yValue-end",i):t.resolveColumnById(s,"yValue-raw",i),c=t.getDomain(s,"xValue","key",i),h=t.resolveColumnNeedsValueOf(s,"xValue",i),d=t.resolveColumnNeedsValueOf(s,a?"yValue-end":"yValue-raw",i);if(n){const[u,p]=si(e,c);return NI([u,p],o,r,l,{smallestKeyInterval:i.reduced?.smallestKeyInterval,xNeedsValueOf:h,yNeedsValueOf:d,existingFilters:n})}return j3(e,o,r,l,c,i.reduced?.smallestKeyInterval,h,d)}function $3(e,t,i,s,n,o){const a=t.resolveKeysById(s,"xValue",i),r=t.hasColumnById(s,"yValue-start"),l=r?t.resolveColumnById(s,"yValue-start",i):void 0,c=r?t.resolveColumnById(s,"yValue-end",i):t.resolveColumnById(s,"yValue-raw",i),h=t.getDomain(s,"xValue","key",i),d=t.resolveColumnNeedsValueOf(s,"xValue",i),u=t.resolveColumnNeedsValueOf(s,r?"yValue-end":"yValue-raw",i),[p,f]=si(e,h);return G3([p,f],a,l,c,{smallestKeyInterval:i.reduced?.smallestKeyInterval,xNeedsValueOf:d,yNeedsValueOf:u,targetRange:n,existingFilters:o})}var OI=class extends Yt{constructor(){super(...arguments),this.placement="inside-center",this.spacing=0}};g([m],OI.prototype,"placement",2),g([m],OI.prototype,"spacing",2);var Vt=class extends YD{constructor(){super(...arguments),this.fill="#c16068",this.fillOpacity=1,this.stroke="#874349",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.crisp=void 0,this.shadow=new Ta,this.label=new OI,this.tooltip=yh(),this.sparklineMode=!1}};g([m],Vt.prototype,"xKey",2),g([m],Vt.prototype,"xName",2),g([m],Vt.prototype,"yKey",2),g([m],Vt.prototype,"yName",2),g([m],Vt.prototype,"yFilterKey",2),g([m],Vt.prototype,"stackGroup",2),g([m],Vt.prototype,"normalizedTo",2),g([m],Vt.prototype,"fill",2),g([m],Vt.prototype,"fillOpacity",2),g([m],Vt.prototype,"stroke",2),g([m],Vt.prototype,"strokeWidth",2),g([m],Vt.prototype,"strokeOpacity",2),g([m],Vt.prototype,"lineDash",2),g([m],Vt.prototype,"lineDashOffset",2),g([m],Vt.prototype,"cornerRadius",2),g([m],Vt.prototype,"crisp",2),g([m],Vt.prototype,"styler",2),g([m],Vt.prototype,"itemStyler",2),g([m],Vt.prototype,"simpleItemStyler",2),g([m],Vt.prototype,"shadow",2),g([m],Vt.prototype,"label",2),g([m],Vt.prototype,"tooltip",2),g([m],Vt.prototype,"sparklineMode",2);var EI=class extends VO{constructor(e){super({moduleCtx:e,propertyKeys:Fu,propertyNames:zu,categoryKey:"xValue",pickModes:[2,1,0],pathsPerSeries:[],datumSelectionGarbageCollection:!1,animationAlwaysUpdateSelections:!0,animationResetFns:{datum:df,label:mh}}),this.properties=new Vt,this.connectsToYAxis=!0,this.aggregationManager=new Kx,this.phantomGroup=this.contentGroup.appendChild(new Oe({name:"phantom",zIndex:-1})),this.phantomSelection=ci.select(this.phantomGroup,()=>this.nodeFactory(),!1),this.phantomHighlightGroup=this.highlightGroup.appendChild(new Oe({name:`${this.internalId}-highlight-node`})),this.phantomHighlightSelection=ci.select(this.phantomHighlightGroup,()=>this.nodeFactory(),!1),this.phantomGroup.opacity=.2,this.phantomHighlightGroup.opacity=.2}get pickModeAxis(){return this.properties.sparklineMode?"main":void 0}crossFilteringEnabled(){return this.properties.yFilterKey!=null&&(this.seriesGrouping==null||this.seriesGrouping.stackIndex===0)}async processData(e){if(!this.data)return;const{xKey:t,yKey:i,yFilterKey:s,normalizedTo:n}=this.properties,{seriesGrouping:{groupIndex:o=this.id}={},data:a}=this,l=(this.seriesGrouping?.stackCount??0)>1||n!=null,c=l,h=!this.ctx.animationManager.isSkipped(),d=this.getCategoryAxis()?.scale,u=this.getValueAxis()?.scale,{isContinuousX:p,xScaleType:f,yScaleType:y}=this.getScaleInformation({xScale:d,yScale:u}),b=`bar-stack-${o}-yValues`,x=`${b}-trailing`,v=this.visible?{}:{forceValue:0},S=[Ll(t,f,{id:"xValue"}),Ct(i,y,{id:"yValue-raw",invalidValue:null,...v})];this.crossFilteringEnabled()&&S.push(Ct(s,y,{id:"yFilterValue",invalidValue:null,...v})),l&&S.push(...Pg(i,"normal",{id:"yValue-end",rangeId:"yValue-range",invalidValue:null,missingValue:0,groupId:b,separateNegative:!0,...v},y),...Pg(i,"trailing",{id:"yValue-start",invalidValue:null,missingValue:0,groupId:x,separateNegative:!0,...v},y)),p&&S.push(_T,VT),$e(n)&&S.push(nx([b,x],Math.abs(n))),this.needsDataModelDiff()&&this.processedData&&S.push(ax(this.id,this.processedData)),(h||!c)&&S.push(Fg());const{dataModel:M,processedData:D}=await this.requestDataModel(e,a,{props:S,groupByKeys:c,groupByData:!c});this.aggregateData(M,D),this.smallestDataInterval=D.reduced?.smallestKeyInterval,this.largestDataInterval=D.reduced?.largestKeyInterval,this.animationState.transition("updateData")}yCumulativeKey(e){return e.hasColumnById(this,"yValue-end")?"yValue-end":"yValue-raw"}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(i==null||t==null)return{domain:[]};if(e===this.getCategoryDirection()){const r=i.resolveProcessedDataDefById(this,"xValue"),l=i.getDomain(this,"xValue","key",t);return r?.def.type==="key"&&r.def.valueType==="category"?l:{domain:this.padBandExtent(l.domain)}}const s=this.yCumulativeKey(i);let n=this.domainForClippedRange(e,[s],"xValue");const o=this.crossFilteringEnabled()?i.getDomain(this,"yFilterValue","value",t).domain:void 0;o!=null&&(n=[Math.min(n[0],o[0]),Math.max(n[1],o[1])]);const a=this.getValueAxis();if(a instanceof zn&&!(a instanceof Hu)){const r=Number.isFinite(n[1]-n[0])?[Math.min(0,n[0]),Math.max(0,n[1])]:[];return{domain:ln(r)}}else return{domain:ln(n)}}getSeriesRange(e,t){if((this.properties.direction==="horizontal"?"x":"y")!==e)return[];const s=this.yCumulativeKey(this.dataModel),[n,o]=this.domainForVisibleRange("y",[s],"xValue",t);return[Math.min(n,0),Math.max(o,0)]}getZoomRangeFittingItems(e,t,i){const s=this.yCumulativeKey(this.dataModel);return this.zoomFittingVisibleItems("xValue",[s],e,t,i)}getVisibleItems(e,t,i){const s=this.yCumulativeKey(this.dataModel);return this.countVisibleItems("xValue",[s],e,t,i)}aggregateData(e,t){if(this.aggregationManager.markStale(),lo(t))return;const i=this.axes.x;if(i==null)return;const s=this.estimateTargetRange();this.aggregationManager.aggregate({computePartial:o=>$3(i.scale.type,e,t,this,s,o),computeFull:o=>W3(i.scale.type,e,t,this,o),targetRange:s});const n=this.aggregationManager.filters;n&&n.length>0&&Jn.record(`${this.type}:aggregation`,n.map(o=>o.maxRange))}estimateTargetRange(){const e=this.axes.x;if(e?.scale?.range){const[t,i]=e.scale.range;return Math.abs(i-t)}return this.ctx.scene?.canvas?.width??800}createNodeDatumContext(e,t){const{dataModel:i,processedData:s,groupScale:n}=this;if(!i||!s)return;const o=s.dataSources?.get(this.id);if(o==null)return;const a=e.scale,r=t.scale,{barWidth:l,groupIndex:c}=this.updateGroupScale(e),h=Math.abs(a.range[1]-a.range[0]);this.aggregationManager.ensureLevelForRange(h);const d=this.aggregationManager.getFilterForRange(h),u=i.hasColumnById(this,"yValue-start"),{label:p}=this.properties,f=this.contextNodeData?.nodeData!=null&&(s.changeDescription!=null||!lo(s)||d!=null);return{rawData:o,xValues:i.resolveKeysById(this,"xValue",s),yRawValues:i.resolveColumnById(this,"yValue-raw",s),yFilterValues:this.crossFilteringEnabled()?i.resolveColumnById(this,"yFilterValue",s):void 0,yStartValues:u?i.resolveColumnById(this,"yValue-start",s):void 0,yEndValues:u?i.resolveColumnById(this,"yValue-end",s):void 0,xScale:a,yScale:r,xAxis:e,yAxis:t,groupOffset:n.convert(String(c)),barOffset:yt.is(a)?l*-.5:0,barWidth:l,range:h,yReversed:t.isReversed(),bboxBottom:r.convert(0),labelSpacing:p.spacing+(typeof p.padding=="number"?p.padding:0),crisp:d==null&&(this.properties.crisp??r2(e?.scale,e?.visibleRange,this.smallestDataInterval,this.largestDataInterval)),isStacked:u,animationEnabled:!this.ctx.animationManager.isSkipped(),dataAggregationFilter:d,canIncrementallyUpdate:f,phantomNodes:f?this.contextNodeData.phantomNodeData??[]:[],nodes:f?this.contextNodeData.nodeData:[],labels:f?this.contextNodeData.nodeData:[],nodeIndex:0,phantomIndex:0,barAlongX:this.getBarDirection()==="x",shouldFlipXY:this.shouldFlipXY(),xKey:this.properties.xKey,yKey:this.properties.yKey,xName:this.properties.xName,yName:this.properties.yName,legendItemName:this.properties.legendItemName,label:p,yDomain:this.getSeriesDomain("y").domain}}computeXPosition(e,t){return e.xScale.convert(e.xValues[t])+e.groupOffset+e.barOffset}prepareNodeDatumState(e,t,i,s,n){if(!Number.isFinite(n))return;const o=e.xValues[i];if(o==null)return;const a=e.rawData?.data[i],r=e.yRawValues[i],l=e.yFilterValues==null?void 0:Number(e.yFilterValues[i]);if(l!=null&&!Number.isFinite(l))return;const c=e.label.enabled&&r!=null?this.getLabelText(l??r,a,e.yKey,"y",e.yDomain,e.label,{datum:a,value:l??r,xKey:e.xKey,yKey:e.yKey,xName:e.xName,yName:e.yName,legendItemName:e.legendItemName}):void 0,h=r>=0&&!Object.is(r,-0);return t.datum=a,t.xValue=o,t.yRawValue=r,t.yFilterValue=l,t.labelText=c,t.inset=l!=null&&l>r,t.isPositive=h,t.precomputedBottomY=l==null?void 0:e.yScale.convert(s),t.precomputedIsUpward=l==null?void 0:h!==e.yReversed,t}createSkeletonNodeDatum(e,t,i){const s=t.nodeDatumScratch;return{series:this,itemId:i?cs(e.yKey,i):e.yKey,datum:s.datum,datumIndex:t.datumIndex,cumulativeValue:0,phantom:i,xValue:s.xValue??"",yValue:0,yKey:e.yKey,xKey:e.xKey,capDefaults:{lengthRatioMultiplier:0,lengthMax:0},x:0,y:0,width:0,height:0,midPoint:{x:0,y:0},opacity:t.opacity,featherRatio:t.featherRatio,topLeftCornerRadius:!1,topRightCornerRadius:!1,bottomRightCornerRadius:!1,bottomLeftCornerRadius:!1,clipBBox:void 0,crisp:e.crisp,label:void 0,missing:!1,focusable:!i}}createNodeDatum(e,t){const i=this.prepareNodeDatumState(e,t.nodeDatumScratch,t.datumIndex,t.yStart,t.yEnd);if(!i)return{nodeData:void 0,phantomNodeData:void 0};const s=this.createSkeletonNodeDatum(e,t,!1);this.updateNodeDatum(e,s,t,i);let n;return i.yFilterValue!=null&&(n=this.createSkeletonNodeDatum(e,t,!0),this.updateNodeDatum(e,n,t)),{nodeData:s,phantomNodeData:n}}updateNodeDatum(e,t,i,s){if(s??(s=this.prepareNodeDatumState(e,i.nodeDatumScratch,i.datumIndex,i.yStart,i.yEnd)),!s)return;const n=t,o=t.phantom,a=i.yStart,r=o?s.yFilterValue:s.yFilterValue??s.yRawValue,l=o?s.yFilterValue:s.yFilterValue??i.yEnd,c=o?void 0:s.labelText;let h;o||s.yFilterValue==null?h=i.yEnd:h=i.yStart+s.yFilterValue;let d;o?d=i.yRange:d=Math.max(i.yStart+(s.yFilterValue??-1/0),i.yRange);let u;o?u=void 0:s.inset?u=.6:u=void 0;const p=s.precomputedIsUpward??s.isPositive!==e.yReversed,f=e.yScale.convert(h),y=s.precomputedBottomY??e.yScale.convert(a),b=e.yScale.convert(d),x=i.width*.5*(1-(u??1)),v=e.barAlongX?Math.min(f,y):i.x+x,S=e.barAlongX?i.x+x:Math.min(f,y),M=e.barAlongX?Math.abs(y-f):i.width*(u??1),D=e.barAlongX?i.width*(u??1):Math.abs(y-f),k=e.barAlongX?Math.min(e.bboxBottom,b):i.x+x,I=e.barAlongX?i.x+x:Math.min(e.bboxBottom,b),A=e.barAlongX?Math.abs(e.bboxBottom-b):i.width*(u??1),C=e.barAlongX?i.width*(u??1):Math.abs(e.bboxBottom-b);n.datum=s.datum,n.datumIndex=i.datumIndex,n.cumulativeValue=l,n.xValue=s.xValue,n.yValue=r,n.x=k,n.y=I,n.width=A,n.height=C;const w=n.midPoint;w.x=v+M/2,w.y=S+D/2;const T=e.shouldFlipXY?D:M;n.capDefaults.lengthRatioMultiplier=T,n.capDefaults.lengthMax=T,n.opacity=i.opacity,n.featherRatio=i.featherRatio,n.topLeftCornerRadius=e.barAlongX!==p,n.topRightCornerRadius=p,n.bottomRightCornerRadius=e.barAlongX===p,n.bottomLeftCornerRadius=!p;const O=n.clipBBox;if(O?(O.x=v,O.y=S,O.width=M,O.height=D):n.clipBBox=new re(v,S,M,D),n.crisp=e.crisp,c==null)n.label=void 0;else{const E=EO({isUpward:p,isVertical:!e.barAlongX,placement:e.label.placement,spacing:e.labelSpacing,rect:{x:v,y:S,width:M,height:D}}),z=n.label;z?(z.text=c,z.x=E.x,z.y=E.y,z.textAlign=E.textAlign,z.textBaseline=E.textBaseline):n.label={text:c,...E}}n.missing=Jc(r)}createNodeDataWithAggregation(e,t,i){const s=e.yReversed?-1:1;for(let n=0;n<2;n+=1){const o=n===0,a=o?e.dataAggregationFilter.positiveIndices:e.dataAggregationFilter.negativeIndices,r=o?e.dataAggregationFilter.positiveIndexData:e.dataAggregationFilter.negativeIndexData,l=o?Ws:$s,c=o?$s:Ws,h=this.visibleRangeIndices("xValue",e.xAxis.range,a),d=h[0],u=h[1];for(let p=d;p<u;p+=1){const f=p*In,y=r[f+Hs],b=r[f+js],x=r[f+l],v=r[f+c];if(y===cl||e.xValues[v]==null||e.xValues[x]==null)continue;const S=t(Math.trunc((y+b)/2)),M=Math.abs(t(b)-t(y))+e.barWidth;if(S-M<0||S>e.range)continue;const D=Math.abs(b-y)+1,k=Ma.is(e.xScale)?Math.min(e.xScale.bandwidth*Math.max(D-1,1)/(e.xScale.step*D),1):1;if(i.datumIndex=v,i.x=S,i.width=M,i.opacity=k,e.isStacked)i.yStart=Number(e.yStartValues[x]),i.yEnd=Number(e.yEndValues[v]),i.featherRatio=0;else{const I=Number(e.yRawValues[v]),A=Number(e.yRawValues[x]);i.yStart=0,i.yEnd=I,i.featherRatio=(o?1:-1)*s*(1-A/I)}i.yRange=i.yEnd,this.upsertNodeDatum(e,i)}}}createNodeDataGrouped(e,t,i){const s=this.processedData,n=s.invalidData?.get(this.id),o=e.barWidth,a=e.isStacked?this.dataModel.resolveProcessedDataIndexById(this,"yValue-range"):-1,r=s.columnScopes.findIndex(u=>u.has(this.id)),l=s.groups,c=zg(1,l.length,e.xAxis.range,u=>{const f=l[u].keys[0];return this.xCoordinateRange(f)}),h=c[0],d=c[1];for(let u=h;u<d;u+=1){const p=l[u],f=p.aggregation,y=p.datumIndices[r];if(y!=null)for(const b of y){const x=u+b,v=t(x);if(n?.[x]===!0)continue;const S=e.yRawValues[x];if(S==null)continue;const M=S>=0&&!Object.is(S,-0),D=e.isStacked?Number(e.yStartValues?.[x]):0,k=e.isStacked?Number(e.yEndValues?.[x]):S;let I=k;e.isStacked&&(I=f[a][M?1:0]),i.datumIndex=x,i.x=v,i.width=o,i.yStart=D,i.yEnd=k,i.yRange=I,i.featherRatio=0,i.opacity=1,this.upsertNodeDatum(e,i)}}}createNodeDataSimple(e,t,i){const s=this.processedData.invalidData?.get(this.id),n=e.barWidth,o=this.visibleRangeIndices("xValue",e.xAxis.range);let a=o[0],r=o[1];this.processedData.input.count<1e3&&(a=0,r=this.processedData.input.count);for(let l=a;l<r;l+=1){if(s?.[l]===!0)continue;const c=e.yRawValues[l];if(c==null)continue;const h=t(l),d=Number(c);i.datumIndex=l,i.x=h,i.width=n,i.yStart=0,i.yEnd=d,i.yRange=d,i.featherRatio=0,i.opacity=1,this.upsertNodeDatum(e,i)}}upsertNodeDatum(e,t){const i=e.canIncrementallyUpdate&&e.nodeIndex<e.nodes.length,s=e.yFilterValues!=null,n=s&&e.canIncrementallyUpdate&&e.phantomIndex<e.phantomNodes.length;let o,a;if(i)o=e.nodes[e.nodeIndex],this.updateNodeDatum(e,o,t),e.nodeIndex>=e.labels.length&&e.labels.push(o);else{const r=this.createNodeDatum(e,t);r.nodeData&&(e.nodes.push(r.nodeData),e.labels.push(r.nodeData)),a=r.phantomNodeData}if(e.nodeIndex++,!s)return{nodeData:e.nodes[e.nodeIndex]};if(n)a=e.phantomNodes[e.phantomIndex],this.updateNodeDatum(e,a,t);else if(a)e.phantomNodes.push(a);else{const r=this.createNodeDatum(e,t);r.phantomNodeData&&e.phantomNodes.push(r.phantomNodeData)}return e.phantomIndex++,{nodeData:o,phantomNodeData:a}}createNodeData(){const e=this.getCategoryAxis(),t=this.getValueAxis();if(!this.dataModel||!this.processedData||!e||!t)return;const i=this.createNodeDatumContext(e,t);if(!i)return;const s=a=>this.computeXPosition(i,a),n={nodeDatumScratch:{datum:void 0,xValue:void 0,yRawValue:0,yFilterValue:void 0,labelText:void 0,inset:!1,isPositive:!1,precomputedBottomY:void 0,precomputedIsUpward:void 0},datumIndex:0,x:0,width:0,yStart:0,yEnd:0,yRange:0,featherRatio:0,opacity:1};i.dataAggregationFilter!=null?this.createNodeDataWithAggregation(i,s,n):this.processedData.type==="grouped"?this.createNodeDataGrouped(i,s,n):this.createNodeDataSimple(i,s,n),i.canIncrementallyUpdate&&(i.nodeIndex<i.nodes.length&&(i.nodes.length=i.nodeIndex),i.phantomIndex<i.phantomNodes.length&&(i.phantomNodes.length=i.phantomIndex),i.labels.length>i.nodes.length&&(i.labels.length=i.nodes.length));const o=Ox(this.properties.segmentation,i.xAxis,i.yAxis,this.chart.seriesRect,this.ctx.scene);return{itemId:this.properties.yKey,nodeData:i.nodes,phantomNodeData:i.phantomNodes,labelData:i.labels,scales:this.calculateScaling(),visible:this.visible||i.animationEnabled,groupScale:this.getScaling(this.groupScale),styles:YM(this.getItemStyle.bind(this)),segments:o}}nodeFactory(){return new TI}updateSeriesSelections(){super.updateSeriesSelections(),this.phantomSelection=this.updateDatumSelection({nodeData:this.contextNodeData?.phantomNodeData??[],datumSelection:this.phantomSelection})}updateHighlightSelectionItem(e){const t=super.updateHighlightSelectionItem(e),i=this.ctx.highlightManager?.getActiveHighlight(),n=this.isSeriesHighlighted(i)&&i?.datum?i:void 0;return this.phantomHighlightSelection=this.updateDatumSelection({nodeData:n?this.getHighlightData(this.contextNodeData?.phantomNodeData??[],n)??[]:[],datumSelection:this.phantomHighlightSelection}),t}updateNodes(e,t){super.updateNodes(e,t),this.updateDatumNodes({datumSelection:this.phantomSelection,isHighlight:!1,drawingMode:"overlay"}),this.updateDatumNodes({datumSelection:this.phantomHighlightSelection,isHighlight:!0,drawingMode:"overlay"})}getHighlightData(e,t){const i=e.find(s=>s.datum===t.datum);return i==null?void 0:[{...i}]}updateDatumSelection(e){return lo(this.processedData)?e.datumSelection.update(e.nodeData,void 0,this.getDatumId.bind(this)):e.datumSelection.update(e.nodeData)}makeStylerParams(e){const{id:t}=this,{cornerRadius:i,fill:s,fillOpacity:n,lineDash:o,lineDashOffset:a,stackGroup:r,stroke:l,strokeOpacity:c,strokeWidth:h,xKey:d,yKey:u}=this.properties,p=lu(e??0);return{cornerRadius:i,fill:s,fillOpacity:n,highlightState:p,lineDash:o,lineDashOffset:a,seriesId:t,stackGroup:r,stroke:l,strokeOpacity:c,strokeWidth:h,xKey:d,yKey:u}}makeItemStylerParams(e,t,i,s,n,o){const{id:a}=this,{xKey:r,yKey:l,stackGroup:c}=this.properties,h=t.dataSources.get(a)?.data?.[i],d=e.resolveColumnById(this,"yValue-raw",t)[i],u=e.getDomain(this,"xValue","key",t).domain,p=e.getDomain(this,this.yCumulativeKey(e),"value",t).domain,f=this.ctx.highlightManager?.getActiveHighlight(),y=this.getHighlightStateString(f,n,i),b=this.filterItemStylerFillParams(o.fill)??o.fill;return{seriesId:a,...KM(s,d,r,l,u,p),datum:h,xValue:s,yValue:d,stackGroup:c,highlightState:y,...o,fill:b}}getStyle(e,t){const{cornerRadius:i,fill:s,fillOpacity:n,lineDash:o,lineDashOffset:a,stroke:r,strokeOpacity:l,strokeWidth:c,styler:h}=this.properties;let d={};if(!e&&h){const u=this.makeStylerParams(t);d=this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],this.cachedCallWithContext(h,u)??{},{pick:!1})??{}}return{cornerRadius:d.cornerRadius??i,fill:d.fill??s,fillOpacity:d.fillOpacity??n,lineDash:d.lineDash??o,lineDashOffset:d.lineDashOffset??a,opacity:1,stroke:d.stroke??r,strokeOpacity:d.strokeOpacity??l,strokeWidth:d.strokeWidth??c}}getItemStyle(e,t,i){const{properties:s,dataModel:n,processedData:o}=this,{itemStyler:a,simpleItemStyler:r}=s,l=this.getHighlightStyle(t,e,i);if(r&&o!=null&&e!=null){const h=o.dataSources.get(this.id)?.data?.[e],d=r(h);return oe(d,l,this.getStyle(!1,i))}let c=oe(l,this.getStyle(e===void 0,i));if(a&&n!=null&&o!=null&&e!=null){const h=n.resolveKeysById(this,"xValue",o)[e],d=this.cachedDatumCallback(cs(this.getDatumId({xValue:h,phantom:!1}),t?"highlight":"node"),()=>{const u=this.makeItemStylerParams(n,o,e,h,t,c);return this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],this.callWithContext(a,u))});d&&(c=oe(d,c))}return c}updateDatumStyles(e){const t=this.ctx.highlightManager.getActiveHighlight(),i=this;function s(n,o){if(!e.datumSelection.isGarbage(n)){const a=i.getHighlightState(t,e.isHighlight,o.datumIndex);o.style=i.getItemStyle(o.datumIndex,e.isHighlight,a)}}e.datumSelection.each(s)}updateDatumNodes(e){const{contextNodeData:t}=this;if(!t)return;const i=this.ctx.highlightManager.getActiveHighlight(),{shadow:s}=this.properties,n=this.getCategoryDirection()==="x",o=this.getShapeFillBBox(),a=this.getBarDirection(),{drawingMode:r,isHighlight:l}=e,c=this,h=t.styles;function d(u,p){const f=p.style??h[c.getHighlightState(i,l,p.datumIndex)];u.setStyleProperties(f,o);const y=f.cornerRadius??0,b=n?(p.clipBBox?.width??p.width)>0:(p.clipBBox?.height??p.height)>0;u.setStaticProperties(r,p.topLeftCornerRadius?y:0,p.topRightCornerRadius?y:0,p.bottomRightCornerRadius?y:0,p.bottomLeftCornerRadius?y:0,b,p.crisp,s,a,p.featherRatio)}e.datumSelection.each(d)}updateLabelSelection(e){const t=this.isLabelEnabled()?e.labelData:[];return e.labelSelection.update(t,i=>{i.pointerEvents=1})}updateLabelNodes(e){const{isHighlight:t=!1}=e,i={xKey:this.properties.xKey,xName:this.properties.xName??this.properties.xKey,yKey:this.properties.yKey,yName:this.properties.yName??this.properties.yKey,legendItemName:this.properties.legendItemName??this.properties.xName??this.properties.xKey},s=this.ctx.highlightManager?.getActiveHighlight();e.labelSelection.each((n,o)=>{n.fillOpacity=this.getHighlightStyle(t,o?.datumIndex).opacity??1,OO(this,n,i,this.properties.label,o.label,t,s)})}getTooltipContent(e){const{id:t,dataModel:i,processedData:s,properties:n}=this,{xKey:o,xName:a,yKey:r,yName:l,legendItemName:c,stackGroup:h,tooltip:d}=n,u=this.getCategoryAxis(),p=this.getValueAxis();if(!i||!s||!u||!p)return;const f=s.dataSources.get(this.id)?.data?.[e],y=i.resolveKeysById(this,"xValue",s)[e],b=i.resolveColumnById(this,"yValue-raw",s)[e];if(y==null)return;const x=this.getItemStyle(e,!1);return this.formatTooltipWithContext(d,{heading:this.getAxisValueText(u,"tooltip",y,f,o,c),symbol:this.legendItemSymbol(),data:[{label:l,fallbackLabel:r,value:this.getAxisValueText(p,"tooltip",b,f,r,c),missing:Jc(b)}]},{seriesId:t,datum:f,title:l,xKey:o,xName:a,yKey:r,yName:l,legendItemName:c,stackGroup:h,...x,...this.getModuleTooltipParams()})}legendItemSymbol(){const{fill:e,stroke:t,strokeWidth:i,fillOpacity:s,strokeOpacity:n,lineDash:o,lineDashOffset:a}=this.getStyle(!1,0);return{marker:{fill:e??"rgba(0, 0, 0, 0)",stroke:t??"rgba(0, 0, 0, 0)",fillOpacity:s,strokeOpacity:n,strokeWidth:i,lineDash:o,lineDashOffset:a}}}getLegendData(e){const{showInLegend:t}=this.properties;if(e!=="category")return[];const{id:i,ctx:{legendManager:s},visible:n}=this,{yKey:o,yName:a,legendItemName:r}=this.properties;return[{legendType:"category",id:i,itemId:o,seriesId:i,enabled:n&&s.getItemEnabled({seriesId:i,itemId:o}),label:{text:r??a??o},symbol:this.legendItemSymbol(),legendItemName:r,hideInLegend:!t}]}resetDatumAnimation(e){eI([e.datumSelection,this.phantomSelection])}animateReadyHighlight(e){eI([e,this.phantomHighlightSelection])}animateEmptyUpdateReady({datumSelection:e,labelSelection:t,annotationSelections:i}){const{phantomSelection:s}=this,n=hf(cf(this.isVertical(),this.axes,"normal"),"unknown");li(this.id,"nodes",this.ctx.animationManager,[e,s],n),qt(this,"labels",this.ctx.animationManager,t),qt(this,"annotations",this.ctx.animationManager,...i)}animateWaitingUpdateReady(e){const{phantomSelection:t}=this,{datumSelection:i,labelSelection:s,annotationSelections:n,contextData:o,previousContextData:a}=e;this.ctx.animationManager.stopByAnimationGroupId(this.id);const r=h2(this.id,i,this.getDatumId.bind(this),e.contextData,a,this.processedData,this.processedDataUpdated),l=a==null?"fade":"normal",c=hf(cf(this.isVertical(),this.axes,l),"added");li(this.id,"nodes",this.ctx.animationManager,[i,t],c,(h,d)=>this.getDatumId(d),r),(!r||r?.changed||!_o(o.groupScale,a?.groupScale))&&(qt(this,"labels",this.ctx.animationManager,s),qt(this,"annotations",this.ctx.animationManager,...n))}getDatumId(e){return cs(e.xValue,e.phantom)}isLabelEnabled(){return this.properties.label.enabled}computeFocusBounds({datumIndex:e}){const t=this.contextNodeData?.nodeData[e].clipBBox;return tI(this,t)}hasItemStylers(){return this.properties.styler!=null||this.properties.itemStyler!=null||this.properties.simpleItemStyler!=null||this.properties.label.itemStyler!=null}};EI.className="BarSeries",EI.type="bar";var U3={series:{direction:"vertical",fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",Fl],["image",Ar],["pattern",Pn]]},stroke:{$palette:"stroke"},fillOpacity:1,strokeWidth:{$isUserOption:["./stroke",2,0]},lineDash:[0],lineDashOffset:0,label:{...ka,padding:{$isUserOption:["./spacing",0,8]},enabled:!1,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$if:[{$or:[{$eq:[{$path:"./placement"},"outside-start"]},{$eq:[{$path:"./placement"},"outside-end"]}]},{$ref:"textColor"},{$ref:"chartBackgroundColor"}]},placement:"inside-center"},shadow:{enabled:!1,color:fa,xOffset:3,yOffset:3,blur:5},highlight:Ug(),segmentation:yx}},sb={type:"series",name:"bar",chartType:"cartesian",stackable:!0,groupable:!0,version:ue,dependencies:[oi],options:ku,predictAxis:sf,defaultAxes:qN,axisKeys:{x:"xKeyAxis",y:"yKeyAxis"},axisKeysFlipped:{x:"yKeyAxis",y:"xKeyAxis"},themeTemplate:U3,create:e=>new EI(e)},nb=3,K3=5,G2=.05;function Y3(e,t,i){const{xValues:s,yValues:n,xDomain:o,yDomain:a,xNeedsValueOf:r,yNeedsValueOf:l}=e,{x0:c,y0:h,x1:d,y1:u}=i;let p=0,f=1/0;const y=(c+d)/2,b=(h+u)/2;for(const x of t){const v=s[x],S=n[x];if(v==null||S==null)continue;const M=kn(v,o.min,o.max,r),D=kn(S,a.min,a.max,l),k=(M-y)**2+(D-b)**2;k<f&&(f=k,p=x)}return p}function Z3(e,t,i){const{xValues:s,yValues:n,xDomain:o,yDomain:a,xNeedsValueOf:r,yNeedsValueOf:l}=e,{x0:c,y0:h,x1:d,y1:u}=i;let p=0;for(const f of t){const y=s[f],b=n[f];if(y==null||b==null)continue;const x=kn(y,o.min,o.max,r),v=kn(b,a.min,a.max,l);x>=c&&x<=d&&v>=h&&v<=u&&(p+=1)}return p}function X3(e,t,i){const{xValues:s,yValues:n,xDomain:o,yDomain:a,xNeedsValueOf:r,yNeedsValueOf:l}=e,{x0:c,y0:h,x1:d,y1:u}=i,p=[{x0:1,y0:1,x1:0,y1:0,indices:[]},{x0:1,y0:1,x1:0,y1:0,indices:[]},{x0:1,y0:1,x1:0,y1:0,indices:[]},{x0:1,y0:1,x1:0,y1:0,indices:[]}],f=(c+d)/2,y=(h+u)/2;for(const x of t){const v=s[x],S=n[x];if(v==null||S==null)continue;const M=kn(v,o.min,o.max,r),D=kn(S,a.min,a.max,l),k=(M>f?1:0)+(D>y?2:0),I=p[k];I.indices.push(x),I.x0=Math.min(I.x0,M),I.y0=Math.min(I.y0,D),I.x1=Math.max(I.x1,M),I.y1=Math.max(I.y1,D)}const b=[];for(const x of p){const{indices:v,x0:S,x1:M,y0:D,y1:k}=x;if(v.length===0)continue;const I=PI(e,v,{x0:S,y0:D,x1:M,y1:k});b.push(I)}return b}function PI(e,t,i){const{x0:s,y0:n,x1:o,y1:a}=i;let l=t.length<K3&&o-s<G2&&a-n<G2||s===o&&n===a?null:X3(e,t,i);if(l?.length===1)return l[0];l?.length===0&&(l=null);const c=Math.hypot(o-s,a-n),h=Y3(e,t,i);return{scale:c,x0:s,y0:n,x1:o,y1:a,indices:t,primaryDatumIndex:h,children:l}}function q3(e,t,i,s,n,o,a){const[r,l]=e,[c,h]=t,[d,u]=o,{xNeedsValueOf:p,yNeedsValueOf:f}=a,y={xValues:i,yValues:s,xDomain:{min:r,max:l},yDomain:{min:c,max:h},xNeedsValueOf:p,yNeedsValueOf:f},b=[];if(n!=null&&u>d){const x=Array.from({length:nb},()=>[]);for(let v=0;v<n.length;v+=1){const M=(n[v]-d)/(u-d),D=Math.trunc(M*nb);D>=0&&D<nb&&x[D].push(v)}for(let v=0;v<x.length;v+=1){const S=x[v],M=PI(y,S,{x0:0,y0:0,x1:1,y1:1});if(M!=null){const D=v/nb;b.push({sizeRatio:D,node:M})}}}else{const x=i.map((S,M)=>M),v=PI(y,x,{x0:0,y0:0,x1:1,y1:1});v!=null&&b.push({sizeRatio:0,node:v})}return b.length>0?{xValues:i,yValues:s,xd0:r,xd1:l,yd0:c,yd1:h,filters:b,xNeedsValueOf:p,yNeedsValueOf:f}:void 0}function Q3(e,t,i,s,n,o,a,r,l,c){const[h,d]=si(e,o),[u,p]=si(t,a);return q3([h,d],[u,p],i,s,n,[r[0],r[1]],{xNeedsValueOf:l,yNeedsValueOf:c})}function J3(e,t,i,s,n,o,a){const r=i.resolveColumnById(a,"xValue",s),l=i.resolveColumnById(a,"yValue",s),c=o?i.resolveColumnById(a,"sizeValue",s):void 0,h=i.getDomain(a,"xValue","value",s),d=i.getDomain(a,"yValue","value",s),u=o?n.domain:[0,0],p=i.resolveColumnNeedsValueOf(a,"xValue",s),f=i.resolveColumnNeedsValueOf(a,"yValue",s);return Q3(e,t,r,l,c,h,d,u,p,f)}function H2(e,t,i,s,n,o){const{xRange:a,yRange:r,xVisibleRange:[l,c],yVisibleRange:[h,d],minSize:u,maxSize:p}=i,{xValues:f,yValues:y,xd0:b,xd1:x,yd0:v,yd1:S,xNeedsValueOf:M,yNeedsValueOf:D}=t,k=1/Math.min(a/(c-l),r/(d-h)),I={xValues:f,yValues:y,xDomain:{min:b,max:x},yDomain:{min:v,max:S},xNeedsValueOf:M,yNeedsValueOf:D};for(const{sizeRatio:A,node:C}of t.filters){const w=.5*(u+A*(p-u)),T=w*k,O=e*T,E=l-w/a,z=c+w/a,F=h-w/r,_=d+w/r,G=[C];for(;G.length>0;){const B=G.pop();if(!(B.x1<E||B.x0>z||B.y1<F||B.y0>_))if(e!==1&&B.scale<=O)s!=null&&(s.count+=1),n?.push({datumIndex:B.primaryDatumIndex,count:B.indices.length,area:(B.x1-B.x0)*(B.y1-B.y0),dilation:ge(1,B.scale/T,e)});else if(B.children==null){const{indices:V}=B;if(s!=null){const X=B.x0>=l&&B.x1<=c&&B.y0>=h&&B.y1<=d?V.length:Z3(I,V,{x0:l,y0:h,x1:c,y1:d});s.count+=X}o?.push(...V)}else G.push(...B.children)}}}function ob(e,t,i){const s={count:0};return H2(e,t,i,s,void 0,void 0),s.count}var eY=100,tY=12;function iY(e,t,i){if(ob(1,e,t)<=i)return 1;let s=1,n=2;for(;ob(n,e,t)>i&&n<eY;)s*=2,n*=2;for(let o=0;o<tY;o+=1){const a=(n+s)/2;ob(a,e,t)>i?s=a:n=a}return(s+n)/2}function sY(e,t,i){const s=[],n=[];return H2(e,t,i,void 0,s,n),{groupedAggregation:s,singleDatumIndices:n}}var RI=class extends Xs{constructor(){super(...arguments),this.maxSize=30}};g([m,U()],RI.prototype,"maxSize",2),g([m,Yd()],RI.prototype,"domain",2);var j2=class extends Yt{constructor(){super(...arguments),this.placement="top"}};g([m],j2.prototype,"placement",2);var bt=class extends Zo{constructor(){super(...arguments),this.label=new j2,this.tooltip=yh(),this.maxRenderedItems=1/0,this.marker=new RI}};g([m],bt.prototype,"xKey",2),g([m],bt.prototype,"yKey",2),g([m],bt.prototype,"sizeKey",2),g([m],bt.prototype,"labelKey",2),g([m],bt.prototype,"xFilterKey",2),g([m],bt.prototype,"yFilterKey",2),g([m],bt.prototype,"sizeFilterKey",2),g([m],bt.prototype,"xName",2),g([m],bt.prototype,"yName",2),g([m],bt.prototype,"sizeName",2),g([m],bt.prototype,"labelName",2),g([m],bt.prototype,"title",2),g([Bt("marker.shape")],bt.prototype,"shape",2),g([Bt("marker.size")],bt.prototype,"size",2),g([Bt("marker.maxSize")],bt.prototype,"maxSize",2),g([Bt("marker.domain")],bt.prototype,"domain",2),g([Bt("marker.fill")],bt.prototype,"fill",2),g([Bt("marker.fillOpacity")],bt.prototype,"fillOpacity",2),g([Bt("marker.stroke")],bt.prototype,"stroke",2),g([Bt("marker.strokeWidth")],bt.prototype,"strokeWidth",2),g([Bt("marker.strokeOpacity")],bt.prototype,"strokeOpacity",2),g([Bt("marker.lineDash")],bt.prototype,"lineDash",2),g([Bt("marker.lineDashOffset")],bt.prototype,"lineDashOffset",2),g([Bt("marker.itemStyler")],bt.prototype,"itemStyler",2),g([m],bt.prototype,"styler",2),g([m],bt.prototype,"label",2),g([m],bt.prototype,"tooltip",2),g([m],bt.prototype,"maxRenderedItems",2);var nY=class extends $D{constructor(e,t,i,s){super(e,t,i,s),this.sizeKey=s.properties.sizeKey}},ab=class extends Wl{constructor(e){super({moduleCtx:e,propertyKeys:{...Fu,label:["labelKey"],size:["sizeKey"]},propertyNames:{...zu,label:["labelName"],size:["sizeName"]},categoryKey:void 0,pickModes:[2,1,0],pathsPerSeries:[],datumSelectionGarbageCollection:!1,animationResetFns:{label:mh,datum:Vx},usesPlacedLabels:!0,clipFocusBox:!1}),this.NodeEvent=nY,this.properties=new bt,this.dataAggregation=void 0,this.sizeScale=new gh,this.placedLabelData=[]}get pickModeAxis(){return"main-category"}get type(){return super.type}async processData(e){if(this.data==null||!this.visible)return;const t=this.axes.x?.scale,i=this.axes.y?.scale,{xScaleType:s,yScaleType:n}=this.getScaleInformation({xScale:t,yScale:i}),o=this.sizeScale.type,{xKey:a,yKey:r,sizeKey:l,xFilterKey:c,yFilterKey:h,sizeFilterKey:d,labelKey:u,marker:p}=this.properties,{dataModel:f,processedData:y}=await this.requestDataModel(e,this.data,{props:[Ct(a,s,{id:"xValue"}),Ct(r,n,{id:"yValue"}),...c==null?[]:[Ct(c,s,{id:"xFilterValue"})],...h==null?[]:[Ct(h,n,{id:"yFilterValue"})],...d==null?[]:[Ct(d,o,{id:"sizeFilterValue"})],...l?[Ct(l,o,{id:"sizeValue"})]:[],...u?[Ct(u,"category",{id:"labelValue"})]:[]]}),b=l?f.resolveProcessedDataIndexById(this,"sizeValue"):void 0,x=p.domain?[p.domain[0],p.domain[1]]:void 0;this.sizeScale.domain=x??(b==null?void 0:y.domain.values[b])??[],this.dataAggregation=this.aggregateData(f,y),this.animationState.transition("updateData")}xCoordinateRange(e,t,i){const{properties:s,sizeScale:n}=this,{size:o,sizeKey:a}=s,r=this.axes.x.scale.convert(e),l=a==null?void 0:this.dataModel.resolveColumnById(this,"sizeValue",this.processedData),h=.5*(l==null?o:n.convert(l[i]))*t;return[r-h,r+h]}yCoordinateRange(e,t,i){const{properties:s,sizeScale:n}=this,{size:o,sizeKey:a}=s,r=this.axes.y.scale.convert(e[0]),l=a==null?void 0:this.dataModel.resolveColumnById(this,"sizeValue",this.processedData),h=.5*(l==null?o:n.convert(l[i]))*t;return[r-h,r+h]}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;if(!i||!t)return{domain:[]};const s={x:"xValue",y:"yValue"},n=s[e],o=t.resolveProcessedDataDefById(this,n),a=t.getDomain(this,n,"value",i);if(o?.def.type==="value"&&o?.def.valueType==="category")return{domain:a.domain};const l=s[e==="x"?"y":"x"],c=this.domainForClippedRange(e,[n],l);return{domain:ln(Ro(c))}}getSeriesRange(e,t){return this.domainForVisibleRange("y",["yValue"],"xValue",t)}getVisibleItems(e,t,i){const{dataAggregation:s,axes:n}=this,o=n.x,a=n.y;if(s==null||o==null||a==null)return this.countVisibleItems("xValue",["yValue"],e,t,i);const r=this.aggregationOptions(o,a,e,t??[0,1]);return ob(0,s,r)}aggregateData(e,t){if(t.type==="grouped"||t.input.count<=this.properties.maxRenderedItems)return;const i=this.axes.x,s=this.axes.y;if(i==null||s==null)return;const n=i.scale,o=s.scale;if(!(!yt.is(n)||!yt.is(o)))return J3(n.type,o.type,e,t,this.sizeScale,this.properties.sizeKey!=null,this)}aggregationOptions(e,t,i=e.visibleRange,s=t.visibleRange){const{processedData:n,dataModel:o}=this,{sizeKey:a}=this.properties,[r,l]=this.getSizeRange(),c=Math.abs(e.range[1]-e.range[0]),h=Math.abs(t.range[1]-t.range[0]),d=Math.max(r,1),u=a?Math.max(l,1):d,p=e.scale,f=t.scale;return n!=null&&o!=null&&(yt.is(p)&&(i=yg(i,p.domain.map(Wi),o.getDomain(this,"xValue","value",n).domain.map(Wi))),yt.is(f)&&(s=yg(s,f.domain.map(Wi),o.getDomain(this,"yValue","value",n).domain.map(Wi)))),{xRange:c,yRange:h,minSize:d,maxSize:u,xVisibleRange:i,yVisibleRange:s}}createNodeData(){const{axes:e,dataModel:t,processedData:i,sizeScale:s,visible:n}=this,{xKey:o,yKey:a,sizeKey:r,xFilterKey:l,yFilterKey:c,sizeFilterKey:h,labelKey:d,xName:u,yName:p,sizeName:f,labelName:y,label:b,legendItemName:x,marker:v,maxRenderedItems:S}=this.properties,{enabled:M,placement:D}=b,k=ki.anchor(v.shape),I=e.x,A=e.y;if(!(t&&i&&I&&A))return;const C=!this.ctx.animationManager.isSkipped(),w=t.resolveColumnById(this,"xValue",i),T=t.resolveColumnById(this,"yValue",i),O=r==null?void 0:t.resolveColumnById(this,"sizeValue",i),E=d==null?void 0:t.resolveColumnById(this,"labelValue",i),z=l==null?void 0:t.resolveColumnById(this,"xFilterValue",i),F=c==null?void 0:t.resolveColumnById(this,"yFilterValue",i),_=h==null?void 0:t.resolveColumnById(this,"sizeFilterValue",i);let G;d?G=[]:r?G=t.getDomain(this,"sizeValue","value",i).domain:G=[];const B=I.scale,V=A.scale,Y=(B.bandwidth??0)/2,X=(V.bandwidth??0)/2,q=[];s.range=this.getSizeRange();const te=Ze(b),pe=i.dataSources.get(this.id)?.data;if(pe==null)return;const Se=hu(b),ve=(Ie,ze,Xe,Te)=>{const de=pe[Ie],De=w[Ie],ye=T[Ie],Ee=O?.[Ie],Ne=B.convert(De)+Y,xt=V.convert(ye)+X;let nt;z!=null&&F!=null&&(nt=z[Ie]===De&&F[Ie]===ye,_!=null&&nt&&(nt=_[Ie]===Ee));let We;if(M){let vt,Ds,Zn;d&&E?(vt=E[Ie],Ds=d,Zn="label"):r?(vt=Ee,Ds=r,Zn="size"):(vt=ye,Ds=a,Zn="y");const oa=this.getLabelText(vt,de,Ds,Zn,G,b,{value:vt,datum:de,xKey:o,yKey:a,sizeKey:r,labelKey:d,xName:u,yName:p,sizeName:f,labelName:y,legendItemName:x});let{width:yn,height:Xn}=Ce(oa)?Ks(oa,b):te.measureLines(String(oa));yn+=Se.left+Se.right,Xn+=Se.bottom+Se.top,We={text:oa,width:yn,height:Xn}}else We={text:"",width:0,height:0};const rt=Ee==null?s.range[0]:s.convert(Ee),wt={x:Ne,y:xt,size:Math.sqrt(Xe)*rt};q.push({series:this,itemId:a,yKey:a,xKey:o,datum:de,datumIndex:Ie,xValue:De,yValue:ye,sizeValue:Ee,capDefaults:{lengthRatioMultiplier:v.getDiameter(),lengthMax:1/0},point:wt,midPoint:{x:Ne,y:xt},label:We,anchor:k,placement:D,count:ze,dilation:Xe,area:Te,selected:nt})},{dataAggregation:ae}=this;if(n)if(ae==null)for(let Ie=0;Ie<pe.length;Ie++)ve(Ie,1,1,0);else{const Ie=this.aggregationOptions(I,A),ze=iY(ae,Ie,S),{groupedAggregation:Xe,singleDatumIndices:Te}=sY(ze,ae,Ie);for(const{datumIndex:de,count:De,dilation:ye,area:Ee}of Xe)ve(de,De,ye,Ee);for(const de of Te)ve(de,1,1,0)}return{itemId:a,nodeData:q,labelData:M?q:[],scales:this.calculateScaling(),visible:this.visible||C,styles:Hx(this,this.properties,v)}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}getLabelData(){return this.isLabelEnabled()?this.contextNodeData?.labelData??[]:[]}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e,{sizeKey:s}=this.properties;this.properties.marker.isDirty()&&(i.clear(),i.cleanup());let n;return s&&(n=o=>cs(o.xValue,o.yValue,o.sizeValue,Pe(o.label.text))),i.update(t,void 0,n)}updateDatumStyles(e){const{datumSelection:t,isHighlight:i}=e,{xKey:s,yKey:n,sizeKey:o,labelKey:a,marker:r}=this.properties,l={xKey:s,yKey:n,sizeKey:o,labelKey:a},c=this.ctx.highlightManager.getActiveHighlight();t.each((h,d)=>{if(!t.isGarbage(h)){const u=this.getHighlightState(c,e.isHighlight,d.datumIndex),p=this.getStyle(u);d.style=this.getMarkerStyle(r,d,l,{isHighlight:i,highlightState:u,resolveMarkerSubPath:[]},p)}})}updateDatumNodes(e){const{contextNodeData:t}=this;if(!t)return;const{datumSelection:i,isHighlight:s,drawingMode:n}=e;this.sizeScale.range=this.getSizeRange();const o=this.getShapeFillBBox(),a=this.dataAggregation!=null,r=this.ctx.highlightManager.getActiveHighlight();i.each((l,c,h)=>{const{point:{size:d},count:u,area:p,dilation:f}=c;let y=c.style??t.styles[this.getHighlightState(r,s,c.datumIndex)];if(y={...y},y.size=d,f>1){const b=y.fillOpacity??0,x=.269669+683e-6*u+-37.534348*p+.004449*u*p+-0*u**2+44.428603*p**2;y.fillOpacity=ge(b/f,b/.1*x,1)}this.applyMarkerStyle(y,l,c.point,o,{selected:c.selected}),l.drawingMode=n,l.zIndex=a?[-u,h]:0}),s||this.properties.marker.markClean()}updatePlacedLabelData(e){this.placedLabelData=e,this.labelSelection.update(e.map(t=>({...t.datum,point:{x:t.x,y:t.y,size:t.datum.point.size}})),t=>{t.pointerEvents=1}),this.updateLabelNodes({labelSelection:this.labelSelection}),this.updateHighlightLabelSelection()}updateHighlightLabelSelection(){const e=this.ctx.highlightManager?.getActiveHighlight(),t=this.isSeriesHighlighted(e)&&e?.datum?e:void 0,i=t==null?[]:this.placedLabelData.filter(s=>s.datum.datumIndex===t.datumIndex).map(s=>({...s.datum,point:{x:s.x,y:s.y,size:s.datum.point.size}}));this.highlightLabelSelection=this.updateLabelSelection({labelData:i,labelSelection:this.highlightLabelSelection})??this.highlightLabelSelection,this.highlightLabelGroup.visible=i.length>0,this.highlightLabelGroup.batchedUpdate(()=>{this.updateLabelNodes({labelSelection:this.highlightLabelSelection,isHighlight:!0})})}updateLabelNodes(e){const{isHighlight:t=!1}=e,i=this.ctx.highlightManager?.getActiveHighlight(),s=this.makeLabelFormatterParams();e.labelSelection.each((n,o)=>{const a=fh(this,o,s,this.properties.label,t,i);n.text=o.label.text,n.fill=a.color,n.x=o.point?.x??0,n.y=o.point?.y??0,n.fontStyle=a.fontStyle,n.fontWeight=a.fontWeight,n.fontSize=a.fontSize,n.fontFamily=a.fontFamily,n.textBaseline="top",n.fillOpacity=this.getHighlightStyle(t,o.datumIndex).opacity??1,n.setBoxing(a)})}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e;return i.update(t,s=>{s.pointerEvents=1})}makeStylerParams(e){const{id:t,properties:{size:i,maxSize:s,shape:n,fill:o,fillOpacity:a,lineDash:r,lineDashOffset:l,stroke:c,strokeOpacity:h,strokeWidth:d,xKey:u,yKey:p,sizeKey:f,labelKey:y}}=this,b=lu(e??0);return this.type==="bubble"?{highlightState:b,size:i,maxSize:s,shape:n,fill:o,fillOpacity:a,lineDash:r,lineDashOffset:l,seriesId:t,sizeKey:f,stroke:c,strokeOpacity:h,strokeWidth:d,xKey:u,yKey:p,labelKey:y}:this.type==="scatter"?{highlightState:b,size:i,shape:n,fill:o,fillOpacity:a,lineDash:r,lineDashOffset:l,seriesId:t,stroke:c,strokeOpacity:h,strokeWidth:d,xKey:u,yKey:p,labelKey:y}:this.type}makeLabelFormatterParams(){const{xKey:e,xName:t,yKey:i,yName:s,sizeKey:n,sizeName:o,labelKey:a,labelName:r,legendItemName:l}=this.properties;return{xKey:e,xName:t,yKey:i,yName:s,sizeKey:n,sizeName:o,labelKey:a,labelName:r,legendItemName:l}}getTooltipContent(e){const{id:t,dataModel:i,processedData:s,axes:n,properties:o,ctx:a}=this,{formatManager:r}=a,{xKey:l,xName:c,yKey:h,yName:d,sizeKey:u,sizeName:p,labelKey:f,labelName:y,title:b,tooltip:x,marker:v,legendItemName:S}=o,M=n.x,D=n.y;if(!i||!s||!M||!D)return;const k=s.dataSources.get(this.id)?.data?.[e],I=i.resolveColumnById(this,"xValue",s)[e],A=i.resolveColumnById(this,"yValue",s)[e];if(I==null)return;const C=[];if(this.isLabelEnabled()&&f!=null){const T=i.resolveColumnById(this,"labelValue",s)[e],O=r.format(this.callWithContext.bind(this),{type:"category",value:T,datum:k,seriesId:t,legendItemName:S,key:f,source:"tooltip",property:"label",domain:[],boundSeries:this.getFormatterContext("label")});C.push({label:y,fallbackLabel:f,value:O??ao(T)})}if(C.push({label:c,fallbackLabel:l,value:this.getAxisValueText(M,"tooltip",I,k,l,S),missing:Jc(I)},{label:d,fallbackLabel:h,value:this.getAxisValueText(D,"tooltip",A,k,h,S),missing:Jc(A)}),u!=null){const T=i.resolveColumnById(this,"sizeValue",s)[e];if(T!=null){const O=i.getDomain(this,"sizeValue","value",s).domain,E=r.format(this.callWithContext.bind(this),{type:"number",value:T,datum:k,seriesId:t,legendItemName:S,key:u,source:"tooltip",property:"size",boundSeries:this.getFormatterContext("size"),domain:O,fractionDigits:void 0});C.push({label:p,fallbackLabel:u,value:E??ao(T)})}}const w=this.getMarkerStyle(v,{datum:k,datumIndex:e},{xKey:l,yKey:h,sizeKey:u,labelKey:f},{resolveMarkerSubPath:[]});return this.formatTooltipWithContext(x,{title:b,symbol:this.legendItemSymbol(),data:C},{seriesId:t,datum:k,title:h,xKey:l,xName:c,yKey:h,yName:d,sizeKey:u,sizeName:p,labelKey:f,labelName:y,legendItemName:S,...w,...this.getModuleTooltipParams()})}legendItemSymbol(){const e=this.getStyle();return{marker:this.getMarkerStyle(this.properties.marker,{},void 0,{isHighlight:!1,checkForHighlight:!1,resolveMarkerSubPath:[]},e)}}getLegendData(){const{id:e,ctx:{legendManager:t},visible:i}=this,{yKey:s,yName:n,legendItemName:o,title:a,showInLegend:r}=this.properties;return[{legendType:"category",id:e,itemId:s,seriesId:e,enabled:i&&t.getItemEnabled({seriesId:e,itemId:s}),label:{text:o??a??n??s},symbol:this.legendItemSymbol(),legendItemName:o,hideInLegend:!r}]}animateEmptyUpdateReady({datumSelection:e,labelSelection:t}){$K(this,this.ctx.animationManager,e),qt(this,"labels",this.ctx.animationManager,t)}isLabelEnabled(){return this.properties.label.enabled}nodeFactory(){return new ki}getStyle(e){const{properties:t}=this;let i={};if(t.styler){const s=this.makeStylerParams(e),n=this.cachedCallWithContext(t.styler,s)??{};i=this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],n,{pick:!1})??{}}return{fill:i.fill??t.fill,fillOpacity:i.fillOpacity??t.fillOpacity,lineDash:i.lineDash??t.lineDash,lineDashOffset:i.lineDashOffset??t.lineDashOffset,shape:i.shape??t.shape,size:i.size??t.size,maxSize:i.maxSize??t.maxSize,stroke:i.stroke??t.stroke,strokeOpacity:i.strokeOpacity??t.strokeOpacity,strokeWidth:i.strokeWidth??t.strokeWidth}}getSizeRange(){const{size:e,maxSize:t}=this.getStyle();return[e,t]}getFormattedMarkerStyle(e){const{xKey:t,yKey:i,sizeKey:s,labelKey:n,marker:o}=this.properties;return this.getMarkerStyle(o,e,{xKey:t,yKey:i,sizeKey:s,labelKey:n},{resolveMarkerSubPath:[]})}computeFocusBounds(e){return Gx(this,e)}hasItemStylers(){const{styler:e,itemStyler:t,marker:i,label:s}=this.properties;return!!(e??t??i.itemStyler??s.itemStyler)}initQuadTree(e){Fx(e,this.datumNodesIter())}pickNodeDataClosestDatum(e){return zx(this,e)}};ab.className="BubbleSeries",ab.type="bubble";var oY={series:{shape:"circle",size:7,maxSize:30,fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",$g],["image",Ar],["pattern",Pn]]},stroke:{$palette:"stroke"},fillOpacity:.8,maxRenderedItems:2e3,label:{...ka,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},tooltip:{range:{$path:["/tooltip/range","nearest"]},position:{anchorTo:{$path:["/tooltip/position/anchorTo","node"]}}},highlight:Ug()}},FI={type:"series",name:"bubble",chartType:"cartesian",version:ue,dependencies:[oi],options:Mx,predictAxis:_D,defaultAxes:{x:{type:"number",position:"bottom"},y:{type:"number",position:"left"}},axisKeys:{x:"xKeyAxis",y:"yKeyAxis"},themeTemplate:oY,create:e=>new ab(e)},Li=class extends Zo{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.areaPlot=!1,this.aggregation="sum",this.shadow=new Ta,this.label=new Yt,this.tooltip=yh()}getStyle(){const{fill:e,fillOpacity:t,stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:o,lineDashOffset:a,cornerRadius:r}=this;return{fill:e,fillOpacity:t,stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:o,lineDashOffset:a,cornerRadius:r,opacity:1}}};g([m],Li.prototype,"xKey",2),g([m],Li.prototype,"yKey",2),g([m],Li.prototype,"xName",2),g([m],Li.prototype,"yName",2),g([m],Li.prototype,"fill",2),g([m],Li.prototype,"fillOpacity",2),g([m],Li.prototype,"stroke",2),g([m],Li.prototype,"strokeWidth",2),g([m],Li.prototype,"strokeOpacity",2),g([m],Li.prototype,"lineDash",2),g([m],Li.prototype,"lineDashOffset",2),g([m],Li.prototype,"cornerRadius",2),g([m],Li.prototype,"areaPlot",2),g([m],Li.prototype,"bins",2),g([m],Li.prototype,"aggregation",2),g([m],Li.prototype,"binCount",2),g([m],Li.prototype,"shadow",2),g([m],Li.prototype,"label",2),g([m],Li.prototype,"tooltip",2);var W2=10,zI=class extends Wl{constructor(e){super({moduleCtx:e,propertyKeys:Fu,propertyNames:zu,categoryKey:void 0,pickModes:[1,0],datumSelectionGarbageCollection:!0,alwaysClip:!0,animationResetFns:{datum:df,label:mh}}),this.properties=new Li,this.calculatedBins=[]}get hasData(){return this.calculatedBins.length>0}deriveBins(e){const t=Rc(e[0],e[1],W2).ticks,i=Fc(e[0],e[1],W2),[s]=t,n=o=>[o,o+i];return[[s-i,s],...t.map(n)]}calculateNiceBins(e,t){const i=Math.floor(e[0]),s=e[1],n=t||1,{start:o,binSize:a}=this.calculateNiceStart(i,s,n);return this.getBins(o,s,a,n)}getBins(e,t,i,s){const n=[],o=this.calculatePrecision(i);for(let a=0;a<s;a++){const r=Math.round((e+a*i)*o)/o;let l=Math.round((e+(a+1)*i)*o)/o;a===s-1&&(l=Math.max(l,t)),n[a]=[r,l]}return n}calculatePrecision(e){let t=10;if(Number.isFinite(e)&&e>0)for(;e<1;)t*=10,e*=10;return t}calculateNiceStart(e,t,i){const s=Math.abs(t-e)/i,n=Math.floor(Math.log10(s)),o=Math.pow(10,n);return{start:Math.floor(e/o)*o,binSize:s}}async processData(e){const{visible:t}=this,{xKey:i,yKey:s,areaPlot:n,aggregation:o}=this.properties,a=this.axes.x?.scale,r=this.axes.y?.scale,{xScaleType:l,yScaleType:c}=this.getScaleInformation({yScale:r,xScale:a}),h=t?{}:{forceValue:0},d=[Ll(i,l),Vj];if(s){let v=AT("groupAgg",{visible:t});o==="count"||(o==="sum"?v=nj("groupAgg",{visible:t}):o==="mean"&&(v=aj("groupAgg",{visible:t}))),n&&(v=CT("groupAgg",v)),d.push(Ct(s,c,{invalidValue:void 0,...h}),v)}else{d.push(Fj("count"));let v=AT("groupAgg",{visible:t});n&&(v=CT("groupAgg",v)),d.push(v)}let u=[];const p=v=>{const S=ln(v.domain.keys[0]);if(S.length===0)return v.domain.groups=[],()=>[];const M=gt(this.properties.binCount)?this.calculateNiceBins(S,this.properties.binCount):this.properties.bins??this.deriveBins(S),D=M.length;return u=[...M],k=>{let I=k[0];if(Is(I)&&(I=I.getTime()),!gt(I))return[];for(let A=0;A<D;A++){const C=M[A];if(I>=C[0]&&I<C[1]||A===D-1&&I<=C[1])return C}return[]}},{dataModel:f,processedData:y}=await this.requestDataModel(e,this.data,{props:d,groupByFn:p}),b=y,x=new Map;for(const[v,S]of b.groups.entries()){const M=S.keys;x.set(cs(...M),{group:S,groupIndex:v})}this.calculatedBins=u.map(v=>{const S=x.get(cs(...v));if(S){const{group:M,groupIndex:D}=S,[[k,I]=[0,0]]=M.aggregation,A=[...f.forEachDatum(this,b,M,D)],C=this.frequency(M),w=k+I;return{domain:v,datum:A,groupIndex:D,frequency:C,total:w}}else return{domain:v,datum:[],groupIndex:-1,frequency:0,total:0}}),this.animationState.transition("updateData")}xCoordinateRange(){return[Number.NaN,Number.NaN]}yCoordinateRange(){return[Number.NaN,Number.NaN]}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!t||!i||!this.calculatedBins.length)return{domain:[]};const s=i.getDomain(this,"groupAgg","aggregate",t).domain,n=this.calculatedBins[0].domain[0],o=this.calculatedBins[(this.calculatedBins?.length??0)-1].domain[1];return e==="x"?{domain:ln([n,o])}:{domain:ln(s)}}getSeriesRange(e,[t,i]){const{dataModel:s,processedData:n}=this;if(!s||n?.type!=="grouped")return[Number.NaN,Number.NaN];const o=this.axes.x.scale,a=0;let r=-1/0;for(const{keys:l,aggregation:c}of n.groups){const[[h,d]=[0,0]]=c,[u,p]=l,[f,y]=Tt([o.convert(u),o.convert(p)]);if(y>=t&&f<=i){const b=h+d;r=Math.max(r,b)}}return a>r?[Number.NaN,Number.NaN]:[a,r]}frequency(e){return e.datumIndices.reduce((t,i)=>t+i.length,0)}createNodeData(){const{axes:e,processedData:t,dataModel:i}=this,s=e.x,n=e.y;if(!s||!n||!i)return;const{scale:o}=s,{scale:a}=n,{xKey:r,yKey:l,xName:c,yName:h,label:d}=this.properties,u=!this.ctx.animationManager.isSkipped(),p=[],f={itemId:this.properties.yKey??this.id,nodeData:p,labelData:p,scales:this.calculateScaling(),animationValid:!0,visible:this.visible||u,styles:YM(this.getItemStyle.bind(this))};if(t==null||t.type!=="grouped")return f;for(const{domain:y,datum:b,groupIndex:x,frequency:v,total:S}of this.calculatedBins){const[M,D]=y,k=o.convert(M),I=o.convert(D),A=a.convert(0),C=a.convert(S),w=Math.abs(I-k),T=Math.abs(C-A),O=Math.min(k,I),E=Math.min(A,C);let z;d.enabled&&S!==0&&(z={x:O+w/2,y:E+T/2,text:this.getLabelText(S,b,l,"y",[],d,{value:S,datum:b,xKey:r,yKey:l,xName:c,yName:h})});const F={x:O+w/2,y:E+T/2},_=n.isReversed();p.push({series:this,datumIndex:x,datum:b,aggregatedValue:S,frequency:v,domain:y,yKey:l,xKey:r,x:O,y:E,xValue:k,yValue:C,width:w,height:T,midPoint:F,topLeftCornerRadius:!_,topRightCornerRadius:!_,bottomRightCornerRadius:_,bottomLeftCornerRadius:_,label:z,crisp:!0})}return p.sort((y,b)=>y.x-b.x),f}nodeFactory(){return new Di}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e;return i.update(t,void 0,s=>cs(...s.domain))}getItemStyle(e,t,i){const{properties:s}=this,n=this.getHighlightStyle(t,e,i);return oe(n,s.getStyle())}updateDatumStyles(e){const{datumSelection:t,isHighlight:i}=e;t.each((s,n)=>{t.isGarbage(s)||(n.style=this.getItemStyle(n.datumIndex,i))})}updateDatumNodes(e){const{contextNodeData:t}=this;if(!t)return;const i=this.ctx.highlightManager.getActiveHighlight(),{shadow:s}=this.properties,n=this.getShapeFillBBox();e.datumSelection.each((o,a)=>{const r=a.style??t.styles[this.getHighlightState(i,e.isHighlight,a.datumIndex)],{cornerRadius:l=0}=r,{topLeftCornerRadius:c,topRightCornerRadius:h,bottomRightCornerRadius:d,bottomLeftCornerRadius:u}=a;o.setStyleProperties(r,n),o.topLeftCornerRadius=c?l:0,o.topRightCornerRadius=h?l:0,o.bottomRightCornerRadius=d?l:0,o.bottomLeftCornerRadius=u?l:0,o.crisp=a.crisp,o.fillShadow=s})}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e;return i.update(t,s=>{s.pointerEvents=1,s.textAlign="center",s.textBaseline="middle"})}updateLabelNodes(e){const t=this.isLabelEnabled(),{isHighlight:i=!1}=e,s=this.ctx.highlightManager?.getActiveHighlight();e.labelSelection.each((n,o)=>{const a=fh(this,o,this.properties,this.properties.label,i,s),{enabled:r,fontStyle:l,fontWeight:c,fontSize:h,fontFamily:d,color:u}=a;r&&t&&o?.label?(n.text=o.label.text,n.x=o.label.x,n.y=o.label.y,n.fontStyle=l,n.fontWeight=c,n.fontFamily=d,n.fontSize=h,n.fill=u,n.visible=!0,n.fillOpacity=this.getHighlightStyle(i,o.datumIndex).opacity??1,n.setBoxing(a)):n.visible=!1})}initQuadTree(e){const{value:t}=this.contentGroup.children().next();t instanceof Oe&&Fx(e,t.children())}pickNodeClosestDatum(e){return zx(this,e)}getTooltipContent(e){const{id:t,dataModel:i,processedData:s,axes:n,properties:o,ctx:{localeManager:a}}=this,{xKey:r,xName:l,yKey:c,yName:h,tooltip:d,legendItemName:u}=o,p=n.x,f=n.y;if(!i||s?.type!=="grouped"||!p||!f)return;const y=s.groups[e],{aggregation:b,keys:x}=y,[[v,S]=[0,0]]=b,M=this.frequency(y),D=x,[k,I]=D,A=v+S,C={data:[...i.forEachDatum(this,s,y,e)],aggregatedValue:A,frequency:M,domain:D},w=[{label:l,fallbackLabel:r,value:`${this.getAxisValueText(p,"tooltip",k,C,r,u)} - ${this.getAxisValueText(p,"tooltip",I,C,r,u)}`},{label:a.t("seriesHistogramTooltipFrequency"),value:this.getAxisValueText(f,"tooltip",M,C,c,u)}];if(c!=null){let T;switch(o.aggregation){case"sum":T=a.t("seriesHistogramTooltipSum",{yName:h??c});break;case"mean":T=a.t("seriesHistogramTooltipMean",{yName:h??c});break;case"count":T=a.t("seriesHistogramTooltipCount",{yName:h??c});break}w.push({label:T,value:this.getAxisValueText(f,"tooltip",A,C,c,u)})}return this.formatTooltipWithContext(d,{symbol:this.legendItemSymbol(),data:w},{seriesId:t,datum:C,title:h,xKey:r,xName:l,yKey:c,yName:h,xRange:[k,I],frequency:M,...this.getItemStyle(e,!1)})}legendItemSymbol(){const{fill:e,fillOpacity:t,stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:o,lineDashOffset:a}=this.properties;return{marker:{fill:Re(e)??"rgba(0, 0, 0, 0)",stroke:i??"rgba(0, 0, 0, 0)",fillOpacity:t,strokeOpacity:n,strokeWidth:s,lineDash:o,lineDashOffset:a}}}getLegendData(e){if(e!=="category")return[];const{id:t,ctx:{legendManager:i},visible:s}=this,{xKey:n,yName:o,showInLegend:a}=this.properties;return[{legendType:"category",id:t,itemId:n,seriesId:t,enabled:s&&i.getItemEnabled({seriesId:t,itemId:n}),label:{text:o??n??"Frequency"},symbol:this.legendItemSymbol(),hideInLegend:!a}]}animateEmptyUpdateReady({datumSelection:e,labelSelection:t}){const i=hf(cf(!0,this.axes,"normal"),"unknown");li(this.id,"datums",this.ctx.animationManager,[e],i),qt(this,"labels",this.ctx.animationManager,t)}animateWaitingUpdateReady(e){const t=hf(cf(!0,this.axes,"normal"),"added"),i={changed:!0,added:new Set,updated:new Set,removed:new Set,moved:new Set};li(this.id,"datums",this.ctx.animationManager,[e.datumSelection],t,(s,n)=>cs(...n.domain),i),i?.changed&&qt(this,"labels",this.ctx.animationManager,e.labelSelection)}isLabelEnabled(){return this.properties.label.enabled}computeFocusBounds({datumIndex:e}){return tI(this,this.contextNodeData?.nodeData[e])}hasItemStylers(){return this.properties.label.itemStyler!=null}};zI.className="HistogramSeries",zI.type="histogram";var aY={series:{fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",Fl],["image",Ar],["pattern",Pn]]},stroke:{$palette:"stroke"},strokeWidth:1,fillOpacity:1,strokeOpacity:1,lineDash:[0],lineDashOffset:0,label:{...ka,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"chartBackgroundColor"}},shadow:{enabled:!1,color:fa,xOffset:3,yOffset:3,blur:5},highlight:Ug()}},BI={type:"series",name:"histogram",chartType:"cartesian",version:ue,dependencies:[oi],options:P$,predictAxis:sf,defaultAxes:{x:{type:"number",position:"bottom"},y:{type:"number",position:"left"}},axisKeys:{x:"xKeyAxis",y:"yKeyAxis"},themeTemplate:aY,create:e=>new zI(e)},rY=10;function rb(e,t,i,s,n,o,a,r){const l=e[o];if(l==null)return!1;const c=Number.isFinite(t)?kn(l,t,i,a):Lc(o,r),h=eg(c,n);return o===s[h+Hs]||o===s[h+js]||o===s[h+Ws]||o===s[h+$s]}function $2(e,t,i,s,n,o,a,r){let l=0;for(let d=0;d<a;d++)rb(e,t,i,s,n,d,o,a)&&l++;const c=r?.length===l?r:new Uint32Array(l);let h=0;for(let d=0;d<a;d++)rb(e,t,i,s,n,d,o,a)&&(c[h++]=d);return c}function lY(e,t,i,s,n,o,a,r,l){let c=0;for(let u=0;u<e.length;u++){const p=e[u];rb(t,i,s,n,o,p,a,r)&&c++}const h=l?.length===c?l:new Uint32Array(c);let d=0;for(let u=0;u<e.length;u++){const p=e[u];rb(t,i,s,n,o,p,a,r)&&(h[d++]=p)}return h}function _I(e,t,i,s){const n=t.length;if(n<ua)return;const[o,a]=e,{xNeedsValueOf:r,yNeedsValueOf:l,existingFilters:c}=s;let h=pa(t,o,a,{xNeedsValueOf:r});const d=c?.find(b=>b.maxRange===h);let{indexData:u,valueData:p}=ga(t,i,i,o,a,h,{xNeedsValueOf:r,yNeedsValueOf:l,reuseIndexData:d?.indexData,reuseValueData:d?.valueData}),f=$2(t,o,a,u,h,r,n,d?.indices);const y=[{maxRange:h,indices:f,indexData:u,valueData:p}];for(;f.length>rY&&h>64;){const b=h,x=Math.trunc(b/2),v=c?.find(M=>M.maxRange===x),S=hl(u,p,b,{reuseIndexData:v?.indexData,reuseValueData:v?.valueData});h=S.maxRange,u=S.indexData,p=S.valueData,f=lY(f,t,o,a,u,h,r,n,v?.indices),y.push({maxRange:h,indices:f,indexData:u,valueData:p})}return y.reverse(),y}function cY(e,t,i,s){const n=t.length;if(n<ua)return;const[o,a]=e,{xNeedsValueOf:r,yNeedsValueOf:l,targetRange:c,existingFilters:h}=s,d=pa(t,o,a,{xNeedsValueOf:r}),u=Math.min(d,Cc(Math.max(c,ar))),p=h?.find(S=>S.maxRange===u),{indexData:f,valueData:y}=ga(t,i,i,o,a,u,{xNeedsValueOf:r,yNeedsValueOf:l,reuseIndexData:p?.indexData,reuseValueData:p?.valueData}),b=$2(t,o,a,f,u,r,n,p?.indices),x={maxRange:u,indices:b,indexData:f,valueData:y};function v(){return _I([o,a],t,i,{xNeedsValueOf:r,yNeedsValueOf:l,existingFilters:h})?.filter(M=>M.maxRange!==u)??[]}return{immediate:[x],computeRemaining:v}}function hY(e,t,i,s,n,o){const[a,r]=si(e,s);return _I([a,r],t,i,{xNeedsValueOf:n,yNeedsValueOf:o})}var dY=pr(hY);function uY(e,t,i,s,n,o){const a=t.resolveColumnById(n,"xValue",i),r=t.resolveColumnById(n,s,i),l=t.getDomain(n,"xValue","value",i),c=t.resolveColumnNeedsValueOf(n,"xValue",i),h=t.resolveColumnNeedsValueOf(n,s,i);if(o){const[d,u]=si(e,l);return _I([d,u],a,r,{xNeedsValueOf:c,yNeedsValueOf:h,existingFilters:o})}return dY(e,a,r,l,c,h)}function pY(e,t,i,s,n,o,a){const r=t.resolveColumnById(n,"xValue",i),l=t.resolveColumnById(n,s,i),c=t.getDomain(n,"xValue","value",i),h=t.resolveColumnNeedsValueOf(n,"xValue",i),d=t.resolveColumnNeedsValueOf(n,s,i),[u,p]=si(e,c);return cY([u,p],r,l,{xNeedsValueOf:h,yNeedsValueOf:d,targetRange:o,existingFilters:a})}var gi=class extends Zo{constructor(){super(...arguments),this.stroke="#874349",this.strokeWidth=2,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.interpolation=new dl,this.marker=new Xs,this.label=new Yt,this.tooltip=yh(),this.connectMissingData=!1,this.sparklineMode=!1}};g([m],gi.prototype,"xKey",2),g([m],gi.prototype,"yKey",2),g([m],gi.prototype,"xName",2),g([m],gi.prototype,"yName",2),g([m],gi.prototype,"yFilterKey",2),g([m],gi.prototype,"stackGroup",2),g([m],gi.prototype,"normalizedTo",2),g([m],gi.prototype,"title",2),g([m],gi.prototype,"stroke",2),g([m],gi.prototype,"strokeWidth",2),g([m],gi.prototype,"strokeOpacity",2),g([m],gi.prototype,"lineDash",2),g([m],gi.prototype,"lineDashOffset",2),g([m],gi.prototype,"interpolation",2),g([m],gi.prototype,"styler",2),g([m],gi.prototype,"marker",2),g([m],gi.prototype,"label",2),g([m],gi.prototype,"tooltip",2),g([m],gi.prototype,"connectMissingData",2),g([m],gi.prototype,"sparklineMode",2);var gY=.25,VI=class extends Wl{constructor(e){super({moduleCtx:e,propertyKeys:Fu,propertyNames:zu,categoryKey:"xValue",pickModes:[2,1,0],datumSelectionGarbageCollection:!1,segmentedDataNodes:!1,animationResetFns:{path:rI({getVisible:()=>this.visible,getOpacity:()=>this.getOpacity()}),label:mh,datum:(t,i)=>({...Vx(t),...pf(t,i)})},clipFocusBox:!1}),this.properties=new gi,this.aggregationManager=new Kx}get pickModeAxis(){return this.properties.sparklineMode?"main":"main-category"}isNormalized(){return this.properties.normalizedTo!=null}async processData(e){if(this.data==null)return;const{data:t,visible:i,seriesGrouping:{groupIndex:s=this.id,stackCount:n=0}={}}=this,{xKey:o,yKey:a,yFilterKey:r,connectMissingData:l,normalizedTo:c}=this.properties,h=this.axes.x?.scale,d=this.axes.y?.scale,{isContinuousX:u,xScaleType:p,yScaleType:f}=this.getScaleInformation({xScale:h,yScale:d}),y=n>1||c!=null,b={invalidValue:null};l&&y&&(b.invalidValue=0),y&&!i&&(b.forceValue=0);const x={value:`area-stack-${s}-yValue`,marker:`area-stack-${s}-yValues-marker`},v=[];(!u||y)&&v.push(Ll(o,p,{id:"xKey"})),v.push(Ct(o,p,{id:"xValue"}),Ct(a,f,{id:"yValueRaw",...b,invalidValue:void 0})),r!=null&&v.push(Ct(r,f,{id:"yFilterRaw"})),y&&v.push(...Pg(a,"normal",{id:"yValueCumulative",...b,groupId:x.marker},f)),St(c)&&v.push(Ct(a,f,{id:"yValue",...b,groupId:x.value}),nx(Object.values(x),c)),this.needsDataModelDiff()&&(v.push(Fg(u?["xValue"]:void 0)),this.processedData&&v.push(ax(this.id,this.processedData)));const{dataModel:S,processedData:M}=await this.requestDataModel(e,t,{props:v,groupByKeys:y,groupByData:!y});this.aggregateData(S,M),this.animationState.transition("updateData")}yValueKey(){return this.isNormalized()?"yValue":"yValueRaw"}yCumulativeKey(e){return e.type==="grouped"?"yValueCumulative":this.yValueKey()}xCoordinateRange(e,t){const{marker:i}=this.properties,s=this.axes.x.scale.convert(e),n=i.enabled?.5*i.size*t:0;return[s-n,s+n]}yCoordinateRange(e,t){const{marker:i}=this.properties,s=this.axes.y.scale.convert(e[0]),n=i.enabled?.5*i.size*t:0;return[s-n,s+n]}getSeriesDomain(e){const{dataModel:t,processedData:i,axes:s}=this;if(!t||!i)return{domain:[]};const n=s.y;if(e==="x"){const a=t.resolveProcessedDataDefById(this,"xValue"),r=t.getDomain(this,"xValue","value",i);if(a?.def.type==="value"&&a.def.valueType==="category"){const l=t.getKeySortMetadata(this,"xValue",i);return{domain:r.domain,sortMetadata:l}}return{domain:ln(Ro(r.domain))}}const o=this.domainForClippedRange("y",[this.yCumulativeKey(i)],"xValue");if(this.isNormalized()&&n instanceof zn&&!(n instanceof Hu)){const a=Number.isFinite(o[1]-o[0])?[Math.min(o[0],0),Math.max(o[1],0)]:[];return{domain:ln(a)}}else return{domain:ln(o)}}getSeriesRange(e,t){return this.domainForVisibleRange("y",[this.yCumulativeKey(this.processedData)],"xValue",t)}getZoomRangeFittingItems(e,t,i){return this.zoomFittingVisibleItems("xValue",[this.yCumulativeKey(this.processedData)],e,t,i)}getVisibleItems(e,t,i){return this.countVisibleItems("xValue",[this.yCumulativeKey(this.processedData)],e,t,i)}aggregateData(e,t){if(this.aggregationManager.markStale(),t.type!=="ungrouped"||lo(t))return;const i=this.axes.x;if(i==null)return;const s=this.estimateTargetRange();this.aggregationManager.aggregate({computePartial:o=>pY(i.scale.type,e,t,this.yCumulativeKey(t),this,s,o),computeFull:o=>uY(i.scale.type,e,t,this.yCumulativeKey(t),this,o),targetRange:s});const n=this.aggregationManager.filters;n&&n.length>0&&Jn.record(`${this.type}:aggregation`,n.map(o=>o.maxRange))}estimateTargetRange(){const e=this.axes.x;if(e?.scale?.range){const[t,i]=e.scale.range;return Math.abs(i-t)}return this.ctx.scene?.canvas?.width??800}createNodeDatumContext(e,t){const{dataModel:i,processedData:s}=this;if(!i||!s)return;const n=s.dataSources.get(this.id)?.data??[],[o,a]=e.range,r=Math.abs(a-o);this.aggregationManager.ensureLevelForRange(r);const l=this.aggregationManager.getFilterForRange(r),c=this.contextNodeData?.nodeData!=null&&(s.changeDescription!=null||!lo(s)||l!=null);return{rawData:n,xValues:i.resolveColumnById(this,"xValue",s),yRawValues:i.resolveColumnById(this,"yValueRaw",s),yCumulativeValues:i.resolveColumnById(this,this.yCumulativeKey(s),s),selectionValues:this.properties.yFilterKey?i.resolveColumnById(this,"yFilterRaw",s):void 0,xScale:e,yScale:t,xOffset:(e.bandwidth??0)/2,yOffset:(t.bandwidth??0)/2,size:this.properties.marker.enabled?this.properties.marker.size:0,yDomain:this.getSeriesDomain("y").domain,labelsEnabled:this.properties.label.enabled,animationEnabled:!this.ctx.animationManager.isSkipped(),canIncrementallyUpdate:c,dataAggregationFilter:l,range:r,xKey:this.properties.xKey,yKey:this.properties.yKey,xName:this.properties.xName,yName:this.properties.yName,legendItemName:this.properties.legendItemName,connectMissingData:this.properties.connectMissingData,capDefaults:{lengthRatioMultiplier:this.properties.marker.getDiameter(),lengthMax:1/0},nodeData:c?this.contextNodeData.nodeData:[],spanPoints:[],nodeIndex:0}}handleDatum(e,t,i){if(t.datum=e.rawData[i],t.xDatum=e.xValues[i],t.yDatum=e.yRawValues[i],t.yCumulative=e.yCumulativeValues[i],t.selected=e.selectionValues?.[i],t.x=e.xScale.convert(t.xDatum)+e.xOffset,t.y=e.yScale.convert(t.yCumulative)+e.yOffset,!!Number.isFinite(t.x)){if(t.yDatum!=null){const s=e.labelsEnabled?this.getLabelText(t.yDatum,t.datum,e.yKey,"y",e.yDomain,this.properties.label,{value:t.yDatum,datum:t.datum,xKey:e.xKey,yKey:e.yKey,xName:e.xName,yName:e.yName,legendItemName:e.legendItemName}):void 0;if(e.canIncrementallyUpdate&&e.nodeIndex<e.nodeData.length){const o=e.nodeData[e.nodeIndex];o.datum=t.datum,o.datumIndex=i,o.point={x:t.x,y:t.y,size:e.size},o.midPoint={x:t.x,y:t.y},o.cumulativeValue=t.yCumulative,o.yValue=t.yDatum,o.xValue=t.xDatum,o.labelText=s,o.selected=t.selected}else e.nodeData.push({series:this,datum:t.datum,datumIndex:i,yKey:e.yKey,xKey:e.xKey,point:{x:t.x,y:t.y,size:e.size},midPoint:{x:t.x,y:t.y},cumulativeValue:t.yCumulative,yValue:t.yDatum,xValue:t.xDatum,capDefaults:e.capDefaults,labelText:s,selected:t.selected});e.nodeIndex++}this.updateSpanPoints(e,t)}}updateSpanPoints(e,t){const i=e.spanPoints.at(-1);if(t.yDatum!=null){const s={point:{x:t.x,y:t.y},xDatum:t.xDatum,yDatum:t.yCumulative};Array.isArray(i)?i.push(s):i==null?e.spanPoints.push([s]):(i.skip+=1,e.spanPoints.push([s]))}else e.connectMissingData||(Array.isArray(i)||i==null?e.spanPoints.push({skip:0}):i.skip+=1)}createNodeData(){const{processedData:e,axes:t}=this,i=t.x,s=t.y;if(!e||!i||!s)return;const n=i.scale,o=s.scale,a=this.createNodeDatumContext(n,o);if(!a)return;const r={datum:void 0,xDatum:void 0,yDatum:void 0,yCumulative:0,selected:void 0,x:0,y:0},l=a.dataAggregationFilter?.indices;let[c,h]=this.visibleRangeIndices("xValue",i.range,l);c=Math.max(c-1,0),h=Math.min(h+1,l?.length??a.xValues.length),e.input.count<1e3&&(c=0,h=e.input.count);for(let y=c;y<h;y+=1)this.handleDatum(a,r,l?.[y]??y);a.canIncrementallyUpdate&&a.nodeIndex<a.nodeData.length&&(a.nodeData.length=a.nodeIndex);const d=a.spanPoints.flatMap(y=>Array.isArray(y)?lf(y,this.properties.interpolation):[]),u={itemId:a.yKey,spans:d},p=a.selectionValues?.some((y,b)=>y===a.yRawValues[b])??!1,f=Ox(this.properties.segmentation,i,s,this.chart.seriesRect,this.ctx.scene,!1);return{itemId:a.yKey,nodeData:a.nodeData,labelData:a.nodeData,strokeData:u,scales:this.calculateScaling(),visible:this.visible,crossFiltering:p,styles:Hx(this,this.properties,this.properties.marker),segments:f}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}updatePathNodes(e){const{paths:[t],visible:i,animationEnabled:s}=e,n=this.contextNodeData?.crossFiltering===!0,o=oe(this.getHighlightStyle(),this.getStyle()),{strokeWidth:a,stroke:r,strokeOpacity:l,lineDash:c,lineDashOffset:h,opacity:d}=o,u=this.contextNodeData?.segments;t.setProperties({segments:u,fill:void 0,lineJoin:"round",pointerEvents:1,opacity:d,stroke:r,strokeWidth:a,strokeOpacity:l*(n?gY:1),lineDash:c,lineDashOffset:h}),t.datum=u,s||(t.visible=i),Wx(this,t)}updateDatumSelection(e){let{nodeData:t}=e;const{datumSelection:i}=e,{contextNodeData:s,processedData:n,axes:o,properties:a}=this,{marker:r}=a;return t=s?.crossFiltering===!0||oI(n.input.count,o.x.scale,r)?t:[],r.isDirty()&&(i.clear(),i.cleanup()),lo(this.processedData)?i.update(t,void 0,c=>cs(c.xValue)):i.update(t)}updateDatumStyles(e){const{datumSelection:t,isHighlight:i}=e,{marker:s}=this.properties,n=this.ctx.highlightManager.getActiveHighlight();t.each((o,a)=>{if(!t.isGarbage(o)){const r=this.getHighlightState(n,e.isHighlight,a.datumIndex),l=this.getStyle(r),{stroke:c,strokeWidth:h,strokeOpacity:d}=l,u=this.makeItemStylerParams(this.dataModel,this.processedData,a.datumIndex,l.marker);a.style=this.getMarkerStyle(s,a,u,{isHighlight:i,highlightState:r},l.marker,{stroke:c,strokeWidth:h,strokeOpacity:d})}})}updateDatumNodes(e){const{contextNodeData:t}=this;if(!t)return;const{datumSelection:i,isHighlight:s,drawingMode:n}=e,o=this.ctx.animationManager.isSkipped(),a=this.getShapeFillBBox(),r=this.ctx.highlightManager.getActiveHighlight();i.each((l,c)=>{const h=this.getHighlightState(r,s,c.datumIndex),d=c.style??t.styles[h];this.applyMarkerStyle(d,l,c.point,a,{applyTranslation:o,selected:c.selected}),l.drawingMode=n}),s||this.properties.marker.markClean()}updateLabelSelection(e){return e.labelSelection.update(this.isLabelEnabled()?e.labelData:[])}updateLabelNodes(e){const{isHighlight:t=!1}=e,i=this.ctx.highlightManager?.getActiveHighlight(),s=this.makeLabelFormatterParams();e.labelSelection.each((n,o)=>{const a=fh(this,o,s,this.properties.label,t,i),{enabled:r,fontStyle:l,fontWeight:c,fontSize:h,fontFamily:d,color:u}=a;r&&o?.labelText?(n.fontStyle=l,n.fontWeight=c,n.fontSize=h,n.fontFamily=d,n.textAlign="center",n.textBaseline="bottom",n.text=o.labelText,n.x=o.point.x,n.y=o.point.y-10,n.fill=u,n.visible=!0,n.fillOpacity=this.getHighlightStyle(t,o.datumIndex).opacity??1,n.setBoxing(a)):n.visible=!1})}makeStylerParams(e){const{id:t}=this,{marker:i,lineDash:s,lineDashOffset:n,stroke:o,strokeOpacity:a,strokeWidth:r,xKey:l,yKey:c}=this.properties,h=lu(e??0);return{marker:{fill:i.fill,fillOpacity:i.fillOpacity,size:i.size,shape:i.shape,stroke:i.stroke,strokeOpacity:i.strokeOpacity,strokeWidth:i.strokeWidth,lineDash:i.lineDash,lineDashOffset:i.lineDashOffset},highlightState:h,lineDash:s,lineDashOffset:n,seriesId:t,stroke:o,strokeOpacity:a,strokeWidth:r,xKey:l,yKey:c}}makeItemStylerParams(e,t,i,s){const{xKey:n,yKey:o}=this.properties,a=e.resolveColumnById(this,"xValue",t)[i],r=e.resolveColumnById(this,"yValueRaw",t)[i],l=e.getDomain(this,"xValue","key",t).domain,c=e.getDomain(this,this.yCumulativeKey(t),"value",t).domain,h=this.filterItemStylerFillParams(s.fill)??s.fill;return{...KM(a,r,n,o,l,c),xValue:a,yValue:r,...s,fill:h}}makeLabelFormatterParams(){const{xKey:e,xName:t,yKey:i,yName:s,legendItemName:n}=this.properties;return{xKey:e,xName:t,yKey:i,yName:s,legendItemName:n}}getTooltipContent(e){const{id:t,dataModel:i,processedData:s,axes:n,properties:o}=this,{xKey:a,xName:r,yKey:l,yName:c,tooltip:h,legendItemName:d}=o,u=n.x,p=n.y;if(!i||!s||!u||!p)return;const f=s.dataSources.get(this.id)?.data?.[e],y=i.resolveColumnById(this,"xValue",s)[e],b=i.resolveColumnById(this,"yValueRaw",s)[e];if(y==null)return;const x=this.getStyle(),v=this.makeItemStylerParams(i,s,e,x.marker),S=this.getMarkerStyle(this.properties.marker,{datumIndex:e,datum:f},v,{isHighlight:!1},x.marker);return this.formatTooltipWithContext(h,{heading:this.getAxisValueText(u,"tooltip",y,f,a,d),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:l,value:this.getAxisValueText(p,"tooltip",b,f,l,d),missing:Jc(b)}]},{seriesId:t,datum:f,title:c,xKey:a,xName:r,yKey:l,yName:c,...S,...this.getModuleTooltipParams()})}legendItemSymbol(){const{stroke:e,strokeOpacity:t,strokeWidth:i,lineDash:s,marker:n}=this.getStyle();return{marker:{...this.getMarkerStyle(this.properties.marker,{},void 0,{isHighlight:!1,checkForHighlight:!1},{size:n.size,shape:n.shape,fill:n.fill,fillOpacity:n.fillOpacity,stroke:n.stroke,strokeOpacity:n.strokeOpacity,strokeWidth:n.strokeWidth,lineDash:n.lineDash,lineDashOffset:n.lineDashOffset}),enabled:this.properties.marker.enabled},line:{enabled:!0,stroke:e,strokeOpacity:t,strokeWidth:i,lineDash:s}}}getLegendData(e){if(e!=="category")return[];const{id:t,ctx:{legendManager:i},visible:s}=this,{yKey:n,yName:o,title:a,legendItemName:r,showInLegend:l}=this.properties;return[{legendType:e,id:t,itemId:n,legendItemName:r,seriesId:t,enabled:s&&i.getItemEnabled({seriesId:t,itemId:n}),label:{text:r??a??o??n},symbol:this.legendItemSymbol(),hideInLegend:!l}]}updatePaths(e){this.updateLinePaths(e.paths,e.contextData)}updateLinePaths(e,t){const i=t.strokeData.spans,[s]=e;s.path.clear(),qD(s,i),s.markDirty("LineSeries")}resetDatumAnimation(e){nI([e.datumSelection])}animateEmptyUpdateReady(e){const{datumSelection:t,labelSelection:i,annotationSelections:s,contextData:n,paths:o}=e,{animationManager:a}=this.ctx;this.updateLinePaths(o,n),aI(this,a,...o),Ui([t],pf),sI(this,a,t),qt(this,"labels",a,i),qt(this,"annotations",a,...s)}animateReadyResize(e){const{contextData:t,paths:i}=e;this.updateLinePaths(i,t),super.animateReadyResize(e)}animateWaitingUpdateReady(e){const{animationManager:t}=this.ctx,{datumSelection:i,labelSelection:s,annotationSelections:n,contextData:o,paths:a,previousContextData:r}=e,[l]=a;if(o.visible===!1&&r?.visible===!1)return;this.resetDatumAnimation(e),this.resetLabelAnimation(e);const c=()=>{this.resetPathAnimation(e),this.updateLinePaths(a,o)},h=()=>{t.skipCurrentBatch(),c()};if(o==null||r==null){c(),uf(this,t,"added",i),jx(this,"path_properties",t,"add",l),qt(this,"labels",t,s),qt(this,"annotations",t,...n);return}if(o.crossFiltering!==r.crossFiltering){h();return}const d=VK(o,r,this.processedData?.reduced?.diff?.[this.id]);if(d===void 0){h();return}else if(d.status==="no-op")return;li(this.id,"path_properties",t,[l],d.stroke.pathProperties),d.status==="added"?this.updateLinePaths(a,o):d.status==="removed"?this.updateLinePaths(a,r):Yx(this.id,"path_update",t,[l],d.stroke.path),d.hasMotion&&(uf(this,t,void 0,i),qt(this,"labels",t,s),qt(this,"annotations",t,...n)),this.ctx.animationManager.animate({id:this.id,groupId:"reset_after_animation",phase:"trailing",from:{},to:{},onComplete:()=>this.updateLinePaths(a,o)})}isLabelEnabled(){return this.properties.label.enabled}getBandScalePadding(){return{inner:1,outer:.1}}nodeFactory(){return new ki}getStyle(e){const{styler:t,marker:i,lineDash:s,lineDashOffset:n,stroke:o,strokeOpacity:a,strokeWidth:r}=this.properties,{size:l,shape:c,fill:h="transparent",fillOpacity:d}=i;let u={};if(t){const p=this.makeStylerParams(e),f=this.cachedCallWithContext(t,p)??{};u=this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],f,{pick:!1})??{}}return u.marker??(u.marker={}),{lineDash:u.lineDash??s,lineDashOffset:u.lineDashOffset??n,stroke:u.stroke??o,strokeOpacity:u.strokeOpacity??a,strokeWidth:u.strokeWidth??r,marker:{fill:u.marker.fill??h,fillOpacity:u.marker.fillOpacity??d,shape:u.marker.shape??c,size:u.marker.size??l,lineDash:u.marker.lineDash??i.lineDash??s,lineDashOffset:u.marker.lineDashOffset??i.lineDashOffset??n,stroke:u.marker.stroke??i.stroke??o,strokeOpacity:u.marker.strokeOpacity??i.strokeOpacity??a,strokeWidth:u.marker.strokeWidth??i.strokeWidth??r}}}getFormattedMarkerStyle(e){const t=this.getStyle(),i=this.makeItemStylerParams(this.dataModel,this.processedData,e.datumIndex,t.marker);return this.getMarkerStyle(this.properties.marker,e,i,{isHighlight:!0},void 0,t)}computeFocusBounds(e){return Gx(this,e)}hasItemStylers(){return this.properties.styler!=null||this.properties.marker.itemStyler!=null||this.properties.label.itemStyler!=null}};VI.className="LineSeries",VI.type="line";var fY={series:{stroke:gD,strokeWidth:2,strokeOpacity:1,lineDash:[0],lineDashOffset:0,interpolation:{type:"linear"},marker:{shape:"circle",size:7,strokeWidth:{$isUserOption:["./stroke",1,0]},fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",$g],["image",Ar],["pattern",Pn]]},stroke:{$palette:"stroke"}},label:{...ka,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},tooltip:{range:{$path:["/tooltip/range","nearest"]},position:{anchorTo:{$path:["/tooltip/position/anchorTo","node"]}}},highlight:mD(),segmentation:yx}},lb={type:"series",name:"line",chartType:"cartesian",stackable:!0,version:ue,dependencies:[oi],options:Yg,predictAxis:sf,defaultAxes:{y:{type:"number",position:"left"},x:{type:"category",position:"bottom"}},axisKeys:{x:"xKeyAxis",y:"yKeyAxis"},themeTemplate:fY,create:e=>new VI(e)},GI=class extends ab{};GI.className="ScatterSeries",GI.type="scatter";var mY={series:{shape:"circle",size:7,fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",$g],["image",Ar],["pattern",Pn]]},stroke:{$palette:"stroke"},fillOpacity:.8,maxRenderedItems:2e3,label:{...ka,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},tooltip:{range:{$path:["/tooltip/range","nearest"]},position:{anchorTo:{$path:["/tooltip/position/anchorTo","node"]}}},highlight:Ug()}},HI={type:"series",name:"scatter",chartType:"cartesian",version:ue,dependencies:[oi],options:Dx,predictAxis:_D,defaultAxes:{x:{type:"number",position:"bottom"},y:{type:"number",position:"left"}},axisKeys:{x:"xKeyAxis",y:"yKeyAxis"},themeTemplate:mY,create:e=>new GI(e)},U2=class extends Et{constructor(){super(...arguments),this.showInLegend=!1}};g([m],U2.prototype,"showInLegend",2);var jI=class extends Yt{constructor(){super(...arguments),this.spacing=2}set(e,t){return super.set(e)}};g([m],jI.prototype,"text",2),g([m],jI.prototype,"spacing",2);var WI=class extends K{constructor(){super(...arguments),this.fill="transparent",this.fillOpacity=1}};g([m],WI.prototype,"fill",2),g([m],WI.prototype,"fillOpacity",2);var ju=class extends Yt{constructor(){super(...arguments),this.offset=3,this.minAngle=0,this.minSpacing=4,this.maxCollisionOffset=50,this.avoidCollisions=!0}};g([m],ju.prototype,"offset",2),g([m],ju.prototype,"minAngle",2),g([m],ju.prototype,"minSpacing",2),g([m],ju.prototype,"maxCollisionOffset",2),g([m],ju.prototype,"avoidCollisions",2);var $I=class extends Yt{constructor(){super(...arguments),this.positionOffset=0,this.positionRatio=.5}};g([m],$I.prototype,"positionOffset",2),g([m],$I.prototype,"positionRatio",2);var mf=class extends K{constructor(){super(...arguments),this.length=10,this.strokeWidth=1}};g([m],mf.prototype,"colors",2),g([m],mf.prototype,"length",2),g([m],mf.prototype,"strokeWidth",2),g([m],mf.prototype,"itemStyler",2);var je=class extends Go{constructor(){super(...arguments),this.defaultColorRange=[],this.defaultPatternFills=[],this.fills=Object.values(hi),this.strokes=Object.values(kr),this.fillOpacity=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.outerRadiusOffset=0,this.outerRadiusRatio=1,this.strokeWidth=1,this.sectorSpacing=0,this.hideZeroValueSectorsInLegend=!1,this.innerLabels=new Pi(jI),this.title=new U2,this.innerCircle=new WI,this.shadow=new Ta,this.calloutLabel=new ju,this.sectorLabel=new $I,this.calloutLine=new mf,this.tooltip=yh()}};g([m],je.prototype,"angleKey",2),g([m],je.prototype,"angleName",2),g([m],je.prototype,"angleFilterKey",2),g([m],je.prototype,"radiusKey",2),g([m],je.prototype,"radiusName",2),g([m],je.prototype,"radiusMin",2),g([m],je.prototype,"radiusMax",2),g([m],je.prototype,"calloutLabelKey",2),g([m],je.prototype,"calloutLabelName",2),g([m],je.prototype,"sectorLabelKey",2),g([m],je.prototype,"sectorLabelName",2),g([m],je.prototype,"legendItemKey",2),g([m],je.prototype,"defaultColorRange",2),g([m],je.prototype,"defaultPatternFills",2),g([m],je.prototype,"fills",2),g([m],je.prototype,"strokes",2),g([m],je.prototype,"fillOpacity",2),g([m],je.prototype,"strokeOpacity",2),g([m],je.prototype,"lineDash",2),g([m],je.prototype,"lineDashOffset",2),g([m],je.prototype,"cornerRadius",2),g([m],je.prototype,"itemStyler",2),g([m],je.prototype,"rotation",2),g([m],je.prototype,"outerRadiusOffset",2),g([m],je.prototype,"outerRadiusRatio",2),g([m],je.prototype,"innerRadiusOffset",2),g([m],je.prototype,"innerRadiusRatio",2),g([m],je.prototype,"strokeWidth",2),g([m],je.prototype,"sectorSpacing",2),g([m],je.prototype,"hideZeroValueSectorsInLegend",2),g([m],je.prototype,"innerLabels",2),g([m],je.prototype,"title",2),g([m],je.prototype,"innerCircle",2),g([m],je.prototype,"shadow",2),g([m],je.prototype,"calloutLabel",2),g([m],je.prototype,"sectorLabel",2),g([m],je.prototype,"calloutLine",2),g([m],je.prototype,"tooltip",2);function UI(e,t,i,s){const n=[i.convert(0),i.convert(1)],o=[s.convert(0),s.convert(1)],a=Math.PI/-2+mt(t),r=e?"initial":"update",l=({radius:f})=>({innerRadius:n[0],outerRadius:n[0]+(n[1]-n[0])*f}),c=({radius:f})=>({innerRadius:o[0],outerRadius:o[0]+(o[1]-o[0])*f});return{nodes:{toFn:(f,y,b,{prevLive:x})=>{let{startAngle:v,endAngle:S,innerRadius:M,outerRadius:D}=y;const{stroke:k,fill:I}=y.sectorFormat;if(b==="removed"&&x?(v=x.datum?.endAngle,S=x.datum?.endAngle):b==="removed"&&!x&&(v=a,S=a),b==="removed"){const A=l(y);M=A.innerRadius,D=A.outerRadius}return{startAngle:v,endAngle:S,outerRadius:D,innerRadius:M,stroke:k,fill:I}},fromFn:(f,y,b,{prevFromProps:x})=>{let{startAngle:v,endAngle:S,innerRadius:M,outerRadius:D}=f,{fill:k,stroke:I}=y.sectorFormat;if(b==="updated"&&f.previousDatum==null&&(b="added"),b==="unknown"||b==="added"&&!x?(v=a,S=a,M=y.innerRadius,D=y.outerRadius):b==="added"&&x&&(v=x.endAngle??a,S=x.endAngle??a,M=x.innerRadius??y.innerRadius,D=x.outerRadius??y.outerRadius),b==="added"&&!e){const A=c(y);M=A.innerRadius,D=A.outerRadius}return b==="updated"&&(k=f.fill??k,I=(typeof f.stroke=="string"?f.stroke:void 0)??I),{startAngle:v,endAngle:S,innerRadius:M,outerRadius:D,fill:k,stroke:I,phase:r}}},innerCircle:{fromFn:(f,y)=>({size:f.previousDatum?.radius??f.size??0,phase:r}),toFn:(f,y)=>({size:y.radius??0})}}}function yY(e,t){return{startAngle:t.startAngle,endAngle:t.endAngle,innerRadius:t.innerRadius,outerRadius:t.outerRadius,stroke:t.sectorFormat.stroke}}function xY(e,t){const i=t.y-e.centerY,s=t.x-e.centerX,n=Math.atan2(i,s),o=e.getItemNodes();for(const a of o)if(a.datum.missing!==!0&&Us(n,a.startAngle,a.endAngle)){const r=Math.hypot(s,i);let l=0;return r<a.innerRadius?l=a.innerRadius-r:r>a.outerRadius&&(l=r-a.outerRadius),{datum:a.datum,distance:l}}}var bY=class extends gx{constructor(e,t,i,s){super(e,t,i,s),this.angleKey=s.properties.angleKey,this.radiusKey=s.properties.radiusKey,this.calloutLabelKey=s.properties.calloutLabelKey,this.sectorLabelKey=s.properties.sectorLabelKey}},cb=class extends lI{constructor(e){super({moduleCtx:e,categoryKey:void 0,propertyKeys:{...u2,sectorLabel:["sectorLabelKey"],calloutLabel:["calloutLabelKey"]},propertyNames:{...p2,sectorLabel:["sectorLabelName"],calloutLabel:["calloutLabelName"]},pickModes:[1,0],animationResetFns:{item:yY,label:mh}}),this.properties=new je,this.phantomNodeData=void 0,this.backgroundGroup=new ls({name:`${this.id}-background`,zIndex:0}),this.noVisibleData=!1,this.previousRadiusScale=new gh,this.radiusScale=new gh,this.phantomGroup=this.contentGroup.appendChild(new Oe({name:"phantom",zIndex:-1})),this.phantomSelection=ci.select(this.phantomGroup,()=>this.nodeFactory(),!1),this.phantomHighlightGroup=this.highlightGroup.appendChild(new Oe({name:"phantom",zIndex:-1})),this.phantomHighlightSelection=ci.select(this.phantomHighlightGroup,()=>this.nodeFactory(),!1),this.calloutLabelGroup=this.contentGroup.appendChild(new Oe({name:"pieCalloutLabels"})),this.calloutLabelSelection=new ci(this.calloutLabelGroup,Oe),this.zerosumRingsGroup=this.backgroundGroup.appendChild(new Oe({name:`${this.id}-zerosumRings`})),this.zerosumOuterRing=this.zerosumRingsGroup.appendChild(new ki({shape:"circle"})),this.zerosumInnerRing=this.zerosumRingsGroup.appendChild(new ki({shape:"circle"})),this.innerLabelsGroup=this.contentGroup.appendChild(new Oe({name:"innerLabels"})),this.innerCircleGroup=this.backgroundGroup.appendChild(new Oe({name:`${this.id}-innerCircle`})),this.innerLabelsSelection=ci.select(this.innerLabelsGroup,rn),this.innerCircleSelection=ci.select(this.innerCircleGroup,()=>new ki({shape:"circle"})),this.surroundingRadius=void 0,this.NodeEvent=bY,this.angleScale=new gh,this.angleScale.domain=[0,1],this.angleScale.range=[-Math.PI,Math.PI].map(t=>t+Math.PI/2),this.phantomGroup.opacity=.2,this.phantomHighlightGroup.opacity=.2,this.innerLabelsGroup.pointerEvents=1}get calloutNodeData(){return this.phantomNodeData??this.nodeData}attachSeries(e,t,i){super.attachSeries(e,t,i),e?.appendChild(this.backgroundGroup)}detachSeries(e,t,i){super.detachSeries(e,t,i),this.backgroundGroup.remove()}setZIndex(e){super.setZIndex(e),this.backgroundGroup.zIndex=[0,e]}nodeFactory(){const e=new ms;return e.miterLimit=1e9,e}getSeriesDomain(e){return e==="angle"?{domain:this.angleScale.domain}:{domain:this.radiusScale.domain}}async processData(e){if(this.data==null)return;const{visible:t,id:i,ctx:{legendManager:s}}=this,{angleKey:n,angleFilterKey:o,radiusKey:a,calloutLabelKey:r,sectorLabelKey:l,legendItemKey:c}=this.properties,h=()=>(b,x)=>t&&s.getItemEnabled({seriesId:i,itemId:x})?b:0,d=!this.ctx.animationManager.isSkipped(),u=[],p=[];c?u.push(Ll(c,"category",{id:"legendItemKey"})):r?u.push(Ll(r,"category",{id:"calloutLabelKey"})):l&&u.push(Ll(l,"category",{id:"sectorLabelKey"}));const f=this.radiusScale.type,y=this.angleScale.type;a&&p.push(Bj(a,{id:"radiusValue",min:this.properties.radiusMin??0,max:this.properties.radiusMax,missingValue:this.properties.radiusMax??1,processor:h}),Ct(a,f,{id:"radiusRaw",processor:h}),WM("radiusValue",[0,1],1,this.properties.radiusMin??0,this.properties.radiusMax)),r&&p.push(Ct(r,"category",{id:"calloutLabelValue"})),l&&p.push(Ct(l,"category",{id:"sectorLabelValue"})),c&&p.push(Ct(c,"category",{id:"legendItemValue"})),o&&p.push(jM(o,y,{id:"angleFilterValue",onlyPositive:!0,invalidValue:0,processor:h}),Ct(o,y,{id:"angleFilterRaw"}),WM("angleFilterValue",[0,1],0,0)),d&&this.processedData?.reduced?.animationValidation?.uniqueKeys&&u.length>0&&p.push(ax(this.id,this.processedData)),p.push(Fg()),await this.requestDataModel(e,this.data,{props:[...u,jM(n,y,{id:"angleValue",onlyPositive:!0,invalidValue:0,processor:h}),Ct(n,y,{id:"angleRaw"}),WM("angleValue",[0,1],0,0),...p]});for(const b of this.processedData?.defs?.values??[]){const{id:x,missing:v,property:S}=b,M=LT(this,v);x!=="angleRaw"&&M>0&&j.warnOnce(`no value was found for the key '${String(S)}' on ${M} data element${M>1?"s":""}`)}this.animationState.transition("updateData")}maybeRefreshNodeData(){if(!this.nodeDataRefresh)return;const{nodeData:e=[],phantomNodeData:t}=this.createNodeData()??{};this.nodeData=e,this.phantomNodeData=t,e.length>0&&Jn.record(`${this.type}:nodeData`,e.length),this.nodeDataRefresh=!1}getProcessedDataValues(e,t){const i=e.resolveColumnById(this,"angleValue",t),s=e.resolveColumnById(this,"angleRaw",t),n=this.properties.angleFilterKey==null?void 0:e.resolveColumnById(this,"angleFilterValue",t),o=this.properties.angleFilterKey==null?void 0:e.resolveColumnById(this,"angleFilterRaw",t),a=this.properties.radiusKey?e.resolveColumnById(this,"radiusValue",t):void 0,r=this.properties.radiusKey?e.resolveColumnById(this,"radiusRaw",t):void 0,l=this.properties.calloutLabelKey?e.resolveColumnById(this,"calloutLabelValue",t):void 0,c=this.properties.sectorLabelKey?e.resolveColumnById(this,"sectorLabelValue",t):void 0,h=this.properties.legendItemKey?e.resolveColumnById(this,"legendItemValue",t):void 0;return{angleValues:i,angleRawValues:s,angleFilterValues:n,angleFilterRawValues:o,radiusValues:a,radiusRawValues:r,calloutLabelValues:l,sectorLabelValues:c,legendItemValues:h}}createNodeData(){const{id:e,processedData:t,dataModel:i,angleScale:s,ctx:{legendManager:n},visible:o}=this,{rotation:a,innerRadiusRatio:r}=this.properties;if(!i||t?.type!=="ungrouped")return;const l=this.getProcessedDataValues(i,t),{angleValues:c,angleRawValues:h,angleFilterValues:d,angleFilterRawValues:u,radiusValues:p,radiusRawValues:f,legendItemValues:y}=l,b=u?.some((I,A)=>I>h[A])??!1;let x=0,v=0;const S=[],M=u==null?void 0:[],D=t.dataSources.get(this.id)?.data??[],k=t.invalidData?.get(this.id);for(const[I,A]of D.entries()){if(k?.[I]===!0)continue;const C=b?d[I]:c[I],w=u!=null&&!b?Math.sqrt(u[I]/h[I]):1,T=s.convert(x)+mt(a);x=C,v+=C;const O=s.convert(x)+mt(a),E=Math.abs(O-T),z=T+E/2,F=h[I],G=(p?.[I]??1)*w,B=f?.[I],V=y?.[I],Y=this.getLabels(I,A,z,E,l),X=this.getItemStyle({datum:A,datumIndex:I},!1),q={itemId:I,series:this,datum:A,datumIndex:I,angleValue:F,midAngle:z,midCos:Math.cos(z),midSin:Math.sin(z),startAngle:T,endAngle:O,radius:G,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(G),0),sectorFormat:X,radiusValue:B,legendItemValue:V,enabled:o&&n.getItemEnabled({seriesId:e,itemId:I}),focusable:!0,...Y};S.push(q),M?.push({...q,radius:1,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(1),0),focusable:!1})}return this.zerosumOuterRing.visible=v===0,this.zerosumInnerRing.visible=v===0&&r!=null&&r!==1&&r>0,{itemId:e,nodeData:S,labelData:S,phantomNodeData:M}}getLabelContent(e,t,i){const{id:s,ctx:n,properties:o}=this,{formatManager:a}=n,{calloutLabel:r,sectorLabel:l,calloutLabelKey:c,sectorLabelKey:h,legendItemKey:d}=o,u=i.calloutLabelValues?.[e],p=i.sectorLabelValues?.[e],f=i.legendItemValues?.[e],y={datum:t,angleKey:this.properties.angleKey,angleName:this.properties.angleName,radiusKey:this.properties.radiusKey,radiusName:this.properties.radiusName,calloutLabelKey:this.properties.calloutLabelKey,calloutLabelName:this.properties.calloutLabelName,sectorLabelKey:this.properties.sectorLabelKey,sectorLabelName:this.properties.sectorLabelName,legendItemKey:this.properties.legendItemKey},b={callout:void 0,sector:void 0,legendItem:void 0};return c&&(b.callout=this.getLabelText(u,t,c,"calloutLabel",[],r,{...y,value:u})),h&&(b.sector=this.getLabelText(p,t,h,"sectorLabel",[],l,{...y,value:p})),d!=null&&f!=null&&(b.legendItem=a.format(this.callWithContext.bind(this),{type:"category",value:f,datum:t,seriesId:s,legendItemName:void 0,key:d,source:"legend-label",property:"legendItem",domain:[],boundSeries:this.getFormatterContext("legendItem")})??f),b}getLabels(e,t,i,s,n){const{properties:o}=this,{calloutLabel:a,sectorLabel:r,legendItemKey:l}=o,c=this.getLabelContent(e,t,n),h={};return a.enabled&&c.callout&&s>=mt(a.minAngle)&&(h.calloutLabel={...this.getTextAlignment(i),text:c.callout,hidden:!1,collisionTextAlign:void 0,collisionOffsetY:0,box:void 0}),r.enabled&&c.sector&&(h.sectorLabel={text:c.sector}),l&&c.legendItem&&(h.legendItem={key:l,text:c.legendItem}),h}getTextAlignment(e){const t=[{textAlign:"center",textBaseline:"bottom"},{textAlign:"left",textBaseline:"middle"},{textAlign:"center",textBaseline:"top"},{textAlign:"right",textBaseline:"middle"}],i=ag(e),s=-.75*Math.PI,n=i-s,o=Math.floor(n/(Math.PI/2)),a=yS(o,t.length);return t[a]}getFillParams(e,t,i){if(!(!Ut(e)||e.bounds==="item"))return{centerX:0,centerY:0,innerRadius:t,outerRadius:i}}getItemStyle({datum:e,datumIndex:t},i,s,n){const{fills:o,strokes:a,itemStyler:r}=this.properties,l=a[t],c=o[t],{fill:h,fillOpacity:d,stroke:u,strokeWidth:p,strokeOpacity:f,lineDash:y,lineDashOffset:b,cornerRadius:x,opacity:v}=oe(this.getHighlightStyle(i,t,s,n),{fill:c,stroke:l},this.properties);let S;return r&&(S=this.cachedDatumCallback(this.getDatumId(t)+(i?"-highlight":"-hide"),()=>{const M=this.makeItemStylerParams(e,t,i,{fill:h,fillOpacity:d,stroke:u,strokeWidth:p,strokeOpacity:f,lineDash:y,lineDashOffset:b,cornerRadius:x});return this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],this.callWithContext(r,M),{proxyPaths:{fill:["fills",`${t}`],stroke:["strokes",`${t}`]}})})),{fill:S?.fill??h,fillOpacity:S?.fillOpacity??d,stroke:S?.stroke??u,strokeWidth:S?.strokeWidth??p,strokeOpacity:S?.strokeOpacity??f,lineDash:S?.lineDash??y,lineDashOffset:S?.lineDashOffset??b,cornerRadius:S?.cornerRadius??x,opacity:v}}makeItemStylerParams(e,t,i,s){const{angleKey:n,radiusKey:o,calloutLabelKey:a,sectorLabelKey:r,legendItemKey:l}=this.properties,c=this.filterItemStylerFillParams(s.fill)??s.fill;return{datum:e,angleKey:n,radiusKey:o,calloutLabelKey:a,sectorLabelKey:r,legendItemKey:l,...s,fill:c,highlightState:this.getHighlightStateString(this.ctx.highlightManager?.getActiveHighlight(),i,t),seriesId:this.id}}getCalloutLineStyle(e,t){const{properties:i}=this;let s={};if(i.calloutLine.itemStyler){const n=this.getHighlightStateString(this.ctx.highlightManager?.getActiveHighlight(),t,e.datumIndex),o={angleKey:i.angleKey,angleName:i.angleName??i.angleKey,calloutLabelKey:i.calloutLabelKey,calloutLabelName:i.calloutLabelName??i.calloutLabelKey,datum:e.datum,highlightState:n,legendItemKey:i.legendItemKey,radiusKey:i.radiusKey,radiusName:i.radiusName??i.radiusKey,sectorLabelKey:i.sectorLabelKey,sectorLabelName:i.sectorLabelName??i.sectorLabelKey,seriesId:this.id};s=this.cachedCallWithContext(i.calloutLine.itemStyler,o)??{}}return{length:s.length??i.calloutLine.length,strokeWidth:s.strokeWidth??i.calloutLine.strokeWidth,color:s.color,colors:i.calloutLine.colors}}getInnerRadius(){const{radius:e}=this,{innerRadiusRatio:t=1,innerRadiusOffset:i=0}=this.properties,s=e*t+i;return s===e||s<0?0:s}getOuterRadius(){const{outerRadiusRatio:e,outerRadiusOffset:t}=this.properties;return Math.max(this.radius*e+t,0)}updateRadiusScale(e){const t=[this.getInnerRadius(),this.getOuterRadius()];this.radiusScale.range=t,e&&(this.previousRadiusScale.range=t);const i=s=>({...s,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(s.radius),0)});this.nodeData=this.nodeData.map(i),this.phantomNodeData=this.phantomNodeData?.map(i)}getTitleTranslationY(){const e=Math.max(0,this.radiusScale.range[1]);if(e===0)return Number.NaN;const i=2+(this.properties.title?.spacing??0),s=Math.max(0,-e);return-e-i-s}update({seriesRect:e}){const{title:t}=this.properties,i={seriesRectWidth:e?.width,seriesRectHeight:e?.height},s=Ln(this.nodeDataDependencies,i)!=null;if(s&&(this._nodeDataDependencies=i),this.maybeRefreshNodeData(),this.updateTitleNodes(),this.updateRadiusScale(s),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.backgroundGroup.translationX=this.centerX,this.backgroundGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),t){const n=this.getTitleTranslationY();t.node.y=Number.isFinite(n)?n:0;const o=t.node.getBBox();t.node.visible=t.enabled&&Number.isFinite(n)&&!this.bboxIntersectsSurroundingSeries(o)}for(const n of[this.zerosumInnerRing,this.zerosumOuterRing])n.fillOpacity=0,n.stroke=this.properties.calloutLabel.color,n.strokeWidth=1,n.strokeOpacity=1;this.updateNodeMidPoint(),this.updateSelections(),this.updateNodes(e)}updateTitleNodes(){const{oldTitle:e}=this,{title:t}=this.properties;e!==t&&(e&&e.node.remove(),t&&(t.node.textBaseline="bottom",this.labelGroup?.appendChild(t.node)),this.oldTitle=t)}updateNodeMidPoint(){const e=t=>{const i=t.innerRadius+(t.outerRadius-t.innerRadius)/2;t.midPoint={x:t.midCos*Math.max(0,i),y:t.midSin*Math.max(0,i)}};for(const t of this.nodeData)e(t);if(this.phantomNodeData)for(const t of this.phantomNodeData)e(t)}updateSelections(){this.updateGroupSelection(),this.updateInnerCircleSelection()}updateGroupSelection(){const{itemSelection:e,highlightSelection:t,phantomSelection:i,phantomHighlightSelection:s,calloutLabelSelection:n,labelSelection:o,highlightLabelSelection:a,innerLabelsSelection:r}=this,l=this.nodeData.map(d=>({...d,sectorFormat:{...d.sectorFormat}})),c=this.phantomNodeData?.map(d=>({...d,sectorFormat:{...d.sectorFormat}})),h=(d,u)=>{d.update(u,void 0,p=>this.getDatumId(p.datumIndex)),this.ctx.animationManager.isSkipped()&&d.cleanup()};h(e,this.nodeData),h(t,l),h(i,this.phantomNodeData??[]),h(s,c??[]),n.update(this.calloutNodeData,d=>{const u=new En;u.tag=0,u.pointerEvents=1,d.appendChild(u);const p=new rn;p.tag=1,p.pointerEvents=1,d.appendChild(p)}),o.update(this.nodeData),a.update(l),r.update(this.properties.innerLabels,d=>{d.pointerEvents=1})}updateInnerCircleSelection(){const{innerCircle:e}=this.properties;let t=0;const i=this.getInnerRadius();if(i>0){const n=Math.min(i,this.getOuterRadius()),o=1;t=Math.ceil(n*2+o)}const s=e?[{radius:t}]:[];this.innerCircleSelection.update(s)}updateNodes(e){const t=this.ctx.highlightManager.getActiveHighlight(),{visible:i,dataModel:s,processedData:n}=this;if(this.backgroundGroup.visible=i,this.contentGroup.visible=i,!s||!n)return;const{legendItemValues:o}=this.getProcessedDataValues(s,n),a=this.isSeriesHighlighted(t,o),r=this.ctx.chartService.highlight?.drawingMode??"overlay";this.highlightGroup.visible=i&&a,this.labelGroup.visible=i,this.innerCircleSelection.each((p,{radius:f})=>{p.setProperties({fill:this.properties.innerCircle?.fill,opacity:this.properties.innerCircle?.fillOpacity,size:f})});const l=this.radiusScale.range[0],c=this.radiusScale.range[1],h=this.getShapeFillBBox(),d=this.ctx.animationManager.isSkipped(),u=(p,f,y,b,x)=>{const v=this.getItemStyle(f,b,void 0,o);f.sectorFormat.fill=v.fill,f.sectorFormat.stroke=v.stroke,d&&(p.startAngle=f.startAngle,p.endAngle=f.endAngle,p.innerRadius=f.innerRadius,p.outerRadius=f.outerRadius),(b||d)&&(p.fill=v.fill,p.stroke=v.stroke);const S=this.getFillParams(v.fill,l,c);p.setStyleProperties(v,h,S),p.drawingMode=x,p.cornerRadius=v.cornerRadius,p.fillShadow=this.properties.shadow;const M=Math.max((this.properties.sectorSpacing+(v.stroke==null?0:v.strokeWidth))/2,0);p.inset=M,p.lineJoin=this.properties.sectorSpacing>=0||M>0?"miter":"round"};this.itemSelection.each((p,f,y)=>u(p,f,y,!1,"overlay")),this.phantomSelection.each((p,f,y)=>u(p,f,y,!1,"overlay")),this.highlightSelection.each((p,f,y)=>{u(p,f,y,!0,r),p.visible=f.itemId===t?.itemId}),this.phantomHighlightSelection.each((p,f,y)=>{u(p,f,y,!0,r),p.visible=f.itemId===t?.itemId}),this.updateCalloutLineNodes(),this.updateCalloutLabelNodes(e),this.updateSectorLabelNodes(),this.updateInnerLabelNodes(),this.updateZerosumRings(),this.animationState.transition("update")}updateCalloutLineNodes(){const{strokes:e}=this.properties,{offset:t}=this.properties.calloutLabel;for(const i of this.calloutLabelSelection.selectByTag(0)){const s=i.closestDatum(),{length:n,strokeWidth:o,color:a,colors:r}=this.getCalloutLineStyle(s,!1),l=o,c=Y0(r)?r:e,{calloutLabel:h,outerRadius:d,datumIndex:u}=s;if(h?.text&&!h.hidden&&d!==0){i.visible=!0,i.strokeWidth=l,i.stroke=a??c[u%c.length],i.strokeOpacity=this.getHighlightStyle(!1,s.datumIndex).opacity??1,i.fill=void 0;const p=s.midCos*d,f=s.midSin*d;let y=s.midCos*(d+n),b=s.midSin*(d+n);if((h.collisionTextAlign??h.collisionOffsetY!==0)&&h.box!=null){const v=h.box;let S=y,M=b;y<v.x?S=v.x:y>v.x+v.width&&(S=v.x+v.width),b<v.y?M=v.y:b>v.y+v.height&&(M=v.y+v.height);const D=S-y,k=M-b,I=Math.sqrt(Math.pow(D,2)+Math.pow(k,2)),A=I-t;A>0&&(y=y+D*A/I,b=b+k*A/I)}i.x1=p,i.y1=f,i.x2=y,i.y2=b}else i.visible=!1}}getLabelOverflow(e,t){const i=-this.centerX,s=i+t.width,n=-this.centerY,o=n+t.height,a=1;let r=e.width;e.x+a<i?r=(e.x+e.width-i)/e.width:e.x+e.width-a>s&&(r=(s-e.x)/e.width);const l=e.y+a<n||e.y+e.height-a>o,c=this.bboxIntersectsSurroundingSeries(e);return{maxWidth:r,hasVerticalOverflow:l,hasSurroundingSeriesOverflow:c}}bboxIntersectsSurroundingSeries(e){const{surroundingRadius:t}=this;if(t==null)return!1;const i=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],s=t**2;return i.some(n=>n.x**2+n.y**2>s)}computeCalloutLabelCollisionOffsets(){const{radiusScale:e}=this,{calloutLabel:t}=this.properties,{offset:i,minSpacing:s}=t,n=e.convert(0),o=b=>!b.calloutLabel||b.outerRadius===0,a=this.calloutNodeData,r=a.filter(b=>!o(b));for(const b of r){const x=b.calloutLabel;x!=null&&(x.hidden=!1,x.collisionTextAlign=void 0,x.collisionOffsetY=0)}if(r.length<=1)return;const l=r.filter(b=>b.midCos<0).sort((b,x)=>b.midSin-x.midSin),c=r.filter(b=>b.midCos>=0).sort((b,x)=>b.midSin-x.midSin),h=r.filter(b=>b.midSin<0&&b.calloutLabel?.textAlign==="center").sort((b,x)=>b.midCos-x.midCos),d=r.filter(b=>b.midSin>=0&&b.calloutLabel?.textAlign==="center").sort((b,x)=>b.midCos-x.midCos),u=b=>{const x=b.calloutLabel;if(x==null)return re.zero.clone();const v=this.getLabelStyle(b,t),S=hu(v),M=this.getCalloutLineStyle(b,!1).length,D=b.outerRadius+M+i,k=b.midCos*D,I=b.midSin*D+x.collisionOffsetY,A=x.collisionTextAlign??x.textAlign,C=x.textBaseline;return rn.measureBBox(x.text,k,I,{font:this.properties.calloutLabel,textAlign:A,textBaseline:C}).grow(S)},p=(b,x,v)=>{const S=u(b).grow(s/2),M=u(x).grow(s/2);S.x<M.x+M.width&&S.x+S.width>M.x&&(v==="to-top"?S.y<M.y+M.height:S.y+S.height>M.y)&&(x.calloutLabel.collisionOffsetY=v==="to-top"?S.y-M.y-M.height:S.y+S.height-M.y)},f=b=>{const x=b.slice().sort((S,M)=>Math.abs(S.midSin)-Math.abs(M.midSin))[0],v=b.indexOf(x);for(let S=v-1;S>=0;S--){const M=b[S+1],D=b[S];p(M,D,"to-top")}for(let S=v+1;S<b.length;S++){const M=b[S-1],D=b[S];p(M,D,"to-bottom")}},y=b=>{const x=r.some(I=>I.calloutLabel.collisionOffsetY!==0),v=b.map(I=>u(I)),S=v.map(I=>I.clone().grow(s/2));let M=!1;for(let I=0;I<S.length&&!M;I++){const A=S[I];for(let C=I+1;C<b.length;C++){const w=S[C];if(A.collidesBBox(w)){M=!0;break}}}const D=a.map(I=>{const{startAngle:A,endAngle:C,outerRadius:w}=I;return{startAngle:A,endAngle:C,innerRadius:n,outerRadius:w}}),k=v.some(I=>D.some(A=>e3(I,A)));if(!(!M&&!x&&!k))for(const I of b){if(I.calloutLabel.textAlign!=="center")continue;const A=I.calloutLabel;I.midCos<0?A.collisionTextAlign="right":I.midCos>0?A.collisionTextAlign="left":A.collisionTextAlign="center"}};f(l),f(c),y(h),y(d)}getLabelStyle(e,t,i=!1){const s=this.ctx.highlightManager?.getActiveHighlight();return fh(this,e,this.properties,t,i,s)}updateCalloutLabelNodes(e){const{radiusScale:t}=this,{calloutLabel:i}=this.properties,s=new rn,n=this.ctx.highlightManager?.getActiveHighlight(),o=this.isSeriesHighlighted(n);for(const a of this.calloutLabelSelection.selectByTag(1)){const r=a.closestDatum(),l=r.calloutLabel,c=t.convert(r.radius),h=Math.max(0,c);if(!l?.text||h===0||l.hidden){a.visible=!1;continue}const d=o&&this.isItemHighlighted(n,r.datumIndex)===!0,u=this.getLabelStyle(r,i,d),p=this.getCalloutLineStyle(r,!1).length,f=h+p+i.offset,y=r.midCos*f,b=r.midSin*f+l.collisionOffsetY,x={textAlign:l.collisionTextAlign??l.textAlign,textBaseline:l.textBaseline};s.text=l.text,s.x=y,s.y=b,s.setFont(u),s.setAlign(x),s.setBoxing(u);const v=s.getBBox();let S=l.text,M=!0;if(i.avoidCollisions){const{maxWidth:D,hasVerticalOverflow:k}=this.getLabelOverflow(v,e);if(v.width>D){const I={font:this.properties.calloutLabel,textWrap:"on-space",overflow:"hide",maxWidth:D};S=Rd(l.text,I)}M=!k}a.text=S,a.x=y,a.y=b,a.setFont(u),a.setAlign(x),a.setBoxing(u),a.fill=u.color,a.fillOpacity=this.getHighlightStyle(d,r.datumIndex).opacity??1,a.visible=M}}computeLabelsBBox(e,t){const{calloutLabel:i}=this.properties,{offset:s,maxCollisionOffset:n,minSpacing:o}=i;if(!i.avoidCollisions)return null;this.maybeRefreshNodeData(),this.updateRadiusScale(!1),this.computeCalloutLabelCollisionOffsets();const a=[],r=new rn;let l;const{title:c}=this.properties;if(c?.text&&c.enabled){const h=this.getTitleTranslationY();Number.isFinite(h)&&(r.text=c.text,r.x=0,r.y=h,r.setFont(c),r.setAlign({textBaseline:"bottom",textAlign:"center"}),l=r.getBBox(),a.push(l))}for(const h of this.calloutNodeData){const d=h.calloutLabel;if(!d||h.outerRadius===0)continue;const u=this.getLabelStyle(h,i),p=this.getCalloutLineStyle(h,!1).length,f=h.outerRadius+p+s,y=h.midCos*f,b=h.midSin*f+d.collisionOffsetY;r.text=d.text,r.x=y,r.y=b,r.setFont(u),r.setAlign({textAlign:d.collisionTextAlign??d.textAlign,textBaseline:d.textBaseline}),r.setBoxing(u);const x=r.getBBox();if(d.box=x,Math.abs(d.collisionOffsetY)>n){d.hidden=!0;continue}if(l){const v=-this.centerY,S=new re(l.x-o,v,l.width+2*o,l.y+l.height+o-v);if(x.collidesBBox(S)){d.hidden=!0;continue}}if(e.hideWhenNecessary){const{maxWidth:v,hasVerticalOverflow:S,hasSurroundingSeriesOverflow:M}=this.getLabelOverflow(x,t),D=x.width>v;if(S||D||M){d.hidden=!0;continue}}d.hidden=!1,a.push(x)}return a.length===0?null:re.merge(a)}updateSectorLabelNodes(){const{properties:e}=this,{positionOffset:t,positionRatio:i}=this.properties.sectorLabel,s=this.radiusScale.convert(0),n=s<=0&&this.ctx.legendManager.getData(this.id)?.filter(r=>r.enabled).length===1,o={textAlign:"center",textBaseline:"middle"},a=(r,l)=>r.each((c,h)=>{const{outerRadius:d,startAngle:u,endAngle:p}=h;let f=!1;if(h.sectorLabel&&d!==0){const y=this.getLabelStyle(h,e.sectorLabel,l),b=s*(1-i)+d*i+t;c.fill=y.color,c.fillOpacity=this.getHighlightStyle(l,h.datumIndex).opacity??1,c.text=h.sectorLabel.text,n?(c.x=0,c.y=0):(c.x=h.midCos*b,c.y=h.midSin*b),c.setFont(y),c.setAlign(o),c.setBoxing(y);const x=c.getBBox(),v=[[x.x,x.y],[x.x+x.width,x.y],[x.x+x.width,x.y+x.height],[x.x,x.y+x.height]],S={startAngle:u,endAngle:p,innerRadius:s,outerRadius:d};v.every(([M,D])=>gI(M,D,S))&&(f=!0)}c.visible=f});a(this.labelSelection,!1),a(this.highlightLabelSelection,!0)}updateInnerLabelNodes(){const e=[],t=[];this.innerLabelsSelection.each((h,d)=>{const{fontStyle:u,fontWeight:p,fontSize:f,fontFamily:y,color:b}=d;h.fontStyle=u,h.fontWeight=p,h.fontSize=f,h.fontFamily=y,h.text=d.text,h.x=0,h.y=0,h.fill=b,h.textAlign="center",e.push(h.getBBox()),t.push(d.spacing)});const i=h=>h===0?0:t[h],s=h=>h===t.length-1?0:t[h],n=e.reduce((h,d)=>Math.max(h,d.width),0),o=e.reduce((h,d,u)=>h+d.height+i(u)+s(u),0),a=this.getInnerRadius(),l=Math.sqrt(Math.pow(n/2,2)+Math.pow(o/2,2))<=(a>0?a:this.getOuterRadius()),c=[];for(let h=0,d=-o/2;h<e.length;h++){const p=e[h].height+d+i(h);c.push(p),d=p+s(h)}this.innerLabelsSelection.each((h,d,u)=>{h.visible=l,Array.isArray(h.text)?h.y=c[u]-e[u].height:h.y=c[u]})}updateZerosumRings(){this.zerosumOuterRing.size=this.getOuterRadius()*2,this.zerosumInnerRing.size=this.getInnerRadius()*2}pickNodeClosestDatum(e){return xY(this,e)}getTooltipContent(e){const{id:t,dataModel:i,processedData:s,properties:n,ctx:{formatManager:o}}=this,{legendItemKey:a,calloutLabelKey:r,calloutLabelName:l,sectorLabelKey:c,sectorLabelName:h,angleKey:d,angleName:u,radiusKey:p,radiusName:f,tooltip:y}=n,b=this.properties.title.node.getPlainText();if(!i||!s)return;const x=s.dataSources.get(this.id)?.data?.[e],v=this.getProcessedDataValues(i,s),{angleRawValues:S}=v,M=S[e],D=this.getLabelContent(e,x,v),k=D.legendItem??D.callout??D.sector??u,I=Jh(i.getDomain(this,"angleRaw","value",s)),A=o.format(this.callWithContext.bind(this),{type:"number",value:M,datum:x,seriesId:t,legendItemName:void 0,key:d,source:"tooltip",property:"angle",domain:I,boundSeries:this.getFormatterContext("angle"),fractionDigits:void 0})??ao(M,3);return this.formatTooltipWithContext(y,{title:b,symbol:this.legendItemSymbol(e),data:[{label:Pe(k),fallbackLabel:d,value:A}]},{seriesId:t,datum:x,title:u,legendItemKey:a,calloutLabelKey:r,calloutLabelName:l,sectorLabelKey:c,sectorLabelName:h,angleKey:d,angleName:u,radiusKey:p,radiusName:f,...this.getItemStyle({datum:x,datumIndex:e},!1)})}legendItemSymbol(e){const t=this.processedData?.dataSources.get(this.id)?.data?.[e],i=this.getItemStyle({datum:t,datumIndex:e},!1),{fillOpacity:s,strokeOpacity:n,strokeWidth:o,lineDash:a,lineDashOffset:r}=this.properties;let{fill:l}=i;const{stroke:c}=i;return Ut(l)&&(l={...l,gradient:"linear",rotation:0,reverse:!1}),{marker:{fill:l,stroke:c,fillOpacity:s,strokeOpacity:n,strokeWidth:o,lineDash:a,lineDashOffset:r}}}getLegendData(e){const{visible:t,processedData:i,dataModel:s,id:n,ctx:{legendManager:o}}=this;if(!s||!i||e!=="category")return[];const{angleKey:a,calloutLabelKey:r,sectorLabelKey:l,legendItemKey:c,showInLegend:h}=this.properties;if(!c&&(!r||r===a)&&(!l||l===a))return[];const d=this.getProcessedDataValues(s,i),{angleRawValues:u}=d,p=this.properties.title?.showInLegend&&this.properties.title.text,f=[],y=this.properties.hideZeroValueSectorsInLegend,b=i.dataSources.get(this.id)?.data,x=i.invalidData?.get(this.id);for(let v=0;v<i.input.count;v++){const S=b?.[v],M=u[v];if(x?.[v]===!0||y&&M===0)continue;const D=[];p&&D.push(p);const k=this.getLabelContent(v,S,d);c&&k.legendItem!==void 0?D.push(k.legendItem):r&&r!==a&&k.callout!==void 0?D.push(k.callout):l&&l!==a&&k.sector!==void 0&&D.push(k.sector),D.length!==0&&f.push({legendType:"category",id:n,datum:S,itemId:v,seriesId:n,hideToggleOtherSeries:!0,enabled:t&&o.getItemEnabled({seriesId:n,itemId:v}),label:{text:D.map(I=>Pe(I)).join(" - ")},symbol:this.legendItemSymbol(v),legendItemName:c==null?void 0:S[c],hideInLegend:!h})}return f}setLegendState(e){const{id:t,ctx:{legendManager:i,updateService:s}}=this;for(const[n,o]of e.entries())i.toggleItem(o,t,n);i.update(),s.update(5)}animateEmptyUpdateReady(e){const{animationManager:t}=this.ctx,i=UI(!0,this.properties.rotation,this.radiusScale,this.previousRadiusScale);li(this.id,"nodes",t,[this.itemSelection,this.highlightSelection,this.phantomSelection,this.phantomHighlightSelection],i.nodes,(s,n)=>this.getDatumId(n.datumIndex)),li(this.id,"innerCircle",t,[this.innerCircleSelection],i.innerCircle),qt(this,"callout",t,this.calloutLabelSelection),qt(this,"sector",t,this.labelSelection,this.highlightLabelSelection),qt(this,"inner",t,this.innerLabelsSelection),this.previousRadiusScale.range=this.radiusScale.range}animateWaitingUpdateReady(){const{itemSelection:e,highlightSelection:t,phantomSelection:i,phantomHighlightSelection:s,processedData:n,radiusScale:o,previousRadiusScale:a}=this,{animationManager:r}=this.ctx,l=n?.reduced?.diff?.[this.id];this.ctx.animationManager.stopByAnimationGroupId(this.id);const c=(l?.moved.size??0)===0,h=(n?.defs.keys.length??0)>0,d=n?.reduced?.animationValidation?.uniqueKeys??!0;(!c||!h||!d)&&this.ctx.animationManager.skipCurrentBatch();const u=!this.nodeData.some(f=>f.enabled),p=UI(!1,this.properties.rotation,o,a);li(this.id,"nodes",r,[e,t,i,s],p.nodes,(f,y)=>this.getDatumId(y.datumIndex),l),li(this.id,"innerCircle",r,[this.innerCircleSelection],p.innerCircle),qt(this,"callout",this.ctx.animationManager,this.calloutLabelSelection),qt(this,"sector",this.ctx.animationManager,this.labelSelection,this.highlightLabelSelection),this.noVisibleData!==u&&(this.noVisibleData=u,qt(this,"inner",this.ctx.animationManager,this.innerLabelsSelection)),this.previousRadiusScale.range=this.radiusScale.range}animateClearingUpdateEmpty(){const{itemSelection:e,highlightSelection:t,phantomSelection:i,phantomHighlightSelection:s,radiusScale:n,previousRadiusScale:o}=this,{animationManager:a}=this.ctx,r=UI(!1,this.properties.rotation,n,o);li(this.id,"nodes",a,[e,t,i,s],r.nodes,(l,c)=>this.getDatumId(c.datumIndex)),li(this.id,"innerCircle",a,[this.innerCircleSelection],r.innerCircle),Ex(this,"callout",this.ctx.animationManager,this.calloutLabelSelection),Ex(this,"sector",this.ctx.animationManager,this.labelSelection,this.highlightLabelSelection),Ex(this,"inner",this.ctx.animationManager,this.innerLabelsSelection),this.previousRadiusScale.range=this.radiusScale.range}getDatumId(e){const{dataModel:t,processedData:i}=this;if(!t||!i)return`${e}`;const{calloutLabelKey:s,sectorLabelKey:n,legendItemKey:o}=this.properties;if(!i.reduced?.animationValidation?.uniqueKeys)return`${e}`;if(o){const a=t.resolveKeysById(this,"legendItemKey",i);return cs(a[e])}else if(s){const a=t.resolveKeysById(this,"calloutLabelKey",i);return cs(a[e])}else if(n){const a=t.resolveKeysById(this,"sectorLabelKey",i);return cs(a[e])}return`${e}`}hasItemStylers(){return!(this.properties.itemStyler==null&&this.properties.calloutLabel.itemStyler==null&&this.properties.sectorLabel.itemStyler==null&&this.properties.innerLabels.every(e=>e.itemStyler==null))}};cb.className="DonutSeries",cb.type="donut";var KI={series:{title:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:Si.LARGE},fontFamily:{$ref:"fontFamily"},color:{$ref:"subtleTextColor"},spacing:5},calloutLabel:{...ka,enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},offset:3,minAngle:.001},sectorLabel:{...ka,enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"chartBackgroundColor"},positionOffset:0,positionRatio:.5},calloutLine:{length:10,strokeWidth:2,colors:{$map:[{$if:[{$or:[{$isGradient:{$value:"$1"}},{$isPattern:{$value:"$1"}},{$isImage:{$value:"$1"}}]},{$path:["../../strokes/$index",{$ref:"foregroundColor"}]},{$value:"$1"}]},{$if:[{$eq:[{$path:"../strokeWidth"},0]},{$path:"../fills"},{$path:"../strokes"}]}]}},fills:{$applyCycle:[{$cacheMax:{$size:{$path:["./data",{$path:"/data"}]}}},{$palette:"fills"},{$applySwitch:[{$path:["/type",void 0,{$value:"$1"}]},{$value:"$1"},["gradient",QN],["pattern",Pn],["image",Ar]]}]},strokes:{$applyCycle:[{$cacheMax:{$size:{$path:["./data",{$path:"/data"}]}}},{$palette:"strokes"}]},fillOpacity:1,strokeOpacity:1,strokeWidth:{$isUserOption:["./strokes/0",2,0]},lineDash:[0],lineDashOffset:0,rotation:0,sectorSpacing:1,shadow:{enabled:!1,color:fa,xOffset:3,yOffset:3,blur:5},highlight:JN()},legend:{enabled:!0}},vY={...KI,series:{...KI.series,innerRadiusRatio:{$if:[{$eq:[{$path:["./innerRadiusOffset",void 0]},void 0]},.7,void 0]},innerLabels:{$apply:{...ka,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:2}},highlight:JN()}},K2={type:"series",name:"donut",chartType:"polar",version:ue,dependencies:[Nr],options:D1,themeTemplate:vY,create:e=>new cb(e)},YI=class extends cb{};YI.className="PieSeries",YI.type="pie";var Y2={type:"series",name:"pie",chartType:"polar",version:ue,dependencies:[Nr],options:Aa,themeTemplate:KI,create:e=>new YI(e)},ZI=class extends bi{constructor(e){super(),this.ctx=e,this.localeText=void 0}};g([Wt(e=>{e.ctx.localeManager.setLocaleText(e.localeText)}),m],ZI.prototype,"localeText",2),g([Wt(e=>{e.ctx.localeManager.setLocaleTextFormatter(e.getLocaleText)}),m],ZI.prototype,"getLocaleText",2);var XI={type:"plugin",name:"locale",version:ue,options:{localeText:Xa,getLocaleText:vi(N)},create:e=>new ZI(e)},qI={type:"axis",name:"number",chartType:"cartesian",version:ue,dependencies:[oi],options:vu,themeTemplate:{line:{enabled:!1}},create:e=>new zn(e)},Z2={type:"axis",name:"log",chartType:"cartesian",version:ue,dependencies:[oi],options:Su,themeTemplate:{base:10,line:{enabled:!1}},create:e=>new Hu(e)},QI={type:"axis",name:"time",chartType:"cartesian",version:ue,dependencies:[oi],options:Mu,themeTemplate:{gridLine:{enabled:!1}},create:e=>new wa(e)},X2={type:"axis",name:"category",chartType:"cartesian",version:ue,dependencies:[oi],options:xu,themeTemplate:{groupPaddingInner:.1,label:{autoRotate:!0,wrapping:"on-space"},gridLine:{enabled:!1},interval:{placement:"between"}},create:e=>new nf(e)},q2={type:"axis",name:"grouped-category",chartType:"cartesian",version:ue,dependencies:[oi],options:bu,themeTemplate:{tick:{enabled:!0,stroke:{$ref:"separationLinesColor"}},label:{spacing:10,rotation:270,wrapping:"on-space"},maxThicknessRatio:.5,paddingInner:.4,groupPaddingInner:.2},create:e=>new of(e)},Er=class extends m2{constructor(e){super(e,new Pl,!1),this.parentLevel=new Ru,this.min=void 0,this.max=void 0,this.preferredMin=void 0,this.preferredMax=void 0,this.unit=void 0,this.defaultUnit=void 0}get primaryLabel(){return this.parentLevel.enabled?this.parentLevel.label:void 0}get primaryTick(){return this.parentLevel.enabled?this.parentLevel.tick:void 0}hasDefinedDomain(){const{min:e,max:t}=this;return e!=null&&t!=null&&e<t}isCategoryLike(){return!0}processData(){super.processData();let e;const{domain:t}=this.dataDomain;if(t.length===2&&t[0].valueOf()===t[1].valueOf())e=$d(t[0]);else{const{boundSeries:i,direction:s,min:n,max:o}=this;e=TO(i,s,n,o)}ii(this.defaultUnit,e)||(this.defaultUnit=e)}updateScale(){super.updateScale(),this.scale.interval=this.unit??this.defaultUnit}normaliseDataDomain(e){const{extent:t,clipped:i}=dg(e,this.min,this.max,this.preferredMin,this.preferredMax);return{domain:t,clipped:i}}tickFormatParams(e,t,i,s){s??(s=bg(t));const n=vg(e),o=ro(s),a=Fo(s),r=Sl(s);return{type:"date",unit:o,step:a,epoch:r,truncateDate:n}}datumFormatParams(e,t,i,s,n){const o=this.unit??this.defaultUnit??"millisecond";s??(s=o);const{datum:a,seriesId:r,legendItemName:l,key:c,source:h,property:d,domain:u,boundSeries:p}=t,f=ro(s),y=Fo(s),b=Sl(s);return{type:"date",value:Ys(o,e),datum:a,seriesId:r,legendItemName:l,key:c,source:h,property:d,domain:u,boundSeries:p,unit:f,step:y,epoch:b,style:n}}};Er.className="UnitTimeAxis",Er.type="unit-time",g([m],Er.prototype,"parentLevel",2),g([m],Er.prototype,"min",2),g([m],Er.prototype,"max",2),g([m],Er.prototype,"preferredMin",2),g([m],Er.prototype,"preferredMax",2),g([m],Er.prototype,"unit",2);var Q2={type:"axis",name:"unit-time",chartType:"cartesian",version:ue,dependencies:[oi],options:Du,themeTemplate:{groupPaddingInner:.1,label:{autoRotate:!1},gridLine:{enabled:!1},parentLevel:{enabled:!0},interval:{placement:"between"}},create:e=>new Er(e)},J2=[qI,Z2,QI,X2,q2,Q2],eE=[wI,sb,FI,BI,lb,HI],SY=[J2,eE,AI,XI].flat(),tE=[Nr,K2,Y2,AI,XI],JI=[SY,tE,P2].flat(),hb={};Vs(hb,{Arc:()=>Na,BBox:()=>re,Caption:()=>Et,CategoryScale:()=>qc,Group:()=>Oe,Line:()=>En,LinearScale:()=>gh,Marker:()=>ki,Path:()=>Fi,RadialColumnShape:()=>Xo,Rect:()=>Di,Scene:()=>Jy,Sector:()=>ms,Shape:()=>Hc,TranslatableGroup:()=>ls,getRadialColumnWidth:()=>M2,toRadians:()=>mt});var db={};Vs(db,{AGGREGATION_INDEX_UNSET:()=>cl,AGGREGATION_INDEX_X_MAX:()=>js,AGGREGATION_INDEX_X_MIN:()=>Hs,AGGREGATION_INDEX_Y_MAX:()=>$s,AGGREGATION_INDEX_Y_MIN:()=>Ws,AGGREGATION_MAX_POINTS:()=>WL,AGGREGATION_MIN_RANGE:()=>ar,AGGREGATION_SPAN:()=>In,AGGREGATION_THRESHOLD:()=>ua,AbstractModuleInstance:()=>bi,ActionOnSet:()=>He,AdjacencyListGraph:()=>v0,AsyncAwaitQueue:()=>rg,BASE_FONT_SIZE:()=>Oo,BREAK_TRANSFORM_CHAIN:()=>Wp,BaseProperties:()=>K,Border:()=>cr,CARTESIAN_AXIS_TYPE:()=>t0,CARTESIAN_POSITION:()=>e0,CallbackCache:()=>o0,ChangeDetectableProperties:()=>Ry,ChartAxisDirection:()=>Jp,ChartTheme:()=>$o,ChartUpdateType:()=>kc,CleanupRegistry:()=>pt,Color:()=>Be,DEFAULT_ANNOTATION_HANDLE_FILL:()=>md,DEFAULT_ANNOTATION_STATISTICS_COLOR:()=>bd,DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE:()=>vd,DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL:()=>Sd,DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE:()=>Md,DEFAULT_ANNOTATION_STATISTICS_FILL:()=>yd,DEFAULT_ANNOTATION_STATISTICS_STROKE:()=>xd,DEFAULT_CAPTION_ALIGNMENT:()=>lr,DEFAULT_CAPTION_LAYOUT_STYLE:()=>ma,DEFAULT_FIBONACCI_STROKES:()=>fd,DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL:()=>os,DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR:()=>As,DEFAULT_POLAR_SERIES_STROKE:()=>ig,DEFAULT_SHADOW_COLOUR:()=>fa,DEFAULT_SPARKLINE_CROSSHAIR_STROKE:()=>sg,DEFAULT_TEXTBOX_COLOR:()=>kd,DEFAULT_TEXTBOX_FILL:()=>Dd,DEFAULT_TEXTBOX_STROKE:()=>Id,DEFAULT_TEXT_ANNOTATION_COLOR:()=>ng,DEFAULT_TOOLBAR_POSITION:()=>Ad,Debug:()=>Me,DebugMetrics:()=>Jn,DeclaredSceneChangeDetection:()=>_e,DeclaredSceneObjectChangeDetection:()=>Zd,Deprecated:()=>ew,DeprecatedAndRenamedTo:()=>tw,EllipsisChar:()=>od,ErrorType:()=>TS,EventEmitter:()=>Sn,FONT_SIZE:()=>JS,FONT_SIZE_RATIO:()=>Si,IS_DARK_THEME:()=>ul,InterpolationProperties:()=>dl,LRUCache:()=>wp,LineSplitter:()=>Ya,Logger:()=>j,LonLatBBox:()=>Tc,MementoCaretaker:()=>Bm,ModuleRegistry:()=>me,ModuleType:()=>uS,ObserveChanges:()=>Wt,PALETTE_ALT_DOWN_FILL:()=>Zm,PALETTE_ALT_DOWN_STROKE:()=>Km,PALETTE_ALT_NEUTRAL_FILL:()=>Xm,PALETTE_ALT_NEUTRAL_STROKE:()=>qm,PALETTE_ALT_UP_FILL:()=>Ym,PALETTE_ALT_UP_STROKE:()=>Um,PALETTE_DOWN_FILL:()=>jm,PALETTE_DOWN_STROKE:()=>Gm,PALETTE_NEUTRAL_FILL:()=>$m,PALETTE_NEUTRAL_STROKE:()=>Wm,PALETTE_UP_FILL:()=>Hm,PALETTE_UP_STROKE:()=>Vm,POLAR_AXIS_SHAPE:()=>s0,POLAR_AXIS_TYPE:()=>i0,PREV_NEXT_KEYS:()=>Nd,Padding:()=>gr,ParallelStateMachine:()=>F0,PolarZIndexMap:()=>XS,PropertiesArray:()=>Pi,Property:()=>m,ProxyOnWrite:()=>XL,ProxyProperty:()=>Bt,ProxyPropertyOnWrite:()=>kt,SKIP_JS_BUILTINS:()=>Pm,ScaleAlignment:()=>gS,SceneArrayChangeDetection:()=>Yd,SceneChangeDetection:()=>U,SceneObjectChangeDetection:()=>br,SceneRefChangeDetection:()=>Ig,SeriesContentZIndexMap:()=>QS,SeriesZIndexMap:()=>qS,SimpleCache:()=>JL,SpanJoin:()=>tM,StateMachine:()=>he,StateMachineProperty:()=>it,TRIPLE_EQ:()=>Vc,TextMeasurer:()=>yy,TickIntervals:()=>xg,ToolbarButtonProperties:()=>Vo,TrimEdgeGuard:()=>ad,UnknownError:()=>Pp,ValidationError:()=>la,Vec2:()=>H,Vec4:()=>ke,Vertex:()=>S0,WeakCache:()=>m0,ZIndexMap:()=>n0,addEscapeEventListener:()=>hy,addFakeTransformToInstanceProperty:()=>m,addMouseCloseListener:()=>k0,addObserverToInstanceProperty:()=>Tm,addOverrideFocusVisibleEventListener:()=>C0,addTouchCloseListener:()=>A0,addTransformToInstanceProperty:()=>sr,aggregationBucketForDatum:()=>$L,aggregationDatumMatchesIndex:()=>UL,aggregationDomain:()=>si,aggregationIndexForXRatio:()=>eg,aggregationRangeFittingPoints:()=>pa,aggregationXRatioForDatumIndex:()=>Lc,aggregationXRatioForXValue:()=>kn,and:()=>Ue,angleBetween:()=>Eo,angularPadding:()=>ty,appendEllipsis:()=>mm,arcDistanceSquared:()=>iw,areScalingEqual:()=>_o,array:()=>sn,arrayLength:()=>qa,arrayOf:()=>be,arrayOfDefs:()=>Ft,arraysEqual:()=>vn,assignIfNotStrictlyEqual:()=>Fm,attachDescription:()=>Ge,attachListener:()=>ot,autoSizedLabelOptionsDefs:()=>ir,barHighlightOptionsDef:()=>io,bezier2DDistance:()=>q0,bezier2DExtrema:()=>Z0,boolean:()=>R,borderOptionsDef:()=>rl,boxCollides:()=>sy,boxContains:()=>lg,boxEmpty:()=>u0,boxesEqual:()=>cg,buildDateFormatter:()=>Sc,cachedTextMeasurer:()=>Ze,calcLineHeight:()=>Mn,calculatePlacement:()=>my,callWithContext:()=>as,callback:()=>ct,callbackDefs:()=>Qe,callbackOf:()=>vi,checkDatum:()=>U0,circularSliceArray:()=>qn,clamp:()=>ge,clampArray:()=>Ac,clipLines:()=>B0,clipSpanX:()=>Py,collapseSpanToPoint:()=>eM,collectAggregationLevels:()=>KL,color:()=>ie,colorStopsOrderValidator:()=>Dm,colorUnion:()=>ks,commonChartOptionsDefs:()=>we,commonSeriesOptionsDefs:()=>et,commonSeriesThemeableOptionsDefs:()=>Je,compactAggregationIndices:()=>hl,compareDates:()=>oy,computeExtremesAggregation:()=>rr,computeExtremesAggregationPartial:()=>tg,constant:()=>Le,contextMenuItemsArray:()=>Hp,countFractionDigits:()=>vc,countLines:()=>CS,createAggregationIndices:()=>ga,createButton:()=>Kd,createCanvasContext:()=>f0,createCheckbox:()=>oM,createDeprecationWarning:()=>ly,createElement:()=>xe,createElementId:()=>ur,createIcon:()=>lM,createId:()=>Mi,createIdsGenerator:()=>Sg,createNumberFormatter:()=>hm,createSelect:()=>aM,createSvgElement:()=>Pt,createTextArea:()=>rM,createTicks:()=>Rc,date:()=>is,dateToNumber:()=>Wi,dateTruncationForDomain:()=>vg,datesSortOrder:()=>ry,debounce:()=>Np,decodeIntervalValue:()=>j0,deepClone:()=>Re,deepFreeze:()=>on,defaultEpoch:()=>Ay,defined:()=>le,diffArrays:()=>y0,distribute:()=>oS,downloadUrl:()=>lS,dropFirstWhile:()=>sS,dropLastWhile:()=>nS,durationDay:()=>vl,durationHour:()=>bl,durationMinute:()=>fr,durationMonth:()=>vy,durationSecond:()=>Pc,durationWeek:()=>_0,durationYear:()=>zd,easeIn:()=>Lw,easeInOut:()=>ww,easeInOutQuad:()=>Ow,easeInQuad:()=>Tw,easeOut:()=>xr,easeOutQuad:()=>Nw,encodedToTimestamp:()=>mr,enterpriseRegistry:()=>Oi,entries:()=>ht,errorBarOptionsDefs:()=>pd,errorBarThemeableOptionsDefs:()=>ud,estimateTickCount:()=>wy,evaluateBezier:()=>Bo,every:()=>WS,expandLegendPosition:()=>ll,extent:()=>Ro,extractDecoratedProperties:()=>HS,extractDomain:()=>Jh,fillGradientDefaults:()=>zp,fillImageDefaults:()=>_p,fillOptionsDef:()=>se,fillPatternDefaults:()=>Bp,findMaxIndex:()=>hr,findMaxValue:()=>ny,findMinIndex:()=>Nc,findMinMax:()=>Tt,findMinValue:()=>qL,findRangeExtent:()=>da,first:()=>Gs,focusCursorAtEnd:()=>Qm,fontFamilyFull:()=>Vp,fontOptionsDef:()=>Ke,formatNumber:()=>b0,formatObjectValidator:()=>VS,formatPercent:()=>x0,formatValue:()=>ao,fromPairs:()=>$S,generateUUID:()=>Od,geoJson:()=>ml,getAngleRatioRadians:()=>h0,getAttribute:()=>fl,getChartTheme:()=>wx,getDocument:()=>Qn,getElementBBox:()=>a0,getIconClassNames:()=>pl,getLastFocus:()=>gy,getMaxInnerRectSize:()=>l0,getMidpointsForIndices:()=>No,getMinOuterRectSize:()=>ZL,getPath:()=>Em,getTickTimeInterval:()=>jd,getWindow:()=>Ve,googleFont:()=>km,gradientColorStops:()=>Rp,gradientStrict:()=>Fp,greaterThan:()=>ns,groupBy:()=>Zh,guardTextEdges:()=>IS,hasNoModifiers:()=>Td,hasRequiredInPath:()=>ol,highlightOptionsDef:()=>Im,htmlElement:()=>bm,inRange:()=>fS,initRovingTabIndex:()=>uy,insertListItemsSorted:()=>fy,instanceOf:()=>BL,interpolationOptionsDefs:()=>jp,intervalCeil:()=>V0,intervalEpoch:()=>Sl,intervalExtent:()=>Iy,intervalFloor:()=>Ys,intervalHierarchy:()=>Hd,intervalMilliseconds:()=>rs,intervalNext:()=>Dy,intervalPrevious:()=>G0,intervalRange:()=>wn,intervalRangeCount:()=>mg,intervalRangeNumeric:()=>H0,intervalRangeStartIndex:()=>ky,intervalStep:()=>Fo,intervalUnit:()=>ro,inverseEaseOut:()=>hM,isArray:()=>Ce,isBetweenAngles:()=>Us,isBoolean:()=>xS,isButtonClickEvent:()=>py,isColor:()=>SS,isContinuous:()=>Bc,isDate:()=>Is,isDecoratedObject:()=>Up,isDefined:()=>St,isDenseInterval:()=>Ml,isEmptyObject:()=>id,isEnumKey:()=>AL,isEnumValue:()=>CL,isFiniteNumber:()=>$e,isFunction:()=>Co,isGradientFill:()=>Ut,isGradientFillArray:()=>Sw,isGradientOrPatternFill:()=>Mw,isHtmlElement:()=>vS,isImageFill:()=>zo,isInputPending:()=>r0,isInteger:()=>mS,isKeyOf:()=>il,isNegative:()=>bc,isNumber:()=>gt,isNumberEqual:()=>qe,isNumberObject:()=>$0,isObject:()=>fe,isObjectLike:()=>td,isObjectWithProperty:()=>US,isObjectWithStringProperty:()=>KS,isPatternFill:()=>Tn,isPlainObject:()=>st,isPointLabelDatum:()=>Q0,isProperties:()=>wc,isRegExp:()=>bS,isScaleValid:()=>Dl,isSegmentTruncated:()=>Op,isString:()=>Rt,isStringFillArray:()=>Y0,isStringObject:()=>Ty,isSymbol:()=>sd,isTextTruncated:()=>sl,isTruncated:()=>AS,isUnitTimeCategoryScaling:()=>yr,isValidDate:()=>tl,isValidNumberFormat:()=>MS,iterate:()=>or,joinFormatted:()=>Za,jsonApply:()=>wd,jsonDiff:()=>Ln,jsonPropertyCompare:()=>D0,jsonWalk:()=>ya,kebabCase:()=>wS,labelBoxOptionsDef:()=>Dn,legendPositionValidator:()=>dd,lessThan:()=>ss,lessThanOrEqual:()=>OS,levenshteinDistance:()=>LS,lineDashOptionsDef:()=>ne,lineDistanceSquared:()=>dr,lineHighlightOptionsDef:()=>Qa,lineSegmentOptions:()=>RS,lineSegmentation:()=>FS,linear:()=>cM,linearGaugeSeriesOptionsDef:()=>ha,linearGaugeSeriesThemeableOptionsDef:()=>qp,linearGaugeTargetOptionsDef:()=>Zp,linearPoints:()=>iM,listDecoratedProperties:()=>nr,lowestGranularityForInterval:()=>Wd,lowestGranularityUnitForTicks:()=>bg,lowestGranularityUnitForValue:()=>$d,makeAccessibleClickListener:()=>cw,mapValues:()=>Dc,markerOptionsDefs:()=>so,markerStyleOptionsDefs:()=>tr,measureTextSegments:()=>Ks,memo:()=>Ed,merge:()=>gd,mergeArrayDefaults:()=>Om,mergeDefaults:()=>oe,modulus:()=>yS,multiSeriesHighlightOptionsDef:()=>zt,nearestSquared:()=>Pd,nearestSquaredInContainer:()=>N0,nextPowerOf2:()=>Cc,niceTicksDomain:()=>Ly,normalisedExtentWithMetadata:()=>Ec,normalisedTimeExtentWithMetadata:()=>dg,normalizeAngle180:()=>ag,normalizeAngle360:()=>tt,normalizeAngle360FromDegrees:()=>Po,normalizeAngle360Inclusive:()=>Ld,number:()=>W,numberFormatValidator:()=>nn,numberMin:()=>Sm,numberRange:()=>NS,object:()=>Xa,objectsEqual:()=>ii,objectsEqualWith:()=>Nm,optionsDefs:()=>Ot,or:()=>Ae,padding:()=>al,paddingOptions:()=>zS,parseColor:()=>cS,parseNumberFormat:()=>Tp,partialAssign:()=>Yp,pause:()=>iy,pick:()=>Kp,placeLabels:()=>J0,positiveNumber:()=>P,positiveNumberNonZero:()=>Mc,previousPowerOf2:()=>_m,radialGaugeSeriesOptionsDef:()=>Ic,radialGaugeSeriesThemeableOptionsDef:()=>Qp,radialGaugeTargetOptionsDef:()=>Xp,range:()=>zc,rangeValidator:()=>Gp,ratio:()=>ce,readIntegratedWrappedValue:()=>Ny,required:()=>$,rescaleSpan:()=>_c,rescaleVisibleRange:()=>yg,resetIds:()=>dw,resolveOperation:()=>IY,rotatePoint:()=>ey,roundTo:()=>ed,safeCall:()=>gm,seriesLabelOptionsDefs:()=>ft,setAttribute:()=>Fe,setAttributes:()=>oo,setDocument:()=>aS,setElementBBox:()=>Cd,setElementStyle:()=>Cn,setElementStyles:()=>d0,setPath:()=>Rm,setWindow:()=>rS,shadowOptionsDefs:()=>wo,shallowClone:()=>yl,shapeHighlightOptionsDef:()=>It,shapeSegmentOptions:()=>PS,shapeSegmentation:()=>ca,shapeValidator:()=>Ja,simpleMemorize:()=>ji,simpleMemorize2:()=>pr,smoothPoints:()=>nM,solveBezier:()=>Dg,sortAndUniqueDates:()=>ay,sortBasedOnArray:()=>iS,spanRange:()=>Zs,splitBezier2D:()=>Ud,stepPoints:()=>sM,stopPageScrolling:()=>L0,strictObjectKeys:()=>To,strictUnion:()=>Mm,string:()=>N,stringLength:()=>vm,stringifyValue:()=>rd,strokeOptionsDef:()=>J,textOrSegments:()=>Hi,themeNames:()=>DY,themeOperator:()=>hd,themeSymbols:()=>MY,themes:()=>OD,throttle:()=>pm,tickFormat:()=>Cy,tickStep:()=>Fc,toArray:()=>Yh,toDegrees:()=>c0,toFontString:()=>fm,toIterable:()=>jS,toPlainText:()=>Pe,toRadians:()=>mt,toTextString:()=>Dt,toolbarButtonOptionsDefs:()=>er,tooltipOptionsDefs:()=>Ye,transformIntegratedCategoryValue:()=>Mg,truncateLine:()=>xl,typeUnion:()=>nl,undocumented:()=>ee,unguardTextEdges:()=>kS,union:()=>Z,unionSymbol:()=>ld,unique:()=>Ap,validate:()=>Ei,without:()=>Q,wrapLines:()=>Fd,wrapText:()=>xa,wrapTextOrSegments:()=>Rd,wrapTextSegments:()=>by});var MY={DEFAULT_ANNOTATION_HANDLE_FILL:md,DEFAULT_ANNOTATION_STATISTICS_COLOR:bd,DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE:vd,DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL:Sd,DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE:Md,DEFAULT_ANNOTATION_STATISTICS_FILL:yd,DEFAULT_ANNOTATION_STATISTICS_STROKE:xd,DEFAULT_CAPTION_ALIGNMENT:lr,DEFAULT_CAPTION_LAYOUT_STYLE:ma,DEFAULT_FIBONACCI_STROKES:fd,DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL:os,DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR:As,DEFAULT_POLAR_SERIES_STROKE:ig,DEFAULT_SHADOW_COLOUR:fa,DEFAULT_SPARKLINE_CROSSHAIR_STROKE:sg,DEFAULT_TEXTBOX_COLOR:kd,DEFAULT_TEXTBOX_FILL:Dd,DEFAULT_TEXTBOX_STROKE:Id,DEFAULT_TEXT_ANNOTATION_COLOR:ng,DEFAULT_TOOLBAR_POSITION:Ad,IS_DARK_THEME:ul,PALETTE_ALT_DOWN_FILL:Zm,PALETTE_ALT_DOWN_STROKE:Km,PALETTE_ALT_NEUTRAL_FILL:Xm,PALETTE_ALT_NEUTRAL_STROKE:qm,PALETTE_ALT_UP_FILL:Ym,PALETTE_ALT_UP_STROKE:Um,PALETTE_DOWN_FILL:jm,PALETTE_DOWN_STROKE:Gm,PALETTE_NEUTRAL_FILL:$m,PALETTE_NEUTRAL_STROKE:Wm,PALETTE_UP_FILL:Hm,PALETTE_UP_STROKE:Vm},DY=Object.keys(OD);function IY(e){const t=$o.getDefaultPublicParameters(),i=$o.getDefaultColors();return new bO({line:{operation:e}},{series:[{type:"line"}]},t,i).resolve().operation}var ub={};Vs(ub,{Color:()=>Be,interpolateColor:()=>ST});var kY={VERSION:ue,_Scene:hb,_Theme:db,_Util:ub,create:fo.create.bind(fo),createSparkline:fo.__createSparkline.bind(fo),setup:()=>{me.setRegistryMode(me.RegistryMode.Integrated),me.registerModules(JI)},isEnterprise:!1},{Chart:AY}=L,ek=class extends AY{getChartType(){return"standalone"}performLayout(e){const{seriesRoot:t,annotationRoot:i}=this,s=e.layoutBox.clone().shrink(this.seriesArea.getPadding());this.seriesRect=s,this.animationRect=s;for(const n of[t,i])n.translationX=Math.floor(s.x),n.translationY=Math.floor(s.y);t.visible=this.series[0].visible,this.ctx.layoutManager.emitLayoutComplete(e,{series:{visible:!0,rect:s,paddedRect:e.layoutBox}})}getAriaLabel(){const e=this.series[0]?.type;if(e==null)return"";const t=this.getCaptionText();switch(e){case"radial-gauge":case"linear-gauge":{const i=[];t.length!==0&&i.push(t);for(const s of this.series)i.push(s.getCaptionText());return this.ctx.localeManager.t("ariaAnnounceGaugeChart",{caption:i.join(". ")})}case"treemap":case"sunburst":return this.ctx.localeManager.t("ariaAnnounceHierarchyChart",{caption:t});default:return this.ctx.localeManager.t("ariaAnnounceStandaloneChart",{caption:t})}}};ek.className="StandaloneChart",ek.type="standalone";var{standaloneChartOptionsDefs:CY}=L,Wu={type:"chart",name:"standalone",enterprise:!0,version:ue,options:CY,create(e,t){return new ek(e,t)}};function iE(e,t,i){i||(t=LY(t));const s=new Map;for(const o of e)s.set(o.id,{datum:o,linksBefore:[],linksAfter:[],maxPathLengthBefore:-1,maxPathLengthAfter:-1});let n=0;for(const[o,a]of s.entries())n=Math.max(n,tk(s,t,a,o,-1,[])+tk(s,t,a,o,1,[])+1);return{links:t,nodeGraph:s,maxPathLength:n}}function sE(e,t,i,s){const n=s.indexOf(t);if(n!==-1){for(let a=n;a<s.length;a+=1)i.add(s[a]);return}s.push(t);const{toNode:o}=t;for(const a of e)a.fromNode===o&&sE(e,a,i,s);s.pop()}function LY(e){const t=new Set;for(const i of e)sE(e,i,t,[]);return t.size!==0&&j.warnOnce("Some links formed circular references. These will be removed from the output."),t.size===0?e:e.filter(i=>!t.has(i))}function tk(e,t,i,s,n,o){if(o.includes(s))return 1/0;let a=n===-1?i.maxPathLengthBefore:i.maxPathLengthAfter;if(a===-1){a=0;const r=n===-1?i.linksBefore:i.linksAfter;for(const l of t){const{fromNode:c,toNode:h}=l,d=n===-1?h.id:c.id,u=n===-1?c.id:h.id,p=s===d?e.get(u):void 0;p!=null&&(r.push({node:p,link:l}),o?.push(s),a=Math.max(a,tk(e,t,p,u,n,o)+1),o?.pop())}n===-1?i.maxPathLengthBefore=a:i.maxPathLengthAfter=a}return a}var{Series:wY,DataController:TY,keyProperty:NY,valueProperty:pb,Selection:bh,Group:yf,TransformableText:OY,HighlightState:nE}=L,EY=class extends L.SeriesNodeEvent{constructor(e,t,i,s){super(e,t,i,s);const{datumIndex:n}=i,o=s.contextNodeData?.nodeData.find(a=>a.datumIndex.type===n.type&&a.datumIndex.index===n.index);this.size=o?.size,this.label=o?.type===1?o?.label:void 0}},oE=class extends wY{constructor(){super(...arguments),this.NodeEvent=EY,this.nodeCount=0,this.linkCount=0,this.linksDataModel=void 0,this.linksProcessedData=void 0,this.nodesDataModel=void 0,this.nodesProcessedData=void 0,this.processedNodes=new Map,this.linkGroup=this.contentGroup.appendChild(new yf({name:"linkGroup"})),this.nodeGroup=this.contentGroup.appendChild(new yf({name:"nodeGroup"})),this.focusLinkGroup=this.highlightGroup.appendChild(new yf({name:"linkGroup"})),this.focusNodeGroup=this.highlightGroup.appendChild(new yf({name:"nodeGroup"})),this.highlightLinkGroup=this.highlightGroup.appendChild(new yf({name:"linkGroup"})),this.labelSelection=bh.select(this.labelGroup,OY),this.linkSelection=bh.select(this.linkGroup,()=>this.linkFactory()),this.nodeSelection=bh.select(this.nodeGroup,()=>this.nodeFactory()),this.focusLinkSelection=bh.select(this.focusLinkGroup,()=>this.linkFactory()),this.focusNodeSelection=bh.select(this.focusNodeGroup,()=>this.nodeFactory()),this.highlightLinkSelection=bh.select(this.highlightLinkGroup,()=>this.linkFactory()),this.highlightNodeSelection=bh.select(this.highlightNodeGroup,()=>this.nodeFactory())}get nodes(){return this.properties.nodes}async processData(e){const{data:t,nodes:i}=this;if(t==null)return;const{fromKey:s,toKey:n,sizeKey:o,idKey:a,labelKey:r}=this.properties,l=new TY("standalone",e.suppressFieldDotNotation,this.ctx.eventsHub),c=i==null?null:l.request(this.id,L.DataSet.wrap(i)??L.DataSet.empty(),{props:[NY(a,void 0,{id:"idValue",includeProperty:!1}),...r==null?[]:[pb(r,void 0,{id:"labelValue",includeProperty:!1})]],groupByKeys:!0}),h=e.request(this.id,t,{props:[pb(s,void 0,{id:"fromValue",includeProperty:!1}),pb(n,void 0,{id:"toValue",includeProperty:!1}),...o==null?[]:[pb(o,void 0,{id:"sizeValue",includeProperty:!1,missingValue:0})]],groupByKeys:!1});i!=null&&l.execute();const[d,u]=await Promise.all([c??Promise.resolve(null),h]);this.nodesDataModel=d?.dataModel,this.nodesProcessedData=d?.processedData,this.linksDataModel=u?.dataModel,this.linksProcessedData=u?.processedData;const p=new Map;if(d==null){const f=u.dataModel.resolveColumnById(this,"fromValue",u.processedData),y=u.dataModel.resolveColumnById(this,"toValue",u.processedData),b=v=>{const S=p.size,M=v;return{series:this,itemId:void 0,datum:{},datumIndex:{type:1,index:S},type:1,index:S,linksBefore:[],linksAfter:[],id:v,size:0,label:M,style:this.getNodeStyle({datumIndex:{type:1,index:S},datum:{},size:0,label:M},S,!1)}},x=u.processedData.dataSources.get(this.id)?.data;if(x)for(const[v]of x.entries()){const S=f[v],M=y[v];S==null||M==null||(p.has(S)||p.set(S,b(S)),p.has(M)||p.set(M,b(M)))}}else{const f=d.dataModel.resolveColumnById(this,"idValue",d.processedData),y=r==null?void 0:d.dataModel.resolveColumnById(this,"labelValue",d.processedData),b=d.processedData.dataSources.get(this.id)?.data;if(b)for(const[x,v]of b.entries()){const S=f[x],M=y?.[x],D={type:1,index:x};p.set(S,{series:this,itemId:void 0,datum:v,datumIndex:D,type:1,index:x,linksBefore:[],linksAfter:[],id:S,size:0,label:M,style:this.getNodeStyle({datumIndex:D,datum:v,size:0,label:M},x,!1)})}}this.processedNodes=p}getNodeGraph(e,t,{includeCircularReferences:i}){const{linksDataModel:s,linksProcessedData:n}=this;if(s==null||n==null){const{links:y,nodeGraph:b,maxPathLength:x}=iE(new Map().values(),[],i);return this.nodeCount=0,this.linkCount=0,{nodeGraph:b,links:y,maxPathLength:x}}const{sizeKey:o}=this.properties,a=s.resolveColumnById(this,"fromValue",n),r=s.resolveColumnById(this,"toValue",n),l=o==null?void 0:s.resolveColumnById(this,"sizeValue",n),c=new Map;for(const y of this.processedNodes.values()){const b=e(y);c.set(y.id,b)}const h=[],d=n.dataSources.get(this.id)?.data;if(d)for(const[y,b]of d.entries()){const x=a[y],v=r[y],S=l==null?1:l[y],M=c.get(x),D=c.get(v);if(S<=0||M==null||D==null)continue;const k={type:0,index:y},I=t({series:this,itemId:void 0,datum:b,datumIndex:k,type:0,index:y,fromNode:M,toNode:D,size:S,style:this.getLinkStyle({datum:b,datumIndex:k},M.datumIndex,!1)});h.push(I)}const{links:u,nodeGraph:p,maxPathLength:f}=iE(c.values(),h,i);for(const y of p.values())y.datum.linksBefore=y.linksBefore.map(b=>b.link),y.datum.linksAfter=y.linksAfter.map(b=>b.link);return this.nodeCount=p.size,this.linkCount=u.length,{nodeGraph:p,links:u,maxPathLength:f}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(e){const{seriesRect:t}=e,i={seriesRectWidth:t?.width??0,seriesRectHeight:t?.height??0};(this._nodeDataDependencies==null||this._nodeDataDependencies.seriesRectWidth!==i.seriesRectWidth||this._nodeDataDependencies.seriesRectHeight!==i.seriesRectHeight)&&(this._nodeDataDependencies=i),this.updateSelections();const s=this.contextNodeData?.nodeData??[],n=this.contextNodeData?.labelData??[],o=this.getHighlightedDatum();this.contentGroup.visible=this.visible;const a=o==null?nE.None:nE.OtherItem;this.contentGroup.opacity=this.properties.highlight.getStyle(a).opacity??1,this.labelSelection=this.updateLabelSelection({labelData:n,labelSelection:this.labelSelection}),this.updateLabelNodes({labelSelection:this.labelSelection}),this.linkSelection=this.updateLinkSelection({nodeData:s.filter(d=>d.type===0),datumSelection:this.linkSelection}),this.updateLinkNodes({datumSelection:this.linkSelection,isHighlight:!1}),this.nodeSelection=this.updateNodeSelection({nodeData:s.filter(d=>d.type===1),datumSelection:this.nodeSelection}),this.updateNodeNodes({datumSelection:this.nodeSelection,isHighlight:!1});let r,l,c,h;o?.type===1?(r=s.filter(d=>d.type===0&&(d.toNode===o||d.fromNode===o)),l=r.map(d=>d.fromNode===o?d.toNode:d.fromNode),l.push(o),c=[],h=[o]):o?.type===0?(r=[o],l=[o.fromNode,o.toNode],c=[o],h=[]):(r=[],l=[],c=[],h=[]),this.focusLinkSelection=this.updateLinkSelection({nodeData:r,datumSelection:this.focusLinkSelection}),this.updateLinkNodes({datumSelection:this.focusLinkSelection,isHighlight:!1}),this.focusNodeSelection=this.updateNodeSelection({nodeData:l,datumSelection:this.focusNodeSelection}),this.updateNodeNodes({datumSelection:this.focusNodeSelection,isHighlight:!1}),this.highlightLinkSelection=this.updateLinkSelection({nodeData:c,datumSelection:this.highlightLinkSelection}),this.updateLinkNodes({datumSelection:this.highlightLinkSelection,isHighlight:!0}),this.highlightNodeSelection=this.updateNodeSelection({nodeData:h,datumSelection:this.highlightNodeSelection}),this.updateNodeNodes({datumSelection:this.highlightNodeSelection,isHighlight:!0})}getHighlightedDatum(){let e=this.ctx.highlightManager?.getActiveHighlight();if(e?.series===this&&e.type==null){const{itemId:t}=e,i=this.contextNodeData?.nodeData??[];e=t==null?void 0:i.find(s=>s.type===1&&s.id===t)}else e?.series!==this&&(e=void 0);return e}isLabelHighlighted(e,t){return t==null?!1:t.type===1?t===e:t.type===0?t.fromNode===e||t.toNode===e:!1}resetAnimation(e){}dataCount(){return Number.NaN}getSeriesDomain(e){return{domain:[]}}getSeriesRange(e,t){return[Number.NaN,Number.NaN]}legendItemSymbol(e,t,i={}){const{fills:s,strokes:n}=this.properties,{fill:o=s[t%s.length],fillOpacity:a=1,stroke:r=n[t%n.length],strokeWidth:l=0,strokeOpacity:c=1,lineDash:h=[0],lineDashOffset:d=0}=i;return{marker:{fill:o,fillOpacity:a,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}}}getLegendData(e){if(e!=="category")return[];const{showInLegend:t}=this.properties;return Array.from(this.processedNodes.values(),({id:i,label:s},n)=>({legendType:"category",id:this.id,itemId:i,seriesId:this.id,enabled:!0,label:{text:s??i},symbol:this.legendItemSymbol(1,n),hideInLegend:!t,isFixed:!0}))}pickNodeClosestDatum({x:e,y:t}){let i=1/0,s;return this.linkSelection.each((n,o)=>{const a=n.distanceSquared(e,t);a<i&&(i=a,s=o)}),this.nodeSelection.each((n,o)=>{const a=n.distanceSquared(e,t);a<i&&(i=a,s=o)}),s==null?void 0:{datum:s,distance:Math.sqrt(i)}}getDatumAriaText(e,t){if(e.type===0)return this.ctx.localeManager.t("ariaAnnounceFlowProportionLink",{index:e.index+1,count:this.linkCount,from:e.fromNode.id,to:e.toNode.id,size:e.size,sizeName:this.properties.sizeName??this.properties.sizeKey});if(e.type===1)return this.ctx.localeManager.t("ariaAnnounceFlowProportionNode",{index:e.index+1,count:this.nodeCount,description:t})}pickFocus(e){const{datumIndexDelta:t,otherIndexDelta:i}=e,s=this.contextNodeData?.nodeData[e.datumIndex-e.datumIndexDelta];let n=s;if(i!==0||t===0)return;if(s?.type===0){const r=Array.from(this.linkSelection,h=>h.datum),c=r.indexOf(s)+t;c>=0&&c<r.length?n=r[c]:c>0?n=r.at(-1):n=Array.from(this.nodeSelection,d=>d.datum).at(-1)}else if(s?.type===1){const r=Array.from(this.nodeSelection,h=>h.datum),c=r.indexOf(s)+t;c>=0&&c<r.length?n=r[c]:c<0?n=r[0]:n=Array.from(this.linkSelection,d=>d.datum)[0]}if(n==null)return;const o=n.type===1?Array.from(this.nodeSelection).find(r=>r.datum===n):Array.from(this.linkSelection).find(r=>r.datum===n);if(o==null)return;const a=this.computeFocusBounds(o.node);if(a!=null)return{datum:o.datum,datumIndex:this.contextNodeData?.nodeData.indexOf(o.datum)??0,otherIndex:0,bounds:a,clipFocusBox:!0}}getCategoryValue(e){}datumIndexForCategoryValue(e){}},{Path:PY}=L;function aE({radius:e,startAngle:t,endAngle:i,tension:s}){const n=e*Math.cos(t),o=e*Math.sin(t),a=e*Math.cos(i),r=e*Math.sin(i),l=n*s,c=o*s,h=a*s,d=r*s;return{x:[n,l,h,a],y:[o,c,d,r]}}var Pr=class extends PY{constructor(){super(...arguments),this.centerX=0,this.centerY=0,this.radius=0,this.startAngle1=0,this.endAngle1=0,this.startAngle2=0,this.endAngle2=0,this.tension=1}tensionedCurveTo(e,t,i,s,n,o,a,r){const{path:l,tension:c}=this,h=1-c;l.cubicCurveTo((i-e)*h+e,(s-t)*h+t,(n-a)*h+a,(o-r)*h+r,a,r)}updatePath(){const{path:e,centerX:t,centerY:i,radius:s}=this;let{startAngle1:n,endAngle1:o,startAngle2:a,endAngle2:r}=this;n>a&&([n,a]=[a,n],[o,r]=[r,o]),e.clear();const l=t+s*Math.cos(n),c=i+s*Math.sin(n);e.moveTo(l,c),this.tensionedCurveTo(l,c,t,i,t,i,t+s*Math.cos(r),i+s*Math.sin(r)),e.arc(t,i,s,r,a,!0),this.tensionedCurveTo(t+s*Math.cos(a),i+s*Math.sin(a),t,i,t,i,t+s*Math.cos(o),i+s*Math.sin(o)),e.arc(t,i,s,o,n,!0),e.closePath()}};g([U()],Pr.prototype,"centerX",2),g([U()],Pr.prototype,"centerY",2),g([U()],Pr.prototype,"radius",2),g([U()],Pr.prototype,"startAngle1",2),g([U()],Pr.prototype,"endAngle1",2),g([U()],Pr.prototype,"startAngle2",2),g([U()],Pr.prototype,"endAngle2",2),g([U()],Pr.prototype,"tension",2);var{FillGradientDefaults:RY,FillPatternDefaults:FY,FillImageDefaults:zY,makeSeriesTooltip:BY,SeriesProperties:_Y,Label:VY}=L,ik=class extends VY{constructor(){super(...arguments),this.spacing=1,this.maxWidth=1}};g([m],ik.prototype,"spacing",2),g([m],ik.prototype,"maxWidth",2);var Oa=class extends K{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0,this.tension=0}getStyle(e,t,i){const{fillOpacity:s,strokeWidth:n,strokeOpacity:o,lineDash:a,lineDashOffset:r,tension:l}=this,c=this.fill??e[i%e.length],h=this.stroke??t[i%e.length];return{fill:c,fillOpacity:s,stroke:h,strokeWidth:n,strokeOpacity:o,lineDash:a,lineDashOffset:r,tension:l}}};g([m],Oa.prototype,"fill",2),g([m],Oa.prototype,"fillOpacity",2),g([m],Oa.prototype,"stroke",2),g([m],Oa.prototype,"strokeOpacity",2),g([m],Oa.prototype,"strokeWidth",2),g([m],Oa.prototype,"lineDash",2),g([m],Oa.prototype,"lineDashOffset",2),g([m],Oa.prototype,"tension",2),g([m],Oa.prototype,"itemStyler",2);var Qo=class extends K{constructor(){super(...arguments),this.spacing=1,this.width=1,this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}getStyle(e,t,i){const{fillOpacity:s,strokeWidth:n,strokeOpacity:o,lineDash:a,lineDashOffset:r}=this,l=this.fill??e[i%e.length],c=this.stroke??t[i%e.length];return{fill:l,fillOpacity:s,stroke:c,strokeWidth:n,strokeOpacity:o,lineDash:a,lineDashOffset:r}}};g([m],Qo.prototype,"spacing",2),g([m],Qo.prototype,"width",2),g([m],Qo.prototype,"fill",2),g([m],Qo.prototype,"fillOpacity",2),g([m],Qo.prototype,"stroke",2),g([m],Qo.prototype,"strokeOpacity",2),g([m],Qo.prototype,"strokeWidth",2),g([m],Qo.prototype,"lineDash",2),g([m],Qo.prototype,"lineDashOffset",2),g([m],Qo.prototype,"itemStyler",2);var Bi=class extends _Y{constructor(){super(...arguments),this.idKey="",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.sizeKey=void 0,this.sizeName=void 0,this.nodes=void 0,this.fillGradientDefaults=new RY,this.fillPatternDefaults=new FY,this.fillImageDefaults=new zY,this.fills=[],this.strokes=[],this.label=new ik,this.link=new Oa,this.node=new Qo,this.tooltip=BY()}};g([m],Bi.prototype,"fromKey",2),g([m],Bi.prototype,"toKey",2),g([m],Bi.prototype,"idKey",2),g([m],Bi.prototype,"idName",2),g([m],Bi.prototype,"labelKey",2),g([m],Bi.prototype,"labelName",2),g([m],Bi.prototype,"sizeKey",2),g([m],Bi.prototype,"sizeName",2),g([m],Bi.prototype,"nodes",2),g([m],Bi.prototype,"fillGradientDefaults",2),g([m],Bi.prototype,"fillPatternDefaults",2),g([m],Bi.prototype,"fillImageDefaults",2),g([m],Bi.prototype,"fills",2),g([m],Bi.prototype,"strokes",2),g([m],Bi.prototype,"label",2),g([m],Bi.prototype,"link",2),g([m],Bi.prototype,"node",2),g([m],Bi.prototype,"tooltip",2);var{SeriesNodePickMode:rE,createDatumId:gb,Sector:GY,getShapeStyle:fb,getLabelStyles:HY,BBox:jY}=L,mb=e=>e.startAngle+Eo(e.startAngle,e.endAngle)/2,sk=class extends oE{constructor(e){super({moduleCtx:e,pickModes:[rE.NEAREST_NODE,rE.EXACT_SHAPE_MATCH]}),this.properties=new Bi}isLabelEnabled(){return(this.properties.labelKey!=null||this.nodes==null)&&this.properties.label.enabled}linkFactory(){return new Pr}nodeFactory(){return new GY}createNodeData(){const{id:e,_nodeDataDependencies:{seriesRectWidth:t,seriesRectHeight:i}={seriesRectWidth:0,seriesRectHeight:0},properties:s}=this,{fromKey:n,toKey:o,sizeKey:a,labelKey:r,label:{spacing:l,maxWidth:c,fontSize:h},node:{width:d,spacing:u}}=s,p=t/2,f=i/2;let y=[];const{nodeGraph:b,links:x}=this.getNodeGraph(F=>({...F,centerX:p,centerY:f,innerRadius:Number.NaN,outerRadius:Number.NaN,startAngle:Number.NaN,endAngle:Number.NaN}),F=>({...F,centerX:p,centerY:f,radius:Number.NaN,startAngle1:Number.NaN,endAngle1:Number.NaN,startAngle2:Number.NaN,endAngle2:Number.NaN}),{includeCircularReferences:!0});let v=0;for(const[F,{datum:_,linksBefore:G,linksAfter:B}]of b.entries()){const V=G.reduce((Y,{link:X})=>Y+X.size,0)+B.reduce((Y,{link:X})=>Y+X.size,0);if(V===0)b.delete(F);else{const{label:Y}=s;_.size=V,v+=_.size;const X=Y.enabled?this.getLabelText(_.label,_.datum,r,"label",[],Y,{datum:_.datum,value:_.label,fromKey:n,toKey:o,sizeKey:a,size:_.size}):void 0;_.label=Pe(X)}}let S=0;if(this.isLabelEnabled()){const F=Ze(this.properties.label);let _=0;for(const{datum:G}of b.values()){const{id:B,label:V}=G;if(V==null)continue;const Y=xa(V,{maxWidth:c,font:this.properties.label,textWrap:"never"}),{width:X}=F.measureLines(Y);_=Math.max(X,_),y.push({id:B,text:Y,centerX:p,centerY:f,angle:Number.NaN,radius:Number.NaN,size:G.size,datumIndex:G.datumIndex,nodeDatum:G})}S=_+l}const M=b.size;let D=Math.min(t,i)/2-d-S,k=u/D;if(S!==0&&(M*k>=1.5*Math.PI||D<=0)&&(y=[],D=Math.min(t,i)/2-d,k=u/D),M*k>=2*Math.PI||D<=0){j.warnOnce("There was insufficient space to display the Chord Series.");return}const I=D,A=D+d,C=Math.max((2*Math.PI-M*k)/v,0);let w=0;for(const{datum:F}of b.values()){F.innerRadius=I,F.outerRadius=A,F.startAngle=w,F.endAngle=w+F.size*C,w=F.endAngle+k;const _=(F.innerRadius+F.outerRadius)/2,G=mb(F);F.midPoint={x:F.centerX+_*Math.cos(G),y:F.centerY+_*Math.sin(G)}}const T=[];for(const{datum:F,linksBefore:_,linksAfter:G}of b.values()){const B=mb(F),V=[..._.map(X=>({link:X.link,distance:Eo(mb(X.node.datum),B),after:!1})),...G.map(X=>({link:X.link,distance:Eo(mb(X.node.datum),B),after:!0}))];let Y=F.startAngle;for(const{link:X,after:q}of V.toSorted((te,pe)=>te.distance-pe.distance)){const te=X.size*C;q?(X.startAngle1=Y,X.endAngle1=Y+te):(X.startAngle2=Y,X.endAngle2=Y+te),Y+=X.size*C}T.push(F)}const{tension:O}=this.properties.link;for(const F of x){F.radius=D;const _=aE({radius:D,startAngle:F.startAngle1,endAngle:F.endAngle2,tension:O}),G=aE({radius:D,startAngle:F.startAngle2,endAngle:F.endAngle1,tension:O}),B=Bo(..._.x,.5),V=Bo(..._.y,.5),Y=Bo(...G.x,.5),X=Bo(...G.y,.5);F.midPoint={x:F.centerX+(B+Y)/2,y:F.centerY+(V+X)/2},T.push(F)}for(const F of y){const _=b.get(F.id)?.datum;_!=null&&(F.radius=A+l,F.angle=tt(_.startAngle+Eo(_.startAngle,_.endAngle)/2),F.datumIndex=_.datumIndex,F.nodeDatum=_)}y.sort((F,_)=>F.angle-_.angle);let E=1/0,z=-1/0;return y=y.filter(F=>{const _=Mn(h),G=Math.atan2(_/2,F.radius),B=F.angle-G,V=F.angle+G;return Us(E,B,V)||Us(z,B,V)?!1:(E=Math.min(B,E),z=Math.max(V,z),!0)}),{itemId:e,nodeData:T,labelData:y}}updateLabelSelection(e){const t=this.isLabelEnabled()?e.labelData:[];return e.labelSelection.update(t)}updateLabelNodes(e){const t={toKey:this.properties.toKey,fromKey:this.properties.fromKey,sizeKey:this.properties.sizeKey,size:Number.NaN},i=this.getHighlightedDatum();e.labelSelection.each((s,n)=>{const{size:o,text:a,centerX:r,centerY:l,radius:c,angle:h,datumIndex:d,nodeDatum:u}=n;t.size=o;const p=this.isLabelHighlighted(u,i),f=this.getHighlightStyle(p,d),y=HY(this,void 0,t,this.properties.label,p,i),{fontStyle:b,fontWeight:x,fontSize:v,fontFamily:S,color:M}=y;s.visible=!0,s.translationX=r+c*Math.cos(h),s.translationY=l+c*Math.sin(h),s.text=a,s.fill=M,s.fontStyle=b,s.fontWeight=x,s.fontSize=v,s.fontFamily=S,s.textBaseline="middle",Math.cos(h)>=0?(s.textAlign="left",s.rotation=h):(s.textAlign="right",s.rotation=h-Math.PI);const D=f.opacity??1;s.opacity=D,s.fillOpacity=D,s.setBoxing(y)})}updateNodeSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>gb(t.type,t.id))}getNodeStyle(e,t,i){const{properties:s}=this,{fills:n,strokes:o,fillGradientDefaults:a,fillPatternDefaults:r,fillImageDefaults:l}=s,{itemStyler:c}=s.node,h=this.getHighlightStyle(i,e.datumIndex),d=oe(h,s.node.getStyle(n,o,t));let u=fb(d,a,r,l);if(c!=null&&e.datumIndex!=null){const p=this.cachedDatumCallback(gb(e.datumIndex.index,"node",i?"highlight":"node"),()=>{const f=this.makeItemStylerParams(e,i,u);return this.callWithContext(c,f)});p&&(u=fb(oe(p,u),a,r,l))}return u.opacity=1,u}makeItemStylerParams({datum:e,datumIndex:t,size:i=0,label:s},n,o){const{id:a}=this,r=this.ctx.highlightManager?.getActiveHighlight(),l=this.getHighlightStateString(r,n,t),c=this.filterItemStylerFillParams(o.fill)??o.fill;return{seriesId:a,datum:e,highlightState:l,...o,size:i,label:s,fill:c}}updateNodeNodes(e){const{datumSelection:t,isHighlight:i}=e,s=this.getShapeFillBBox();t.each((n,o)=>{const{datumIndex:a}=o,r=this.getNodeStyle(o,a.index,i);n.setStyleProperties(r,s),n.centerX=o.centerX,n.centerY=o.centerY,n.innerRadius=o.innerRadius,n.outerRadius=o.outerRadius,n.startAngle=o.startAngle,n.endAngle=o.endAngle,n.inset=n.strokeWidth/2})}updateLinkSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>gb(t.type,t.index,t.fromNode.id,t.toNode.id))}getLinkStyle({datumIndex:e,datum:t},i,s){const{id:n,properties:o}=this,{fills:a,strokes:r,fillGradientDefaults:l,fillPatternDefaults:c,fillImageDefaults:h}=o,{itemStyler:d}=o.link,u=this.getHighlightStyle(s,e),p=oe(u,o.link.getStyle(a,r,i.index));let f=fb(p,l,c,h);if(d!=null&&e!=null){const y=this.ctx.highlightManager?.getActiveHighlight(),b=this.cachedDatumCallback(gb(e.index,"link",s?"highlight":"node"),()=>{const x=this.getHighlightStateString(y,s,i);return this.callWithContext(d,{seriesId:n,datum:t,highlightState:x,...f})});b&&(f=fb(oe(b,f),l,c,h))}return f.opacity=1,f}updateLinkNodes(e){const{datumSelection:t,isHighlight:i}=e,s=this.getShapeFillBBox();t.each((n,o)=>{const a=o.fromNode.datumIndex,r=this.getLinkStyle(o,a,i);n.centerX=o.centerX,n.centerY=o.centerY,n.radius=o.radius,n.startAngle1=o.startAngle1,n.endAngle1=o.endAngle1,n.startAngle2=o.startAngle2,n.endAngle2=o.endAngle2,n.tension=r.tension,n.setStyleProperties(r,s)})}getShapeFillBBox(){const e=this._nodeDataDependencies?.seriesRectWidth??0,t=this._nodeDataDependencies?.seriesRectHeight??0,i=Math.min(e,t),s=(e-i)/2,n=(t-i)/2,o=new jY(s,n,e,t);return{series:o,axis:o}}getTooltipContent(e){const{id:t,linksProcessedData:i,nodesProcessedData:s,properties:n,ctx:{formatManager:o}}=this,{fromKey:a,toKey:r,sizeKey:l,sizeName:c,tooltip:h}=n,d=this.contextNodeData?.nodeData.find(v=>v.datumIndex.type===e.type&&v.datumIndex.index===e.index);if(d==null)return;const u=d.type===0?d.fromNode.index:d.index,p=d.type===0?`${d.fromNode.label} - ${d.toNode.label}`:d.label,f=e.type===0?i?.dataSources.get(this.id)?.data[e.index]:s?.dataSources.get(this.id)?.data[e.index],y=d.size;let b;if(d.type===0){const v=d.fromNode.datumIndex;b=this.getLinkStyle({datumIndex:e,datum:f},v,!1)}else{const v=d.label;b=this.getNodeStyle({datumIndex:e,datum:f,size:y,label:v},e.index,!1)}const x=[];if(l!=null){const v=o.format(this.callWithContext.bind(this),{type:"number",value:y,datum:f,seriesId:t,legendItemName:void 0,key:l,source:"tooltip",property:"size",domain:[],boundSeries:this.getFormatterContext("size"),fractionDigits:void 0});x.push({label:c,fallbackLabel:l,value:v??String(y)})}return this.formatTooltipWithContext(h,{title:p,symbol:this.legendItemSymbol(d.type,u,b),data:x},{seriesId:t,datum:f,title:p,fromKey:a,toKey:r,sizeKey:l,sizeName:c,size:y,...b})}computeFocusBounds(e){return e}hasItemStylers(){return this.properties.node.itemStyler!=null||this.properties.link.itemStyler!=null||this.properties.label.itemStyler!=null}};sk.className="ChordSeries",sk.type="chord";var{chordSeriesThemeableOptionsDef:WY}=L,yb={...WY,...et,type:$(Le("chord")),fromKey:$(N),toKey:$(N),sizeKey:N,sizeName:N};yb.fillGradientDefaults=ee(zp),yb.fillPatternDefaults=ee(Bp),yb.fillImageDefaults=ee(_p);var lE={type:"series",name:"chord",chartType:"standalone",enterprise:!0,solo:!0,version:ue,dependencies:[Wu],options:yb,themeTemplate:{series:{fills:{$palette:"fills"},strokes:{$palette:"strokes"},fillGradientDefaults:L.FILL_GRADIENT_LINEAR_DEFAULTS,fillPatternDefaults:L.FILL_PATTERN_DEFAULTS,fillImageDefaults:L.FILL_IMAGE_DEFAULTS,highlight:L.singleSeriesHighlightStyle(),label:{...L.LABEL_BOXING_DEFAULTS,enabled:!0,fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:5,maxWidth:100},node:{spacing:8,width:10,strokeWidth:{$isUserOption:["./stroke",2,0]}},link:{fillOpacity:.5,strokeWidth:{$isUserOption:["./stroke",2,0]},tension:.4}},legend:{enabled:!1,toggleSeries:!1}},create:e=>new sk(e)},{BBox:$Y,Path:UY}=L,cE=1e-6;function hE([e,t],[i,s]){return Math.abs(e-i)<=cE&&Math.abs(t-s)<=cE}var Ea=class extends UY{constructor(){super(...arguments),this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0}get midPoint(){const{x0:e,y0:t,x1:i,y1:s,x2:n,y2:o,x3:a,y3:r}=this;return{x:(e+i+n+a)/4,y:(t+s+o+r)/4}}distanceSquared(e,t){if(this.containsPoint(e,t))return 0;const{x0:i,y0:s,x1:n,y1:o,x2:a,y2:r,x3:l,y3:c}=this;return Math.min(dr(e,t,i,s,n,o,1/0),dr(e,t,n,o,a,r,1/0),dr(e,t,a,r,l,c,1/0),dr(e,t,l,c,i,s,1/0))}computeBBox(){const{x0:e,y0:t,x1:i,y1:s,x2:n,y2:o,x3:a,y3:r}=this,l=Math.min(e,i,n,a),c=Math.max(e,i,n,a)-l,h=Math.min(t,s,o,r),d=Math.max(t,s,o,r)-h;return new $Y(l,h,c,d)}updatePath(){const{path:e,x0:t,y0:i,x1:s,y1:n,x2:o,y2:a,x3:r,y3:l}=this,c=[[t,i],[s,n],[o,a],[r,l]];e.clear();let h,d;for(const u of c){if(h!=null&&hE(h,u)||d!=null&&hE(d,u))continue;const[p,f]=u;h==null?e.moveTo(p,f):e.lineTo(p,f),h??(h=u),d=u}e.closePath()}};g([U()],Ea.prototype,"x0",2),g([U()],Ea.prototype,"y0",2),g([U()],Ea.prototype,"x1",2),g([U()],Ea.prototype,"y1",2),g([U()],Ea.prototype,"x2",2),g([U()],Ea.prototype,"y2",2),g([U()],Ea.prototype,"x3",2),g([U()],Ea.prototype,"y3",2);var{SeriesProperties:KY,makeSeriesTooltip:YY,Label:dE,DropShadow:ZY}=L,XY=class extends dE{},nk=class extends dE{constructor(){super(...arguments),this.spacing=0}};g([m],nk.prototype,"spacing",2),g([m],nk.prototype,"placement",2);var _i=class extends KY{constructor(){super(...arguments),this.fills=[],this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.direction="vertical",this.reverse=void 0,this.spacing=0,this.aspectRatio=void 0,this.shadow=new ZY().set({enabled:!1}),this.label=new XY,this.stageLabel=new nk,this.tooltip=YY()}getStyle(e=0){const{fills:t,strokes:i,fillOpacity:s,strokeWidth:n,strokeOpacity:o,lineDash:a,lineDashOffset:r}=this;return{fill:t[e%t.length],fillOpacity:s,stroke:i[e%i.length],strokeWidth:n,strokeOpacity:o,lineDash:a,lineDashOffset:r,opacity:1}}};g([m],_i.prototype,"stageKey",2),g([m],_i.prototype,"valueKey",2),g([m],_i.prototype,"fills",2),g([m],_i.prototype,"fillOpacity",2),g([m],_i.prototype,"strokes",2),g([m],_i.prototype,"strokeWidth",2),g([m],_i.prototype,"strokeOpacity",2),g([m],_i.prototype,"lineDash",2),g([m],_i.prototype,"lineDashOffset",2),g([m],_i.prototype,"direction",2),g([m],_i.prototype,"reverse",2),g([m],_i.prototype,"spacing",2),g([m],_i.prototype,"aspectRatio",2),g([m],_i.prototype,"itemStyler",2),g([m],_i.prototype,"shadow",2),g([m],_i.prototype,"label",2),g([m],_i.prototype,"stageLabel",2),g([m],_i.prototype,"tooltip",2);function uE(e,{x:t,y:i,top:s,right:n,bottom:o,left:a}){e.x0=t-s/2,e.x1=t+s/2,e.x2=t+o/2,e.x3=t-o/2,e.y0=i-a/2,e.y1=i-n/2,e.y2=i+n/2,e.y3=i+a/2}function qY(e){return{fromFn:(n,o)=>{const{x:a,y:r}=o;let{top:l,right:c,bottom:h,left:d}=o;return e==="vertical"?(l=0,h=0):(d=0,c=0),{x:a,y:r,top:l,right:c,bottom:h,left:d}},toFn:(n,o)=>{const{x:a,y:r,top:l,right:c,bottom:h,left:d}=o;return{x:a,y:r,top:l,right:c,bottom:h,left:d}},applyFn:uE}}var{valueProperty:pE,SeriesNodePickMode:gE,createDatumId:QY,BBox:ok,Group:ak,Selection:xf,Text:rk,PointerEvents:fE,fromToMotion:JY,seriesLabelFadeInAnimation:e5,getLabelStyles:t5}=L,lk=class extends L.DataModelSeries{constructor(e){super({moduleCtx:e,categoryKey:void 0,pickModes:[gE.EXACT_SHAPE_MATCH,gE.NEAREST_NODE]}),this.properties=new _i,this.itemGroup=this.contentGroup.appendChild(new ak({name:"itemGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new ak({name:"itemLabelGroup"})),this.stageLabelGroup=this.contentGroup.appendChild(new ak({name:"stageLabelGroup"})),this.datumSelection=xf.select(this.itemGroup,()=>this.nodeFactory()),this.labelSelection=xf.select(this.itemLabelGroup,rk),this.stageLabelSelection=xf.select(this.stageLabelGroup,rk),this.highlightLabelSelection=xf.select(this.highlightLabelGroup,rk),this.highlightDatumSelection=xf.select(this.highlightNodeGroup,()=>this.nodeFactory()),this.animationState=new he("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{clear:"empty",reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable()),this.itemLabelGroup.pointerEvents=fE.None,this.stageLabelGroup.pointerEvents=fE.None,this.cleanup.register(this.ctx.eventsHub.on("legend:item-click",t=>this.onLegendItemClick(t)))}nodeFactory(){return new Ea}getNodeData(){return this.contextNodeData?.nodeData}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"&&this.animationState.transition("skip")}async processData(e){if(this.data==null)return;const{id:t,visible:i,ctx:{legendManager:s}}=this,{stageKey:n,valueKey:o}=this.properties,a="category",r="number",l=(h,d,u)=>i&&s.getItemEnabled({seriesId:t,itemId:u}),c=this.visible?{}:{forceValue:0};await this.requestDataModel(e,this.data,{props:[pE(n,a,{id:"xValue"}),pE(o,r,{id:"yValue",...c,validation:l,invalidValue:0})]})}createNodeData(){const{id:e,dataModel:t,processedData:i,properties:s,visible:n,ctx:{legendManager:o}}=this,{stageKey:a,valueKey:r,direction:l,reverse:c=l==="horizontal",spacing:h,aspectRatio:d,label:u,stageLabel:p}=s;if(t==null||i==null)return;const f=l==="horizontal",y=t.resolveColumnById(this,"xValue",i),b=t.resolveColumnById(this,"yValue",i),x=t.getDomain(this,"xValue","value",i).domain,v=t.getDomain(this,"yValue","value",i).domain,S=Ze(p);let M,D;f?(M="center",D=p.placement==="before"?"bottom":"top"):(M=p.placement==="after"?"left":"right",D="middle");const k=p.enabled?[]:void 0;let I=0,A=0,C=0;const w=i.dataSources.get(this.id)?.data??[];for(const[q,te]of w.entries()){const pe=y[q],Se=b[q],ve=n&&o.getItemEnabled({seriesId:e,itemId:q});if(C+=Se,k==null)continue;const ae=this.getLabelText(pe,te,a,"x",x,this.properties.stageLabel,{datum:te,value:Se,stageKey:a,valueKey:r}),{width:Ie,height:ze}=Ce(ae)?Ks(ae,u):S.measureLines(Dt(ae));I=Math.max(I,Ie),A=Math.max(A,ze),k.push({x:Number.NaN,y:Number.NaN,text:ae,textAlign:M,textBaseline:D,visible:ve})}const T=this._nodeDataDependencies?.seriesRectWidth??0,O=this._nodeDataDependencies?.seriesRectHeight??0,E=h*(i.input.count-1);let z;if(f){const q=A+p.spacing;z=new ok(0,p.placement==="before"?q:0,T,O-q)}else{const q=I+p.spacing;z=new ok(p.placement==="after"?0:q,0,T-q,O)}if(d!=null&&d!==0){const q=l==="horizontal"?1/d:d,te=Math.min(z.width,z.height*q),pe=te/q;z=new ok(z.x+(z.width-te)/2,z.y+(z.height-pe)/2,te,pe)}let F,_;f?_=p.placement==="before"?z.y-p.spacing:z.y+z.height+p.spacing:F=p.placement==="after"?z.x+z.width+p.spacing:z.x-p.spacing;const G=z.width-(f?E:0),B=z.height-(f?0:E);if(G<0||B<0)return;const V=[],Y=[];let X=0;for(const[q,te]of w.entries()){const pe=y[q],Se=b[q],ve=n&&o.getItemEnabled({seriesId:e,itemId:q}),ae=X+Se,Ie=(X+ae)/(2*C),ze=(ae-X)/C,Xe=f?G*Ie+h*q:G*.5,Te=f?B*.5:B*Ie+h*q,de=z.x+Xe,De=z.y+Te;if(k!=null){const rt=k[q];rt.x=F??de,rt.y=_??De}let ye,Ee,Ne,xt;if(f){const rt=G*ze;ye=rt,Ne=rt;const wt=(Xe+rt/2)*(B/z.width),vt=(Xe-rt/2)*(B/z.width);Ee=c?z.height-wt:wt,xt=c?z.height-vt:vt}else{const rt=B*ze;Ee=rt,xt=rt;const wt=(Te-rt/2)*(G/z.height),vt=(Te+rt/2)*(G/z.height);ye=c?z.width-wt:wt,Ne=c?z.width-vt:vt}const nt=this.getLabelText(Se,te,r,"y",v,u,{datum:te,value:Se,stageKey:a,valueKey:r}),We={x:de,y:De,text:nt,textAlign:"center",textBaseline:"middle",visible:ve};Y.push(We),V.push({series:this,itemId:r,datum:te,datumIndex:q,index:q,xValue:pe,yValue:Se,x:de,y:De,top:ye,right:Ee,bottom:Ne,left:xt,label:We,enabled:ve,midPoint:{x:de,y:De},style:this.getItemStyle({datumIndex:q,datum:te},!1)}),X=ae}return{itemId:e,nodeData:V,labelData:Y,stageLabelData:k,bounds:z}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update({seriesRect:e}){this.checkResize(e);const{datumSelection:t,labelSelection:i,stageLabelSelection:s,highlightDatumSelection:n,highlightLabelSelection:o}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let a=this.ctx.highlightManager?.getActiveHighlight();a!=null&&(a.series!==this||a.datum==null)&&(a=void 0);const r=this.contextNodeData?.nodeData??[],l=this.contextNodeData?.labelData??[],c=this.contextNodeData?.stageLabelData??[];this.datumSelection=this.updateDatumSelection({nodeData:r,datumSelection:t}),this.updateDatumStyles({datumSelection:t,isHighlight:!1}),this.updateDatumNodes({datumSelection:t,isHighlight:!1}),this.labelSelection=this.updateLabelSelection({labelData:l,labelSelection:i}),this.updateLabelNodes({labelSelection:i,labelProperties:this.properties.label}),this.stageLabelSelection=this.updateStageLabelSelection({stageLabelData:c,stageLabelSelection:s}),this.updateLabelNodes({labelSelection:s,labelProperties:this.properties.stageLabel,checkActiveHighlight:!0});const h=this.getHighlightLabelData(l,a)??[];this.highlightLabelSelection=o.update(h),this.updateLabelNodes({labelSelection:this.highlightLabelSelection,labelProperties:this.properties.label,isHighlight:!0}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:a==null?[]:[a],datumSelection:n}),this.updateDatumStyles({datumSelection:n,isHighlight:!0}),this.updateDatumNodes({datumSelection:n,isHighlight:!0}),this.animationState.transition("update")}updateDatumSelection(e){return e.datumSelection.update(e.nodeData)}getItemStyle({datumIndex:e,datum:t},i){const{properties:s}=this,{itemStyler:n}=s,o=this.getHighlightStyle(i,e);let r=oe(o,s.getStyle(e));if(n!=null&&e!=null){const l=this.cachedDatumCallback(QY(e,i?"highlight":"node"),()=>{const c=this.makeItemStylerParams(t,e,i,r);return this.callWithContext(n,c)});l&&(r=oe(l,r))}return r}makeItemStylerParams(e,t,i,s){const{id:n,properties:o}=this,{stageKey:a,valueKey:r}=o,l=this.ctx.highlightManager?.getActiveHighlight(),c=this.getHighlightStateString(l,i,t),h=this.filterItemStylerFillParams(s.fill)??s.fill;return{seriesId:n,datum:e,stageKey:a,valueKey:r,highlightState:c,...s,fill:h}}updateDatumStyles({datumSelection:e,isHighlight:t}){e.each((i,s)=>{s.style=this.getItemStyle(s,t)})}updateDatumNodes({datumSelection:e}){const{properties:t}=this,{shadow:i}=t,s=this.contextNodeData?.bounds,n=s?{series:s,axis:s}:void 0;e.each((o,a)=>{o.setStyleProperties(a.style,n),uE(o,a),o.fillShadow=i})}updateLabelSelection(e){return e.labelSelection.update(this.properties.label.enabled?e.labelData:[])}updateStageLabelSelection(e){return e.stageLabelSelection.update(e.stageLabelData)}updateLabelNodes(e){const t=this.ctx.highlightManager?.getActiveHighlight(),{labelSelection:i,labelProperties:s,isHighlight:n=!1,checkActiveHighlight:o=!1}=e;i.each((a,r,l)=>{const{visible:c,x:h,y:d,text:u,textAlign:p,textBaseline:f}=r,y=n||o&&t?.datumIndex===l,b=this.getHighlightStyle(y,l),x=t5(this,void 0,this.properties,s,y,t),{color:v,fontSize:S,fontStyle:M,fontWeight:D,fontFamily:k}=x;a.visible=c,a.x=h,a.y=d,a.text=u,a.fill=v,a.opacity=(b.opacity??1)*(x.fillOpacity??1),a.fillOpacity=(b.opacity??1)*(x.fillOpacity??1),a.fontStyle=M,a.fontWeight=D,a.fontSize=S,a.fontFamily=k,a.textAlign=p,a.textBaseline=f,a.setBoxing(x)})}getHighlightLabelData(e,t){if(t?.label)return[{...t.label}]}computeFocusBounds(e){const t=this.getNodeData()?.[e.datumIndex];if(t!==void 0){for(const i of this.datumSelection)if(i.datum===t)return i.node}}getTooltipContent(e){const{id:t,dataModel:i,processedData:s,properties:n}=this,{stageKey:o,valueKey:a,tooltip:r}=n;if(!i||!s)return;const l=s.dataSources.get(this.id)?.data[e],c=i.resolveColumnById(this,"xValue",s)[e],h=i.resolveColumnById(this,"yValue",s)[e];if(c==null)return;const d=this.getLabelText(c,l,o,"x",i.getDomain(this,"xValue","value",s).domain,this.properties.stageLabel,{datum:l,value:c,stageKey:o,valueKey:a}),u=this.getItemStyle({datumIndex:e,datum:l},!1);return this.formatTooltipWithContext(r,{symbol:this.legendItemSymbol(e),data:[{label:Pe(d),value:Pe(h)}]},{seriesId:t,datum:l,title:void 0,stageKey:o,valueKey:a,...u})}getSeriesDomain(){return{domain:[Number.NaN,Number.NaN]}}getSeriesRange(){return[Number.NaN,Number.NaN]}pickNodeClosestDatum({x:e,y:t}){let i=1/0,s;return this.datumSelection.each((n,o)=>{const a=n.distanceSquared(e,t);a<i&&(i=a,s=o)}),s==null?void 0:{datum:s,distance:Math.sqrt(i)}}legendItemSymbol(e){const{fills:t,strokes:i,strokeWidth:s,fillOpacity:n,strokeOpacity:o,lineDash:a,lineDashOffset:r}=this.properties,l=t[e]??"black",c=i[e]??"black";return{marker:{fill:l,fillOpacity:n,stroke:c,strokeWidth:s,strokeOpacity:o,lineDash:a,lineDashOffset:r}}}getLegendData(e){const{processedData:t,dataModel:i,id:s,ctx:{legendManager:n},visible:o}=this;if(!i||!t||e!=="category")return[];const{showInLegend:a}=this.properties,r=[],l=i.resolveColumnById(this,"xValue",t),c=t.dataSources.get(this.id)?.data??[];for(const[h]of c.entries()){const d=l[h];r.push({legendType:"category",id:s,itemId:h,seriesId:s,enabled:o&&n.getItemEnabled({seriesId:s,itemId:h}),label:{text:d},symbol:this.legendItemSymbol(h),hideInLegend:!a})}return r}animateReset(){this.ctx.animationManager.skipCurrentBatch(),this.ctx.animationManager.stopByAnimationGroupId(this.id)}animateEmptyUpdateReady(){const{datumSelection:e,labelSelection:t,properties:i}=this,s=qY(i.direction);JY(this.id,"nodes",this.ctx.animationManager,[e],s),e5(this,"labels",this.ctx.animationManager,t)}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.label.itemStyler!=null}};lk.className="PyramidSeries",lk.type="pyramid";var{pyramidSeriesThemeableOptionsDef:i5}=L,s5={...i5,...et,type:$(Le("pyramid")),stageKey:$(N),valueKey:$(N)},n5={series:{direction:"vertical",strokeWidth:{$isUserOption:["./strokes/0",2,0]},spacing:2,fills:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$palette:"fills"},{$applySwitch:[{$path:["/type",void 0,{$value:"$1"}]},{$value:"$1"},["gradient",L.FILL_GRADIENT_LINEAR_DEFAULTS],["pattern",L.FILL_PATTERN_DEFAULTS],["image",L.FILL_IMAGE_DEFAULTS]]}]},strokes:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$palette:"strokes"}]},label:{...L.LABEL_BOXING_DEFAULTS,enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"chartBackgroundColor"}},stageLabel:{...L.LABEL_BOXING_DEFAULTS,enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:12},shadow:{enabled:!1,color:fa,xOffset:3,yOffset:3,blur:5},highlight:{unhighlightedItem:{opacity:.4}}}},mE={type:"series",name:"pyramid",chartType:"standalone",enterprise:!0,solo:!0,version:ue,dependencies:[Wu],options:s5,themeTemplate:n5,create:e=>new lk(e)},{BBox:o5,Path:a5}=L,vh=class extends a5{constructor(){super(...arguments),this.x1=0,this.x2=0,this.y1=0,this.y2=0,this.height=0,this.inset=0,this.elbows=[]}computeBBox(){const e=Math.min(this.x1,this.x2),t=Math.max(this.x1,this.x2)-e,i=Math.min(this.y1,this.y2),s=Math.max(this.y1,this.y2)-i+this.height;return new o5(e,i,t,s)}updatePath(){const{path:e,inset:t}=this;e.clear();const i=this.height-2*this.inset,s=i/2;let n=this.x1+t,o=this.y1+t;e.moveTo(n,o);for(const l of this.elbows)this.updatePathSection(n,o,l.x,l.y,i,-s),n=l.x,o=l.y;const a=this.x2-t,r=this.y2+t;this.updatePathSection(n,o,a,r,i,-s),e.lineTo(a,r+i),n=a,o=r;for(const l of this.elbows.toReversed())this.updatePathSection(n,o,l.x,l.y,i,s),n=l.x,o=l.y;this.updatePathSection(n,o,this.x1+t,this.y1+t,i,s),e.closePath()}updatePathSection(e,t,i,s,n,o){const{path:a}=this,r=H.from(e,t+o+n/2),l=H.from(i,s+o+n/2);if(Math.abs(l.y-r.y)<2){a.lineTo(l.x,l.y);return}let c=H.angle(H.sub(l,r));c<0&&(c=2*Math.PI+c);const h=0,d=Math.PI/2,u=Math.PI,p=Math.PI*1.5,f=yE(r,l,0),y=yE(r,l,n);if(f.radius<n){a.cubicCurveTo((r.x+l.x)/2,r.y,(r.x+l.x)/2,l.y,l.x,l.y);return}c>=p?(a.arc(r.x,t-f.radius,f.radius,d,d+y.angle,!0),a.arc(l.x,s+y.radius,y.radius,p+y.angle,p),a.lineTo(l.x,l.y)):c>h&&c<=d?(a.arc(r.x,t+y.radius,y.radius,p,p+y.angle),a.arc(l.x,s-f.radius,f.radius,d+f.angle,d,!0),a.lineTo(l.x,l.y)):c>d&&c<=u?(a.arc(r.x,t+y.radius,y.radius-n,p,p+y.angle,!0),a.arc(l.x,s-f.radius,f.radius+n,d+f.angle,d),a.lineTo(l.x,l.y)):(a.arc(r.x,t-f.radius,f.radius+n,d,d+f.angle),a.arc(l.x,s+y.radius,y.radius-n,p+y.angle,p,!0),a.lineTo(l.x,l.y))}};g([U()],vh.prototype,"x1",2),g([U()],vh.prototype,"x2",2),g([U()],vh.prototype,"y1",2),g([U()],vh.prototype,"y2",2),g([U()],vh.prototype,"height",2),g([U()],vh.prototype,"inset",2);function yE(e,t,i){const s=H.angle(H.sub(t,e)),n=H.distance(e,t),o=H.add(e,H.rotate(H.from(n/2,0),s)),a=-1/H.gradient(e,t),r=H.intercept(o,a),l=r5(.1,.5,Math.PI/2-Math.abs(H.gradient(e,t))),c=H.intersectAtX(a,r,e.x),h=Math.max(i,H.distance(e,c)*l);return{angle:H.angle(H.sub(c,e),H.sub(c,o))/-(1.1-l),radius:h}}function r5(e,t,i){return ge(e,(t-e)*i+e,t)}var{FillGradientDefaults:l5,FillPatternDefaults:c5,FillImageDefaults:h5,makeSeriesTooltip:d5,SeriesProperties:u5,Label:p5}=L,xb=class extends p5{constructor(){super(...arguments),this.spacing=1,this.placement=void 0,this.edgePlacement=void 0}};g([m],xb.prototype,"spacing",2),g([m],xb.prototype,"placement",2),g([m],xb.prototype,"edgePlacement",2);var Rr=class extends K{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};g([m],Rr.prototype,"fill",2),g([m],Rr.prototype,"fillOpacity",2),g([m],Rr.prototype,"stroke",2),g([m],Rr.prototype,"strokeOpacity",2),g([m],Rr.prototype,"strokeWidth",2),g([m],Rr.prototype,"lineDash",2),g([m],Rr.prototype,"lineDashOffset",2),g([m],Rr.prototype,"itemStyler",2);var qs=class extends K{constructor(){super(...arguments),this.spacing=1,this.minSpacing=0,this.width=1,this.alignment="justify",this.verticalAlignment="center",this.sort="auto",this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};g([m],qs.prototype,"spacing",2),g([m],qs.prototype,"minSpacing",2),g([m],qs.prototype,"width",2),g([m],qs.prototype,"alignment",2),g([m],qs.prototype,"verticalAlignment",2),g([m],qs.prototype,"sort",2),g([m],qs.prototype,"fill",2),g([m],qs.prototype,"fillOpacity",2),g([m],qs.prototype,"stroke",2),g([m],qs.prototype,"strokeOpacity",2),g([m],qs.prototype,"strokeWidth",2),g([m],qs.prototype,"lineDash",2),g([m],qs.prototype,"lineDashOffset",2),g([m],qs.prototype,"itemStyler",2);var fi=class extends u5{constructor(){super(...arguments),this.nodes=void 0,this.idKey="",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.sizeKey=void 0,this.sizeName=void 0,this.fillGradientDefaults=new l5,this.fillPatternDefaults=new c5,this.fillImageDefaults=new h5,this.defaultColorRange=[],this.defaultPatternFills=[],this.fills=[],this.strokes=[],this.label=new xb,this.link=new Rr,this.node=new qs,this.tooltip=d5()}getStyle(e,t,i,s){const{fillOpacity:n,strokeWidth:o,strokeOpacity:a,lineDash:r,lineDashOffset:l,fill:c=t[s%t.length],stroke:h=i[s%t.length]}=e?this.link:this.node;return{fill:c,fillOpacity:n,stroke:h,strokeWidth:o,strokeOpacity:a,lineDash:r,lineDashOffset:l}}};g([m],fi.prototype,"nodes",2),g([m],fi.prototype,"fromKey",2),g([m],fi.prototype,"toKey",2),g([m],fi.prototype,"idKey",2),g([m],fi.prototype,"idName",2),g([m],fi.prototype,"labelKey",2),g([m],fi.prototype,"labelName",2),g([m],fi.prototype,"sizeKey",2),g([m],fi.prototype,"sizeName",2),g([m],fi.prototype,"fillGradientDefaults",2),g([m],fi.prototype,"fillPatternDefaults",2),g([m],fi.prototype,"fillImageDefaults",2),g([m],fi.prototype,"defaultColorRange",2),g([m],fi.prototype,"defaultPatternFills",2),g([m],fi.prototype,"fills",2),g([m],fi.prototype,"strokes",2),g([m],fi.prototype,"label",2),g([m],fi.prototype,"link",2),g([m],fi.prototype,"node",2),g([m],fi.prototype,"tooltip",2);var{Transformable:g5,SeriesNodePickMode:xE,createDatumId:bb,getShapeStyle:bE,getLabelStyles:f5,Rect:vE,BBox:SE}=L,ck=class extends oE{constructor(e){super({moduleCtx:e,pickModes:[xE.NEAREST_NODE,xE.EXACT_SHAPE_MATCH]}),this.properties=new fi}isLabelEnabled(){return(this.properties.labelKey!=null||this.nodes==null)&&this.properties.label.enabled}linkFactory(){return new vh}nodeFactory(){return new vE}createNodeData(){const e=this._nodeDataDependencies?.seriesRectWidth??0,t=this.properties.node.width,{nodeGraph:i,links:s,maxPathLength:n}=this.getNodeGraph(this.createNode.bind(this,t),this.createLink,{includeCircularReferences:!1}),o=i;if(o.size===0)return;const a=this.initialiseColumns(n);this.assignNodesToColumns(o,a,n);const r=Ze(this.properties.label),{columnLabelInsetBefore:l,columnLabelInsetAfter:c}=this.getColumnLabelInsets(a,r,n),h=(e-t-l-c)/(n-1);this.positionNodesInColumnsX(a,h,l),this.createGhostNodesAndColumnDiffs(o,a),this.weightNodes(a);const d=1,{sizeScale:u,nodeSpacing:p}=this.getScaleAndSpacing(a,d);if(u<0){j.warnOnce("There was insufficient space to display the Sankey Series. Reduce [node.spacing], [node.minSpacing], or provide a larger container.");return}this.positionNodesInColumnsY(a,d,u,p),this.sortAndPositionLinks(o,u);const f=[],y=[];return this.createNodesNodeData(f,o,a,h,r,y),this.createLinksNodeData(f,s,d,u),{itemId:this.id,nodeData:f,labelData:y}}createNode(e,t){return{...t,x:Number.NaN,y:Number.NaN,width:e,height:Number.NaN}}createLink(e){return{...e,x1:Number.NaN,x2:Number.NaN,y1:Number.NaN,y2:Number.NaN,height:Number.NaN,elbows:[]}}initialiseColumns(e){const t=[];for(let i=0;i<e;i+=1)t.push({index:i,size:0,nodes:[],x:0});return t}assignNodesToColumns(e,t,i){const{fromKey:s,toKey:n,sizeKey:o,labelKey:a}=this.properties;for(const r of e.values()){const{datum:l,linksBefore:c,linksAfter:h}=r,d=Math.max(c.reduce((y,{link:b})=>y+b.size,0),h.reduce((y,{link:b})=>y+b.size,0));if(c.length===0&&h.length===0||d===0){r.columnIndex=-1;continue}const u=this.getNodeColumn(t,r,i);l.size=d;const{label:p}=this.properties,f=p.enabled?this.getLabelText(l.label,l.datum,a,"label",[],this.properties.label,{datum:l.datum,value:l.label,fromKey:s,toKey:n,sizeKey:o,size:d}):void 0;l.label=Pe(f),u.nodes.push(r),u.size+=d,r.columnIndex=u.index}}getNodeColumn(e,t,i){const{node:{alignment:s}}=this.properties,{linksBefore:n,linksAfter:o,maxPathLengthBefore:a,maxPathLengthAfter:r}=t;let l;switch(s){case"left":l=e[a];break;case"right":l=e[i-1-r];break;case"center":{if(n.length!==0)l=e[a];else if(o.length===0)l=e[0];else{const c=o.reduce((h,d)=>Math.min(h,d.node.maxPathLengthBefore),i)-1;l=e[c]}break}case"justify":{l=o.length===0?e[i-1]:e[a];break}}return l}getColumnLabelInsets(e,t,i){const{label:{spacing:s,placement:n,edgePlacement:o},node:{width:a}}=this.properties,r=this._nodeDataDependencies?.seriesRectWidth??0;let l=0,c=0;if(this.isLabelEnabled()&&(o==="outside"||o==null)){const h=(d,u)=>{const p=u;if(p.datum.label==null||p.datum.label==="")return d;let f=(r-a)/(i-1)-s;n==="center"&&o==null&&(f/=2);const y=xa(p.datum.label,{maxWidth:f,maxHeight:p.datum.height,font:this.properties.label,textWrap:"never"});let{width:b}=t.measureLines(y);return n==="center"&&o==null&&(b/=2),Math.max(d,b)};(n!=="right"||o==="outside")&&(l=a+e[0].nodes.reduce(h,0)),(n!=="left"||o==="outside")&&(c=a+e.at(-1).nodes.reduce(h,0))}return{columnLabelInsetBefore:l,columnLabelInsetAfter:c}}positionNodesInColumnsX(e,t,i){for(let s=0;s<e.length;s++){const n=e[s];n.x=i+s*t;for(const o of n.nodes)o.datum.x=n.x}}createGhostNodesAndColumnDiffs(e,t){for(const i of e.values()){i.weight=0;let s=1/0;for(const n of i.linksAfter){const o=n.node;s=Math.min(s,o.columnIndex-i.columnIndex)}if(s===1/0)for(const n of i.linksBefore){const o=n.node;s=Math.min(s,i.columnIndex-o.columnIndex)}i.closestColumnDiff=s,this.createNodeGhostNodes(i,t,s)}}createNodeGhostNodes(e,t,i){for(const s of e.linksAfter){const n=s.node;if(!(n.columnIndex<=e.columnIndex))for(let o=n.columnIndex-1;o>e.columnIndex;o--){const a=s.link.size,r={ghost:!0,datum:{...e.datum,size:a,y:0,height:0},weight:0,linksBefore:[{node:{columnIndex:o-1,datum:{size:a}}}],linksAfter:[{node:{columnIndex:o+1,datum:{size:a}}}],link:s.link,columnIndex:e.columnIndex,size:e.datum.size,closestColumnDiff:i,fromNode:{y:n.datum.y},toNode:{y:0}};t[o].size+=a,t[o].nodes.push(r)}}}weightNodes(e){const{properties:t}=this;if(t.node.sort==="data")return;if(t.node.sort!=="auto"){for(const n of e)n.nodes.sort((o,a)=>this.sortNodes(o,a));return}const i=e.toSorted((n,o)=>{const a=n.nodes.reduce((l,c)=>Math.max(l,c.datum.size),0);return o.nodes.reduce((l,c)=>Math.max(l,c.datum.size),0)-a}),s={};for(let n=0;n<i.length;n++)s[i[n].index]=Math.pow(10,i.length-n-1);for(const n of e){for(const o of n.nodes){if("ghost"in o&&o.ghost){o.weight=o.size/n.size*s[n.index];continue}o.weight=o.datum.size/n.size*s[n.index]}n.nodes.sort((o,a)=>o.weight-a.weight)}for(const n of e){for(const o of n.nodes)"ghost"in o&&o.ghost||(o.weight+=o.linksBefore.reduce((a,r)=>{if(r.node.columnIndex!==n.index-1)return a;const l=e[r.node.columnIndex].nodes.indexOf(r.node)*s[r.node.columnIndex];return Math.max(a,l)},0),o.weight+=o.linksAfter.reduce((a,r)=>{if(r.node.columnIndex!==n.index+1)return a;const l=e[r.node.columnIndex].nodes.indexOf(r.node)*s[r.node.columnIndex];return Math.max(a,l)},0));n.nodes.sort((o,a)=>this.sortNodes(o,a))}}getScaleAndSpacing(e,t){const i=this._nodeDataDependencies?.seriesRectHeight??0,s=a=>e.reduce((r,{size:l,nodes:c})=>{const h=i-c.length*t,u=(1-(c.length-1)*a/h)/l;return Math.min(r,u)},1/0);let n=this.properties.node.spacing,o=s(n);for(;o<0&&n>this.properties.node.minSpacing;)n-=1,o=s(n);return{nodeSpacing:n,sizeScale:o}}positionNodesInColumnsY(e,t,i,s){const n=this._nodeDataDependencies?.seriesRectHeight??0;for(const o of e){let a=0;for(const c of o.nodes){const h=n*c.datum.size*i;c.datum.height=Math.max(t,h),a+=h}const r=s*(o.nodes.length-1);let l=0;this.properties.node.verticalAlignment==="bottom"?l=n-a-r:this.properties.node.verticalAlignment==="center"&&(l=(n-a-r)/2);for(const c of o.nodes)c.datum.y=l,l+=n*c.datum.size*i+s,"ghost"in c&&c.ghost&&c.link.elbows.push({x:o.x,y:c.datum.y})}}sortAndPositionLinks(e,t){const i=this._nodeDataDependencies?.seriesRectHeight??0;for(const{datum:s,linksBefore:n,linksAfter:o}of e.values()){let a=s.y;n.sort((l,c)=>this.sortNodes(l.node,c.node));for(const{link:l}of n)l.y2=a,a+=l.size*i*t;let r=s.y;o.sort((l,c)=>this.sortNodes(l.node,c.node,{invertColumnSort:!0}));for(const{link:l}of o)l.y1=r,r+=l.size*i*t}}createNodesNodeData(e,t,i,s,n,o){for(const[a,r]of i.entries()){const l=a===0,c=a===i.length-1;let h=-1/0;r.nodes.sort((d,u)=>d.datum.y-u.datum.y);for(const d of r.nodes){if("ghost"in d&&d.ghost)continue;const{datum:u}=d;u.midPoint={x:u.x+u.width/2,y:u.y+u.height/2},e.push(u),h=this.createNodeLabelData(t,s,n,o,u,l,c,h)}}}createNodeLabelData(e,t,i,s,n,o,a,r){if(n.label==null)return r;const{label:{spacing:l,edgePlacement:c,fontSize:h}}=this.properties,d=this._nodeDataDependencies?.seriesRectWidth??0,u=n.y+n.height/2;let p;if(!o&&!a){const S=Mn(h),M=u-S,D=u+S;let k=d;for(const{datum:A}of e.values())A.x>n.x&&Math.max(A.y,M)<=Math.min(A.y+A.height,D)&&(k=Math.min(k,A.x-l));const I=k-n.x-2*l;p=xa(n.label,{maxWidth:I,maxHeight:n.height,font:this.properties.label,textWrap:"never",overflow:"hide"})}if(p==null||p===""){const S=c==null&&(o||a)?l:l*2;p=xa(n.label,{maxWidth:t-S,maxHeight:n.height,font:this.properties.label,textWrap:"never"})}if(p==="")return r;const{height:f}=i.measureLines(p),y=u-f/2,b=u+f/2,{x,textAlign:v}=this.getNodeLabelPlacement(n,o,a);return y>=r&&(s.push({x,y:u,textAlign:v,text:p,size:n.size,nodeDatum:n,datumIndex:n.datumIndex}),r=b),r}getNodeLabelPlacement(e,t,i){const{label:{spacing:s,placement:n,edgePlacement:o}}=this.properties;let a=e.x+e.width+s,r="left",l=n;return t&&o==null&&n==null&&(l="left"),o==="outside"?(t&&(l="left"),i&&(l="right")):o==="inside"&&(t&&(l="right"),i&&(l="left")),l==="left"?(a=e.x-s,r="right"):l==="center"&&(a=e.x+e.width/2,r="center"),{x:a,textAlign:r}}createLinksNodeData(e,t,i,s){const n=this._nodeDataDependencies?.seriesRectHeight??0,o=this.properties.node.width;for(const a of t){const{fromNode:r,toNode:l,size:c}=a;a.height=Math.max(i,n*c*s),a.x1=r.x+o,a.x2=l.x,a.midPoint={x:(a.x1+a.x2)/2,y:(a.y1+a.y2)/2+a.height/2},e.push(a)}}sortNodes(e,t,i){const{properties:s}=this;return s.node.sort==="ascending"?(e.datum.label??"").localeCompare(t.datum.label??""):s.node.sort==="descending"?(t.datum.label??"").localeCompare(e.datum.label??""):s.node.sort==="data"?0:e.columnIndex<t.columnIndex?i?.invertColumnSort?1:-1:e.columnIndex>t.columnIndex?i?.invertColumnSort?-1:1:e.weight===t.weight?e.datum.size-t.datum.size:e.closestColumnDiff<t.closestColumnDiff?1:e.closestColumnDiff>t.closestColumnDiff?-1:e.weight-t.weight}updateLabelSelection(e){const t=this.isLabelEnabled()?e.labelData:[];return e.labelSelection.update(t)}updateLabelNodes(e){const t=this.getHighlightedDatum();e.labelSelection.each((i,s)=>{const{x:n,y:o,textAlign:a,text:r,datumIndex:l,nodeDatum:c}=s,h=s,d=this.isLabelHighlighted(c,t),u=this.getHighlightStyle(d,l),p=f5(this,void 0,h,this.properties.label,d,t),{color:f,fontStyle:y,fontWeight:b,fontSize:x,fontFamily:v}=p;i.visible=!0,i.x=n,i.y=o,i.text=r,i.fill=f,i.fontStyle=y,i.fontWeight=b,i.fontSize=x,i.fontFamily=v,i.textAlign=a,i.textBaseline="middle";const S=u.opacity??1;i.opacity=S,i.fillOpacity=S,i.setBoxing(p)})}updateNodeSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>bb(t.type,t.id))}getNodeStyle(e,t,i){const{properties:s}=this,{fills:n,strokes:o,defaultColorRange:a,defaultPatternFills:r,fillGradientDefaults:l,fillPatternDefaults:c,fillImageDefaults:h}=s,{itemStyler:d}=s.node,u=a[t%a.length].map(v=>({color:v})),p=r[t%r.length],f=this.getHighlightStyle(i,e.datumIndex),y=oe(f,s.getStyle(!1,n,o,t)),b=s.node.fill!=null;let x=bE(y,b?l:{...l.toJson(),colorStops:u},b?c:{...c.toJson(),fill:p,stroke:p},h);if(d!=null&&e.datumIndex!=null){const v=this.cachedDatumCallback(bb(e.datumIndex.index,"node",i?"highlight":"node"),()=>{const S=this.makeItemStylerParams(e,i,x);return this.callWithContext(d,S)});v&&(x=oe(v,x,{...l.toJson(),colorStops:u},{...c.toJson(),fill:p,stroke:p},h))}return x.opacity=1,x}makeItemStylerParams({datum:e,datumIndex:t,size:i=0,label:s},n,o){const{id:a}=this,r=this.ctx.highlightManager?.getActiveHighlight(),l=this.getHighlightStateString(r,n,t),c=this.filterItemStylerFillParams(o.fill)??o.fill;return{seriesId:a,datum:e,highlightState:l,...o,size:i,label:s,fill:c}}updateNodeNodes(e){const{datumSelection:t,isHighlight:i}=e,s=this.getShapeFillBBox();t.each((n,o)=>{const{datumIndex:a}=o,r=this.getNodeStyle(o,a.index,i);n.x=o.x,n.y=o.y,n.width=Math.max(o.width,0),n.height=Math.max(o.height,0),n.setStyleProperties(r,s)})}getShapeFillBBox(){const e=this._nodeDataDependencies?.seriesRectWidth??0,t=this._nodeDataDependencies?.seriesRectHeight??0,i=new SE(0,0,e,t);return{series:i,axis:i}}updateLinkSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>bb(t.type,t.index,t.fromNode.id,t.toNode.id))}getLinkStyle({datumIndex:e,datum:t},i,s){const{id:n,properties:o}=this,{fills:a,strokes:r,defaultColorRange:l,defaultPatternFills:c,fillGradientDefaults:h,fillPatternDefaults:d,fillImageDefaults:u}=o,{itemStyler:p}=o.link,f=l[i.index%l.length].map(M=>({color:M})),y=c[i.index%c.length],b=this.getHighlightStyle(s,e),x=oe(b,o.getStyle(!0,a,r,i.index)),v=o.link.fill!=null;let S=bE(x,v?h:{...h.toJson(),colorStops:f},v?d:{...d.toJson(),fill:y,stroke:y},u);if(p!=null&&e!=null){const M=this.cachedDatumCallback(bb(e.index,"link",s?"highlight":"node"),()=>{const D=this.ctx.highlightManager?.getActiveHighlight(),k=this.getHighlightStateString(D,s,e);return this.callWithContext(p,{seriesId:n,datum:t,highlightState:k,...S})});M&&(S=oe(M,S,{...h.toJson(),colorStops:f},{...d.toJson(),fill:y,stroke:y},u))}return S.opacity=1,S}updateLinkNodes(e){const{datumSelection:t,isHighlight:i}=e,s=this.getShapeFillBBox();t.each((n,o)=>{const a=o.fromNode.datumIndex,r=this.getLinkStyle(o,a,i);n.x1=o.x1,n.y1=o.y1,n.x2=o.x2,n.y2=o.y2,n.height=o.height,n.elbows=o.elbows,n.setStyleProperties(r,s),n.inset=n.strokeWidth/2})}getTooltipContent(e){const{id:t,linksProcessedData:i,nodesProcessedData:s,properties:n,ctx:{formatManager:o}}=this,{fromKey:a,toKey:r,sizeKey:l,sizeName:c,tooltip:h}=n,d=this.contextNodeData?.nodeData.find(v=>v.datumIndex.type===e.type&&v.datumIndex.index===e.index);if(d==null)return;const u=d.type===0?d.fromNode.index:d.index,p=d.type===0?`${d.fromNode.label} - ${d.toNode.label}`:d.label,f=e.type===0?i?.dataSources.get(this.id)?.data[e.index]:s?.dataSources.get(this.id)?.data[e.index],y=d.size;let b;if(d.type===0){const v=d.fromNode.datumIndex;b=this.getLinkStyle({datumIndex:e,datum:f},v,!1)}else b=this.getNodeStyle({datumIndex:e,datum:f},e.index,!1);const x=[];if(l!=null){const v=o.format(this.callWithContext.bind(this),{type:"number",value:y,datum:f,seriesId:t,legendItemName:void 0,key:l,source:"tooltip",property:"size",domain:[],boundSeries:this.getFormatterContext("size"),fractionDigits:void 0});x.push({label:c,fallbackLabel:l,value:v??String(y)})}return this.formatTooltipWithContext(h,{title:p,symbol:this.legendItemSymbol(d.type,u,b),data:x},{seriesId:t,datum:f,title:p,fromKey:a,toKey:r,sizeKey:l,sizeName:c,size:y,...b})}computeFocusBounds(e){if(e instanceof vE){const{x:t,y:i,width:s,height:n}=e,o=new SE(t,i,s,n);return g5.toCanvas(this.contentGroup,o)}return e}hasItemStylers(){return this.properties.node.itemStyler!=null||this.properties.link.itemStyler!=null||this.properties.label.itemStyler!=null}};ck.className="SankeySeries",ck.type="sankey";var{sankeySeriesThemeableOptionsDef:m5}=L,$u={...m5,...et,type:$(Le("sankey")),fromKey:$(N),toKey:$(N),sizeKey:N,sizeName:N};$u.fillGradientDefaults=ee(zp),$u.fillPatternDefaults=ee(Bp),$u.fillImageDefaults=ee(_p),$u.defaultColorRange=ee(be(be(ie))),$u.defaultPatternFills=ee(be(ie));var ME={type:"series",name:"sankey",chartType:"standalone",enterprise:!0,solo:!0,version:ue,dependencies:[Wu],options:$u,themeTemplate:{seriesArea:{padding:{top:10,bottom:10}},series:{fills:{$palette:"fills"},strokes:{$palette:"strokes"},fillGradientDefaults:L.FILL_GRADIENT_LINEAR_DEFAULTS,fillPatternDefaults:L.FILL_PATTERN_DEFAULTS,fillImageDefaults:L.FILL_IMAGE_DEFAULTS,defaultColorRange:{$palette:"gradients"},defaultPatternFills:L.SAFE_FILLS_OPERATION,highlight:{unhighlightedItem:{opacity:.5}},label:{...L.LABEL_BOXING_DEFAULTS,enabled:!0,fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:10},node:{spacing:{$if:[{$greaterThan:[{$path:"./minSpacing"},20]},{$path:"./minSpacing"},20]},minSpacing:0,width:10,strokeWidth:{$isUserOption:["./stroke",2,0]}},link:{fillOpacity:.5,strokeWidth:{$isUserOption:["./stroke",2,0]}}},legend:{enabled:!1,toggleSeries:!1}},create:e=>new ck(e)};function y5(e,t){const{fontSize:i,minimumFontSize:s=i}=e,{fontSize:n,minimumFontSize:o=n}=t,a=i-s,r=n-o;let l=e.fontSize,c=t.fontSize;const h=[{labelFontSize:i,secondaryLabelFontSize:n}];for(;l>s||c>o;){const d=a>0?(l-s)/a:-1,u=r>0?(c-o)/r:-1;d>u?l--:c--,h.push({labelFontSize:l,secondaryLabelFontSize:c})}return h.reverse(),h}function DE(e,t,i,s,{padding:n},o){const{spacing:a=0}=t,r=2*n,l=2*n+a,c=(t.minimumFontSize??t.fontSize)+(s.minimumFontSize??s.fontSize);if(c>o(c+l,!1).height-l)return;const h=y5(t,s),d={fontFamily:t.fontFamily,fontStyle:t.fontStyle,fontWeight:t.fontWeight},u={fontFamily:s.fontFamily,fontStyle:s.fontStyle,fontWeight:s.fontWeight};let p,f;return ny(0,h.length-1,y=>{const{labelFontSize:b,secondaryLabelFontSize:x}=h[y],v=y===0,S={...d,fontSize:b},M={...u,fontSize:x},D=Ze(S).lineHeight(),k=Ze(M).lineHeight(),I=o(D+k+l,v),A=I.width-r,C=I.height-l;if(D+k>C||((p==null||p.fontSize!==b)&&(p=kE(t,e,A,C,S,t.wrapping,v?t.overflowStrategy:"hide")),p==null||p.width>A||p.height>C)||((f==null||f.fontSize!==x)&&(f=kE(s,i,A,C,M,s.wrapping,v?s.overflowStrategy:"hide")),f==null))return;const w=p.height+f.height;if(!(f.width>A||w>C))return{width:Math.max(p.width,f.width),height:w+a,meta:I.meta,label:p,secondaryLabel:f}})}function bf(e,t,{padding:i},s){const n=2*i,o=Math.min(t.minimumFontSize??t.fontSize,t.fontSize),a={fontFamily:t.fontFamily,fontStyle:t.fontStyle,fontWeight:t.fontWeight};return ny(o,t.fontSize,r=>{const l={...a,fontSize:r},c=Ze(l),h=r===o,d=t.lineHeight??c.lineHeight(),u=s(d+n,h),p=u.width-n,f=u.height-n;if(d>f||p<0)return;const y=Fd(e,{maxWidth:p,maxHeight:f,font:l,textWrap:t.wrapping,overflow:(h?t.overflowStrategy:null)??"hide"});if(!y.length)return;const{width:b,height:x}=c.measureLines(y),v=y.join(`
`);return[{width:b,height:x,text:v,fontSize:r,lineHeight:d},u.meta]})}function IE(e){return e?.minimumFontSize!=null&&e?.fontSize!=null&&e?.minimumFontSize>e?.fontSize}function hk(e,t,i,s,n,o){const a=t.enabled?e:void 0,r=s.enabled?i:void 0;(IE(t)||IE(s))&&j.warnOnce("minimumFontSize should be set to a value less than or equal to the font size");let l;a!=null&&r!=null&&(l=DE(a,t,r,s,n,o));let c;if(l==null&&a!=null&&(c=bf(a,t,n,o)),c!=null){const[d,u]=c;l={width:d.width,height:d.height,meta:u,label:d,secondaryLabel:void 0}}let h;if(l==null&&a==null&&r!=null&&(h=bf(r,s,n,o)),h!=null){const[d,u]=h;l={width:d.width,height:d.height,meta:u,label:void 0,secondaryLabel:d}}return l}function kE(e,t,i,s,n,o,a){const r=Fd(t,{maxWidth:i,maxHeight:s,font:n,textWrap:o,overflow:a});if(!r.length)return;const l=Ze(n),c=e.lineHeight??l.lineHeight(),{width:h}=l.measureLines(r);return{width:h,lineHeight:c,text:r.join(`
`),height:r.length*c,fontSize:n.fontSize}}var Uu=class extends L.Label{constructor(){super(...arguments),this.wrapping="on-space",this.overflowStrategy="ellipsis"}};g([m],Uu.prototype,"wrapping",2),g([m],Uu.prototype,"overflowStrategy",2),g([m],Uu.prototype,"lineHeight",2),g([m],Uu.prototype,"minimumFontSize",2);var Ku=class extends Uu{constructor(){super(...arguments),this.spacing=0}};g([m],Ku.prototype,"spacing",2);var vb=class extends Uu{},{HierarchySeriesProperties:x5,makeSeriesTooltip:b5,HighlightProperties:v5}=L,Zl=class extends K{};g([m],Zl.prototype,"fill",2),g([m],Zl.prototype,"fillOpacity",2),g([m],Zl.prototype,"stroke",2),g([m],Zl.prototype,"strokeWidth",2),g([m],Zl.prototype,"strokeOpacity",2),g([m],Zl.prototype,"opacity",2);var dk=class extends v5{constructor(){super(...arguments),this.highlightedBranch=new Zl,this.unhighlightedBranch=new Zl}};g([m],dk.prototype,"highlightedBranch",2),g([m],dk.prototype,"unhighlightedBranch",2);var Qs=class extends x5{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=0,this.strokeOpacity=1,this.cornerRadius=0,this.highlight=new dk,this.label=new Ku,this.secondaryLabel=new vb,this.tooltip=b5()}getStyle(e){const{fills:t,strokes:i,fillOpacity:s,strokeWidth:n,strokeOpacity:o}=this;return{fill:t[e%t.length],fillOpacity:s,stroke:i[e%i.length],strokeWidth:n,strokeOpacity:o,opacity:1}}};g([m],Qs.prototype,"sizeName",2),g([m],Qs.prototype,"labelKey",2),g([m],Qs.prototype,"secondaryLabelKey",2),g([m],Qs.prototype,"fillOpacity",2),g([m],Qs.prototype,"strokeWidth",2),g([m],Qs.prototype,"strokeOpacity",2),g([m],Qs.prototype,"cornerRadius",2),g([m],Qs.prototype,"sectorSpacing",2),g([m],Qs.prototype,"padding",2),g([m],Qs.prototype,"itemStyler",2),g([m],Qs.prototype,"highlight",2),g([m],Qs.prototype,"label",2),g([m],Qs.prototype,"secondaryLabel",2),g([m],Qs.prototype,"tooltip",2);var{fromToMotion:S5,createDatumId:M5,PointerEvents:D5,Sector:AE,Group:Sb,ScalableGroup:I5,Selection:uk,TransformableText:pk,BBox:CE,getLabelStyles:k5,toHierarchyHighlightString:A5}=L,C5=class extends L.HierarchyNode{constructor(){super(...arguments),this.label=void 0,this.secondaryLabel=void 0,this.contentHeight=0,this.bbox=void 0,this.startAngle=0,this.endAngle=0}};function LE(e,t=0,i=2*Math.PI/e.sumSize){for(const s of e.children){const n=t+s.sumSize*i;s.startAngle=t,s.endAngle=n,LE(s,t,i),t=n}}var gk=class extends L.HierarchySeries{constructor(e){super(e),this.NodeClass=C5,this.properties=new Qs,this.scalingGroup=this.contentGroup.appendChild(new I5),this.sectorGroup=this.scalingGroup.appendChild(new Sb),this.highlightSectorGroup=this.scalingGroup.appendChild(new Sb),this.sectorLabelGroup=this.scalingGroup.appendChild(new Sb),this.datumSelection=uk.select(this.sectorGroup,AE),this.labelSelection=uk.select(this.sectorLabelGroup,Sb),this.highlightSelection=uk.select(this.highlightSectorGroup,AE),this.sectorLabelGroup.pointerEvents=D5.None}processData(){super.processData(),LE(this.rootNode)}updateSelections(){const e=this.getActiveHighlightNode();if(this.highlightSelection.update(e==null?[]:[e],void 0,o=>this.getDatumId(o)),!this.nodeDataRefresh)return;this.nodeDataRefresh=!1;const{chart:t}=this;if(t==null||t.seriesRect==null)return;const s=Array.from(this.rootNode),n=o=>{o.append([new pk({tag:0}),new pk({tag:1})])};this.datumSelection.update(s,void 0,o=>this.getDatumId(o)),this.labelSelection.update(s,n,o=>this.getDatumId(o))}getItemStyle(e,t){const{properties:i,colorScale:s}=this,{itemStyler:n}=i,o=e.datumIndex?.[0]??0,a=this.getActiveHighlightNode(),r=this.getHierarchyHighlightState(t,a,e),l=this.getHierarchyHighlightStyles(r,this.properties.highlight),c=oe(l,i.getStyle(o));e.colorValue!=null&&l?.fill==null&&(c.fill=s.convert(e.colorValue));let h=c;if(n!=null&&e!=null){const d=this.cachedDatumCallback(M5(this.getDatumId(e),t?"highlight":"node"),()=>{const u=this.makeItemStylerParams(e,h,A5(r));return this.callWithContext(n,u)});d&&(h=oe(d,h))}return h}makeItemStylerParams(e,t,i){const{id:s}=this,n=this.filterItemStylerFillParams(t.fill)??t.fill;return{seriesId:s,datum:e.datum,depth:e.depth??0,highlightState:i,...t,fill:n}}updateNodes(){const{chart:e,data:t,maxDepth:i}=this;if(e==null||t==null)return;const{width:s,height:n}=e.seriesRect,{sectorSpacing:o=0,padding:a=0,cornerRadius:r,childrenKey:l,colorKey:c,colorName:h,labelKey:d,secondaryLabelKey:u,sizeKey:p,sizeName:f}=this.properties;this.contentGroup.translationX=s/2,this.contentGroup.translationY=n/2;const y=o*.5,b=Math.min(s,n)/2,x=b/(i+1),v=-Math.PI/2,S={series:new CE(-b,-b,2*b,2*b),axis:new CE(-b,-b,2*b,2*b)};this.rootNode?.walk(A=>{const{startAngle:C,endAngle:w}=A;if(A.depth!=null){const T=(C+w)/2+v,O=(A.depth+.5)*x;A.midPoint.x=Math.cos(T)*O,A.midPoint.y=Math.sin(T)*O}}),this.rootNode?.walk(A=>{const{datum:C,depth:w,startAngle:T,endAngle:O,parent:E,sumSize:z}=A;A.label=void 0,A.secondaryLabel=void 0,A.contentHeight=0;let F;if(C!=null&&w!=null&&d!=null){const We=C[d];F=this.getLabelText(We,C,d,"label",[],this.properties.label,{depth:w,datum:C,childrenKey:l,colorKey:c,colorName:h,labelKey:d,secondaryLabelKey:u,sizeKey:p,sizeName:f,value:We})}F===""&&(F=void 0);let _;if(C!=null&&w!=null&&u!=null){const We=C[u];_=this.getLabelText(We,C,u,"secondaryLabel",[],this.properties.secondaryLabel,{depth:w,datum:C,childrenKey:l,colorKey:c,colorName:h,labelKey:d,secondaryLabelKey:u,sizeKey:p,sizeName:f,value:We})}if(_===""&&(_=void 0),w==null)return;const G=w*x+y,B=(w+1)*x-y,V=G>y?y/G:y,Y=B>y?y/B:y,X=T+V,te=O+V-X,pe=T+Y,ve=O+Y-pe,ae=We=>{if(w===0&&E?.sumSize===z)return{width:2*Math.sqrt(B**2-(We*.5)**2),height:We,meta:0};const wt=We,vt=2*Math.sqrt(B**2-(G+wt)**2),Ds=te<Math.PI?2*G*Math.tan(te*.5):1/0,Zn=Math.min(vt,Ds),oa=Math.PI/4;let yn,Xn;return w===0?(yn=We,Xn=Math.sqrt(B**2-(yn/2)**2)-We/(2*Math.tan(ve*.5))):tt(te)<oa?(yn=2*G*Math.tan(te*.5),Xn=Math.sqrt(B**2-(yn/2)**2)-G):(Xn=0,yn=0),Zn>=Xn?{width:Zn,height:wt,meta:1}:{width:Xn,height:yn,meta:2}},Ie=hk(Pe(F),this.properties.label,Pe(_),this.properties.secondaryLabel,{padding:a},ae);if(Ie==null)return;const{width:ze,height:Xe,meta:Te,label:de,secondaryLabel:De}=Ie,ye=v+(T+O)/2,Ee=Math.sin(ye)>=0,Ne=Math.cos(ye)>=0,xt=(Ee?3:12)&(Ne?6:9);let nt;switch(Te){case 0:nt=0;break;case 1:{const rt=B-(x-Xe)*.58,wt=Math.sqrt((B-a)**2-(ze/2)**2);nt=Math.min(rt,wt);break}case 2:if(w===0){const We=Xe/(2*Math.tan(te*.5))+ze*.5,rt=Math.sqrt(B**2-(Xe*.5)**2)-ze*.5;nt=(We+rt)*.5}else nt=(G+B)*.5;break}if(de!=null){const{fontStyle:We="normal",fontFamily:rt,fontWeight:wt="normal",color:vt="black"}=this.properties.label;A.label={...de,fontStyle:We,fontFamily:rt,fontWeight:wt,color:vt,labelPlacement:Te,circleQuarter:xt,radius:nt,theta:ye}}if(De!=null){const{fontStyle:We="normal",fontFamily:rt,fontWeight:wt="normal",color:vt="black"}=this.properties.secondaryLabel;A.secondaryLabel={...De,fontStyle:We,fontFamily:rt,fontWeight:wt,color:vt,labelPlacement:Te,circleQuarter:xt,radius:nt,theta:ye}}A.contentHeight=Ie.height});const M=(A,C,w)=>{const{depth:T,startAngle:O,endAngle:E}=A;if(T==null){C.visible=!1;return}C.visible=!0;const z=this.getItemStyle(A,w),F=z.fill,_=z.strokeWidth,G=Ut(F)&&F.bounds!=="item"?S:void 0;C.setStyleProperties(z,G),C.centerX=0,C.centerY=0,C.innerRadius=T*x,C.outerRadius=(T+1)*x,C.startAngle=O+v,C.endAngle=E+v,C.inset=y+_*.5,C.cornerRadius=r};this.datumSelection.each((A,C)=>{M(C,A,!1)}),this.highlightSelection.each((A,C)=>{M(C,A,!0)});const D=this.getActiveHighlightNode(),k=(A,C,w,T)=>{const{depth:O,contentHeight:E}=A,z=w===0,F=z?A.label:A.secondaryLabel;if(O==null||F==null){C.visible=!1;return}const{labelPlacement:_,circleQuarter:G,radius:B,theta:V}=F,Y=this.getHierarchyHighlightState(T,D,A),{opacity:X}=this.getHierarchyHighlightStyles(Y,this.properties.highlight)??{},q={childrenKey:this.properties.childrenKey,colorKey:this.properties.colorKey,colorName:this.properties.colorName??this.properties.colorKey,depth:A.depth??Number.NaN,labelKey:this.properties.labelKey,secondaryLabelKey:this.properties.secondaryLabelKey,sizeKey:this.properties.sizeKey,sizeName:this.properties.sizeName??this.properties.sizeKey},te=z?this.properties.label:this.properties.secondaryLabel,pe=this.ctx.highlightManager?.getActiveHighlight(),Se=k5(this,A,q,te,T,pe);switch(C.text=F.text,C.fontSize=F.fontSize,C.lineHeight=F.lineHeight,C.fontStyle=F.fontStyle,C.fontFamily=F.fontFamily,C.fontWeight=F.fontWeight,C.fillOpacity=X??1,C.fill=Se.color,C.setBoxing(Se),_){case 0:C.textAlign="center",C.textBaseline="top",C.translationX=0,C.translationY=(z?0:E-F.height)-E*.5,C.rotation=0;break;case 1:{const ve=(G&3)!==0,ae=z===!ve?B:B-(E-F.height);C.textAlign="center",C.textBaseline=ve?"bottom":"top",C.translationX=Math.cos(V)*ae,C.translationY=Math.sin(V)*ae,C.rotation=ve?V-Math.PI*.5:V+Math.PI*.5;break}case 2:{const ve=(G&6)!==0,ae=z===!ve?(E-F.height)*.5:(F.height-E)*.5;C.textAlign="center",C.textBaseline="middle",C.translationX=Math.cos(V)*B+Math.cos(V+Math.PI/2)*ae,C.translationY=Math.sin(V)*B+Math.sin(V+Math.PI/2)*ae,C.rotation=ve?V:V+Math.PI;break}}C.visible=!0},I=this.getActiveHighlightNode();for(const A of this.labelSelection.selectByClass(pk)){const C=A.closestDatum();k(C,A,A.tag,C===I)}}getTooltipContent(e){const{id:t,properties:i,ctx:s}=this,{labelKey:n,secondaryLabelKey:o,childrenKey:a,sizeKey:r,sizeName:l,colorKey:c,colorName:h,tooltip:d}=i,{formatManager:u}=s,p=e.reduce((k,I)=>k?.children[I],this.rootNode);if(p==null)return;const{datum:f,depth:y}=p;if(f==null||y==null)return;const b=[],x=r==null?void 0:f[r];if(x!=null){const k=[0,this.rootNode?.sumSize??0],I=u.format(this.callWithContext.bind(this),{type:"number",value:x,datum:f,seriesId:t,legendItemName:void 0,key:r,source:"tooltip",property:"size",boundSeries:this.getFormatterContext("size"),domain:k,fractionDigits:void 0});b.push({label:l,fallbackLabel:r,value:I??ao(x)})}const v=c==null?void 0:f[c];if(v!=null){const{colorDomain:k}=this,I=u.format(this.callWithContext.bind(this),{type:"number",value:v,datum:f,seriesId:t,legendItemName:void 0,key:c,source:"tooltip",property:"color",boundSeries:this.getFormatterContext("color"),domain:k,fractionDigits:void 0});b.push({label:h,fallbackLabel:c,value:I??ao(v)})}const S=this.getItemStyle({...p,colorValue:v??p.colorValue},!1),D={shape:"square",fill:S.fill,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0};return Ut(D.fill)&&(D.fill={...D.fill,gradient:"linear",rotation:0,reverse:!1}),this.formatTooltipWithContext(d,{title:n==null?void 0:f[n],symbol:{marker:D},data:b},{seriesId:t,datum:f,title:void 0,depth:y,labelKey:n,secondaryLabelKey:o,childrenKey:a,sizeKey:r,sizeName:l,colorKey:c,colorName:h,...S})}createNodeData(){}pickNodeClosestDatum(e){return this.pickNodeNearestDistantObject(e,this.datumSelection.nodes())}animateEmptyUpdateReady(){S5(this.id,"nodes",this.ctx.animationManager,[this.scalingGroup],{toFn(){return{scalingX:1,scalingY:1}},fromFn(){return{scalingX:0,scalingY:0}}})}computeFocusBounds(e){return e}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.label.itemStyler!=null}};gk.className="SunburstSeries",gk.type="sunburst";var{sunburstSeriesThemeableOptionsDef:L5}=L,w5={...L5,...Q(et,["highlightStyle","highlight","showInLegend"]),type:$(Le("sunburst")),labelKey:N,secondaryLabelKey:N,childrenKey:N,sizeKey:N,colorKey:N,sizeName:N,colorName:N},T5={series:{fills:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$palette:"fills"},{$applySwitch:[{$path:["/type",void 0,{$value:"$1"}]},{$value:"$1"},["gradient",L.FILL_GRADIENT_RADIAL_REVERSED_SERIES_DEFAULTS],["pattern",L.FILL_PATTERN_DEFAULTS],["image",L.FILL_IMAGE_DEFAULTS]]}]},strokes:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$palette:"strokes"}]},colorRange:{$palette:"divergingColors"},strokeWidth:{$isUserOption:["./strokes/0",2,0]},label:{...L.LABEL_BOXING_DEFAULTS,enabled:!0,fontFamily:{$ref:"fontFamily"},fontSize:{$rem:Si.LARGE},minimumFontSize:{$rem:9/Oo},fontWeight:{$ref:"fontWeight"},color:{$ref:"chartBackgroundColor"},overflowStrategy:"ellipsis",wrapping:"never",spacing:2},secondaryLabel:{...L.LABEL_BOXING_DEFAULTS,enabled:!0,fontFamily:{$ref:"fontFamily"},fontSize:{$rem:Si.SMALLEST},minimumFontSize:{$rem:7/Oo},fontWeight:{$ref:"fontWeight"},color:{$ref:"chartBackgroundColor"},overflowStrategy:"ellipsis",wrapping:"never"},sectorSpacing:2,padding:3,highlight:{unhighlightedItem:{fillOpacity:.6,strokeOpacity:.6},unhighlightedBranch:{fillOpacity:.2,strokeOpacity:.2}}},gradientLegend:{enabled:{$if:[{$path:"../series/0/colorKey"},!0,!1]}}},wE={type:"series",name:"sunburst",chartType:"standalone",enterprise:!0,solo:!0,version:ue,dependencies:[Wu],options:w5,themeTemplate:T5,create:e=>new gk(e)},{HierarchySeriesProperties:N5,makeSeriesTooltip:O5,Label:E5}=L,TE=class extends E5{constructor(){super(...arguments),this.spacing=0}};g([m],TE.prototype,"spacing",2);var Xl=class extends K{};g([m],Xl.prototype,"fill",2),g([m],Xl.prototype,"fillOpacity",2),g([m],Xl.prototype,"stroke",2),g([m],Xl.prototype,"strokeWidth",2),g([m],Xl.prototype,"strokeOpacity",2),g([m],Xl.prototype,"opacity",2);var fk=class extends K{constructor(){super(...arguments),this.highlightedItem=new Xl,this.unhighlightedItem=new Xl}};g([m],fk.prototype,"highlightedItem",2),g([m],fk.prototype,"unhighlightedItem",2);var Pa=class extends K{};g([m],Pa.prototype,"fill",2),g([m],Pa.prototype,"fillOpacity",2),g([m],Pa.prototype,"stroke",2),g([m],Pa.prototype,"strokeWidth",2),g([m],Pa.prototype,"strokeOpacity",2),g([m],Pa.prototype,"opacity",2);var vf=class extends K{constructor(){super(...arguments),this.highlightedBranch=new Pa,this.highlightedItem=new Pa,this.unhighlightedItem=new Pa,this.unhighlightedBranch=new Pa}};g([m],vf.prototype,"highlightedBranch",2),g([m],vf.prototype,"highlightedItem",2),g([m],vf.prototype,"unhighlightedItem",2),g([m],vf.prototype,"unhighlightedBranch",2);var Bn=class extends K{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.cornerRadius=0,this.textAlign="center",this.gap=0,this.padding=0,this.interactive=!0,this.label=new TE,this.highlight=new fk}};g([m],Bn.prototype,"fill",2),g([m],Bn.prototype,"fillOpacity",2),g([m],Bn.prototype,"stroke",2),g([m],Bn.prototype,"strokeWidth",2),g([m],Bn.prototype,"strokeOpacity",2),g([m],Bn.prototype,"cornerRadius",2),g([m],Bn.prototype,"textAlign",2),g([m],Bn.prototype,"gap",2),g([m],Bn.prototype,"padding",2),g([m],Bn.prototype,"interactive",2),g([m],Bn.prototype,"label",2),g([m],Bn.prototype,"highlight",2);var dn=class extends K{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.cornerRadius=0,this.textAlign="center",this.verticalAlign="middle",this.gap=0,this.padding=0,this.label=new Ku,this.secondaryLabel=new vb,this.highlight=new vf}};g([m],dn.prototype,"fill",2),g([m],dn.prototype,"fillOpacity",2),g([m],dn.prototype,"stroke",2),g([m],dn.prototype,"strokeWidth",2),g([m],dn.prototype,"strokeOpacity",2),g([m],dn.prototype,"cornerRadius",2),g([m],dn.prototype,"textAlign",2),g([m],dn.prototype,"verticalAlign",2),g([m],dn.prototype,"gap",2),g([m],dn.prototype,"padding",2),g([m],dn.prototype,"label",2),g([m],dn.prototype,"secondaryLabel",2),g([m],dn.prototype,"highlight",2);var Ra=class extends N5{constructor(){super(...arguments),this.tooltip=O5(),this.group=new Bn,this.tile=new dn,this.undocumentedGroupFills=[],this.undocumentedGroupStrokes=[]}getStyle(e,t,i,s){const{fillOpacity:n,strokeWidth:o,strokeOpacity:a,fill:r=e?t[s%t.length]:t[Math.min(s,t.length)],stroke:l=e?i[s%t.length]:i[Math.min(s,i.length)]}=e?this.tile:this.group;return{fill:r,fillOpacity:n,stroke:l,strokeWidth:o,strokeOpacity:a,opacity:1}}};g([m],Ra.prototype,"sizeName",2),g([m],Ra.prototype,"labelKey",2),g([m],Ra.prototype,"secondaryLabelKey",2),g([m],Ra.prototype,"itemStyler",2),g([m],Ra.prototype,"tooltip",2),g([m],Ra.prototype,"group",2),g([m],Ra.prototype,"tile",2),g([m],Ra.prototype,"undocumentedGroupFills",2),g([m],Ra.prototype,"undocumentedGroupStrokes",2);var{createDatumId:P5,Rect:NE,Group:OE,BBox:Yu,Selection:mk,Text:yk,Transformable:R5,getLabelStyles:F5,HierarchyHighlightState:Jo,toHierarchyHighlightString:Sf}=L,z5=class extends L.HierarchyNode{constructor(){super(...arguments),this.labelValue=void 0,this.secondaryLabelValue=void 0,this.label=void 0,this.secondaryLabel=void 0,this.bbox=void 0,this.padding=void 0}};function ql(e){return e.children.length>0?e.sumSize-e.sizeValue:e.sizeValue}var EE={left:0,center:.5,right:1},B5={top:0,middle:.5,bottom:1},ase=class extends L.Group{distanceSquared(e,t){return this.getBBox().distanceSquared(e,t)}},xk=class extends L.HierarchySeries{constructor(){super(...arguments),this.NodeClass=z5,this.properties=new Ra,this.rectGroup=this.contentGroup.appendChild(new OE),this.datumSelection=mk.select(this.rectGroup,NE),this.labelSelection=mk.select(this.labelGroup,OE),this.highlightSelection=mk.select(this.rectGroup,NE)}groupTitleHeight(e,t){const{labelValue:i}=e,{label:s}=this.properties.group,n=3;if(i!=null){if(s.fontSize>t.width/n||s.fontSize>t.height/n)return;{const{height:o}=Ze(s).measureLines(i);return Math.max(o,s.fontSize)}}}getNodePadding(e,t){if(e.parent==null)return{top:0,right:0,bottom:0,left:0};if(e.children.length===0){const{padding:a}=this.properties.tile;return{top:a,right:a,bottom:a,left:a}}const{label:{spacing:i},padding:s}=this.properties.group,n=this.groupTitleHeight(e,t),o=n==null?0:n+i;return{top:s+o,right:s,bottom:s,left:s}}sortChildren({children:e}){const t=Array.from(e,(s,n)=>n).filter(s=>ql(e[s])>0).sort((s,n)=>ql(e[n])-ql(e[s]));return{sortedChildrenIndices:t,childAt:s=>{const n=t[s];return e[n]}}}squarify(e,t){const{datum:i,children:s}=e;if(t.width<=0||t.height<=0){e.bbox=void 0,e.padding=void 0,e.midPoint.x=Number.NaN,e.midPoint.y=Number.NaN;return}const n=i==null?{top:0,right:0,bottom:0,left:0}:this.getNodePadding(e,t);e.parent==null?(e.bbox=void 0,e.padding=void 0,e.midPoint.x=Number.NaN,e.midPoint.y=Number.NaN):(e.bbox=t,e.padding=n,e.midPoint.x=t.x+t.width/2,e.midPoint.y=t.y);const{sortedChildrenIndices:o,childAt:a}=this.sortChildren(e),r=o.every(D=>s[D].children.length===0),l=1,c=t.width-n.left-n.right,h=t.height-n.top-n.bottom;if(c<=0||h<=0)return;const d=o.length;let u=0,p=0,f=1/0,y=o.reduce((D,k)=>D+ql(s[k]),0);const b=new Yu(t.x+n.left,t.y+n.top,c,h),x=b.clone();let v=0;for(;v<d;){const D=ql(a(v)),k=ql(a(p)),I=x.width<x.height;u+=D;const A=I?x.height:x.width,C=I?x.width:x.height,w=C*k/u;let T=A*u/y;const O=Math.max(w,T)/Math.min(w,T),E=Math.abs(l-O);if(E<f){f=E,v++;continue}u-=D,T=A*u/y;let z=I?x.x:x.y;for(let F=p;F<v;F++){const _=a(F),G=ql(_),B=I?z:x.x,V=I?x.y:z,Y=C*G/u,X=I?Y:T,q=I?T:Y,te=new Yu(B,V,X,q);this.applyGap(b,te,r),this.squarify(_,te),y-=G,z+=Y}I?(x.y+=T,x.height-=T):(x.x+=T,x.width-=T),p=v,u=0,f=1/0}const S=x.width<x.height;let M=S?x.x:x.y;for(let D=p;D<d;D++){const k=a(D),I=S?M:x.x,A=S?x.y:M,C=ql(k)/y,w=x.width*(S?C:1),T=x.height*(S?1:C),O=new Yu(I,A,w,T);this.applyGap(b,O,r),this.squarify(k,O),M+=S?w:T}}applyGap(e,t,i){const s=i?this.properties.tile.gap*.5:this.properties.group.gap*.5,n=l=>({left:l.x,top:l.y,right:l.x+l.width,bottom:l.y+l.height}),o=n(e),a=n(t),r=["top","right","bottom","left"];for(const l of r)qe(o[l],a[l])||t.shrink(s,l)}createNodeData(){}getItemStyle(e,t,i){const{properties:s,colorScale:n}=this,{itemStyler:o}=s,a=e.datumIndex?.[0]??0,r=t?s.fills:s.undocumentedGroupFills,l=t?s.strokes:s.undocumentedGroupStrokes,c=t?a:e.depth??-1,h=this.getActiveHighlightNode(),d=this.getHierarchyHighlightState(i,h,e),u=this.getGroupHighlightState(i,h,e),p=t?d:u,f=t?this.getTileHighlightStyle(d,u,h):this.getGroupHighlightStyle(u),y=oe(f,s.getStyle(t,r,l,c));t&&e.colorValue!=null&&f?.fill==null&&(y.fill=n.convert(e.colorValue));let b=y;if(o!=null&&e!=null){const x=this.cachedDatumCallback(P5(this.getDatumId(e),i?"highlight":"node"),()=>{const v=this.makeItemStylerParams(e,b,Sf(p));return this.callWithContext(o,v)});x&&(b=oe(x,b))}return b}makeItemStylerParams(e,t,i){const{id:s}=this,n=this.filterItemStylerFillParams(t.fill)??t.fill;return{seriesId:s,datum:e.datum,depth:e.depth??-1,highlightState:i,...t,fill:n}}updateSelections(){const e=this.getActiveHighlightNode();if(this.highlightSelection.update(e==null?[]:[e],void 0,n=>this.getDatumId(n)),!this.nodeDataRefresh)return;this.nodeDataRefresh=!1;const{seriesRect:t}=this.chart??{};if(!t)return;const i=Array.from(this.rootNode),s=n=>{n.append([new yk({tag:0}),new yk({tag:1})])};this.datumSelection.update(i,void 0,n=>this.getDatumId(n)),this.labelSelection.update(i,s,n=>this.getDatumId(n))}getActiveHighlightNode(){const e=super.getActiveHighlightNode();if(!(e?.children.length&&!this.properties.group.interactive))return e}updateNodes(){const{rootNode:e,data:t}=this,{childrenKey:i,colorKey:s,colorName:n,labelKey:o,secondaryLabelKey:a,sizeKey:r,sizeName:l,tile:c,group:h}=this.properties,{seriesRect:d}=this.chart??{};if(!d||!t)return;this.rootNode?.walk(v=>{const{datum:S,depth:M,children:D}=v,k=D.length===0,I=k?c.label:h.label;let A;if(I.enabled&&S!=null&&M!=null&&o!=null){const w=S[o];A=this.getLabelText(w,S,o,"label",[],I,{depth:M,datum:S,childrenKey:i,colorKey:s,colorName:n,labelKey:o,secondaryLabelKey:a,sizeKey:r,sizeName:l,value:w})}A===""&&(A=void 0);let C;if(c.secondaryLabel.enabled&&k&&S!=null&&M!=null&&a!=null){const w=S[a];C=this.getLabelText(w,S,a,"secondaryLabel",[],c.secondaryLabel,{depth:M,datum:S,childrenKey:i,colorKey:s,colorName:n,labelKey:o,secondaryLabelKey:a,sizeKey:r,sizeName:l,value:w})}C===""&&(C=void 0),v.labelValue=Pe(A),v.secondaryLabelValue=Pe(C)});const{width:u,height:p}=d;this.squarify(e,new Yu(0,0,u,p)),this.rootNode?.walk(v=>{const{bbox:S,children:M,labelValue:D,secondaryLabelValue:k}=v;if(v.label=void 0,v.secondaryLabel=void 0,S!=null)if(M.length===0){const I={width:S.width,height:S.height,meta:null},A=hk(D,this.properties.tile.label,k,this.properties.tile.secondaryLabel,{padding:c.padding},()=>I);if(A==null)return;const{height:C,label:w,secondaryLabel:T}=A,{textAlign:O,verticalAlign:E,padding:z}=c,F=EE[O]??.5,_=S.x+z+(S.width-2*z)*F,G=B5[E]??.5,B=S.y+z+C*.5+(S.height-2*z-C)*G;if(w!=null){const{fontStyle:V="normal",fontFamily:Y,fontWeight:X="normal",color:q="black"}=this.properties.tile.label;v.label={text:w.text,fontSize:w.fontSize,lineHeight:w.lineHeight,fontStyle:V,fontFamily:Y,fontWeight:X,color:q,textAlign:O,verticalAlign:"middle",x:_,y:B-(C-w.height)*.5}}if(T!=null){const{fontStyle:V="normal",fontFamily:Y,fontWeight:X="normal",color:q="black"}=this.properties.tile.secondaryLabel;v.secondaryLabel={text:T.text,fontSize:T.fontSize,lineHeight:T.fontSize,fontStyle:V,fontFamily:Y,fontWeight:X,color:q,textAlign:O,verticalAlign:"middle",x:_,y:B+(C-T.height)*.5}}}else{if(D==null)return;{const{padding:I,textAlign:A}=h,C=this.groupTitleHeight(v,S);if(C==null)return;const w=S.width-2*I,T=xa(D,{maxWidth:S.width-2*I,font:h.label,textWrap:"never"}),O=EE[A]??.5,{fontStyle:E="normal",fontFamily:z,fontWeight:F="normal",color:_="black"}=this.properties.group.label;v.label={text:T,fontSize:h.label.fontSize,lineHeight:Mn(h.label.fontSize),fontStyle:E,fontFamily:z,fontWeight:F,color:_,textAlign:A,verticalAlign:"middle",x:S.x+I+w*O,y:S.y+I+C*.5}}}});const f={series:new Yu(0,0,u,p),axis:new Yu(0,0,u,p)},y=(v,S,M)=>{const{bbox:D}=v;if(D==null){S.visible=!1;return}const{depth:k=-1}=v,I=v.children.length===0,A=this.getItemStyle(v,I,M);S.crisp=!0,S.setStyleProperties(A,f),S.cornerRadius=I?c.cornerRadius:h.cornerRadius,S.zIndex=[0,k,M?1:0];const C=v.parent?.children.every(O=>O.children.length===0),w=v.parent==null?void 0:v.parent.bbox,T=v.parent==null?void 0:v.parent.padding;C===!0&&w!=null&&T!=null?(S.clipBBox=D,S.x=w.x+T.left,S.y=w.y+T.top,S.width=w.width-(T.left+T.right),S.height=w.height-(T.top+T.bottom)):(S.clipBBox=void 0,S.x=D.x,S.y=D.y,S.width=D.width,S.height=D.height),S.visible=!0};this.datumSelection.each((v,S)=>y(S,v,!1)),this.highlightSelection.each((v,S)=>{y(S,v,!0)});const b=(v,S,M,D)=>{const k=v.children.length===0,I=M===0?v.label:v.secondaryLabel;if(I==null){S.visible=!1;return}let A,C;M===0?(A=k?c.label:h.label,C=["series",`${this.declarationOrder}`,k?"tile":"group","label"]):(A=c.secondaryLabel,C=["series",`${this.declarationOrder}`,"tile","secondaryLabel"]);const{opacity:w}=this.getItemStyle(v,k,D)??{},T={childrenKey:this.properties.childrenKey,colorKey:this.properties.colorKey,colorName:this.properties.colorName??this.properties.colorKey,depth:v.depth??Number.NaN,labelKey:this.properties.labelKey,secondaryLabelKey:this.properties.secondaryLabelKey,sizeKey:this.properties.sizeKey,sizeName:this.properties.sizeName??this.properties.sizeKey},O=this.ctx.highlightManager?.getActiveHighlight(),E=F5(this,v,T,A,D,O,C);S.text=I.text,S.fontSize=I.fontSize,S.lineHeight=I.lineHeight,S.fontStyle=I.fontStyle,S.fontFamily=I.fontFamily,S.fontWeight=I.fontWeight,S.fillOpacity=w??1,S.fill=E.color,S.setBoxing(E),S.textAlign=I.textAlign,S.textBaseline=I.verticalAlign,S.x=I.x,S.y=I.y,S.visible=!0,S.zIndex=1},x=this.getActiveHighlightNode();for(const v of this.labelSelection.selectByClass(yk)){const S=v.closestDatum();b(S,v,v.tag,S===x)}}getGroupHighlightState(e,t,i){const s=i.datumIndex,n=t?.datumIndex,o=this.isDescendantDatumIndex(s,n);if(i.children?.length===0)return s==null||t==null||t.children?.length===0?Jo.None:o?Jo.Item:Jo.OtherItem;if(t==null||t.children?.length===0)return Jo.None;const a=i.depth!=null&&t.depth!=null&&i.depth===t.depth;return o&&!a?Jo.None:e?Jo.Item:Jo.OtherItem}getTileHighlightStyle(e,t,i){if(i?.children&&i.children.length>0){const n=this.getGroupHighlightStyle(t);return n?.fillOpacity==null&&n?.strokeOpacity==null?void 0:{fillOpacity:n.fillOpacity,strokeOpacity:n.strokeOpacity}}return this.getHierarchyHighlightStyles(e,this.properties.tile.highlight)}getGroupHighlightStyle(e){const{highlight:t}=this.properties.group;switch(e){case Jo.Item:return t.highlightedItem;case Jo.OtherItem:return t.unhighlightedItem;default:return}}getHighlightStateString(e,t,i){if(i==null)return Sf(Jo.None);const s=i.reduce((r,l)=>r?.children[l],this.rootNode),n=this.getActiveHighlightNode();if(s==null)return Sf(Jo.None);if((s.children?.length??0)===0){const r=this.getHierarchyHighlightState(t??!1,n,s);return Sf(r)}const a=this.getGroupHighlightState(t??!1,n,s);return Sf(a)}isDescendantDatumIndex(e,t){if(t==null||t.length===0)return!0;if(e==null||e.length<t.length)return!1;for(let i=0;i<t.length;i+=1)if(e[i]!==t[i])return!1;return!0}pickNodesExactShape(e){const t=super.pickNodesExactShape(e);return t.sort((i,s)=>s.datumIndex.length-i.datumIndex.length),t}pickNodeClosestDatum(e){const t=this.pickNodesExactShape(e);return t.length!==0?{datum:t[0],distance:0}:this.pickNodeNearestDistantObject(e,this.datumSelection.nodes())}getTooltipContent(e){const{id:t,properties:i,ctx:s}=this,{formatManager:n}=s,{labelKey:o,secondaryLabelKey:a,childrenKey:r,sizeKey:l,sizeName:c,colorKey:h,colorName:d,tooltip:u}=i,p=e.reduce((C,w)=>C?.children[w],this.rootNode);if(p==null)return;const{datum:f,depth:y,children:b}=p;if(f==null||y==null)return;const x=b.length===0,v=[],S=l==null?void 0:f[l];if(S!=null){const C=[0,this.rootNode?.sumSize??0],w=n.format(this.callWithContext.bind(this),{type:"number",value:S,datum:f,seriesId:t,legendItemName:void 0,key:l,source:"tooltip",property:"size",boundSeries:this.getFormatterContext("size"),domain:C,fractionDigits:void 0});v.push({label:c,fallbackLabel:l,value:w??ao(S)})}const M=h==null?void 0:f[h];if(M!=null){const{colorDomain:C}=this,w=n.format(this.callWithContext.bind(this),{type:"number",value:M,datum:f,seriesId:t,legendItemName:void 0,key:h,source:"tooltip",property:"color",boundSeries:this.getFormatterContext("color"),domain:C,fractionDigits:void 0});v.push({label:d,fallbackLabel:h,value:w??ao(M)})}const D=this.getItemStyle({...p,colorValue:M??p.colorValue},x,!1),I={shape:"square",fill:D.fill,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0};Ut(I.fill)&&(I.fill={...I.fill,gradient:"linear",rotation:0,reverse:!1});const A=x?{marker:I}:void 0;return this.formatTooltipWithContext(u,{title:o==null?void 0:f[o],symbol:A,data:v},{seriesId:t,datum:f,title:void 0,depth:y,labelKey:o,secondaryLabelKey:a,childrenKey:r,sizeKey:l,sizeName:c,colorKey:h,colorName:d,...D})}computeFocusBounds(e){return R5.toCanvas(this.contentGroup,e.getBBox())}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.tile.label.itemStyler!=null||this.properties.group.label.itemStyler!=null}};xk.className="TreemapSeries",xk.type="treemap";var{treemapSeriesThemeableOptionsDef:_5}=L,bk={..._5,...Q(et,["highlightStyle","highlight","showInLegend"]),type:$(Le("treemap")),labelKey:N,secondaryLabelKey:N,childrenKey:N,sizeKey:N,colorKey:N,sizeName:N,colorName:N};bk.undocumentedGroupFills=ee(be(ie)),bk.undocumentedGroupStrokes=ee(be(ie));var PE={type:"series",name:"treemap",chartType:"standalone",enterprise:!0,solo:!0,version:ue,dependencies:[Wu],options:bk,themeTemplate:{series:{fills:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$palette:"fills"},{$applySwitch:[{$path:["/type",void 0,{$value:"$1"}]},{$value:"$1"},["gradient",L.FILL_GRADIENT_LINEAR_DEFAULTS],["pattern",L.FILL_PATTERN_DEFAULTS],["image",L.FILL_IMAGE_DEFAULTS]]}]},strokes:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$palette:"strokes"}]},colorRange:{$palette:"divergingColors"},undocumentedGroupFills:{$palette:"hierarchyColors"},undocumentedGroupStrokes:{$palette:"secondHierarchyColors"},group:{label:{...L.LABEL_BOXING_DEFAULTS,enabled:!0,color:{$ref:"textColor"},fontStyle:void 0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},spacing:4},fill:void 0,stroke:void 0,strokeWidth:1,padding:4,gap:2,textAlign:"left",highlight:{unhighlightedItem:{opacity:.2,fillOpacity:.2,strokeOpacity:.2}}},tile:{label:{...L.LABEL_BOXING_DEFAULTS,enabled:!0,color:{$ref:"chartBackgroundColor"},fontStyle:void 0,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:1.5},minimumFontSize:{$rem:Si.SMALLER},fontFamily:{$ref:"fontFamily"},wrapping:"on-space",overflowStrategy:"ellipsis",spacing:2},secondaryLabel:{...L.LABEL_BOXING_DEFAULTS,enabled:!0,color:{$ref:"chartBackgroundColor"},fontStyle:void 0,fontWeight:void 0,fontSize:{$ref:"fontSize"},minimumFontSize:{$rem:Si.SMALLER},fontFamily:{$ref:"fontFamily"},wrapping:"never",overflowStrategy:"ellipsis"},fill:void 0,stroke:void 0,strokeWidth:{$isUserOption:["../strokes/0",2,{$isUserOption:["./stroke",2,0]}]},padding:3,gap:1,highlight:{unhighlightedItem:{fillOpacity:.6,strokeOpacity:.6},unhighlightedBranch:{fillOpacity:.2,strokeOpacity:.2}}}},gradientLegend:{enabled:{$if:[{$path:"../series/0/colorKey"},!0,!1]}}},create:e=>new xk(e)},Mb=class extends bi{constructor(e){super(),this.ctx=e,this.enabled=!0,e.animationManager.skip(!1),this.cleanup.register(()=>e.animationManager.skip(!0))}};g([Wt((e,t)=>{e.ctx.animationManager.skip(!t)}),m],Mb.prototype,"enabled",2),g([Wt((e,t)=>{t!=null&&(e.ctx.animationManager.defaultDuration=t)}),m],Mb.prototype,"duration",2),g([Wt((e,t)=>{e.ctx.animationManager.maxAnimatableItems=t??1/0}),m],Mb.prototype,"maxAnimatableItems",2);var Mf={type:"plugin",name:"animation",enterprise:!0,version:ue,options:{enabled:R,duration:P},themeTemplate:{enabled:!0},create:e=>new Mb(e)};Mf.options.maxAnimatableItems=ee(P);var RE=class om extends bi{constructor(t){super(),this.ctx=t,this.activeSections=new Set,this.sectionButtons={annotations:[],chartToolbar:[]},this.container=this.ctx.domManager.addChild("canvas-overlay","shared-toolbar"),this.container.role="presentation"}getSharedToolbar(t){return this.sharedToolbar||this.createSharedToolbar(),t==="chartToolbar"&&this.sharedToolbar&&this.sharedToolbar.setAriaLabelId("ariaLabelFinancialCharts"),this.toolbarWithSection(t)}createSharedToolbar(){this.sharedToolbar=new L.Toolbar(this.ctx,"ariaLabelAnnotationsToolbar","vertical"),this.sharedToolbar.addClass("ag-charts-shared-toolbar"),this.container.append(this.sharedToolbar.getElement()),this.cleanup.register(()=>{this.sharedToolbar&&(this.sharedToolbar.getElement().remove(),this.sharedToolbar.destroy(),this.sharedToolbar=void 0)})}toolbarWithSection(t){const i=this.sharedToolbar,s={layout:(n,o)=>{if(this.firstLayoutSection!=null&&this.firstLayoutSection!==t&&this.activeSections.has(this.firstLayoutSection))return;this.firstLayoutSection=t;const a=i.getBounds().width;i.setBounds({x:n.x,y:n.y,width:a}),n.shrink({left:a+i.horizontalSpacing+(o??0)})},addToolbarListener:(n,o)=>i.addToolbarListener(n,a=>{const r=this.getSectionIndex(t,a.button.index);if(r<0)return;const l={...a,button:this.sectionButtons[t][r]};o(l)}),updateButtons:n=>{this.sectionButtons[t]=n;const o=om.SECTION_ORDER.flatMap(a=>this.sectionButtons[a]);i.updateButtons(o)},updateButtonByIndex:(n,o)=>{i.updateButtonByIndex(this.getIndex(t,n),o)},toggleActiveButtonByIndex:n=>{i.toggleActiveButtonByIndex(this.getIndex(t,n))},toggleButtonEnabledByIndex:(n,o)=>{i.toggleButtonEnabledByIndex(this.getIndex(t,n),o)},setHidden:n=>{n?this.activeSections.delete(t):this.activeSections.add(t);let o=0;for(const a of om.SECTION_ORDER){if(a!==t){o+=this.sectionButtons[a].length;continue}for(const r of this.sectionButtons[t].keys())i.setButtonHiddenByIndex(o+r,n)}},destroy:()=>{s.setHidden(!0),this.activeSections.size===0&&this.destroy()},clearActiveButton:i.clearActiveButton.bind(i),addListener:i.addListener.bind(i),removeListener:i.removeListener.bind(i)};return s.setHidden(!1),s}getIndex(t,i){let s=0;for(const n of om.SECTION_ORDER){if(n===t)return s+i;s+=this.sectionButtons[n].length}return-1}getSectionIndex(t,i){let s=0;for(const n of om.SECTION_ORDER){if(n===t)return i>=s+this.sectionButtons[t].length?-1:i-s;s+=this.sectionButtons[n].length}return-1}};RE.SECTION_ORDER=["chartToolbar","annotations"];var FE=RE,V5='<div contenteditable="plaintext-only" class="ag-charts-text-input__textarea" tabindex="0"></div>',zE="text-input",BE="canvas-overlay",G5=class{constructor(e){this.ctx=e,this.cleanup=new pt,this.layout={getTextInputCoords:()=>({x:0,y:0}),getTextPosition:()=>"center",alignment:"center",textAlign:"center"},this.visible=!1,this.element=e.domManager.addChild(BE,zE),this.element.classList.add("ag-charts-text-input"),this.cleanup.register(()=>e.domManager.removeChild(BE,zE))}setKeyDownHandler(e){this.cleanup.register(ot(this.element,"keydown",e))}show(e){this.element.innerHTML=V5;const t=this.element.firstElementChild;oo(t,{role:"textbox","data-preventdefault":!1}),t.isContentEditable||(t.contentEditable="true"),t.setAttribute("placeholder",this.ctx.localeManager.t(e.placeholderText??"inputTextareaPlaceholder")),e.styles?.placeholderColor&&t.style.setProperty("--placeholder-text-color",e.styles?.placeholderColor),t.innerText=e.text??"",t.style.color=e.styles?.color??"inherit",t.style.fontFamily=e.styles?.fontFamily??"inherit",t.style.fontSize=e.styles?.fontSize?`${e.styles.fontSize}px`:"inherit",t.style.fontStyle=e.styles?.fontStyle??"inherit",t.style.fontWeight=typeof e.styles?.fontWeight=="number"?`${e.styles.fontWeight}`:e.styles?.fontWeight??"inherit",Qm(t),t.addEventListener("input",()=>{this.updatePosition(),e.onChange?.(this.getValue(),this.getBBox())}),t.addEventListener("click",i=>{i.stopPropagation()}),e.layout&&(this.layout=e.layout,this.updatePosition()),e.onChange?.(this.getValue(),this.getBBox()),this.visible=!0}hide(){this.element.innerHTML="",this.layout={getTextInputCoords:()=>({x:0,y:0}),getTextPosition:()=>"center",alignment:"center",textAlign:"center"},this.visible=!1}isVisible(){return this.visible}updateColor(e){this.element.firstElementChild&&(this.element.firstElementChild.style.color=e)}updateFontSize(e){if(this.element.firstElementChild)return this.element.firstElementChild.style.fontSize=`${e}px`,this.updatePosition(),this.getBBox()}getValue(){if(this.element.firstElementChild)return this.element.firstElementChild.innerText.trim()}updatePosition(){const{element:e}=this,t=e.firstElementChild;if(!t)return;const i=this.ctx.domManager.getBoundingClientRect(),{width:s,getTextInputCoords:n,getTextPosition:o,alignment:a,textAlign:r}=this.layout;e.style.setProperty("width",s?`${s}px`:"unset");const l=t.getBoundingClientRect(),c=n(l.height);let h=c.x;a==="center"?h-=(s??l.width)/2:a==="right"&&(h-=s??l.width);const d=o();let u=c.y;d==="center"?u-=l.height/2:d==="bottom"&&(u-=l.height),e.style.setProperty("top",`${u}px`),e.style.setProperty("left",`${h}px`),e.style.setProperty("max-width",`${i.width-h}px`),e.style.setProperty("text-align",a),t.style.setProperty("text-align",r)}getBBox(){const{left:e,top:t,width:i,height:s}=this.element.getBoundingClientRect();return new L.BBox(e,t,i,s)}destroy(){this.cleanup.flush()}},vk=class extends K{constructor(){super(...arguments),this.enabled=!1,this.axes="y"}};g([m],vk.prototype,"enabled",2),g([m],vk.prototype,"axes",2);var Sk=(e=>(e.Line="line",e.HorizontalLine="horizontal-line",e.VerticalLine="vertical-line",e.DisjointChannel="disjoint-channel",e.ParallelChannel="parallel-channel",e.FibonacciRetracement="fibonacci-retracement",e.FibonacciRetracementTrendBased="fibonacci-retracement-trend-based",e.Callout="callout",e.Comment="comment",e.Note="note",e.Text="text",e.Arrow="arrow",e.ArrowUp="arrow-up",e.ArrowDown="arrow-down",e.DateRange="date-range",e.PriceRange="price-range",e.DatePriceRange="date-price-range",e.QuickDatePriceRange="quick-date-price-range",e))(Sk||{}),H5=Object.values(Sk);function j5(e){for(const t of H5)if(t===e)return t}var Df=class extends K{};g([m],Df.prototype,"x",2),g([m],Df.prototype,"y",2);var W5=class extends Ps(Fr(HE(K))){},Mk=class extends Ps(Fr(Fa(kk(Dh(K))))){constructor(){super(...arguments),this.cornerRadius=2}};g([m],Mk.prototype,"enabled",2),g([m],Mk.prototype,"cornerRadius",2);var $5=class extends Fa(K){},U5=class extends Ps(Fr(Fa(K))){},Sh=class extends Dh(K){constructor(){super(...arguments),this.label="",this.position="top",this.alignment="left"}};g([m],Sh.prototype,"label",2),g([m],Sh.prototype,"position",2),g([m],Sh.prototype,"alignment",2);var K5=class extends Dh(K){},If=class extends Dh(K){constructor(){super(...arguments),this.label=""}};g([m],If.prototype,"label",2),g([m],If.prototype,"position",2),g([m],If.prototype,"alignment",2);function Mh(e){class t extends Z5(HE(e)){constructor(){super(...arguments),this.id=Od()}}return t}function Dk(e){class t extends e{constructor(){super(...arguments),this.start=new Df,this.end=new Df}}return g([m],t.prototype,"start",2),g([m],t.prototype,"end",2),t}function _E(e){class t extends e{}return g([m],t.prototype,"x",2),g([m],t.prototype,"y",2),t}function VE(e){class t extends e{}return g([m],t.prototype,"value",2),t}function Ik(e){class t extends e{constructor(){super(...arguments),this.background=new $5}}return g([m],t.prototype,"background",2),t}function Ql(e){class t extends e{constructor(){super(...arguments),this.handle=new U5}}return g([m],t.prototype,"handle",2),t}function GE(e){class t extends e{constructor(){super(...arguments),this.axisLabel=new Mk}}return g([m],t.prototype,"axisLabel",2),t}function kk(e){class t extends e{constructor(){super(...arguments),this.padding=void 0,this.textAlign="center",this.formatter=void 0}}return g([m],t.prototype,"padding",2),g([m],t.prototype,"textAlign",2),g([m],t.prototype,"formatter",2),t}function Y5(e){class t extends e{}return t}function Ak(e){class t extends e{}return g([m],t.prototype,"extendStart",2),g([m],t.prototype,"extendEnd",2),t}function Z5(e){class t extends e{isWriteable(){return!this.locked&&!this.readOnly}isHoverable(){return!this.readOnly}}return g([m],t.prototype,"locked",2),g([m],t.prototype,"readOnly",2),t}function Ck(e){class t extends e{setLocaleManager(s){this.localeManager??(this.localeManager=s)}}return t}function HE(e){class t extends e{}return g([m],t.prototype,"visible",2),t}function Fa(e){class t extends e{}return g([m],t.prototype,"fill",2),g([m],t.prototype,"fillOpacity",2),t}function Ps(e){class t extends e{}return g([m],t.prototype,"stroke",2),g([m],t.prototype,"strokeOpacity",2),g([m],t.prototype,"strokeWidth",2),t}function Fr(e){class t extends e{constructor(){super(...arguments),this.lineCap=void 0,this.computedLineDash=void 0}}return g([m],t.prototype,"lineDash",2),g([m],t.prototype,"lineDashOffset",2),g([m],t.prototype,"lineStyle",2),t}function Dh(e){class t extends e{constructor(){super(...arguments),this.fontSize=12,this.fontFamily="Verdana, sans-serif"}}return g([m],t.prototype,"fontStyle",2),g([m],t.prototype,"fontWeight",2),g([m],t.prototype,"fontSize",2),g([m],t.prototype,"fontFamily",2),g([m],t.prototype,"color",2),t}function jE(e){return gt(e)||Rt(e)||Is(e)?{value:e,groupPercentage:0}:e??{value:void 0,groupPercentage:0}}function wi(e){return jE(e)?.value}function Js(e,t){if(e.start==null||e.end==null)return;const i=Qt(e.start,t),s=Qt(e.end,t);if(!(i==null||s==null))return{x1:i.x,y1:i.y,x2:s.x,y2:s.y}}function Qt(e,t){const i=zr(e.x,t.xAxis),s=zr(e.y,t.yAxis);return{x:i,y:s}}function zr(e,t){if(e==null)return 0;const{value:i,groupPercentage:s}=jE(e),{scale:n,snapToGroup:o}=t,a=n.bandwidth===0?n.step??0:n.bandwidth??0,r=o?a/2:a*s;return n.convert(i)+r}function en(e,t){const i=Db(e.x,t.xAxis),s=Db(e.y,t.yAxis);return{x:i,y:s}}function Db(e,t){const{scale:i}=t;if(t.continuous&&i.step==null)return t.scaleInvert(e);const s=t.scaleInvertNearest(e),n=i.bandwidth===0?i.step:i.bandwidth??0,o=i.convert(s),a=o+n,r=o===a?0:(e-o)/(a-o);return{value:s,groupPercentage:r}}var Lk=class extends Mh(Dk(Ql(K))){constructor(){super(...arguments),this.snapToAngle=45}getDefaultColor(e){}getDefaultOpacity(e){}},WE=class extends Ck(kk(Dh(Lk))){constructor(){super(...arguments),this.text="",this.position="top",this.alignment="left",this.placement="inside",this.placeholderText="inputTextareaPlaceholder"}getDefaultColor(e){return this.color}getDefaultOpacity(e){}getPlaceholderColor(){}getPadding(){const{padding:e=0}=this;return{top:e,right:e,bottom:e,left:e}}getText(){const e=this.text.length==0;let t=this.text;return e&&(t=this.placeholderText??"",this.localeManager&&(t=this.localeManager.t(t))),{text:t,isPlaceholder:e}}getTextInputCoords(e,t){return Qt(this.end,e)}getTextPosition(){return this.position}};g([m],WE.prototype,"text",2);var X5={top:6,right:12,bottom:9,left:12},ea=class extends Fa(Ps(WE)){constructor(){super(...arguments),this.type="callout",this.position="bottom",this.alignment="left"}static is(e){return fe(e)&&e.type==="callout"}getDefaultColor(e){switch(e){case"fill-color":return this.fill;case"line-color":return this.stroke;case"text-color":default:return this.color}}getDefaultOpacity(e){switch(e){case"fill-color":return this.fillOpacity;case"line-color":return this.strokeOpacity;case"text-color":default:return}}getPlaceholderColor(){const{r:e,g:t,b:i}=Be.fromString(this.color??"#888888");return new Be(e,t,i,.66).toString()}getPadding(){const{padding:e}=this;return e==null?{...X5}:{top:e,right:e,bottom:e,left:e}}getTextInputCoords(e,t){const i=super.getTextInputCoords(e,t),s=this.getPadding(),n=s.left??0,o=s.bottom??0;return{x:i.x+n,y:i.y-o}}};g([m],ea.prototype,"type",2);var Ib=class extends Mh(_E(Ql(kk(Dh(K))))){constructor(){super(...arguments),this.text="",this.position="top",this.alignment="left",this.placement="inside",this.placeholderText="inputTextareaPlaceholder"}getDefaultColor(e){return this.color}getDefaultOpacity(e){}getPlaceholderColor(){}getPadding(){const{padding:e=0}=this;return{top:e,right:e,bottom:e,left:e}}getText(){const e=this.text.length==0;return{text:e?this.placeholderText??"":this.text,isPlaceholder:e}}getTextInputCoords(e,t){return Qt(this,e)}getTextPosition(){return this.position}};g([m],Ib.prototype,"text",2);var kb={top:8,right:14,bottom:8,left:14},za=class extends Fa(Ps(Ib)){constructor(){super(...arguments),this.type="comment",this.position="bottom",this.alignment="left"}static is(e){return fe(e)&&e.type==="comment"}getDefaultColor(e){switch(e){case"fill-color":return this.fill;case"line-color":return this.stroke;case"text-color":default:return this.color}}getDefaultOpacity(e){switch(e){case"fill-color":return this.fillOpacity;case"line-color":return this.strokeOpacity;case"text-color":default:return}}getPlaceholderColor(){const{r:e,g:t,b:i}=Be.fromString(this.color??"#888888");return new Be(e,t,i,.66).toString()}getPadding(){const{padding:e,fontSize:t}=this;return e==null?{top:Math.max(t*.4,kb.top),bottom:Math.max(t*.4,kb.bottom),left:Math.max(t*.8,kb.left),right:Math.max(t*.8,kb.right)}:{top:e,right:e,bottom:e,left:e}}getTextInputCoords(e,t){const i=super.getTextInputCoords(e,t),s=this.getPadding();return{x:i.x+s.left,y:i.y-s.bottom}}};g([m],za.prototype,"type",2);function kf(e,t){return e?"dashed":t??"solid"}function $E(e,t){switch(t){case"solid":return[];case"dashed":return[e*4,e*2];case"dotted":return[0,e*2]}}function Zu(e,t,i,s){const n=kf(e,i);return t??e??$E(s??1,n)}function Xu(e,t,i){const s=kf(t,i);return e??s==="dotted"?"round":void 0}function q5(e,t){const[i,s]=H.from(e),n=t.height,o=H.gradient(s,i,n),a=H.intercept(s,o,n),r=[{x:i.x,y:n??0},{x:i.x,y:n==null?t.height:n-t.height}];if(o===1/0)return r;let l=[H.intersectAtY(o,a,0,n),H.intersectAtY(o,a,t.height,n),H.intersectAtX(o,a,0,n),H.intersectAtX(o,a,t.width,n)];return l=l.filter(c=>c.x>=t.x&&c.x<=t.width&&c.y>=t.y&&c.y<=t.height).sort((c,h)=>c.x===h.x?0:c.x<h.x?-1:1),l.length!==2?r:l}var Q5=class extends Ps(K){},wk=class extends Dh(Fa(Ps(K))){constructor(){super(...arguments),this.divider=new Q5}};g([m],wk.prototype,"divider",2);var Tk=class extends Fa(Ps(Ql(K))){constructor(){super(...arguments),this.statistics=new wk}};g([m],Tk.prototype,"statistics",2);var qu=class extends Ck(Ik(Ps(Fr(Lk)))){constructor(){super(...arguments),this.direction="both",this.hasDateRange=!1,this.hasPriceRange=!1,this.statistics=new wk,this.getVolume=()=>{},this.text=new Sh}getDefaultColor(e){switch(e){case"fill-color":return this.background.fill;case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(e){switch(e){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return Zu(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Xu(this.lineCap,this.lineDash,this.lineStyle)}};g([m],qu.prototype,"statistics",2),g([m],qu.prototype,"text",2);function Nk(e){class t extends e{constructor(){super(...arguments),this.hasDateRange=!0}}return t}function Ok(e){class t extends e{constructor(){super(...arguments),this.hasPriceRange=!0}}return t}var mo=class extends Nk(qu){constructor(){super(...arguments),this.type="date-range",this.direction="horizontal"}static is(e){return fe(e)&&e.type==="date-range"}};g([m],mo.prototype,"type",2),g([m],mo.prototype,"extendAbove",2),g([m],mo.prototype,"extendBelow",2);var yo=class extends Ok(qu){constructor(){super(...arguments),this.type="price-range",this.direction="vertical"}static is(e){return fe(e)&&e.type==="price-range"}};g([m],yo.prototype,"type",2),g([m],yo.prototype,"extendLeft",2),g([m],yo.prototype,"extendRight",2);var Br=class extends Nk(Ok(qu)){constructor(){super(...arguments),this.type="date-price-range",this.direction="both"}static is(e){return fe(e)&&e.type==="date-price-range"}};g([m],Br.prototype,"type",2);var _n=class extends Nk(Ok(qu)){constructor(){super(...arguments),this.type="quick-date-price-range",this.up=new Tk,this.down=new Tk,this.direction="both"}static is(e){return fe(e)&&e.type==="quick-date-price-range"}};g([m],_n.prototype,"type",2),g([m],_n.prototype,"up",2),g([m],_n.prototype,"down",2);var{BBox:J5}=L,Ab=1.38;function Cb(e,t,i){return i?xa(t,{maxWidth:i,font:e,textWrap:"always",avoidOrphans:!1}):t}function eZ(e,t){const{lineMetrics:i,width:s}=Ze(e).measureLines(t),n=i.length*Mn(e.fontSize,Ab);return{width:s,height:n}}function Ek(e,t,i,s){let n=s?.width??0,o=s?.height??0;if(!s){const a=e.width==null?t:Cb(e,t,e.width);({width:n,height:o}=eZ(e,a))}return new J5(i.x,i.y,n,o)}function UE(e,t,i,s,{x:n,y:o},a){const{visible:r=!0,fontFamily:l,fontSize:c=14,fontStyle:h,fontWeight:d,textAlign:u}=s,p=Mn(c,Ab);a??(a=s.position=="center"?"middle":s.position);const f=i?s.getPlaceholderColor():s.color;e.setProperties({x:n,y:o,visible:r,text:t,fill:f,fontFamily:l,fontSize:c,fontStyle:h,fontWeight:d,textAlign:u,lineHeight:p,textBaseline:a})}var tZ=10,iZ=11,KE=20,sZ=22,nZ=10,YE=KE+nZ,ZE=34,oZ=class extends Fa(Ps(K)){},un=class extends Fa(Ps(Ib)){constructor(){super(...arguments),this.type="note",this.background=new oZ,this.position="bottom",this.alignment="center",this.width=200}static is(e){return fe(e)&&e.type==="note"}getDefaultColor(e){switch(e){case"line-color":return this.fill;case"text-color":return this.color}}getDefaultOpacity(e){switch(e){case"line-color":return this.fillOpacity;case"text-color":return}}getPadding(){const e=this.padding??tZ;return{top:e,right:e,bottom:e,left:e}}getTextInputCoords(e,t){const{width:i,text:s}=this,n=super.getTextInputCoords(e,t),o=this.getPadding().top,a=Ek(this,s,n);a.x=ge(i/2,a.x,e.seriesRect.width-i/2);const r=a.y-YE-o*2,l=a.y+iZ+o*2,c=Math.max(a.height,t);return r-c-ZE<0?(a.y=l,this.position="top"):(a.y=r+o,this.position="bottom"),{x:a.x,y:a.y}}isHoverable(){return!0}};g([m],un.prototype,"type",2),g([m],un.prototype,"background",2);var aZ=class extends Mh(_E(Ql(K))){getDefaultColor(e){}getDefaultOpacity(e){}},Pk=class i_ extends Fa(aZ){constructor(){super(...arguments),this.size=32}static is(t){return t instanceof i_}getDefaultColor(t){return t==="fill-color"?this.fill:void 0}getDefaultOpacity(t){return t==="fill-color"?this.fillOpacity:void 0}},Rs=class extends Mh(VE(Ql(GE(Ps(Fr(K)))))){constructor(){super(...arguments),this.direction="horizontal",this.type="horizontal-line",this.text=new Sh}static is(e){return fe(e)&&e.type==="horizontal-line"}getDefaultColor(){return this.stroke}getDefaultOpacity(){return this.strokeOpacity}getLineDash(){return Zu(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Xu(this.lineCap,this.lineDash,this.lineStyle)}};g([m],Rs.prototype,"type",2),g([m],Rs.prototype,"text",2);var Ba=class extends Mh(VE(Ql(GE(Ps(Fr(K)))))){constructor(){super(...arguments),this.direction="vertical",this.type="vertical-line",this.text=new Sh}static is(e){return fe(e)&&e.type==="vertical-line"}getDefaultColor(){return this.stroke}getDefaultOpacity(){return this.strokeOpacity}getLineDash(){return Zu(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Xu(this.lineCap,this.lineDash,this.lineStyle)}};g([m],Ba.prototype,"type",2),g([m],Ba.prototype,"text",2);var xo=class extends Mh(Ik(Dk(Ql(Ak(Ps(Fr(K))))))){constructor(){super(...arguments),this.type="disjoint-channel",this.text=new If,this.snapToAngle=45}static is(e){return fe(e)&&e.type==="disjoint-channel"}get bottom(){const e={start:{x:this.start.x,y:this.start.y},end:{x:this.end.x,y:this.end.y}};return typeof e.start.y=="number"&&typeof e.end.y=="number"?(e.start.y-=this.startHeight,e.end.y-=this.endHeight):j.warnOnce(`Annotation [${this.type}] can only be used with a numeric y-axis.`),e}getDefaultColor(e){switch(e){case"fill-color":return this.background.fill;case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(e){switch(e){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return Zu(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Xu(this.lineCap,this.lineDash,this.lineStyle)}};g([m],xo.prototype,"type",2),g([m],xo.prototype,"startHeight",2),g([m],xo.prototype,"endHeight",2),g([m],xo.prototype,"text",2);var Lb=class extends Ck(Y5(Ak(Ps(Fr(Lk))))){constructor(){super(...arguments),this.text=new Sh}getDefaultColor(e){switch(e){case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(){return this.strokeOpacity}getLineDash(){return Zu(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Xu(this.lineCap,this.lineDash,this.lineStyle)}};g([m],Lb.prototype,"text",2);var _r=class extends Lb{constructor(){super(...arguments),this.type="arrow",this.endCap="arrow"}static is(e){return fe(e)&&e.type==="arrow"}};g([m],_r.prototype,"type",2);var Vr=class extends Lb{constructor(){super(...arguments),this.type="line"}static is(e){return fe(e)&&e.type==="line"}};g([m],Vr.prototype,"type",2);var Gr=class extends Lb{constructor(){super(...arguments),this.label=new K5,this.reverse=!1,this.showFill=!0,this.isMultiColor=!0,this.strokes=[],this.bands=10}getDefaultColor(e){switch(e){case"line-color":return this.rangeStroke??this.stroke;case"text-color":return this.text.color}}};g([m],Gr.prototype,"label",2),g([m],Gr.prototype,"reverse",2),g([m],Gr.prototype,"showFill",2),g([m],Gr.prototype,"isMultiColor",2),g([m],Gr.prototype,"strokes",2),g([m],Gr.prototype,"rangeStroke",2),g([m],Gr.prototype,"bands",2);var _a=class extends Gr{constructor(){super(...arguments),this.type="fibonacci-retracement-trend-based",this.endRetracement=new Df}static is(e){return fe(e)&&e.type==="fibonacci-retracement-trend-based"}};g([m],_a.prototype,"type",2),g([m],_a.prototype,"endRetracement",2);var Hr=class extends Gr{constructor(){super(...arguments),this.type="fibonacci-retracement"}static is(e){return fe(e)&&e.type==="fibonacci-retracement"}};g([m],Hr.prototype,"type",2);var bo=class extends Mh(Ik(Dk(Ql(Ak(Ps(Fr(K))))))){constructor(){super(...arguments),this.type="parallel-channel",this.middle=new W5,this.text=new If,this.snapToAngle=45}static is(e){return fe(e)&&e.type==="parallel-channel"}get bottom(){const e={start:{x:this.start.x,y:this.start.y},end:{x:this.end.x,y:this.end.y}};return typeof e.start.y=="number"&&typeof e.end.y=="number"?(e.start.y-=this.height,e.end.y-=this.height):j.warnOnce(`Annotation [${this.type}] can only be used with a numeric y-axis.`),e}getDefaultColor(e){switch(e){case"fill-color":return this.background.fill;case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(e){switch(e){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return Zu(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Xu(this.lineCap,this.lineDash,this.lineStyle)}};g([m],bo.prototype,"type",2),g([m],bo.prototype,"height",2),g([m],bo.prototype,"middle",2),g([m],bo.prototype,"text",2);var jr=class extends Ib{constructor(){super(...arguments),this.type="text",this.position="bottom"}static is(e){return fe(e)&&e.type==="text"}};g([m],jr.prototype,"type",2);function Jl(e){return _n.is(e)}function wb(e){return Vr.is(e)||Rs.is(e)||Ba.is(e)||_r.is(e)||XE(e)}function Wr(e){return xo.is(e)||bo.is(e)}function XE(e){return Hr.is(e)||_a.is(e)}function Va(e){return ea.is(e)||za.is(e)||un.is(e)||jr.is(e)}function Af(e){return mo.is(e)||yo.is(e)||Br.is(e)||_n.is(e)}function Rk(e){return Va(e)&&!un.is(e)}function ec(e){return wb(e)||Wr(e)||Af(e)&&!_n.is(e)}function rZ(e){return wb(e)||Wr(e)||Af(e)||ea.is(e)||un.is(e)}function lZ(e){return un.is(e)}function cZ(e){return Wr(e)||Af(e)||ea.is(e)||za.is(e)||Pk.is(e)}function hZ(e){return Va(e)&&!un.is(e)}function Qu(e){return(wb(e)||Wr(e)||Af(e))&&!Jl(e)&&fe(e.text)}function dZ(e,t){"fontSize"in e&&(e.fontSize=t),Qu(e)&&(e.text.fontSize=t)}function qE(e,t){const i=t?.strokeWidth??e.strokeWidth??1,s=t?.type??e.lineStyle,n=s??kf(e.lineDash,s),o=$E(i,n);e.strokeWidth=i,e.computedLineDash=o,e.lineStyle=n,e.lineCap=n==="dotted"?"round":void 0}function Tb(e,t,i,s,n,o){switch(t){case"fill-color":{"fill"in e&&(e.fill=s),"fillOpacity"in e&&(e.fillOpacity=n),"background"in e&&(e.background.fill=s,e.background.fillOpacity=n);break}case"line-color":{"axisLabel"in e&&(e.axisLabel.fill=s,e.axisLabel.fillOpacity=n,e.axisLabel.stroke=s,e.axisLabel.strokeOpacity=n),"fill"in e&&"fillOpacity"in e&&lZ(e)?(e.fill=s,e.fillOpacity=n):("strokeOpacity"in e&&(e.strokeOpacity=n),"isMultiColor"in e&&"rangeStroke"in e?(e.isMultiColor=o,e.rangeStroke=s):"stroke"in e&&(e.stroke=s));break}case"text-color":{"color"in e&&(e.color=i),Qu(e)&&(e.text.color=s);break}}}var uZ=class{constructor(){this.mementoOriginatorKey="annotation-defaults",this.colors=new Map(Object.values(Sk).map(e=>[e,new Map([["line-color",void 0],["fill-color",void 0],["text-color",void 0]])])),this.fontSizes=new Map([["callout",void 0],["comment",void 0],["text",void 0],["arrow",void 0],["line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineStyles=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineTextAlignments=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineTextPositions=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.fibonacciOptions=new Map([["fibonacci-retracement",{bands:void 0,reverse:void 0,showFill:void 0}],["fibonacci-retracement-trend-based",{bands:void 0,reverse:void 0,showFill:void 0}]])}createMemento(){return{colors:Re(this.colors),fontSizes:Re(this.fontSizes),lineStyles:Re(this.lineStyles),lineTextAlignments:Re(this.lineTextAlignments),lineTextPositions:Re(this.lineTextPositions),fibonacciOptions:Re(this.fibonacciOptions)}}guardMemento(e){return!0}restoreMemento(e,t,i){this.colors=Re(i.colors),this.fontSizes=Re(i.fontSizes),this.lineStyles=Re(i.lineStyles),this.lineTextAlignments=Re(i.lineTextAlignments),this.lineTextPositions=Re(i.lineTextPositions),this.fibonacciOptions=Re(i.fibonacciOptions)}setDefaultColor(e,t,i,s,n,o){this.colors.get(e)?.set(t,[i,s,n,o])}setDefaultFontSize(e,t){this.fontSizes.set(e,t)}setDefaultLineStyleType(e,t){const i=this.lineStyles.get(e);i?i.type=t:this.lineStyles.set(e,{type:t})}setDefaultLineStyleWidth(e,t){const i=this.lineStyles.get(e);i?i.strokeWidth=t:this.lineStyles.set(e,{strokeWidth:t})}setDefaultLineTextAlignment(e,t){this.lineTextAlignments.set(e,t)}setDefaultLineTextPosition(e,t){this.lineTextPositions.set(e,t)}setDefaultFibonacciOptions(e,t,i){if(e!="fibonacci-retracement"&&e!="fibonacci-retracement-trend-based")return;const s=this.fibonacciOptions.get(e);s[t]=i,this.fibonacciOptions.set(e,s)}applyDefaults(e){for(const[t,i]of this.colors)if(e.type===t)for(const[s,[n,o,a,r]=[]]of i)n&&o&&a!=null&&r!=null&&Tb(e,s,n,o,a,r);for(const[t,i]of this.fontSizes)e.type!==t||i==null||dZ(e,i);for(const[t,i]of this.lineStyles)e.type!==t||i==null||qE(e,i);for(const[t,i]of this.lineTextPositions)e.type!==t||i==null||(e.text.position=i);for(const[t,i]of this.lineTextAlignments)e.type!==t||i==null||(e.text.alignment=i);for(const[t,i]of this.fibonacciOptions)if(!(e.type!==t||i==null))for(const s of Object.keys(i)){const n=i[s];n!=null&&e.set({[s]:n})}}},pZ='<div class="ag-charts-color-picker__palette" role="slider" tabindex="0"></div><div class="ag-charts-color-picker__color-row" role="presentation"><button class="ag-charts-color-picker__multi-color-button" tabindex="0" type="button" role="switch"></button> <input class="ag-charts-color-picker__hue-input" tabindex="0" type="range" min="0" max="360" value="0"></div><input class="ag-charts-color-picker__alpha-input" tabindex="0" type="range" min="0" max="1" value="1" step="0.01"> <label class="ag-charts-color-picker__color-field" role="presentation"><span class="ag-charts-color-picker__color-label" aria-hidden="true"></span> <input class="ag-charts-color-picker__color-input" tabindex="0" value="#000"></label>',QE=e=>{try{const t=Be.fromString(e),[i,s,n]=t.toHSB();return[i,s,n,t.a]}catch{return}},JE=class extends L.AnchoredPopover{constructor(e,t){super(e,"color-picker",t),this.hasChanged=!1,this.hideFns.push(()=>{this.i18nUpdater=void 0,this.hasChanged&&this.onChangeHide?.()}),this.cleanup.register(this.ctx.eventsHub.on("locale:change",()=>this.i18nUpdater?.()))}show(e){this.hasChanged=!1,this.onChangeHide=e.onChangeHide;const{element:t,initialFocus:i}=this.createColorPicker(e),s=this.showWithChildren([t],{initialFocus:i,...e});s.classList.add("ag-charts-color-picker"),s.setAttribute("role","dialog")}createColorPicker(e){const{localeManager:t}=this.ctx;let i=e.isMultiColor??!1,[s,n,o,a]=QE(e.color??"#f00")??[0,1,.5,1];a=e.opacity??a;const r=xe("div","ag-charts-color-picker__content");r.innerHTML=pZ,r.ariaLabel=this.ctx.localeManager.t("ariaLabelColorPicker");const l=r.querySelector(".ag-charts-color-picker__palette"),c=r.querySelector(".ag-charts-color-picker__hue-input"),h=r.querySelector(".ag-charts-color-picker__multi-color-button"),d=r.querySelector(".ag-charts-color-picker__alpha-input"),u=r.querySelector(".ag-charts-color-picker__color-input"),p=r.querySelector(".ag-charts-color-picker__color-label"),f=S=>{const M={s:"ariaValueColorPalette",v:"ariaValueColorPaletteFirstV"}[S];l.ariaValueText=t.t(M,{s:n,v:o})};this.i18nUpdater=()=>{l.ariaRoleDescription=t.t("ariaRoleDescription2DSlider"),l.ariaLabel=t.t("ariaLabelColorPickerPalette"),c.ariaLabel=t.t("ariaLabelColorPickerHue"),h.ariaLabel=t.t("ariaLabelColorPickerMultiColor"),d.ariaLabel=t.t("ariaLabelColorPickerAlpha"),u.ariaLabel=t.t("ariaLabelColor"),f("s")},this.i18nUpdater(),h.classList.toggle("ag-charts-color-picker__multi-color-button--hidden",!e.hasMultiColorOption);const y=(S=!0)=>{const D=Be.fromHSB(s,n,o,a).toHexString();if(r.style.setProperty("--h",`${s}`),r.style.setProperty("--s",`${n}`),r.style.setProperty("--v",`${o}`),r.style.setProperty("--a",`${a}`),r.style.setProperty("--color",D.slice(0,7)),r.style.setProperty("--color-a",D),c.value=`${s}`,d.value=`${a}`,d.classList.toggle("ag-charts-color-picker__alpha-input--opaque",a===1),h.classList.toggle("ag-charts-color-picker__multi-color-button--active",i),p.classList.toggle("ag-charts-color-picker__color-label--multi-color",i),document.activeElement!==u&&(h.ariaChecked=i.toString(),u.value=i?t.t("ariaLabelColorPickerMultiColor"):D.toUpperCase()),S||e.color==null){const k=Be.fromHSB(s,n,o,1).toHexString();e.onChange?.(D,k,a,i)}S&&(this.hasChanged=!0)};y(!1);const b=S=>S.preventDefault(),x=S=>S.stopPropagation(),v=S=>{S.preventDefault();const M=S.currentTarget;M.focus();const D=M.getBoundingClientRect(),k=({clientX:A,clientY:C})=>{i=!1,n=Math.min(Math.max((A-D.left)/D.width,0),1),o=1-Math.min(Math.max((C-D.top)/D.height,0),1),y(),f("s")};k(S);const I=ot(Ve(),"pointermove",k);Ve().addEventListener("pointerup",I,{once:!0})};return r.addEventListener("mousedown",x),r.addEventListener("touchstart",x),r.addEventListener("touchmove",x),r.addEventListener("keydown",S=>{switch(S.stopPropagation(),S.key){case"Enter":case"Escape":this.hide();break;default:return}S.preventDefault()}),l.addEventListener("pointerdown",v),l.addEventListener("touchstart",b,{passive:!1}),l.addEventListener("touchmove",b,{passive:!1}),l.addEventListener("keydown",S=>{if(S.key==="ArrowLeft")n=ge(0,n-.01,1),f("s");else if(S.key==="ArrowRight")n=ge(0,n+.01,1),f("s");else if(S.key==="ArrowUp")o=ge(0,o+.01,1),f("v");else if(S.key==="ArrowDown")o=ge(0,o-.01,1),f("v");else return;S.preventDefault(),y()}),l.addEventListener("focus",()=>{f("s")}),h.addEventListener("click",()=>{i=!i,y()}),c.addEventListener("input",S=>{i=!1,s=S.currentTarget.valueAsNumber??0,y()}),d.addEventListener("input",S=>{i=!1,a=S.currentTarget.valueAsNumber??0,y()}),u.addEventListener("input",S=>{i=!1;const M=QE(S.currentTarget.value);M!=null&&([s,n,o,a]=M,y())}),u.addEventListener("blur",()=>y()),u.addEventListener("keydown",S=>{S.key==="Enter"&&(S.currentTarget.blur(),y())}),{element:r,initialFocus:l}}};function eP(e){return!(e instanceof L.LogScale)&&!(e instanceof L.BandScale)}var gZ=[{label:"toolbarAnnotationsTrendLine",icon:"trend-line-drawing",value:"line"},{label:"toolbarAnnotationsHorizontalLine",icon:"horizontal-line-drawing",value:"horizontal-line"},{label:"toolbarAnnotationsVerticalLine",icon:"vertical-line-drawing",value:"vertical-line"},{label:"toolbarAnnotationsParallelChannel",icon:"parallel-channel-drawing",value:"parallel-channel",visible:eP},{label:"toolbarAnnotationsDisjointChannel",icon:"disjoint-channel-drawing",value:"disjoint-channel",visible:eP}],fZ=[{label:"toolbarAnnotationsFibonacciRetracement",icon:"fibonacci-retracement-drawing",value:"fibonacci-retracement"},{label:"toolbarAnnotationsFibonacciRetracementTrendBased",icon:"fibonacci-retracement-trend-based-drawing",value:"fibonacci-retracement-trend-based"}],mZ=[{label:"Fibonacci - Extended",value:10},{label:"Fibonacci - 6 Band",value:6},{label:"Fibonacci - 4 Band",value:4}],yZ=[{label:"toolbarAnnotationsText",icon:"text-annotation",value:"text"},{label:"toolbarAnnotationsComment",icon:"comment-annotation",value:"comment"},{label:"toolbarAnnotationsCallout",icon:"callout-annotation",value:"callout"},{label:"toolbarAnnotationsNote",icon:"note-annotation",value:"note"}],xZ=[{label:"toolbarAnnotationsArrow",icon:"arrow-drawing",value:"arrow"},{label:"toolbarAnnotationsArrowUp",icon:"arrow-up-drawing",value:"arrow-up"},{label:"toolbarAnnotationsArrowDown",icon:"arrow-down-drawing",value:"arrow-down"}],bZ=[{label:"toolbarAnnotationsQuickDatePriceRange",icon:"measurer-drawing",value:"quick-date-price-range"},{label:"toolbarAnnotationsDateRange",icon:"date-range-drawing",value:"date-range"},{label:"toolbarAnnotationsPriceRange",icon:"price-range-drawing",value:"price-range"},{label:"toolbarAnnotationsDatePriceRange",icon:"date-price-range-drawing",value:"date-price-range"}],tP=[{strokeWidth:1,label:"1",value:1},{strokeWidth:2,label:"2",value:2},{strokeWidth:3,label:"3",value:3},{strokeWidth:4,label:"4",value:4},{strokeWidth:8,label:"8",value:8}],Cf=[{icon:"line-style-solid",altText:"iconAltTextLineStyleSolid",value:"solid"},{icon:"line-style-dashed",altText:"iconAltTextLineStyleDashed",value:"dashed"},{icon:"line-style-dotted",altText:"iconAltTextLineStyleDotted",value:"dotted"}],iP=[{label:"10",value:10},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"22",value:22},{label:"28",value:28},{label:"36",value:36},{label:"46",value:46}],{FloatingToolbar:vZ,Menu:Fk,ToolbarButtonWidget:SZ}=L,Ju=class extends Vo{constructor(){super(...arguments),this.checkedOverrides=new Vo}};g([m],Ju.prototype,"value",2),g([m],Ju.prototype,"checkedOverrides",2),g([m],Ju.prototype,"color",2),g([m],Ju.prototype,"strokeWidth",2),g([m],Ju.prototype,"isMultiColor",2);var MZ=class extends SZ{update(e){super.update(e),e.value==="line-stroke-width"&&this.updateLineStrokeWidth(e),(e.value==="fill-color"||e.value==="line-color"||e.value==="text-color")&&this.updateFillColor(e)}updateFillColor(e){const t=this.getElement();t.classList.add("ag-charts-annotations__color-picker-button"),t.classList.toggle("ag-charts-annotations__color-picker-button--multi-color",e.isMultiColor),t.style.setProperty("--color",e.color??null)}updateLineStrokeWidth(e){const t=this.getElement();t.classList.add("ag-charts-annotations__stroke-width-button"),t.style.setProperty("--stroke-width",`${e.strokeWidth}px`)}},DZ=class extends vZ{createButtonWidget(){return new MZ(this.localeManager)}},zk=class extends K{constructor(e,t){super(),this.ctx=e,this.getActiveDatum=t,this.enabled=!0,this.buttons=new Pi(Ju),this.cleanup=new pt,this.events=new Sn,this.visibleButtons=[],this.toolbar=new DZ(this.ctx,"ariaLabelAnnotationOptionsToolbar","annotation-options"),this.colorPicker=new JE(this.ctx),this.textSizeMenu=new Fk(this.ctx,"text-size"),this.lineStyleTypeMenu=new Fk(this.ctx,"annotations-line-style-type"),this.lineStrokeWidthMenu=new Fk(this.ctx,"annotations-line-stroke-width"),this.cleanup.register(this.toolbar.addToolbarListener("button-pressed",this.onButtonPress.bind(this)),this.toolbar.addToolbarListener("toolbar-moved",this.onToolbarMoved.bind(this)),e.widgets.seriesWidget.addListener("drag-start",this.onDragStart.bind(this)),e.widgets.seriesWidget.addListener("drag-end",this.onDragEnd.bind(this)),()=>{this.colorPicker.destroy(),this.toolbar.destroy()})}onDragStart(){this.toolbar.ignorePointerEvents()}onDragEnd(){this.toolbar.capturePointerEvents()}destroy(){this.cleanup.flush()}show(){this.enabled&&this.toolbar.show()}hide(){this.toolbar.hide()}updateButtons(e){if(!this.enabled)return;const t={"line-style-type":ec(e),"line-stroke-width":ec(e),"line-color":rZ(e),"text-color":hZ(e),"fill-color":cZ(e),"text-size":Rk(e),settings:Qu(e),lock:!0,delete:!0};this.visibleButtons=this.buttons.filter(i=>t[i.value]),this.toolbar.clearButtons(),this.toolbar.updateButtons(this.visibleButtons),this.refreshButtons(e)}setAnchorScene(e){this.toolbar.hasBeenDragged()||this.toolbar.setAnchor(e.getAnchor())}hideOverlays(){this.toolbar.clearActiveButton(),this.colorPicker.hide({lastFocus:null}),this.textSizeMenu.hide(),this.lineStyleTypeMenu.hide(),this.lineStrokeWidthMenu.hide(),this.events.emit("hid-overlays",null)}clearActiveButton(){this.toolbar.clearActiveButton()}updateColors(e){this.updateColorPickerColor("line-color",e.getDefaultColor("line-color"),e.getDefaultOpacity("line-color"),"isMultiColor"in e&&e?.isMultiColor),this.updateColorPickerColor("fill-color",e.getDefaultColor("fill-color"),e.getDefaultOpacity("fill-color"),"isMultiColor"in e&&e?.isMultiColor),this.updateColorPickerColor("text-color",e.getDefaultColor("text-color"),e.getDefaultOpacity("text-color"),"isMultiColor"in e&&e?.isMultiColor)}updateColorPickerColor(e,t,i,s){if(t!=null&&i!=null){const{r:n,g:o,b:a}=Be.fromString(t);t=Be.fromArray([n,o,a,i]).toHexString()}this.updateButtonByValue(e,{color:t,isMultiColor:s})}updateFontSize(e){this.updateButtonByValue("text-size",{label:e==null?void 0:String(e)})}updateLineStyleType(e){this.updateButtonByValue("line-style-type",{icon:e.icon})}updateStrokeWidth(e){this.updateButtonByValue("line-stroke-width",{label:e.label,strokeWidth:e.value})}onButtonPress({event:e,button:t,buttonWidget:i}){const s=this.getActiveDatum();if(s)switch(this.hideOverlays(),t.value){case"line-style-type":{const n=ec(s)?kf(s.lineDash,s.lineStyle):void 0;this.lineStyleTypeMenu.show(i,{items:Cf,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsLineStyle"),value:n,onPress:o=>this.onLineStyleTypeMenuPress(o,s),class:"ag-charts-annotations__line-style-type-menu"});break}case"line-stroke-width":{const n=ec(s)?s.strokeWidth:void 0;this.lineStrokeWidthMenu.show(i,{items:tP,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsLineStrokeWidth"),value:n,onPress:o=>this.onLineStrokeWidthMenuPress(o,s),class:"ag-charts-annotations__line-stroke-width-menu"});break}case"line-color":case"fill-color":case"text-color":{this.toolbar.toggleActiveButtonByIndex(t.index),this.colorPicker.show({color:s?.getDefaultColor(t.value),opacity:s?.getDefaultOpacity(t.value),sourceEvent:e.sourceEvent,hasMultiColorOption:"isMultiColor"in s,isMultiColor:"isMultiColor"in s&&s?.isMultiColor,onChange:s==null?void 0:this.onColorPickerChange.bind(this,t.value,s),onChangeHide:(n=>{this.events.emit("saved-color",{type:s.type,colorPickerType:t.value,color:s.getDefaultColor(n)})}).bind(this,t.value)});break}case"text-size":{const n=Va(s)?s.fontSize:void 0;this.textSizeMenu.show(i,{items:iP,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsTextSize"),value:n,onPress:o=>this.onTextSizeMenuPress(o,s),class:"ag-charts-annotations__text-size-menu"});break}case"delete":{this.events.emit("pressed-delete",null);break}case"lock":{s.locked=!s.locked,this.refreshButtons(s),this.events.emit("pressed-lock",{locked:s.locked});break}case"settings":{this.toolbar.toggleActiveButtonByIndex(t.index),this.events.emit("pressed-settings",e);break}}}onToolbarMoved(e){const{buttonBounds:t,popoverBounds:i}=e,s={x:i.x,y:i.y+i.height+4},n={y:i.y-4};this.colorPicker.setAnchor(s,n);for(const[o,a]of t.entries()){const r=this.visibleButtons.at(o);if(!r)continue;const l={x:a.x,y:a.y+a.height-1},c={y:a.y};switch(r.value){case"line-stroke-width":this.lineStrokeWidthMenu.setAnchor(l,c);break;case"line-style-type":this.lineStyleTypeMenu.setAnchor(l,c);break;case"text-size":this.textSizeMenu.setAnchor(l,c);break}}}onColorPickerChange(e,t,i,s,n,o){this.events.emit("updated-color",{type:t.type,colorPickerType:e,colorOpacity:i,color:s,opacity:n,isMultiColor:o}),this.updateColorPickerColor(e,i,n,o)}onTextSizeMenuPress(e,t){if(!Rk(t))return;const i=e.value;this.events.emit("updated-font-size",{type:t.type,fontSize:i}),this.textSizeMenu.hide(),this.updateFontSize(i)}onLineStyleTypeMenuPress(e,t){if(!ec(t))return;const i=e.value;this.events.emit("updated-line-style",{type:t.type,lineStyleType:i}),this.lineStyleTypeMenu.hide(),this.updateLineStyleType(e)}onLineStrokeWidthMenuPress(e,t){if(!ec(t))return;const i=e.value;this.events.emit("updated-line-width",{type:t.type,strokeWidth:i}),this.lineStrokeWidthMenu.hide(),this.updateStrokeWidth(e)}refreshButtons(e){const t=e.locked??!1;for(const[i,s]of this.visibleButtons.entries())s&&(s.value==="lock"?(this.toolbar.toggleSwitchCheckedByIndex(i,t),this.updateButtonByIndex(i,t?s.checkedOverrides.toJson():s.toJson())):this.toolbar.toggleButtonEnabledByIndex(i,!t));Rk(e)&&this.updateFontSize(e.fontSize),this.updateColors(e),this.updateLineStyles(e)}updateLineStyles(e){if(!ec(e))return;const t=e.strokeWidth??1,i=kf(e.lineDash,e.lineStyle);this.updateStrokeWidth({strokeWidth:t,value:t,label:String(t)}),this.updateLineStyleType(Cf.find(s=>s.value===i)??Cf[0])}updateButtonByValue(e,t){const i=this.visibleButtons.findIndex(s=>s.value===e);i!==-1&&this.updateButtonByIndex(i,t)}updateButtonByIndex(e,t){const i=this.visibleButtons.at(e);i&&this.toolbar.updateButtonByIndex(e,{...i.toJson(),...t,value:t.value??i.value})}};g([m],zk.prototype,"enabled",2),g([m],zk.prototype,"buttons",2);var mi=class extends he{constructor(e){const t=({context:i})=>{this.node?.drag(this.datum,this.offset,i,this.snapping),e.update()};super("idle",{idle:{dragStart:{target:"dragging",action:({offset:i,context:s})=>{this.hasMoved=!1,this.dragStart=i,this.offset=i,this.node?.dragStart(this.datum,i,s)}}},dragging:{keyDown:t,keyUp:t,drag:({offset:i,context:s})=>{this.hasMoved=H.lengthSquared(H.sub(i,this.dragStart))>0,this.offset=i,this.node?.drag(this.datum,i,s,this.snapping),e.update()},dragEnd:{target:he.parent,action:()=>{this.node?.stopDragging(),this.hasMoved&&e.recordAction("Move annotation"),e.update()}}}}),this.debug=Me.create(!0,"annotations"),this.hasMoved=!1,this.snapping=!1}};g([it()],mi.prototype,"snapping",2),g([it()],mi.prototype,"datum",2),g([it()],mi.prototype,"node",2);var tc=class extends Pk{constructor(){super(...arguments),this.type="arrow-down"}static is(e){return fe(e)&&e.type==="arrow-down"}};g([m],tc.prototype,"type",2);var ep=class extends L.Marker{isPointInPath(e,t){return this.updatePathIfDirty(),this.path.closedPath&&this.path.isPointInPath(e,t)}},sP=class s_ extends L.Group{constructor(){super(...arguments),this.active=!1,this.locked=!1,this.visible=!1,this.zIndex=1}drag(t){const{handle:i,locked:s}=this;return s?{point:{x:i.x,y:i.y},offset:{x:0,y:0}}:{point:t,offset:{x:t.x-i.x,y:t.y-i.y}}}toggleActive(t){this.active=t,t||(this.handle.strokeWidth=s_.INACTIVE_STROKE_WIDTH)}toggleHovered(t){this.glow.visible=!this.locked&&t,this.glow.dirtyPath=!0}toggleDragging(t){this.locked||(this.handle.visible=!t,this.glow.visible=this.glow.visible&&!t,this.handle.dirtyPath=!0,this.glow.dirtyPath=!0)}toggleLocked(t){this.locked=t}getCursor(){}containsPoint(t,i){return this.handle.containsPoint(t,i)}};sP.INACTIVE_STROKE_WIDTH=2;var ic=sP,Bk=class n_ extends ic{constructor(){super(),this.handle=new ep({shape:"circle"}),this.glow=new ep({shape:"circle"}),this.append([this.handle]),this.handle.size=n_.HANDLE_SIZE,this.handle.strokeWidth=ic.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2}update(t){this.handle.setProperties({...t,strokeWidth:ic.INACTIVE_STROKE_WIDTH})}drag(t){return{point:t,offset:{x:0,y:0}}}};Bk.HANDLE_SIZE=7,Bk.GLOW_SIZE=9;var sc=Bk,Nb=class bn extends ic{constructor(){super(),this.handle=new L.Rect,this.glow=new L.Rect,this.gradient="horizontal",this.append([this.glow,this.handle]),this.handle.cornerRadius=bn.CORNER_RADIUS,this.handle.width=bn.HANDLE_SIZE,this.handle.height=bn.HANDLE_SIZE,this.handle.strokeWidth=ic.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2,this.glow.cornerRadius=bn.CORNER_RADIUS,this.glow.width=bn.GLOW_SIZE,this.glow.height=bn.GLOW_SIZE,this.glow.strokeWidth=0,this.glow.fillOpacity=.2,this.glow.zIndex=1,this.glow.visible=!1}toggleLocked(t){if(super.toggleLocked(t),t){const i=(bn.HANDLE_SIZE-sc.HANDLE_SIZE)/2;this.handle.cornerRadius=1,this.handle.fill=this.handle.stroke,this.handle.strokeWidth=0,this.handle.x+=i,this.handle.y+=i,this.handle.width=sc.HANDLE_SIZE,this.handle.height=sc.HANDLE_SIZE,this.glow.width=sc.GLOW_SIZE,this.glow.height=sc.GLOW_SIZE}else this.handle.cornerRadius=bn.CORNER_RADIUS,this.handle.width=bn.HANDLE_SIZE,this.handle.height=bn.HANDLE_SIZE,this.glow.width=bn.GLOW_SIZE,this.glow.height=bn.GLOW_SIZE,this.cachedStyles&&this.handle.setProperties(this.cachedStyles)}update(t){if(this.cachedStyles={...t},this.active||delete t.strokeWidth,this.locked){delete t.fill,delete t.strokeWidth;const i=(bn.HANDLE_SIZE-sc.HANDLE_SIZE)/2;t.x-=i,t.y-=i,this.cachedStyles.x-=i,this.cachedStyles.y-=i}this.handle.setProperties(t),this.glow.setProperties({...t,x:(t.x??this.glow.x)-2,y:(t.y??this.glow.y)-2,strokeWidth:0,fill:t.stroke})}drag(t){return this.locked?{point:t,offset:{x:0,y:0}}:this.gradient==="vertical"?{point:{x:t.x,y:this.handle.y},offset:{x:t.x-this.handle.x,y:0}}:{point:{x:this.handle.x,y:t.y},offset:{x:0,y:t.y-this.handle.y}}}getCursor(){if(!this.locked)return this.gradient==="vertical"?"col-resize":"row-resize"}};Nb.HANDLE_SIZE=12,Nb.GLOW_SIZE=16,Nb.CORNER_RADIUS=4;var tp=Nb,_k=class am extends ic{constructor(){super(),this.handle=new ep({shape:"circle"}),this.glow=new ep({shape:"circle"}),this.append([this.glow,this.handle]),this.handle.size=am.HANDLE_SIZE,this.handle.strokeWidth=ic.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2,this.glow.size=am.GLOW_SIZE,this.glow.strokeWidth=0,this.glow.fillOpacity=.2,this.glow.zIndex=1,this.glow.visible=!1}toggleLocked(t){super.toggleLocked(t),t?(this.handle.fill=this.handle.stroke,this.handle.strokeWidth=0,this.handle.size=sc.HANDLE_SIZE,this.glow.size=sc.GLOW_SIZE):(this.handle.size=am.HANDLE_SIZE,this.glow.size=am.GLOW_SIZE,this.cachedStyles&&this.handle.setProperties(this.cachedStyles))}update(t){this.cachedStyles={...t},this.active||delete t.strokeWidth,this.locked&&(delete t.fill,delete t.strokeWidth),this.handle.setProperties(t),this.glow.setProperties({...t,strokeWidth:0,fill:t.stroke})}getCursor(){return"pointer"}};_k.HANDLE_SIZE=11,_k.GLOW_SIZE=17;var Jt=_k,Yi=class extends L.Group{constructor(){super(...arguments),this.name="AnnotationScene",this.zIndex=12}static isCheck(e,t){return fe(e)&&Object.hasOwn(e,"type")&&e.type===t}toggleHovered(e,t,i){i!==!0&&this.toggleHandles(e||t)}computeBBoxWithoutHandles(){return L.Transformable.toCanvas(this,L.Group.computeChildrenBBox(this.excludeChildren({instance:ic})))}updateNode(e,t,i){if(!i&&t){t.remove();return}return i&&t==null&&(t=new e,this.appendChild(t)),t}},{ContinuousScale:IZ}=L;function Lf(e,t,i=!1,s,n=1){if(!i)return en(e,t);const o=s?Qt(s,t):H.origin();return en(Ob(e,o,n),t)}function Ob(e,t,i){const s=H.sub(e,t),n=mt(i),o=Math.round(H.angle(s)/n)*n;return H.rotate(s,o,t)}function Eb(e,t){const i={};for(const[s,n]of ht(e))i[s]=Qt(n,t);return i}function $r(e,t,i,s={overflowContinuous:0,translateVectors:void 0,invertYVectors:void 0,snap:void 0}){const{xAxis:n,yAxis:o}=i,a=Object.keys(e),r=[],l=[],c=new Set(s.translateVectors??a),h=new Set(s.invertYVectors??[]),d=new Set([...c,...h]),u=H.multiply(t,H.from(1,-1));for(const x of a)d.has(x)&&(e[x]=H.add(e[x],h.has(x)?u:t),s.snap&&(e[x]=Ob(e[x],s.snap.vectors[x],s.snap.angle))),r.push(n.getRangeOverflow(e[x].x)),l.push(o.getRangeOverflow(e[x].y));const p=(x,v)=>Math.abs(x)-Math.abs(v),f=(x,v,S)=>s.overflowContinuous===0||!IZ.is(x)?S.toSorted(p).at(-1)??0:a.length===d.size?S.toSorted(p).at(-s.overflowContinuous-1)??0:S.filter(D=>D!==0).length<=s.overflowContinuous?0:S.filter((D,k)=>D!==0&&Math.abs(D)<=Math.abs(v)&&d.has(a[k])).toSorted(p).at(-1)??0,y=H.from(f(n.scale,t.x,r),f(o.scale,t.y,l));if(!H.equal(y,H.origin()))for(const x of a)d.has(x)&&(e[x]=H.round(H.sub(e[x],y),4));const b={};for(const x of a)b[x]=en(e[x],i);return b}var nP=class extends Yi{constructor(){super(...arguments),this.handle=new Jt,this.anchor={x:0,y:0,position:"above"}}update(e,t){const i=Qt(e,t);this.updateHandle(e,i),this.anchor=this.updateAnchor(e,i,t)}dragStart(e,t,i){this.dragState={offset:t,...Eb({handle:e},i)}}drag(e,t,i){const{dragState:s}=this;if(!e.isWriteable()||!s)return;const{point:n}=$r({point:s.handle},H.sub(t,s.offset),i);e.x=n.x,e.y=n.y}translate(e,t,i){if(!e.isWriteable())return;const{point:s}=$r({point:Qt(e,i)},t,i);e.x=s.x,e.y=s.y}toggleHandles(e){this.handle.visible=!!e,this.handle.toggleHovered(this.activeHandle==="handle")}toggleActive(e){this.toggleHandles(e),this.handle.toggleActive(e)}stopDragging(){this.handle.toggleDragging(!1)}copy(e,t,i){const s=Qt(e,i),n=en({x:s.x-30,y:s.y-30},i);return t.x=n.x,t.y=n.y,t}getAnchor(){return this.anchor}getCursor(){return"pointer"}containsPoint(e,t){const{handle:i}=this;return this.activeHandle=void 0,i.containsPoint(e,t)?(this.activeHandle="handle",!0):!1}getNodeAtCoords(e,t){if(this.handle.containsPoint(e,t))return"handle"}updateHandle(e,t,i){const{x:s,y:n}=this.getHandleCoords(e,t,i),o=this.getHandleStyles(e);this.handle.update({...o,x:s,y:n}),this.handle.toggleLocked(e.locked??!1)}updateAnchor(e,t,i){const s=this.getHandleCoords(e,t);return{x:s.x+i.seriesRect.x,y:s.y+i.seriesRect.y,position:this.anchor.position}}getHandleCoords(e,t,i){return{x:t.x,y:t.y}}getHandleStyles(e){return{fill:e.handle.fill,stroke:e.handle.stroke,strokeOpacity:e.handle.strokeOpacity,strokeWidth:e.handle.strokeWidth}}},oP=class extends nP{constructor(){super(),this.append([this.handle])}update(e,t){super.update(e,t);const i=Qt(e,t);this.updateShape(e,i)}updateShape(e,t){this.updateShapeStyles(e),this.updateShapePath(e,t)}updateShapeStyles(e){const{shape:t}=this;t.fill=e.fill,t.fillOpacity=e.fillOpacity??1}updateShapePath(e,t){const{shape:i}=this;i.x=t.x,i.y=t.y,i.size=e.size}containsPoint(e,t){return super.containsPoint(e,t)||this.shape.containsPoint(e,t)}getNodeAtCoords(e,t){return this.shape.containsPoint(e,t)?"shape":super.getNodeAtCoords(e,t)}},aP=[[.5,0],[1,.5],[.75,.5],[.75,1],[.25,1],[.25,.5],[0,.5]];function rP(e){L.drawMarkerUnitPolygon(e,aP)}rP.anchor={x:.5,y:0};var Pb=class extends oP{constructor(){super(),this.type="arrow-up",this.shape=new ep({shape:rP}),this.append([this.shape])}static is(e){return Yi.isCheck(e,"arrow-up")}getHandleCoords(e,t){const i=Jt.HANDLE_SIZE/2,s=super.getHandleCoords(e,t);return s.y-=i,s}},kZ=aP.map(([e,t])=>[e,1-t]);function lP(e){L.drawMarkerUnitPolygon(e,kZ)}lP.anchor={x:.5,y:1};var Rb=class extends oP{constructor(){super(),this.type="arrow-down",this.shape=new ep({shape:lP}),this.append([this.shape])}static is(e){return Yi.isCheck(e,"arrow-down")}updateAnchor(e,t,i){const s=super.updateAnchor(e,t,i);return s.y-=e.size,s}getHandleCoords(e,t){const i=Jt.HANDLE_SIZE/2,s=super.getHandleCoords(e,t);return s.y+=i,s}},Vk=class extends he{constructor(e){const t=({point:s})=>{const n=this.createDatum();n.set({x:s.x,y:s.y}),e.create(n)},i=()=>{this.node?.toggleActive(!0),e.showAnnotationOptions(),e.update()};super("start",{start:{click:{target:"waiting-first-render",action:t},drag:{target:"waiting-first-render",action:t},cancel:he.parent,reset:he.parent},"waiting-first-render":{render:{target:he.parent,action:i}}}),this.debug=Me.create(!0,"annotations")}};g([it()],Vk.prototype,"node",2);var AZ=class extends Vk{createDatum(){return new tc}},cP={type:"arrow-down",datum:tc,scene:Rb,isDatum:tc.is,translate:(e,t,i,s)=>{tc.is(t)&&Rb.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(tc.is(t)&&tc.is(i)&&Rb.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{tc.is(t)&&Rb.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new AZ({...e,create:t("arrow-down")}),dragState:e=>new mi(e)},nc=class extends Pk{constructor(){super(...arguments),this.type="arrow-up"}static is(e){return fe(e)&&e.type==="arrow-up"}};g([m],nc.prototype,"type",2);var CZ=class extends Vk{createDatum(){return new nc}},hP={type:"arrow-up",datum:nc,scene:Pb,isDatum:nc.is,translate:(e,t,i,s)=>{nc.is(t)&&Pb.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(nc.is(t)&&nc.is(i)&&Pb.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{nc.is(t)&&Pb.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new CZ({...e,create:t("arrow-up")}),dragState:e=>new mi(e)},dP=class extends Yi{constructor(){super(...arguments),this.overflowContinuous=0}extendLine({x1:e,y1:t,x2:i,y2:s},n,o){const a={x1:e,y1:t,x2:i,y2:s};if(!n.extendStart&&!n.extendEnd)return a;const[r,l]=q5(a,o.yAxis.bounds),c=a.x2<a.x1,h=a.y1>=a.y2,d=a.x2===a.x1;return n.extendEnd&&(d?a.y2=h?l.y:r.y:(a.x2=c?r.x:l.x,a.y2=c?r.y:l.y)),n.extendStart&&(d?a.y1=h?r.y:l.y:(a.x1=c?l.x:r.x,a.y1=c?l.y:r.y)),a}dragStart(e,t,i){this.dragState={offset:t,...Eb({start:e.start,end:e.end},i)}}drag(e,t,i,s){e.isWriteable()&&(this.activeHandle?this.dragHandle(e,t,i,s):this.dragAll(e,t,i))}dragAll(e,t,i){const{dragState:s}=this;s&&this.translatePoints(e,s.start,s.end,H.sub(t,s.offset),i)}translate(e,t,i){e.isWriteable()&&this.translatePoints(e,Qt(e.start,i),Qt(e.end,i),t,i)}copy(e,t,i){const s=Js(e,i);if(!s)return;const n=this.computeBBoxWithoutHandles(),o={x:-n.width/2,y:-n.height/2};return this.translatePoints(t,ke.start(s),ke.end(s),o,i),t}translatePoints(e,t,i,s,n){const o=this.getTranslatePointsVectors(t,i),a=$r(o,s,n,{overflowContinuous:this.overflowContinuous});e.start.x=a.start.x,e.end.x=a.end.x,e.start.y=a.start.y,e.end.y=a.end.y}getTranslatePointsVectors(e,t){return{start:e,end:t}}},Gk=class extends dP{constructor(){super(...arguments),this.start=new Jt,this.end=new Jt,this.anchor={x:0,y:0,position:"above"}}update(e,t){const i=Js(e,t);i!=null&&(this.updateHandles(e,i),this.updateAnchor(e,i,t))}toggleHandles(e){if(typeof e=="boolean")this.start.visible=e,this.end.visible=e;else for(const[t,i]of ht(e))this[t].visible=i;this.start.toggleHovered(this.activeHandle==="start"),this.end.toggleHovered(this.activeHandle==="end")}toggleActive(e){this.toggleHandles(e),this.start.toggleActive(e),this.end.toggleActive(e)}dragHandle(e,t,i,s){const{activeHandle:n,dragState:o}=this;if(!n||!o)return;this[n].toggleDragging(!0);const a=n==="start"?"end":"start",r=s?{vectors:{[n]:Qt(e[a],i)},angle:e.snapToAngle}:void 0,{[n]:l}=$r({[n]:o[n]},H.sub(t,o.offset),i,{overflowContinuous:0,snap:r});e[n].x=l.x,e[n].y=l.y}stopDragging(){this.start.toggleDragging(!1),this.end.toggleDragging(!1)}getAnchor(){return this.anchor}getCursor(){return"pointer"}containsPoint(e,t){const{start:i,end:s}=this;return this.activeHandle=void 0,i.containsPoint(e,t)?(this.activeHandle="start",!0):s.containsPoint(e,t)?(this.activeHandle="end",!0):!1}getNodeAtCoords(e,t){if(this.start.containsPoint(e,t)||this.end.containsPoint(e,t))return"handle"}updateHandles(e,t,i){this.start.update({...this.getHandleStyles(e,"start"),...this.getHandleCoords(e,t,"start")}),this.end.update({...this.getHandleStyles(e,"end"),...this.getHandleCoords(e,t,"end",i)}),this.start.toggleLocked(e.locked??!1),this.end.toggleLocked(e.locked??!1)}updateAnchor(e,t,i,s){this.anchor={x:t.x1+i.seriesRect.x,y:t.y1+i.seriesRect.y,position:this.anchor.position}}getHandleCoords(e,t,i,s){return i==="start"?ke.start(t):ke.end(t)}getHandleStyles(e,t){return{fill:e.handle.fill,stroke:e.handle.stroke,strokeOpacity:e.handle.strokeOpacity,strokeWidth:e.handle.strokeWidth}}},LZ=class extends Gk{constructor(){super(...arguments),this.label=new L.Text({zIndex:1}),this.anchor={x:0,y:0,position:"above-left"}}setTextInputBBox(e){this.textInputBBox=e,this.markDirty("TextualStartEndScene")}update(e,t){const i=Js(e,t);if(i==null)return;const s=this.getTextBBox(e,i);this.updateLabel(e,s,i),this.updateHandles(e,i,s),this.updateShape(e,s,i),this.updateAnchor(e,i,t,s)}containsPoint(e,t){return super.containsPoint(e,t)||this.label.containsPoint(e,t)}getNodeAtCoords(e,t){return this.label.containsPoint(e,t)?"text":super.getNodeAtCoords(e,t)}getTextBBox(e,t){const{text:i}=e.getText();return Ek(e,i,ke.end(t),this.textInputBBox)}updateLabel(e,t,i){const{text:s,isPlaceholder:n}=e.getText();UE(this.label,s,n,e,this.getLabelCoords(e,t,i))}updateShape(e,t,i){}getLabelCoords(e,t,i){return ke.end(i)}getHandleStyles(e,t){return{...super.getHandleStyles(e,t),stroke:e.handle.stroke??e.color}}},{drawCorner:wZ,Path:TZ}=L,Fb=class extends LZ{constructor(){super(),this.type="callout",this.shape=new TZ,this.append([this.shape,this.label,this.start,this.end])}static is(e){return Yi.isCheck(e,"callout")}drag(e,t,i,s){e.isWriteable()&&(this.activeHandle==="end"?this.dragHandle(e,t,i,s):this.dragAll(e,t,i))}getLabelCoords(e,t,i){const s=e.getPadding(),{bodyBounds:n={x:0,y:0,width:0,height:0}}=this.getDimensions(e,t,i)??{};return{x:n.x+s.left,y:n.y-s.bottom}}getHandleStyles(e,t){return t==="start"?{fill:e.handle.fill,stroke:e.handle.stroke??e.stroke,strokeOpacity:e.handle.strokeOpacity,strokeWidth:e.handle.strokeWidth}:{fill:void 0,strokeWidth:0}}updateAnchor(e,t,i,s){const{bodyBounds:n}=this.getDimensions(e,s,t)??{},o=n??s;this.anchor={x:o.x+i.seriesRect.x,y:o.y+i.seriesRect.y-o.height,position:this.anchor.position}}updateShape(e,t,i){const{shape:s}=this;s.fill=e.fill,s.fillOpacity=e.fillOpacity??1,s.stroke=e.stroke,s.strokeWidth=e.strokeWidth??1,s.strokeOpacity=e.strokeOpacity??1;const{tailPoint:n,bodyBounds:o}=this.getDimensions(e,t,i)??{};!n||!o||this.updatePath(n,o)}updatePath(e,t){const{x:i,y:s}=e,{x:n,y:o,width:a,height:r}=t,l=o-r,c=n+a,h=this.calculateCalloutPlacement({x:i,y:s},t),d=8,u=[{coordinates:{x0:n,x1:n+d,y0:l+d,y1:l,cx:h==="topLeft"?i:n+d,cy:h==="topLeft"?s:l+d},type:h==="topLeft"?"calloutCorner":"corner"},{coordinates:{x0:n+d,x1:c-d,y0:l,y1:l,cx:i,cy:s},type:h==="top"?"calloutSide":"side"},{coordinates:{x0:c-d,x1:c,y0:l,y1:l+d,cx:h==="topRight"?i:c-d,cy:h==="topRight"?s:l+d},type:h==="topRight"?"calloutCorner":"corner"},{coordinates:{x0:c,x1:c,y0:l+d,y1:o-d,cx:i,cy:s},type:h==="right"?"calloutSide":"side"},{coordinates:{x0:c,x1:c-d,y0:o-d,y1:o,cx:h==="bottomRight"?i:c-d,cy:h==="bottomRight"?s:o-d},type:h==="bottomRight"?"calloutCorner":"corner"},{coordinates:{x0:c-d,x1:n+d,y0:o,y1:o,cx:i,cy:s},type:h==="bottom"?"calloutSide":"side"},{coordinates:{x0:n+d,x1:n,y0:o,y1:o-d,cx:h==="bottomLeft"?i:n+d,cy:h==="bottomLeft"?s:o-d},type:h==="bottomLeft"?"calloutCorner":"corner"},{coordinates:{x0:n,x1:n,y0:o-d,y1:l+d,cx:i,cy:s},type:h==="left"?"calloutSide":"side"}],{path:p}=this.shape;p.clear(),p.moveTo(n,l+d);for(const{coordinates:f,type:y}of u)this.drawPath(p,f,d,y);p.closePath()}drawPath(e,{x0:t,y0:i,x1:s,y1:n,cx:o,cy:a},r,l){switch(l){case"calloutCorner":{e.lineTo(o,a),e.lineTo(s,n);break}case"corner":{wZ(e,{x0:t,x1:s,y0:i,y1:n,cx:o,cy:a},r,!1);break}case"calloutSide":{if(t===s){const h=i>n?-1:1,d=Math.min(i,n)+Math.abs(i-n)/2;e.lineTo(t,d-6*h),e.lineTo(o,a),e.lineTo(t,d+6*h),e.lineTo(s,n)}else{const h=t>s?-1:1,d=Math.min(t,s)+Math.abs(s-t)/2;e.lineTo(d-6*h,i),e.lineTo(o,a),e.lineTo(d+6*h,i),e.lineTo(s,n)}break}case"side":default:{e.lineTo(s,n);break}}}calculateCalloutPlacement(e,t){const i=t.x+t.width,s=t.y-t.height;let n,o;return e.x>i?n="right":e.x<t.x&&(n="left"),e.y>t.y?o="bottom":e.y<s&&(o="top"),n&&o?`${o}${n[0].toUpperCase()}${n.substring(1)}`:o??n}getDimensions(e,t,i){const{fontSize:s}=e,n=e.getPadding(),o=n.left+n.right,a=n.top+n.bottom,r=t.width+o,l=Math.max(t.height+a,s+a);return{tailPoint:{x:i.x1,y:i.y1},bodyBounds:{x:t.x,y:t.y,width:r,height:l}}}containsPoint(e,t){const{start:i,end:s,shape:n}=this;if(this.activeHandle=void 0,i.containsPoint(e,t))return this.activeHandle="start",!0;const o=s.containsPoint(e,t)||n.containsPoint(e,t);return o&&(this.activeHandle="end"),o}};function Hk({key:e}){return e==="Escape"}function jk({key:e,shiftKey:t}){return!t&&e==="Enter"}var Wk=class extends he{constructor(e){const t=({point:u})=>{const p=this.createDatum();p.set({start:u,end:u,visible:!0}),e.create(p)},i=()=>{const{node:u}=this;u?.toggleActive(!0),u?.toggleHandles({start:!0})},s=()=>{e.showTextInput(),this.datum&&(this.datum.visible=!1)},n=()=>{e.hideTextInput(),this.datum&&(this.datum.visible=!0),e.deselect()},o=u=>{this.node?.setTextInputBBox(u),e.update()},a=({point:u})=>{const{datum:p,node:f}=this;p?.set({end:u}),f?.toggleActive(!0),f?.toggleHandles({end:!1}),e.update()},r=()=>{e.showAnnotationOptions(),this.node?.toggleHandles({end:!0})},l=({colorPickerType:u,colorOpacity:p,color:f,opacity:y,isMultiColor:b})=>{const{datum:x}=this;x&&(u==="text-color"&&e.updateTextInputColor(f),Tb(x,u,p,f,y,b),e.update())},c=u=>{const{datum:p,node:f}=this;!p||!f||!Va(p)||(p.fontSize=u,e.updateTextInputFontSize(u),e.update())},h=()=>{e.delete()},d=({textInputValue:u,bbox:p})=>{const{datum:f}=this;if(p!=null&&u!=null&&u.length>0){if(!Va(f))return;const y=Cb(f,u,p.width);f?.set({text:y}),e.update(),e.recordAction(`Create ${f?.type} annotation`)}else e.delete()};super("start",{start:{click:{target:"waiting-first-render",action:t},dragStart:{target:"waiting-first-render",action:t},cancel:he.parent,reset:he.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:a,drag:a,click:{target:"edit",action:r},dragEnd:{target:"edit",action:r},reset:{target:he.parent,action:h},cancel:{target:he.parent,action:h}},edit:{onEnter:s,updateTextInputBBox:o,color:l,fontSize:c,textInput:[{guard:Hk,target:he.parent,action:h},{guard:jk,target:he.parent,action:d}],click:{target:he.parent,action:d},dragStart:{target:he.parent,action:d},resize:{target:he.parent,action:d},onExit:n,cancel:{target:he.parent,action:h}}}),this.debug=Me.create(!0,"annotations")}};g([it()],Wk.prototype,"datum",2),g([it()],Wk.prototype,"node",2);var NZ=class extends Wk{createDatum(){return new ea}},uP={type:"callout",datum:ea,scene:Fb,isDatum:ea.is,translate:(e,t,i,s)=>{if(ea.is(t)&&Fb.is(e))return e.translate(t,i,s)},copy:(e,t,i,s)=>{if(ea.is(t)&&ea.is(i)&&Fb.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{ea.is(t)&&Fb.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new NZ({...e,create:t("callout")}),dragState:e=>new mi(e)},$k=class extends nP{constructor(){super(...arguments),this.label=new L.Text({zIndex:1}),this.anchor={x:0,y:0,position:"above-left"}}setTextInputBBox(e){this.textInputBBox=e,this.markDirty("TextualPointScene")}update(e,t){const i=Qt(e,t),s=this.getTextBBox(e,i,t);this.updateLabel(e,s),this.updateHandle(e,i,s),this.updateShape(e,s),this.anchor=this.updateAnchor(e,s,t)}copy(e,t,i){const s=Qt(e,i),n=this.getTextBBox(e,s,i),o=e.getPadding(),a=o.left+o.right,r=o.top+o.bottom,l=(n.width+a)/2,c=n.height+r,h=en({x:s.x-l,y:s.y-c},i);return t.x=h.x,t.y=h.y,t}containsPoint(e,t){const{label:i}=this;return super.containsPoint(e,t)||i.visible&&i.containsPoint(e,t)}getNodeAtCoords(e,t){return this.label.visible&&this.label.containsPoint(e,t)?"text":super.getNodeAtCoords(e,t)}getTextBBox(e,t,i){const{text:s}=e.getText();return Ek(e,s,{x:t.x,y:t.y},this.textInputBBox)}updateLabel(e,t){const{text:i,isPlaceholder:s}=e.getText();UE(this.label,i,s,e,this.getLabelCoords(e,t),this.getTextBaseline(e))}updateShape(e,t){}updateAnchor(e,t,i){return{x:t.x+i.seriesRect.x,y:t.y+i.seriesRect.y-t.height,position:this.anchor.position}}getLabelCoords(e,t){return t}getTextBaseline(e){return e.position=="center"?"middle":e.position}getHandleCoords(e,t,i){return i}getHandleStyles(e){const t=super.getHandleStyles(e);return t.stroke=e.handle.stroke??e.color,t}},{drawCorner:Uk}=L,zb=class extends $k{constructor(){super(),this.type="comment",this.shape=new L.Path,this.append([this.shape,this.label,this.handle])}static is(e){return Yi.isCheck(e,"comment")}updateShape(e,t){const{shape:i}=this;i.fill=e.fill,i.fillOpacity=e.fillOpacity??1,i.stroke=e.stroke??"transparent",i.strokeWidth=e.strokeWidth??1,i.strokeOpacity=e.strokeOpacity??1,this.updatePath(e,t)}getLabelCoords(e,t){const i=e.getPadding();return{x:t.x+i.left,y:t.y-i.bottom}}getHandleStyles(e){return{fill:e.handle.fill,stroke:e.handle.stroke??e.stroke??e.fill,strokeOpacity:e.handle.strokeOpacity,strokeWidth:e.handle.strokeWidth}}updateAnchor(e,t,i){const s=super.updateAnchor(e,t,i),n=e.getPadding();return s.y-=n.bottom+n.top,s}updatePath(e,t){const i=e.getPadding(),{x:s,y:n}=t;let{width:o,height:a}=t;const{fontSize:r}=e,l=i.left+i.right,c=i.top+i.bottom;o=o+l,a=Math.max(a+c,r+c);const h=n-a,d=s+o,u=(Mn(r,Ab)+c)/2,{path:p}=this.shape;p.clear(),p.moveTo(s,n),p.lineTo(s,h+u),Uk(p,{x0:s,x1:s+u,y0:h+u,y1:h,cx:s+u,cy:h+u},u,!1),p.lineTo(d-u,h),Uk(p,{x0:d-u,x1:d,y0:h,y1:h+u,cx:d-u,cy:h+u},u,!1),p.lineTo(d,n-u),Uk(p,{x0:d,x1:d-u,y0:n-u,y1:n,cx:d-u,cy:n-u},u,!1),p.closePath()}containsPoint(e,t){return super.containsPoint(e,t)||this.shape.containsPoint(e,t)}},wf=class extends he{constructor(e){const t=({point:h})=>{const d=this.createDatum();d.set({x:h.x,y:h.y}),e.create(d)},i=()=>{this.node?.toggleActive(!0),e.showAnnotationOptions(),e.update()},s=()=>{e.showTextInput(),this.datum&&(this.datum.visible=!1)},n=()=>{e.hideTextInput(),this.datum&&(this.datum.visible=!0),e.deselect()},o=h=>{this.node?.setTextInputBBox(h),e.update()},a=({colorPickerType:h,colorOpacity:d,color:u,opacity:p,isMultiColor:f})=>{this.datum&&(h==="text-color"&&e.updateTextInputColor(u),Tb(this.datum,h,d,u,p,f),e.update())},r=h=>{const{datum:d,node:u}=this;!d||!u||!Va(d)||(d.fontSize=h,e.updateTextInputFontSize(h),e.update())},l=()=>{e.delete()},c=({textInputValue:h,bbox:d})=>{if(d!=null&&h!=null&&h.length>0){const{datum:u}=this;if(!Va(u))return;const p=Cb(u,h,d.width);u?.set({text:p}),e.update(),e.recordAction(`Create ${u?.type} annotation`)}else e.delete()};super("start",{start:{click:{target:"waiting-first-render",action:t},dragStart:{target:"waiting-first-render",action:t},cancel:he.parent,reset:he.parent},"waiting-first-render":{render:{target:"edit",action:i}},edit:{onEnter:s,updateTextInputBBox:o,color:a,fontSize:r,textInput:[{guard:Hk,target:he.parent,action:l},{guard:jk,target:he.parent,action:c}],click:{target:he.parent,action:c},dragStart:{target:he.parent,action:c},resize:{target:he.parent,action:c},onExit:n,cancel:{target:he.parent,action:l}}}),this.debug=Me.create(!0,"annotations")}};g([it()],wf.prototype,"datum",2),g([it()],wf.prototype,"node",2);var OZ=class extends wf{createDatum(){return new za}},pP={type:"comment",datum:za,scene:zb,isDatum:za.is,translate:(e,t,i,s)=>{za.is(t)&&zb.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(za.is(t)&&za.is(i)&&zb.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{za.is(t)&&zb.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new OZ({...e,create:t("comment")}),dragState:e=>new mi(e)},{calculateLabelTranslation:EZ}=L,gP=class extends L.Group{constructor(){super({name:"AnnotationAxisLabelGroup"}),this.label=new L.Text({zIndex:1}),this.rect=new L.Rect;const{label:e}=this;e.fontSize=12,e.fontFamily="Verdana, sans-serif",e.fill="black",e.textBaseline="middle",e.textAlign="center",this.append([this.rect,this.label])}update(e){this.updateLabel(e),this.updateRect(e),this.updatePosition(e)}updateLabel({value:e,styles:t,context:i}){const{fontWeight:s,fontSize:n,fontStyle:o,fontFamily:a,textAlign:r,color:l="white",formatter:c}=t,h=c?c({value:e}):i.formatScaleValue(e,"annotation-label");this.label.setProperties({fontWeight:s,fontSize:n,fontStyle:o,fontFamily:a,textAlign:r,fill:l,text:h})}updateRect({styles:e}){const{rect:t}=this,{cornerRadius:i,fill:s,fillOpacity:n,stroke:o,strokeOpacity:a}=e;t.fill=s,t.fillOpacity=n??1,t.stroke=o,t.strokeOpacity=a??1,t.cornerRadius=i??0}updatePosition({x:e,y:t,context:i,styles:{padding:s}}){const{label:n,rect:o}=this,a=n.getBBox()?.clone(),r=s??8,l=s??4,{xTranslation:c,yTranslation:h}=EZ({yDirection:!0,padding:i.labelPadding,position:i.position??"left",bbox:a});a.grow(r,"horizontal"),a.grow(l,"vertical");const d=e+c,u=t+h;n.x=d,n.y=u,o.y=u-Math.round(a.height/2),o.x=d-Math.round(a.width/2),o.height=a.height,o.width=a.width}};gP.className="AxisLabel";var pn=class extends L.Line{constructor(){super(...arguments),this.growCollisionBox=9,this.clipMask=new Map}setProperties(e){return super.setProperties(e),this.updateCollisionBBox(),this}updateCollisionBBox(){const{growCollisionBox:e,strokeWidth:t,x1:i,y1:s,x2:n,y2:o}=this;let a=t+e;a%2===0&&(a+=1);const r=H.from(i,s-Math.floor(a/2)),l=H.from(n,o),c=H.distance(r,l);this.collisionBBox=new L.BBox(r.x,r.y,c,a)}isPointInPath(e,t){const{collisionBBox:i,x1:s,y1:n,x2:o,y2:a}=this;if(!i)return!1;const r=H.from(s,n),l=H.from(o,a),c=H.sub(H.from(e,t),r),h=H.sub(l,r),d=H.rotate(c,H.angle(c,h),r);return i.containsPoint(d.x,d.y)??!1}render(e){const{clipMask:t}=this,{ctx:i}=e;if(t.size===0){super.render(e);return}i.save();try{for(const s of this.clipMask.values()){const{x:n,y:o,radius:a}=s;i.beginPath(),i.rect(0,0,i.canvas.width,i.canvas.height),i.ellipse(n,o,a,a,0,Math.PI*2,0,!0),i.clip()}super.render(e)}finally{i.restore()}}setClipMask(e,t){const i=this.clipMask.get(e);Ln(i,t)!=null&&this.markDirty("CollidableLine"),t?this.clipMask.set(e,t):this.clipMask.delete(e)}},Ih=class extends L.TransformableText{constructor(){super(...arguments),this.growCollisionBox={top:4,right:4,bottom:4,left:4}}isPointInPath(e,t){const i=this.fromParentPoint(e,t),s=this.computeBBoxWithoutTransforms();return s?s.grow(this.growCollisionBox).containsPoint(i.x,i.y):!1}};function ip(e,t,i,s,n,o,a){if(!o||!n||!s){t.setClipMask(e);return}const{alignment:r,position:l}=s,c=mP(i,s.fontSize,a),{point:h,textBaseline:d}=yP(c,l,r);xP(n,o,s,h,c.angle,d);const{x:u,y:p,width:f,height:y}=n.getBBox(),b=H.length(H.from(f,y)),x={x:u+f/2,y:p+y/2,radius:b/2+H.length(c.offset)};return l==="center"?t.setClipMask(e,x):t.setClipMask(e),{clipMask:x,numbers:c}}function fP(e,t,i,s,n,o,a){if(!a||!o)return;const{alignment:r,position:l}=s,[c,h]=t.y1<=i.y1?[t,i]:[i,t];let d=c;l==="bottom"?d=h:l==="inside"&&(d={x1:(c.x1+h.x1)/2,y1:(c.y1+h.y1)/2,x2:(c.x2+h.x2)/2,y2:(c.y2+h.y2)/2});const u=mP(d,s.fontSize,n),{point:p,textBaseline:f}=yP(u,l==="inside"?"center":l,r,e);xP(o,a,s,p,u.angle,f)}function mP(e,t,i){let[s,n]=H.from(e);s.x>n.x&&([s,n]=[n,s]);const o=H.normalized(H.sub(n,s)),a=H.angle(o),r=H.multiply(o,Jt.HANDLE_SIZE/2+(t??14)/2),l=H.multiply(o,(i??2)/2+(t??14)/3);return{left:s,right:n,normal:o,angle:a,inset:r,offset:l}}function yP({left:e,right:t,normal:i,angle:s,inset:n,offset:o},a,r,l){let c;r==="right"?c=H.sub(t,n):r==="center"?c=H.add(e,H.multiply(i,H.distance(e,t)/2)):c=H.add(e,n);let h="bottom";return a==="bottom"?(c=H.rotate(o,s+Math.PI/2,c),h="top"):a==="center"&&!l?h="middle":c=H.rotate(o,s-Math.PI/2,c),{point:c,textBaseline:h}}function xP(e,t,i,s,n,o){e.setProperties({text:t,x:s.x,y:s.y,rotation:n,rotationCenterX:s.x,rotationCenterY:s.y,fill:i.color,fontFamily:i.fontFamily,fontSize:i.fontSize,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textAlign:i.alignment,textBaseline:o})}var oc=class extends Yi{constructor(){super(),this.type="cross-line",this.line=new pn,this.middle=new tp,this.isHorizontal=!1,this.append([this.line,this.middle])}static is(e){return Yi.isCheck(e,"cross-line")}update(e,t){const{seriesRect:i}=t;this.seriesRect=i,this.isHorizontal=Rs.is(e);const s=this.isHorizontal?t.yAxis:t.xAxis,n=this.convertCrossLine(e,s);if(n==null){this.visible=!1;return}this.visible=e.visible??!0,this.visible&&(this.updateLine(e,n),this.updateHandle(e,n),this.updateText(e,n),this.updateAxisLabel(e,s,n))}updateLine(e,t){const{line:i}=this,{lineDashOffset:s,stroke:n,strokeWidth:o,strokeOpacity:a}=e,{x1:r,y1:l,x2:c,y2:h}=t;i.setProperties({x1:r,y1:l,x2:c,y2:h,lineCap:e.getLineCap(),lineDash:e.getLineDash(),lineDashOffset:s,stroke:n,strokeWidth:o,strokeOpacity:a,fillOpacity:0})}updateHandle(e,t){const{middle:i}=this,{locked:s,stroke:n,strokeWidth:o,strokeOpacity:a}=e,r={fill:e.handle.fill,stroke:e.handle.stroke??n,strokeOpacity:e.handle.strokeOpacity??a,strokeWidth:e.handle.strokeWidth??o},l=H.sub(ke.center(t),H.from(i.handle.width/2,i.handle.height/2));i.gradient=this.isHorizontal?"horizontal":"vertical",i.update({...r,...l}),i.toggleLocked(s??!1)}updateText(e,t){this.text=this.updateNode(Ih,this.text,!!e.text.label),ip(this.line.id,this.line,t,e.text,this.text,e.text.label,e.strokeWidth)}createAxisLabel(e){const t=new gP;return e.attachLabel(t),t}updateAxisLabel(e,t,i){this.axisLabel??(this.axisLabel=this.createAxisLabel(t));const{axisLabel:s,seriesRect:n}=this,{direction:o,position:a}=t;if(e.axisLabel.enabled){s.visible=this.visible;const r=a==="left"||a==="top"?ke.start(i):ke.end(i),l=o==="x"?r.x:r.y;if(!t.inRange(l)){s.visible=!1;return}const c=wi(e.value);s.update({...H.add(r,H.required(n)),value:c,styles:e.axisLabel,context:t})}else s.visible=!1}setAxisLabelOpacity(e){this.axisLabel&&(this.axisLabel.opacity=e)}setAxisLabelVisible(e){this.axisLabel&&(this.axisLabel.visible=e)}toggleHandles(e){this.middle.visible=e,this.middle.toggleHovered(this.activeHandle==="middle")}destroy(){super.destroy(),this.axisLabel?.destroy()}toggleActive(e){this.toggleHandles(e),this.middle.toggleActive(e)}dragStart(e,t,i){const s=Rs.is(e)?{x:t.x,y:zr(e.value,i.yAxis)}:{x:zr(e.value,i.xAxis),y:t.y};this.dragState={offset:t,middle:s}}drag(e,t,i){const{activeHandle:s,dragState:n}=this;!e.isWriteable()||!n||(s&&this[s].toggleDragging(!0),this.translatePoint(e,n.middle,H.sub(t,n.offset),i))}translate(e,t,i){if(!e.isWriteable())return;const s=Rs.is(e)?H.from(0,zr(e.value,i.yAxis)):H.from(zr(e.value,i.xAxis),0);this.translatePoint(e,s,t,i)}translatePoint(e,t,i,s){const n=Rs.is(e);n?i.x=0:i.y=0;const{point:o}=$r({point:t},i,s);e.value=n?o.y:o.x}stopDragging(){this.middle.toggleDragging(!1)}copy(e,t,i){const s=Rs.is(e),n=this.isHorizontal?i.yAxis:i.xAxis,o=this.convertCrossLine(e,n);if(!o)return;const a=s?-30:0,r=s?0:-30,l=en({x:o.x1+r,y:o.y1+a},i);return t.set({value:s?l.y:l.x}),t}getCursor(){return this.activeHandle==null?"pointer":this[this.activeHandle].getCursor()}containsPoint(e,t){const{middle:i,line:s,text:n}=this;return this.activeHandle=void 0,i.containsPoint(e,t)?(this.activeHandle="middle",!0):s.isPointInPath(e,t)||!!n?.containsPoint(e,t)}getNodeAtCoords(e,t){if(this.text?.containsPoint(e,t))return"text";if(this.line.isPointInPath(e,t))return"line";if(this.middle.containsPoint(e,t))return"handle"}getAnchor(){const e=this.computeBBoxWithoutHandles();return this.isHorizontal?{x:e.x+e.width/2,y:e.y}:{x:e.x+e.width,y:e.y+e.height/2,position:"right"}}convertCrossLine(e,t){if(e.value==null)return;let i=0,s=0,n,o;const{bounds:a}=t,r=zr(e.value,t);return Rs.is(e)?(n=a.width,s=r,o=r):(i=r,n=r,o=a.height),{x1:i,y1:s,x2:n,y2:o}}},Kk=class extends he{constructor(e,t){const i=({point:n})=>{const o=e==="horizontal",a=o?new Rs:new Ba;a.set({value:o?n.y:n.x}),t.create(a),t.recordAction(`Create ${o?"horizontal-line":"vertical-line"} annotation`)},s=()=>{this.node?.toggleActive(!0),t.showAnnotationOptions(),t.update()};super("start",{start:{click:{target:"waiting-first-render",action:i},drag:{target:"waiting-first-render",action:i},reset:he.parent,cancel:he.parent},"waiting-first-render":{render:{target:he.parent,action:s}}}),this.debug=Me.create(!0,"annotations")}};g([it()],Kk.prototype,"node",2);var bP={type:"horizontal-line",datum:Rs,scene:oc,isDatum:Rs.is,translate:(e,t,i,s)=>{Rs.is(t)&&oc.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(Rs.is(t)&&Rs.is(i)&&oc.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{Rs.is(t)&&oc.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new Kk("horizontal",{...e,create:t("horizontal-line")}),dragState:e=>new mi(e)},vP={type:"vertical-line",datum:Ba,scene:oc,isDatum:Ba.is,translate:(e,t,i,s)=>{Ba.is(t)&&oc.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(Ba.is(t)&&Ba.is(i)&&oc.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{Ba.is(t)&&oc.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new Kk("vertical",{...e,create:t("vertical-line")}),dragState:e=>new mi(e)},SP=class{static updateBackground(e,t,i,s){const{background:n}=this,{seriesRect:o}=s;n.path.clear(!0);const a=ke.from(0,0,o.width,o.height),r=this.getBackgroundPoints(e,t,i,a);for(let c=0;c<r.length;c++){const h=r[c];c===0?n.path.moveTo(h.x,h.y):n.path.lineTo(h.x,h.y)}n.path.closePath(),n.checkPathDirty();const l=this.getBackgroundStyles?.(e)??e.background;n.fill=l.fill,n.fillOpacity=l.fillOpacity??1}},MP=class extends dP{constructor(){super(...arguments),this.handles={},this.overflowContinuous=2,this.topLine=new pn,this.bottomLine=new pn,this.background=new L.Path({zIndex:-1}),this.anchor={x:0,y:0},this.updateBackground=SP.updateBackground.bind(this)}update(e,t){const{locked:i,visible:s}=e,n=Js(e,t),o=Js(e.bottom,t);if(n==null||o==null){this.visible=!1;return}else this.visible=s??!0;const a=this.extendLine(n,e,t),r=this.extendLine(o,e,t);this.updateLines(e,a,r,t,n,o),this.updateHandles(e,n,o),this.updateText(e,n,o),this.updateBackground(e,a,r,t),this.updateAnchor(n,o);for(const l of Object.values(this.handles))l.toggleLocked(i??!1)}toggleHandles(e){const{handles:t}=this;if(typeof e=="boolean"){for(const[i,s]of Object.entries(t))s.visible=e,s.toggleHovered(this.activeHandle===i);return}for(const[i,s]of Object.entries(e)){const n=t[i];n.visible=s??!0,n.toggleHovered(this.activeHandle===i)}}toggleActive(e){this.toggleHandles(e);for(const t of Object.values(this.handles))t.toggleActive(e)}stopDragging(){const{activeHandle:e,handles:t}=this;e!=null&&t[e].toggleDragging(!1)}getAnchor(){return this.anchor}getCursor(){return this.activeHandle==null?"pointer":this.handles[this.activeHandle].getCursor()}containsPoint(e,t){const{handles:i,topLine:s,bottomLine:n,text:o}=this;this.activeHandle=void 0;for(const[a,r]of Object.entries(i))if(r.containsPoint(e,t))return this.activeHandle=a,!0;return s.containsPoint(e,t)||n.containsPoint(e,t)||!!o?.containsPoint(e,t)}getNodeAtCoords(e,t){if(this.text?.containsPoint(e,t))return"text";if(this.topLine.containsPoint(e,t)||this.bottomLine.containsPoint(e,t))return"line";for(const[,i]of Object.entries(this.handles))if(i.containsPoint(e,t))return"handle"}updateAnchor(e,t){const{x:i,y:s}=L.Transformable.toCanvasPoint(this.topLine,(e.x1+e.x2)/2,Math.min(e.y1,e.y2,t.y1,t.y2));this.anchor.x=i,this.anchor.y=s}},Bb=class extends MP{constructor(){super(),this.type="disjoint-channel",this.handles={topLeft:new Jt,topRight:new Jt,bottomLeft:new Jt,bottomRight:new tp},this.append([this.background,this.topLine,this.bottomLine,...Object.values(this.handles)])}static is(e){return Yi.isCheck(e,"disjoint-channel")}dragHandle(e,t,i,s){const{activeHandle:n,handles:o}=this;if(n==null)return;const{offset:a}=o[n].drag(t);o[n].toggleDragging(!0),n==="bottomRight"&&(a.x=0);let r=[],l=[],c=s;switch(n){case"topLeft":r=["topLeft"],l=["bottomLeft"];break;case"bottomLeft":r=["bottomLeft"],l=["topLeft"];break;case"topRight":r=["topRight"],l=["bottomRight"];break;case"bottomRight":r=["bottomLeft","bottomRight"],c=!1;break}const h=Js(e,i),d=Js(e.bottom,i);if(!h||!d)return;const u={topLeft:ke.start(h),topRight:ke.end(h),bottomLeft:ke.start(d),bottomRight:ke.end(d)},p={vectors:{topLeft:u.topRight,bottomLeft:u.bottomRight,topRight:u.topLeft,bottomRight:u.bottomLeft},angle:e.snapToAngle},f=$r(u,a,i,{overflowContinuous:this.overflowContinuous,translateVectors:r,invertYVectors:l,snap:c?p:void 0});e.start.x=f.topLeft.x,e.start.y=f.topLeft.y,e.end.x=f.topRight.x,e.end.y=f.topRight.y,e.startHeight=f.topLeft.y-f.bottomLeft.y,e.endHeight=f.topRight.y-f.bottomRight.y}getTranslatePointsVectors(e,t){const{bottomLeft:i,bottomRight:s,topLeft:n,topRight:o}=this.handles,a=i.getBBox().y-n.getBBox().y,r=s.getBBox().y-o.getBBox().y,l=H.add(e,H.from(0,a)),c=H.add(t,H.from(0,r));return{start:e,end:t,bottomStart:l,bottomEnd:c}}updateLines(e,t,i){const{topLine:s,bottomLine:n}=this,{lineDashOffset:o,stroke:a,strokeOpacity:r,strokeWidth:l}=e,c={lineCap:e.getLineCap(),lineDash:e.getLineDash(),lineDashOffset:o,stroke:a,strokeOpacity:r,strokeWidth:l};s.setProperties({...t,...c}),n.setProperties({...i,...c})}updateHandles(e,t,i){const{handles:{topLeft:s,topRight:n,bottomLeft:o,bottomRight:a}}=this,r={fill:e.handle.fill,stroke:e.handle.stroke??e.stroke,strokeOpacity:e.handle.strokeOpacity??e.strokeOpacity,strokeWidth:e.handle.strokeWidth??e.strokeWidth};s.update({...r,...ke.start(t)}),n.update({...r,...ke.end(t)}),o.update({...r,...ke.start(i)}),a.update({...r,...H.sub(ke.end(i),H.from(a.handle.width/2,a.handle.height/2))})}updateText(e,t,i){this.text=this.updateNode(Ih,this.text,!!e.text.label),fP(!1,t,i,e.text,e.strokeWidth,this.text,e.text.label)}getBackgroundPoints(e,t,i,s){const n=t.x1>t.x2,o=t.y1>t.y2,a=o?s.y2:s.y1,r=o?s.y1:s.y2,l=H.from(t);return e.extendEnd&&t.y2===r&&l.push(H.from(n?s.x1:s.x2,o?s.y1:s.y2)),e.extendEnd&&i.y2===a&&l.push(H.from(n?s.x1:s.x2,o?s.y2:s.y1)),l.push(...H.from(i).reverse()),e.extendStart&&i.y1===r&&l.push(H.from(n?s.x2:s.x1,o?s.y1:s.y2)),e.extendStart&&t.y1===a&&l.push(H.from(n?s.x2:s.x1,o?s.y2:s.y1)),l}},_b=class extends he{constructor(e){const t=({point:l})=>{const c=new xo;c.set({start:l,end:l,startHeight:0,endHeight:0}),e.create(c)},i=()=>{const{node:l}=this;l?.toggleActive(!0),l?.toggleHandles({topLeft:!0,topRight:!1,bottomLeft:!1,bottomRight:!1})},s=({offset:l,context:c})=>{const{datum:h,snapping:d}=this;h&&(h.set({end:Lf(l,c,d,h.start,h.snapToAngle)}),e.update())},n=()=>{this.node?.toggleHandles({topRight:!0}),e.update()},o=({point:l})=>{const{datum:c,node:h}=this,d=wi(c?.end.y),u=wi(c?.start.y),{y:p}=l;if(c==null||!gt(u)||!gt(d)||!gt(p))return;const f=d-(p??0),y=(u-d)*2+f,b={x:c?.start.x,y:u-y},x={x:c?.end.x,y:l.y};h?.toggleHandles({bottomLeft:!0,bottomRight:!0}),!(!e.validatePoint(b,{overflowContinuous:!0})||!e.validatePoint(x,{overflowContinuous:!0}))&&(c.set({startHeight:y,endHeight:f}),e.update())},a=({point:l})=>{const{datum:c,node:h}=this,d=wi(c?.end.y),u=wi(c?.start.y),{y:p}=l;if(c==null||!gt(u)||!gt(d)||!gt(p))return;const f=d-(p??0),y=(u-d)*2+f,b={x:c.start.x,y:u-f},x={x:c.end.x,y:l.y};h?.toggleHandles(!0),!(!e.validatePoint(b,{overflowContinuous:!0})||!e.validatePoint(x,{overflowContinuous:!0}))&&(c.set({startHeight:y,endHeight:f}),e.recordAction("Create disjoint-channel annotation"),e.showAnnotationOptions(),e.update())},r=()=>e.delete();super("start",{start:{click:{target:"waiting-first-render",action:t},drag:{target:"waiting-first-render",action:t},reset:he.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:s,drag:s,click:{target:"height",action:n},dragEnd:{target:"height",action:n},reset:{target:he.parent,action:r},cancel:{target:he.parent,action:r}},height:{hover:o,click:{target:he.parent,action:a},drag:{target:he.parent,action:a},reset:{target:he.parent,action:r},cancel:{target:he.parent,action:r}}}),this.debug=Me.create(!0,"annotations"),this.snapping=!1}};g([it()],_b.prototype,"datum",2),g([it()],_b.prototype,"node",2),g([it()],_b.prototype,"snapping",2);var DP={type:"disjoint-channel",datum:xo,scene:Bb,isDatum:xo.is,translate:(e,t,i,s)=>{xo.is(t)&&Bb.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(xo.is(t)&&xo.is(i)&&Bb.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{xo.is(t)&&Bb.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new _b({...e,create:t("disjoint-channel")}),dragState:e=>new mi(e)},Yk=[0,23.6,38.2,50,61.8,78.6,100],PZ=[161.8,261.8,361.8,423.6],RZ=[...Yk,...PZ],FZ={10:RZ,6:Yk,4:Yk.filter(e=>e!==78.6&&e!==23.6)},zZ=10;function BZ(e,t){const{x2:i,y1:s,y2:n}=e,o=s-n;return t==null?{x1:i,x2:i,y1:n-o,y2:n}:{x1:t.x1,x2:t.x2,y1:t.y2-o,y2:t.y2}}function IP({x1:e,y1:t,x2:i,y2:s},n,o,a,r=10){const l=t-s,c=o?-1:1;let h=a;const d=[];for(const[u,p]of FZ[r].entries()){const f=a+l*(p/100)*c,y=n.yAxis.scaleInvert(f);d.push({id:u,x1:e,x2:i,y1:h,y2:f,tag:p==100?0:1,label:{x1:Math.min(e,i)-zZ,x2:i,y1:f,y2:f,text:`${(p/100).toFixed(3)} (${y.toFixed(2)})`}}),h=f}return d}var kP=class extends Yi{constructor(){super(),this.trendLine=new pn,this.rangeFillsGroup=new L.Group({name:`${this.id}-range-fills`}),this.rangeFillsGroupSelection=L.Selection.select(this.rangeFillsGroup,L.Range),this.rangeStrokesGroup=new L.Group({name:`${this.id}-range-strokes`}),this.rangeStrokesGroupSelection=L.Selection.select(this.rangeStrokesGroup,pn),this.labelsGroup=new L.Group({name:`${this.id}-ranges-labels`}),this.labelsGroupSelection=L.Selection.select(this.labelsGroup,Ih),this.anchor={x:0,y:0,position:"above"},this.append([this.trendLine,this.rangeFillsGroup,this.rangeStrokesGroup,this.labelsGroup])}update(e,t){let i=Js(e,t);if(i==null){this.visible=!1;return}if(i=ke.round(i),this.visible=e.visible??!0,!this.visible)return;this.updateLine(e,i,this.trendLine),this.updateHandles(e,i),this.updateAnchor(e,i,t);const{reverse:s}=e,n=this.extendLine(i,e,t),o=s?n.y1:n.y2,a=s?n.y2:n.y1,r=IP(n,t,e.reverse,o,e.bands);this.updateRanges(e,r,t);const l={...n,y1:a,y2:a};this.updateText(e,l)}extendLine({x1:e,y1:t,x2:i,y2:s},n,o){const a={x1:e,y1:t,x2:i,y2:s};if(!n.extendStart&&!n.extendEnd)return a;const{x:r,width:l}=o.xAxis.bounds;return n.extendEnd&&(a[e>i?"x1":"x2"]=r+l),n.extendStart&&(a[e>i?"x2":"x1"]=r),a}updateLine(e,t,i){if(!t||!i)return;const{lineDashOffset:s,strokeWidth:n,strokeOpacity:o,stroke:a}=e;i.setProperties({...t,lineCap:e.getLineCap(),lineDash:[3,4],lineDashOffset:s,strokeWidth:n,strokeOpacity:o,fillOpacity:0,stroke:a})}updateRangeStrokes(e){const{lineDashOffset:t,strokeWidth:i,strokeOpacity:s,strokes:n,rangeStroke:o,isMultiColor:a}=e;this.rangeStrokesGroupSelection.each((r,{x1:l,x2:c,y2:h,tag:d},u)=>{const p=h,f=a?n[u%n.length]:o;r.setProperties({x1:l,x2:c,y1:p,y2:p,stroke:f,strokeOpacity:s,strokeWidth:i,lineCap:e.getLineCap(),lineDash:e.getLineDash(),lineDashOffset:t,tag:d})})}updateRanges(e,t,i){const s=n=>n.id;this.rangeFillsGroupSelection.update(t,void 0,s),this.rangeStrokesGroupSelection.update(t,void 0,s),this.labelsGroupSelection.update(t,void 0,s),this.updateRangeFills(e),this.updateRangeStrokes(e),this.updateRangeLabels(e,i)}updateRangeFills(e){const{lineDashOffset:t,strokeWidth:i,strokeOpacity:s,strokes:n,rangeStroke:o,showFill:a,isMultiColor:r}=e;this.rangeFillsGroupSelection.each((l,{x1:c,x2:h,y1:d,y2:u},p)=>{const f=r?n[p%n.length]:o;if(!a){l.visible=!1;return}l.setProperties({x1:c,x2:h,y1:d,y2:u,startLine:!1,endLine:!1,stroke:f,strokeOpacity:s,fill:f,fillOpacity:(s??1)*.15,strokeWidth:i,lineCap:e.getLineCap(),lineDash:e.getLineDash(),lineDashOffset:t,visible:!0})})}updateRangeLabels(e,{xAxis:t}){const{rangeStrokesGroupSelection:i}=this,{strokes:s,strokeWidth:n,rangeStroke:o,isMultiColor:a,label:{fontFamily:r,fontSize:l,fontStyle:c,fontWeight:h,color:d}}=e,u={fontFamily:r,fontSize:l,fontStyle:c,fontWeight:h},p=this.checkWithinBounds(t,u,this.labelsGroupSelection.at(0));this.labelsGroupSelection.each((f,y,b)=>{const x=d??(a?s[b%s.length]:o),v=i.at(b);if(!v)return;const{text:S,...M}=y.label;if(p)f.setProperties({...u,text:S,x:M.x1,y:M.y1,textBaseline:"middle",textAlign:"end",fill:x}),ip(f.id,v,M);else{const D={...u,label:S,position:"center",alignment:"left",color:x};ip(f.id,v,M,D,f,S,n)}})}checkWithinBounds(e,t,i){if(!i)return!1;const{text:s,...n}=i.datum.label;i.setProperties({...t,text:s,x:n.x1,y:n.y1,textBaseline:"middle",textAlign:"end"});const{x:o}=i.getBBox();return o>=e.bounds.x&&o<=e.bounds.x+e.bounds.width}updateText(e,t){const i=this.rangeStrokesGroupSelection.selectByTag(0)[0];if(!i)return;const{text:s,strokeWidth:n}=e;this.text=this.updateNode(Ih,this.text,!!s.label),ip(i.id,i,t,s,this.text,s.label,n)}updateAnchor(e,t,i,s){const n=ke.topCenter(t);H.apply(this.anchor,L.Transformable.toCanvasPoint(this.trendLine,n.x,n.y))}containsPoint(e,t){const{trendLine:i,rangeStrokesGroupSelection:s,text:n}=this;let o=!1;return s.each(a=>o||(o=a.isPointInPath(e,t))),o||i.isPointInPath(e,t)||!!n?.containsPoint(e,t)}getNodeAtCoords(e,t){if(this.text?.containsPoint(e,t))return"text";if(this.trendLine.isPointInPath(e,t))return"line"}getHandleStyles(e){return{fill:e.handle.fill,stroke:e.handle.stroke??e.stroke,strokeOpacity:e.handle.strokeOpacity??e.strokeOpacity,strokeWidth:e.handle.strokeWidth??e.strokeWidth}}drag(e,t,i,s){e.isWriteable()&&(this.activeHandle?this.dragHandle(e,t,i,s):this.dragAll(e,t,i))}getAnchor(){return this.anchor}getCursor(){return"pointer"}},{ContinuousScale:AP}=L;function Vb(e,t,i={overflowContinuous:!1},s){if(t.x==null||t.y==null)return s&&j.warnOnce(`${s}requires both an [x] and [y] property, ignoring.`),!1;const{xAxis:n,yAxis:o}=e,a=i.overflowContinuous&&AP.is(n.scale),r=i.overflowContinuous&&AP.is(o.scale),l=a||CP(t.x,n),c=r||CP(t.y,o);if(l&&c)return!0;if(s){let h="x & y domains";l&&(h="y domain"),c&&(h="x domain");const d=wi(t.x),u=wi(t.y);j.warnOnce(`${s}is outside the ${h}, ignoring. - x: [${d}], y: ${u}]`)}return!1}function CP(e,t){const{domain:i}=t.scale,s=wi(e);return i&&s!=null&&t.continuous?s>=i[0]&&s<=i.at(-1):!0}var Gb=class extends kP{constructor(){super(),this.type="fibonacci-retracement-trend-based",this.endRetracementLine=new pn,this.start=new Jt,this.end=new Jt,this.endRetracement=new Jt,this.append([this.endRetracementLine,this.start,this.end,this.endRetracement])}static is(e){return Yi.isCheck(e,"fibonacci-retracement-trend-based")}update(e,t){let{coords1:i,coords2:s}=this.getCoords(e,t);if(i==null||s==null){this.visible=!1;return}if(i=ke.round(i),s=ke.round(s),this.visible=e.visible??!0,!this.visible)return;(e.endRetracement.x==null||e.endRetracement.y==null)&&(s=void 0),this.updateLine(e,i,this.trendLine),this.updateLine(e,s,this.endRetracementLine),this.updateHandles(e,i,s),this.updateAnchor(e,s??i,t);const{reverse:n,bands:o}=e,a=BZ(i,s),r=this.extendLine(a,e,t),l=r.y2,c=r.y1,h=s?IP(r,t,n,l,o):[];this.updateRanges(e,h,t);const d={...r,y1:c,y2:c};this.updateText(e,d)}containsPoint(e,t){const{start:i,end:s,endRetracement:n,endRetracementLine:o}=this;return this.activeHandle=void 0,i.containsPoint(e,t)?(this.activeHandle="start",!0):s.containsPoint(e,t)?(this.activeHandle="end",!0):n.containsPoint(e,t)?(this.activeHandle="endRetracement",!0):o.isPointInPath(e,t)||super.containsPoint(e,t)}getNodeAtCoords(e,t){return this.start.containsPoint(e,t)||this.end.containsPoint(e,t)||this.endRetracement.containsPoint(e,t)?"handle":this.endRetracementLine.isPointInPath(e,t)?"line":super.getNodeAtCoords(e,t)}dragStart(e,t,i){this.dragState={offset:t,...Eb({start:e.start,end:e.end,endRetracement:e.endRetracement},i)}}stopDragging(){this.start.toggleDragging(!1),this.end.toggleDragging(!1),this.endRetracement.toggleDragging(!1)}dragAll(e,t,i){const{dragState:s}=this;s&&this.translatePoints({datum:e,start:s.start,end:s.end,endRetracement:s.endRetracement,translation:H.sub(t,s.offset),context:i})}dragHandle(e,t,i,s){const{activeHandle:n,dragState:o}=this;if(!n||!o)return;this[n].toggleDragging(!0);const a=s?this.snapToAngle(e,t,i):en(this[n].drag(t).point,i);!a||!Vb(i,a)||(e[n].x=a.x,e[n].y=a.y)}snapToAngle(e,t,i){const{activeHandle:s}=this,n=["start","end","endRetracement"];if(!s)return;const o=(n.indexOf(s)+1)%n.length,a=n[o];this[s].toggleDragging(!0);const r=Qt(e[a],i);return en(Ob(t,r,e.snapToAngle),i)}translatePoints({datum:e,start:t,end:i,endRetracement:s,translation:n,context:o}){const a=$r({start:t,end:i,endRetracement:s},n,o,{overflowContinuous:2});e.start.x=a.start.x,e.end.x=a.end.x,e.endRetracement.x=a.endRetracement.x,e.start.y=a.start.y,e.end.y=a.end.y,e.endRetracement.y=a.endRetracement.y}translate(e,t,i){this.translatePoints({datum:e,start:Qt(e.start,i),end:Qt(e.end,i),endRetracement:Qt(e.endRetracement,i),translation:t,context:i})}copy(e,t,i){const{coords1:s,coords2:n}=this.getCoords(e,i);if(!s||!n)return;const o=this.computeBBoxWithoutHandles();return this.translatePoints({datum:t,start:ke.start(s),end:ke.end(s),endRetracement:ke.end(n),translation:{x:-o.width/2,y:-o.height/2},context:i}),t}getCoords(e,t){return{coords1:Js(e,t),coords2:Js({start:e.end,end:e.endRetracement},t)}}toggleHandles(e){if(typeof e=="boolean")this.start.visible=e,this.end.visible=e,this.endRetracement.visible=e;else for(const[t,i]of ht(e))this[t].visible=i;this.start.toggleHovered(this.activeHandle==="start"),this.end.toggleHovered(this.activeHandle==="end"),this.endRetracement.toggleHovered(this.activeHandle==="endRetracement")}toggleActive(e){this.toggleHandles(e),this.start.toggleActive(e),this.end.toggleActive(e),this.endRetracement.toggleActive(e)}updateHandles(e,t,i,s){this.start.update({...this.getHandleStyles(e),...this.getHandleCoords(e,t,"start")}),this.end.update({...this.getHandleStyles(e),...this.getHandleCoords(e,t,"end",s)}),i&&this.endRetracement.update({...this.getHandleStyles(e),...this.getHandleCoords(e,i,"endRetracement",s)}),this.start.toggleLocked(e.locked??!1),this.end.toggleLocked(e.locked??!1),this.endRetracement.toggleLocked(e.locked??!1)}getHandleCoords(e,t,i,s){return i==="start"?ke.start(t):ke.end(t)}},Hb=class extends he{constructor(e){const t=({point:c})=>{const h=this.createDatum();h.set({start:c,end:c}),e.create(h)},i=()=>{const{node:c}=this;c?.toggleActive(!0),c?.toggleHandles({start:!0,end:!1,endRetracement:!1})},s=({offset:c,context:h})=>{const{datum:d,snapping:u}=this;d&&(d.set({end:Lf(c,h,u,d.start,d.snapToAngle)}),e.update())},n=()=>{const{datum:c}=this;c&&(c.endRetracement.x=c.end.x,c.endRetracement.y=c.end.y,this.node?.toggleHandles({end:!0}),e.update())},o=({offset:c,context:h})=>{const{datum:d,snapping:u}=this;d&&(d.set({endRetracement:Lf(c,h,u,d.end,d.snapToAngle)}),e.update())},a=()=>{this.node?.toggleHandles({endRetracement:!0}),e.update()},r=()=>e.delete(),l=()=>{e.showAnnotationOptions(),e.recordAction(`Create ${this.datum?.type} annotation`)};super("start",{start:{click:{target:"waiting-first-render",action:t},drag:{target:"waiting-first-render",action:t},reset:he.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:s,click:{target:"endRetracement",action:n},drag:s,dragEnd:{target:"endRetracement",action:n},reset:{target:he.parent,action:r},cancel:{target:he.parent,action:r},onExit:l},endRetracement:{hover:o,click:{target:he.parent,action:a},drag:{target:he.parent,action:a},reset:{target:he.parent,action:r},cancel:{target:he.parent,action:r}}}),this.debug=Me.create(!0,"annotations"),this.snapping=!1}createDatum(){return new _a}};g([it()],Hb.prototype,"datum",2),g([it()],Hb.prototype,"node",2),g([it()],Hb.prototype,"snapping",2);var LP={type:"fibonacci-retracement-trend-based",datum:_a,scene:Gb,isDatum:_a.is,translate:(e,t,i,s)=>{_a.is(t)&&Gb.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(_a.is(t)&&_a.is(i)&&Gb.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{_a.is(t)&&Gb.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new Hb({...e,create:t("fibonacci-retracement-trend-based")}),dragState:e=>new mi(e)},jb=class extends kP{constructor(){super(),this.type="fibonacci-retracement",this.start=new Jt,this.end=new Jt,this.append([this.start,this.end])}static is(e){return Yi.isCheck(e,"fibonacci-retracement")}containsPoint(e,t){const{start:i,end:s}=this;return this.activeHandle=void 0,i.containsPoint(e,t)?(this.activeHandle="start",!0):s.containsPoint(e,t)?(this.activeHandle="end",!0):super.containsPoint(e,t)}getNodeAtCoords(e,t){return this.start.containsPoint(e,t)||this.end.containsPoint(e,t)?"handle":super.getNodeAtCoords(e,t)}dragStart(e,t,i){this.dragState={offset:t,...Eb({start:e.start,end:e.end},i)}}stopDragging(){this.start.toggleDragging(!1),this.end.toggleDragging(!1)}dragAll(e,t,i){const{dragState:s}=this;s&&this.translatePoints({datum:e,start:s.start,end:s.end,translation:H.sub(t,s.offset),context:i})}dragHandle(e,t,i,s){const{activeHandle:n,dragState:o}=this;if(!n||!o)return;this[n].toggleDragging(!0);const a=s?this.snapToAngle(e,t,i):en(this[n].drag(t).point,i);!a||!Vb(i,a)||(e[n].x=a.x,e[n].y=a.y)}snapToAngle(e,t,i){const{activeHandle:s}=this,o=["start","end"].find(r=>r!==s);if(!s||!o)return;this[s].toggleDragging(!0);const a=Qt(e[o],i);return en(Ob(t,a,e.snapToAngle),i)}translatePoints({datum:e,start:t,end:i,translation:s,context:n}){const o=$r({start:t,end:i},s,n,{overflowContinuous:1});e.start.x=o.start.x,e.end.x=o.end.x,e.start.y=o.start.y,e.end.y=o.end.y}translate(e,t,i){this.translatePoints({datum:e,start:Qt(e.start,i),end:Qt(e.end,i),translation:t,context:i})}copy(e,t,i){const s=Js(e,i);if(!s)return;const n=this.computeBBoxWithoutHandles();return this.translatePoints({datum:t,start:{x:s.x1,y:s.y1},end:{x:s.x2,y:s.y2},translation:{x:-n.width/2,y:-n.height/2},context:i}),t}toggleHandles(e){if(typeof e=="boolean")this.start.visible=e,this.end.visible=e;else for(const[t,i]of ht(e))this[t].visible=i;this.start.toggleHovered(this.activeHandle==="start"),this.end.toggleHovered(this.activeHandle==="end")}toggleActive(e){this.toggleHandles(e),this.start.toggleActive(e),this.end.toggleActive(e)}updateHandles(e,t,i,s){this.start.update({...this.getHandleStyles(e),...this.getHandleCoords(e,t,"start")}),this.end.update({...this.getHandleStyles(e),...this.getHandleCoords(e,t,"end",s)}),this.start.toggleLocked(e.locked??!1),this.end.toggleLocked(e.locked??!1)}getHandleCoords(e,t,i,s){return i==="start"?ke.start(t):ke.end(t)}},sp=class extends he{constructor(e){const t=({point:r})=>{const l=this.createDatum();l.set({start:r,end:r}),e.create(l)},i=()=>{const{node:r}=this;r?.toggleActive(!0),r?.toggleHandles({start:!0,end:!1})},s=({offset:r,context:l})=>{const{datum:c,snapping:h}=this;c&&(c.set({end:Lf(r,l,h,c.start,c.snapToAngle)}),e.update())},n=()=>{this.node?.toggleHandles({end:!0}),e.update()},o=()=>e.delete(),a=()=>{e.showAnnotationOptions(),e.recordAction(`Create ${this.datum?.type} annotation`)};super("start",{start:{click:{target:"waiting-first-render",action:t},drag:{target:"waiting-first-render",action:t},reset:he.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:s,click:{target:he.parent,action:n},drag:s,dragEnd:{target:he.parent,action:n},reset:{target:he.parent,action:o},cancel:{target:he.parent,action:o},onExit:a}}),this.debug=Me.create(!0,"annotations"),this.snapping=!1}};g([it()],sp.prototype,"datum",2),g([it()],sp.prototype,"node",2),g([it()],sp.prototype,"snapping",2);var _Z=class extends sp{createDatum(){return new _r}},VZ=class extends sp{createDatum(){return new Vr}},GZ=class extends sp{createDatum(){return new Hr}},wP={type:"fibonacci-retracement",datum:Hr,scene:jb,isDatum:Hr.is,translate:(e,t,i,s)=>{Hr.is(t)&&jb.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(Hr.is(t)&&Hr.is(i)&&jb.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{Hr.is(t)&&jb.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new GZ({...e,create:t("fibonacci-retracement")}),dragState:e=>new mi(e)},HZ=class extends L.Group{},Wb=class extends HZ{constructor(){super(),this.type="arrow",this.path=new L.Path,this.armLength=6,this.append([this.path])}update(e){const{path:t}=this,{x:i,y:s,angle:n,...o}=e,a=H.from(i,s),r=3*Math.PI/4,l=this.armLength+(e.strokeWidth??0)*2,c=H.rotate(H.from(0,l),n+r,a),h=H.rotate(H.from(l,0),n-r,a);t.setProperties(o),t.fillOpacity=0,t.path.clear(),t.path.moveTo(c.x,c.y),t.path.lineTo(a.x,a.y),t.path.lineTo(h.x,h.y)}},{Transformable:jZ}=L,ac=class extends Gk{constructor(){super(),this.type="line",this.line=new pn,this.append([this.line,this.start,this.end])}static is(e){return Yi.isCheck(e,"line")}update(e,t){let i=Js(e,t);if(i==null){this.visible=!1;return}i=ke.round(i),this.visible=e.visible??!0,this.visible&&(this.updateLine(e,i,t),this.updateHandles(e,i),this.updateText(e,i),this.updateCaps(e,i),this.updateAnchor(e,i,t))}updateLine(e,t,i){const{line:s}=this,{lineDashOffset:n,stroke:o,strokeWidth:a,strokeOpacity:r}=e,l=this.extendLine(t,e,i);s.setProperties({...l,lineCap:e.getLineCap(),lineDash:e.getLineDash(),lineDashOffset:n,stroke:o,strokeWidth:a,strokeOpacity:r,fillOpacity:0})}updateText(e,t){this.text=this.updateNode(Ih,this.text,!!e.text.label),ip(this.line.id,this.line,t,e.text,this.text,e.text.label,e.strokeWidth)}updateCaps(e,t){if(!e.startCap&&this.startCap&&(this.startCap.remove(),this.startCap=void 0),!e.endCap&&this.endCap&&(this.endCap.remove(),this.endCap=void 0),!e.startCap&&!e.endCap)return;const{stroke:i,strokeWidth:s,strokeOpacity:n}=e,[o,a]=H.from(t),r=H.angle(H.sub(a,o));e.startCap&&(this.startCap&&this.startCap.type!==e.startCap&&(this.startCap.remove(),this.startCap=void 0),this.startCap==null&&(this.startCap=new Wb,this.append([this.startCap])),this.startCap.update({x:o.x,y:o.y,angle:r-Math.PI,stroke:i,strokeWidth:s,strokeOpacity:n})),e.endCap&&(this.endCap&&this.endCap.type!==e.endCap&&(this.endCap.remove(),this.endCap=void 0),this.endCap==null&&(this.endCap=new Wb,this.append([this.endCap])),this.endCap.update({x:a.x,y:a.y,angle:r,stroke:i,strokeWidth:s,strokeOpacity:n}))}updateAnchor(e,t,i,s){const n=ke.topCenter(t);H.apply(this.anchor,jZ.toCanvasPoint(this.line,n.x,n.y))}containsPoint(e,t){const{line:i,text:s}=this;return super.containsPoint(e,t)||i.isPointInPath(e,t)||!!s?.containsPoint(e,t)}getNodeAtCoords(e,t){return this.text?.containsPoint(e,t)?"text":this.line.isPointInPath(e,t)?"line":super.getNodeAtCoords(e,t)}getHandleCoords(e,t,i,s){const{startCap:n,endCap:o}=this;let[a,r]=H.from(t);const l=H.angle(H.sub(r,a));return n&&(a=H.rotate(H.from(0,-Jt.HANDLE_SIZE/2),l,a)),o&&(r=H.rotate(H.from(0,Jt.HANDLE_SIZE/2),l,r)),i==="start"?a:r}getHandleStyles(e){return{fill:e.handle.fill,stroke:e.handle.stroke??e.stroke,strokeOpacity:e.handle.strokeOpacity??e.strokeOpacity,strokeWidth:e.handle.strokeWidth??e.strokeWidth}}},TP={type:"line",datum:Vr,scene:ac,isDatum:Vr.is,translate:(e,t,i,s)=>{Vr.is(t)&&ac.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(Vr.is(t)&&Vr.is(i)&&ac.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{Vr.is(t)&&ac.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new VZ({...e,create:t("line")}),dragState:e=>new mi(e)},NP={type:"arrow",datum:_r,scene:ac,isDatum:_r.is,translate:(e,t,i,s)=>{_r.is(t)&&ac.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(_r.is(t)&&_r.is(i)&&ac.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{_r.is(t)&&ac.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new _Z({...e,create:t("arrow")}),dragState:e=>new mi(e)};function OP(e,t=0,i=0){let s=t;for(const n of e)if(Array.isArray(n)){for(const o of n)EP(o,s);s+=L.Group.computeChildrenBBox(n).width+i}else EP(n,s),s+=n.getBBox().width+i}function WZ(e,t=0,i=0){let s=t;for(const n of e)if(Array.isArray(n)){for(const o of n)PP(o,s);s+=L.Group.computeChildrenBBox(n).height+i}else PP(n,s),s+=n.getBBox().height+i}function EP(e,t){"x1"in e?(e.x2=t+(e.x2-e.x1),e.x1=t):e.x=t}function PP(e,t){"y1"in e?(e.y2=t+(e.y2-e.y1),e.y1=t):e.y=t}function RP(e,t){"x1"in e?(e.x1+=t,e.x2+=t):e.x+=t}function FP(e,t){"y1"in e?(e.y1+=t,e.y2+=t):e.y+=t}var zP=class extends L.Group{constructor(){super(),this.name="MeasurerStatisticsScene",this.background=new L.Rect,this.dateRangeBarsText=new L.Text,this.dateRangeDivider=new L.Line,this.dateRangeValueText=new L.Text,this.priceRangeValueText=new L.Text,this.priceRangeDivider=new L.Line,this.priceRangePercentageText=new L.Text,this.volumeText=new L.Text,this.volumeFormatter=new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2}),this.append([this.background,this.dateRangeBarsText,this.dateRangeDivider,this.dateRangeValueText,this.priceRangeValueText,this.priceRangeDivider,this.priceRangePercentageText,this.volumeText])}update(e,t,i,s,n,o,a){this.verticalDirection=o;const r=this.updateStatistics(e,t,i,a),l=L.Group.computeChildrenBBox(r.flat()),c=10;l.grow(c),this.updateBackground(e,l,c),this.reposition(r,c,n),this.checkVisibility(e,n,s)}checkVisibility(e,t,i){const s=ke.from(t.seriesRect);this.visible=ke.collides(i,s)&&(e.visible??!0)}updateStatistics(e,t,i,s){const{dateRangeBarsText:n,dateRangeDivider:o,dateRangeValueText:a,priceRangeValueText:r,priceRangeDivider:l,priceRangePercentageText:c,volumeText:h}=this,d=8,u=6,p=e.statistics.fontSize+3,f=-2,y=this.getTextStyles(e),b={...this.getDividerStyles(e),x1:0,y1:0,x2:0,y2:p},x=[n,o,a],v=[r,l,c],S=[];return t.priceRange&&(r.setProperties({...y,text:this.formatPriceRangeValue(t.priceRange.value,s)}),l.setProperties(b),c.setProperties({...y,text:this.formatPriceRangePercentage(t.priceRange.percentage,s)}),OP(v,i.x,d),S.push(v)),t.dateRange&&(n.setProperties({...y,text:this.formatDateRangeBars(t.dateRange.bars,s)}),o.setProperties(b),a.setProperties({...y,text:this.formatDateRangeValue(t.dateRange.value)}),OP(x,i.x,d),S.push(x)),t.volume==null?h.visible=!1:(h.setProperties({...y,x:i.x,text:this.formatVolume(t.volume,s),visible:!0}),S.push(h)),WZ(S,i.y,u),l.y1+=f,l.y2+=f,o.y1+=f,o.y2+=f,S}updateBackground(e,t,i){const s=this.getBackgroundStyles(e);this.background.setProperties({...s,...t,x:t.x-t.width/2+i,y:t.y})}reposition(e,t,i){const{width:s,height:n}=i.seriesRect,o=ke.from(this.background.getBBox());let a=0;o.x1<0&&(a=-o.x1),o.x2>s&&(a=s-o.x2);const r=Math.min(t,n-o.y2);for(const l of e)if(Array.isArray(l)){const c=L.Group.computeChildrenBBox(l).width;for(const h of l)RP(h,a-c/2),FP(h,r)}else RP(l,a-l.getBBox().width/2),FP(l,r);this.background.x+=a,this.background.y+=r}getTextStyles(e){return{fill:e.statistics.color,fontFamily:e.statistics.fontFamily,fontSize:e.statistics.fontSize,fontStyle:e.statistics.fontStyle,fontWeight:e.statistics.fontWeight,textBaseline:"top"}}getDividerStyles(e){return{stroke:e.statistics.divider.stroke,strokeOpacity:e.statistics.divider.strokeOpacity,strokeWidth:e.statistics.divider.strokeWidth}}getBackgroundStyles(e){return{fill:e.statistics.fill,stroke:e.statistics.stroke,strokeOpacity:e.statistics.strokeOpacity,strokeWidth:e.statistics.strokeWidth,cornerRadius:4}}formatDateRangeBars(e,t){return t?.t("measurerDateRangeBars",{value:e})??`${e}`}formatDateRangeValue(e){const t=[],i=e>=0?"":"-";e=Math.abs(e);const s=1e3*60,n=s*60,o=n*24,a=Math.floor(e/s),r=Math.floor(e/n),l=Math.floor(e/o),c=r%(o/n),h=a%(n/s);return l>=1&&t.push(`${l}d`),r>=1&&(e<o||c!==0)&&t.push(`${c}h`),(e<n||h!==0)&&t.push(`${h}m`),t[0]=`${i}${t[0]}`,t.join(" ")}formatPriceRangeValue(e,t){return t?.t("measurerPriceRangeValue",{value:Number(e.toFixed(2))})??`${e}`}formatPriceRangePercentage(e,t){return t?.t("measurerPriceRangePercent",{value:e})??`${e}`}formatVolume(e,t){const i=Number.isNaN(e)?"":this.volumeFormatter.format(e);return t?.t("measurerVolume",{value:i})??i}},$Z=class extends zP{getDirectionStyles(e){return this.verticalDirection==="down"?e.down.statistics:e.up.statistics}getTextStyles(e){const t=this.getDirectionStyles(e);return{...super.getTextStyles(e),fill:t.color,fontFamily:t.fontFamily,fontSize:t.fontSize,fontStyle:t.fontStyle,fontWeight:t.fontWeight}}getDividerStyles(e){const t=this.getDirectionStyles(e);return{stroke:t.divider.stroke,strokeOpacity:t.divider.strokeOpacity,strokeWidth:t.divider.strokeWidth}}getBackgroundStyles(e){const t=this.getDirectionStyles(e);return{...super.getBackgroundStyles(e),fill:t.fill,stroke:t.stroke,strokeOpacity:t.strokeOpacity,strokeWidth:t.strokeWidth}}},Vn=class extends Gk{constructor(){super(),this.type="measurer",this.horizontalLine=new pn,this.verticalLine=new pn,this.horizontalStartLine=new pn,this.horizontalEndLine=new pn,this.verticalStartLine=new pn,this.verticalEndLine=new pn,this.horizontalEndCap=new Wb,this.verticalEndCap=new Wb,this.background=new L.Path({zIndex:-1}),this.updateBackground=SP.updateBackground.bind(this),this.statistics=this.createStatisticsScene(),this.statistics.zIndex=1,this.append([this.background,this.verticalStartLine,this.verticalEndLine,this.horizontalStartLine,this.horizontalEndLine,this.horizontalLine,this.verticalLine,this.horizontalEndCap,this.verticalEndCap,this.start,this.end,this.statistics])}static is(e){return Yi.isCheck(e,"measurer")}createStatisticsScene(){return new zP}update(e,t){const i=Js(e,t);if(i==null){this.visible=!1;return}if(this.visible=e.visible??!0,!this.visible)return;const s=this.extendPerpendicular(i,e,t),n={...s,y2:s.y1},o={...s,y1:s.y2};this.verticalDirection=i.y1<i.y2?"down":"up",this.updateVisibilities(e),this.updateLines(e,i),this.updateHandles(e,i),this.updateText(e,i),this.updateCaps(e,i),this.updateBoundingLines(e,s),this.updateBackground(e,n,o,t),this.updateStatistics(e,i,t),this.updateAnchor(e,i,t)}extendPerpendicular(e,t,i){const s={x1:Math.min(e.x1,e.x2),x2:Math.max(e.x1,e.x2),y1:Math.min(e.y1,e.y2),y2:Math.max(e.y1,e.y2)},[n,o]=H.from(i.yAxis.bounds);return mo.is(t)?(t.extendAbove&&(s.y1=n.y),t.extendBelow&&(s.y2=o.y)):yo.is(t)&&(t.extendLeft&&(s.x1=n.x),t.extendRight&&(s.x2=o.x)),s}updateVisibilities(e){const{horizontalStartLine:t,horizontalEndLine:i,horizontalEndCap:s,verticalStartLine:n,verticalEndLine:o,verticalEndCap:a}=this,{direction:r}=e;n.visible=r!=="vertical",o.visible=r!=="vertical",s.visible=r!=="vertical",t.visible=r!=="horizontal",i.visible=r!=="horizontal",a.visible=r!=="horizontal"}updateLines(e,t){const{horizontalLine:i,verticalLine:s}=this,{direction:n}=e,{x1:o,y1:a,x2:r,y2:l}=t,c=H.round(ke.center(t),0),h=this.getLineStyles(e);n!=="vertical"&&i.setProperties({...h,x1:o,x2:r,y1:c.y,y2:c.y}),n!=="horizontal"&&s.setProperties({...h,x1:c.x,x2:c.x,y1:a,y2:l})}updateText(e,t){const{direction:i}=e,s=H.round(ke.center(t),0);let n;const o={...t};i==="vertical"?(n=this.verticalLine,o.x1=s.x,o.x2=s.x):(n=this.horizontalLine,o.y1=s.y,o.y2=s.y),this.text=this.updateNode(Ih,this.text,!!e.text.label);const{id:a}=n,r=ip(a,n,o,e.text,this.text,e.text.label,e.strokeWidth);let l;if(i==="both"&&r&&this.text){const c=ke.from(this.text.getBBox()),{offset:h}=r.numbers;c.x1<=s.x+h.x&&c.x2>=s.x-h.x&&(l={x:s.x,y:r.clipMask.y,radius:this.text.getBBox().height/2+H.length(h)})}this.verticalLine.setClipMask(a,l)}updateCaps(e,t){const{horizontalEndCap:i,verticalEndCap:s}=this,{direction:n}=e,{x1:o,y1:a,x2:r,y2:l}=t,c=H.round(ke.center(t),0),{stroke:h,strokeWidth:d,strokeOpacity:u}=this.getLineStyles(e),p={stroke:h,strokeWidth:d,strokeOpacity:u};if(n!=="vertical"){const f=o<=r?0:Math.PI;let y=r;n==="horizontal"&&(y+=o<=r?-2:2),i.update({...p,x:y,y:c.y,angle:f})}if(n!=="horizontal"){const f=a<=l?Math.PI/2:Math.PI/-2;let y=l;n==="vertical"&&(y+=a<=l?-2:2),s.update({...p,x:c.x,y,angle:f})}}updateBoundingLines(e,t){const{verticalStartLine:i,verticalEndLine:s,horizontalStartLine:n,horizontalEndLine:o}=this,{direction:a}=e,{x1:r,y1:l,x2:c,y2:h}=t,d=this.getLineStyles(e);a==="horizontal"&&(i.setProperties({...d,x1:r,y1:l,x2:r,y2:h}),s.setProperties({...d,x1:c,y1:l,x2:c,y2:h})),a==="vertical"&&(n.setProperties({...d,x1:r,y1:l,x2:c,y2:l}),o.setProperties({...d,x1:r,y1:h,x2:c,y2:h}))}updateStatistics(e,t,i){const s=H.add(ke.bottomCenter(t),H.from(0,10)),n={volume:this.getVolume(e)};e.hasPriceRange&&(n.priceRange={percentage:this.getPriceRangePercentage(e),value:this.getPriceRangeValue(e)}),e.hasDateRange&&(n.dateRange={bars:this.getDateRangeBars(t,i),value:this.getDateRangeValue(e)}),this.statistics.update(e,n,s,t,i,this.verticalDirection,e.localeManager)}updateAnchor(e,t,i,s){const n=ke.topCenter(t);H.apply(this.anchor,L.Transformable.toCanvasPoint(this.horizontalLine,n.x,n.y))}getBackgroundPoints(e,t,i,s){const[n,o]=H.from(t),[a,r]=H.from(i);return[n,o,r,a]}getLineStyles(e){const{lineDashOffset:t,stroke:i,strokeWidth:s,strokeOpacity:n}=e;return{lineCap:e.getLineCap(),lineDash:e.getLineDash(),lineDashOffset:t,stroke:i,strokeWidth:s,strokeOpacity:n,fillOpacity:0}}getBackgroundStyles(e){const{background:t}=e;return{fill:t.fill,fillOpacity:t.fillOpacity}}getHandleStyles(e){return{fill:e.handle.fill,stroke:e.handle.stroke??e.stroke,strokeOpacity:e.handle.strokeOpacity??e.strokeOpacity,strokeWidth:e.handle.strokeWidth??e.strokeWidth}}containsPoint(e,t){const{horizontalLine:i,text:s,verticalLine:n,horizontalStartLine:o,horizontalEndLine:a,verticalStartLine:r,verticalEndLine:l}=this;return super.containsPoint(e,t)||i.isPointInPath(e,t)||n.isPointInPath(e,t)||o.visible&&o.isPointInPath(e,t)||a.visible&&a.isPointInPath(e,t)||r.visible&&r.isPointInPath(e,t)||l.visible&&l.isPointInPath(e,t)||!!s?.containsPoint(e,t)}getNodeAtCoords(e,t){return this.text?.containsPoint(e,t)?"text":this.start.containsPoint(e,t)||this.end.containsPoint(e,t)?"handle":"line"}getDateRangeBars(e,t){const{step:i}=t.xAxis.scale,s=e.x1<=e.x2?1:-1;return i?Math.round(ke.width(e)/i)*s:0}getDateRangeValue(e){const t=wi(e.start.x),i=wi(e.end.x);if(!Is(t)||!Is(i))throw new Error("Can not create a date range measurement of non-date x-axis.");return i.getTime()-t.getTime()}getPriceRangePercentage(e){if(e.start.y==null||e.end.y==null)throw new Error("Can not create a price range measurement of a non-numeric y-axis");const t=wi(e.end.y),i=wi(e.start.y);if(!gt(t)||!gt(i))throw new Error("Can not create a price range measurement of a non-numeric y-axis");return(t-i)/i}getPriceRangeValue(e){if(e.start.y==null||e.end.y==null)throw new Error("Can not create a price range measurement of a non-numeric y-axis");const t=wi(e.end.y),i=wi(e.start.y);if(!gt(t)||!gt(i))throw new Error("Can not create a price range measurement of a non-numeric y-axis");return t-i}getVolume(e){return e.getVolume(e.start.x,e.end.x)}},$b=class extends Vn{constructor(){super(...arguments),this.type="quick-measurer"}static is(e){return Yi.isCheck(e,"quick-measurer")}createStatisticsScene(){return new $Z}getDirectionStyles(e){return this.verticalDirection==="down"?e.down:e.up}getLineStyles(e){const t=this.getDirectionStyles(e);return{...super.getLineStyles(e),stroke:t.stroke,strokeWidth:t.strokeWidth,strokeOpacity:t.strokeOpacity}}getBackgroundStyles(e){const t=this.getDirectionStyles(e);return{fill:t.fill,fillOpacity:t.fillOpacity}}getHandleStyles(e){const t=this.getDirectionStyles(e);return{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth}}},np=class extends he{constructor(e){const t=({point:a})=>{const r=this.createDatum();r.set({start:a,end:a}),e.create(r)},i=({point:a})=>{const{datum:r,node:l}=this;r?.set({end:a}),l?.toggleActive(!0),l?.toggleHandles({end:!1}),e.update()},s=()=>{this.node?.toggleHandles({end:!0})},n=()=>e.delete(),o=()=>{e.showAnnotationOptions(),e.recordAction(`Create ${this.node?.type} annotation`)};super("start",{start:{reset:he.parent,click:{target:"end",action:t},drag:{target:"end",action:t}},end:{hover:i,drag:i,click:{target:he.parent,action:s},dragEnd:{target:he.parent,action:s},reset:{target:he.parent,action:n},cancel:{target:he.parent,action:n},onExit:o}}),this.debug=Me.create(!0,"annotations")}};g([it()],np.prototype,"datum",2),g([it()],np.prototype,"node",2);var UZ=class extends np{createDatum(){return new mo}},KZ=class extends np{createDatum(){return new yo}},YZ=class extends np{createDatum(){return new Br}},ZZ=class extends np{createDatum(){return new _n}},BP={type:"date-range",datum:mo,scene:Vn,isDatum:mo.is,translate:(e,t,i,s)=>{mo.is(t)&&Vn.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(mo.is(t)&&mo.is(i)&&Vn.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{mo.is(t)&&Vn.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new UZ({...e,create:t("date-range")}),dragState:e=>new mi(e)},_P={type:"price-range",datum:yo,scene:Vn,isDatum:yo.is,translate:(e,t,i,s)=>{yo.is(t)&&Vn.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(yo.is(t)&&yo.is(i)&&Vn.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{yo.is(t)&&Vn.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new KZ({...e,create:t("date-range")}),dragState:e=>new mi(e)},VP={type:"date-price-range",datum:Br,scene:Vn,isDatum:Br.is,translate:(e,t,i,s)=>{Br.is(t)&&Vn.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(Br.is(t)&&Br.is(i)&&Vn.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{Br.is(t)&&Vn.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new YZ({...e,create:t("date-range")}),dragState:e=>new mi(e)},GP={type:"quick-date-price-range",datum:_n,scene:$b,isDatum:_n.is,translate:(e,t,i,s)=>{_n.is(t)&&$b.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(_n.is(t)&&_n.is(i)&&$b.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{_n.is(t)&&$b.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new ZZ({...e,create:t("quick-date-price-range")}),dragState:e=>new mi(e)},Ub=class extends $k{constructor(){super(),this.type="note",this.shape=new L.Rect,this.iconBackground=new L.TranslatableSvgPath("M22 1.83333C22 0.820811 21.1792 0 20.1667 0H1.83333C0.820811 0 0 0.82081 0 1.83333V13.9868C0 14.9994 0.820811 15.8202 1.83333 15.8202L5.88971 15.8202C6.44575 15.8202 6.97175 16.0725 7.31971 16.5062L9.57006 19.3112C10.304 20.2259 11.6962 20.2259 12.4301 19.3112L14.6804 16.5062C15.0284 16.0725 15.5544 15.8202 16.1104 15.8202L20.1667 15.8202C21.1792 15.8202 22 14.9994 22 13.9868V1.83333Z"),this.iconLines=new L.TranslatableSvgPath("M17.1114 5.75C17.1114 6.16421 16.7756 6.5 16.3614 6.5H5.63916C5.22495 6.5 4.88916 6.16421 4.88916 5.75V5.75C4.88916 5.33579 5.22495 5 5.63916 5H16.3614C16.7756 5 17.1114 5.33579 17.1114 5.75V5.75ZM17.1114 9.25C17.1114 9.66421 16.7756 10 16.3614 10H5.63916C5.22495 10 4.88916 9.66421 4.88916 9.25V9.25C4.88916 8.83579 5.22495 8.5 5.63916 8.5H16.3614C16.7756 8.5 17.1114 8.83579 17.1114 9.25V9.25Z"),this.active=!1,this.shape.visible=!1,this.label.visible=!1,this.iconBackground.fillShadow=new L.DropShadow,this.append([this.shape,this.label,this.iconBackground,this.iconLines,this.handle])}static is(e){return Yi.isCheck(e,"note")}update(e,t){this.updateIcon(e,t),super.update(e,t)}getTextBBox(e,t,i){const s=super.getTextBBox(e,t,i);s.x-=e.width/2,s.x=ge(0,s.x,i.seriesRect.width-e.width);const n=e.getPadding().top,o=s.y-YE-n*2,a=s.y+Jt.HANDLE_SIZE+n*2;return o-s.height-ZE<0?(s.y=a,e.position="top"):(s.y=o+n,e.position="bottom"),s}updateLabel(e,t){const i=e.visible===!1?!1:this.label.visible;super.updateLabel(e,t),this.label.visible=i,this.label.text=xa(e.text,{maxWidth:200,font:e,textWrap:"always",avoidOrphans:!1})}updateShape(e,t){const{shape:i}=this;i.fill=e.background.fill,i.fillOpacity=e.background.fillOpacity??1,i.stroke=e.background.stroke,i.strokeOpacity=e.background.strokeOpacity??1,i.strokeWidth=e.background.strokeWidth??1,i.cornerRadius=4;const s=e.getPadding().top,n=e.position==="top";i.x=t.x-s,i.width=e.width+s*2,i.height=t.height+s*2,i.y=t.y+(n?0:-t.height)-s}updateIcon(e,t){const{active:i,iconBackground:s,iconLines:n}=this,{x:o,y:a}=Qt(e,t);s.translationX=o-sZ/2,s.translationY=a-KE,n.translationX=s.translationX,n.translationY=s.translationY,s.fill=e.fill,s.fillOpacity=e.fillOpacity??1,s.stroke=e.stroke,s.strokeOpacity=e.strokeOpacity??1,s.strokeWidth=e.strokeWidth??1,n.fill=e.stroke,i?s.fillShadow.color=e.fill??"rgba(0, 0, 0, 0.22)":s.fillShadow.color="rgba(0, 0, 0, 0.22)"}updateAnchor(e,t,i){const s=e.getPadding().top,n=e.position==="top",o=n?1:-1;return{x:t.x+i.seriesRect.x+e.width/2,y:t.y+i.seriesRect.y+o*(t.height+s),position:n?"below":"above"}}getLabelCoords(e,t){const i=e.position==="top",s=e.getPadding().top+Mn(e.fontSize,Ab)/2;return{x:t.x,y:t.y+(i?s/2:0)}}getTextBaseline(e){return e.position==="top"?"middle":e.position}getHandleCoords(e,t,i){return{x:t.x,y:t.y+Jt.HANDLE_SIZE/2+4}}getHandleStyles(e){return{fill:e.handle.fill,stroke:e.handle.stroke??e.fill,strokeOpacity:e.handle.strokeOpacity,strokeWidth:e.handle.strokeWidth}}toggleHovered(e,t,i){super.toggleHovered(e,t,i);const s=e||t&&!i;this.label.visible=s,this.shape.visible=s,this.zIndex=s?13:12}toggleActive(e){super.toggleActive(e),this.label.visible=e,this.shape.visible=e,this.active=e}containsPoint(e,t){return this.shape.visible&&this.shape.containsPoint(e,t)||this.iconBackground.containsPoint(e,t)?!0:super.containsPoint(e,t)}},XZ=class extends wf{createDatum(){return new un}},HP={type:"note",datum:un,scene:Ub,isDatum:un.is,translate:(e,t,i,s)=>{un.is(t)&&Ub.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(un.is(t)&&un.is(i)&&Ub.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{un.is(t)&&Ub.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new XZ({...e,create:t("note")}),dragState:e=>new mi(e)},Kb=class extends MP{constructor(){super(),this.type="parallel-channel",this.handles={topLeft:new Jt,topMiddle:new tp,topRight:new Jt,bottomLeft:new Jt,bottomMiddle:new tp,bottomRight:new Jt},this.middleLine=new pn,this.append([this.background,this.topLine,this.middleLine,this.bottomLine,...Object.values(this.handles)])}static is(e){return Yi.isCheck(e,"parallel-channel")}dragHandle(e,t,i,s){const{activeHandle:n,handles:o}=this;if(n==null)return;const{offset:a}=o[n].drag(t);o[n].toggleDragging(!0),(n==="topMiddle"||n==="bottomMiddle")&&(a.x=0);let r=[],l=s;switch(n){case"topLeft":case"bottomLeft":r=["topLeft","bottomLeft"];break;case"topMiddle":r=["topLeft","topRight"],a.y-=tp.HANDLE_SIZE/2,l=!1;break;case"topRight":case"bottomRight":r=["topRight","bottomRight"];break;case"bottomMiddle":r=["bottomLeft","bottomRight"],a.y-=tp.HANDLE_SIZE/2,l=!1;break}const c=Js(e,i),h=Js(e.bottom,i);if(!c||!h)return;const d={topLeft:ke.start(c),topRight:ke.end(c),bottomLeft:ke.start(h),bottomRight:ke.end(h)},u={vectors:{topLeft:d.topRight,bottomLeft:d.bottomRight,topRight:d.topLeft,bottomRight:d.bottomLeft},angle:e.snapToAngle},p=$r(d,a,i,{overflowContinuous:this.overflowContinuous,translateVectors:r,snap:l?u:void 0});e.start.x=p.topLeft.x,e.start.y=p.topLeft.y,e.end.x=p.topRight.x,e.end.y=p.topRight.y,e.height=p.topLeft.y-p.bottomLeft.y}getTranslatePointsVectors(e,t){const{bottomLeft:i,topLeft:s}=this.handles,n=i.getBBox().y-s.getBBox().y,o=H.add(e,H.from(0,n)),a=H.add(t,H.from(0,n));return{start:e,end:t,bottomStart:o,bottomEnd:a}}containsPoint(e,t){return super.containsPoint(e,t)||this.middleLine.visible&&this.middleLine.strokeWidth>0&&this.middleLine.containsPoint(e,t)}getNodeAtCoords(e,t){return this.middleLine.visible&&this.middleLine.strokeWidth>0&&this.middleLine.containsPoint(e,t)?"line":super.getNodeAtCoords(e,t)}updateLines(e,t,i,s,n,o){const{topLine:a,middleLine:r,bottomLine:l}=this,{lineDashOffset:c,stroke:h,strokeOpacity:d,strokeWidth:u}=e,p=e.getLineDash(),f={lineCap:e.getLineCap(),lineDash:p,lineDashOffset:c,stroke:h,strokeOpacity:d,strokeWidth:u};a.setProperties({...t,...f}),l.setProperties({...i,...f});const y=this.extendLine({x1:n.x1,y1:o.y1+(n.y1-o.y1)/2,x2:n.x2,y2:o.y2+(n.y2-o.y2)/2},e,s);r.setProperties({...y,lineDash:e.middle.lineDash??p,lineDashOffset:e.middle.lineDashOffset??c,stroke:e.middle.stroke??h,strokeOpacity:e.middle.strokeOpacity??d,strokeWidth:e.middle.strokeWidth??u,visible:e.middle.visible??!0})}updateHandles(e,t,i){const{handles:{topLeft:s,topMiddle:n,topRight:o,bottomLeft:a,bottomMiddle:r,bottomRight:l}}=this,c={fill:e.handle.fill,stroke:e.handle.stroke??e.stroke,strokeOpacity:e.handle.strokeOpacity??e.strokeOpacity,strokeWidth:e.handle.strokeWidth??e.strokeWidth};s.update({...c,...ke.start(t)}),o.update({...c,...ke.end(t)}),a.update({...c,...ke.start(i)}),l.update({...c,...ke.end(i)}),n.update({...c,...H.sub(ke.center(t),H.from(n.handle.width/2,n.handle.height/2))}),r.update({...c,...H.sub(ke.center(i),H.from(r.handle.width/2,r.handle.height/2))})}updateText(e,t,i){this.text=this.updateNode(Ih,this.text,!!e.text.label),fP(!0,t,i,e.text,e.strokeWidth,this.text,e.text.label)}getBackgroundPoints(e,t,i,s){const n=t.x1>t.x2,o=t.y1>t.y2,a=t.x1!==i.x1&&t.y1!==i.y1,r=t.x2!==i.x2&&t.y2!==i.y2,l=H.from(t);return e.extendEnd&&r&&l.push(H.from(n?s.x1:s.x2,o?s.y1:s.y2)),l.push(...H.from(i).reverse()),e.extendStart&&a&&l.push(H.from(n?s.x2:s.x1,o?s.y2:s.y1)),l}},Yb=class extends he{constructor(e){const t=({point:l})=>{const c=new bo;c.set({start:l,end:l,height:0}),e.create(c)},i=()=>{const{node:l}=this;l?.toggleActive(!0),l?.toggleHandles({topLeft:!0,topMiddle:!1,topRight:!1,bottomLeft:!1,bottomMiddle:!1,bottomRight:!1})},s=({offset:l,context:c})=>{const{datum:h,snapping:d}=this;h&&(h.set({end:Lf(l,c,d,h.start,h.snapToAngle)}),e.update())},n=()=>{this.node?.toggleHandles({topRight:!0}),e.update()},o=({point:l})=>{const{datum:c,node:h}=this,d=wi(c?.end.y),u=wi(c?.start.y),{y:p}=l;if(c==null||!gt(u)||!gt(d)||!gt(p))return;const f=d-(p??0),y=u-f;h?.toggleHandles({bottomLeft:!0,bottomRight:!0}),!(!e.validatePoint({x:c.start.x,y},{overflowContinuous:!0})||!e.validatePoint({x:c.end.x,y:l.y},{overflowContinuous:!0}))&&(c.set({height:f}),e.update())},a=({point:l})=>{const{datum:c,node:h}=this,d=wi(c?.end.y),u=wi(c?.start.y),{y:p}=l;if(c==null||!gt(u)||!gt(d)||!gt(p))return;const f=d-(p??0),y=u-f;h?.toggleHandles(!0),!(!e.validatePoint({x:c.start.x,y},{overflowContinuous:!0})||!e.validatePoint({x:c.end.x,y:l.y},{overflowContinuous:!0}))&&(c.set({height:f}),e.recordAction("Create parallel-channel annotation"),e.showAnnotationOptions(),e.update())},r=()=>e.delete();super("start",{start:{click:{target:"waiting-first-render",action:t},drag:{target:"waiting-first-render",action:t},reset:he.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:s,drag:s,click:{target:"height",action:n},dragEnd:{target:"height",action:n},reset:{target:he.parent,action:r},cancel:{target:he.parent,action:r}},height:{hover:o,click:{target:he.parent,action:a},drag:{target:he.parent,action:a},reset:{target:he.parent,action:r},cancel:{target:he.parent,action:r}}}),this.debug=Me.create(!0,"annotations"),this.snapping=!1}};g([it()],Yb.prototype,"datum",2),g([it()],Yb.prototype,"node",2),g([it()],Yb.prototype,"snapping",2);var jP={type:"parallel-channel",datum:bo,scene:Kb,isDatum:bo.is,translate:(e,t,i,s)=>{bo.is(t)&&Kb.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(bo.is(t)&&bo.is(i)&&Kb.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{bo.is(t)&&Kb.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new Yb({...e,create:t("parallel-channel")}),dragState:e=>new mi(e)},Zb=class extends $k{constructor(){super(),this.type="text",this.append([this.label,this.handle])}static is(e){return Yi.isCheck(e,"text")}getHandleCoords(e,t){const i=Jt.HANDLE_SIZE/2;return{x:t.x+i,y:t.y+2+i}}},qZ=class extends wf{createDatum(){return new jr}},WP={type:"text",datum:jr,scene:Zb,isDatum:jr.is,translate:(e,t,i,s)=>{jr.is(t)&&Zb.is(e)&&e.translate(t,i,s)},copy:(e,t,i,s)=>{if(jr.is(t)&&jr.is(i)&&Zb.is(e))return e.copy(t,i,s)},update:(e,t,i)=>{jr.is(t)&&Zb.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new qZ({...e,create:t("text")}),dragState:e=>new mi(e)},Gn={[TP.type]:TP,[bP.type]:bP,[vP.type]:vP,[jP.type]:jP,[DP.type]:DP,[wP.type]:wP,[LP.type]:LP,[uP.type]:uP,[pP.type]:pP,[HP.type]:HP,[WP.type]:WP,[NP.type]:NP,[hP.type]:hP,[cP.type]:cP,[BP.type]:BP,[_P.type]:_P,[VP.type]:VP,[GP.type]:GP};function kh(e){for(const{isDatum:t}of Object.values(Gn))if(t(e))return e}var Xb=class extends F0{constructor(e){super(new QZ(t=>{this.snapping=t}),new JZ(()=>{this.node=this.active==null?void 0:e.node(this.active)}),new rc(e,t=>{this.active=t,this.datum=this.active==null?void 0:e.datum(this.active),this.node=this.active==null?void 0:e.node(this.active)})),this.snapping=!1}getActive(){return this.active}isActive(e){return e===this.active}};g([it()],Xb.prototype,"snapping",2),g([it()],Xb.prototype,"datum",2),g([it()],Xb.prototype,"node",2);var QZ=class extends he{constructor(e){super("idle",{idle:{hover:({shiftKey:t})=>e(t),keyDown:({shiftKey:t})=>e(t),keyUp:({shiftKey:t})=>e(t),click:({shiftKey:t})=>e(t),drag:({shiftKey:t})=>e(t)},dragging:{},translating:{},"text-input":{}})}},JZ=class extends he{constructor(e){super("idle",{idle:{onEnter:e,render:e},dragging:{onEnter:e,render:e},translating:{onEnter:e,render:e},"text-input":{render:e}})}},rc=class extends he{constructor(e,t){const i=S=>M=>{e.create(S,M),this.active=e.selectLast()},s=()=>{this.active!=null&&e.delete(this.active),this.active=void 0,e.select()},n={createDatum:i},o={...e,delete:s,showTextInput:()=>{this.active!=null&&e.showTextInput(this.active)},deselect:()=>{const S=this.active;this.active=void 0,this.hovered=void 0,e.select(this.active,S)},showAnnotationOptions:()=>{this.active!=null&&e.showAnnotationOptions(this.active)}},a=Object.fromEntries(Object.entries(Gn).map(([S,M])=>[S,M.createState(o,n)])),r=Object.fromEntries(Object.entries(Gn).map(([S,M])=>[S,M.dragState(e,n)])),l=({colorPickerType:S,colorOpacity:M,color:D,opacity:k,isMultiColor:I})=>{this.datum&&(S==="text-color"&&e.updateTextInputColor(D),Tb(this.datum,S,M,D,k,I),e.update())},c=S=>{const{datum:M,node:D}=this;!M||!D||(Va(M)?(M.fontSize=S,e.updateTextInputFontSize(S)):Qu(M)&&(M.text.fontSize=S),e.update())},h=S=>{const{datum:M,node:D}=this;!M||!D||!ec(M)||(qE(M,S),e.update())},d=S=>{const{node:M}=this;!M||!("setTextInputBBox"in M)||(M.setTextInputBBox(S),e.update())},u=({textInputValue:S,bbox:M})=>{const{datum:D}=this;if(M!=null&&S!=null&&S.length>0){if(!Va(D))return;const k=Cb(D,S,M.width);D.set({text:k}),e.update(),e.recordAction(`Change ${D.type} annotation text`)}else e.delete(this.active),e.recordAction(`Delete ${D?.type} annotation`)},p=()=>{e.updateTextInputBBox(void 0)},f=()=>this.active!=null,y=()=>this.copied!=null,b=()=>{const{active:S,datum:M}=this;return S==null||!M?!1:Qu(M)&&M.isWriteable()},x=()=>this.active!=null&&!Jl(this.datum),v=()=>this.hovered!=null;super("idle",{idle:{onEnter:()=>{e.select(this.active,this.active),this.hoverCoords&&(this.hovered=e.hoverAtCoords(this.hoverCoords,this.active,this.hovered))},hover:({offset:S})=>{this.hovered=e.hoverAtCoords(S,this.active,this.hovered),this.hoverCoords=S},translate:{guard:f,target:"translating",action:({translation:S})=>{e.startInteracting(),e.translate(this.active,S),e.update()}},copy:{guard:x,action:()=>{this.copied=e.copy(this.active)}},cut:{guard:x,action:()=>{this.copied=e.copy(this.active),s()}},paste:{guard:y,action:()=>{e.paste(this.copied)}},selectLast:()=>{const S=this.active;this.active=e.selectLast(),e.select(this.active,S)},click:[{guard:()=>{const{active:S,hovered:M,datum:D}=this;return S==null||M!==S||!D?!1:Va(D)&&D.isWriteable()},target:"text-input"},{action:()=>{const S=this.active;this.active=this.hovered,e.select(this.active,S)}}],dblclick:{guard:b,action:({offset:S})=>{const M=e.getNodeAtCoords(S,this.active)==="text"?"text":"line";e.showAnnotationSettings(this.active,void 0,M)}},dragStart:[{guard:v,target:"dragging",action:()=>{const S=this.active;this.active=this.hovered,e.select(this.active,S),e.startInteracting()}},{action:()=>{const S=this.active;this.active=this.hovered,e.select(this.active,S)}}],color:{guard:f,action:l},fontSize:{guard:f,action:c},lineProps:{guard:f,action:S=>{const M=kh(this.datum);M?.set(S),e.update(),e.recordAction(`Change ${M?.type} ${Object.entries(S).map(([D,k])=>`${D} to ${k}`).join(", ")}`)}},lineStyle:{guard:f,action:h},lineText:{guard:f,action:S=>{const M=kh(this.datum);Qu(M)&&(Wr(M)&&S.position==="center"&&(S.position="inside"),M.text.set(S),e.update())}},updateTextInputBBox:{guard:f,action:d},toolbarPressSettings:{guard:b,action:S=>{e.showAnnotationSettings(this.active,S)}},reset:()=>{this.active!=null&&this.node?.toggleActive(!1),this.hovered=void 0,this.active=void 0,e.select(this.active,this.active),e.resetToIdle()},delete:()=>{this.active!=null&&(e.delete(this.active),!Jl(this.datum)&&e.recordAction(`Delete ${this.datum?.type} annotation`))},deleteAll:()=>{e.deleteAll()},...a},dragging:{onEnter:(S,M)=>{if(this.active==null)return;const D=e.getAnnotationType(this.active);D&&(this.transitionRoot(D),this.transitionRoot("dragStart",M))},...r},translating:{onEnter:()=>{},translate:{guard:f,target:"translating",action:({translation:S})=>{e.startInteracting(),e.translate(this.active,S),e.update()}},translateEnd:{guard:f,target:"idle"},onExit:()=>{e.stopInteracting(),e.update(),e.recordAction("Translate annotation")}},"text-input":{onEnter:()=>{if(this.active==null)return;const S=kh(this.datum);!S||!("getTextInputCoords"in S)||(e.startInteracting(),e.showTextInput(this.active),S.visible=!1,e.update())},updateTextInputBBox:{guard:f,action:d},resize:{target:"idle",action:u},click:{target:"idle",action:u},drag:{target:"idle",action:u},textInput:[{guard:Hk,target:"idle",action:p},{guard:jk,target:"idle",action:u}],color:{guard:f,action:l},fontSize:{guard:f,action:c},cancel:{target:"idle",action:p},onExit:()=>{e.stopInteracting(),e.hideTextInput();const S=this.active;if(this.active=this.hovered=void 0,e.select(this.active,S),S==null)return;const M=e.datum(S),D=e.node(S);!M||!D||(M.visible=!0)}}}),this.setActive=t,this.debug=Me.create(!0,"annotations"),this.snapping=!1}};g([He({changeValue(e){this.setActive(e)}}),it()],rc.prototype,"active",2),g([it()],rc.prototype,"hovered",2),g([it()],rc.prototype,"hoverCoords",2),g([it()],rc.prototype,"copied",2),g([it()],rc.prototype,"snapping",2),g([it()],rc.prototype,"datum",2),g([it()],rc.prototype,"node",2);var{LayoutElement:eX,Menu:tX}=L,$P=class extends Vo{};g([m],$P.prototype,"value",2);var qb=class extends K{constructor(e){super(),this.ctx=e,this.enabled=!0,this.padding=20,this.buttons=new Pi($P),this.events=new Sn,this.annotationMenu=new tX(this.ctx,"annotations"),this.cleanup=new pt,this.toolbar=e.sharedToolbar.getSharedToolbar("annotations");const t=this.onKeyDown.bind(this);this.toolbar.addListener("keydown",t),this.cleanup.register(this.toolbar.addToolbarListener("button-pressed",this.onToolbarButtonPress.bind(this)),e.layoutManager.registerElement(eX.ToolbarLeft,this.onLayoutStart.bind(this)),()=>{this.toolbar.removeListener("keydown",t),this.toolbar.destroy()})}destroy(){this.cleanup.flush()}toggleClearButtonEnabled(e){const t=this.buttons.findIndex(i=>i.value==="clear");this.toolbar.toggleButtonEnabledByIndex(t,e)}resetButtonIcons(){for(const[e,t]of this.buttons.entries())switch(t.value){case"line-menu":this.updateButtonByIndex(e,{icon:"trend-line-drawing",value:"line-menu"});break;case"fibonacci-menu":this.updateButtonByIndex(e,{icon:"fibonacci-retracement-drawing",value:"fibonacci-menu"});break;case"text-menu":this.updateButtonByIndex(e,{icon:"text-annotation",value:"text-menu"});break;case"shape-menu":this.updateButtonByIndex(e,{icon:"arrow-drawing",value:"shape-menu"});break;case"measurer-menu":this.updateButtonByIndex(e,{icon:"measurer-drawing",value:"measurer-menu"});break}}hideOverlays(){this.annotationMenu.hide()}clearActiveButton(){this.toolbar.clearActiveButton()}onLayoutStart(e){this.enabled&&(this.toolbar.updateButtons(this.buttons),this.toolbar.layout(e.layoutBox,this.padding))}refreshButtonsEnabled(e){for(const[t,i]of this.buttons.entries())i&&this.toolbar.toggleButtonEnabledByIndex(t,e)}onToolbarButtonPress({event:e,button:t,buttonBounds:i,buttonWidget:s}){const n=this.ctx.axisManager.getAxisContext("y")[0].scale;switch(t.value){case"clear":this.events.emit("pressed-clear",null);break;case"line-menu":this.onToolbarButtonPressShowMenu(e,i,s,t.value,"toolbarAnnotationsLineAnnotations",gZ.filter(o=>o.visible?o.visible(n):!0));break;case"fibonacci-menu":this.onToolbarButtonPressShowMenu(e,i,s,t.value,"toolbarAnnotationsFibonacciAnnotations",fZ);break;case"text-menu":this.onToolbarButtonPressShowMenu(e,i,s,t.value,"toolbarAnnotationsTextAnnotations",yZ);break;case"shape-menu":this.onToolbarButtonPressShowMenu(e,i,s,t.value,"toolbarAnnotationsShapeAnnotations",xZ);break;case"measurer-menu":this.onToolbarButtonPressShowMenu(e,i,s,t.value,"toolbarAnnotationsMeasurerAnnotations",bZ);break}}onToolbarButtonPressShowMenu(e,t,i,s,n,o){this.events.emit("pressed-show-menu",null);const a=this.buttons.findIndex(r=>r.value===s);this.toolbar.toggleActiveButtonByIndex(a),this.annotationMenu.setAnchor({x:t.x+t.width+6,y:t.y}),this.annotationMenu.show(i,{items:o,ariaLabel:this.ctx.localeManager.t(n),class:"ag-charts-annotations__toolbar-menu",sourceEvent:e.sourceEvent,onPress:this.onButtonPressMenuCreateAnnotation.bind(this,s)})}onButtonPressMenuCreateAnnotation(e,t){const i=this.buttons.findIndex(s=>s.value===e);this.updateButtonByIndex(i,{icon:t.icon}),this.events.emit("pressed-create-annotation",{annotation:t.value}),this.annotationMenu.hide()}onKeyDown({sourceEvent:e}){e.key==="Escape"&&this.events.emit("cancel-create-annotation",null)}updateButtonByIndex(e,t){const i=this.buttons.at(e);i&&(i.set({...i.toJson(),...t,value:t.value??i.value}),this.toolbar.updateButtonByIndex(e,{...i.toJson()}))}};g([m,He({changeValue(e){this.toolbar?.setHidden(!e)}})],qb.prototype,"enabled",2),g([m],qb.prototype,"padding",2),g([m],qb.prototype,"buttons",2);var{InteractionState:Tf}=L,Nf="ag-charts-annotations__axis-button",UP=class extends bi{constructor(e,t,i,s){super(),this.ctx=e,this.axisCtx=t,this.onButtonClick=i,this.seriesRect=s,this.enabled=!0,this.snap=!1,this.padding=0,this.button=this.setup(),this.toggleVisibility(!1),this.updateButtonElement(),this.snap=!!t.scale.bandwidth,e.domManager.addEventListener("focusin",({target:n})=>{const o=n instanceof HTMLElement?n:void 0;!(o&&e.domManager.contains(o,"series-area"))&&o!==this.button.getElement()&&this.hide()}),this.cleanup.register(e.widgets.seriesWidget.addListener("drag-move",n=>this.onMouseDrag(n)),e.widgets.seriesWidget.addListener("mousemove",n=>this.onMouseMove(n)),e.widgets.seriesWidget.addListener("mouseleave",()=>this.onMouseLeave()),e.widgets.seriesDragInterpreter?.events.on("click",n=>this.onClick(n)),e.eventsHub.on("series:focus-change",()=>this.onKeyPress()),e.eventsHub.on("zoom:pan-start",()=>this.hide()),e.eventsHub.on("zoom:change-complete",()=>this.hide()),()=>this.destroyElements(),()=>this.button.destroy())}update(e,t){this.seriesRect=e,this.padding=t}setup(){const e=new gf.ButtonWidget;return e.addClass(Nf),e.setTabIndex(-1),e.setAriaLabel(this.ctx.localeManager.t("ariaLabelAddHorizontalLine")),this.ctx.widgets.seriesWidget.getElement().appendChild(e.getElement()),e}destroyElements(){this.ctx.domManager.removeChild("canvas-overlay",Nf)}onMouseMove(e){this.ctx.interactionManager.isState(Tf.Clickable)&&this.show(e)}onMouseDrag(e){this.ctx.interactionManager.isState(Tf.AnnotationsMoveable)&&this.show(e)}onMouseLeave(){this.ctx.interactionManager.isState(Tf.Clickable)&&this.hide()}onClick(e){this.ctx.interactionManager.isState(Tf.Clickable)&&e.device==="touch"&&this.show(e)}show(e){const{sourceEvent:t,currentX:i,currentY:s}=e;if(!(this.enabled&&this.ctx.widgets.seriesWidget.getElement().contains(t.target))){this.hide();return}this.toggleVisibility(!0);const n=this.getButtonCoordinates({x:i,y:s});this.coords={x:n.x+this.button.clientWidth/2,y:n.y+this.button.clientHeight/2},this.updatePosition(n)}hide(){this.toggleVisibility(!1)}onKeyPress(){this.snap&&this.ctx.interactionManager.isState(Tf.Default)||this.hide()}getButtonCoordinates({x:e,y:t}){const{axisCtx:{direction:i,position:s},seriesRect:n,snap:o,axisCtx:a,padding:r}=this,{clientWidth:l,clientHeight:c}=this.button,[h,d]=[0,n.height],[u,p]=[0,n.width];if(o&&(e=zr(Db(e-n.x,a),a)+n.x,t=zr(Db(t-n.y,a),a)+n.y),i==="x"){const y=c-Math.max(0,r-5);e=e-l/2,t=s==="top"?h-c+y:d-y}else{const y=l-Math.max(0,r-9);e=s==="left"?u-l+y:p-y,t=t-c/2}return{x:e,y:t}}toggleVisibility(e){const{button:t}=this;if(t==null)return;const i=this.enabled&&e;this.toggleClass("-hidden",!i)}toggleClass(e,t){this.button.toggleClass(`${Nf}-${e}`,t)}updatePosition({x:e,y:t}){this.button.getElement().style.transform=`translate(${Math.round(e)}px, ${Math.round(t)}px)`}updateButtonElement(){const{button:e}=this;e.addListener("click",()=>this.onButtonClick(this.coords)),e.addListener("touchend",()=>this.onButtonClick(this.coords)),e.addListener("drag-start",()=>{}),e.setInnerHTML(`<span class="${pl("zoom-in")} ${Nf}-icon"></span>`)}};g([m],UP.prototype,"enabled",2);var{DraggablePopover:iX,NativeWidget:Zk}=L,KP=class pL extends iX{constructor(t,i){super(t,i),this.dragHandleDraggingClass="ag-charts-dialog__drag-handle--dragging",this.colorPicker=new JE(this.ctx,{detached:!0}),this.cleanup.register(t.eventsHub.on("layout:complete",this.onLayoutComplete.bind(this)))}showWithChildren(t,i){const s=super.showWithChildren(t,i);return s.classList.add("ag-charts-dialog"),s.setAttribute("role","dialog"),s.addEventListener("mousedown",n=>{n.target.classList?.contains("ag-charts-dialog__color-picker-button")||this.colorPicker.hide()}),s.addEventListener("keydown",this.onKeyDown.bind(this)),Ve().requestAnimationFrame(()=>this.reposition()),this.colorPicker.attachTo(this),s}updatePosition(t){super.updatePosition(t);const{anchor:i,fallbackAnchor:s}=this.getColorPickerAnchors()??{};i&&this.colorPicker.setAnchor(i,s)}createTabs(t,i,s){const n=xe("div","ag-charts-dialog__tabs"),o=Dc(s,()=>ur()),a=Dc(s,()=>ur());for(const[p,f]of ht(s))oo(f.panel,{id:a[p],role:"tabpanel","aria-labelledby":o[p]});const r=p=>{for(const[f,y]of ht(s))y.panel.classList.toggle("ag-charts-dialog__tab-panel--active",f===p),h[f].classList.toggle("ag-charts-dialog__tab-button--active",f===p),Fe(h[f],"aria-selected",f===p),f===p&&y.onShow?.()},l=new Zk(xe("div","ag-charts-dialog__header"));l.addListener("drag-start",p=>{const{sourceEvent:f}=p;f.target instanceof Element&&f.target.classList.contains("ag-charts-dialog__header")&&this.onDragStart(p)}),l.addListener("drag-move",p=>this.onDragMove(p)),l.addListener("drag-end",()=>this.onDragEnd());const c=new nX;this.setDragHandle(c);const h=Dc(s,(p,f)=>Kd({label:this.ctx.localeManager.t(p.label),onPress:()=>r(f)},{id:o[f],class:"ag-charts-dialog__tab-button",role:"tab","aria-controls":a[f]})),d=xe("div","ag-charts-dialog__tab-list");oo(d,{role:"tablist","aria-label":this.ctx.localeManager.t(t)}),d.append(...Object.values(h));const u=this.createHeaderCloseButton();return l.getElement().append(c.getElement(),d,u),n.append(l.getElement(),...Object.values(s).map(p=>p.panel)),r(i),uy({orientation:"horizontal",buttons:Object.values(h)}),{tabs:n,initialFocus:h[i]}}createTabPanel(){return xe("div","ag-charts-dialog__tab-panel")}createInputGroupLine(){return xe("div","ag-charts-dialog__input-group-line")}createRadioGroup({label:t,options:i,value:s,onChange:n}){const o=this.createInputGroup(t);oo(o,{role:"radiogroup",tabindex:-1,"aria-label":this.ctx.localeManager.t(t)});const a="ag-charts-dialog__button--active",r=[];for(const l of i){const{icon:c,altText:h}=l,d=this.ctx.localeManager.t(h),u=Kd({icon:c,altText:d,onPress:()=>{for(const p of Array.from(o.children))p.classList.remove(a),p.ariaChecked="false";u.classList.add(a),u.ariaChecked="true",n(l.value)}},{"aria-checked":l.value===s,class:"ag-charts-dialog__button",role:"radio",title:d});l.value===s&&u.classList.add(a),o.appendChild(u),r.push(u)}return uy({orientation:"horizontal",buttons:r}),o}createSelect({altText:t,label:i,options:s,value:n,onChange:o}){const a=this.createInputGroup(i),r=this.ctx.localeManager.t(t),l=aM({value:n,options:s,onChange:o},{class:"ag-charts-dialog__select","aria-label":r,title:r});return a.append(l),a}createTextArea({placeholder:t,value:i,onChange:s}){const n=t?this.ctx.localeManager.t(t):void 0;return rM({value:i,onChange:s},{placeholder:n})}createCheckbox({label:t,checked:i,onChange:s}){const n=ur(),o=this.createInputGroup(t,{for:n}),a=oM({checked:i,onChange:s},{class:"ag-charts-dialog__checkbox",role:"switch",id:n});return o.append(a),o}createColorPicker({color:t,opacity:i,label:s,altText:n,onChange:o,onChangeHide:a,isMultiColor:r,hasMultiColorOption:l}){const c=this.createInputGroup(s),h=this.ctx.localeManager.t(n),d=Kd({label:h,onPress:u=>{const{anchor:p,fallbackAnchor:f}=this.getColorPickerAnchors(d)??{};this.colorPicker.show({anchor:p,fallbackAnchor:f,color:t,opacity:i,isMultiColor:r,hasMultiColorOption:l,sourceEvent:u,onChange:(y,b,x,v)=>{d.style.setProperty("--color",y),d.classList.toggle("ag-charts-dialog__color-picker-button--multi-color",v),o(y,b,x,v)},onChangeHide:a})}},{"aria-label":h,tabindex:0,class:"ag-charts-dialog__color-picker-button",title:h});if(r)d.classList.toggle("ag-charts-dialog__color-picker-button--multi-color");else if(t){const u=Be.fromString(t),p=new Be(u.r,u.g,u.b,i);d.style.setProperty("--color",p.toHexString())}return c.append(d),this.hideFns.push(()=>{this.colorPicker.hide()}),c}createHeaderCloseButton(){return Kd({icon:"close",altText:this.ctx.localeManager.t("iconAltTextClose"),onPress:()=>this.hide()},{class:"ag-charts-dialog__close-button"})}createInputGroup(t,i){const s=xe("div","ag-charts-dialog__input-group"),n=xe("label","ag-charts-dialog__input-group-label");return n.innerText=this.ctx.localeManager.t(t),Fe(n,"for",i?.for),s.appendChild(n),s}onLayoutComplete(t){this.seriesRect=t.series.paddedRect,this.reposition()}onKeyDown(t){t.altKey||t.ctrlKey||t.metaKey||t.isComposing||t.key!=="Escape"||this.hide()}reposition(){const{seriesRect:t,ctx:i}=this,s=this.getPopoverElement();if(!t||!s)return;const n=i.domManager.getBoundingClientRect(),o=H.from(0,t.y),a=H.from(n.width,t.height),r=H.from(s),l=H.from(.5,1);let c;if(t.width>1e3){const h=H.sub(H.add(o,H.multiply(a,l)),H.multiply(r,l));c=H.sub(h,H.from(0,pL.offset))}else{const h=H.sub(H.add(o,a),r);c=H.sub(h,pL.offset)}this.updatePosition(c)}getColorPickerAnchors(t){if(t&&(this.colorPickerAnchorElement=t),!this.colorPickerAnchorElement)return;const i=this.colorPickerAnchorElement.getBoundingClientRect(),s=this.ctx.domManager.getBoundingClientRect(),n=H.sub(H.from(i.x,i.y),H.from(s.left,s.top)),o=H.add(n,H.from(0,i.height+5)),a=H.sub(n,H.from(0,5));return{anchor:o,fallbackAnchor:a}}};KP.offset=60;var sX=KP,nX=class extends Zk{constructor(){super(xe("div","ag-charts-dialog__drag-handle"));const e=new Zk(xe("span",pl("drag-handle")));e.setAriaHidden(!0),this.addChild(e)}},oX=class extends sX{constructor(e){super(e,"settings"),this.events=new Sn,this.hideFns.push(()=>this.events.emit("hidden",null))}show(e,t){const i=this.createLinearLineTab(e,t),s=this.createLinearTextTab(e,t);let n="dialogHeaderLine";Wr(e)?n="dialogHeaderChannel":XE(e)?n="dialogHeaderFibonacciRange":e.type==="date-range"?n="dialogHeaderDateRange":e.type==="price-range"?n="dialogHeaderPriceRange":e.type==="date-price-range"&&(n="dialogHeaderDatePriceRange");const{tabs:o,initialFocus:a}=this.createTabs("ariaLabelSettingsTabBar",t.initialSelectedTab,{line:{label:n,panel:i},text:{label:"dialogHeaderText",panel:s.panel,onShow:s.onShow}});t.initialFocus=a,this.showWithChildren([o],t).classList.add("ag-charts-dialog--annotation-settings")}createLinearLineTab(e,t){const i=this.createTabPanel(),s=this.createInputGroupLine(),n=this.createInputGroupLine(),o="isMultiColor"in e,a=this.createColorPickerInput("line-color",e.getDefaultColor("line-color"),e.getDefaultOpacity("line-color"),o?e.isMultiColor:!1,o,t.onChangeLineColor,t.onChangeHideLineColor),r=this.createStrokeWidthSelect(e.strokeWidth??2,t.onChangeLineStyleWidth),l=this.createLineStyleRadioGroup(e.lineStyle??"solid",t.onChangeLineStyleType);if(s.append(a),"background"in e){const c=this.createColorPickerInput("fill-color",e.getDefaultColor("fill-color"),e.getDefaultOpacity("fill-color"),!1,!1,t.onChangeFillColor,t.onChangeHideFillColor);s.append(c),n.append(r)}else"showFill"in e?(s.append(this.createCheckbox({label:"dialogInputShowFill",checked:e.showFill??!0,onChange:c=>t.onChangeLine({showFill:c})})),n.append(r)):s.append(r);return n.append(l),i.append(s,n),"bands"in e&&i.append(this.createFibonacciRatioSelect(e.bands??10,c=>t.onChangeLine({bands:c}))),"extendStart"in e&&"extendEnd"in e&&i.append(this.createCheckbox({label:Wr(e)?"dialogInputExtendChannelStart":"dialogInputExtendLineStart",checked:e.extendStart??!1,onChange:c=>t.onChangeLine({extendStart:c})}),this.createCheckbox({label:Wr(e)?"dialogInputExtendChannelEnd":"dialogInputExtendLineEnd",checked:e.extendEnd??!1,onChange:c=>t.onChangeLine({extendEnd:c})})),"extendAbove"in e&&"extendBelow"in e&&i.append(this.createCheckbox({label:"dialogInputExtendAbove",checked:e.extendAbove??!1,onChange:c=>t.onChangeLine({extendAbove:c})}),this.createCheckbox({label:"dialogInputExtendBelow",checked:e.extendBelow??!1,onChange:c=>t.onChangeLine({extendBelow:c})})),"extendLeft"in e&&"extendRight"in e&&i.append(this.createCheckbox({label:"dialogInputExtendLeft",checked:e.extendLeft??!1,onChange:c=>t.onChangeLine({extendLeft:c})}),this.createCheckbox({label:"dialogInputExtendRight",checked:e.extendRight??!1,onChange:c=>t.onChangeLine({extendRight:c})})),"reverse"in e&&"showFill"in e&&i.append(this.createCheckbox({label:"dialogInputReverse",checked:e.reverse??!1,onChange:c=>t.onChangeLine({reverse:c})})),i}createLinearTextTab(e,t){const i=this.createTabPanel(),s=this.createTextArea({placeholder:"inputTextareaPlaceholder",value:e.text.label,onChange:h=>t.onChangeText({label:h})}),n=this.createFontSizeSelect(e.text.fontSize,t.onChangeTextFontSize),o=this.createColorPickerInput("text-color",e.text.color,1,!1,!1,t.onChangeTextColor,t.onChangeHideTextColor),a=e.text.position==="inside"?"center":e.text.position,r=this.createPositionRadioGroup(a??"top",h=>t.onChangeText({position:h})),l=this.createAlignmentRadioGroup(e.text.alignment??"center",h=>t.onChangeText({alignment:h})),c=this.createInputGroupLine();return c.append(n,o,r,l),i.append(s,c),{panel:i,onShow:()=>Qm(s)}}createColorPickerInput(e,t,i,s,n,o,a){const r=e==="fill-color"?"dialogInputFillColorPicker":"dialogInputColorPicker",l=e==="fill-color"?"dialogInputFillColorPickerAltText":"dialogInputColorPickerAltText";return this.createColorPicker({label:r,altText:l,color:t,opacity:i,isMultiColor:s,hasMultiColorOption:n,onChange:o,onChangeHide:a})}createStrokeWidthSelect(e,t){return this.createSelect({label:"dialogInputStrokeWidth",altText:"dialogInputStrokeWidthAltText",options:tP.map(({label:i,value:s})=>({label:i,value:`${s}`})),value:String(e),onChange:i=>t(Number(i))})}createFibonacciRatioSelect(e,t){return this.createSelect({label:"dialogInputFibonacciBands",altText:"dialogInputFibonacciBandsAltText",options:mZ.map(({label:i,value:s})=>({label:i,value:`${s}`})),value:String(e),onChange:i=>t(Number(i))})}createLineStyleRadioGroup(e,t){return this.createRadioGroup({label:"dialogInputLineStyle",options:[{icon:"line-style-solid",altText:"iconAltTextLineStyleSolid",value:"solid"},{icon:"line-style-dashed",altText:"iconAltTextLineStyleDashed",value:"dashed"},{icon:"line-style-dotted",altText:"iconAltTextLineStyleDotted",value:"dotted"}],value:e,onChange:t})}createFontSizeSelect(e,t){return this.createSelect({label:"dialogInputFontSize",altText:"dialogInputFontSizeAltText",options:iP.map(({label:i,value:s})=>({label:i,value:String(s)})),value:String(e),onChange:i=>t(Number(i))})}createPositionRadioGroup(e,t){return this.createRadioGroup({label:"dialogInputPosition",options:[{icon:"position-top",altText:"iconAltTextPositionTop",value:"top"},{icon:"position-center",altText:"iconAltTextPositionCenter",value:"center"},{icon:"position-bottom",altText:"iconAltTextPositionBottom",value:"bottom"}],value:e,onChange:t})}createAlignmentRadioGroup(e,t){return this.createRadioGroup({label:"dialogInputAlign",options:[{icon:"align-left",altText:"iconAltTextAlignLeft",value:"left"},{icon:"align-center",altText:"iconAltTextAlignCenter",value:"center"},{icon:"align-right",altText:"iconAltTextAlignRight",value:"right"}],value:e,onChange:t})}};function Xk(e){return e.gridPadding+e.seriesAreaPadding+e.tickSize+e.label.spacing}function aX(e,t,i){for(const{update:s}of Object.values(Gn))s(e,t,i)}var{InteractionState:gn,keyProperty:rX,valueProperty:lX,Selection:cX,BBox:hX}=L,op=class o_ extends bi{constructor(t){super(),this.ctx=t,this.toolbar=new qb(this.ctx),this.optionsToolbar=new zk(this.ctx,()=>{const i=this.state.getActive();if(i!=null)return kh(this.annotationData.at(i))}),this.axesButtons=new vk,this.enabled=!0,this.snap=!1,this.data=void 0,this.xKey=void 0,this.volumeKey=void 0,this.annotationData=new Pi(o_.createAnnotationDatum),this.defaults=new uZ,this.container=new L.Group({name:"static-annotations"}),this.annotations=new cX(this.container,this.createAnnotationScene.bind(this)),this.settingsDialog=new oX(this.ctx),this.textInput=new G5(this.ctx),this.postUpdateFns=[],this.state=this.setupStateMachine(),this.setupListeners(),this.setupDOM(),this.ctx.historyManager.addMementoOriginator(t.annotationManager),this.ctx.historyManager.addMementoOriginator(this.defaults),this.textInput.setKeyDownHandler(this.onTextInput.bind(this)),this.cleanup.register(()=>{this.clear(),this.xAxis?.button?.destroy(),this.yAxis?.button?.destroy(),this.textInput.destroy()})}setupStateMachine(){const{ctx:t}=this;return new Xb({resetToIdle:()=>{t.domManager.updateCursor("annotations"),this.popAnnotationState(gn.Annotations),this.hideOverlays(),this.optionsToolbar.hide(),this.deleteEphemeralAnnotations(),this.update()},hoverAtCoords:(i,s,n)=>{let o;return this.annotations.each((a,r,l)=>{if(!r.isHoverable())return;const c=a.containsPoint(i.x,i.y);c&&(o??(o=l)),a.toggleHovered(c,s===l,r.readOnly)}),o!=null?t.tooltipManager.suppressTooltip("annotations"):this.isAnnotationState()||t.tooltipManager.unsuppressTooltip("annotations"),(o==null||!this.annotationData.at(o)?.readOnly)&&this.ctx.domManager.updateCursor("annotations",o==null?void 0:this.annotations.at(o)?.getCursor()),o!==n&&this.update(),o},getNodeAtCoords:(i,s)=>{const n=this.annotations.at(s);if(n)return n.getNodeAtCoords(i.x,i.y)},translate:(i,s)=>{const n=this.annotations.at(i),o=kh(this.annotationData.at(i));if(!(!n||!o))return this.translateNode(n,o,s)},copy:i=>{const s=this.annotations.at(i),n=kh(this.annotationData.at(i));if(!(!s||!n))return this.createAnnotationDatumCopy(s,n)},paste:i=>{this.createAnnotation(i.type,i,!1),this.postUpdateFns.push(()=>{this.state.transitionAsync("selectLast"),this.state.transitionAsync("copy")})},select:(i,s)=>{const{annotations:n,optionsToolbar:o,toolbar:a}=this;this.hideOverlays(),a.clearActiveButton(),a.resetButtonIcons();const r=i==null?null:n.at(i),l=s==null?null:n.at(s),c=i==null?null:this.annotationData.at(i);l===r&&r!=null||(l?.toggleActive(!1),o.hide(),r&&!c?.readOnly?(this.pushAnnotationState(gn.AnnotationsSelected),r.toggleActive(!0),Jl(c)||(o.updateButtons(this.annotationData.at(i)),this.postUpdateFns.push(()=>{o.show(),o.setAnchorScene(r)}))):(this.popAnnotationState(gn.AnnotationsSelected),this.popAnnotationState(gn.Annotations)),Jl(c)||this.deleteEphemeralAnnotations(),this.update())},selectLast:()=>(this.pushAnnotationState(gn.AnnotationsSelected),this.annotationData.length-1),startInteracting:()=>{this.pushAnnotationState(gn.Annotations)},stopInteracting:()=>{this.popAnnotationState(gn.Annotations)},create:(i,s)=>{this.createAnnotation(i,s)},delete:i=>{this.annotationData.splice(i,1)},deleteAll:()=>{const i=this.annotationData.filter(s=>{if(s.readOnly===!0)return s});this.annotationData.splice(0,this.annotationData.length);for(const s of i)this.annotationData.push(s)},validatePoint:(i,s)=>{const n=this.getAnnotationContext();return n?Vb(n,i,s):!0},getAnnotationType:i=>j5(this.annotationData[i].type),datum:i=>this.annotationData.at(i),node:i=>this.annotations.at(i),recordAction:i=>{this.recordActionAfterNextUpdate(i)},update:()=>{this.postUpdateFns.push(()=>{const i=this.state.getActive(),s=i==null?null:this.annotations.at(i);s!=null&&this.optionsToolbar.setAnchorScene(s)}),this.update()},showTextInput:i=>{const s=kh(this.annotationData.at(i));if(!this.annotations.at(i)||!s||!("getTextInputCoords"in s)||!("getTextPosition"in s))return;const o={color:s.color,fontFamily:s.fontFamily,fontSize:s.fontSize,fontStyle:s.fontStyle,fontWeight:s.fontWeight,placeholderColor:s.getPlaceholderColor()},a=this.getAnnotationContext(),r=c=>H.add(s.getTextInputCoords(a,c),H.required(this.seriesRect)),l=()=>s.getTextPosition();this.textInput.show({styles:o,layout:{getTextInputCoords:r,getTextPosition:l,alignment:s.alignment,textAlign:s.textAlign,width:s.width},text:s.text,placeholderText:s.placeholderText,onChange:(c,h)=>{this.state.transition("updateTextInputBBox",h)}}),this.ctx.domManager.updateCursor("annotations")},hideTextInput:()=>{this.textInput.hide()},updateTextInputColor:i=>{this.textInput.updateColor(i)},updateTextInputFontSize:i=>{const s=this.textInput.updateFontSize(i);this.state.transition("updateTextInputBBox",s)},updateTextInputBBox:i=>{this.state.transition("updateTextInputBBox",i)},showAnnotationOptions:i=>{const s=this.annotations.at(i);!s||Jl(this.annotationData.at(i))||(this.optionsToolbar.updateButtons(this.annotationData.at(i)),this.optionsToolbar.show(),this.optionsToolbar.setAnchorScene(s))},showAnnotationSettings:(i,s,n="line")=>{const o=this.annotationData.at(i);if(!wb(o)&&!Wr(o)&&!Af(o)||Jl(o))return;const a=c=>(h,d,u,p)=>{this.setColorAndDefault(o.type,c,h,d,u,p),this.optionsToolbar.updateColorPickerColor(c,d,u,p)},r=c=>()=>{this.recordActionAfterNextUpdate(`Change ${o.type} ${c} to ${o.getDefaultColor(c)}`,["annotations","defaults"]),this.update()},l={initialSelectedTab:n,ariaLabel:this.ctx.localeManager.t("ariaLabelAnnotationSettingsDialog"),sourceEvent:s,onChangeLine:c=>{this.state.transition("lineProps",c),c.bands!=null&&this.defaults.setDefaultFibonacciOptions(o.type,"bands",c.bands),c.reverse!=null&&this.defaults.setDefaultFibonacciOptions(o.type,"reverse",c.reverse),c.showFill!=null&&this.defaults.setDefaultFibonacciOptions(o.type,"showFill",c.showFill)},onChangeText:c=>{this.state.transition("lineText",c),c.alignment&&this.defaults.setDefaultLineTextAlignment(o.type,c.alignment),c.position&&this.defaults.setDefaultLineTextPosition(o.type,c.position),this.recordActionAfterNextUpdate(`Change ${o.type} text ${Object.keys(c).map(h=>`${h} to ${c[h]}`).join(", ")}`)},onChangeFillColor:a("fill-color"),onChangeHideFillColor:r("fill-color"),onChangeLineColor:a("line-color"),onChangeHideLineColor:r("line-color"),onChangeLineStyleType:c=>{this.setLineStyleTypeAndDefault(o.type,c),this.optionsToolbar.updateLineStyleType(Cf.find(h=>h.value===c)??Cf[0])},onChangeLineStyleWidth:c=>{this.setLineStyleWidthAndDefault(o.type,c),this.optionsToolbar.updateStrokeWidth({strokeWidth:c,value:c,label:String(c)})},onChangeTextColor:a("text-color"),onChangeHideTextColor:r("text-color"),onChangeTextFontSize:c=>{this.setFontSizeAndDefault(o.type,c)}};this.settingsDialog.show(o,l)}})}setupListeners(){const{ctx:t,optionsToolbar:i,settingsDialog:s,toolbar:n}=this,{seriesWidget:o,seriesDragInterpreter:a,chartWidget:r}=t.widgets;a&&this.cleanup.register(a.events.on("click",this.hoverTouchPreHandler.bind(this)),a.events.on("drag-start",this.hoverTouchPreHandler.bind(this)),a.events.on("drag-move",this.dragMoveTouchPreHandler.bind(this)),a.events.on("mousemove",this.onHover.bind(this)),a.events.on("click",this.onClick.bind(this)),a.events.on("dblclick",this.onDoubleClick.bind(this)),a.events.on("drag-start",this.onDragStart.bind(this)),a.events.on("drag-move",this.onDrag.bind(this)),a.events.on("drag-end",this.onDragEnd.bind(this))),this.cleanup.register(o.addListener("keydown",this.onKeyDown.bind(this)),o.addListener("keyup",this.onKeyUp.bind(this)),r.addListener("click",this.onCancel.bind(this)),t.eventsHub.on("annotations:restore",this.onRestoreAnnotations.bind(this)),t.eventsHub.on("layout:complete",this.onLayoutComplete.bind(this)),t.updateService.addListener("pre-scene-render",this.onPreRender.bind(this)),t.eventsHub.on("zoom:change-complete",()=>this.onResize()),t.eventsHub.on("dom:resize",()=>this.onResize()),n.events.on("cancel-create-annotation",()=>{this.cancel(),this.reset(),this.update()}),n.events.on("pressed-create-annotation",({annotation:l})=>{this.cancel(),this.pushAnnotationState(gn.Annotations),this.state.transition(l),this.update()}),n.events.on("pressed-clear",()=>{this.clear(),this.recordActionAfterNextUpdate("Clear all")}),n.events.on("pressed-show-menu",()=>{this.cancel(),this.reset()}),n.events.on("pressed-unrelated",()=>{this.reset()}),i.events.on("pressed-delete",()=>{this.cancel(),this.delete(),this.reset()}),i.events.on("pressed-settings",({sourceEvent:l})=>{this.state.transition("toolbarPressSettings",l)}),i.events.on("pressed-lock",({locked:l})=>{this.recordActionAfterNextUpdate(l?"Locked":"Unlocked"),this.update()}),i.events.on("hid-overlays",()=>{this.settingsDialog.hide()}),i.events.on("saved-color",({type:l,colorPickerType:c,color:h})=>{this.recordActionAfterNextUpdate(`Change ${l} ${c} to ${h}`,["annotations","defaults"])}),i.events.on("updated-color",({type:l,colorPickerType:c,colorOpacity:h,color:d,opacity:u,isMultiColor:p})=>{this.setColorAndDefault(l,c,h,d,u,p)}),i.events.on("updated-font-size",({type:l,fontSize:c})=>{this.setFontSizeAndDefault(l,c)}),i.events.on("updated-line-style",({type:l,lineStyleType:c})=>{this.setLineStyleTypeAndDefault(l,c)}),i.events.on("updated-line-width",({type:l,strokeWidth:c})=>{this.setLineStyleWidthAndDefault(l,c)}),s.events.on("hidden",()=>{this.optionsToolbar.clearActiveButton()}))}setupDOM(){const{ctx:t,toolbar:i,optionsToolbar:s}=this;this.cleanup.register(t.annotationManager.attachNode(this.container),()=>{t.domManager.removeStyles(Nf),i.destroy(),s.destroy()})}async processData(t){if(!this.enabled||this.data==null||this.xKey==null||this.volumeKey==null)return;const i=[rX(this.xKey,void 0,{id:"date"}),lX(this.volumeKey,"number",{id:"volume"})],s=L.DataSet.wrap(this.data)??L.DataSet.empty(),{dataModel:n,processedData:o}=await t.request("annotations",s,{props:i});this.dataModel=n,this.processedData=o}createAnnotationScene(t){if(t.type in Gn)return new Gn[t.type].scene;throw new Error(`AG Charts - Cannot create annotation scene of type [${t.type}], expected one of [${Object.keys(Gn)}], ignoring.`)}static createAnnotationDatum(t){if(t.type in Gn)return new Gn[t.type].datum().set(t);throw new Error(`AG Charts - Cannot create annotation datum of unknown type [${t.type}], expected one of [${Object.keys(Gn)}], ignoring.`)}createAnnotation(t,i,s=!0){if(this.annotationData.push(i),s){const n=this.ctx.annotationManager.getAnnotationTypeStyles(t);n&&i.set(n),this.defaults.applyDefaults(i)}this.injectDatumDependencies(i),this.update()}injectDatumDependencies(t){"setLocaleManager"in t&&t.setLocaleManager(this.ctx.localeManager),"getVolume"in t&&(t.getVolume=this.getDatumRangeVolume.bind(this))}getDatumRangeVolume(t,i){const{dataModel:s,processedData:n}=this;let o=wi(t),a=wi(i);if(!tl(o)||!tl(a)||!s||!n||this.volumeKey==null)return;o>a&&([o,a]=[a,o]);const r=s.resolveKeysById({id:"annotations"},"date",n),l=s.resolveColumnById({id:"annotations"},"volume",n);let c=0;for(let h=0;h<n.input.count;h++){const d=r[h];tl(d)&&d>=o&&d<=a&&(c+=l[h])}return c}translateNode(t,i,s){const n=this.getAnnotationConfig(i),o=this.getAnnotationContext();o&&n.translate(t,i,s,o)}createAnnotationDatumCopy(t,i){const s=this.getAnnotationConfig(i),n=new s.datum;n.set(i.toJson());const o=this.getAnnotationContext();if(o)return s.copy(t,i,n,o)}getAnnotationConfig(t){if(t.type in Gn)return Gn[t.type];throw new Error(`AG Charts - Cannot get annotation config of unknown type [${t.type}], expected one of [${Object.keys(Gn)}], ignoring.`)}onRestoreAnnotations(t){this.enabled&&(this.clear(),this.annotationData.set(t.annotations),this.postUpdateFns.push(()=>{this.ctx.annotationManager.fireChangedEvent()}),this.update())}onLayoutComplete(t){if(!this.enabled)return;const i=t.series.paddedRect;this.seriesRect=i,this.container.setClipRect(i),this.xAxis=this.getAxis(t.axes.x,i,this.xAxis?.button),this.yAxis=this.getAxis(t.axes.y,i,this.yAxis?.button),this.showAnnotations()?this.animateAnnotations({from:0,to:1,phase:"trailing"}):this.animateAnnotations({from:1,to:0,phase:"remove"})}showAnnotations(){if(!this.yAxis||!this.xAxis)return!1;const t=this.ctx.chartService.series.some(n=>n.hasData),s=this.yAxis.context.seriesIds().some(n=>this.ctx.chartService.series.find(a=>a.id===n)?.visible);return t&&s}animateAnnotations({from:t,to:i,phase:s}){const{annotations:n}=this;this.ctx.animationManager?.animate({from:t,to:i,id:"chart-annotations",phase:s,groupId:"opacity",onUpdate(o){n.each(a=>{a.opacity=o,"setAxisLabelOpacity"in a&&a.setAxisLabelOpacity(o)})},onStop(){n.each(o=>{o.opacity=i,"setAxisLabelOpacity"in o&&o.setAxisLabelOpacity(i)})}})}onPreRender(){this.enabled&&(this.updateAnnotations(),this.state.transition("render"))}getAxis(t,i,s){const n=this.ctx.axisManager.getAxisContext(t.direction)[0],{position:o="bottom",direction:a}=n,r=t.gridPadding+t.seriesAreaPadding,l=new hX(0,0,i.width,i.height).grow(r,o),c=a==="x"?"vertical":"horizontal",{axesButtons:h,snap:d}=this;if(this.enabled&&h.enabled&&(h.axes==="xy"||h.axes===a)){s??(s=new UP(this.ctx,{...n,snapToGroup:d},f=>this.onAxisButtonClick(f,c),i));const p=Xk(t);s.update(i,p)}else s?.destroy(),s=void 0;return{layout:t,context:n,bounds:l,button:s}}recordActionAfterNextUpdate(t,i=["annotations"]){const{defaults:s,ctx:{annotationManager:n,historyManager:o}}=this,a=i.map(r=>r==="defaults"?s:n);this.postUpdateFns.push(()=>{o.record(t,...a),n.fireChangedEvent()})}setColorAndDefault(t,i,s,n,o,a){this.state.transition("color",{colorPickerType:i,colorOpacity:s,color:n,opacity:o,isMultiColor:a}),this.defaults.setDefaultColor(t,i,s,n,o,a)}setFontSizeAndDefault(t,i){this.state.transition("fontSize",i),this.defaults.setDefaultFontSize(t,i),this.recordActionAfterNextUpdate(`Change ${t} font size to ${i}`,["annotations","defaults"])}setLineStyleTypeAndDefault(t,i){this.state.transition("lineStyle",{type:i}),this.defaults.setDefaultLineStyleType(t,i),this.recordActionAfterNextUpdate(`Change ${t} line style to ${i}`,["annotations","defaults"])}setLineStyleWidthAndDefault(t,i){this.state.transition("lineStyle",{strokeWidth:i}),this.defaults.setDefaultLineStyleWidth(t,i),this.recordActionAfterNextUpdate(`Change ${t} stroke width to ${i}`,["annotations","defaults"])}updateAnnotations(){const{annotationData:t,annotations:i,seriesRect:s,ctx:{annotationManager:n}}=this,o=this.getAnnotationContext();if(!s||!o)return;n.updateData(t.toJson());const a=this.showAnnotations();this.toolbar.refreshButtonsEnabled(a),this.toolbar.toggleClearButtonEnabled(t.length>0&&a),i.update(t??[],void 0,r=>r.id).each((r,l)=>{if(!a){r.visible=!1,"setAxisLabelVisible"in r&&r.setAxisLabelVisible(!1);return}"setAxisLabelVisible"in r&&r.setAxisLabelVisible(!0),this.injectDatumDependencies(l),aX(r,l,o)});for(const r of this.postUpdateFns)r();this.postUpdateFns=[]}getAnnotationContext(){const{seriesRect:t,xAxis:i,yAxis:s,snap:n}=this;if(t&&i&&s)return{seriesRect:t,xAxis:{...i.context,bounds:i.bounds,labelPadding:Xk(i.layout),snapToGroup:n},yAxis:{...s.context,bounds:s.bounds,labelPadding:Xk(i.layout),snapToGroup:n}}}onHover(t){const{state:i}=this,s=this.getAnnotationContext();if(!s)return;const n=t.sourceEvent.shiftKey,o=H.from(t),a=en(o,s);i.transition("hover",{offset:o,point:a,shiftKey:n,context:s})}onClick(t){const{state:i}=this,s=this.getAnnotationContext();if(!s)return;const n=t.sourceEvent.shiftKey,o=en(H.from(t),s),a=this.textInput.getValue(),r=this.textInput.getBBox();i.transition("click",{point:o,shiftKey:n,textInputValue:a,bbox:r})}onDoubleClick(t){const{state:i}=this;if(!this.getAnnotationContext())return;const n=H.from(t);i.transition("dblclick",{offset:n})}onAxisButtonClick(t,i){this.cancel(),this.reset();const s=this.getAnnotationContext();if(!this.annotationData||!s)return;const{state:n}=this;this.pushAnnotationState(gn.Annotations);const o=i==="horizontal";if(n.transition(o?"horizontal-line":"vertical-line"),this.optionsToolbar.hide(),!t)return;const a=en(t,s);Vb(s,a)&&(n.transition("click",{point:a,shiftKey:!1}),this.update())}onResize(){const t=this.textInput.getValue(),i=this.textInput.getBBox();this.state.transition("resize",{textInputValue:t,bbox:i})}hoverTouchPreHandler(t){t.device==="touch"&&this.onHover(t)}dragMoveTouchPreHandler(t){t.device==="touch"&&this.ctx.interactionManager.isState(gn.AnnotationsSelected)&&t.sourceEvent.preventDefault()}onDragStart(t){if(!this.ctx.interactionManager.isState(gn.AnnotationsDraggable))return;const i=this.getAnnotationContext();if(!i)return;const s=H.from(t),n=en(s,i),o=this.textInput.getValue(),a=this.textInput.getBBox();this.state.transition("dragStart",{context:i,offset:s,point:n,textInputValue:o,bbox:a})}onDrag(t){if(!this.ctx.interactionManager.isState(gn.AnnotationsDraggable))return;const i=this.getAnnotationContext();if(!i)return;const s=H.from(t),n=en(s,i),o=t.sourceEvent.shiftKey,a=this.textInput.getValue(),r=this.textInput.getBBox();this.state.transition("drag",{context:i,offset:s,point:n,shiftKey:o,textInputValue:a,bbox:r})}onDragEnd(){this.state.transition("dragEnd")}onCancel(t){const{sourceEvent:i}=t??{};i?.currentTarget===i?.target&&(this.cancel(),this.reset())}onDelete(){this.textInput.isVisible()||(this.cancel(),this.delete(),this.reset(),this.update())}onTextInput(t){const{state:i}=this,s=this.getAnnotationContext();if(!s)return;const{key:n,shiftKey:o}=t,a=this.textInput.getValue(),r=this.textInput.getBBox();i.transition("textInput",{key:n,shiftKey:o,textInputValue:a,bbox:r,context:s})}onKeyDown(t){const{state:i}=this,s=this.getAnnotationContext();if(!s)return;const{sourceEvent:n}=t,{shiftKey:o,ctrlKey:a,metaKey:r}=n,l=a||r,c=a||o;i.transition("keyDown",{shiftKey:o,context:s});const h={x:0,y:0},d=Math.max(s?.xAxis.scale.bandwidth??0,c?10:1),u=Math.max(s?.yAxis.scale.bandwidth??0,c?10:1);switch(n.key){case"ArrowDown":h.y=u;break;case"ArrowUp":h.y=-u;break;case"ArrowLeft":h.x=-d;break;case"ArrowRight":h.x=d;break;case"Escape":this.onCancel();return;case"Backspace":case"Delete":this.onDelete();return}if((h.x||h.y)&&(i.transition("translate",{translation:h}),n.stopPropagation(),n.preventDefault()),!!l)switch(n.key){case"c":i.transition("copy");return;case"x":i.transition("cut"),this.recordActionAfterNextUpdate("Cut annotation");return;case"v":i.transition("paste"),this.recordActionAfterNextUpdate("Paste annotation");return}}onKeyUp(t){const{shiftKey:i}=t.sourceEvent,s=this.getAnnotationContext();s&&(this.state.transition("keyUp",{shiftKey:i,context:s}),this.state.transition("translateEnd"))}clear(){this.cancel(),this.deleteAll(),this.reset()}reset(){this.state.transition("reset")}cancel(){this.state.transition("cancel")}delete(){this.state.transition("delete")}deleteAll(){this.state.transition("deleteAll")}deleteEphemeralAnnotations(){let t=!1;for(const[i,s]of this.annotationData.entries())Jl(s)&&(this.annotationData.splice(i,1),t=!0);t&&this.recordActionAfterNextUpdate("Delete ephemeral annotations")}hideOverlays(){this.settingsDialog.hide(),this.toolbar.hideOverlays(),this.optionsToolbar.hideOverlays()}pushAnnotationState(t){this.ctx.interactionManager.pushState(t),this.ctx.tooltipManager.suppressTooltip("annotations")}popAnnotationState(t){this.ctx.interactionManager.popState(t),this.ctx.tooltipManager.unsuppressTooltip("annotations")}isAnnotationState(){return this.ctx.interactionManager.isState(gn.Annotations)||this.ctx.interactionManager.isState(gn.AnnotationsSelected)}update(t=6){this.ctx.updateService.update(t)}};g([m],op.prototype,"toolbar",2),g([m],op.prototype,"optionsToolbar",2),g([m],op.prototype,"axesButtons",2),g([m,Wt((e,t)=>{const i=t??!0;e.toolbar.enabled=i,e.optionsToolbar.enabled=i,e.axesButtons.enabled=i})],op.prototype,"enabled",2),g([m],op.prototype,"snap",2);var dX=op,vo={stroke:{$ref:"foregroundColor"},strokeOpacity:1,strokeWidth:2},ys={fill:md,strokeOpacity:1,strokeWidth:2},Ah={color:{$ref:"chartBackgroundColor"},fontSize:{$rem:Si.LARGE},fontFamily:{$ref:"fontFamily"}},YP={...Ah,enabled:!0,fill:{$ref:"foregroundColor"},fontSize:{$ref:"fontSize"}},Qb={...Ah,textAlign:"left"},Ch={...Ah,position:"top",alignment:"center",color:{$ref:"textColor"}},ZP={...Ah,position:"top",alignment:"center",color:{$ref:"textColor"}},qk={...Ah,fontSize:{$ref:"fontSize"},color:bd,fill:yd,stroke:xd,strokeWidth:1,divider:{stroke:vd,strokeWidth:1,strokeOpacity:.5}},Qk={...vo,background:{fill:{$ref:"foregroundColor"},fillOpacity:.075},handle:{...ys},text:{...Ch},statistics:{...qk}},uX={buttons:{$shallowSimple:[{icon:"text-annotation",tooltip:"toolbarAnnotationsTextAnnotations",value:"text-menu"},{icon:"trend-line-drawing",tooltip:"toolbarAnnotationsLineAnnotations",value:"line-menu"},{icon:"arrow-drawing",tooltip:"toolbarAnnotationsShapeAnnotations",value:"shape-menu"},{icon:"delete",tooltip:"toolbarAnnotationsClearAll",value:"clear"}]},padding:{$ref:"chartPadding"}},pX={buttons:{$shallowSimple:[{icon:"text-annotation",tooltip:"toolbarAnnotationsTextColor",value:"text-color"},{icon:"line-color",tooltip:"toolbarAnnotationsLineColor",value:"line-color"},{icon:"fill-color",tooltip:"toolbarAnnotationsFillColor",value:"fill-color"},{tooltip:"toolbarAnnotationsTextSize",value:"text-size"},{tooltip:"toolbarAnnotationsLineStrokeWidth",value:"line-stroke-width"},{icon:"line-style-solid",tooltip:"toolbarAnnotationsLineStyle",value:"line-style-type"},{icon:"settings",tooltip:"toolbarAnnotationsSettings",value:"settings"},{icon:"unlocked",tooltip:"toolbarAnnotationsLock",ariaLabel:"toolbarAnnotationsLock",checkedOverrides:{icon:"locked",tooltip:"toolbarAnnotationsUnlock"},value:"lock"},{icon:"delete",tooltip:"toolbarAnnotationsDelete",value:"delete"}]}},gX={enabled:!1,line:{...vo,handle:{...ys},text:{...Ch}},"horizontal-line":{...vo,handle:{...ys},axisLabel:{...YP},text:{...Ch}},"vertical-line":{...vo,handle:{...ys},axisLabel:{...YP},text:{...Ch}},"disjoint-channel":{...vo,background:{fill:{$ref:"foregroundColor"},fillOpacity:.075},handle:{...ys},text:{...ZP}},"parallel-channel":{...vo,middle:{lineDash:[6,5],strokeWidth:1},background:{fill:{$ref:"foregroundColor"},fillOpacity:.075},handle:{...ys},text:{...ZP}},"fibonacci-retracement":{...vo,strokes:fd,rangeStroke:{$ref:"foregroundColor"},handle:{...ys},text:{...Ch,position:"center"},label:{...Ah,color:void 0,fontSize:{$rem:Si.SMALLER}}},"fibonacci-retracement-trend-based":{...vo,strokes:fd,rangeStroke:{$ref:"foregroundColor"},handle:{...ys},text:{...Ch,position:"center"},label:{...Ah,color:void 0,fontSize:{$rem:Si.SMALLER}}},callout:{...vo,...Qb,color:{$ref:"textColor"},handle:{...ys},fill:{$ref:"foregroundColor"},fillOpacity:.075},comment:{...Qb,fontWeight:700,handle:{...ys},fill:{$ref:"foregroundColor"}},note:{...Qb,color:kd,fill:As,stroke:{$ref:"chartBackgroundColor"},strokeWidth:1,strokeOpacity:1,handle:{...ys},background:{fill:Dd,stroke:Id,strokeWidth:1}},text:{...Qb,color:{$ref:"textColor"},handle:{...ys}},arrow:{...vo,handle:{...ys},text:{...Ch}},"arrow-up":{fill:{$palette:"up.fill"},handle:{...ys,stroke:{$ref:"foregroundColor"}}},"arrow-down":{fill:{$palette:"down.fill"},handle:{...ys,stroke:{$ref:"foregroundColor"}}},"date-range":{...Qk},"price-range":{...Qk},"date-price-range":{...Qk},"quick-date-price-range":{up:{...vo,fill:os,fillOpacity:.2,handle:{...ys},statistics:{...qk,color:"#fff",fill:os,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}}},down:{...vo,stroke:Md,fill:Sd,fillOpacity:.2,handle:{...ys,stroke:Md},statistics:{...qk,color:"#fff",fill:Sd,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}}}},axesButtons:{},toolbar:uX,optionsToolbar:pX},Jk={type:"plugin",name:"annotations",chartType:"cartesian",enterprise:!0,version:ue,options:L.annotationOptionsDef,themeTemplate:gX,create:e=>new dX(e),patchContext:e=>{e.sharedToolbar||(e.sharedToolbar=new FE(e),e.cleanup.register(()=>e.sharedToolbar.destroy()))}},{Range:fX,TranslatableGroup:mX,BBox:yX,FillGradientDefaults:xX,FillImageDefaults:bX,FillPatternDefaults:vX,getShapeFill:SX,InteractionState:Jb}=L,Hn=class extends bi{constructor(e){super(),this.ctx=e,this.id=Mi(this),this.enabled=!1,this.stroke="rgb(195, 195, 195)",this.lineDash=[6,3],this.lineDashOffset=0,this.strokeWidth=1,this.strokeOpacity=1,this.fill="#c16068",this.fillOpacity=1,this.fillGradientDefaults=new xX,this.fillPatternDefaults=new vX,this.fillImageDefaults=new bX,this.bounds=new yX(0,0,0,0),this.bandHighlightGroup=new mX({name:"bandHighlight",zIndex:1}),this.rangeNode=this.bandHighlightGroup.appendChild(new fX),this.activeAxisHighlight=void 0,this.axisCtx=e.parent,this.hideBand(),e.domManager.addEventListener("focusin",({target:o})=>{const a=o instanceof HTMLElement&&e.domManager.contains(o,"series-area");this.bandHighlightGroup.visible&&!a&&(this.hideBand(),this.ctx.updateService.update(7))});const{widgets:{seriesWidget:t,seriesDragInterpreter:i},animationManager:s,eventsHub:n}=e;this.cleanup.register(e.scene.attachNode(this.bandHighlightGroup),t.addListener("mousemove",o=>this.onHoverLikeEvent(o)),t.addListener("mouseleave",()=>this.clearAllHighlight()),s.addListener("animation-start",()=>this.clearAllHighlight()),n.on("layout:complete",o=>this.layout(o)),n.on("series:focus-change",()=>this.onKeyPress()),n.on("zoom:pan-start",()=>this.clearAllHighlight()),n.on("zoom:change-complete",()=>this.clearAllHighlight()),n.on("dom:resize",()=>this.clearAllHighlight()),n.on("axis:change",()=>this.axisChange())),i&&this.cleanup.register(i.events.on("drag-move",o=>this.onHoverLikeEvent(o)),i.events.on("click",o=>this.onClick(o)))}axisChange(){this.onHighlightChange()}isHover(e){return e.type==="mousemove"||e.type==="click"||e.device==="touch"&&this.ctx.chartService.touch.dragAction==="hover"}onClick(e){e.device==="touch"&&this.onHoverLikeEvent(e)}clearAllHighlight(){this.ctx.interactionManager.isState(Jb.Clickable)&&this.onHighlightChange()}onKeyPress(){this.ctx.interactionManager.isState(Jb.Default)&&this.onHighlightChange()}onHoverLikeEvent(e){const t=this.isHover(e)?Jb.Clickable:Jb.AnnotationsMoveable;this.ctx.interactionManager.isState(t)&&this.handleHoverHighlight(e)}handleHoverHighlight(e){if(!e)return;const{currentX:t,currentY:i}=e;this.onHighlightChange(this.axisCtx.pickBand({x:t,y:i}))}layout({series:{rect:e,visible:t},axes:i}){if(!t||!i||!this.enabled)return;const{position:s="left",axisId:n}=this.axisCtx,o=i[n];if(!o)return;this.axisLayout=o,this.bounds=e.clone().grow(o.gridPadding,s);const{bandHighlightGroup:a,bounds:r}=this;a.translationX=Math.round(r.x),a.translationY=Math.round(r.y),this.updateBand()}updateBand(){const{rangeNode:e,stroke:t,strokeWidth:i,strokeOpacity:s,lineDash:n,fill:o,fillOpacity:a,fillGradientDefaults:r,fillPatternDefaults:l,fillImageDefaults:c,lineDashOffset:h,axisLayout:d}=this;d&&(e.stroke=t,e.strokeWidth=i,e.strokeOpacity=s,e.lineDash=n,e.lineDashOffset=h,e.fill=SX(o,r,l,c),e.fillOpacity=a,e.startLine=!0,e.endLine=!0)}isVertical(){return this.axisCtx.direction==="x"}onHighlightChange(e){this.enabled&&(this.activeAxisHighlight=e,this.activeAxisHighlight?this.showBand():this.hideBand(),this.ctx.updateService.update(7))}updateBandPosition(){const{rangeNode:e,bounds:t}=this,{band:i}=this.activeAxisHighlight??{};if(i==null){this.hideBand();return}let s=Math.min(...i),n=Math.max(...i);if(n-s<1){const o=(s+n)/2;s=o-.5,n=o+.5}this.isVertical()?(e.y1=0,e.y2=t.height,e.x1=s,e.x2=n,e.horizontal=!0):(e.y1=s,e.y2=n,e.x1=0,e.x2=t.width,e.horizontal=!1)}showBand(){this.updateBandPosition(),this.bandHighlightGroup.visible=!0}hideBand(){this.bandHighlightGroup.visible=!1}};Hn.className="BandHighlight",g([m],Hn.prototype,"enabled",2),g([m],Hn.prototype,"stroke",2),g([m],Hn.prototype,"lineDash",2),g([m],Hn.prototype,"lineDashOffset",2),g([m],Hn.prototype,"strokeWidth",2),g([m],Hn.prototype,"strokeOpacity",2),g([m],Hn.prototype,"fill",2),g([m],Hn.prototype,"fillOpacity",2),g([m],Hn.prototype,"fillGradientDefaults",2),g([m],Hn.prototype,"fillPatternDefaults",2),g([m],Hn.prototype,"fillImageDefaults",2);var eA={type:"axis:plugin",name:"bandHighlight",chartType:"cartesian",axisTypes:["category","ordinal-time","unit-time","grouped-category"],enterprise:!0,version:ue,themeTemplate:{enabled:!1,strokeWidth:0,lineDash:[],fill:{$foregroundBackgroundMix:.05}},create:e=>new Hn(e)},{LayoutElement:MX,Menu:DX}=L,tA=[{label:"toolbarSeriesTypeOHLC",icon:"ohlc-series",value:"ohlc"},{label:"toolbarSeriesTypeCandles",icon:"candlestick-series",value:"candlestick"},{label:"toolbarSeriesTypeHollowCandles",icon:"hollow-candlestick-series",value:"hollow-candlestick"},{label:"toolbarSeriesTypeLine",icon:"line-series",value:"line"},{label:"toolbarSeriesTypeStepLine",icon:"step-line-series",value:"step-line"},{label:"toolbarSeriesTypeHLC",icon:"hlc-series",value:"hlc"},{label:"toolbarSeriesTypeHighLow",icon:"high-low-series",value:"high-low"}],XP=class extends bi{constructor(e){super(),this.ctx=e,this.enabled=!1,this.menu=new DX(this.ctx,"chart-toolbar"),this.toolbar=e.sharedToolbar.getSharedToolbar("chartToolbar"),this.cleanup.register(this.toolbar.addToolbarListener("button-pressed",this.onButtonPressed.bind(this)),e.layoutManager.registerElement(MX.ToolbarLeft,this.onLayoutStart.bind(this)),()=>this.toolbar.destroy())}onLayoutStart(e){this.enabled&&(this.updateButton(),this.toolbar.layout(e.layoutBox))}onButtonPressed({event:e,buttonBounds:t,buttonWidget:i}){this.menu.setAnchor({x:t.x+t.width+6,y:t.y}),this.menu.show(i,{items:tA,menuItemRole:"menuitemradio",ariaLabel:this.ctx.localeManager.t("toolbarSeriesTypeDropdown"),class:"ag-charts-chart-toolbar__menu",value:this.getChartType(),sourceEvent:e.sourceEvent,onPress:s=>{this.setChartType(s.value),this.hidePopover()},onHide:()=>{this.toolbar.clearActiveButton()}}),this.toolbar.toggleActiveButtonByIndex(0)}updateButton(){const e=this.getChartType(),t=tA.find(i=>i.value===e)?.icon;t!=null&&this.toolbar.updateButtons([{icon:t,tooltip:"toolbarSeriesTypeDropdown",value:"menu"}])}hidePopover(){this.toolbar.clearActiveButton(),this.menu.hide()}setChartType(e){const t={chartType:e};this.ctx.chartService.publicApi?.updateDelta(t).catch(i=>j.error(i))}getChartType(){const e=this.ctx.chartService.publicApi?.getOptions()?.chartType;return e==null||!tA.some(t=>t.value===e)?"candlestick":e}};g([m,He({changeValue(e){this.toolbar?.setHidden(!e)}})],XP.prototype,"enabled",2);var ev={type:"plugin",name:"chartToolbar",chartType:"cartesian",enterprise:!0,version:ue,options:{enabled:R},create:e=>new XP(e),patchContext:e=>{e.sharedToolbar||(e.sharedToolbar=new FE(e),e.cleanup.register(()=>e.sharedToolbar.destroy()))}};function iA(e,t){return e==="always"?!0:e==="series-area"?t==="series-area"||t==="series-node":e===t}function qP(e,t,i){let s=!0;if(t.type==="separator"){const n=i.at(-1);s=n!==void 0&&n.type!=="separator"}if(s&&(s=iA(t.showOn??"always",e)),s){const n=new AX(t);return i.push(n),n}}function QP(e,t,i,s){t.isVisible(i)&&qP(e,t.builtins.items[i],s)}function IX(e,t,i,s){const{builtins:n}=t;if(il(i,n.lists))for(const o of n.lists[i])QP(e,t,o,s);else QP(e,t,i,s)}function kX(e,t,i){const s=[],{builtins:n}=i;for(const o of t)if(typeof o=="string"&&il(o,n.lists))for(const a of n.lists[o])s.push(a);else s.push(o);return s.filter(o=>{if(typeof o=="string"){const a=i.builtins.items[o].showOn??"always";return i.isVisible(o)&&iA(a,e)}else return iA(o.showOn??"always",e)})}function JP(e,t,i,s){for(const n of i)if(typeof n=="string")IX(e,t,n,s);else{const o=qP(e,n,s);n.items&&o&&n.items.length>0&&JP(e,t,n.items,o.items)}s.at(-1)?.type==="separator"&&s.pop()}var AX=class{constructor(e){this.type="action",this.showOn="always",this.label="",this.iconUrl=void 0,this.enabled=!0,this.items=[],this.action=void 0,e&&this.setOptions(e),this.items=[]}setField(e,t,i){t[e]=i}setOptions(e){let t;for(t in e)e[t]!==void 0&&this.setField(t,this,e[t])}},Ur="ag-charts-context-menu",{ContextMenuRegistry:Of}=L,sA="context-menu",CX=["angleKey","calloutLabelKey","colorKey","labelKey","radiusKey","sectorLabelKey","sizeKey","xKey","yKey"],Ef=class extends bi{constructor(e){if(super(),this.ctx=e,this.enabled=!0,this.darkTheme=!1,this.items=["defaults"],this.pickedNode=void 0,this.showEvent=void 0,this.x=0,this.y=0,this.collapsingSubMenus=0,this.menuWidget=new gf.MenuWidget,this.interactionManager=e.interactionManager,this.element=e.domManager.addChild("canvas-overlay",sA),this.element.classList.add(Ur),this.element.style.display="none",this.element.addEventListener("contextmenu",t=>t.preventDefault()),this.element.addEventListener("focusout",({relatedTarget:t})=>{this.collapsingSubMenus>0||(t==null||t instanceof Node&&!this.element.contains(t))&&this.hide()}),this.cleanup.register(()=>this.element.remove(),()=>this.menuWidget.destroy(),e.eventsHub.on("dom:hidden",()=>this.hide()),this.menuWidget.addListener("collapse-widget",()=>this.onCollapse())),this.menuWidget.addClass(`${Ur}__menu`),typeof MutationObserver<"u"){const t=new MutationObserver(()=>{this.element.contains(this.menuWidget.getElement())&&this.reposition()});t.observe(this.element,{childList:!0}),this.mutationObserver=t,this.cleanup.register(()=>t.disconnect())}this.ctx.contextMenuRegistry.builtins.items.download.action=()=>{const t=e.chartService.title;let i="image";t?.enabled&&(i=t.node.getPlainText().replace(/\.+/,"")),this.ctx.chartService.publicApi?.download({fileName:i}).catch(s=>{j.error("Unable to download chart",s)})},this.cleanup.register(this.ctx.eventsHub.on("context-menu:complete",t=>this.onContext(t)))}makeGetItemsParams(e){const{showOn:t}=e,{context:i}=this.ctx.chartService,s=kX(t,this.items,this.ctx.contextMenuRegistry);switch(t){case"always":case"series-area":return{showOn:t,context:i,defaultItems:s};case"series-node":{if(this.pickedNode==null)throw new Error("this.pickedNode is null");const c={showOn:t,context:i,seriesId:this.pickedNode.series.id,datum:this.pickedNode.datum,defaultItems:s};for(const h of CX)this.pickedNode[h]!==void 0&&(c[h]=this.pickedNode[h]);return c}case"legend-item":if(this.pickedLegendItem==null)throw new Error("this.pickedLegendItem is null");const{itemId:n,seriesId:o,label:a,enabled:r}=this.pickedLegendItem,l=Pe(a.text);if(typeof n!="string")throw new Error(`unexpected itemId type: [${typeof n}] (expected [string])`);return{showOn:t,context:i,itemId:n,seriesId:o,text:l,visible:r,defaultItems:s};default:return t}}expandItemsOptions(e){const t=[];let i;if(this.getItems){const s=this.makeGetItemsParams(e);i=this.getItems(s)}return i??(i=this.items),JP(e.showOn,this.ctx.contextMenuRegistry,i,t),t}onContext(e){if(!this.enabled)return;e.widgetEvent.sourceEvent.preventDefault(),this.showEvent=e.widgetEvent.sourceEvent,this.x=e.x,this.y=e.y,this.pickedNode=void 0,this.pickedLegendItem=void 0,Of.check("series-node",e)?this.pickedNode=e.context.pickedNode:Of.check("legend-item",e)&&(this.pickedLegendItem=e.context.legendItem);const t=this.expandItemsOptions(e);t.length!==0&&this.show(e.widgetEvent,t)}show(e,t){const{sourceEvent:i}=e;this.interactionManager.pushState(L.InteractionState.ContextMenu),this.element.style.display="block";const s=i.pointerType==="touch"?!1:void 0;s!==void 0&&this.ctx.chartService.overrideFocusVisible(s),this.createMenu(t),this.element.appendChild(this.menuWidget.getElement()),this.menuWidget.expand({sourceEvent:i,overrideFocusVisible:s})}hide(){this.menuWidget.collapse()}onCollapse(){this.interactionManager.popState(L.InteractionState.ContextMenu),this.menuWidget.getElement().remove(),this.element.style.display="none"}onSubMenuExpand(e,t){const i=e.getBounds();e.setFocusOverride(!0),e.getElement().insertAdjacentElement("afterend",t.getElement()),t.getElement().style.position="absolute";const s=this.ctx.domManager.getBoundingClientRect(),n=e.getBoundingClientRect(),o=s.right-n.right,a=n.left-s.left,{offsetWidth:r,offsetHeight:l}=t.getElement();let c=i.y;if(s.height>l){const h=s.bottom-n.top;h<l&&(c-=l-h)}if(o>=r)t.setBounds({x:i.x+i.width,y:c});else{const h=i.x-r,d=a+h;d>=0?t.setBounds({x:h,y:c}):t.setBounds({x:h-d,y:c})}}onSubMenuCollapse(e,t){e.setFocusOverride(void 0),this.collapsingSubMenus++,t.remove(),this.collapsingSubMenus--}createMenu(e){const{menuWidget:t}=this;t.clear(),t.setTabIndex(-1),this.createMenuItems(t,e)}createMenuItems(e,t){for(const i of t)switch(i.type){case"separator":{e.addSeparator().classList.add(`${Ur}__divider`);break}case"action":{if(i.items.length===0){const s=new gf.MenuItemWidget;this.initButtonElement(s,i),e.addChild(s)}else{const{subMenuButton:s,subMenu:n}=e.addSubMenu();n.addClass(`${Ur}__menu`),n.addListener("expand-widget",()=>this.onSubMenuExpand(s,n)),n.addListener("collapse-widget",()=>this.onSubMenuCollapse(s,n)),this.initButtonElement(s,i),this.createMenuItems(n,i.items)}break}default:throw new Error("unhandled case")}}createButtonOnClick(e,t){return Of.checkCallback("legend-item",e,t)?i=>{const s=i.sourceEvent;if(this.pickedLegendItem){const{seriesId:n,itemId:o,label:a}=this.pickedLegendItem,{chartService:r}=this.ctx;if(typeof o!="string"){j.error(`unexpected itemId type: [${typeof o}] (expected [string])`);return}const c=[r.series.find(d=>d.id===n)?.properties,r],h={type:"contextmenu",seriesId:n,itemId:o,text:Pe(a.text),event:s};as(c,t,h),this.hide()}else j.error("legend item not found")}:Of.checkCallback("series-area",e,t)?()=>{const i=this.ctx.chartService,s={type:"seriesContextMenuAction",event:this.showEvent};as(i,t,s),this.hide()}:Of.checkCallback("series-node",e,t)?()=>{const{showEvent:i}=this,{chartService:s}=this.ctx,n=this.pickedNode,o=[n?.series.properties,s],a=n?.series.createNodeContextMenuActionEvent(i,n);a?as(o,t,a):j.error("series node not found"),this.hide()}:()=>{const i=this.ctx.chartService,s={type:"contextMenuEvent",event:this.showEvent};as(i,t,s),this.hide()}}initTableCells(e){const t=xe("div"),i=xe("div"),s=xe("div");return t.classList.toggle(`${Ur}__icon`,!0),i.classList.toggle(`${Ur}__cell`,!0),s.classList.toggle(`${Ur}__cell`,!0),t.ariaHidden="true",i.role="presentation",s.ariaHidden="true",e.append(t,i,s),{cellIcon:t,cellLabel:i,cellArrow:s}}initButtonElement(e,t){e.addClass(`${Ur}__item`),e.setEnabled(t.enabled);const i=this.ctx.localeManager.t(t.label),s=`${Ur}__cellpadding`,{cellIcon:n,cellLabel:o,cellArrow:a}=this.initTableCells(e.getElement());if(o.textContent=i,o.classList.add(s),t.iconUrl!=null){const c=xe("img");c.src=t.iconUrl,n.append(c),n.classList.add(s)}if(t.items.length>0){const c=xe("span",pl("chevron-right"));a.append(c),a.classList.add(s)}const{showOn:r,action:l}=t;l!=null&&e.addListener("click",this.createButtonOnClick(r,l)),t.items.length===0&&(e.addListener("mouseleave",()=>e.setFocusOverride(!1)),e.addListener("mouseenter",()=>e.setFocusOverride(void 0)))}reposition(){let{x:e,y:t}=this;this.element.style.top="unset",this.element.style.bottom="unset";const i=this.ctx.domManager.getBoundingClientRect(),{offsetWidth:s,offsetHeight:n}=this.element;e=ge(0,e,i.width-s),t=ge(0,t,i.height-n),this.element.style.left=`${e}px`,this.element.style.top=`calc(${t}px - 0.5em)`}destroy(){super.destroy(),this.mutationObserver?.disconnect(),this.ctx.domManager.removeStyles(sA),this.ctx.domManager.removeChild("canvas-overlay",sA)}};g([m],Ef.prototype,"enabled",2),g([m],Ef.prototype,"darkTheme",2),g([m],Ef.prototype,"items",2),g([m],Ef.prototype,"getItems",2);var Pf={type:"plugin",name:"contextMenu",enterprise:!0,version:ue,options:{enabled:R,items:Hp,getItems:vi(Hp,"a menu items array")},themeTemplate:{enabled:!0,darkTheme:ul},create:e=>new Ef(e)};Pf.options.darkTheme=ee(R);function Rf(e){return typeof e?.datum=="object"?e.datum:null}var{FormatManager:LX}=L,wX="ag-charts-crosshair-label",lc=class extends K{constructor(){super(...arguments),this.enabled=!0,this.xOffset=0,this.yOffset=0,this.format=void 0,this.renderer=void 0,this._cachedFormatter=void 0}formatValue(e,t,i,s){const{formatter:n,format:o}=this,{domain:a,boundSeries:r}=s;let l;if(n!=null){const c=s.type==="number"?s.fractionDigits:void 0,h=s.type==="date"?s.unit:void 0,d=s.type==="date"?s.step:void 0;l=e(n,{value:i,domain:a,fractionDigits:c,unit:h,step:d,boundSeries:r})}if(o!=null){let c=this._cachedFormatter;(c==null||c.type!==t||c.format!==o)&&(c={type:t,format:o,formatter:LX.getFormatter(t,o)},this._cachedFormatter=c),l??(l=c.formatter?.(i))}return l==null?void 0:String(l)}};g([m],lc.prototype,"enabled",2),g([m],lc.prototype,"xOffset",2),g([m],lc.prototype,"yOffset",2),g([m],lc.prototype,"formatter",2),g([m],lc.prototype,"format",2),g([m],lc.prototype,"renderer",2);var eR=class extends lc{constructor(e,t,i){super(),this.domManager=e,this.id=Mi(this),this.element=e.addChild("canvas-overlay",`crosshair-label-${this.id}`),this.element.classList.add(wX),Fe(this.element,"aria-hidden",!0),this.element.dataset.key=t,this.element.dataset.axisId=i}show(e){const{element:t}=this,i=e.x+this.xOffset,s=e.y+this.yOffset;t.style.top=`${Math.round(s)}px`,t.style.left=`${Math.round(i)}px`,this.toggle(!0)}setLabelHtml({html:e,styles:t}){if(e!==void 0&&(this.element.innerHTML=e),t!==void 0){const i=this.element.children[0]??this.element;Object.assign(i.style,t)}}getBBox(){const{element:e}=this;return new L.BBox(e.clientLeft,e.clientTop,e.clientWidth,e.clientHeight)}toggle(e){this.element.classList.toggle("ag-charts-crosshair-label--hidden",!e)}destroy(){this.domManager.removeChild("canvas-overlay",`crosshair-label-${this.id}`)}toLabelHtml(e,t){if(typeof e=="string")return{html:e,styles:{}};t=t??{};const{text:i=t.text??"",color:s=t.color,backgroundColor:n=t.backgroundColor,opacity:o=t.opacity??1}=e,a={opacity:o,"background-color":n?.toLowerCase(),color:s};return{html:`<div class="ag-charts-crosshair-label-content">
                    <span>${i}</span>
                </div>`,styles:a}}};eR.className="CrosshairLabel";var{Group:TX,TranslatableGroup:NX,Line:OX,BBox:tR,InteractionState:tv}=L,Ga=class extends bi{constructor(e){super(),this.ctx=e,this.id=Mi(this),this.enabled=!1,this.stroke="rgb(195, 195, 195)",this.lineDash=[6,3],this.lineDashOffset=0,this.strokeWidth=1,this.strokeOpacity=1,this.snap=!0,this.label=new lc,this.seriesRect=new tR(0,0,0,0),this.bounds=new tR(0,0,0,0),this.crosshairGroup=new NX({name:"crosshairs",zIndex:9}),this.lineGroup=this.crosshairGroup.appendChild(new TX({name:`${this.id}-crosshair-lines`,zIndex:9})),this.lineGroupSelection=L.Selection.select(this.lineGroup,OX,!1),this.activeHighlight=void 0,this.axisCtx=e.parent,this.labels={},this.hideCrosshairs(),e.domManager.addEventListener("focusin",({target:i})=>{const s=i instanceof HTMLElement&&e.domManager.contains(i,"series-area");this.crosshairGroup.visible&&!s&&(this.hideCrosshairs(),this.ctx.updateService.update(7))});const{seriesDragInterpreter:t}=e.widgets;this.cleanup.register(e.scene.attachNode(this.crosshairGroup),e.widgets.seriesWidget.addListener("mousemove",i=>this.onMouseHoverLike(i)),e.widgets.seriesWidget.addListener("mouseleave",()=>this.onMouseOut()),e.eventsHub.on("series:focus-change",()=>this.onKeyPress()),e.eventsHub.on("zoom:pan-start",()=>this.onMouseOut()),e.eventsHub.on("zoom:change-complete",()=>this.onMouseOut()),e.eventsHub.on("highlight:change",i=>this.onHighlightChange(i)),e.eventsHub.on("layout:complete",i=>this.layout(i)),()=>{for(const i of Object.values(this.labels))i.destroy()}),t&&this.cleanup.register(t.events.on("drag-move",i=>this.onMouseHoverLike(i)),t.events.on("click",i=>this.onClick(i)))}layout({series:{rect:e,visible:t},axes:i}){if(!t||!i||!this.enabled)return;this.seriesRect=e;const{position:s="left",axisId:n}=this.axisCtx,o=i[n];if(!o)return;this.axisLayout=o,this.bounds=e.clone().grow(o.gridPadding+o.seriesAreaPadding,s);const{crosshairGroup:a,bounds:r}=this;a.translationX=Math.round(r.x),a.translationY=Math.round(r.y);const l=["pointer",...this.axisCtx.seriesKeyProperties()];this.updateSelections(l),this.updateLines(),this.updateLabels(l)}updateSelections(e){this.lineGroupSelection.update(e,void 0,t=>t)}updateLabels(e){const{labels:t,ctx:i}=this;for(const s of e)this.label.enabled&&(t[s]??(t[s]=new eR(i.domManager,s,this.axisCtx.axisId))),t[s]&&this.updateLabel(t[s])}updateLabel(e){const{enabled:t,xOffset:i,yOffset:s,format:n,renderer:o}=this.label;e.enabled=t,e.xOffset=i,e.yOffset=s,e.format=n,e.renderer=o}updateLines(){const{lineGroupSelection:e,bounds:t,stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:o,lineDashOffset:a,axisLayout:r}=this;if(!r)return;const l=this.isVertical();e.each(c=>{c.stroke=i,c.strokeWidth=s,c.strokeOpacity=n,c.lineDash=o,c.lineDashOffset=a,c.y1=0,c.y2=l?t.height:0,c.x1=0,c.x2=l?0:t.width})}isVertical(){return this.axisCtx.direction==="x"}isHover(e){return e.type==="mousemove"||e.type==="click"||e.device==="touch"&&this.ctx.chartService.touch.dragAction==="hover"}formatValue(e){return Pe(this.axisCtx.formatScaleValue(e,"crosshair",this.label))}onClick(e){e.device==="touch"&&this.onMouseHoverLike(e)}onMouseHoverLike(e){if(!this.enabled||this.snap)return;const t=this.isHover(e)?tv.Clickable:tv.AnnotationsMoveable;this.ctx.interactionManager.isState(t)&&(this.updatePositions(this.getData(e)),this.crosshairGroup.visible=!0,this.ctx.updateService.update(7))}onMouseOut(){this.ctx.interactionManager.isState(tv.Clickable)&&(this.hideCrosshairs(),this.ctx.updateService.update(7))}onKeyPress(){this.enabled&&!this.snap&&this.ctx.interactionManager.isState(tv.Default)&&this.hideCrosshairs()}onHighlightChange(e){if(!this.enabled)return;const{crosshairGroup:t,axisCtx:i}=this,{datum:s,series:n}=e.currentHighlight??{},o=s&&(n?.axes.x?.id===i.axisId||n?.axes.y?.id===i.axisId);if(this.activeHighlight=o?e.currentHighlight:void 0,!this.activeHighlight)this.hideCrosshairs();else if(this.snap){const a=this.getActiveHighlightData(this.activeHighlight);this.updatePositions(a),t.visible=!0}}isInRange(e){return this.axisCtx.inRange(e)}updatePositions(e){const{seriesRect:t,lineGroupSelection:i}=this;i.each((s,n)=>{const o=e[n];if(!o){s.visible=!1,this.hideLabel(n);return}s.visible=!0;const{value:a,position:r}=o;let l=0,c=0;this.isVertical()?(l=r,s.x=Math.round(l)):(c=r,s.y=Math.round(c)),this.label.enabled?this.showLabel(l+t.x,c+t.y,a,n):this.hideLabel(n)})}getData(e){const{axisCtx:t}=this,i="pointer",{xKey:s="",yKey:n=""}=this.activeHighlight??{},{currentX:o,currentY:a}=e,r=Rf(this.activeHighlight),l=this.isVertical(),c=l?o:a;let h=r?.[l?s:n]??"";return t.continuous&&(h=t.scaleInvert(c)),{[i]:{position:c,value:h}}}getActiveHighlightData(e){const{axisCtx:t}=this,{series:i,xKey:s="",aggregatedValue:n,cumulativeValue:o,midPoint:a}=e,r=Rf(e),l=i.getKeyProperties(t.direction),c=(t.scale.bandwidth??0)/2,h=i.axes[t.direction]?.id===t.axisId,d=l.includes("yKey")&&h,u=l.includes("xKey")&&h,p=n??o;if(d&&p!==void 0){const y=t.scale.convert(p)+c;return this.isInRange(y)?{yKey:{value:p,position:y}}:{}}if(u){const y=(this.isVertical()?a?.x:a?.y)??0,b=t.continuous?t.scaleInvert(y):r?.[s];return this.isInRange(y)?{xKey:{value:b,position:y}}:{}}const f={};for(const y of l){const b=i.properties[y],x=r?.[b],v=t.scale.convert(x)+c;this.isInRange(v)&&(f[y]={value:x,position:v})}return f}getLabelHtml(e,t){const i=this.axisLayout?.label?.fractionDigits??0,s={text:this.formatValue(e)};return this.label.renderer?t.toLabelHtml(this.label.renderer({value:e,fractionDigits:i}),s):t.toLabelHtml(s)}showLabel(e,t,i,s){if(!this.axisLayout)return;const{bounds:n}=this,o=this.labels[s],a=this.getLabelHtml(i,o);o.setLabelHtml(a);const{width:r,height:l}=o.getBBox(),c=this.axisCtx.position;let h=this.axisLayout.label.spacing+this.axisLayout.tickSize;this.axisCtx.direction==="x"?(h-=4,o.show({x:e-r/2,y:c==="bottom"?n.y+n.height+h:n.y-l-h})):(h-=8,o.show({x:c==="right"?n.x+n.width+h:n.x-r-h,y:t-l/2}))}hideCrosshairs(){this.crosshairGroup.visible=!1;for(const e of Object.keys(this.labels))this.hideLabel(e)}hideLabel(e){this.labels[e]?.toggle(!1)}};Ga.className="Crosshair",g([m],Ga.prototype,"enabled",2),g([m],Ga.prototype,"stroke",2),g([m],Ga.prototype,"lineDash",2),g([m],Ga.prototype,"lineDashOffset",2),g([m],Ga.prototype,"strokeWidth",2),g([m],Ga.prototype,"strokeOpacity",2),g([m],Ga.prototype,"snap",2),g([m],Ga.prototype,"label",2);var nA={type:"axis:plugin",name:"crosshair",chartType:"cartesian",enterprise:!0,version:ue,themeTemplate:{enabled:{$if:[{$or:[{$eq:[{$path:"../type"},"number"]},{$eq:[{$path:"../type"},"log"]},{$eq:[{$path:"../type"},"time"]},{$eq:[{$path:"../type"},"unit-time"]},{$eq:[{$path:"../type"},"ordinal-time"]}]},!0,!1]},snap:!0,stroke:{$ref:"subtleTextColor"},strokeWidth:1,strokeOpacity:1,lineDash:[5,6],lineDashOffset:0,label:{enabled:!0}},create:e=>new Ga(e)},ap=class extends bi{constructor(e){super(),this.enabled=!0,this.getData=()=>Promise.resolve(),this.dataService=e.dataService;let t=!1;this.cleanup.register(e.eventsHub.on("data:load",()=>{t=!0}),e.eventsHub.on("layout:complete",()=>{t&&e.zoomManager.updateZoom({source:"data-update",sourceDetail:"dataSource"})}))}updateCallback(e,t){this.dataService&&(e&&t!=null?this.dataService.updateCallback(t):this.dataService.clearCallback())}};g([He({newValue(e){this.updateCallback(e,this.getData)}}),m],ap.prototype,"enabled",2),g([He({newValue(e){this.updateCallback(this.enabled,e)}}),m],ap.prototype,"getData",2),g([He({newValue(e){this.dataService.requestThrottle=e}})],ap.prototype,"requestThrottle",2),g([He({newValue(e){this.dataService.dispatchThrottle=e}})],ap.prototype,"updateThrottle",2),g([He({newValue(e){this.dataService.dispatchOnlyLatest=!e}})],ap.prototype,"updateDuringInteraction",2);var iv={type:"plugin",name:"dataSource",enterprise:!0,version:ue,options:{getData:ct,requestThrottle:ee(P),updateThrottle:ee(P),updateDuringInteraction:ee(R)},create:e=>new ap(e)},{BBox:cc}=L,EX=class{constructor(e){this.components=e,this.union=cc.merge(e)}containsPoint(e,t){if(!this.union.containsPoint(e,t))return!1;for(const i of this.components)if(i.containsPoint(e,t))return!0;return!1}},PX=class extends L.Group{constructor(){super(),this.capLength=Number.NaN,this._datum=void 0,this.whiskerPath=new L.Path,this.capsPath=new L.Path,this.bboxes=new EX([]),this.append([this.whiskerPath,this.capsPath])}get datum(){return this._datum}set datum(e){this._datum=e}calculateCapLength(e,t){const{lengthRatio:i=1,length:s}=e,{lengthRatioMultiplier:n,lengthMax:o}=t,a=s??i*n;return Math.min(a,o)}getItemStylerParams(e,t,i,s){const{datum:n}=this;if(n==null||e.itemStyler==null)return;const{xLowerKey:o,xUpperKey:a,yLowerKey:r,yUpperKey:l}=e;return{...t,datum:n.datum,seriesId:n.series.id,xKey:n.xKey,yKey:n.yKey,xLowerKey:o,xUpperKey:a,yLowerKey:r,yUpperKey:l,highlighted:i,highlightState:s}}formatStyles(e,t,i,s,n){let{cap:o,...a}=e;const r=this.getItemStylerParams(t,e,s,n);if(r!=null&&t.itemStyler!=null){const l=i.callWithContext(t.itemStyler,r);a=oe(l,a),o=oe(l?.cap,l,o)}return{whiskerStyle:a,capsStyle:o}}applyStyling(e,t){Yp(["visible","stroke","strokeWidth","strokeOpacity","lineDash","lineDashOffset"],e,t)}update(e,t,i,s,n){if(this.datum===void 0)return;const{whiskerStyle:o,capsStyle:a}=this.formatStyles(e,t,i,s,n),{xBar:r,yBar:l,capDefaults:c}=this.datum,h=this.whiskerPath;this.applyStyling(h,o),h.path.clear(!0),l!==void 0&&(h.path.moveTo(l.lowerPoint.x,l.lowerPoint.y),h.path.lineTo(l.upperPoint.x,l.upperPoint.y)),r!==void 0&&(h.path.moveTo(r.lowerPoint.x,r.lowerPoint.y),h.path.lineTo(r.upperPoint.x,r.upperPoint.y)),h.path.closePath(),this.capLength=this.calculateCapLength(a??{},c);const d=this.capLength/2,u=this.capsPath;this.applyStyling(u,a),u.path.clear(!0),l!==void 0&&(u.path.moveTo(l.lowerPoint.x-d,l.lowerPoint.y),u.path.lineTo(l.lowerPoint.x+d,l.lowerPoint.y),u.path.moveTo(l.upperPoint.x-d,l.upperPoint.y),u.path.lineTo(l.upperPoint.x+d,l.upperPoint.y)),r!==void 0&&(u.path.moveTo(r.lowerPoint.x,r.lowerPoint.y-d),u.path.lineTo(r.lowerPoint.x,r.lowerPoint.y+d),u.path.moveTo(r.upperPoint.x,r.upperPoint.y-d),u.path.lineTo(r.upperPoint.x,r.upperPoint.y+d)),u.path.closePath()}updateBBoxes(){const{capLength:e,whiskerPath:t,capsPath:i}=this,{yBar:s,xBar:n}=this.datum??{},o=e/2,a=[];if(s!==void 0){const r=s.lowerPoint.y-s.upperPoint.y;a.push(new cc(s.lowerPoint.x,s.upperPoint.y,t.strokeWidth,r),new cc(s.lowerPoint.x-o,s.lowerPoint.y,e,i.strokeWidth),new cc(s.upperPoint.x-o,s.upperPoint.y,e,i.strokeWidth))}if(n!==void 0){const r=n.upperPoint.x-n.lowerPoint.x;a.push(new cc(n.lowerPoint.x,n.upperPoint.y,r,t.strokeWidth),new cc(n.lowerPoint.x,n.lowerPoint.y-o,i.strokeWidth,e),new cc(n.upperPoint.x,n.upperPoint.y-o,i.strokeWidth,e))}this.bboxes.components=a,this.bboxes.union=cc.merge(a)}containsPoint(e,t){return this.bboxes.containsPoint(e,t)}pickNode(e,t){return this.containsPoint(e,t)?this:void 0}nearestSquared(e,t,i){const{bboxes:s}=this;if(s.union.distanceSquared(e,t)>i)return{nearest:void 0,distanceSquared:1/0};const{distanceSquared:n}=Pd(e,t,s.components);return{nearest:this,distanceSquared:n}}},RX=class extends L.Group{nearestSquared(e,t){const{nearest:i,distanceSquared:s}=N0(e,t,{children:this.children()});if(i!==void 0&&!Number.isNaN(s))return{datum:i.datum,distanceSquared:s}}},Kr=class extends K{};g([m],Kr.prototype,"visible",2),g([m],Kr.prototype,"stroke",2),g([m],Kr.prototype,"strokeWidth",2),g([m],Kr.prototype,"strokeOpacity",2),g([m],Kr.prototype,"lineDash",2),g([m],Kr.prototype,"lineDashOffset",2),g([m],Kr.prototype,"length",2),g([m],Kr.prototype,"lengthRatio",2);var xs=class extends K{constructor(){super(...arguments),this.visible=!0,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.cap=new Kr}};g([m],xs.prototype,"yLowerKey",2),g([m],xs.prototype,"yLowerName",2),g([m],xs.prototype,"yUpperKey",2),g([m],xs.prototype,"yUpperName",2),g([m],xs.prototype,"xLowerKey",2),g([m],xs.prototype,"xLowerName",2),g([m],xs.prototype,"xUpperKey",2),g([m],xs.prototype,"xUpperName",2),g([m],xs.prototype,"visible",2),g([m],xs.prototype,"stroke",2),g([m],xs.prototype,"strokeWidth",2),g([m],xs.prototype,"strokeOpacity",2),g([m],xs.prototype,"lineDash",2),g([m],xs.prototype,"lineDashOffset",2),g([m],xs.prototype,"itemStyler",2),g([m],xs.prototype,"cap",2);var{fixNumericExtent:FX,groupAccumulativeValueProperty:zX,valueProperty:sv}=L,BX=class rm extends bi{constructor(t){super(),this.properties=new xs;const i=t.series,{annotationGroup:s,annotationSelections:n}=i;this.cartesianSeries=i,this.groupNode=new RX({name:`${s.id}-errorBars`}),s.appendChild(this.groupNode),this.selection=L.Selection.select(this.groupNode,()=>this.errorBarFactory()),n.add(this.selection),i.addEventListener("seriesVisibilityChange",o=>this.onToggleSeriesItem(o)),this.cleanup.register(i.events.on("data-processed",o=>this.onDataProcessed(o)),i.events.on("data-update",o=>this.onDataUpdate(o)),t.eventsHub.on("highlight:change",o=>this.onHighlightChange(o)),()=>this.groupNode.remove(),()=>n.delete(this.selection))}hasErrorBars(){const{xLowerKey:t,xUpperKey:i,yLowerKey:s,yUpperKey:n}=this.properties;return St(t)&&St(i)||St(s)&&St(n)}isStacked(){const t=this.cartesianSeries.seriesGrouping?.stackCount;return t==null?!1:t>0}getUnstackPropertyDefinition(t){const i=[],{xLowerKey:s,xUpperKey:n,yLowerKey:o,yUpperKey:a,xErrorsID:r,yErrorsID:l}=this.getMaybeFlippedKeys(),{xScaleType:c,yScaleType:h}=t;return o!=null&&a!=null&&i.push(sv(o,h,{id:`${l}-lower`}),sv(a,h,{id:`${l}-upper`})),s!=null&&n!=null&&i.push(sv(s,c,{id:`${r}-lower`}),sv(n,c,{id:`${r}-upper`})),i}getStackPropertyDefinition(t){const i=[],{cartesianSeries:s}=this,{xLowerKey:n,xUpperKey:o,yLowerKey:a,yUpperKey:r,xErrorsID:l,yErrorsID:c}=this.getMaybeFlippedKeys(),{xScaleType:h,yScaleType:d}=t,u=s.seriesGrouping?.groupIndex??s.id,p={invalidValue:null,missingValue:0,separateNegative:!0,...s.visible?{}:{forceValue:0}},f=(b,x,v,S)=>zX(b,"normal",{id:`${x}-${v}`,groupId:`errorGroup-${u}-${v}`,...p},S),y=(b,x,v,S)=>{i.push(...f(b,v,"lower",S),...f(x,v,"upper",S))};return a!=null&&r!=null&&y(a,r,c,d),n!=null&&o!=null&&y(n,o,l,h),i}getPropertyDefinitions(t){return this.isStacked()?this.getStackPropertyDefinition(t):this.getUnstackPropertyDefinition(t)}onDataProcessed(t){this.dataModel=t.dataModel,this.processedData=t.processedData}getDomain(t){const{xLowerKey:i,xUpperKey:s,xErrorsID:n,yLowerKey:o,yUpperKey:a,yErrorsID:r}=this.getMaybeFlippedKeys();if(t==="x"?St(i)&&St(s):St(o)&&St(a)){const{dataModel:c,processedData:h,cartesianSeries:d}=this;if(c!=null&&h!=null){const u={x:n,y:r}[t],p=c.getDomain(d,`${u}-lower`,"value",h).domain,f=c.getDomain(d,`${u}-upper`,"value",h).domain,y=[Math.min(...p,...f),Math.max(...p,...f)];return FX(y)}}return[]}onDataUpdate(t){this.dataModel=t.dataModel,this.processedData=t.processedData,St(t.dataModel)&&St(t.processedData)&&(this.createNodeData(),this.update())}getNodeData(){return this.hasErrorBars()?this.cartesianSeries.contextNodeData?.nodeData:void 0}createNodeData(){const t=this.getNodeData(),i=this.cartesianSeries.axes.x?.scale,s=this.cartesianSeries.axes.y?.scale;if(!(!i||!s||!t))for(let n=0;n<t.length;n++){const{midPoint:o,xLower:a,xUpper:r,yLower:l,yUpper:c}=this.getDatum(t,n);if(o!=null){let h,d;St(a)&&St(r)&&(h={lowerPoint:{x:this.convert(i,a),y:o.y},upperPoint:{x:this.convert(i,r),y:o.y}}),St(l)&&St(c)&&(d={lowerPoint:{x:o.x,y:this.convert(s,l)},upperPoint:{x:o.x,y:this.convert(s,c)}}),t[n].xBar=h,t[n].yBar=d}}}getMaybeFlippedKeys(){let{xLowerKey:t,xUpperKey:i,yLowerKey:s,yUpperKey:n}=this.properties,[o,a]=["xValue-errors","yValue-errors"];return this.cartesianSeries.shouldFlipXY()&&([t,s]=[s,t],[i,n]=[n,i],[o,a]=[a,o]),{xLowerKey:t,xUpperKey:i,xErrorsID:o,yLowerKey:s,yUpperKey:n,yErrorsID:a}}static getDatumKey(t,i,s){if(i==null)return;const o=Rf(t)?.[i];if(o!=null){if(typeof o!="number"){j.warnOnce(`Found [${i}] error value of type ${typeof o}. Expected number type`);return}return o+s}}getDatum(t,i){const{xLowerKey:s,xUpperKey:n,yLowerKey:o,yUpperKey:a}=this.getMaybeFlippedKeys(),r=t[i],l=r.cumulativeValue==null||!this.isStacked()?0:r.cumulativeValue-r.yValue,[c,h]=this.cartesianSeries.shouldFlipXY()?[l,0]:[0,l];return{midPoint:r.midPoint,xLower:rm.getDatumKey(r,s,c),xUpper:rm.getDatumKey(r,n,c),yLower:rm.getDatumKey(r,o,h),yUpper:rm.getDatumKey(r,a,h)}}convert(t,i){const s=(t.bandwidth??0)/2;return t.convert(i)+s}update(){const t=this.getNodeData();t!=null&&(this.selection.update(t),this.selection.each((i,s,n)=>this.updateNode(i,s,n)))}updateNode(t,i,s){t.datum=i,t.update(this.getDefaultStyle(),this.properties,this.cartesianSeries,!1,"none"),t.updateBBoxes()}pickNodeExact(t){const{x:i,y:s}=t,n=this.groupNode.pickNode(i,s);if(n!=null)return{datum:n.datum,distanceSquared:0}}pickNodeNearest(t){return this.groupNode.nearestSquared(t.x,t.y)}pickNodeMainAxisFirst(t,i){let s,n=[1/0,1/0];const o=[t.x,t.y];i==="y"&&o.reverse();for(const a of this.groupNode.children()){const r=a.getBBox(),l=[r.x+r.width/2,r.y+r.height/2];i==="y"&&l.reverse();const c=[];for(let h=0;h<o.length;h++)c.push(Math.abs(o[h]-l[h]));(c[0]<n[0]||c[0]==n[0]&&c[1]<n[1])&&(s=a.datum,n=c)}if(s)return{datum:s,distanceSquared:Math.pow(n[0],2)+Math.pow(n[1],2)}}getTooltipParams(){const{xLowerKey:t,xUpperKey:i,yLowerKey:s,yUpperKey:n,xLowerName:o=t,xUpperName:a=i,yLowerName:r=s,yUpperName:l=n}=this.properties;return{xLowerKey:t,xLowerName:o,xUpperKey:i,xUpperName:a,yLowerKey:s,yLowerName:r,yUpperKey:n,yUpperName:l}}onToggleSeriesItem(t){this.groupNode.visible=t.visible}makeStyle(t){return{visible:t.visible,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeOpacity:t.strokeOpacity,cap:oe(this.properties.cap,t)}}getDefaultStyle(){return this.makeStyle(this.getWhiskerProperties())}getHighlightStyle(){return this.makeStyle(this.getWhiskerProperties())}restyleHighlightChange(t,i,s){const n=this.getNodeData();if(n!=null){for(let o=0;o<n.length;o++)if(t===n[o]){this.selection.at(o)?.update(i,this.properties,this.cartesianSeries,s,s?"highlighted-item":"unhighlighted-item");break}}}onHighlightChange(t){const{previousHighlight:i,currentHighlight:s}=t;s?.series===this.cartesianSeries&&this.restyleHighlightChange(s,this.getHighlightStyle(),!0),i?.series===this.cartesianSeries&&this.restyleHighlightChange(i,this.getDefaultStyle(),!1),this.groupNode.opacity=this.cartesianSeries.getOpacity()}errorBarFactory(){return new PX}getWhiskerProperties(){const{stroke:t,strokeWidth:i,visible:s,strokeOpacity:n,lineDash:o,lineDashOffset:a}=this.properties;return{stroke:t,strokeWidth:i,visible:s,strokeOpacity:n,lineDash:o,lineDashOffset:a}}},oA={type:"series:plugin",name:"errorBar",chartType:"cartesian",seriesTypes:["bar","line","scatter"],enterprise:!0,version:ue,options:pd,themeTemplate:{visible:!0,stroke:{$ref:"foregroundColor"},strokeWidth:1,strokeOpacity:1,cap:{lengthRatio:{$if:[{$eq:[{$path:"../../type"},"bar"]},.3,1]}}},create:e=>new BX(e)};function _X(e){for(const t of["x","y"])for(const i of e.axisManager.getAxisContext(t))if(L.BandScale.is(i.scale))return i}var hc=class extends K{constructor(e){super(),this.ctx=e,this.enabled=!1,this.item="chart",this.color="#cfeeff",this.opacity=1,this.flashDuration=100,this.fadeDuration=900,this.cleanup=new pt,this.element=this.ctx.domManager.addChild("canvas-background","flashOnUpdate"),this.element.role="presentation";let t=!0;const i=s=>{t?t=!1:this.onDataUpdate(s)};this.cleanup.register(this.ctx.eventsHub.on("data:update",i),this.ctx.eventsHub.on("datamodel:diff",s=>this.onDataModelDiff(s)))}destroy(){this.ctx.domManager.removeChild("canvas-background","flashOnUpdate"),this.cleanup.flush()}clearFlash(){this.element.innerHTML="",clearTimeout(this.animationTimeout),this.animationTimeout=void 0}flashElem(e){const{flashDuration:t,fadeDuration:i}=this,s=t+i;e.animate([{background:this.color,offset:0},{background:this.color,offset:t/s},{background:"transparent",offset:1}],{duration:s,easing:"ease-out"})}flashCategoryBands(e){const t=_X(this.ctx);if(!t)return;this.clearFlash();const i=this.computeCategoryFlashBounds(t,e);for(const n of i){const o=xe("div");Fe(o,"role","presentation"),Cn(o,"position","absolute"),Cd(o,n),this.element.appendChild(o),this.flashElem(o)}const s=this.flashDuration+this.fadeDuration;this.animationTimeout=setTimeout(()=>this.clearFlash(),s)}computeCategories(e){const t=new Set;for(const i of Object.keys(e))for(const s of["updated","added","moved"])for(const n of e[i][s])t.add(n);return t}computeCategoryFlashBounds(e,t){const i=this.ctx.widgets.seriesWidget.getBounds(),s=e.direction==="x"?([a,r])=>({x:i.x+a,y:i.y,width:r-a,height:i.height}):([a,r])=>({x:i.x,y:i.y+a,width:i.width,height:r-a}),n=[],o=this.computeCategories(t);for(const a of o){const r=e.measureBand(a);r?.band&&n.push(s(r.band))}return n}onDataUpdate(e){!this.enabled||this.item!=="chart"||!e||this.flashElem(this.ctx.widgets.containerWidget.getElement())}onDataModelDiff(e){!this.enabled||this.item!=="category"||this.flashCategoryBands(e.diff)}};hc.className="FlashOnUpdate",g([m],hc.prototype,"enabled",2),g([m],hc.prototype,"item",2),g([m],hc.prototype,"color",2),g([m],hc.prototype,"opacity",2),g([m],hc.prototype,"flashDuration",2),g([m],hc.prototype,"fadeDuration",2);var iR={type:"plugin",name:"flashOnUpdate",enterprise:!0,version:ue,options:{enabled:R,item:Mm()("chart","category"),color:ie,opacity:ce,flashDuration:P,fadeDuration:P},themeTemplate:{enabled:!1,item:"chart",color:"#cfeeff",opacity:1,flashDuration:100,fadeDuration:900},create:e=>new hc(e)},{TranslatableGroup:VX}=L,aA=class extends VX{constructor(){super(...arguments),this.inset=0,this.cornerRadius=0}applyClip(e,t){const{cornerRadius:i,inset:s}=this,{x:n,y:o,width:a,height:r}=t,l=new Path2D;l.roundRect(n+s,o+s,a-2*s,r-2*s,i),e.clip(l)}};g([U()],aA.prototype,"inset",2),g([U()],aA.prototype,"cornerRadius",2);var{CategoryAxis:GX,Group:Lh,BBox:sR,stackCartesianSeries:HX}=L,rA=class{constructor(){this.top=0,this.bottom=0}};g([m],rA.prototype,"top",2),g([m],rA.prototype,"bottom",2);var rp=class extends bi{constructor(e){super(),this.ctx=e,this.enabled=!1,this.padding=new rA,this.root=new Lh({name:"root"}),this.seriesRoot=this.root.appendChild(new aA({name:"Series-root",zIndex:7,renderToOffscreenCanvas:!0})),this.axisGridGroup=this.root.appendChild(new Lh({name:"Axes-Grids",zIndex:2})),this.axisGroup=this.root.appendChild(new Lh({name:"Axes-Grids",zIndex:2})),this.axisLabelGroup=this.root.appendChild(new Lh({name:"Axes-Labels",zIndex:15})),this.axisCrosslineRangeGroup=this.root.appendChild(new Lh({name:"Axes-Crosslines-Range",zIndex:6})),this.axisCrosslineLineGroup=this.root.appendChild(new Lh({name:"Axes-Crosslines-Line",zIndex:10})),this.axisCrosslineLabelGroup=this.root.appendChild(new Lh({name:"Axes-Crosslines-Label",zIndex:15})),this.data=[],this._destroyed=!1,this.miniChartAnimationPhase="initial",this.seriesRect=void 0,this.axes=new L.ChartAxes,this.series=[],this.cleanup.register(this.ctx.eventsHub.on("data:update",t=>this.updateData(t)))}destroy(){this._destroyed||(super.destroy(),this.destroySeries(this.series),this.axes.destroy(),this._destroyed=!0)}onSeriesChange(e,t){const i=t?.filter(s=>!e.includes(s))??[];this.destroySeries(i);for(const s of e)t?.includes(s)||(s.attachSeries(this.seriesRoot,this.seriesRoot,void 0),s.chart={},Object.defineProperty(s.chart,"mode",{get:()=>"standalone"}),Object.defineProperty(s.chart,"isMiniChart",{get:()=>!0}),Object.defineProperty(s.chart,"flashOnUpdateEnabled",{get:()=>!1}),Object.defineProperty(s.chart,"seriesRect",{get:()=>this.seriesRect}),s.resetAnimation(this.miniChartAnimationPhase==="initial"?"initial":"disabled"));this.seriesRect=void 0}destroySeries(e){if(e)for(const t of e)t.destroy(),t.detachSeries(this.seriesRoot,this.seriesRoot,void 0),t.chart=void 0}assignSeriesToAxes(){for(const e of this.axes)e.boundSeries=this.series.filter(t=>t.axes[e.direction]===e)}assignAxesToSeries(){const e={};for(const t of this.axes){const i=t.direction;(e[i]??(e[i]=[])).push(t)}for(const t of this.series)for(const i of t.directions){const s=t.getKeyAxis(i)??i,n=this.axes.findById(s);if(!n){j.warnOnce(`no matching axis for direction [${i}] and id [${s}]; check series and axes configuration.`);return}t.axes[i]=n}}updateData(e){for(const t of this.series)t.setChartData(e);this.miniChartAnimationPhase==="initial"&&this.ctx.animationManager.onBatchStop(()=>{this.miniChartAnimationPhase="ready";for(const t of this.series)t.resetAnimation("disabled")})}async processData(e){this.series.some(t=>t.canHaveAxes)&&(this.assignAxesToSeries(),this.assignSeriesToAxes()),await Promise.all(this.series.map(async t=>(t.resetDatumCallbackCache(),t.processData(e))));for(const t of this.axes)t.processData()}computeAxisPadding(){const e=new gr;if(!this.enabled)return e;for(const{position:t,thickness:i,line:s,label:n}of this.axes){if(t==null)continue;let o;i?o=i:o=(s.enabled?s.width:0)+(n.enabled?Mn(n.fontSize??0)+n.spacing:0),e[t]=Math.ceil(o)}return e}async layout(e,t){var i;const{padding:s}=this,n=this.seriesRect!=null,o=new sR(0,0,e,t-(s.top+s.bottom)),a=this.seriesRect==null||this.seriesRect.width!==e||this.seriesRect.height!==t;this.seriesRect=o,this.seriesRoot.translationY=s.top,this.seriesRoot.setClipRectCanvasSpace(new sR(0,-s.top,e,t));for(const r of this.axes){const{position:l="left"}=r;switch(l){case"top":case"bottom":r.range=[0,o.width],r.gridLength=o.height;break;case"right":case"left":{const c=r instanceof GX;r.range=c?[0,o.height]:[o.height,0],r.gridLength=o.width;break}}if(r.gridPadding=0,r.translation.x=0,r.translation.y=0,l==="right"?r.translation.x=e:l==="bottom"&&(r.translation.y=t),n||r.resetAnimation("initial"),r.crossLines)for(const c of r.crossLines)c instanceof L.CartesianCrossLine&&(c.position=r.position??"top",(i=c.label).parallel??(i.parallel=r.label?.parallel));r.calculateLayout(),r.update()}a&&HX(this.series),await Promise.all(this.series.map(async r=>r.update({seriesRect:o})))}};g([m],rp.prototype,"enabled",2),g([Bt(["seriesRoot","inset"])],rp.prototype,"inset",2),g([Bt(["seriesRoot","cornerRadius"])],rp.prototype,"cornerRadius",2),g([He({changeValue(e,t=new L.ChartAxes){const i={axisNode:this.axisGroup,gridNode:this.axisGridGroup,labelNode:this.axisLabelGroup,crossLineLineNode:this.axisCrosslineLineGroup,crossLineRangeNode:this.axisCrosslineRangeGroup,crossLineLabelNode:this.axisCrosslineLabelGroup};for(const s of t)e.includes(s)||(s.detachAxis(),s.destroy());for(const s of e)t?.includes(s)||s.attachAxis(i)}})],rp.prototype,"axes",2),g([He({changeValue(e,t){this.onSeriesChange(e,t)}})],rp.prototype,"series",2);var{SliderWidget:nR}=L,jX=class{constructor(e,t){this.ctx=e,this.sliderHandlers=t,this._min=0,this._max=1,this.minRange=.001,this.dragStartX=0,this.ctx=e,this.toolbar=e.proxyInteractionService.createProxyContainer({type:"toolbar",domManagerId:"navigator-toolbar",classList:["ag-charts-proxy-navigator-toolbar"],orientation:"vertical",ariaLabel:{id:"ariaLabelNavigator"}}),this.sliders=[e.proxyInteractionService.createProxyElement({type:"slider",domIndex:1,ariaLabel:{id:"ariaLabelNavigatorMinimum"},parent:this.toolbar,cursor:"ew-resize"}),e.proxyInteractionService.createProxyElement({type:"slider",domIndex:-1/0,ariaLabel:{id:"ariaLabelNavigatorRange"},parent:this.toolbar,cursor:"grab"}),e.proxyInteractionService.createProxyElement({type:"slider",domIndex:2,ariaLabel:{id:"ariaLabelNavigatorMaximum"},parent:this.toolbar,cursor:"ew-resize"})];for(const[i,s]of["min","pan","max"].entries()){const n=this.sliders[i];n.step=nR.STEP_HUNDRETH,n.keyboardStep=nR.STEP_ONE,n.orientation="horizontal",n.setPreventsDefault(!1),n.addListener("drag-start",o=>this.onDragStart(i,o,s)),n.addListener("drag-move",o=>this.onDrag(n,o,s)),n.addListener("drag-end",()=>this.updateSliderRatios()),n.addListener("contextmenu",o=>this.onContextMenu(n,o))}this.sliders[0].addListener("change",()=>this.onMinSliderChange()),this.sliders[1].addListener("change",()=>this.onPanSliderChange()),this.sliders[2].addListener("change",()=>this.onMaxSliderChange()),this.updateSliderRatios(),this.updateVisibility(!1)}destroy(){this.toolbar.destroy()}updateVisibility(e){this.toolbar.setHidden(!e)}updateZoom(){const{_min:e,_max:t}=this;e==null||t==null||this.ctx.zoomManager.updateZoom({source:"user-interaction",sourceDetail:"navigatorDOM"},{x:{min:e,max:t}})}updateBounds(e){this.toolbar.setBounds(e)}updateSliderBounds(e,t){this.sliders[e].setBounds(t)}updateMinMax(e,t){this._min=e,this._max=t,this.updateSliderRatios()}updateSliderRatios(){let{_min:e,_max:t}=this;e=Math.round(e*100)/100,t=Math.round(t*100)/100;const i=this.ctx.localeManager.t("ariaValuePanRange",{min:e,max:t});this.sliders[0].setValueRatio(e),this.sliders[1].setValueRatio(e,{ariaValueText:i}),this.sliders[2].setValueRatio(t)}toCanvasOffsets(e){return{offsetX:this.dragStartX+e.originDeltaX}}moveToFront(e){if(e===1)return;const t=this.sliders[e],i=this.sliders[2-e];this.toolbar.moveChild(i,t.domIndex-1)}onDragStart(e,t,i){const s=this.sliders[e],n=this.toolbar.cssLeft(),o=s.cssLeft();this.dragStartX=n+o+t.offsetX,this.moveToFront(e),t.sourceEvent.preventDefault(),this.sliderHandlers.onDragStart(i,this.toCanvasOffsets(t))}onDrag(e,t,i){t.sourceEvent.preventDefault(),this.sliderHandlers.onDrag(i,this.toCanvasOffsets(t))}onContextMenu(e,t){const{offsetX:i,offsetY:s}=t,{x:n,y:o}=this.toolbar.getBounds(),{x:a,y:r}=e.getBounds(),l=i+n+a,c=s+o+r;this.ctx.contextMenuRegistry.dispatchContext("always",{widgetEvent:t,canvasX:l,canvasY:c},void 0)}onPanSliderChange(){const e=this.sliders[1].getValueRatio(),t=this._max-this._min;this._min=ge(0,e,1-t),this._max=this._min+t,this.updateZoom()}onMinSliderChange(){this._min=this.sliders[0].clampValueRatio(0,this._max-this.minRange),this.updateZoom()}onMaxSliderChange(){this._max=this.sliders[2].clampValueRatio(this._min+this.minRange,1),this.updateZoom()}},{BBox:WX,ExtendedPath2D:$X}=L,dc=class extends L.Path{constructor(){super(...arguments),this.zIndex=3,this.centerX=0,this.centerY=0,this.width=8,this.height=16,this.cornerRadius=4,this.grip=!0,this.gripPath=new $X}setCenter(e,t){this.dirtyPath=!0,(this.centerX!==e||this.centerY!==t)&&(this.centerX=e,this.centerY=t,this.markDirty("center"))}static align(e,t,i,s,n,o,a,r,l){const c=e.align(i+n*a)+l,h=c+e.align(i+n*a,n*(r-a))-2*l,d=e.align(s+o/2);e.setCenter(c,d),t.setCenter(h,d)}computeBBox(){const{centerX:e,centerY:t,width:i,height:s}=this,n=e-i/2,o=t-s/2;return new WX(n,o,i,s)}isPointInPath(e,t){return this.getBBox().containsPoint(e,t)}updatePath(){const{centerX:e,centerY:t,path:i,gripPath:s,strokeWidth:n,cornerRadius:o,grip:a}=this,r=n/2,l=this.layerManager?.canvas?.pixelRatio??1;i.clear(),s.clear();const c=Math.floor(this.width/2*l)/l,h=Math.floor(this.height/2*l)/l;i.roundRect(e-c+r,t-h+r,2*(c-r),2*(h-r),o);const d=3;if(a)for(let u=-.5;u<=.5;u+=1)for(let p=-1;p<=1;p+=1)s.arc(e+u*d,t+p*d,1,0,2*Math.PI),s.closePath()}renderFill(e,t){const{stroke:i}=this;super.renderFill(e,t),e.fillStyle=typeof i=="string"?i:"black",e.fill(this.gripPath.getPath2D())}};dc.className="RangeHandle",g([m,U()],dc.prototype,"width",2),g([m,U()],dc.prototype,"height",2),g([m,U()],dc.prototype,"cornerRadius",2),g([m,U()],dc.prototype,"grip",2);var{Path:UX,BBox:lA,ExtendedPath2D:KX,clippedRoundRect:YX}=L,cA=class extends UX{constructor(){super(...arguments),this.cornerRadius=4,this.zIndex=2,this.x=0,this.y=0,this.width=200,this.height=30,this.min=0,this.max=1,this.visiblePath=new KX}layout(e,t,i,s,n,o){n=Number.isNaN(n)?this.min:n,o=Number.isNaN(o)?this.max:o,(e!==this.x||t!==this.y||i!==this.width||this.height!==s||n!==this.min||o!==this.max)&&(this.x=e,this.y=t,this.width=i,this.height=s,this.min=n,this.max=o,this.dirtyPath=!0,this.markDirty("RangeMask.layout"))}computeBBox(){const{x:e,y:t,width:i,height:s}=this;return new lA(e,t,i,s)}computeVisibleRangeBBox(){const{x:e,y:t,width:i,height:s,min:n,max:o}=this,a=e+i*n,r=e+i*o;return new lA(a,t,r-a,s)}updatePath(){const{path:e,visiblePath:t,x:i,y:s,width:n,height:o,min:a,max:r,strokeWidth:l,cornerRadius:c}=this,h=l/2;e.clear(),t.clear();const d=this.align(i)+h,u=this.align(s)+h,p=this.align(i,n)-2*h,f=this.align(s,o)-2*h,y=this.align(i+n*a)+h,b=y+this.align(i+n*a,n*(r-a))-2*h,x={topLeft:c,topRight:c,bottomRight:c,bottomLeft:c},v=(S,M,D)=>{if(D-M<1)return;const k=new lA(M,u,D-M,f);YX(S,d,u,p,f,x,k)};v(e,d,y),v(e,b,p+d),v(t,y,b)}renderStroke(e,t){super.renderStroke(e,t),super.renderStroke(e,this.visiblePath.getPath2D())}};cA.className="RangeMask",g([m,U()],cA.prototype,"cornerRadius",2);var ZX=class extends L.Group{constructor(e){super({name:"rangeSelectorGroup",zIndex:17}),this.x=0,this.y=0,this.width=200,this.height=30,this.lOffset=0,this.rOffset=0,this.background=this.appendChild(new L.TranslatableGroup({name:"navigator-background",zIndex:1})),this.append(e)}layout(e,t,i,s,n,o){this.x=e,this.y=t,this.width=i,this.height=s,this.lOffset=n,this.rOffset=o,this.background.translationX=e,this.background.translationY=t,this.markDirty("RangeSelector")}updateBackground(e,t){e?.remove(),t!=null&&this.background.appendChild(t),this.markDirty("RangeSelector")}computeBBox(){const{x:e,y:t,width:i,height:s,lOffset:n,rOffset:o}=this;return new L.BBox(e-n,t,i+(n+o),s)}},lp=class extends bi{constructor(e){super(),this.ctx=e,this.enabled=!1,this.mask=new cA,this.minHandle=new dc,this.maxHandle=new dc,this.maskVisibleRange={id:"navigator-mask-visible-range",getBBox:()=>this.mask.computeVisibleRangeBBox(),toCanvasBBox:()=>this.mask.computeVisibleRangeBBox(),fromCanvasPoint:(t,i)=>({x:t,y:i})},this.height=30,this.cornerRadius=0,this.spacing=10,this.x=0,this.y=0,this.width=0,this.rangeSelector=new ZX([this.mask,this.minHandle,this.maxHandle]),this.cleanup.register(e.scene.attachNode(this.rangeSelector),e.eventsHub.on("locale:change",()=>this.updateZoom()),e.layoutManager.registerElement(L.LayoutElement.Navigator,t=>this.onLayoutStart(t)),e.eventsHub.on("layout:complete",t=>this.onLayoutComplete(t)),e.eventsHub.on("zoom:change-complete",t=>this.onZoomChange(t))),this.domProxy=new jX(e,this),this.updateGroupVisibility(),this.miniChart=new rp(e)}updateBackground(e,t){this.rangeSelector?.updateBackground(e,t)}updateGroupVisibility(){const{enabled:e}=this;this.rangeSelector==null||e===this.rangeSelector.visible||(this.rangeSelector.visible=e,this.domProxy.updateVisibility(e),e?this.updateZoom():this.ctx.zoomManager.updateZoom({source:"chart-update",sourceDetail:"navigator"},{x:{min:0,max:1}}))}onLayoutStart({layoutBox:e}){if(this.enabled){const t=this.height+this.spacing;e.shrink(t,"bottom"),this.y=e.y+e.height+this.spacing}else this.y=0;if(this.enabled&&this.miniChart){const{top:t,bottom:i}=this.miniChart.computeAxisPadding();e.shrink(t+i,"bottom"),this.y-=i,this.miniChart.inset=this.mask.strokeWidth/2,this.miniChart.cornerRadius=this.mask.cornerRadius}}onLayoutComplete(e){const{x:t,width:i}=e.series.rect,{y:s,height:n}=this;if(this.domProxy.updateVisibility(this.enabled),this.enabled){const{_min:o,_max:a}=this.domProxy;this.layoutNodes(t,s,i,n,o,a),this.domProxy.updateBounds({x:t,y:s,width:i,height:n})}this.x=t,this.width=i,this.miniChart?.layout(i,n).catch(o=>j.error(o))}canDrag(){return this.enabled&&this.ctx.interactionManager.isState(L.InteractionState.ZoomDraggable)}onDragStart(e,{offsetX:t}){this.canDrag()&&(e==="pan"&&(this.panStart=(t-this.x)/this.width-this.domProxy._min),this.ctx.zoomManager.fireZoomPanStartEvent("navigator"))}onDrag(e,{offsetX:t}){if(!this.canDrag())return;const{panStart:i,x:s,width:n}=this,{minRange:o}=this.domProxy;let{_min:a,_max:r}=this.domProxy;const l=(t-s)/n;if(e==="min")a=ge(0,l,r-o);else if(e==="max")r=ge(a+o,l,1);else if(e==="pan"&&i!=null){const c=r-a;a=ge(0,l-i,1-c),r=a+c}this.domProxy._min=a,this.domProxy._max=r,this.updateZoom()}onZoomChange(e){const{x:t}=e;if(!t)return;const{x:i,y:s,width:n,height:o}=this,{min:a,max:r}=t;this.domProxy.updateMinMax(a,r),this.layoutNodes(i,s,n,o,a,r)}layoutNodes(e,t,i,s,n,o){const{rangeSelector:a,mask:r,minHandle:l,maxHandle:c}=this;r.layout(e,t,i,s,n,o),a.layout(e,t,i,s,l.width/2,c.width/2),dc.align(l,c,e,t,i,s,n,o,r.strokeWidth/2),n+(o-n)/2<.5?(l.zIndex=3,c.zIndex=4):(l.zIndex=4,c.zIndex=3);for(const[h,d]of[l,this.maskVisibleRange,c].entries()){const u=d.getBBox(),p={x:u.x-e,y:u.y-t,height:u.height,width:u.width};this.domProxy.updateSliderBounds(h,p)}}updateZoom(){this.enabled&&this.domProxy.updateZoom()}async processData(e){return this.miniChart?.processData(e)}};g([Wt((e,t,i)=>{e.updateBackground(i?.root,t?.root)})],lp.prototype,"miniChart",2),g([m,Wt((e,t)=>{e.ctx.zoomManager.setNavigatorEnabled(!!t),e.updateGroupVisibility()})],lp.prototype,"enabled",2),g([m],lp.prototype,"height",2),g([m,Wt((e,t)=>{e.mask.cornerRadius=t})],lp.prototype,"cornerRadius",2),g([m],lp.prototype,"spacing",2);function XX(e){return{from:e?{scalingX:1,scalingY:0}:{scalingX:0,scalingY:1},to:{scalingX:1,scalingY:1}}}function qX(e){return(t,i)=>e?{scalingCenterY:i.scaledValues.medianValue}:{scalingCenterX:i.scaledValues.medianValue}}var{Path:QX,Scalable:JX,ExtendedPath2D:e6,BBox:wh,clippedRoundRect:oR}=L,Vi=class extends JX(QX){constructor(){super(...arguments),this.wickPath=new e6,this.horizontal=!1,this.center=0,this.thickness=0,this.min=0,this.q1=0,this.median=0,this.q3=0,this.max=0,this.cornerRadius=0,this.crisp=!1,this.strokeAlignment=0,this.wickStroke=void 0,this.wickStrokeWidth=void 0,this.wickStrokeOpacity=void 0,this.capLengthRatio=1,this.wickStrokeAlignment=0}computeBBox(){const{horizontal:e,center:t,thickness:i,min:s,max:n}=this;return e?new wh(Math.min(s,n),t-i/2,Math.abs(n-s),i):new wh(t-i/2,Math.min(s,n),i,Math.abs(n-s))}computeDefaultGradientFillBBox(){const{horizontal:e,center:t,thickness:i,q1:s,q3:n}=this;return e?new wh(Math.min(s,n),t-i/2,Math.abs(n-s),i):new wh(t-i/2,Math.min(s,n),i,Math.abs(n-s))}isPointInPath(e,t){return this.getBBox().containsPoint(e,t)}distanceSquared(e,t){return this.getBBox().distanceSquared(e,t)}get midPoint(){return this.horizontal?{x:(this.min+this.max)/2,y:this.center}:{x:this.center,y:(this.min+this.max)/2}}alignedCoordinates(){const{thickness:e,crisp:t}=this;let{center:i,min:s,q1:n,median:o,q3:a,max:r}=this,l=i-e/2,c=i+e/2;if(t&&e>1){s=this.align(s),n=this.align(n),o=this.align(o),a=this.align(a),r=s+this.align(s,r-s);const h=this.align(e/2);i=this.align(i),l=i-h,c=i+h}return{center:i,x0:l,x1:c,min:s,max:r,q1:n,median:o,q3:a}}updatePath(){const{path:e,stroke:t,strokeWidth:i,strokeOpacity:s,lineDash:n,lineDashOffset:o,wickStroke:a,wickStrokeWidth:r,wickStrokeOpacity:l,wickLineDash:c,wickLineDashOffset:h,strokeAlignment:d,cornerRadius:u,capLengthRatio:p,horizontal:f}=this,{center:y,x0:b,x1:x,min:v,max:S,q1:M,median:D,q3:k}=this.alignedCoordinates(),I=this.layerManager?.canvas.pixelRatio??1,A=this.wickStrokeAlignment>0?I/this.wickStrokeAlignment/2%1:0;this.path.clear(),this.wickPath.clear();const w=a!=null&&a!==t||r!=null&&r!==i||l!=null&&l!==s||c!=null&&c!==n||h!=null&&h!==o?this.wickPath:e;if(Math.abs(x-b)<=3){cp(w,f,y,v),hp(w,f,y,S);return}const T=Math.min(v,S),O=Math.max(v,S),E=Math.min(M,k),z=Math.max(M,k),F=y-Math.abs((x-b)*p)/2,_=y+Math.abs((x-b)*p)/2;cp(w,f,F,T-A),hp(w,f,_,T-A),cp(w,f,y-A,T-A),hp(w,f,y-A,E+i/2),cp(w,f,y-A,O+A),hp(w,f,y-A,z-i/2),cp(w,f,F,O+A),hp(w,f,_,O+A);const G=i/2+d,B=i/2-d,V=z-E-2*B;if(V>0){const Y=b+G,X=E+B,q=x-b-2*G,te={topLeft:u,topRight:u,bottomRight:u,bottomLeft:u};aR(e,f,Y,X,q,V,te,new wh(Y,X,q,D-X)),aR(e,f,Y,X,q,V,te,new wh(Y,D,q,X+V-D))}else{const Y=(E+z)/2;cp(e,f,b,Y),hp(e,f,x,Y)}}drawPath(e){super.drawPath(e);const{wickPath:t}=this;if(t.isEmpty())return;const{stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:o,lineDashOffset:a,wickStroke:r=i,wickStrokeWidth:l=s,wickStrokeOpacity:c=n,wickLineDash:h=o,wickLineDashOffset:d=a}=this;l!==0&&(e.globalAlpha*=c,typeof r=="string"&&(e.strokeStyle=r),e.lineWidth=l,h!=null&&e.setLineDash([...h]),e.lineDashOffset=d,e.stroke(t.getPath2D()))}};g([U()],Vi.prototype,"horizontal",2),g([U()],Vi.prototype,"center",2),g([U()],Vi.prototype,"thickness",2),g([U()],Vi.prototype,"min",2),g([U()],Vi.prototype,"q1",2),g([U()],Vi.prototype,"median",2),g([U()],Vi.prototype,"q3",2),g([U()],Vi.prototype,"max",2),g([U()],Vi.prototype,"cornerRadius",2),g([U()],Vi.prototype,"crisp",2),g([U()],Vi.prototype,"strokeAlignment",2),g([U()],Vi.prototype,"wickStroke",2),g([U()],Vi.prototype,"wickStrokeWidth",2),g([U()],Vi.prototype,"wickStrokeOpacity",2),g([Yd()],Vi.prototype,"wickLineDash",2),g([U()],Vi.prototype,"wickLineDashOffset",2),g([U()],Vi.prototype,"capLengthRatio",2),g([U()],Vi.prototype,"wickStrokeAlignment",2);function cp(e,t,i,s){t?e.moveTo(s,i):e.moveTo(i,s)}function hp(e,t,i,s){t?e.lineTo(s,i):e.lineTo(i,s)}function aR(e,t,i,s,n,o,a,r){t?oR(e,s,i,o,n,a,r==null?void 0:new wh(r.y,r.x,r.height,r.width)):oR(e,i,s,n,o,a,r)}var{AbstractBarSeriesProperties:t6,makeSeriesTooltip:i6}=L,rR=class extends K{constructor(){super(...arguments),this.lengthRatio=.5}};g([m],rR.prototype,"lengthRatio",2);var dp=class extends K{};g([m],dp.prototype,"stroke",2),g([m],dp.prototype,"strokeWidth",2),g([m],dp.prototype,"strokeOpacity",2),g([m],dp.prototype,"lineDash",2),g([m],dp.prototype,"lineDashOffset",2);var Lt=class extends t6{constructor(){super(...arguments),this.fill="#c16068",this.fillOpacity=1,this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.cap=new rR,this.whisker=new dp,this.tooltip=i6()}toJson(){const{stroke:e,strokeWidth:t,strokeOpacity:i,lineDash:s,lineDashOffset:n}=this,o=super.toJson();return o.whisker=oe(o.whisker,{stroke:e,strokeWidth:t,strokeOpacity:i,lineDash:s,lineDashOffset:n}),o}};g([m],Lt.prototype,"xKey",2),g([m],Lt.prototype,"minKey",2),g([m],Lt.prototype,"q1Key",2),g([m],Lt.prototype,"medianKey",2),g([m],Lt.prototype,"q3Key",2),g([m],Lt.prototype,"maxKey",2),g([m],Lt.prototype,"xName",2),g([m],Lt.prototype,"yName",2),g([m],Lt.prototype,"minName",2),g([m],Lt.prototype,"q1Name",2),g([m],Lt.prototype,"medianName",2),g([m],Lt.prototype,"q3Name",2),g([m],Lt.prototype,"maxName",2),g([m],Lt.prototype,"fill",2),g([m],Lt.prototype,"fillOpacity",2),g([m],Lt.prototype,"stroke",2),g([m],Lt.prototype,"strokeWidth",2),g([m],Lt.prototype,"strokeOpacity",2),g([m],Lt.prototype,"lineDash",2),g([m],Lt.prototype,"lineDashOffset",2),g([m],Lt.prototype,"cornerRadius",2),g([m],Lt.prototype,"styler",2),g([m],Lt.prototype,"itemStyler",2),g([m],Lt.prototype,"cap",2),g([m],Lt.prototype,"whisker",2),g([m],Lt.prototype,"tooltip",2);var{fixNumericExtent:s6,keyProperty:n6,SeriesNodePickMode:lR,SMALLEST_KEY_INTERVAL:o6,valueProperty:Ff,diff:a6,animationValidation:r6,computeBarFocusBounds:l6,createDatumId:c6,HighlightState:hA,ContinuousScale:h6,motion:cR,getItemStyles:d6,calculateSegments:u6,toHighlightString:p6}=L,g6=class extends L.SeriesNodeEvent{constructor(e,t,i,s){super(e,t,i,s),this.xKey=s.properties.xKey,this.minKey=s.properties.minKey,this.q1Key=s.properties.q1Key,this.medianKey=s.properties.medianKey,this.q3Key=s.properties.q3Key,this.maxKey=s.properties.maxKey}},dA=class extends L.AbstractBarSeries{constructor(e){super({moduleCtx:e,pickModes:[lR.NEAREST_NODE,lR.EXACT_SHAPE_MATCH],propertyKeys:{x:["xKey"],y:["medianKey","q1Key","q3Key","minKey","maxKey"]},propertyNames:{x:["xName"],y:["medianName","q1Name","q3Name","minName","maxName"]},categoryKey:"xValue",pathsPerSeries:[]}),this.properties=new Lt,this.NodeEvent=g6}async processData(e){if(!this.visible)return;const{xKey:t,minKey:i,q1Key:s,medianKey:n,q3Key:o,maxKey:a}=this.properties,r=!this.ctx.animationManager.isSkipped(),l=this.getCategoryAxis()?.scale,c=this.getValueAxis()?.scale,{isContinuousX:h,xScaleType:d,yScaleType:u}=this.getScaleInformation({xScale:l,yScale:c}),p=[];this.needsDataModelDiff()&&this.processedData&&p.push(a6(this.id,this.processedData)),r&&p.push(r6());const{processedData:f}=await this.requestDataModel(e,this.data,{props:[n6(t,d,{id:"xValue"}),Ff(i,u,{id:"minValue"}),Ff(s,u,{id:"q1Value"}),Ff(n,u,{id:"medianValue"}),Ff(o,u,{id:"q3Value"}),Ff(a,u,{id:"maxValue"}),...h?[o6]:[],...p]});this.smallestDataInterval=f.reduced?.smallestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!(t&&i))return{domain:[]};if(e!==this.getBarDirection()){const{index:n,def:o}=i.resolveProcessedDataDefById(this,"xValue"),a=t.domain.keys[n];if(o.type==="key"&&o.valueType==="category"){const r=i.getKeySortMetadata(this,"xValue",t);return{domain:a,sortMetadata:r}}return{domain:this.padBandExtent(a)}}const s=this.domainForClippedRange(e,["minValue","maxValue"],"xValue");return{domain:s6(s)}}getSeriesRange(e,t){return this.domainForVisibleRange("y",["maxValue","minValue"],"xValue",t)}createNodeData(){const{visible:e,dataModel:t,processedData:i}=this,s=this.getCategoryAxis(),n=this.getValueAxis();if(!(t&&i&&s&&n))return;const{xKey:o}=this.properties,a=[],r=t.resolveKeysById(this,"xValue",i),l=t.resolveColumnById(this,"minValue",i),c=t.resolveColumnById(this,"q1Value",i),h=t.resolveColumnById(this,"medianValue",i),d=t.resolveColumnById(this,"q3Value",i),u=t.resolveColumnById(this,"maxValue",i),{barWidth:p,groupIndex:f}=this.updateGroupScale(s),y=h6.is(s.scale)?p*-.5:0,{groupScale:b}=this,x=this.isVertical(),v=u6(this.properties.segmentation,s,n,this.chart.seriesRect,this.ctx.scene),S={itemId:o,nodeData:a,labelData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible,styles:d6(this.getItemStyle.bind(this)),segments:v};if(!e)return S;const M=i.dataSources.get(this.id)?.data??[];for(const[D,k]of M.entries()){const I=r[D];if(I==null)continue;const A=l[D],C=c[D],w=h[D],T=d[D],O=u[D];if([A,C,w,T,O].some(Y=>typeof Y!="number")||A>C||C>w||w>T||T>O)continue;const E={xValue:s.scale.convert(I),minValue:n.scale.convert(A),q1Value:n.scale.convert(C),medianValue:n.scale.convert(w),q3Value:n.scale.convert(T),maxValue:n.scale.convert(O)},z=p;E.xValue+=b.convert(String(f))+y+z/2;const F=Math.abs(E.q3Value-E.q1Value),_=E.xValue,G=Math.min(E.q3Value,E.q1Value)+F/2,B={x:x?_:G,y:x?G:_};let V;x?V={x:B.x-z/2,y:E.minValue,width:z,height:E.maxValue-E.minValue}:V={x:E.minValue,y:B.y-z/2,width:E.maxValue-E.minValue,height:z},a.push({series:this,itemId:I,datum:k,datumIndex:D,xKey:o,bandwidth:z,scaledValues:E,midPoint:B,focusRect:V})}return S}legendItemSymbol(){const{fill:e,stroke:t,strokeWidth:i,fillOpacity:s,strokeOpacity:n,lineDash:o,lineDashOffset:a}=this.getStyle(!1,hA.None);return{marker:{fill:Re(e),fillOpacity:s,stroke:t,strokeOpacity:n,strokeWidth:i,lineDash:o,lineDashOffset:a}}}getLegendData(e){const{id:t,ctx:{legendManager:i},visible:s}=this,{xKey:n,yName:o,showInLegend:a,legendItemName:r}=this.properties;return!n||e!=="category"?[]:[{legendType:"category",id:t,itemId:t,seriesId:t,enabled:s&&i.getItemEnabled({seriesId:t,itemId:t}),label:{text:r??o??t},symbol:this.legendItemSymbol(),legendItemName:r,hideInLegend:!a}]}getTooltipContent(e){const{id:t,dataModel:i,processedData:s,properties:n}=this,{xKey:o,xName:a,yName:r,medianKey:l,medianName:c,q1Key:h,q1Name:d,q3Key:u,q3Name:p,minKey:f,minName:y,maxKey:b,maxName:x,legendItemName:v,tooltip:S}=n,M=this.getCategoryAxis(),D=this.getValueAxis();if(!i||!s||!M||!D)return;const k=s.dataSources.get(this.id)?.data[e],I=i.resolveKeysById(this,"xValue",s)[e],A=i.resolveColumnById(this,"minValue",s)[e],C=i.resolveColumnById(this,"q1Value",s)[e],w=i.resolveColumnById(this,"medianValue",s)[e],T=i.resolveColumnById(this,"q3Value",s)[e],O=i.resolveColumnById(this,"maxValue",s)[e];if(I==null)return;const E=this.getItemStyle(e,!1),z=[{label:y,fallbackLabel:f,value:this.getAxisValueText(D,"tooltip",A,k,f,v),missing:L.isTooltipValueMissing(A)},{label:d,fallbackLabel:h,value:this.getAxisValueText(D,"tooltip",C,k,h,v),missing:L.isTooltipValueMissing(C)},{label:c,fallbackLabel:l,value:this.getAxisValueText(D,"tooltip",w,k,l,v),missing:L.isTooltipValueMissing(w)},{label:p,fallbackLabel:u,value:this.getAxisValueText(D,"tooltip",T,k,u,v),missing:L.isTooltipValueMissing(T)},{label:x,fallbackLabel:b,value:this.getAxisValueText(D,"tooltip",O,k,b,v),missing:L.isTooltipValueMissing(O)}];return this.formatTooltipWithContext(S,{heading:this.getAxisValueText(M,"tooltip",I,k,o,v),title:v??r,symbol:this.legendItemSymbol(),data:z},{seriesId:t,datum:k,title:r,xKey:o,xName:a,yName:r,medianKey:l,medianName:c,q1Key:h,q1Name:d,q3Key:u,q3Name:p,minKey:f,minName:y,maxKey:b,maxName:x,...E})}animateEmptyUpdateReady({datumSelection:e}){const t=this.isVertical(),{from:i,to:s}=XX(t);cR.resetMotion([e],qX(t)),cR.staticFromToMotion(this.id,"datums",this.ctx.animationManager,[e],i,s,{phase:"initial"})}isLabelEnabled(){return!1}updateDatumSelection(e){const t=e.nodeData??[];return e.datumSelection.update(t)}makeStylerParams(e){const{id:t}=this,{cornerRadius:i,cap:{lengthRatio:s},fill:n,fillOpacity:o,lineDash:a,lineDashOffset:r,stroke:l,strokeOpacity:c,strokeWidth:h,maxKey:d,maxName:u,medianKey:p,medianName:f,minKey:y,minName:b,q1Key:x,q1Name:v,q3Key:S,q3Name:M,whisker:{lineDash:D,lineDashOffset:k,stroke:I,strokeOpacity:A,strokeWidth:C},xKey:w,xName:T,yName:O}=this.properties,E=p6(e??hA.None);return{cap:{lengthRatio:s},cornerRadius:i,fill:n,fillOpacity:o,highlightState:E,lineDash:a,lineDashOffset:r,maxKey:d,maxName:u??d,medianKey:p,medianName:f??p,minKey:y,minName:b??y,q1Key:x,q1Name:v??x,q3Key:S,q3Name:M??S,seriesId:t,stroke:l,strokeOpacity:c,strokeWidth:h,whisker:{lineDash:D??a,lineDashOffset:k??r,stroke:I??l,strokeOpacity:A??c,strokeWidth:C??h},xKey:w,xName:T??w,yName:O}}getStyle(e,t){const{cap:i,cornerRadius:s,fill:n,fillOpacity:o,lineDash:a,lineDashOffset:r,stroke:l,strokeOpacity:c,strokeWidth:h,styler:d,whisker:u}=this.properties;let p={};if(!e&&d){const f=this.makeStylerParams(t);p=this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],this.cachedCallWithContext(d,f)??{},{pick:!1})??{}}return{cornerRadius:p.cornerRadius??s,fill:p.fill??n,fillOpacity:p.fillOpacity??o,lineDash:p.lineDash??a,lineDashOffset:p.lineDashOffset??r,opacity:1,stroke:p.stroke??l,strokeOpacity:p.strokeOpacity??c,strokeWidth:p.strokeWidth??h,cap:{lengthRatio:p.cap?.lengthRatio??i.lengthRatio},whisker:{lineDash:p.whisker?.lineDash??u.lineDash,lineDashOffset:p.whisker?.lineDashOffset??u.lineDashOffset,stroke:p.whisker?.stroke??u.stroke,strokeOpacity:p.whisker?.strokeOpacity??u.strokeOpacity,strokeWidth:p.whisker?.strokeWidth??u.strokeWidth}}}getItemStyle(e,t,i){const{properties:s}=this,{itemStyler:n}=s,o=this.getHighlightStyle(t,e,i);let a=oe(o,this.getStyle(e===void 0,i));if(n!=null&&e!=null){const u=this.cachedDatumCallback(c6(e,t?"highlight":"node"),()=>{const p=this.makeItemStylerParams(e,t,a);return this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],this.callWithContext(n,p))});u&&(a=oe(u,a))}const{stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}=a;return a.whisker=oe(a.whisker,{stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}),a}makeItemStylerParams(e,t,i){const{id:s}=this,{xKey:n,minKey:o,q1Key:a,medianKey:r,q3Key:l,maxKey:c}=this.properties,h=this.processedData?.dataSources.get(s)?.data[e],d=this.ctx.highlightManager?.getActiveHighlight(),u=this.getHighlightStateString(d,t,e),p=this.filterItemStylerFillParams(i.fill)??i.fill;return{seriesId:s,datum:h,xKey:n,minKey:o,q1Key:a,medianKey:r,q3Key:l,maxKey:c,highlightState:u,...i,fill:p}}updateDatumStyles({datumSelection:e,isHighlight:t}){const i=this.ctx.highlightManager.getActiveHighlight();e.each((s,n)=>{const o=this.getHighlightState(i,t,n.datumIndex);n.style=this.getItemStyle(n.datumIndex,t,o)})}updateDatumNodes({datumSelection:e,isHighlight:t}){const{contextNodeData:i,properties:s}=this;if(!i)return;const n=this.isVertical(),o=this.ctx.highlightManager.getActiveHighlight(),a=this.getShapeFillBBox(),r=this.getStyle(!1,hA.None).strokeWidth/2,l=s.whisker.strokeWidth??s.strokeWidth;e.each((c,h)=>{const d=h.style??i.styles[this.getHighlightState(o,t,h.datumIndex)];c.setFillProperties(d.fill,a);const u=d.opacity??1,p=d.whisker?.strokeOpacity??d.strokeOpacity;c.fill=d.fill,c.fillOpacity=d.fillOpacity*u,c.stroke=d.stroke,c.strokeWidth=d.strokeWidth,c.strokeOpacity=d.strokeOpacity*u,c.lineDash=d.lineDash,c.lineDashOffset=d.lineDashOffset,c.wickStroke=d.whisker.stroke,c.wickStrokeWidth=d.whisker.strokeWidth,c.wickStrokeOpacity=p*u,c.wickLineDash=d.whisker.lineDash,c.wickLineDashOffset=d.whisker.lineDashOffset,c.cornerRadius=d.cornerRadius,c.crisp=!0,c.horizontal=!n,c.center=h.scaledValues.xValue,c.thickness=h.bandwidth,c.min=h.scaledValues.minValue,c.q1=h.scaledValues.q1Value,c.median=h.scaledValues.medianValue,c.q3=h.scaledValues.q3Value,c.max=h.scaledValues.maxValue,c.capLengthRatio=d.cap.lengthRatio,c.strokeAlignment=r,c.wickStrokeAlignment=l})}updateLabelNodes(){}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e;return i.update(t)}nodeFactory(){return new Vi}computeFocusBounds({datumIndex:e}){return l6(this,this.contextNodeData?.nodeData[e].focusRect)}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.styler!=null}};dA.className="BoxPlotSeries",dA.type="box-plot";var{boxPlotSeriesThemeableOptionsDef:f6}=L,m6={...et,...f6,type:$(Le("box-plot")),xKey:$(N),minKey:$(N),q1Key:$(N),medianKey:$(N),q3Key:$(N),maxKey:$(N),xKeyAxis:N,yKeyAxis:N,xName:N,yName:N,minName:N,q1Name:N,medianName:N,q3Name:N,maxName:N,grouped:R,legendItemName:N,segmentation:ca},{FILL_GRADIENT_LINEAR_DEFAULTS:y6,FILL_IMAGE_DEFAULTS:x6,FILL_PATTERN_DEFAULTS:b6,SAFE_FILL_OPERATION:v6,SEGMENTATION_DEFAULTS:S6}=L,M6={series:{direction:"vertical",fill:{$applySwitch:[{$path:"type"},{$if:[{$or:[{$isGradient:{$palette:"fill"}},{$isPattern:{$palette:"fill"}},{$isImage:{$palette:"fill"}}]},{$palette:"fill"},{$mix:[v6,{$ref:"chartBackgroundColor"},.7]}]},["gradient",y6],["image",x6],["pattern",b6]]},stroke:{$palette:"stroke"},strokeWidth:2,fillOpacity:1,strokeOpacity:1,lineDash:void 0,lineDashOffset:0,highlight:{unhighlightedItem:{opacity:.5},unhighlightedSeries:{opacity:.1}},segmentation:S6},axes:{number:{crosshair:{snap:!1}},category:{groupPaddingInner:.2,crosshair:{enabled:!1,snap:!1}}}},{DIRECTION_SWAP_AXES:D6,predictCartesianNonPrimitiveAxis:I6}=L,uA={type:"series",name:"box-plot",chartType:"cartesian",enterprise:!0,groupable:!0,version:ue,dependencies:[oi],options:m6,predictAxis:I6,defaultAxes:D6,axisKeys:{x:"xKeyAxis",y:"yKeyAxis"},axisKeysFlipped:{x:"yKeyAxis",y:"xKeyAxis"},themeTemplate:M6,create:e=>new dA(e)};function k6(e,t,i,s,n,o,a,r){const[l,c]=si(e,n);return rr([l,c],t,i,s,{smallestKeyInterval:o,xNeedsValueOf:a,yNeedsValueOf:r})}var A6=pr(k6);function C6(e,t,i,s,n){const o=t.resolveKeysById(s,"xValue",i),a=t.resolveColumnById(s,"highValue",i),r=t.resolveColumnById(s,"lowValue",i),l=t.getDomain(s,"xValue","key",i),c=t.resolveColumnNeedsValueOf(s,"xValue",i),h=t.resolveColumnNeedsValueOf(s,"highValue",i)??t.resolveColumnNeedsValueOf(s,"lowValue",i);if(n){const[d,u]=si(e,l);return rr([d,u],o,a,r,{smallestKeyInterval:i.reduced?.smallestKeyInterval,xNeedsValueOf:c,yNeedsValueOf:h,existingFilters:n})}return A6(e,o,a,r,l,i.reduced?.smallestKeyInterval,c,h)}function L6(e,t,i,s,n,o){const a=t.resolveKeysById(s,"xValue",i),r=t.resolveColumnById(s,"highValue",i),l=t.resolveColumnById(s,"lowValue",i),c=t.getDomain(s,"xValue","key",i),h=t.resolveColumnNeedsValueOf(s,"xValue",i),d=t.resolveColumnNeedsValueOf(s,"highValue",i)??t.resolveColumnNeedsValueOf(s,"lowValue",i),[u,p]=si(e,c);return tg([u,p],a,r,l,{smallestKeyInterval:i.reduced?.smallestKeyInterval,targetRange:n,xNeedsValueOf:h,yNeedsValueOf:d,existingFilters:o})}var{Path:w6,BBox:T6}=L,Yr=class extends w6{constructor(){super(...arguments),this.centerX=0,this.y=0,this.width=0,this.height=0,this.yOpen=0,this.yClose=0,this.crisp=!1}setStaticProperties(e,t,i,s,n,o,a){this.__centerX=e,this.__width=t,this.__y=i,this.__height=s,this.__yOpen=n,this.__yClose=o,this.__crisp=a,this.dirtyPath=!0,this.markDirty()}computeBBox(){const{__centerX:e,__y:t,__width:i,__height:s}=this;return new T6(e-i/2,t,i,s)}isPointInPath(e,t){return this.getBBox().containsPoint(e,t)}distanceSquared(e,t){return this.getBBox().distanceSquared(e,t)}get midPoint(){return{x:this.__centerX,y:this.__y+this.__height/2}}alignedCoordinates(){const{__y:e,__width:t,__height:i,__crisp:s}=this;let{__centerX:n,__yOpen:o,__yClose:a}=this,r=n-t/2,l=n+t/2,c=e,h=e+i;if(s&&t>1){if(n=this.align(n),o<=a){const u=this.align(o,a-o);o=this.align(o),a=o+u}else{const u=this.align(a,o-a);a=this.align(a),o=a+u}const d=this.align(t/2);r=n-d,l=n+d,c=this.align(e),h=c+this.align(c,i)}return{centerX:n,x0:r,x1:l,y0:c,y1:h,yOpen:o,yClose:a}}executeStroke(e,t){const{__width:i,strokeWidth:s}=this;i<s&&(e.lineWidth=i),super.executeStroke(e,t)}};g([_e()],Yr.prototype,"centerX",2),g([_e()],Yr.prototype,"y",2),g([_e()],Yr.prototype,"width",2),g([_e()],Yr.prototype,"height",2),g([_e()],Yr.prototype,"yOpen",2),g([_e()],Yr.prototype,"yClose",2),g([_e()],Yr.prototype,"crisp",2);var hR=class extends Yr{constructor(){super(...arguments),this.strokeAlignment=0}updatePath(){const{path:e}=this,{centerX:t,x0:i,x1:s,y0:n,y1:o,yOpen:a,yClose:r}=this.alignedCoordinates(),l=this.layerManager?.canvas.pixelRatio??1,c=this.__strokeAlignment>0?l/this.__strokeAlignment/2%1:0;e.clear(),e.moveTo(t-c,n),e.lineTo(t-c,o),Math.abs(s-i)>1&&(e.moveTo(i,a-c),e.lineTo(t-c,a-c),e.moveTo(t-c,r-c),e.lineTo(s,r-c))}};g([_e()],hR.prototype,"strokeAlignment",2);var N6=Hs,O6=$s,E6=Ws,dR=js,uR=In,{AggregationManager:P6,fixNumericExtent:R6,keyProperty:F6,createDatumId:pA,SeriesNodePickMode:pR,SMALLEST_KEY_INTERVAL:z6,valueProperty:nv,diff:B6,animationValidation:_6,computeBarFocusBounds:V6,visibleRangeIndices:gR,BandScale:G6,processedDataIsAnimatable:gA,getItemStylesPerItemId:H6}=L,j6=class extends L.SeriesNodeEvent{constructor(e,t,i,s){super(e,t,i,s),this.xKey=s.properties.xKey,this.openKey=s.properties.openKey,this.closeKey=s.properties.closeKey,this.highKey=s.properties.highKey,this.lowKey=s.properties.lowKey}};function W6(e){for(const t of e){const i=t.nodes();t.batchedUpdate(function(){for(const n of i){const o=n.datum;o!=null&&n.setStaticProperties(o.centerX,o.width,o.y,o.height,o.yOpen,o.yClose,o.crisp)}t.cleanup()})}}var fR=class extends L.AbstractBarSeries{constructor(e){super({moduleCtx:e,pickModes:[pR.AXIS_ALIGNED,pR.EXACT_SHAPE_MATCH],propertyKeys:{x:["xKey"],y:["lowKey","highKey","openKey","closeKey"]},propertyNames:{x:["xName"],y:["lowName","highName","openName","closeName"]},categoryKey:"xValue",pathsPerSeries:[]}),this.NodeEvent=j6,this.aggregationManager=new P6}async processData(e){if(!this.visible)return;const{xKey:t,openKey:i,closeKey:s,highKey:n,lowKey:o}=this.properties,a=!this.ctx.animationManager.isSkipped(),r=this.getCategoryAxis()?.scale,l=this.getValueAxis()?.scale,{isContinuousX:c,xScaleType:h,yScaleType:d}=this.getScaleInformation({xScale:r,yScale:l}),u=[];this.needsDataModelDiff()&&this.processedData&&u.push(B6(this.id,this.processedData)),a&&u.push(_6()),i&&u.push(nv(i,d,{id:"openValue",invalidValue:void 0,missingValue:void 0}));const{dataModel:p,processedData:f}=await this.requestDataModel(e,this.data,{props:[F6(t,h,{id:"xValue"}),nv(s,d,{id:"closeValue"}),nv(n,d,{id:"highValue"}),nv(o,d,{id:"lowValue"}),...c?[z6]:[],...u]});this.smallestDataInterval=f.reduced?.smallestKeyInterval,this.aggregateData(p,f),this.animationState.transition("updateData")}aggregateData(e,t){if(this.aggregationManager.markStale(),t.type!=="ungrouped"||gA(t))return;const i=this.axes.x;if(i==null)return;const s=this.estimateTargetRange();this.aggregationManager.aggregate({computePartial:o=>L6(i.scale.type,e,t,this,s,o),computeFull:o=>C6(i.scale.type,e,t,this,o),targetRange:s});const n=this.aggregationManager.filters;n&&n.length>0&&Jn.record(`${this.type}:aggregation`,n.map(o=>o.maxRange))}estimateTargetRange(){const e=this.axes.x;if(!e)return-1;const[t,i]=e.scale.range;return Math.abs(i-t)}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!(t&&i))return{domain:[]};if(e!==this.getBarDirection()){const{def:n}=i.resolveProcessedDataDefById(this,"xValue"),o=i.getDomain(this,"xValue","key",t);return n.type==="key"&&n.valueType==="category"?o:{domain:this.padBandExtent(o.domain)}}const s=this.domainForClippedRange(e,["highValue","lowValue"],"xValue");return{domain:R6(s)}}getSeriesRange(e,t){return this.domainForVisibleRange("y",["highValue","lowValue"],"xValue",t)}getZoomRangeFittingItems(e,t,i){return this.zoomFittingVisibleItems("xValue",["highValue","lowValue"],e,t,i)}getVisibleItems(e,t,i){return this.countVisibleItems("xValue",["highValue","lowValue"],e,t,i)}createNodeDatumContext(e,t){const{dataModel:i,processedData:s,groupScale:n}=this;if(!i||!s)return;const o=s.dataSources.get(this.id)?.data??[];if(o.length===0)return;const a=e.scale,r=t.scale,{barWidth:l,groupIndex:c}=this.updateGroupScale(e),h=n.convert(String(c)),d=l>=1?l:n.rawBandwidth,u=G6.is(a),[p,f]=a.range,y=Math.abs(f-p);this.aggregationManager.ensureLevelForRange(y);const b=this.aggregationManager.getFilterForRange(y),x=b==null,v=this.contextNodeData?.nodeData!=null&&(s.changeDescription!=null||!gA(s)||b!=null);return{rawData:o,xValues:i.resolveKeysById(this,"xValue",s),openValues:i.resolveColumnById(this,"openValue",s),closeValues:i.resolveColumnById(this,"closeValue",s),highValues:i.resolveColumnById(this,"highValue",s),lowValues:i.resolveColumnById(this,"lowValue",s),xScale:a,yScale:r,xAxis:e,yAxis:t,barWidth:l,groupOffset:h,effectiveBarWidth:d,applyWidthOffset:u,crisp:x,xKey:this.properties.xKey,openKey:this.properties.openKey,closeKey:this.properties.closeKey,highKey:this.properties.highKey,lowKey:this.properties.lowKey,dataAggregationFilter:b,range:y,nodeDatumStateScratch:{datum:void 0,xValue:void 0,openValue:0,closeValue:0,highValue:0,lowValue:0,isRising:!0,itemType:"up"},canIncrementallyUpdate:v,nodeIndex:0,nodeData:v?this.contextNodeData.nodeData:[]}}prepareOhlcNodeDatumState(e,t){const i=e.xValues[t];if(i==null)return;const s=e.openValues[t],n=e.closeValues[t],o=e.highValues[t],a=e.lowValues[t],r=a!=null&&a<=s&&a<=n,l=o!=null&&o>=s&&o>=n;if(!r){j.warnOnce(`invalid low value for key [${e.lowKey}] in data element, low value cannot be higher than datum open or close values`);return}if(!l){j.warnOnce(`invalid high value for key [${e.highKey}] in data element, high value cannot be lower than datum open or close values.`);return}const c=e.rawData[t],h=n>s,d=h?"up":"down",u=e.nodeDatumStateScratch;return u.datum=c,u.xValue=i,u.openValue=s,u.closeValue=n,u.highValue=o,u.lowValue=a,u.isRising=h,u.itemType=d,u}createSkeletonNodeDatum(e,t,i,s,n,o){const a=e.applyWidthOffset?n/2:0,r=s+a,l=e.yScale.convert(t.openValue),c=e.yScale.convert(t.closeValue),h=e.yScale.convert(t.highValue),d=e.yScale.convert(t.lowValue),u=Math.min(h,d),p=Math.max(h,d)-u;return{series:this,itemType:t.itemType,datum:t.datum,datumIndex:i,xKey:e.xKey,xValue:t.xValue,openValue:t.openValue,closeValue:t.closeValue,highValue:t.highValue,lowValue:t.lowValue,midPoint:{x:r,y:u+p/2},aggregatedValue:t.closeValue,isRising:t.isRising,centerX:r,width:n,y:u,height:p,yOpen:l,yClose:c,crisp:o}}updateNodeDatum(e,t,i,s,n,o,a){const r=t,l=e.applyWidthOffset?o/2:0,c=n+l,h=e.yScale.convert(i.openValue),d=e.yScale.convert(i.closeValue),u=e.yScale.convert(i.highValue),p=e.yScale.convert(i.lowValue),f=Math.min(u,p),y=Math.max(u,p)-f;r.datum=i.datum,r.datumIndex=s,r.itemType=i.itemType,r.xValue=i.xValue,r.openValue=i.openValue,r.closeValue=i.closeValue,r.highValue=i.highValue,r.lowValue=i.lowValue,r.aggregatedValue=i.closeValue,r.isRising=i.isRising,r.centerX=c,r.width=o,r.y=f,r.height=y,r.yOpen=h,r.yClose=d,r.crisp=a;const b=r.midPoint;b.x=c,b.y=f+y/2}upsertNodeDatum(e,t,i,s,n){const o=this.prepareOhlcNodeDatumState(e,t);if(!o)return;if(e.canIncrementallyUpdate&&e.nodeIndex<e.nodeData.length)this.updateNodeDatum(e,e.nodeData[e.nodeIndex],o,t,i,s,n);else{const r=this.createSkeletonNodeDatum(e,o,t,i,s,n);e.nodeData.push(r)}e.nodeIndex++}createNodeData(){const{visible:e}=this,t=this.getCategoryAxis(),i=this.getValueAxis();if(!t||!i)return;const s=this.createNodeDatumContext(t,i),n={itemId:this.properties.xKey,nodeData:s?.nodeData??[],labelData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible,styles:H6(this.getItemStyle.bind(this),"up","down")};if(!e||!s)return n;const o=a=>s.xScale.convert(s.xValues[a])+s.groupOffset;if(s.dataAggregationFilter==null){const a=this.processedData.invalidData?.get(this.id);let[r,l]=gR(1,s.rawData.length,s.xAxis.range,c=>{const h=s.applyWidthOffset?0:-s.effectiveBarWidth/2,d=o(c)+h;return[d,d+s.effectiveBarWidth]});this.processedData.input.count<1e3&&(r=0,l=this.processedData.input.count);for(let c=r;c<l;c+=1){if(a?.[c]===!0)continue;const h=o(c);this.upsertNodeDatum(s,c,h,s.effectiveBarWidth,s.crisp)}s.canIncrementallyUpdate&&s.nodeIndex<s.nodeData.length&&(s.nodeData.length=s.nodeIndex)}else{const{maxRange:a,indexData:r,midpointIndices:l}=s.dataAggregationFilter,[c,h]=gR(1,a,s.xAxis.range,d=>{const u=d*uR,p=r[u+dR],f=l[d];if(f===-1)return;const y=s.applyWidthOffset?0:-s.effectiveBarWidth/2;return[o(f)+y,o(p)+y+s.effectiveBarWidth]});for(let d=c;d<h;d+=1){const u=d*uR,p=r[u+N6],f=r[u+dR],y=r[u+O6],b=r[u+E6],x=l[d];if(x===-1)continue;const v=this.prepareOhlcNodeDatumState(s,x);if(!v)continue;v.openValue=s.openValues[p],v.closeValue=s.closeValues[f],v.highValue=s.highValues[y],v.lowValue=s.lowValues[b],v.isRising=v.closeValue>v.openValue,v.itemType=v.isRising?"up":"down";const S=o(x),M=Math.abs(o(f)-o(p))+s.effectiveBarWidth;if(s.canIncrementallyUpdate&&s.nodeIndex<s.nodeData.length)this.updateNodeDatum(s,s.nodeData[s.nodeIndex],v,x,S,M,!1);else{const k=this.createSkeletonNodeDatum(s,v,x,S,M,!1);s.nodeData.push(k)}s.nodeIndex++}s.canIncrementallyUpdate&&s.nodeIndex<s.nodeData.length&&(s.nodeData.length=s.nodeIndex)}return n}isVertical(){return!0}isLabelEnabled(){return!1}resetDatumAnimation(e){W6([e.datumSelection])}updateDatumSelection(e){const t=e.nodeData??[];return gA(this.processedData)?e.datumSelection.update(t,void 0,i=>pA(i.xValue)):e.datumSelection.update(t)}updateLabelNodes(e){}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e;return i.update(t)}getItemStyle(e,t,i,s="up"){const{properties:n,dataModel:o,processedData:a}=this,{itemStyler:r}=n,l=this.getHighlightStyle(t,e,i);let h=oe(l,n.getStyle(s));if(r&&o!=null&&a!=null&&e!=null){const d=o.resolveKeysById(this,"xValue",a)[e],u=this.cachedDatumCallback(pA(pA(d),t?"highlight":"node"),()=>{const p=this.makeItemStylerParams(s,e,t,h);return this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`,"item",s],this.callWithContext(r,p))});u&&(h=oe(u,h))}return h}makeItemStylerParams(e,t,i,s){const{id:n,properties:o,processedData:a}=this,{xKey:r,openKey:l,closeKey:c,highKey:h,lowKey:d}=o,u=a.dataSources.get(n)?.data[t],p=this.ctx.highlightManager?.getActiveHighlight(),f=this.getHighlightStateString(p,i,t),y={seriesId:n,datum:u,itemType:e,xKey:r,openKey:l,closeKey:c,highKey:h,lowKey:d,highlightState:f,...s};return"fill"in y&&"fill"in s&&(y.fill=this.filterItemStylerFillParams(s.fill)??s.fill),y}getTooltipContent(e){const{id:t,dataModel:i,processedData:s,properties:n}=this,{xKey:o,xName:a,yName:r,openKey:l,openName:c,highKey:h,highName:d,lowKey:u,lowName:p,closeKey:f,closeName:y,legendItemName:b,tooltip:x}=n,v=this.getCategoryAxis(),S=this.getValueAxis();if(!i||!s||!v||!S)return;const M=s.dataSources.get(this.id)?.data[e],D=i.resolveKeysById(this,"xValue",s)[e],k=i.resolveColumnById(this,"openValue",s)[e],I=i.resolveColumnById(this,"highValue",s)[e],A=i.resolveColumnById(this,"lowValue",s)[e],C=i.resolveColumnById(this,"closeValue",s)[e];if(D==null)return;const w=C>=k?"up":"down",T=this.properties.item[w],O=this.getItemStyle(e,!1),E={fill:T.fill??T.stroke,fillOpacity:T.fillOpacity??T.strokeOpacity??1,stroke:T.stroke,strokeWidth:T.strokeWidth??1,strokeOpacity:T.strokeOpacity??1,lineDash:T.lineDash??[0],lineDashOffset:T.lineDashOffset??0};return this.formatTooltipWithContext(x,{heading:this.getAxisValueText(v,"tooltip",D,M,o,b),title:b,symbol:{marker:E},data:[{label:c,fallbackLabel:l,value:this.getAxisValueText(S,"tooltip",k,M,l,b),missing:L.isTooltipValueMissing(k)},{label:d,fallbackLabel:h,value:this.getAxisValueText(S,"tooltip",I,M,h,b),missing:L.isTooltipValueMissing(I)},{label:p,fallbackLabel:u,value:this.getAxisValueText(S,"tooltip",A,M,u,b),missing:L.isTooltipValueMissing(A)},{label:y,fallbackLabel:f,value:this.getAxisValueText(S,"tooltip",C,M,f,b),missing:L.isTooltipValueMissing(C)}]},{seriesId:t,datum:M,title:r,itemType:w,xKey:o,xName:a,yName:r,openKey:l,openName:c,highKey:h,highName:d,lowKey:u,lowName:p,closeKey:f,closeName:y,...O})}computeFocusBounds(e){const t=this.getNodeData()?.at(e.datumIndex);if(t==null)return;const{centerX:i,y:s,width:n,height:o}=t,a={x:i-n/2,y:s,width:n,height:o};return V6(this,a)}},{ExtendedPath2D:$6,BBox:U6}=L,Th=class extends Yr{constructor(){super(...arguments),this.wickPath=new $6,this.wickStroke=void 0,this.wickStrokeWidth=void 0,this.wickStrokeOpacity=void 0,this.wickStrokeAlignment=0}setWickProperties(e,t,i,s,n){this.__wickStroke=e,this.__wickStrokeWidth=t,this.__wickStrokeOpacity=i,this.wickLineDash=s,this.__wickLineDashOffset=n,this.dirtyPath=!0,this.markDirty()}computeDefaultGradientFillBBox(){const{__width:e,__centerX:t,__yOpen:i,__yClose:s}=this,n=Math.min(i,s),a=Math.max(i,s)-n,r=t-e/2,l=t+e/2;return new U6(r,n,l-r,a)}updatePath(){const{path:e,stroke:t,strokeWidth:i,strokeOpacity:s,lineDash:n,lineDashOffset:o,__wickStroke:a,__wickStrokeWidth:r,__wickStrokeOpacity:l,wickLineDash:c,__wickLineDashOffset:h}=this,{centerX:d,x0:u,x1:p,y0:f,y1:y,yOpen:b,yClose:x}=this.alignedCoordinates(),v=this.layerManager?.canvas.pixelRatio??1,S=this.__wickStrokeAlignment>0?v/this.__wickStrokeAlignment/2%1:0;this.path.clear(),this.wickPath.clear();const D=a!=null&&a!==t||r!=null&&r!==i||l!=null&&l!==s||c!=null&&c!==n||h!=null&&h!==o?this.wickPath:e;if(Math.abs(p-u)<=3){D.moveTo(d-S,f),D.lineTo(d-S,y);return}const k=Math.min(b,x),I=Math.max(b,x),A=i/2;D.moveTo(d-S,f),D.lineTo(d-S,k+A),D.moveTo(d-S,y),D.lineTo(d-S,I-A);const C=I-k-2*A;if(C>0)e.rect(u+A,k+A,p-u-2*A,C);else{const w=(k+I)/2;e.moveTo(u,w),e.lineTo(p,w)}}drawPath(e){super.drawPath(e);const{wickPath:t}=this;if(t.isEmpty())return;const{stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:o,lineDashOffset:a,__wickStroke:r=i,__wickStrokeWidth:l=s,__wickStrokeOpacity:c=n,wickLineDash:h=o,__wickLineDashOffset:d=a}=this;l!==0&&(e.globalAlpha*=c,typeof r=="string"&&(e.strokeStyle=r),e.lineWidth=l,h!=null&&e.setLineDash([...h]),e.lineDashOffset=d,e.stroke(t.getPath2D()))}};g([_e()],Th.prototype,"wickStroke",2),g([_e()],Th.prototype,"wickStrokeWidth",2),g([_e()],Th.prototype,"wickStrokeOpacity",2),g([Yd()],Th.prototype,"wickLineDash",2),g([_e()],Th.prototype,"wickLineDashOffset",2),g([_e()],Th.prototype,"wickStrokeAlignment",2);var{AbstractBarSeriesProperties:K6,makeSeriesTooltip:Y6}=L,Nh=class extends K{constructor(){super(...arguments),this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};g([m],Nh.prototype,"stroke",2),g([m],Nh.prototype,"strokeWidth",2),g([m],Nh.prototype,"strokeOpacity",2),g([m],Nh.prototype,"lineDash",2),g([m],Nh.prototype,"lineDashOffset",2);var fA=class extends K{constructor(){super(...arguments),this.up=new Nh,this.down=new Nh}};g([m],fA.prototype,"up",2),g([m],fA.prototype,"down",2);var jn=class extends K6{};g([m],jn.prototype,"xKey",2),g([m],jn.prototype,"openKey",2),g([m],jn.prototype,"closeKey",2),g([m],jn.prototype,"highKey",2),g([m],jn.prototype,"lowKey",2),g([m],jn.prototype,"xName",2),g([m],jn.prototype,"yName",2),g([m],jn.prototype,"openName",2),g([m],jn.prototype,"closeName",2),g([m],jn.prototype,"highName",2),g([m],jn.prototype,"lowName",2);var ov=class extends jn{constructor(){super(...arguments),this.tooltip=Y6(),this.item=new fA}getStyle(e){const{strokeWidth:t,strokeOpacity:i,stroke:s,lineDash:n,lineDashOffset:o}=this.item[e];return{stroke:s,strokeWidth:t,strokeOpacity:i,lineDash:n,lineDashOffset:o,opacity:1}}};g([m],ov.prototype,"tooltip",2),g([m],ov.prototype,"item",2),g([m],ov.prototype,"itemStyler",2);var{makeSeriesTooltip:Z6}=L,up=class extends K{};g([m],up.prototype,"stroke",2),g([m],up.prototype,"strokeWidth",2),g([m],up.prototype,"strokeOpacity",2),g([m],up.prototype,"lineDash",2),g([m],up.prototype,"lineDashOffset",2);var ta=class extends K{constructor(){super(...arguments),this.fill="#c16068",this.fillOpacity=1,this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.wick=new up}};g([m],ta.prototype,"fill",2),g([m],ta.prototype,"fillOpacity",2),g([m],ta.prototype,"stroke",2),g([m],ta.prototype,"strokeWidth",2),g([m],ta.prototype,"strokeOpacity",2),g([m],ta.prototype,"lineDash",2),g([m],ta.prototype,"lineDashOffset",2),g([m],ta.prototype,"cornerRadius",2),g([m],ta.prototype,"wick",2);var mA=class extends K{constructor(){super(...arguments),this.up=new ta,this.down=new ta}};g([m],mA.prototype,"up",2),g([m],mA.prototype,"down",2);var av=class extends jn{constructor(){super(...arguments),this.item=new mA,this.tooltip=Z6()}getStyle(e){const{fill:t,fillOpacity:i,strokeWidth:s,strokeOpacity:n,stroke:o,lineDash:a,lineDashOffset:r,cornerRadius:l,wick:c}=this.item[e];return{fill:t,fillOpacity:i,stroke:o,strokeWidth:s,strokeOpacity:n,lineDash:a,lineDashOffset:r,cornerRadius:l,opacity:1,wick:c}}};g([m],av.prototype,"item",2),g([m],av.prototype,"tooltip",2),g([m],av.prototype,"itemStyler",2);var yA=class extends fR{constructor(){super(...arguments),this.properties=new av}nodeFactory(){const e=new Th;return e.lineCap="butt",e}updateDatumStyles({datumSelection:e,isHighlight:t}){e.each((i,s)=>{s.style=this.getItemStyle(s.datumIndex,t,void 0,s.itemType)})}updateDatumNodes({datumSelection:e,isHighlight:t}){const{contextNodeData:i,properties:s}=this;if(!i)return;const n=this.ctx.highlightManager.getActiveHighlight(),{up:o,down:a}=s.item,r=this.getShapeFillBBox(),l=this;e.each(function(h,d){const{centerX:u,width:p,y:f,height:y,yOpen:b,yClose:x,crisp:v}=d,S=d.isRising?o:a,M=l.getHighlightState(n,t,d.datumIndex),D=d.style??i.styles[d.itemType][M];h.setStaticProperties(u,p,f,y,b,x,v),h.setStyleProperties(D,r);const k=D?.wick;h.setWickProperties(k?.stroke,k?.strokeWidth,k?.strokeOpacity,k?.lineDash,k?.lineDashOffset),h.wickStrokeAlignment=S.wick.strokeWidth??S.strokeWidth})}legendItemSymbol(){const{up:e,down:t}=this.properties.item,i=Ut(e.fill)?e.fill.colorStops.map(a=>typeof a=="string"?a:{color:a.color,stop:a.stop==null?void 0:a.stop*.5}):[{color:Tn(e.fill)||zo(e.fill)?e.stroke:e.fill,stop:0},{color:Tn(e.fill)||zo(e.fill)?e.stroke:e.fill,stop:.5}],s=Ut(t.fill)?t.fill.colorStops.map(a=>typeof a=="string"?a:{color:a.color,stop:a.stop==null?void 0:a.stop*.5}):[{color:Tn(t.fill)||zo(t.fill)?t.stroke:t.fill,stop:.5}],n={type:"gradient",gradient:"linear",rotation:90,colorStops:[...i,...s],reverse:!1},o={type:"gradient",gradient:"linear",rotation:90,colorStops:[{color:e.stroke,stop:0},{color:e.stroke,stop:.5},{color:t.stroke,stop:.5}],reverse:!1};return{marker:{fill:n,fillOpacity:e.fillOpacity,stroke:o,strokeWidth:e.strokeWidth??1,strokeOpacity:e.strokeOpacity??1,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset}}}getLegendData(e){const{id:t,data:i,visible:s,ctx:{legendManager:n}}=this,{xKey:o,yName:a,showInLegend:r,legendItemName:l}=this.properties;return!i?.data.length||!o||e!=="category"?[]:[{legendType:"category",id:t,itemId:t,seriesId:t,enabled:s&&n.getItemEnabled({seriesId:t,itemId:t}),label:{text:l??a??t},symbol:this.legendItemSymbol(),legendItemName:l,hideInLegend:!r}]}hasItemStylers(){return this.properties.itemStyler!=null}};yA.className="CandleStickSeries",yA.type="candlestick";var{candlestickSeriesThemeableOptionsDef:X6}=L,xA={...et,...X6,type:$(Le("candlestick")),xKey:$(N),openKey:$(N),highKey:$(N),lowKey:$(N),closeKey:$(N),xName:N,yName:N,openName:N,highName:N,lowName:N,closeName:N,xKeyAxis:N,yKeyAxis:N};xA.pickOutsideVisibleMinorAxis=ee(R),xA.focusPriority=ee(W);var{multiSeriesHighlightStyle:q6,FILL_GRADIENT_LINEAR_KEYED_DEFAULTS:Q6,FILL_IMAGE_DEFAULTS:J6,FILL_PATTERN_KEYED_DEFAULTS:e9}=L;function mR(e){return{fill:{$applySwitch:[{$path:"type"},{$if:[{$eq:[{$palette:"type"},"user-indexed"]},e==="up"?"transparent":{$palette:"fill"},{$palette:`${e}.fill`}]},["gradient",Q6(e)],["image",J6],["pattern",e9(e)]]},stroke:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$palette:"stroke"},{$palette:`${e}.stroke`}]}}}var t9={series:{item:{up:mR("up"),down:mR("down")},tooltip:{range:{$path:["/tooltip/range","nearest"]}},highlight:q6()},animation:{enabled:!1},axes:{number:{crosshair:{snap:!1}},"ordinal-time":{groupPaddingInner:0,crosshair:{enabled:!0}}}},{predictCartesianFinancialAxis:i9}=L,rv={type:"series",name:"candlestick",chartType:"cartesian",enterprise:!0,groupable:!1,version:ue,dependencies:[oi],options:xA,predictAxis:i9,defaultAxes:{y:{type:"number",position:"left"},x:{type:"ordinal-time",position:"bottom"}},axisKeys:{x:"xKeyAxis",y:"yKeyAxis"},themeTemplate:t9,create:e=>new yA(e)},{CartesianSeriesProperties:s9,makeSeriesTooltip:n9}=L,Zi=class extends s9{constructor(){super(...arguments),this.colorRange=["black","black"],this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.textAlign="center",this.verticalAlign="middle",this.itemPadding=0,this.label=new Ku,this.tooltip=n9()}};g([m],Zi.prototype,"title",2),g([m],Zi.prototype,"xKey",2),g([m],Zi.prototype,"yKey",2),g([m],Zi.prototype,"colorKey",2),g([m],Zi.prototype,"xName",2),g([m],Zi.prototype,"yName",2),g([m],Zi.prototype,"colorName",2),g([m],Zi.prototype,"colorRange",2),g([m],Zi.prototype,"stroke",2),g([m],Zi.prototype,"strokeOpacity",2),g([m],Zi.prototype,"strokeWidth",2),g([m],Zi.prototype,"textAlign",2),g([m],Zi.prototype,"verticalAlign",2),g([m],Zi.prototype,"itemPadding",2),g([m],Zi.prototype,"itemStyler",2),g([m],Zi.prototype,"label",2),g([m],Zi.prototype,"tooltip",2);var{SeriesNodePickMode:yR,computeBarFocusBounds:o9,getMissCount:a9,valueProperty:bA,DEFAULT_CARTESIAN_DIRECTION_KEYS:r9,DEFAULT_CARTESIAN_DIRECTION_NAMES:l9,createDatumId:c9,ColorScale:h9,Rect:d9,PointerEvents:u9,addHitTestersToQuadtree:p9,findQuadtreeMatch:xR,updateLabelNode:g9}=L,f9=class extends L.CartesianSeriesNodeEvent{constructor(e,t,i,s){super(e,t,i,s),this.colorKey=s.properties.colorKey}},m9={left:-.5,center:0,right:-.5},y9={top:-.5,middle:0,bottom:-.5},vA=class extends L.CartesianSeries{constructor(e){super({moduleCtx:e,propertyKeys:{...r9,color:["colorKey"]},propertyNames:{...l9,color:["colorName"]},categoryKey:void 0,pickModes:[yR.NEAREST_NODE,yR.EXACT_SHAPE_MATCH],pathsPerSeries:[]}),this.properties=new Zi,this.NodeEvent=f9,this.colorScale=new h9}async processData(e){const t=this.axes.x,i=this.axes.y;if(!t||!i)return;const{xKey:s,yKey:n,colorRange:o,colorKey:a}=this.properties,r=this.axes.x?.scale,l=this.axes.y?.scale,{xScaleType:c,yScaleType:h}=this.getScaleInformation({xScale:r,yScale:l}),d=this.colorScale.type,{dataModel:u,processedData:p}=await this.requestDataModel(e,this.data,{props:[bA(s,c,{id:"xValue"}),bA(n,h,{id:"yValue"}),...a?[bA(a,d,{id:"colorValue",invalidValue:void 0})]:[]]});if(this.isColorScaleValid()){const f=u.resolveProcessedDataIndexById(this,"colorValue"),y=p.domain.values[f].filter(x=>x!=null),b=Ro(y);if(this.colorScale.domain=b??[],b?.length&&b[0]===b[1]){const x=Math.floor(o.length/2);this.colorScale.range=[o[x],o[x]]}else this.colorScale.range=o;this.colorScale.update()}}isColorScaleValid(){const{colorKey:e}=this.properties;if(!e)return!1;const{dataModel:t,processedData:i}=this;if(!t||!i)return!1;const s=t.resolveProcessedDataIndexById(this,"colorValue"),n=i.input.count,o=a9(this,i.defs.values[s].missing),a=t.resolveProcessedDataIndexById(this,"colorValue"),r=i.domain.values[a].filter(c=>c!=null).length;return!(n===0||n===o||r===0)}xCoordinateRange(e,t){const i=this.axes.x.scale,s=t*(i.bandwidth??0)/2,n=i.convert(e)+s,o=t*(i.bandwidth??10);return[n,n+o]}yCoordinateRange(e,t){const i=this.axes.y.scale,s=t*(i.bandwidth??0)/2,n=i.convert(e[0])+s,o=t*(i.bandwidth??10);return[n,n+o]}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;return!t||!i?{domain:[]}:e==="x"?{domain:t.getDomain(this,"xValue","value",i).domain}:{domain:t.getDomain(this,"yValue","value",i).domain}}getSeriesRange(){return[Number.NaN,Number.NaN]}createNodeData(){const{data:e,visible:t,axes:i,dataModel:s,processedData:n}=this,o=i.x,a=i.y;if(!(e&&t&&o&&a))return;if(!s||!n)return{itemId:this.properties.yKey??this.id,nodeData:[],labelData:[],scales:this.calculateScaling(),visible:this.visible};if(o.type!=="category"||a.type!=="category"){j.warnOnce(`Heatmap series expected axes to have "category" type, but received "${o.type}" and "${a.type}" instead.`);return}const{xKey:r,xName:l,yKey:c,yName:h,colorKey:d,colorName:u,textAlign:p,verticalAlign:f,itemPadding:y,label:b}=this.properties,x=s.resolveColumnById(this,"xValue",n),v=s.resolveColumnById(this,"yValue",n),S=d?s.resolveColumnById(this,"colorValue",n):void 0,M=d?s.getDomain(this,"colorValue","value",n).domain:[],D=o.scale,k=a.scale,I=(D.bandwidth??0)/2,A=(k.bandwidth??0)/2,C=[],w=[],T=D.bandwidth??10,O=k.bandwidth??10,E=(T-2*y)*m9[p],z=(O-2*y)*y9[f],F=()=>({width:T,height:O,meta:null}),_=n.dataSources.get(this.id)?.data??[];for(const[G,B]of _.entries()){const V=x[G],Y=v[G],X=D.convert(V)+I,q=k.convert(Y)+A,te=S?.[G],pe=b.enabled&&te!=null?this.getLabelText(te,B,d,"color",M,b,{value:te,datum:B,colorKey:d,colorName:u,xKey:r,yKey:c,xName:l,yName:h}):void 0,Se=hk(Pe(pe),this.properties.label,void 0,this.properties.label,{padding:y},F),ve={x:X,y:q,size:0},ae=this.getItemStyle({datumIndex:G,datum:B,colorValue:te},!1);if(C.push({series:this,itemId:c,datumIndex:G,yKey:c,xKey:r,xValue:V,yValue:Y,colorValue:te,datum:B,point:ve,width:T,height:O,midPoint:{x:X,y:q},missing:S!=null&&te==null,style:ae}),Se?.label!=null){const{text:Ie,fontSize:ze,lineHeight:Xe,height:Te}=Se.label,{fontStyle:de,fontFamily:De,fontWeight:ye,color:Ee}=this.properties.label,Ne=ve.x+E*(T-2*y),xt=ve.y+z*(O-2*y)-(Se.height-Te)*.5;w.push({series:this,itemId:c,datum:B,datumIndex:G,text:Ie,fontSize:ze,lineHeight:Xe,fontStyle:de,fontFamily:De,fontWeight:ye,color:Ee,textAlign:p,textBaseline:f,x:Ne,y:xt,style:ae})}}return{itemId:this.properties.yKey??this.id,nodeData:C,labelData:w,scales:this.calculateScaling(),visible:this.visible}}nodeFactory(){return new d9}update(e){return this.ctx.animationManager.skipCurrentBatch(),super.update(e)}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e,s=t??[];return i.update(s)}getItemStyle({datumIndex:e,datum:t,colorValue:i},s,n){const{properties:o}=this,{itemStyler:a,stroke:r,strokeWidth:l,strokeOpacity:c}=o,h=this.getHighlightStyle(s,e,n),d=oe(h,{fill:this.isColorScaleValid()&&i!=null?this.colorScale.convert(i):"transparent",fillOpacity:1,stroke:r,strokeWidth:l,strokeOpacity:c,opacity:1});let u;return a!=null&&e!=null&&(u=this.cachedDatumCallback(c9(e,s?"highlight":"node"),()=>{const p=this.makeItemStylerParams(t,e,s,d);return this.callWithContext(a,p)})),u?oe(u,d):d}makeItemStylerParams(e,t,i,s){const{id:n,properties:o}=this,{xKey:a,yKey:r}=o,l=this.ctx.highlightManager?.getActiveHighlight(),c=this.getHighlightStateString(l,i,t),h=this.filterItemStylerFillParams(s.fill)??s.fill;return{seriesId:n,datum:e,xKey:a,yKey:r,highlightState:c,...s,fill:h}}updateDatumStyles({datumSelection:e,isHighlight:t}){const i=this.ctx.highlightManager?.getActiveHighlight();e.each((s,n)=>{const o=this.getHighlightState(i,t,n.datumIndex);n.style=this.getItemStyle(n,t,o)})}updateDatumNodes({datumSelection:e}){const t=this.axes.x,[i,s]=t?.visibleRange??[],o=!(i!==0||s!==1);e.each((a,r)=>{const{point:l,width:c,height:h,style:d}=r;a.setStyleProperties(d),a.crisp=o,a.x=Math.floor(l.x-c/2),a.y=Math.floor(l.y-h/2),a.width=Math.ceil(c),a.height=Math.ceil(h)})}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e,{enabled:s}=this.properties.label,n=s?t:[];return i.update(n)}updateLabelNodes(e){const{isHighlight:t=!1}=e,i=this.ctx.highlightManager?.getActiveHighlight();e.labelSelection.each((s,n)=>{s.pointerEvents=u9.None,s.text=n.text,s.fillOpacity=this.getHighlightStyle(t,n.datumIndex)?.opacity??1,g9(this,s,this.properties,this.properties.label,n,t,i)})}getTooltipContent(e){const{id:t,dataModel:i,processedData:s,axes:n,properties:o,colorScale:a,ctx:r}=this,{formatManager:l}=r,{xKey:c,xName:h,yKey:d,yName:u,colorKey:p,colorName:f,colorRange:y,title:b,legendItemName:x,tooltip:v}=o,S=n.x,M=n.y;if(!i||!s||!S||!M)return;const D=s.dataSources.get(this.id)?.data[e],k=i.resolveColumnById(this,"xValue",s)[e],I=i.resolveColumnById(this,"yValue",s)[e],A=p!=null&&this.isColorScaleValid()?i.resolveColumnById(this,"colorValue",s)[e]:void 0;if(k==null)return;const C=[];let w;if(A==null)w=y[0];else{w=a.convert(A);const E=i.getDomain(this,"colorValue","value",s).domain,z=l.format(this.callWithContext.bind(this),{type:"number",value:A,datum:D,seriesId:t,legendItemName:x,key:p,source:"tooltip",property:"color",domain:E,boundSeries:this.getFormatterContext("color"),fractionDigits:void 0});C.push({label:f,fallbackLabel:p,value:z??ao(A)})}C.push({label:h,fallbackLabel:c,value:this.getAxisValueText(S,"tooltip",k,D,c,x)},{label:u,fallbackLabel:d,value:this.getAxisValueText(M,"tooltip",I,D,d,x)});const T=this.getItemStyle({datumIndex:e,datum:D,colorValue:A},!1);T.fill!=null&&(w=T.fill);const O=w==null?void 0:{marker:{shape:"square",fill:w,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0}};return this.formatTooltipWithContext(v,{title:b??x,symbol:O,data:C},{seriesId:t,datum:D,title:b,xKey:c,xName:h,yKey:d,yName:u,colorKey:p,colorName:f,...T})}getLegendData(e){return e!=="gradient"||!this.isColorScaleValid()||!this.dataModel?[]:[{legendType:"gradient",enabled:this.visible,seriesId:this.id,series:this.getFormatterContext("color"),colorDomain:this.colorScale.domain,colorRange:this.colorScale.range}]}isLabelEnabled(){return this.properties.label.enabled&&!!this.properties.colorKey}getBandScalePadding(){return{inner:0,outer:0}}computeFocusBounds({datumIndex:e}){const t=this.contextNodeData?.nodeData[e];if(t===void 0)return;const{width:i,height:s,midPoint:n}=t,o={x:n.x-i/2,y:n.y-s/2,width:i,height:s};return o9(this,o)}initQuadTree(e){p9(e,this.datumNodesIter())}pickNodesExactShape(e){const t=xR(this,e);return t!=null&&t.distance<=0?[t.datum]:[]}pickNodeClosestDatum(e){return xR(this,e)}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.label.itemStyler!=null||this.isColorScaleValid()}};vA.className="HeatmapSeries",vA.type="heatmap";var{heatmapSeriesThemeableOptionsDef:x9}=L,b9={...Q(x9,["showInLegend"]),...Q(et,["showInLegend"]),type:$(Le("heatmap")),xKey:$(N),yKey:$(N),xKeyAxis:N,yKeyAxis:N,colorKey:N,xName:N,yName:N,colorName:N,colorRange:be(ie)},bR={series:{stroke:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$ref:"chartBackgroundColor"},{$path:["/0",{$palette:"stroke"},{$palette:"strokes"}]}]},strokeWidth:{$isUserOption:["./stroke",2,void 0]},label:{...L.LABEL_BOXING_DEFAULTS,enabled:!1,color:{$ref:"textColor"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},wrapping:"on-space",overflowStrategy:"ellipsis"},itemPadding:3,highlight:{unhighlightedItem:{opacity:.6}}},gradientLegend:{enabled:!0}};bR.series.colorRange={$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"divergingColors"},L.SAFE_RANGE2_OPERATION]};var SA={type:"series",name:"heatmap",chartType:"cartesian",enterprise:!0,version:ue,dependencies:[oi],options:b9,defaultAxes:{y:{type:"category",position:"left"},x:{type:"category",position:"bottom"}},axisKeys:{x:"xKeyAxis",y:"yKeyAxis"},themeTemplate:bR,create:e=>new vA(e)},MA=class extends fR{constructor(){super(...arguments),this.properties=new ov}nodeFactory(){const e=new hR;return e.lineCap="square",e}updateDatumStyles({datumSelection:e,isHighlight:t}){e.each((i,s)=>{s.style=this.getItemStyle(s.datumIndex,t,void 0,s.itemType)})}updateDatumNodes({datumSelection:e,isHighlight:t}){const{contextNodeData:i,properties:s}=this;if(!i)return;const n=this.ctx.highlightManager.getActiveHighlight(),{up:o,down:a}=s.item,r=this;e.each(function(c,h){const{centerX:d,width:u,y:p,height:f,yOpen:y,yClose:b,crisp:x}=h,v=h.isRising?o:a;c.setStaticProperties(d,u,p,f,y,b,x);const S=h.style??i.styles[h.itemType][r.getHighlightState(n,t,h.datumIndex)];c.setStyleProperties(S),c.strokeAlignment=v.strokeWidth})}getLegendData(e){const{id:t,data:i,ctx:{legendManager:s},visible:n}=this,{xKey:o,yName:a,item:{up:r,down:l},showInLegend:c,legendItemName:h}=this.properties;if(!i?.data.length||!o||e!=="category")return[];const d={type:"gradient",gradient:"linear",colorSpace:"rgb",colorStops:[{color:r.stroke,stop:0},{color:r.stroke,stop:.5},{color:l.stroke,stop:.5}],rotation:90};return[{legendType:"category",id:t,itemId:t,seriesId:t,enabled:n&&s.getItemEnabled({seriesId:t,itemId:t}),label:{text:h??a??t},symbol:{marker:{fill:d,fillOpacity:r.strokeOpacity,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0}},legendItemName:h,hideInLegend:!c}]}hasItemStylers(){return this.properties.itemStyler!=null}};MA.className="ohlc",MA.type="ohlc";var{ohlcSeriesThemeableOptionsDef:v9}=L,DA={...et,...v9,type:$(Le("ohlc")),xKey:$(N),openKey:$(N),highKey:$(N),lowKey:$(N),closeKey:$(N),xKeyAxis:N,yKeyAxis:N,xName:N,yName:N,openName:N,highName:N,lowName:N,closeName:N};DA.pickOutsideVisibleMinorAxis=ee(R),DA.focusPriority=ee(W);var{multiSeriesHighlightStyle:S9,predictCartesianFinancialAxis:M9}=L,D9={animation:{enabled:!1},series:{item:{up:{stroke:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$palette:"stroke"},{$palette:"up.stroke"}]}},down:{stroke:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$palette:"stroke"},{$palette:"down.stroke"}]}}},tooltip:{range:{$path:["/tooltip/range","nearest"]}},highlight:S9()},axes:{number:{crosshair:{snap:!1}},"ordinal-time":{groupPaddingInner:0,crosshair:{enabled:!0}}}},lv={type:"series",name:"ohlc",chartType:"cartesian",enterprise:!0,version:ue,dependencies:[oi],options:DA,predictAxis:M9,defaultAxes:{y:{type:"number",position:"left"},x:{type:"ordinal-time",position:"bottom"}},axisKeys:{x:"xKeyAxis",y:"yKeyAxis"},themeTemplate:D9,create:e=>new MA(e)};function I9(e,t,i,s,n,o,a,r){const[l,c]=si(e,n);return rr([l,c],t,i,s,{smallestKeyInterval:o,xNeedsValueOf:a,yNeedsValueOf:r})}var k9=pr(I9);function A9(e,t,i,s,n){const o=t.resolveKeysById(s,"xValue",i),a=t.resolveColumnById(s,"yHighValue",i),r=t.resolveColumnById(s,"yLowValue",i),l=t.getDomain(s,"xValue","key",i),c=t.resolveColumnNeedsValueOf(s,"xValue",i),h=t.resolveColumnNeedsValueOf(s,"yHighValue",i)??t.resolveColumnNeedsValueOf(s,"yLowValue",i);if(n){const[d,u]=si(e,l);return rr([d,u],o,a,r,{smallestKeyInterval:i.reduced?.smallestKeyInterval,xNeedsValueOf:c,yNeedsValueOf:h,existingFilters:n})}return k9(e,o,a,r,l,i.reduced?.smallestKeyInterval,c,h)}function C9(e,t,i,s,n,o){const a=t.resolveKeysById(s,"xValue",i),r=t.resolveColumnById(s,"yHighValue",i),l=t.resolveColumnById(s,"yLowValue",i),c=t.getDomain(s,"xValue","key",i),h=t.resolveColumnNeedsValueOf(s,"xValue",i),d=t.resolveColumnNeedsValueOf(s,"yHighValue",i)??t.resolveColumnNeedsValueOf(s,"yLowValue",i),[u,p]=si(e,c);return tg([u,p],a,r,l,{smallestKeyInterval:i.reduced?.smallestKeyInterval,targetRange:n,xNeedsValueOf:h,yNeedsValueOf:d,existingFilters:o})}function vR({span:e},t){switch(e.type){case"linear":case"step":case"multi-line":{const i=(t-e.x0)/(e.x1-e.x0);return e.y0+i*(e.y1-e.y0)}case"cubic":{const{cp0x:i,cp0y:s,cp1x:n,cp1y:o,cp2x:a,cp2y:r,cp3x:l,cp3y:c}=e;let h=.5;const d=1e-6;for(let p=0;p<10;p++){const f=1-h,b=f*f*f*i+3*f*f*h*n+3*f*h*h*a+h*h*h*l-t;if(Math.abs(b)<d)break;const x=3*f*f*(n-i)+6*f*h*(a-n)+3*h*h*(l-a);if(Math.abs(x)<1e-12)break;h=h-b/x,h=Math.max(0,Math.min(1,h))}const u=1-h;return u*u*u*s+3*u*u*h*o+3*u*h*h*r+h*h*h*c}}}function SR(e,t,i=0){for(let s=i;s<e.length;s++){const n=e[s],[o,a]=Zs(n.span);if(t>=o.x&&t<=a.x)return{span:n,index:s};if(t<o.x)break}return{span:null,index:i}}function L9(e,t,i,s,n){const o=SR(e,i,n),a=SR(t,i,n);if(!o.span||!a.span)return{intersection:null,spanIndex:o.index,isInverted:s};const r=vR(o.span,i),l=vR(a.span,i),c=r>l;return{intersection:s===c?null:{x:i,y:r},spanIndex:o.index,isInverted:c}}function w9(e,t,i,s,n=!1){if(e.length===0||t.length===0)return[];const o=[];let a=n,r=0;for(let l=i;l<=s;l+=.5){const c=L9(e,t,l,a,r);c.intersection&&o.push(c.intersection.x),r=c.spanIndex,a=c.isInverted}return o}function T9(e,t,i,s,n={}){const o=Math.max(t.x,i.width-(t.x+t.width)),a=Math.max(t.y,i.height-(t.y+t.height)),r=[],l=(h,d)=>({x0:h,y0:-a,x1:d,y1:t.height+a});s&&r.push({clipRect:l(-o,e[0]??t.width+o),...n});const c=s?1:0;for(let h=c;h<e.length;h+=2)r.push({clipRect:l(e[h],e[h+1]??t.width+o),...n});return r}var{CartesianSeriesProperties:N9,SeriesMarker:O9,makeSeriesTooltip:E9,DropShadow:P9,Label:R9}=L,IA=class extends R9{constructor(){super(...arguments),this.placement="outside",this.spacing=0}};g([m],IA.prototype,"placement",2),g([m],IA.prototype,"spacing",2);var cv=class{constructor(){this.enabled=!1,this.fillOpacity=1}};g([m],cv.prototype,"enabled",2),g([m],cv.prototype,"fill",2),g([m],cv.prototype,"fillOpacity",2);var uc=class extends K{constructor(){super(...arguments),this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.marker=new O9}};g([m],uc.prototype,"stroke",2),g([m],uc.prototype,"strokeWidth",2),g([m],uc.prototype,"strokeOpacity",2),g([m],uc.prototype,"lineDash",2),g([m],uc.prototype,"lineDashOffset",2),g([m],uc.prototype,"marker",2);var kA=class extends K{constructor(){super(...arguments),this.low=new uc,this.high=new uc}};g([m],kA.prototype,"low",2),g([m],kA.prototype,"high",2);var So=class extends K{};g([m],So.prototype,"enabled",2),g([m],So.prototype,"shape",2),g([m],So.prototype,"size",2),g([m],So.prototype,"fill",2),g([m],So.prototype,"fillOpacity",2),g([m],So.prototype,"stroke",2),g([m],So.prototype,"strokeWidth",2),g([m],So.prototype,"strokeOpacity",2),g([m],So.prototype,"lineDash",2),g([m],So.prototype,"lineDashOffset",2),g([m],So.prototype,"itemStyler",2);var Gt=class extends N9{constructor(){super(...arguments),this.fill="#99CCFF",this.fillOpacity=1,this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.interpolation=new dl,this.item=new kA,this.invertedStyle=new cv,this.shadow=new P9().set({enabled:!1}),this.marker=new So,this.label=new IA,this.tooltip=E9(),this.connectMissingData=!1}};g([m],Gt.prototype,"xKey",2),g([m],Gt.prototype,"yLowKey",2),g([m],Gt.prototype,"yHighKey",2),g([m],Gt.prototype,"xName",2),g([m],Gt.prototype,"yName",2),g([m],Gt.prototype,"yLowName",2),g([m],Gt.prototype,"yHighName",2),g([m],Gt.prototype,"fill",2),g([m],Gt.prototype,"fillOpacity",2),g([m],Gt.prototype,"stroke",2),g([m],Gt.prototype,"strokeWidth",2),g([m],Gt.prototype,"strokeOpacity",2),g([m],Gt.prototype,"lineDash",2),g([m],Gt.prototype,"lineDashOffset",2),g([m],Gt.prototype,"interpolation",2),g([m],Gt.prototype,"styler",2),g([m],Gt.prototype,"item",2),g([m],Gt.prototype,"invertedStyle",2),g([m],Gt.prototype,"shadow",2),g([m],Gt.prototype,"marker",2),g([m],Gt.prototype,"label",2),g([m],Gt.prototype,"tooltip",2),g([m],Gt.prototype,"connectMissingData",2);var{CollapseMode:hv,pairUpSpans:dv,prepareAreaFillAnimationFns:F9,plotInterpolatedLinePathStroke:pp,prepareLinePathPropertyAnimation:z9}=L;function B9(e,t,i,s){const n=(l,c)=>{pp(l,c,t.removed),pp(l,c,i.removed)},o=(l,c)=>{pp(l,c,t.moved),pp(l,c,i.moved)},a=(l,c)=>{pp(l,c,t.added),pp(l,c,i.added)},r=z9(e,s);return{status:e,path:{addPhaseFn:a,updatePhaseFn:o,removePhaseFn:n},pathProperties:r}}function _9(e,t,i){const s=e.scales.x?.type==="category",n=t.scales.x?.type==="category";if(s!==n||!Dl(e.scales.x)||!Dl(t.scales.x))return;let o="updated";t.visible&&!e.visible?o="removed":!t.visible&&e.visible&&(o="added");const a=dv({scales:e.scales,data:e.fillData.spans},{scales:t.scales,data:t.fillData.spans},hv.Split);if(a==null)return;const r=dv({scales:e.scales,data:e.fillData.phantomSpans},{scales:t.scales,data:t.fillData.phantomSpans},hv.Split);if(r==null)return;const l=dv({scales:e.scales,data:e.highStrokeData.spans},{scales:t.scales,data:t.highStrokeData.spans},hv.Split);if(l==null)return;const c=dv({scales:e.scales,data:e.lowStrokeData.spans},{scales:t.scales,data:t.lowStrokeData.spans},hv.Split);if(c==null)return;const h="fade",d=F9(o,a,r,h),u=B9(o,l,c,h),p=(i?.changed??!0)||!_o(e.scales.x,t.scales.x)||!_o(e.scales.y,t.scales.y)||o!=="updated";return{status:o,fill:d,stroke:u,hasMotion:p}}var V9=$s,G9=Ws,H9=In,{valueProperty:MR,keyProperty:j9,updateLabelNode:W9,fixNumericExtent:DR,buildResetPathFn:$9,resetLabelFn:U9,resetMarkerFn:K9,resetMarkerPositionFn:IR,pathSwipeInAnimation:Y9,resetMotion:Z9,markerSwipeScaleInAnimation:X9,seriesLabelFadeInAnimation:AA,animationValidation:q9,diff:Q9,updateClipPath:CA,computeMarkerFocusBounds:kR,plotAreaPathFill:J9,plotLinePathStroke:AR,interpolatePoints:CR,pathFadeInAnimation:LA,markerFadeInAnimation:LR,fromToMotion:wA,pathMotion:TA,PointerEvents:uv,Marker:eq,BBox:tq,processedDataIsAnimatable:NA,markerEnabled:iq,getMarkerStyles:sq,calculateSegments:nq,toHighlightString:oq,HighlightState:aq,AggregationManager:rq,resetMarkerSelectionsDirect:lq,createDatumId:cq,visibleRangeIndices:wR}=L,hq=class extends L.SeriesNodeEvent{constructor(e,t,i,s){super(e,t,i,s),this.xKey=s.properties.xKey,this.yLowKey=s.properties.yLowKey,this.yHighKey=s.properties.yHighKey}},dq=L.CartesianSeries,OA=class extends dq{constructor(e){super({moduleCtx:e,pathsPerSeries:["fill","lowStroke","highStroke"],pickModes:[L.SeriesNodePickMode.AXIS_ALIGNED],propertyKeys:{x:["xKey"],y:["yLowKey","yHighKey"]},propertyNames:{x:["xName"],y:["yLowName","yHighName","yName"]},categoryKey:"xValue",animationResetFns:{path:$9({getVisible:()=>this.visible,getOpacity:()=>this.getOpacity()}),label:U9,datum:(t,i)=>({...K9(t),...IR(t,i)})},clipFocusBox:!1}),this.properties=new Gt,this.NodeEvent=hq,this.aggregationManager=new rq}async processData(e){const{xKey:t,yLowKey:i,yHighKey:s}=this.properties,n=this.axes.x?.scale,o=this.axes.y?.scale,{xScaleType:a,yScaleType:r}=this.getScaleInformation({xScale:n,yScale:o}),l=[],c=!this.ctx.animationManager.isSkipped();this.needsDataModelDiff()&&this.processedData&&l.push(Q9(this.id,this.processedData)),c&&l.push(q9());const{dataModel:h,processedData:d}=await this.requestDataModel(e,this.data,{props:[j9(t,a,{id:"xValue"}),MR(i,r,{id:"yLowValue"}),MR(s,r,{id:"yHighValue"}),...l]});this.aggregateData(h,d),this.animationState.transition("updateData")}aggregateData(e,t){if(this.aggregationManager.markStale(),t.type!=="ungrouped"||NA(t))return;const i=this.axes.x;if(i==null)return;const s=this.estimateTargetRange();this.aggregationManager.aggregate({computePartial:o=>C9(i.scale.type,e,t,this,s,o),computeFull:o=>A9(i.scale.type,e,t,this,o),targetRange:s});const n=this.aggregationManager.filters;n&&n.length>0&&Jn.record(`${this.type}:aggregation`,n.map(o=>o.maxRange))}estimateTargetRange(){const e=this.axes.x;if(e?.scale?.range){const[t,i]=e.scale.range;return Math.abs(i-t)}return this.ctx.scene?.canvas?.width??800}createNodeDatumContext(e,t,i){const{dataModel:s,processedData:n}=this;if(!s||!n)return;const o=n.dataSources.get(this.id)?.data??[],[a,r]=e.range,l=Math.abs(r-a);this.aggregationManager.ensureLevelForRange(l);const c=this.aggregationManager.getFilterForRange(l),h=this.contextNodeData?.nodeData,d=h!=null&&(n.changeDescription!=null||!NA(n)||c!=null);return{rawData:o,xValues:s.resolveKeysById(this,"xValue",n),yHighValues:s.resolveColumnById(this,"yHighValue",n),yLowValues:s.resolveColumnById(this,"yLowValue",n),xScale:e,yScale:t,xAxisRange:i,xOffset:(e.bandwidth??0)/2,dataAggregationFilter:c,range:l,labelsEnabled:this.properties.label.enabled,canIncrementallyUpdate:d,xKey:this.properties.xKey,yLowKey:this.properties.yLowKey,yHighKey:this.properties.yHighKey,item:this.properties.item,yDomain:this.getSeriesDomain("y").domain,connectMissingData:this.properties.connectMissingData,interpolation:this.properties.interpolation,markerData:d?h:[],labelData:[],spanPoints:[],nodeIndex:0}}xCoordinateRange(e){const t=this.axes.x.scale.convert(e);return[t,t]}yCoordinateRange(e){const t=this.axes.y.scale.convert(e[0]);return[t,t]}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!(t&&i))return{domain:[]};const{domain:{keys:[s]}}=t;if(e==="x"){const n=i.resolveProcessedDataDefById(this,"xValue");if(n?.def.type==="key"&&n.def.valueType==="category"){const o=i.getKeySortMetadata(this,"xValue",t);return{domain:s,sortMetadata:o}}return{domain:DR(Ro(s))}}else{const n=this.domainForClippedRange("y",["yHighValue","yLowValue"],"xValue"),o=Tt(n);return{domain:DR(o)}}}getSeriesRange(e,t){return this.domainForVisibleRange("y",["yHighValue","yLowValue"],"xValue",t)}handleDatumPoint(e,t,i,s,n){if(t.xValue=e.xValues[i],t.xValue==null)return;t.datum=e.rawData[i],t.yHighValue=s??e.yHighValues[i],t.yLowValue=n??e.yLowValues[i];const o=e.spanPoints.at(-1);if(Number.isFinite(t.yHighValue)&&Number.isFinite(t.yLowValue)){t.inverted=t.yLowValue>t.yHighValue,t.x=e.xScale.convert(t.xValue)+e.xOffset,t.yHighCoordinate=e.yScale.convert(t.yHighValue),t.yLowCoordinate=e.yScale.convert(t.yLowValue),this.upsertMarkerDatum(e,t,i,"high",t.yHighValue,t.yHighCoordinate),this.upsertMarkerDatum(e,t,i,"low",t.yLowValue,t.yLowCoordinate);const a={high:{point:{x:t.x,y:t.yHighCoordinate},xDatum:t.xValue,yDatum:t.yHighValue},low:{point:{x:t.x,y:t.yLowCoordinate},xDatum:t.xValue,yDatum:t.yLowValue}};Array.isArray(o)?o.push(a):o==null?e.spanPoints.push([a]):(o.skip+=1,e.spanPoints.push([a]))}else e.connectMissingData||(Array.isArray(o)||o==null?e.spanPoints.push({skip:0}):o.skip+=1)}upsertMarkerDatum(e,t,i,s,n,o){const{size:a}=e.item[s].marker;if(e.canIncrementallyUpdate&&e.nodeIndex<e.markerData.length){const l=e.markerData[e.nodeIndex];l.index=i,l.itemType=s,l.datum=t.datum,l.datumIndex=i,l.midPoint={x:t.x,y:o},l.yHighValue=t.yHighValue,l.yLowValue=t.yLowValue,l.xValue=t.xValue,l.point={x:t.x,y:o,size:a}}else e.markerData.push({index:i,series:this,itemType:s,datum:t.datum,datumIndex:i,midPoint:{x:t.x,y:o},yHighValue:t.yHighValue,yLowValue:t.yLowValue,xValue:t.xValue,xKey:e.xKey,yLowKey:e.yLowKey,yHighKey:e.yHighKey,point:{x:t.x,y:o,size:a},enabled:!0});if(e.nodeIndex++,e.labelsEnabled){const l=this.createLabelData({datumIndex:i,point:{x:t.x,y:o},value:n,yLowValue:t.yLowValue,yHighValue:t.yHighValue,itemType:s,inverted:t.inverted,datum:t.datum,series:this});e.labelData.push(l)}}createNodeData(){const{data:e,processedData:t,axes:i}=this,s=i.x,n=i.y;if(!(e&&s&&n&&t&&this.chart?.seriesRect))return;const o=this.createNodeDatumContext(s.scale,n.scale,s.range);if(!o)return;const a={datum:void 0,xValue:void 0,yHighValue:0,yLowValue:0,x:0,yHighCoordinate:0,yLowCoordinate:0,inverted:!1},r=x=>o.xScale.convert(o.xValues[x])+o.xOffset;if(t.input.count<1e3||o.dataAggregationFilter==null){let[x,v]=wR(1,o.xValues.length,o.xAxisRange,S=>{const M=r(S);return[M,M]});t.input.count<1e3&&(x=0,v=t.input.count),x=Math.max(x-1,0),v=Math.min(v+1,o.xValues.length);for(let S=x;S<v;S+=1)this.handleDatumPoint(o,a,S)}else{const{maxRange:x,indexData:v,midpointIndices:S}=o.dataAggregationFilter,[M,D]=wR(1,x,o.xAxisRange,k=>{const I=S[k];if(I!==cl)return[r(I),r(I)]});for(let k=M;k<D;k+=1){if(S[k]===cl)continue;const A=k*H9,C=v[A+V9],w=v[A+G9];this.handleDatumPoint(o,a,C,o.yHighValues[C],o.yLowValues[w])}}o.canIncrementallyUpdate&&o.nodeIndex<o.markerData.length&&(o.markerData.length=o.nodeIndex);const l=o.spanPoints.flatMap(x=>{if(!Array.isArray(x))return[];const v=x.map(S=>S.high);return CR(v,o.interpolation)}),c=o.spanPoints.flatMap(x=>{if(!Array.isArray(x))return[];const v=x.map(S=>S.low);return CR(v,o.interpolation)}),h=nq(this.properties.segmentation,s,n,this.chart.seriesRect,this.ctx.scene,!1);let d;if(this.properties.invertedStyle.enabled){const x=o.yHighValues[0]<o.yLowValues[0],v=w9(l,c,o.xScale.range[0],o.xScale.range[1],x);d=T9(v,this.chart.seriesRect,this.ctx.scene,x,this.properties.invertedStyle)}const{fill:u,fillOpacity:p,item:f}=this.properties,y=x=>{const v=f[x],{stroke:S,strokeWidth:M,strokeOpacity:D}=v,k={fill:u,fillOpacity:p,stroke:S,strokeWidth:M,strokeOpacity:D};return sq(this,v,v.marker,k)};return{itemId:`${o.yLowKey}-${o.yHighKey}`,labelData:o.labelData,nodeData:o.markerData,fillData:{itemType:"high",spans:l,phantomSpans:c},highStrokeData:{itemType:"high",spans:l},lowStrokeData:{itemType:"low",spans:c},scales:this.calculateScaling(),visible:this.visible,styles:{low:y("low"),high:y("high")},segments:h,intersectionSegments:d}}createLabelData({datumIndex:e,point:t,value:i,itemType:s,inverted:n,datum:o,series:a}){const{xKey:r,yLowKey:l,yHighKey:c,xName:h,yName:d,yLowName:u,yHighName:p,legendItemName:f,label:y}=this.properties,{placement:b}=y,x=y.spacing+(typeof y.padding=="number"?y.padding:0);let v=s;n&&(v=s==="low"?"high":"low");const S=b==="outside"&&v==="high"||b==="inside"&&v==="low"?-1:1,M=this.getSeriesDomain("y").domain;return{x:t.x,y:t.y+x*S,series:a,itemType:s,datum:o,datumIndex:e,text:this.getLabelText(i,o,s==="high"?c:l,"y",M,y,{value:i,datum:o,itemType:s,xKey:r,yLowKey:l,yHighKey:c,xName:h,yLowName:u,yHighName:p,yName:d,legendItemName:f}),textAlign:"center",textBaseline:S===-1?"bottom":"top"}}isPathOrSelectionDirty(){const{low:e,high:t}=this.properties.item;return e.marker.isDirty()||t.marker.isDirty()}strokewidthChange(){const e=t=>{const i=this.properties.item[t].strokeWidth??0,s=this.properties.highlight.highlightedSeries.item?.[t]?.strokeWidth??i,n=this.properties.highlight.highlightedItem.item?.[t]?.strokeWidth??i;return i>n||s>n};return e("low")||e("high")}updatePathNodes(e){const{visible:t}=e,[i,s,n]=e.paths,o=this.contextNodeData?.segments,a=this.ctx.highlightManager?.getActiveHighlight(),r=this.getHighlightState(a,!1),l=this.getHighlightStyle(),{item:c,fill:h,fillOpacity:d,opacity:u}=oe(l,this.getStyle(r));s.setProperties({datum:o,segments:o,fill:void 0,lineCap:"round",lineJoin:"round",pointerEvents:uv.None,stroke:c.low.stroke,strokeWidth:c.low.strokeWidth,strokeOpacity:c.low.strokeOpacity,lineDash:c.low.lineDash,lineDashOffset:c.low.lineDashOffset,opacity:u,visible:t}),n.setProperties({segments:o,fill:void 0,lineCap:"round",lineJoin:"round",pointerEvents:uv.None,stroke:c.high.stroke,strokeWidth:c.high.strokeWidth,strokeOpacity:c.high.strokeOpacity,lineDash:c.high.lineDash,lineDashOffset:c.high.lineDashOffset,opacity:u,visible:t});const p=this.getShapeFillBBox();i.setFillProperties(h,p),i.setStyleProperties({stroke:void 0,fill:h,fillOpacity:d,opacity:u},p);const f=this.contextNodeData?.intersectionSegments??o;i.setProperties({segments:f,pointerEvents:uv.None,lineJoin:"round",fillShadow:this.properties.shadow,opacity:u,visible:t}),i.datum=f,CA(this,i),CA(this,s),CA(this,n)}updatePaths(e){this.updateAreaPaths(e.paths,e.contextData)}updateAreaPaths(e,t){for(const i of e)i.visible=t.visible;if(t.visible)this.updateFillPath(e,t),this.updateStrokePath(e,t);else for(const i of e)i.path.clear(),i.markDirty("RangeArea")}updateFillPath(e,t){const[i]=e;i.path.clear(),J9(i,t.fillData),i.markDirty("RangeArea")}updateStrokePath(e,t){const[,i,s]=e;i.path.clear(),s.path.clear(),AR(i,t.lowStrokeData.spans),AR(s,t.highStrokeData.spans),i.markDirty("RangeArea"),s.markDirty("RangeArea")}resetDatumAnimation(e){lq([e.datumSelection])}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e,{processedData:s,axes:n,properties:o}=this,a=o.styler?this.getStylerMarkerOptions().item:o.item,{low:r,high:l}=a,c=iq(s.input.count,n.x.scale,{enabled:r.marker.enabled||l.marker.enabled});(o.item.low.marker.isDirty()||o.item.high.marker.isDirty())&&(i.clear(),i.cleanup());let h;if(c)if(r.marker.enabled&&l.marker.enabled)h=t;else{h=[];for(const d of t)a[d.itemType].marker.enabled&&h.push(d)}else h=[];return NA(this.processedData)?i.update(h,void 0,d=>cq(d.xValue,d.itemType)):i.update(h)}updateDatumStyles({datumSelection:e,isHighlight:t}){const i=this.ctx.highlightManager.getActiveHighlight();e.each((s,n)=>{const o=this.getHighlightState(i,t,n.datumIndex),a=this.getStyle(o),{fill:r,fillOpacity:l,item:c}=a,{stroke:h,strokeWidth:d,strokeOpacity:u}=c[n.itemType],{marker:p}=this.properties.item[n.itemType],f=this.makeItemStylerParams(n.itemType);n.style=this.getMarkerStyle(p,n,f,{isHighlight:t,highlightState:o,resolveMarkerSubPath:["item",n.itemType,"marker"]},a.item[n.itemType].marker,{fill:r,fillOpacity:l,stroke:h,strokeWidth:d,strokeOpacity:u})})}updateDatumNodes(e){const{contextNodeData:t}=this;if(!t)return;const{datumSelection:i,isHighlight:s}=e,n=this.getShapeFillBBox(),o=this.ctx.highlightManager.getActiveHighlight();i.each((a,r)=>{const{itemType:l}=r,c=r.style??t.styles[l][this.getHighlightState(o,s,r.datumIndex)];this.applyMarkerStyle(c,a,r.point,n)}),s||(this.properties.item.low.marker.markClean(),this.properties.item.high.marker.markClean())}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e;return i.update(t,s=>{s.pointerEvents=uv.None})}updateLabelNodes(e){const t={xKey:this.properties.xKey,xName:this.properties.xName??this.properties.xKey,yName:this.properties.yName,yLowKey:this.properties.yLowKey,yLowName:this.properties.yLowName??this.properties.yLowKey,yHighKey:this.properties.yHighKey,yHighName:this.properties.yHighName??this.properties.yHighKey,legendItemName:this.properties.legendItemName},i=this.ctx.highlightManager?.getActiveHighlight(),{isHighlight:s=!1,labelSelection:n}=e;n.each((o,a)=>{o.fillOpacity=this.getHighlightStyle(s,a.datumIndex).opacity??1,W9(this,o,t,this.properties.label,a,s,i)})}getHighlightLabelData(e,t){return e?.length?e.filter(i=>i.datum===t.datum):[]}getHighlightData(e,t){const i=e.filter(s=>s.datum===t.datum).map(s=>({...s}));return i.length>0?i:void 0}getStyle(e){return this.getStylerCouple(e)[0]}getStylerMarkerOptions(){return this.getStylerCouple()[1]}getStylerCouple(e){const{fill:t,fillOpacity:i,item:s,styler:n}=this.properties;let o={};if(n){const c=this.makeStylerParams(e);o=this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],this.cachedCallWithContext(n,c)??{},{pick:!1})??{}}const a={item:{low:{marker:{enabled:!1}},high:{marker:{enabled:!1}}}},r=c=>{const h=o.item?.[c],{lineDash:d,lineDashOffset:u,marker:p,stroke:f,strokeOpacity:y,strokeWidth:b}=s[c];return a.item[c].marker.enabled=h?.marker?.enabled??p.enabled,{marker:{fill:h?.marker?.fill??p.fill??t,fillOpacity:h?.marker?.fillOpacity??p.fillOpacity,shape:h?.marker?.shape??p.shape,size:h?.marker?.size??p.size,lineDash:h?.marker?.lineDash??p.lineDash,lineDashOffset:h?.marker?.lineDashOffset??p.lineDashOffset,stroke:h?.marker?.stroke??p.stroke??f,strokeOpacity:h?.marker?.strokeOpacity??p.strokeOpacity,strokeWidth:h?.marker?.strokeWidth??p.strokeWidth},lineDash:h?.lineDash??d,lineDashOffset:h?.lineDashOffset??u,stroke:h?.stroke??f,strokeOpacity:h?.strokeOpacity??y,strokeWidth:h?.strokeWidth??b}};return[{fill:o.fill??t,fillOpacity:o.fillOpacity??i,opacity:1,topLevel:{lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,marker:this.properties.marker,stroke:this.properties.stroke,strokeOpacity:this.properties.strokeOpacity,strokeWidth:this.properties.strokeWidth},item:{low:r("low"),high:r("high")}},a]}makeStylerParams(e){const{id:t}=this,{fill:i,fillOpacity:s,item:n,xKey:o,yHighKey:a,yLowKey:r}=this.properties,l=oq(e??aq.None),c=h=>{const{lineDash:d,lineDashOffset:u,marker:p,stroke:f,strokeOpacity:y,strokeWidth:b}=n[h];return{marker:{fill:p.fill??i,fillOpacity:p.fillOpacity,size:p.size,shape:p.shape,stroke:p.stroke??f,strokeOpacity:p.strokeOpacity,strokeWidth:p.strokeWidth,lineDash:p.lineDash,lineDashOffset:p.lineDashOffset},lineDash:d,lineDashOffset:u,stroke:f,strokeOpacity:y,strokeWidth:b}};return{item:{low:c("low"),high:c("high")},fill:i,fillOpacity:s,highlightState:l,seriesId:t,xKey:o,yLowKey:r,yHighKey:a}}makeItemStylerParams(e){const{xKey:t,yLowKey:i,yHighKey:s}=this.properties;return{xKey:t,yLowKey:i,yHighKey:s,itemType:e}}getTooltipContent(e,t){const i=t?.itemType??"high",{id:s,dataModel:n,processedData:o,axes:a,properties:r}=this,{xName:l,yName:c,yLowKey:h,yLowName:d,xKey:u,yHighKey:p,yHighName:f,tooltip:y,legendItemName:b}=r,x=a.x,v=a.y;if(!n||!o||!x||!v)return;const S=o.dataSources.get(this.id)?.data[e],M=n.resolveKeysById(this,"xValue",o)[e],D=n.resolveColumnById(this,"yHighValue",o)[e],k=n.resolveColumnById(this,"yLowValue",o)[e];if(M==null)return;const I=this.getStyle(),A=this.makeItemStylerParams(i),C=this.getMarkerStyle(this.properties.item[i].marker,{datumIndex:e,datum:S},A,{isHighlight:!1,resolveMarkerSubPath:["item",i,"marker"]},I.item[i].marker),w=`${this.getAxisValueText(v,"tooltip",k,S,h,b)} - ${this.getAxisValueText(v,"tooltip",D,S,p,b)}`;return this.formatTooltipWithContext(y,{heading:this.getAxisValueText(x,"tooltip",M,S,u,b),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:`${d??h} - ${f??p}`,value:w,missing:L.isTooltipValueMissing(D)&&L.isTooltipValueMissing(k)}]},{seriesId:s,datum:S,title:c,itemType:i,xName:l,yName:c,yLowKey:h,yLowName:d,xKey:u,yHighKey:p,yHighName:f,legendItemName:b,...C})}legendItemSymbol(){const{fill:e,topLevel:t}=this.getStyle(),{stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:o,marker:a}=t;return{marker:{shape:a.shape,fill:a.fill??e,stroke:a.stroke??i,fillOpacity:a.fillOpacity,strokeOpacity:a.strokeOpacity,strokeWidth:a.strokeWidth,lineDash:a.lineDash,lineDashOffset:a.lineDashOffset},line:{enabled:!0,stroke:i,strokeOpacity:n,strokeWidth:s,lineDash:o}}}getLegendData(e){if(e!=="category")return[];const{id:t,visible:i}=this,{yLowKey:s,yHighKey:n,yName:o,yLowName:a,yHighName:r,legendItemName:l,showInLegend:c}=this.properties,h=l??o??`${a??s} - ${r??n}`,d=`${s}-${n}`;return[{legendType:"category",id:t,itemId:d,seriesId:t,enabled:i,label:{text:`${h}`},symbol:this.legendItemSymbol(),legendItemName:l,hideInLegend:!c}]}isLabelEnabled(){return this.properties.label.enabled}nodeFactory(){return new eq}animateEmptyUpdateReady(e){const{datumSelection:t,labelSelection:i,contextData:s,paths:n}=e,{animationManager:o}=this.ctx;this.updateAreaPaths(n,s),Y9(this,o,...n),Z9([t],IR),X9(this,o,t),AA(this,"labels",o,i,this.highlightLabelSelection)}animateReadyResize(e){const{contextData:t,paths:i}=e;this.updateAreaPaths(i,t),super.animateReadyResize(e)}animateWaitingUpdateReady(e){const{animationManager:t}=this.ctx,{datumSelection:i,labelSelection:s,contextData:n,paths:o,previousContextData:a}=e,[r,l,c]=o;if(r==null&&l==null&&c==null)return;this.resetDatumAnimation(e),this.resetLabelAnimation(e);const h=()=>{this.resetPathAnimation(e),this.updateAreaPaths(o,n)},d=()=>{t.skipCurrentBatch(),h()};if(n==null||a==null){h(),LR(this,t,"added",i),LA(this,"fill_path_properties",t,"add",r),LA(this,"low_stroke_path_properties",t,"add",l),LA(this,"high_stroke_path_properties",t,"add",c),AA(this,"labels",t,s,this.highlightLabelSelection);return}const u=_9(n,a,this.processedData?.reduced?.diff?.[this.id]);if(u===void 0){d();return}else if(u.status==="no-op")return;wA(this.id,"fill_path_properties",t,[r],u.fill.pathProperties),wA(this.id,"low_stroke_path_properties",t,[l],u.stroke.pathProperties),wA(this.id,"high_stroke_path_properties",t,[c],u.stroke.pathProperties),u.status==="added"?this.updateAreaPaths(o,n):u.status==="removed"?this.updateAreaPaths(o,a):(TA(this.id,"fill_path_update",t,[r],u.fill.path),TA(this.id,"low_stroke_path_update",t,[l],u.stroke.path),TA(this.id,"high_stroke_path_update",t,[c],u.stroke.path)),u.hasMotion&&(LR(this,t,void 0,i),AA(this,"labels",t,s,this.highlightLabelSelection)),this.ctx.animationManager.animate({id:this.id,groupId:"reset_after_animation",phase:"trailing",from:{},to:{},onComplete:()=>this.updateAreaPaths(o,n)})}getFormattedMarkerStyle(e){const t=this.getStyle(),i=this.makeItemStylerParams(e.itemType);return this.getMarkerStyle(this.properties.item[e.itemType].marker,e,i,{isHighlight:!0,resolveMarkerSubPath:["item",e.itemType,"marker"]},void 0,t)}getMarkerStyle(e,t,i,s,n,o){return e.itemStyler=this.properties.marker.itemStyler,super.getMarkerStyle(e,t,i,s,n,o)}computeFocusBounds(e){const t=kR(this,e),i=kR(this,{...e,datumIndex:e.datumIndex+1});if(t&&i)return tq.merge([t,i])}isDatumEnabled(e,t){return t%2===0&&super.isDatumEnabled(e,t)}hasItemStylers(){return this.properties.styler!=null||this.properties.marker.itemStyler!=null||this.properties.label.itemStyler!=null}};OA.className="RangeAreaSeries",OA.type="range-area";var{rangeAreaSeriesThemeableOptionsDef:uq}=L,EA={...et,...uq,type:$(Le("range-area")),xKey:$(N),yLowKey:$(N),yHighKey:$(N),xKeyAxis:N,yKeyAxis:N,xName:N,yName:N,yLowName:N,yHighName:N,legendItemName:N,segmentation:ca,invertedStyle:{enabled:R,...se}};EA.pickOutsideVisibleMinorAxis=ee(R),EA.focusPriority=ee(W);var TR={lineDash:{$path:"/series/$index/lineDash"},lineDashOffset:{$path:"/series/$index/lineDashOffset"},stroke:{$path:["/series/$index/stroke",{$palette:"stroke"}]},strokeOpacity:{$path:"/series/$index/strokeOpacity"},strokeWidth:{$path:["/series/$index/strokeWidth",1]},marker:{enabled:{$path:"/series/$index/marker/enabled"},fill:{$isUserOption:["/series/$index/marker/fill",{$if:[{$or:[{$isGradient:{$path:"/series/$index/marker/fill"}},{$isImage:{$path:"/series/$index/marker/fill"}},{$isPattern:{$path:"/series/$index/marker/fill"}}]},{$merge:[{$path:"/series/$index/marker/fill"},{$applySwitch:[{$path:"type"},void 0,["gradient",L.FILL_GRADIENT_RADIAL_REVERSED_DEFAULTS],["image",L.FILL_IMAGE_DEFAULTS],["pattern",L.FILL_PATTERN_DEFAULTS]]}]},{$isUserOption:["/series/$index/marker/fill",{$path:"/series/$index/marker/fill"},{$palette:"fill"}]}]},{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",L.FILL_GRADIENT_RADIAL_REVERSED_DEFAULTS],["image",L.FILL_IMAGE_DEFAULTS],["pattern",L.FILL_PATTERN_DEFAULTS]]}]},fillOpacity:{$path:"/series/$index/marker/fillOpacity"},lineDash:{$path:"/series/$index/marker/lineDash"},lineDashOffset:{$path:"/series/$index/marker/lineDashOffset"},shape:{$path:"/series/$index/marker/shape"},size:{$path:["/series/$index/marker/size",6]},stroke:{$path:["/series/$index/marker/stroke",{$palette:"stroke"}]},strokeOpacity:{$path:"/series/$index/marker/strokeOpacity"},strokeWidth:{$path:["/series/$index/marker/strokeWidth",2]}}},pq={series:{fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",L.FILL_GRADIENT_LINEAR_DEFAULTS],["pattern",L.FILL_PATTERN_DEFAULTS]]},fillOpacity:.7,stroke:{$palette:"stroke"},strokeWidth:1,marker:{enabled:!1,fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",L.FILL_GRADIENT_RADIAL_REVERSED_DEFAULTS],["image",L.FILL_IMAGE_DEFAULTS],["pattern",L.FILL_PATTERN_DEFAULTS]]},shape:"circle",stroke:{$palette:"stroke"},size:6,strokeWidth:2},nodeClickRange:"nearest",item:{low:TR,high:TR},label:{...L.LABEL_BOXING_DEFAULTS,enabled:!1,placement:"outside",padding:{$isUserOption:["./spacing",0,10]},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},interpolation:{type:"linear"},tooltip:{range:{$path:["/tooltip/range","nearest"]}},highlight:L.markerSeriesHighlightStyle(),segmentation:L.SEGMENTATION_DEFAULTS,invertedStyle:{enabled:!1,fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",L.FILL_GRADIENT_LINEAR_DEFAULTS],["image",L.FILL_IMAGE_DEFAULTS],["pattern",L.FILL_PATTERN_DEFAULTS]]},fillOpacity:{$path:"../fillOpacity"}}},axes:{number:{crosshair:{enabled:!0}}}},{predictCartesianNonPrimitiveAxis:gq}=L,pv={type:"series",name:"range-area",chartType:"cartesian",enterprise:!0,version:ue,dependencies:[oi],options:EA,predictAxis:gq,defaultAxes:{y:{type:"number",position:"left"},x:{type:"category",position:"bottom"}},axisKeys:{x:"xKeyAxis",y:"yKeyAxis"},themeTemplate:pq,create:e=>new OA(e)};function fq(e,t,i,s,n,o,a,r){const[l,c]=si(e,n);return rr([l,c],t,i,s,{smallestKeyInterval:o,xNeedsValueOf:a,yNeedsValueOf:r})}var mq=pr(fq);function yq(e,t,i,s,n){const o=t.resolveKeysById(s,"xValue",i),a=t.resolveColumnById(s,"yHighValue",i),r=t.resolveColumnById(s,"yLowValue",i),l=t.getDomain(s,"xValue","key",i),c=t.resolveColumnNeedsValueOf(s,"xValue",i),h=t.resolveColumnNeedsValueOf(s,"yHighValue",i)??t.resolveColumnNeedsValueOf(s,"yLowValue",i);if(n){const[d,u]=si(e,l);return rr([d,u],o,a,r,{smallestKeyInterval:i.reduced?.smallestKeyInterval,xNeedsValueOf:c,yNeedsValueOf:h,existingFilters:n})}return mq(e,o,a,r,l,i.reduced?.smallestKeyInterval,c,h)}function xq(e,t,i,s,n,o){const a=t.resolveKeysById(s,"xValue",i),r=t.resolveColumnById(s,"yHighValue",i),l=t.resolveColumnById(s,"yLowValue",i),c=t.getDomain(s,"xValue","key",i),h=t.resolveColumnNeedsValueOf(s,"xValue",i),d=t.resolveColumnNeedsValueOf(s,"yHighValue",i)??t.resolveColumnNeedsValueOf(s,"yLowValue",i),[u,p]=si(e,c);return tg([u,p],a,r,l,{smallestKeyInterval:i.reduced?.smallestKeyInterval,targetRange:n,xNeedsValueOf:h,yNeedsValueOf:d,existingFilters:o})}var{AbstractBarSeriesProperties:bq,makeSeriesTooltip:vq,DropShadow:Sq,Label:Mq}=L,PA=class extends Mq{constructor(){super(...arguments),this.placement="inside",this.spacing=0}};g([m],PA.prototype,"placement",2),g([m],PA.prototype,"spacing",2);var yi=class extends bq{constructor(){super(...arguments),this.fill="#99CCFF",this.fillOpacity=1,this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.shadow=new Sq().set({enabled:!1}),this.label=new PA,this.tooltip=vq()}};g([m],yi.prototype,"xKey",2),g([m],yi.prototype,"yLowKey",2),g([m],yi.prototype,"yHighKey",2),g([m],yi.prototype,"xName",2),g([m],yi.prototype,"yName",2),g([m],yi.prototype,"yLowName",2),g([m],yi.prototype,"yHighName",2),g([m],yi.prototype,"fill",2),g([m],yi.prototype,"fillOpacity",2),g([m],yi.prototype,"stroke",2),g([m],yi.prototype,"strokeWidth",2),g([m],yi.prototype,"strokeOpacity",2),g([m],yi.prototype,"lineDash",2),g([m],yi.prototype,"lineDashOffset",2),g([m],yi.prototype,"cornerRadius",2),g([m],yi.prototype,"styler",2),g([m],yi.prototype,"itemStyler",2),g([m],yi.prototype,"shadow",2),g([m],yi.prototype,"label",2),g([m],yi.prototype,"tooltip",2);var{SeriesNodePickMode:NR,valueProperty:OR,keyProperty:Dq,checkCrisp:Iq,updateLabelNode:kq,SMALLEST_KEY_INTERVAL:Aq,LARGEST_KEY_INTERVAL:Cq,diff:Lq,prepareBarAnimationFunctions:ER,midpointStartingBarPosition:PR,resetBarSelectionsFn:wq,resetBarSelectionsDirect:Tq,fixNumericExtent:Nq,seriesLabelFadeInAnimation:RR,resetLabelFn:Oq,animationValidation:Eq,computeBarFocusBounds:Pq,visibleRangeIndices:Rq,createDatumId:Fq,ContinuousScale:zq,Rect:Bq,PointerEvents:_q,motion:FR,processedDataIsAnimatable:RA,getItemStyles:Vq,calculateSegments:Gq,toHighlightString:Hq,HighlightState:zR,AggregationManager:jq}=L,Wq=class extends L.SeriesNodeEvent{constructor(e,t,i,s){super(e,t,i,s),this.xKey=s.properties.xKey,this.yLowKey=s.properties.yLowKey,this.yHighKey=s.properties.yHighKey}},FA=class extends L.AbstractBarSeries{constructor(e){super({moduleCtx:e,pickModes:[NR.AXIS_ALIGNED,NR.EXACT_SHAPE_MATCH],propertyKeys:{x:["xKey"],y:["yLowKey","yHighKey"]},propertyNames:{x:["xName"],y:["yLowName","yHighName","yName"]},categoryKey:"xValue",datumSelectionGarbageCollection:!1,animationResetFns:{datum:wq,label:Oq}}),this.properties=new yi,this.aggregationManager=new jq,this.NodeEvent=Wq}async processData(e){const{xKey:t,yLowKey:i,yHighKey:s}=this.properties,n=this.getCategoryAxis()?.scale,o=this.getValueAxis()?.scale,{isContinuousX:a,xScaleType:r,yScaleType:l}=this.getScaleInformation({xScale:n,yScale:o}),c=[];this.needsDataModelDiff()&&this.processedData&&c.push(Lq(this.id,this.processedData)),this.ctx.animationManager.isSkipped()||c.push(Eq());const h=this.visible?{}:{forceValue:0},{dataModel:d,processedData:u}=await this.requestDataModel(e,this.data,{props:[Dq(t,r,{id:"xValue"}),OR(i,l,{id:"yLowValue",invalidValue:null,...h}),OR(s,l,{id:"yHighValue",invalidValue:null,...h}),...a?[Aq,Cq]:[],...c],groupByKeys:!1});this.smallestDataInterval=u.reduced?.smallestKeyInterval,this.largestDataInterval=u.reduced?.largestKeyInterval,this.aggregateData(d,u),this.animationState.transition("updateData")}aggregateData(e,t){if(this.aggregationManager.markStale(),t.type!=="ungrouped"||RA(t))return;const i=this.axes.x;if(i==null)return;const s=this.estimateTargetRange();this.aggregationManager.aggregate({computePartial:o=>xq(i.scale.type,e,t,this,s,o),computeFull:o=>yq(i.scale.type,e,t,this,o),targetRange:s});const n=this.aggregationManager.filters;n&&n.length>0&&Jn.record(`${this.type}:aggregation`,n.map(o=>o.maxRange))}estimateTargetRange(){const e=this.axes.x;if(e?.scale==null)return 0;const[t,i]=e.scale.range;return Math.abs(i-t)}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!t||!i)return{domain:[]};const{keys:[s]}=t.domain;if(e===this.getCategoryDirection()){const n=i.resolveProcessedDataDefById(this,"xValue");if(n?.def.type==="key"&&n?.def.valueType==="category"){const o=i.getKeySortMetadata(this,"xValue",t);return{domain:s,sortMetadata:o}}return{domain:this.padBandExtent(s)}}else{const n=this.domainForClippedRange(e,["yHighValue","yLowValue"],"xValue"),o=Tt(n);return{domain:Nq(o)}}}getSeriesRange(e,t){return this.domainForVisibleRange("y",["yHighValue","yLowValue"],"xValue",t)}createNodeDatumContext(e,t){const{dataModel:i,processedData:s,groupScale:n}=this;if(!i||!s)return;const o=s.dataSources?.get(this.id)?.data;if(o==null)return;const a=e.scale,r=t.scale,{barWidth:l,groupIndex:c}=this.updateGroupScale(e),h=zq.is(a)?l*-.5:0,d=n.convert(String(c)),u=this.getBarDirection()==="x",p=Iq(e?.scale,e?.visibleRange,this.smallestDataInterval,this.largestDataInterval),[f,y]=a.range,b=Math.abs(y-f);this.aggregationManager.ensureLevelForRange(b);const x=this.aggregationManager.getFilterForRange(b),v=this.contextNodeData?.nodeData!=null&&(s.changeDescription!=null||!RA(s)||x!=null);return{rawData:o,xValues:i.resolveKeysById(this,"xValue",s),yLowValues:i.resolveColumnById(this,"yLowValue",s),yHighValues:i.resolveColumnById(this,"yHighValue",s),xScale:a,yScale:r,xAxis:e,yAxis:t,barWidth:l,groupOffset:d,barOffset:h,barAlongX:u,crisp:p,dataAggregationFilter:x,xKey:this.properties.xKey,yLowKey:this.properties.yLowKey,yHighKey:this.properties.yHighKey,labelEnabled:this.properties.label.enabled,labelPlacement:this.properties.label.placement,labelPadding:(this.properties.label.spacing+(typeof this.properties.label.padding=="number"?this.properties.label.padding:0))*(this.properties.label.placement==="outside"?1:-1),canIncrementallyUpdate:v,nodes:v?this.contextNodeData.nodeData:[],nodeIndex:0}}prepareNodeDatumState(e,t,i){const s=e.rawData[i],n=e.xValues[i];if(n==null)return;const o=e.yLowValues[i],a=e.yHighValues[i];if(!Number.isFinite(o?.valueOf())||!Number.isFinite(a?.valueOf()))return;const[r,l]=o<a?[o,a]:[a,o];return t.datum=s,t.xValue=n,t.yLowValue=r,t.yHighValue=l,t.rawLowValue=o,t.rawHighValue=a,t}createSkeletonNodeDatum(e,t,i){const s=t.nodeDatumScratch;return{index:t.groupedDataIndex,series:this,itemId:i,datum:s.datum,datumIndex:t.datumIndex,xValue:s.xValue,yLowValue:0,yHighValue:0,yLowKey:e.yLowKey,yHighKey:e.yHighKey,xKey:e.xKey,x:0,y:0,width:0,height:0,midPoint:{x:0,y:0},crisp:t.crisp,labels:[]}}createNodeDatum(e,t,i,s){const n=this.prepareNodeDatumState(e,t.nodeDatumScratch,t.datumIndex);if(!n)return;const o=this.createSkeletonNodeDatum(e,t,i);return this.updateNodeDatum(e,o,t,s,n),o}updateNodeDatum(e,t,i,s,n){if(n??(n=this.prepareNodeDatumState(e,i.nodeDatumScratch,i.datumIndex)),!n)return;const o=t;o.index=i.groupedDataIndex,o.datum=n.datum,o.datumIndex=i.datumIndex,o.xValue=n.xValue,o.yLowValue=n.rawLowValue,o.yHighValue=n.rawHighValue,o.crisp=i.crisp;const a=Math.round(e.yScale.convert(i.yHigh)),r=Math.round(e.yScale.convert(i.yLow)),l=Math.max(s,Math.abs(r-a)),c={x:e.barAlongX?Math.min(a,r):i.x,y:e.barAlongX?i.x:Math.min(a,r),width:e.barAlongX?l:i.width,height:e.barAlongX?i.width:l};o.x=c.x,o.y=c.y,o.width=c.width,o.height=c.height;const h=o.midPoint;h.x=c.x+c.width/2,h.y=c.y+c.height/2;const d=o.clipBBox;d&&(d.x=c.x,d.y=c.y,d.width=c.width,d.height=c.height);const u=i.labelParamsScratch;u.labels=o.labels,u.datumIndex=i.datumIndex,u.rectX=c.x,u.rectY=c.y,u.rectWidth=c.width,u.rectHeight=c.height,u.yLowValue=n.yLowValue,u.yHighValue=n.yHighValue,u.datum=n.datum,this.updateLabelData(e,u)}upsertNodeDatum(e,t,i,s){if(e.canIncrementallyUpdate&&e.nodeIndex<e.nodes.length){const o=e.nodes[e.nodeIndex];this.updateNodeDatum(e,o,t,s)}else{const o=this.createNodeDatum(e,t,i,s);o&&e.nodes.push(o)}e.nodeIndex++}createNodeDataWithAggregation(e,t,i,s,n,o){const{maxRange:a,indexData:r,midpointIndices:l}=o,[c,h]=Rq(1,a,e.xAxis.range,d=>{const u=d*In,p=r[u+js],f=l[d];if(f!==-1)return[t(f),t(p)+e.barWidth]});for(let d=c;d<h;d+=1){const u=d*In,p=r[u+Hs],f=r[u+js],y=r[u+Ws],b=r[u+$s],x=l[d];x===-1||e.xValues[x]==null||(i.datumIndex=x,i.groupedDataIndex=0,i.x=t(x),i.width=Math.abs(t(p)-t(f))+e.barWidth,i.yLow=e.yLowValues[y],i.yHigh=e.yHighValues[b],i.crisp=!1,this.upsertNodeDatum(e,i,s,n))}}createNodeDataSimple(e,t,i,s,n,o){const a=o.invalidData?.get(this.id);let[r,l]=this.visibleRangeIndices("xValue",e.xAxis.range);o.input.count<1e3&&(r=0,l=o.input.count);for(let c=r;c<l;c+=1)a?.[c]!==!0&&(i.datumIndex=c,i.groupedDataIndex=0,i.x=t(c),i.width=e.barWidth,i.yLow=e.yLowValues[c],i.yHigh=e.yHighValues[c],i.crisp=e.crisp,this.upsertNodeDatum(e,i,s,n))}createNodeDataGrouped(e,t,i,s,n){const o=this.processedData;for(const{datumIndex:a,groupIndex:r}of this.dataModel.forEachGroupDatum(this,o))i.datumIndex=a,i.groupedDataIndex=r,i.x=t(a),i.width=e.barWidth,i.yLow=e.yLowValues[a],i.yHigh=e.yHighValues[a],i.crisp=e.crisp,this.upsertNodeDatum(e,i,s,n)}createNodeData(){const{data:e,processedData:t,visible:i}=this,s=this.getCategoryAxis(),n=this.getValueAxis();if(!(e&&s&&n&&this.dataModel&&t?.dataSources&&this.chart?.seriesRect))return;const o=this.createNodeDatumContext(s,n);if(!o)return;const{yLowKey:a,yHighKey:r,strokeWidth:l}=this.properties,c=`${a}-${r}`,h=Gq(this.properties.segmentation,s,n,this.chart.seriesRect,this.ctx.scene),d={itemId:c,nodeData:o.nodes,labelData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible,styles:Vq(this.getItemStyle.bind(this)),segments:h};if(!i)return d;const u=f=>Math.round(o.xScale.convert(o.xValues[f]))+o.groupOffset+o.barOffset,p={nodeDatumScratch:{datum:void 0,xValue:void 0,yLowValue:0,yHighValue:0,rawLowValue:void 0,rawHighValue:void 0},labelParamsScratch:{labels:[],datumIndex:0,rectX:0,rectY:0,rectWidth:0,rectHeight:0,yLowValue:0,yHighValue:0,datum:void 0},datumIndex:0,groupedDataIndex:0,x:0,width:0,yLow:0,yHigh:0,crisp:!1};o.dataAggregationFilter!=null?this.createNodeDataWithAggregation(o,u,p,c,l,o.dataAggregationFilter):t.type==="ungrouped"?this.createNodeDataSimple(o,u,p,c,l,t):this.createNodeDataGrouped(o,u,p,c,l),o.canIncrementallyUpdate&&o.nodeIndex<o.nodes.length&&(o.nodes.length=o.nodeIndex);for(const f of o.nodes)d.labelData.push(...f.labels);return d}updateLabelData(e,t){const i=t.labels;if(!e.labelEnabled){i.length>0&&(i.length=0);return}const{xKey:s,yLowKey:n,yHighKey:o,xName:a,yLowName:r,yHighName:l,yName:c,legendItemName:h,label:d}=this.properties,u=e.barAlongX,p=e.labelPlacement,f=e.labelPadding,y=t.rectX,b=t.rectY,x=t.rectWidth,v=t.rectHeight,S=y+(u?-f:x/2),M=b+(u?v/2:v+f);let D;p==="outside"?D=u?"right":"center":D=u?"left":"center";let k;p==="outside"?k=u?"middle":"top":k=u?"middle":"bottom";const I=y+(u?x+f:x/2),A=b+(u?v/2:-f);let C;p==="outside"?C=u?"left":"center":C=u?"right":"center";let w;p==="outside"?w=u?"middle":"bottom":w=u?"middle":"top";const T=t.datum,O=t.yLowValue,E=t.yHighValue,z=t.datumIndex,F={datum:T,xKey:s,yLowKey:n,yHighKey:o,xName:a,yLowName:r,yHighName:l,yName:c,legendItemName:h},_=this.getSeriesDomain("y").domain,G=this.getLabelText(O,T,n,"y",_,d,{itemType:"low",value:O,...F}),B=this.getLabelText(E,T,o,"y",_,d,{itemType:"high",value:E,...F});if(i.length>0&&i[0].itemType==="low"){const V=i[0];V.datumIndex=z,V.x=S,V.y=M,V.textAlign=D,V.textBaseline=k,V.text=G,V.datum=T}else i[0]={datumIndex:z,x:S,y:M,textAlign:D,textBaseline:k,text:G,itemType:"low",datum:T,series:this};if(i.length>1&&i[1].itemType==="high"){const V=i[1];V.datumIndex=z,V.x=I,V.y=A,V.textAlign=C,V.textBaseline=w,V.text=B,V.datum=T}else i[1]={datumIndex:z,x:I,y:A,textAlign:C,textBaseline:w,text:B,itemType:"high",datum:T,series:this};i.length=2}nodeFactory(){return new Bq}getStyle(e,t){const{cornerRadius:i,fill:s,fillOpacity:n,lineDash:o,lineDashOffset:a,stroke:r,strokeOpacity:l,strokeWidth:c,styler:h}=this.properties;let d={};if(!e&&h){const u=this.makeStylerParams(t);d=this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],this.cachedCallWithContext(h,u)??{},{pick:!1})??{}}return{cornerRadius:d.cornerRadius??i,fill:d.fill??s,fillOpacity:d.fillOpacity??n,lineDash:d.lineDash??o,lineDashOffset:d.lineDashOffset??a,opacity:1,stroke:d.stroke??r,strokeOpacity:d.strokeOpacity??l,strokeWidth:d.strokeWidth??c}}makeStylerParams(e){const{id:t}=this,{cornerRadius:i,fill:s,fillOpacity:n,lineDash:o,lineDashOffset:a,stroke:r,strokeOpacity:l,strokeWidth:c,xKey:h,yLowKey:d,yHighKey:u}=this.properties,p=Hq(e??zR.None);return{cornerRadius:i,fill:s,fillOpacity:n,highlightState:p,lineDash:o,lineDashOffset:a,seriesId:t,stroke:r,strokeOpacity:l,strokeWidth:c,xKey:h,yLowKey:d,yHighKey:u}}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e,s=t??[];return RA(this.processedData)?i.update(s,void 0,n=>this.getDatumId(n)):i.update(s)}getItemStyle(e,t,i){const{properties:s,dataModel:n,processedData:o}=this,{itemStyler:a}=s,r=this.getHighlightStyle(t,e,i);let l=oe(r,this.getStyle(e===void 0,i));if(a&&n!=null&&o!=null&&e!=null){const c=n.resolveKeysById(this,"xValue",o)[e],h=this.cachedDatumCallback(Fq(this.getDatumId({xValue:c}),t?"highlight":"node"),()=>{const d=this.makeItemStylerParams(e,t,l);return this.callWithContext(a,d)});h&&(l=oe(h,l))}return l}makeItemStylerParams(e,t,i){const{id:s,properties:n,processedData:o}=this,{xKey:a,yHighKey:r,yLowKey:l}=n,c=o.dataSources.get(s)?.data[e],h=this.ctx.highlightManager?.getActiveHighlight(),d=this.getHighlightStateString(h,t,e),u=this.filterItemStylerFillParams(i.fill)??i.fill;return{seriesId:s,datum:c,xKey:a,yHighKey:r,yLowKey:l,highlightState:d,...i,fill:u}}updateDatumStyles(e){const t=this.ctx.highlightManager.getActiveHighlight();e.datumSelection.each((i,s)=>{if(!e.datumSelection.isGarbage(i)){const n=this.getHighlightState(t,e.isHighlight,s.datumIndex);s.style=this.getItemStyle(s.datumIndex,e.isHighlight,n)}})}updateDatumNodes({datumSelection:e,isHighlight:t}){const{contextNodeData:i}=this;if(!i)return;const s=this.ctx.highlightManager.getActiveHighlight(),n=this.getCategoryDirection()==="x",o=this.getShapeFillBBox(),a=this;e.each(function(l,c){const h=c.style??i.styles[a.getHighlightState(s,t,c.datumIndex)];l.setStyleProperties(h,o),l.setStaticProperties("overlay",h.cornerRadius??0,h.cornerRadius??0,h.cornerRadius??0,h.cornerRadius??0,n?c.width>0:c.height>0,c.crisp,void 0)})}updateLabelSelection(e){const t=this.properties.label.enabled?e.labelData:[];return e.labelSelection.update(t,i=>{i.pointerEvents=_q.None})}updateLabelNodes(e){const{isHighlight:t=!1}=e,i={xKey:this.properties.xKey,xName:this.properties.xName??this.properties.xKey,yName:this.properties.yName,yLowKey:this.properties.yLowKey,yLowName:this.properties.yLowName??this.properties.yLowKey,yHighKey:this.properties.yHighKey,yHighName:this.properties.yHighName??this.properties.yHighKey,legendItemName:this.properties.legendItemName},s=this.ctx.highlightManager?.getActiveHighlight();e.labelSelection.each((n,o)=>{n.fillOpacity=this.getHighlightStyle(t,o?.datumIndex).opacity??1,kq(this,n,i,this.properties.label,o,t,s)})}getHighlightLabelData(e,t){return t.labels?.length?t.labels:super.getHighlightLabelData(e,t)}getTooltipContent(e){const{id:t,dataModel:i,processedData:s,properties:n}=this,{xKey:o,xName:a,yName:r,yLowKey:l,yHighKey:c,yLowName:h,yHighName:d,tooltip:u,legendItemName:p}=n,f=this.getCategoryAxis(),y=this.getValueAxis();if(!i||!s||!f||!y)return;const b=s.dataSources.get(this.id)?.data[e],x=i.resolveKeysById(this,"xValue",s)[e],v=i.resolveColumnById(this,"yHighValue",s)[e],S=i.resolveColumnById(this,"yLowValue",s)[e];if(x==null)return;const M=this.getItemStyle(e,!1),D=`${this.getAxisValueText(y,"tooltip",S,b,l,p)} - ${this.getAxisValueText(y,"tooltip",v,b,c,p)}`;return this.formatTooltipWithContext(u,{heading:this.getAxisValueText(f,"tooltip",x,b,o,p),symbol:this.legendItemSymbol(),data:[{label:r,fallbackLabel:`${h??l} - ${d??c}`,value:D,missing:L.isTooltipValueMissing(v)&&L.isTooltipValueMissing(S)}]},{seriesId:t,datum:b,title:r,xKey:o,xName:a,yName:r,yLowKey:l,yHighKey:c,yLowName:h,yHighName:d,legendItemName:p,...M})}legendItemSymbol(){const{fill:e,stroke:t,strokeWidth:i,fillOpacity:s,strokeOpacity:n,lineDash:o,lineDashOffset:a}=this.getStyle(!1,zR.None);return{marker:{fill:e,stroke:t,fillOpacity:s,strokeOpacity:n,strokeWidth:i,lineDash:o,lineDashOffset:a}}}getLegendData(e){if(e!=="category")return[];const{id:t,visible:i}=this,{yName:s,yLowName:n,yHighName:o,yLowKey:a,yHighKey:r,legendItemName:l,showInLegend:c}=this.properties,h=l??s??`${n??a} - ${o??r}`,d=`${a}-${r}`;return[{legendType:"category",id:t,itemId:d,seriesId:t,enabled:i,label:{text:`${h}`},symbol:this.legendItemSymbol(),legendItemName:l,hideInLegend:!c}]}resetDatumAnimation(e){Tq([e.datumSelection])}animateEmptyUpdateReady({datumSelection:e,labelSelection:t}){const i=ER(PR(this.isVertical(),"normal"),"unknown");FR.fromToMotion(this.id,"datums",this.ctx.animationManager,[e],i),RR(this,"labels",this.ctx.animationManager,t,this.highlightLabelSelection)}animateWaitingUpdateReady(e){const{datumSelection:t,labelSelection:i,contextData:s,previousContextData:n}=e,o=L.calculateDataDiff(this.id,t,this.getDatumId.bind(this),s,n,this.processedData,this.processedDataUpdated);this.ctx.animationManager.stopByAnimationGroupId(this.id);const a=n==null?"fade":"normal",r=ER(PR(this.isVertical(),a),"added");FR.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],r,(l,c)=>this.getDatumId(c),o),(o?.changed||!_o(s.groupScale,n?.groupScale))&&RR(this,"labels",this.ctx.animationManager,i,this.highlightLabelSelection)}getDatumId(e){return`${e.xValue}`}isLabelEnabled(){return this.properties.label.enabled}computeFocusBounds({datumIndex:e}){return Pq(this,this.contextNodeData?.nodeData[e])}hasItemStylers(){return this.properties.styler!=null||this.properties.itemStyler!=null||this.properties.label.itemStyler!=null}};FA.className="RangeBarSeries",FA.type="range-bar";var{rangeBarSeriesThemeableOptionsDef:$q}=L,zA={...et,...$q,type:$(Le("range-bar")),xKey:$(N),yLowKey:$(N),yHighKey:$(N),xKeyAxis:N,yKeyAxis:N,xName:N,yName:N,yLowName:N,yHighName:N,legendItemName:N,segmentation:ca};zA.pickOutsideVisibleMinorAxis=ee(R),zA.focusPriority=ee(W);var Uq={series:{direction:"vertical",fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",L.FILL_GRADIENT_LINEAR_DEFAULTS],["image",L.FILL_IMAGE_DEFAULTS],["pattern",L.FILL_PATTERN_DEFAULTS]]},stroke:{$palette:"stroke"},strokeWidth:{$isUserOption:["./stroke",2,0]},label:{...L.LABEL_BOXING_DEFAULTS,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"chartBackgroundColor"},placement:"inside",padding:{$isUserOption:["./spacing",0,6]}},highlight:L.multiSeriesHighlightStyle(),segmentation:L.SEGMENTATION_DEFAULTS},axes:{number:{crosshair:{enabled:!0}}}},{DIRECTION_SWAP_AXES:Kq,predictCartesianNonPrimitiveAxis:Yq}=L,gv={type:"series",name:"range-bar",chartType:"cartesian",enterprise:!0,groupable:!0,version:ue,dependencies:[oi],options:zA,predictAxis:Yq,defaultAxes:Kq,axisKeys:{x:"xKeyAxis",y:"yKeyAxis"},axisKeysFlipped:{x:"yKeyAxis",y:"xKeyAxis"},themeTemplate:Uq,create:e=>new FA(e)},{AbstractBarSeriesProperties:Zq,makeSeriesTooltip:Xq,DropShadow:qq,Label:Qq}=L,fv=class extends K{};g([m],fv.prototype,"totalType",2),g([m],fv.prototype,"index",2),g([m],fv.prototype,"axisLabel",2);var BR=class extends K{};g([m],BR.prototype,"renderer",2);var BA=class extends Qq{constructor(){super(...arguments),this.placement="outside-end",this.spacing=0}};g([m],BA.prototype,"placement",2),g([m],BA.prototype,"spacing",2);var Fs=class extends K{constructor(){super(...arguments),this.fill="#c16068",this.stroke="#c16068",this.fillOpacity=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.strokeWidth=1,this.cornerRadius=0,this.shadow=new qq().set({enabled:!1}),this.label=new BA,this.tooltip=new BR}};g([m],Fs.prototype,"name",2),g([m],Fs.prototype,"fill",2),g([m],Fs.prototype,"stroke",2),g([m],Fs.prototype,"fillOpacity",2),g([m],Fs.prototype,"strokeOpacity",2),g([m],Fs.prototype,"lineDash",2),g([m],Fs.prototype,"lineDashOffset",2),g([m],Fs.prototype,"strokeWidth",2),g([m],Fs.prototype,"cornerRadius",2),g([m],Fs.prototype,"itemStyler",2),g([m],Fs.prototype,"shadow",2),g([m],Fs.prototype,"label",2),g([m],Fs.prototype,"tooltip",2);var Oh=class extends K{constructor(){super(...arguments),this.enabled=!0,this.stroke="black",this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.strokeWidth=2}};g([m],Oh.prototype,"enabled",2),g([m],Oh.prototype,"stroke",2),g([m],Oh.prototype,"strokeOpacity",2),g([m],Oh.prototype,"lineDash",2),g([m],Oh.prototype,"lineDashOffset",2),g([m],Oh.prototype,"strokeWidth",2);var mv=class extends K{constructor(){super(...arguments),this.positive=new Fs,this.negative=new Fs,this.total=new Fs}};g([m],mv.prototype,"positive",2),g([m],mv.prototype,"negative",2),g([m],mv.prototype,"total",2);var Zr=class extends Zq{constructor(){super(...arguments),this.item=new mv,this.totals=new Pi(fv),this.line=new Oh,this.tooltip=Xq()}getStyle(e){const{fillOpacity:t,strokeWidth:i,strokeOpacity:s,fill:n,stroke:o,lineDash:a,lineDashOffset:r,cornerRadius:l}=this.item[e==="subtotal"?"total":e];return{fill:n,fillOpacity:t,stroke:o,strokeWidth:i,strokeOpacity:s,lineDash:a,lineDashOffset:r,cornerRadius:l,opacity:1}}};g([m],Zr.prototype,"xKey",2),g([m],Zr.prototype,"yKey",2),g([m],Zr.prototype,"xName",2),g([m],Zr.prototype,"yName",2),g([m],Zr.prototype,"item",2),g([m],Zr.prototype,"totals",2),g([m],Zr.prototype,"line",2),g([m],Zr.prototype,"tooltip",2);var{adjustLabelPlacement:Jq,SeriesNodePickMode:_R,fixNumericExtent:e8,valueProperty:VR,keyProperty:t8,accumulativeValueProperty:yv,trailingAccumulatedValueProperty:i8,createDatumId:GR,checkCrisp:s8,updateLabelNode:n8,prepareBarAnimationFunctions:o8,collapsedStartingBarPosition:a8,resetBarSelectionsFn:r8,seriesLabelFadeInAnimation:l8,resetLabelFn:c8,animationValidation:h8,DEFAULT_CARTESIAN_DIRECTION_KEYS:d8,DEFAULT_CARTESIAN_DIRECTION_NAMES:u8,computeBarFocusBounds:p8,Rect:g8,motion:f8,getItemStylesPerItemId:m8,DataSet:y8}=L,_A=class extends L.AbstractBarSeries{constructor(e){super({moduleCtx:e,propertyKeys:d8,propertyNames:u8,categoryKey:void 0,pickModes:[_R.NEAREST_NODE,_R.EXACT_SHAPE_MATCH],pathsPerSeries:["connector"],pathsZIndexSubOrderOffset:[-1,-1],animationResetFns:{datum:r8,label:c8}}),this.properties=new Zr,this.seriesItemTypes=new Set(["positive","negative","total"])}async processData(e){const{xKey:t,yKey:i,totals:s}=this.properties,{data:n}=this;if(!this.visible)return;const o=v=>Bc(v)&&Number(v)>=0,a=v=>Bc(v)&&Number(v)>=0,r=v=>v==="total"||v==="subtotal",l={missingValue:void 0,invalidValue:void 0},c=[],h=s.reduce((v,S)=>{const M=v.get(S.index);return M?M.push(S):v.set(S.index,[S]),v},new Map);for(const[v,S]of n?.data.entries()??[]){c.push(S);const M=h.get(v);if(M)for(const D of M)c.push({...D.toJson(),[t]:D.axisLabel})}const d=[];this.ctx.animationManager.isSkipped()||d.push(h8());const u=this.getCategoryAxis()?.scale,p=this.getValueAxis()?.scale,{isContinuousX:f,xScaleType:y,yScaleType:b}=this.getScaleInformation({xScale:u,yScale:p}),{processedData:x}=await this.requestDataModel(e,y8.wrap(c),{props:[t8(t,y,{id:"xValue"}),yv(i,b,{...l,id:"yCurrent"}),yv(i,b,{...l,missingValue:0,id:"yCurrentTotal"}),yv(i,b,{...l,id:"yCurrentPositive",validation:o}),yv(i,b,{...l,id:"yCurrentNegative",validation:a}),i8(i,b,{...l,id:"yPrevious"}),VR(i,b,{id:"yRaw"}),VR("totalType","category",{id:"totalTypeValue",missingValue:void 0,validation:r}),...f?[L.SMALLEST_KEY_INTERVAL,L.LARGEST_KEY_INTERVAL]:[],...d]});this.smallestDataInterval=x.reduced?.smallestKeyInterval,this.largestDataInterval=x.reduced?.largestKeyInterval,this.updateSeriesItemTypes(),this.animationState.transition("updateData")}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!t||!i)return{domain:[]};const{keys:[s],values:n}=t.domain;if(e===this.getCategoryDirection()){const o=i.resolveProcessedDataDefById(this,"xValue");if(o?.def.type==="key"&&o?.def.valueType==="category"){const l=i.getKeySortMetadata(this,"xValue",t);return{domain:s,sortMetadata:l}}const a=e==="y",r=this.getCategoryAxis().isReversed();return{domain:this.padBandExtent(s,r!==a)}}else{const o=i.resolveProcessedDataIndexById(this,"yCurrent"),a=n[o],r=[Math.min(0,a[0]),Math.max(0,a[1])];return{domain:e8(r)}}}getSeriesRange(){return[Number.NaN,Number.NaN]}createNodeData(){const{data:e,dataModel:t,processedData:i}=this,s=this.getCategoryAxis(),n=this.getValueAxis();if(!e||!s||!n||!t||!i)return;const{line:o}=this.properties,a=s.scale,r=n.scale,l=this.getBarDirection()==="x",c=this.getBandwidth(s)??10,h=s.isReversed(),d=n.isReversed();if(i.type!=="ungrouped")return;const u={itemId:this.properties.yKey,nodeData:[],labelData:[],pointData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible,styles:m8(this.getItemStyle.bind(this),"total","subtotal","positive","negative")};if(!this.visible)return u;const p=[],f=t.resolveKeysById(this,"xValue",i),y=t.resolveColumnById(this,"yRaw",i),b=t.resolveColumnById(this,"totalTypeValue",i),x=t.resolveColumnById(this,"yCurrent",i),v=t.resolveColumnById(this,"yPrevious",i),S=t.resolveColumnById(this,"yCurrentTotal",i),M=this.getSeriesDomain("y").domain,D=s8(s?.scale,s?.visibleRange,this.smallestDataInterval,this.largestDataInterval);function k(F,_,G){return F||_?{cumulativeValue:S[G],trailingValue:_?A:0}:{cumulativeValue:x[G],trailingValue:v[G]}}function I(F,_,G,B,V){return F?B:_?(B??0)-(V??0):G}let A=0;const{xKey:C,yKey:w,xName:T,yName:O}=this.properties,E=i.dataSources.get(this.id)?.data??[];for(const[F,_]of E.entries()){const G=b[F],B=this.isSubtotal(G),V=this.isTotal(G),Y=V||B,X=f[F];if(X==null)continue;const q=Math.round(a.convert(X)),te=y[F],{cumulativeValue:pe,trailingValue:Se}=k(V,B,F);Y&&(A=pe??0);const ve=Math.round(r.convert(pe)),ae=Math.round(r.convert(Se)),Ie=I(V,B,te,pe,Se),ze=(Ie??0)>=0,Xe=this.getSeriesItemType(ze,G),{strokeWidth:Te,label:de}=this.getItemConfig(Xe),De=ze?ve:ae,ye=ze?ae:ve,Ee=Math.max(Te,Math.abs(ye-De)),Ne={x:l?Math.min(De,ye):q,y:l?q:Math.min(De,ye),width:l?Ee:c,height:l?c:Ee},xt={x:Ne.x+Ne.width/2,y:Ne.y+Ne.height/2},nt=Y?ve:ae,We=Math.floor(o.strokeWidth)%2/2,rt=h?ve:nt,wt=h?nt:ve;let vt,Ds;l?(vt={x:rt+We,y:Ne.y},Ds={x:wt+We,y:Ne.y+Ne.height}):(vt={x:Ne.x,y:rt+We},Ds={x:Ne.x+Ne.width,y:wt+We});const Zn={x:h?Ds.x:vt.x,y:h?Ds.y:vt.y,x2:h?vt.x:Ds.x,y2:h?vt.y:Ds.y,size:0};p.push(Zn);const oa=Xe==="subtotal"?"total":Xe,yn=this.getLabelText(Ie,_,w,"y",M,de,{itemType:oa,value:Ie,datum:_,xKey:C,yKey:w,xName:T,yName:O}),Xn=de.spacing+(typeof de.padding=="number"?de.padding:0),Dp={index:F,series:this,itemType:Xe,datum:_,datumIndex:F,cumulativeValue:pe??0,xValue:X,yValue:Ie,yKey:w,xKey:C,x:Ne.x,y:Ne.y,width:Ne.width,height:Ne.height,midPoint:xt,crisp:D,label:{text:yn,...Jq({isUpward:(Ie??-1)>=0!==d,isVertical:!l,placement:de.placement,spacing:Xn,rect:Ne})}};u.nodeData.push(Dp),u.labelData.push(Dp)}const z=this.properties.line.enabled;return x!=null&&z&&(u.pointData=p),u}updateSeriesItemTypes(){const{dataModel:e,seriesItemTypes:t,processedData:i}=this;if(!e||!i)return;t.clear();const s=e.resolveProcessedDataIndexById(this,"yCurrentPositive"),n=e.resolveProcessedDataIndexById(this,"yCurrentNegative"),o=e.resolveProcessedDataIndexById(this,"totalTypeValue"),a=i.domain.values[s]??[],r=i.domain.values[n]??[];a.length>0&&t.add("positive"),r.length>0&&t.add("negative");const l=i?.domain.values[o];if(l)for(const c of l)(c==="total"||c==="subtotal")&&t.add("total")}isSubtotal(e){return e==="subtotal"}isTotal(e){return e==="total"}nodeFactory(){return new g8}getSeriesItemType(e,t){return t??(e?"positive":"negative")}getItemConfig(e){switch(e){case"positive":return this.properties.item.positive;case"negative":return this.properties.item.negative;case"subtotal":case"total":return this.properties.item.total}}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e,s=t??[];return i.update(s)}getItemStyle(e,t,i,s="total"){const{properties:n}=this,{datumIndex:o=0,datum:a}=e??{},r=s==="subtotal"?"total":s,l=n.item[r],c=this.getHighlightStyle(t,o,i),h=oe(c,n.getStyle(s)),{itemStyler:d}=l;let u=h;if(d!=null&&e!=null){const p=this.cachedDatumCallback(GR(o,t?"highlight":"node"),()=>{const f=this.makeItemStylerParams(s,o,a,t,u);return this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`,"item",r],this.callWithContext(d,f))});p&&(u=oe(p,u))}return u}makeItemStylerParams(e,t,i,s,n){const{id:o,properties:a}=this,{xKey:r,yKey:l}=a,c=this.ctx.highlightManager?.getActiveHighlight(),h=this.getHighlightStateString(c,s,t),d=this.filterItemStylerFillParams(n.fill)??n.fill;return{seriesId:o,itemType:e,datum:i,xKey:r,yKey:l,highlightState:h,...n,fill:d}}updateDatumStyles({datumSelection:e,isHighlight:t}){e.each((i,s)=>{s.style=this.getItemStyle(s,t,void 0,s.itemType)})}updateDatumNodes({datumSelection:e,isHighlight:t}){const{contextNodeData:i}=this;if(!i)return;const s=this.ctx.highlightManager.getActiveHighlight(),n=this.getCategoryDirection()==="x",o=this.getShapeFillBBox();e.each((a,r)=>{const l=r.style??i.styles[r.itemType][this.getHighlightState(s,t,r.datumIndex)];a.setStyleProperties(l,o),a.cornerRadius=l.cornerRadius??0,a.visible=n?r.width>0:r.height>0,a.crisp=r.crisp})}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e;if(t.length===0)return i.update([]);const s=t.filter(n=>{const{label:o}=this.getItemConfig(n.itemType);return o.enabled});return i.update(s)}updateLabelNodes({labelSelection:e,isHighlight:t}){const i={itemType:"positive",xKey:this.properties.xKey,xName:this.properties.xName??this.properties.xName,yKey:this.properties.yKey,yName:this.properties.yName??this.properties.yName},s=this.ctx.highlightManager?.getActiveHighlight();e.each((n,o)=>{i.itemType=o.itemType;const a=this.getHighlightStyle(t,o.datumIndex)?.opacity??1;n.visible=!0,n.fillOpacity=a;const r=this.getItemConfig(o.itemType).label;n8(this,n,i,r,o.label,t,s)})}getTooltipContent(e){const{id:t,dataModel:i,processedData:s,properties:n}=this,{xKey:o,xName:a,yKey:r,yName:l,tooltip:c,legendItemName:h}=n,d=this.getCategoryAxis(),u=this.getValueAxis();if(!i||!s||!d||!u)return;const p=s.dataSources.get(this.id)?.data[e],f=i.resolveKeysById(this,"xValue",s)[e],y=i.resolveColumnById(this,"yRaw",s)[e],b=i.resolveColumnById(this,"yCurrentTotal",s),x=i.resolveColumnById(this,"totalTypeValue",s);if(f==null)return;const v=x[e],S=(y??0)>=0,M=this.getSeriesItemType(S,v);let D;if(this.isTotal(v))D=b[e];else if(this.isSubtotal(v)){D=b[e];for(let A=e-1;A>=0;A-=1)if(this.isSubtotal(x[A])){D=D-b[A];break}}else D=y;const k=this.contextNodeData?.nodeData?.[e],I=this.getItemStyle(k,!1,void 0,k?.itemType);return this.formatTooltipWithContext(c,{heading:this.getAxisValueText(d,"tooltip",f,p,o,h),symbol:this.legendItemSymbol(M),data:[{label:l,fallbackLabel:r,value:this.getAxisValueText(u,"tooltip",D,p,r,h),missing:L.isTooltipValueMissing(y)}]},{seriesId:t,datum:p,title:l,itemType:M,xKey:o,xName:a,yKey:r,yName:l,...I})}legendItemSymbol(e){const{fill:t,stroke:i,fillOpacity:s,strokeOpacity:n,strokeWidth:o,lineDash:a,lineDashOffset:r}=this.getItemConfig(e);return{marker:{fill:t,stroke:i,fillOpacity:s,strokeOpacity:n,strokeWidth:o,lineDash:a,lineDashOffset:r}}}getLegendData(e){if(e!=="category")return[];const{id:t,seriesItemTypes:i}=this,s=[],n=a=>a.charAt(0).toUpperCase()+a.substring(1),{showInLegend:o}=this.properties;for(const a of i){const{name:r}=this.getItemConfig(a);s.push({legendType:"category",id:t,itemId:GR(a),seriesId:t,enabled:!0,label:{text:r??n(a)},symbol:this.legendItemSymbol(a),hideInLegend:!o,isFixed:!0})}return s}toggleSeriesItem(){}animateEmptyUpdateReady(e){const{datumSelection:t,labelSelection:i,contextData:s}=e,n=o8(a8(this.isVertical(),this.axes,"normal"),"unknown");f8.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],n),l8(this,"labels",this.ctx.animationManager,i);const{pointData:o}=s;o&&(this.isVertical()?this.animateConnectorLinesVertical(e):this.animateConnectorLinesHorizontal(e))}animateConnectorLinesHorizontal(e){const{pointData:t=[]}=e.contextData,[i]=e.paths,{path:s}=i;this.updateLineNode(i);const n=this.getValueAxis(),o=n?.isReversed(),a=o?(h,d)=>h<d:(h,d)=>h>d,r=n?.scale.convert(0),l=t.reduce((h,d)=>(a(d.x,h)&&(h=d.x),h),o?1/0:0),c=(h,d,u,p,f)=>(h-d)/(u-d)*(f-p)+p;this.ctx.animationManager.animate({id:`${this.id}_connectors`,groupId:this.id,phase:"initial",from:r,to:l,ease:xr,collapsable:!1,onUpdate(h){s.clear(!0);for(const[d,u]of t.entries()){const p=c(h,r,l,r,u.x),f=c(h,r,l,r,u.x2);d!==0&&s.lineTo(p,u.y),s.moveTo(f,u.y2)}i.checkPathDirty()},onStop:()=>this.resetConnectorLinesPath(e)})}animateConnectorLinesVertical(e){const{pointData:t=[]}=e.contextData,[i]=e.paths,{path:s}=i;this.updateLineNode(i);const n=this.getValueAxis(),o=n?.isReversed(),a=o?(h,d)=>h>d:(h,d)=>h<d,r=n?.scale.convert(0),l=t.reduce((h,d)=>(a(d.y,h)&&(h=d.y),h),o?0:1/0),c=(h,d,u,p,f)=>(h-d)/(u-d)*(f-p)+p;this.ctx.animationManager.animate({id:`${this.id}_connectors`,groupId:this.id,phase:"initial",from:r,to:l,ease:xr,collapsable:!1,onUpdate(h){s.clear(!0);for(const[d,u]of t.entries()){const p=c(h,r,l,r,u.y),f=c(h,r,l,r,u.y2);d!==0&&s.lineTo(u.x,p),s.moveTo(u.x2,f)}i.checkPathDirty()},onStop:()=>this.resetConnectorLinesPath(e)})}animateReadyResize(e){super.animateReadyResize(e),this.resetConnectorLinesPath(e)}updatePaths(e){this.resetConnectorLinesPath({contextData:e.contextData,paths:e.paths})}resetConnectorLinesPath({contextData:e,paths:t}){if(t.length===0)return;const[i]=t;this.updateLineNode(i);const{path:s}=i;s.clear(!0);const{pointData:n}=e;if(n){for(const[o,a]of n.entries())o!==0&&s.lineTo(a.x,a.y),s.moveTo(a.x2,a.y2);i.checkPathDirty()}}updateLineNode(e){const{stroke:t,strokeWidth:i,strokeOpacity:s,lineDash:n,lineDashOffset:o}=this.properties.line;e.setProperties({fill:void 0,stroke:t,strokeWidth:i,strokeOpacity:s,lineDash:n,lineDashOffset:o,lineJoin:"round",pointerEvents:L.PointerEvents.None})}isLabelEnabled(){const{positive:e,negative:t,total:i}=this.properties.item;return e.label.enabled||t.label.enabled||i.label.enabled}computeFocusBounds({datumIndex:e}){return p8(this,this.contextNodeData?.nodeData[e])}hasItemStylers(){const{positive:e,negative:t,total:i}=this.properties.item;return e.itemStyler!=null||e.label.itemStyler!=null||t.itemStyler!=null||t.label.itemStyler!=null||i.itemStyler!=null||i.label.itemStyler!=null}};_A.className="WaterfallSeries",_A.type="waterfall";var{waterfallSeriesThemeableOptionsDef:x8}=L,b8={...x8,...et,type:$(Le("waterfall")),xKey:$(N),yKey:$(N),xKeyAxis:N,yKeyAxis:N,xName:N,yName:N,totals:Ft({totalType:$(Z("total","subtotal")),index:$(P),axisLabel:$(N)},"a total definition options array")},{FILL_GRADIENT_LINEAR_KEYED_DEFAULTS:v8,FILL_IMAGE_DEFAULTS:S8,FILL_PATTERN_KEYED_DEFAULTS:M8}=L;function VA(e,t){return{fill:{$applySwitch:[{$path:"type"},{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$path:[`/${t}`,{$palette:"fill"},{$palette:"fills"}]},{$palette:`${e}.fill`}]},["gradient",v8(e)],["image",S8],["pattern",M8(e)]]},stroke:{$palette:`${e}.stroke`},strokeWidth:{$isUserOption:["./stroke",2,0]},label:{...L.LABEL_BOXING_DEFAULTS,enabled:!1,fontStyle:void 0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},formatter:void 0,placement:"outside-end",padding:{$isUserOption:["./spacing",0,6]}}}}var D8={series:{item:{positive:VA("altUp",0),negative:VA("altDown",1),total:VA("neutral",2)},line:{stroke:{$palette:"neutral.stroke"},strokeOpacity:1,lineDash:[0],lineDashOffset:0,strokeWidth:2},highlight:L.singleSeriesHighlightStyle()},legend:{enabled:!0,toggleSeries:!1}},{DIRECTION_SWAP_AXES:I8}=L,GA={type:"series",name:"waterfall",chartType:"cartesian",enterprise:!0,solo:!0,version:ue,dependencies:[oi],options:b8,defaultAxes:I8,axisKeys:{x:"xKeyAxis",y:"yKeyAxis"},axisKeysFlipped:{x:"yKeyAxis",y:"xKeyAxis"},themeTemplate:D8,create:e=>new _A(e)},HR={width:P,height:P,grip:R,fill:ie,stroke:ie,strokeWidth:P,cornerRadius:P},fn=["cursor","highlightStyle","listeners","nodeClickRange","showInLegend","showInMiniChart","tooltip","visible","xName","yName"],jR=[...fn,"errorBar","label","legendItemName"],WR=[...fn,"direction","legendItemName","minName","q1Name","medianName","q3Name","maxName"],$R=[...fn,"title","label","labelKey","labelName","sizeName"],UR=[...fn,"title","label","colorName","textAlign","verticalAlign","itemPadding","colorRange"],KR=[...fn,"label"],YR=[...fn,"errorBar","title","label"],ZR=[...fn,"label","yLowName","yHighName"],XR=[...fn,"direction","label","yLowName","yHighName"],qR=[...fn,"errorBar","title","label","labelKey","labelName"],QR=[...fn,"direction"],k8={enabled:R,height:P,spacing:P,cornerRadius:W,mask:{fill:ie,fillOpacity:ce,stroke:ie,strokeWidth:P},minHandle:HR,maxHandle:HR,miniChart:{enabled:R,padding:{top:P,bottom:P},label:{enabled:R,avoidCollisions:R,spacing:P,format:nn,formatter:vi(Hi),interval:{minSpacing:P,maxSpacing:P,values:sn,step:W},...Ke},series:Ft(nl({area:Q(wI.options,[...fn,"type"]),bar:Q(sb.options,[...jR,"type"]),"box-plot":Q(uA.options,[...WR,"type"]),bubble:Q(FI.options,[...$R,"type"]),candlestick:Q(rv.options,[...fn,"type"]),heatmap:Q(SA.options,[...UR,"type"]),histogram:Q(BI.options,[...KR,"type"]),line:Q(lb.options,[...YR,"type"]),ohlc:Q(lv.options,[...fn,"type"]),"range-area":Q(pv.options,[...ZR,"type"]),"range-bar":Q(gv.options,[...XR,"type"]),scatter:Q(HI.options,[...qR,"type"]),waterfall:Q(GA.options,[...QR,"type"])},"miniChart series options"))}},A8=["area","bar","bubble","candlestick","heatmap","histogram","line","ohlc","range-area","range-bar","scatter","waterfall"],C8=["itemStyler","simpleItemStyler","direction","fill","fillGradientDefaults","fillPatternDefaults","fillImageDefaults","fillOpacity","shadow","focusPriority","highlight","lineDash","lineDashOffset","strokeWidth"];function JR(e,t){return{$merge:[{$switch:[t,{},[["area","line","range-area"],{marker:{enabled:{$isUserOption:["/series/$index/marker/enabled",{$path:["/series/$index/marker/enabled",!1]},!1]}}}]]},{$omit:[{$switch:[t,fn,["bar",jR],["box-plot",WR],["bubble",$R],["heatmap",UR],["histogram",KR],["line",[...YR,...C8]],["range-area",ZR],["range-bar",XR],["scatter",qR],["waterfall",QR]]},e]}]}}var L8={enabled:!1,height:{$if:[{$path:"./miniChart/enabled"},40,18]},cornerRadius:4,mask:{fill:{$ref:"foregroundColor"},fillOpacity:.1,stroke:{$ref:"borderColor"},strokeWidth:1},minHandle:{fill:{$ref:"chartBackgroundColor"},stroke:{$ref:"borderColor"},strokeWidth:1,width:12,height:24,cornerRadius:4},maxHandle:{fill:{$ref:"chartBackgroundColor"},stroke:{$ref:"borderColor"},strokeWidth:1,width:12,height:24,cornerRadius:4},miniChart:{enabled:!1,label:{color:{$ref:"textColor"},fontSize:{$rem:Si.SMALLER},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},spacing:5},padding:{top:0,bottom:0},series:{$apply:[JR({$path:"/series/$index"},{$path:["/navigator/miniChart/series/$index/type",{$path:["type",{$path:"/series/$index/type"}]}]}),{$if:[{$or:A8.map(e=>({$eq:[{$path:"/series/0/type"},e]}))},{$map:[JR({$value:"$1"},{$path:"/series/$index/type"}),{$path:"/series"}]},void 0]}]}}},HA={type:"plugin",name:"navigator",chartType:"cartesian",enterprise:!0,version:ue,options:k8,themeTemplate:L8,create:e=>new lp(e)},eF=class extends Vo{};g([m],eF.prototype,"value",2);var{userInteraction:w8,LayoutElement:T8,Toolbar:N8}=L,jA=class extends bi{constructor(e){super(),this.ctx=e,this.enabled=!1,this.buttons=new Pi(eF),this.verticalSpacing=10,this.container=e.domManager.addChild("canvas-overlay","range-buttons"),this.container.role="presentation",this.toolbar=new N8(this.ctx,"ariaLabelRangesToolbar","horizontal"),this.toolbar.addClass("ag-charts-range-buttons"),this.container.append(this.toolbar.getElement()),this.cleanup.register(this.toolbar.addToolbarListener("button-pressed",this.onButtonPress.bind(this)),e.layoutManager.registerElement(T8.ToolbarBottom,this.onLayoutStart.bind(this)),e.eventsHub.on("zoom:change-complete",this.onZoomChanged.bind(this)),this.teardown.bind(this))}teardown(){this.toolbar.getElement().remove(),this.toolbar.destroy()}onLayoutStart({layoutBox:e}){const{buttons:t,ctx:i,enabled:s,toolbar:n,verticalSpacing:o}=this;if(!s||!i.zoomManager.isZoomEnabled()){n.setHidden(!0);return}n.setHidden(!1),n.updateButtons(t);const a=n.getBounds().height;n.setBounds({x:e.x,y:e.y+e.height-a,width:e.width,height:a}),e.shrink({bottom:a+o})}onZoomChanged(){this.toolbar.clearActiveButton()}onButtonPress({button:{index:e}}){const{zoomManager:t}=this.ctx,i=this.buttons.at(e);if(!i)return;const{value:s}=i,n=w8(`zoom-range-button-${e}`);s==null?t.resetZoom(n):typeof s=="number"?t.extendToEnd(n,"x",s):Array.isArray(s)?t.updateWith(n,"x",()=>s):typeof s=="function"&&t.updateWith(n,"x",s),this.toolbar.toggleActiveButtonByIndex(e)}};g([m],jA.prototype,"enabled",2),g([m],jA.prototype,"buttons",2);var tF=1e3*60*60*24,WA=tF*30,O8=tF*365,$A={type:"plugin",name:"ranges",chartType:"cartesian",enterprise:!0,version:ue,options:{enabled:R,buttons:Ft({...er,value:Ae(W,Ue(be(Ae(W,is)),qa(2,2)),ct)},"range button options array")},themeTemplate:{enabled:!1,buttons:{$shallowSimple:[{label:"toolbarRange1Month",ariaLabel:"toolbarRange1MonthAria",value:WA},{label:"toolbarRange3Months",ariaLabel:"toolbarRange3MonthsAria",value:3*WA},{label:"toolbarRange6Months",ariaLabel:"toolbarRange6MonthsAria",value:6*WA},{label:"toolbarRangeYearToDate",ariaLabel:"toolbarRangeYearToDateAria",value:(e,t)=>[new Date(`${new Date(t).getFullYear()}-01-01`).getTime(),void 0]},{label:"toolbarRange1Year",ariaLabel:"toolbarRange1YearAria",value:O8},{label:"toolbarRangeAll",ariaLabel:"toolbarRangeAllAria",value:void 0}]}},create:e=>new jA(e)},{LayoutElement:E8,Group:P8,Label:zf,Rect:R8,Text:Xi}=L,iF={ohlc:62,candlestick:62,"hollow-candlestick":62,line:96,"step-line":96,hlc:184,"high-low":800},F8={up:"positive",down:"negative"},z8={hlc:"altNeutral"},UA=class extends K{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1}};g([m],UA.prototype,"fill",2),g([m],UA.prototype,"fillOpacity",2);var mn=class extends bi{constructor(e){super(),this.ctx=e,this.enabled=!1,this.openKey=void 0,this.highKey=void 0,this.lowKey=void 0,this.closeKey=void 0,this.volumeKey=void 0,this.title=new zf,this.positive=new zf,this.negative=new zf,this.neutral=new zf,this.altNeutral=new zf,this.background=new UA,this.layoutStyle="block",this.id="status-bar",this.layer=new P8({name:"StatusBar",zIndex:14}),this.labelGroup=this.layer.appendChild(new L.TranslatableGroup),this.backgroundNode=this.labelGroup.appendChild(new R8),this.labels=[{label:"O",configuration:2,title:this.labelGroup.appendChild(new Xi),value:this.labelGroup.appendChild(new Xi),id:"openValue",key:"openKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"H",configuration:16,title:this.labelGroup.appendChild(new Xi),value:this.labelGroup.appendChild(new Xi),id:"highValue",key:"highKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"H",configuration:256,title:this.labelGroup.appendChild(new Xi),value:this.labelGroup.appendChild(new Xi),style:"neutral",id:"highValue",key:"highKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"L",configuration:8,title:this.labelGroup.appendChild(new Xi),value:this.labelGroup.appendChild(new Xi),id:"lowValue",key:"lowKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"L",configuration:512,title:this.labelGroup.appendChild(new Xi),value:this.labelGroup.appendChild(new Xi),style:"neutral",id:"lowValue",key:"lowKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"C",configuration:4,title:this.labelGroup.appendChild(new Xi),value:this.labelGroup.appendChild(new Xi),id:"closeValue",key:"closeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"C",configuration:128,title:this.labelGroup.appendChild(new Xi),value:this.labelGroup.appendChild(new Xi),id:"closeValue",key:"closeKey",style:"neutral",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"",configuration:64,title:this.labelGroup.appendChild(new Xi),value:this.labelGroup.appendChild(new Xi),style:"neutral",id:"closeValue",key:"closeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2})},{label:"Vol",configuration:32,title:this.labelGroup.appendChild(new Xi),value:this.labelGroup.appendChild(new Xi),id:"volumeValue",key:"volumeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2})}],this.highlightManager=e.highlightManager,this.labelGroup.visible=!1,this.cleanup.register(e.scene.attachNode(this.layer),e.layoutManager.registerElement(E8.Overlay,t=>this.startPerformLayout(t)),e.eventsHub.on("layout:complete",t=>this.onLayoutComplete(t)),e.eventsHub.on("highlight:change",()=>this.updateHighlight()),e.eventsHub.on("data:update",t=>{this.chartData=t}))}updateDomainsFromSeries(){if(!this.enabled)return;const e=this.ctx.chartService.series;if(e.length===0)return;let t,i;for(const s of e){const o=s.getDomain("y")?.domain;!Array.isArray(o)||o.length<2||(s.type==="bar"?i=[o[0],o.at(-1)]:t=[o[0],o.at(-1)])}for(const s of this.labels){if(this[s.key]==null){s.domain=void 0;continue}s.domain=s.key==="volumeKey"?i:t}}startPerformLayout({layoutBox:e}){if(this.labelGroup.translationX=0,this.labelGroup.translationY=0,!this.enabled){this.labelGroup.visible=!1;return}this.updateDomainsFromSeries();const t=4,i=12,s=0,n=8;this.labelGroup.translationY=e.y+s;const o=Math.max(this.title.fontSize,this.positive.fontSize,this.negative.fontSize),a=Mn(o),r=iF[this.getChartType()]??0;let l=0,c,h="alphabetic";if(this.layoutStyle==="block")e.shrink(s+a+n,"top"),c=o+(a-o)/2;else{const{title:d}=this.ctx.chartService;if(h="top",c=s+d.padding,d.enabled){const u=d.node.getBBox();l=u.x+u.width+i}else l=d.padding}for(const{label:d,configuration:u,title:p,value:f,domain:y,formatter:b}of this.labels){if(y==null||!(r&u)){p.visible=!1,f.visible=!1;continue}const x=Ze(this.positive),v=Ze(this.negative),S=Math.max(x.textWidth(b.format(y[0])),x.textWidth(b.format(y[1])),v.textWidth(b.format(y[0])),v.textWidth(b.format(y[1])));p.visible=!0,f.visible=!0;const M=Ze(this.title).measureLines(d);p.setFont(this.title),p.fill=this.title.color,p.text=d,p.textBaseline=h,p.y=c,p.x=l,l+=M.width+t,f.textBaseline=h,f.y=c,f.x=l,l+=S+i}this.backgroundNode.x=0,this.backgroundNode.y=0,this.backgroundNode.width=l-i,this.backgroundNode.height=a+s+n,this.backgroundNode.fill=this.background.fill,this.backgroundNode.fillOpacity=this.background.fillOpacity}onLayoutComplete(e){this.labelGroup.translationX=e.series.rect.x,this.updateHighlight()}updateHighlight(){if(!this.enabled)return;const e=this.highlightManager.getActiveHighlight(),t=e?.datum??this.chartData?.data?.at(-1);if(t==null){this.labelGroup.visible=!1;return}this.labelGroup.visible=!0;const i=e?.itemId;let s=i==null?void 0:F8[i];s==null&&this.openKey!=null&&this.closeKey!=null&&(t[this.openKey]<t[this.closeKey]?s="positive":s="negative");for(const{domain:n,value:o,key:a,formatter:r,style:l}of this.labels){if(n==null)continue;let c=l??s??"neutral";c==="neutral"&&(c=z8[this.getChartType()]??c);const h=this[a],d=h==null?void 0:t?.[h];o.setFont(this[c]),o.fill=this[c].color,o.text=typeof d=="number"?r.format(d):""}}getChartType(){let e=this.ctx.chartService.publicApi?.getOptions()?.chartType;return(e==null||iF[e]==null)&&(e="candlestick"),e}};g([m],mn.prototype,"enabled",2),g([m],mn.prototype,"openKey",2),g([m],mn.prototype,"highKey",2),g([m],mn.prototype,"lowKey",2),g([m],mn.prototype,"closeKey",2),g([m],mn.prototype,"volumeKey",2),g([m],mn.prototype,"title",2),g([m],mn.prototype,"positive",2),g([m],mn.prototype,"negative",2),g([m],mn.prototype,"neutral",2),g([m],mn.prototype,"altNeutral",2),g([m],mn.prototype,"background",2),g([m],mn.prototype,"layoutStyle",2);var KA={type:"plugin",name:"statusBar",chartType:"cartesian",enterprise:!0,version:ue,themeTemplate:{enabled:!1,layoutStyle:ma,title:{color:{$ref:"textColor"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}},positive:{color:{$palette:"up.stroke"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}},negative:{color:{$palette:"down.stroke"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}},neutral:{color:{$palette:"neutral.stroke"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}},background:{fill:{$ref:"chartBackgroundColor"},fillOpacity:.5},altNeutral:{color:"gray",fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}}},create:e=>new mn(e)},Mo=0,qi=1,Eh=qi-Mo,sF="end",nF="middle",oF=300,xv=(e,t=Mo,i=qi)=>ge(t,e,i);function YA(){return{x:{min:Mo,max:qi},y:{min:Mo,max:qi}}}function Qi(e){return e.x.max-e.x.min}function Wn(e){return e.y.max-e.y.min}function aF(e,t){return qe(e.min,t.min)&&qe(e.max,t.max)}function bv(e,t){return aF(e.x,t.x)&&aF(e.y,t.y)}function vv(e){return bv(e,YA())}function Ji(e){return{x:{min:e?.x?.min??Mo,max:e?.x?.max??qi},y:{min:e?.y?.min??Mo,max:e?.y?.max??qi}}}function Xr(e,t,i){if(!e)return{x:0,y:0};const s=xv(t-e.x,0,e.x+e.width),n=xv(i-e.y,0,e.y+e.height),o=1/e.width*s,a=1-1/e.height*n;return{x:xv(o),y:xv(a)}}function Ph(e,t,i){return{x:{min:e.x.min+t,max:e.x.max+t},y:{min:e.y.min+i,max:e.y.max+i}}}function Sv(e,t,i){return{x:{min:e.x.min,max:e.x.min+Qi(e)*t},y:{min:e.y.min,max:e.y.min+Wn(e)*i}}}function rF(e,t,i){const s=Qi(e),n=Wn(e),o=e.x.min+s/2,a=e.y.min+n/2;return{x:{min:o-s*t/2,max:o+s*t/2},y:{min:a-n*i/2,max:a+n*i/2}}}function $n(e,t,i,s){const{min:n,max:o}=t,a=n+(o-n)/2,r=e.max-e.min;switch(i){case"start":return{min:n,max:t.min+r};case"end":return{min:t.max-r,max:o};case"middle":return{min:a-r/2,max:a+r/2};case"pointer":return B8(e,t,s??a);default:return{min:n,max:o}}}function B8(e,t,i){const s=e.max-e.min,n=t.max-t.min,o=i*(1-(n-s)),a=i-o,r=e.min+a,l=e.max+a;return{min:r,max:l}}function _8(e,t,i){return{x:{min:e.x.min*t,max:e.x.max*t},y:{min:e.y.min*i,max:e.y.max*i}}}function Do(e){return{x:Mv(e.x),y:Mv(e.y)}}function Mv(e){const t=e.max-e.min;let i=e.max>qi?qi-t:e.min,s=e.min<Mo?t:e.max;return i=Math.max(Mo,i),s=Math.min(qi,s),{min:i,max:s}}function lF(e){const t=e.getCoreZoom(),i=e.getRestoredZoom();return Ln(t,i)!=null}var{CartesianAxis:ZA,ContinuousScale:cF,TimeScale:V8,UnitTimeScale:G8,TooltipManager:H8}=L,Ha=Me.create("sync");function hF(e,t,i){const s=e.getKeys(t),n=e.getKeys(i);return e.shouldFlipXY?.()?[n,s]:[s,n]}function XA(e="x"){switch(e){case"x":return["x"];case"y":return["y"];case"xy":return["x","y"]}}function j8(e,t,i){return V8.is(e)||G8.is(e)?!vn(t.map(s=>s?.valueOf()),i.map(s=>s?.valueOf())):!vn(t,i)}var pc=class extends K{constructor(e){super(),this.moduleContext=e,this.enabled=!1,this.axes="x",this.nodeInteraction=!0,this.zoom=!0,this.domainMode="id",this.domainSync=new rg}updateSiblings(e){const{syncManager:t}=this.moduleContext;for(const i of t.getGroupSiblings(e??this.groupId))Ha("ChartSync.updateSiblings()",i.id,i),this.updateChart(i)}updateChart(e,t=3){Ha("ChartSync.updateChart()",e.id,kc[t],e),t===3?e.ctx.updateService.update(t,{forceNodeDataRefresh:!0}):e.ctx.updateService.update(t)}enabledZoomSync(){const{eventsHub:e}=this.moduleContext;this.disableZoomSync?.(),this.disableZoomSync=e.on("zoom:change-complete",t=>this.onZoom(t))}onZoom(e){const{syncManager:t}=this.moduleContext;for(const i of t.getGroupSiblings(this.groupId)){if(!i.modulesManager.getModule("sync")?.zoom)continue;const n=i.modulesManager.getModule("zoom");if(!n)continue;const o=this.prepareZoomUpdate();e.source!=="sync"&&(Ha("ChartsSyncManager.enabledZoomSync()",i.id,o),n.updateSyncZoom(o))}}enabledNodeInteractionSync(){this.disableNodeInteractionSync?.(),this.disableNodeInteractionSync=this.moduleContext.eventsHub.on("highlight:change",this.onHighlightChange.bind(this))}onHighlightChange(e){const{syncManager:t}=this.moduleContext;if(e.callerId.endsWith("-sync"))return;Ha("ChartSync.onHighlightChange()",e);const i=e.currentHighlight?.series,[s]=XA(this.axes),n=s==="x"?"y":"x",[o,a]=i?hF(i,s,n):[],r=Rf(e.currentHighlight);let l=o?.[0]?r?.[o[0]]:void 0,c=!1;if(Is(l)&&(c=!0,l=l.getTime()),!e.currentHighlight?.datum){for(const d of t.getGroupSiblings(this.groupId))d.modulesManager.getModule("sync")?.nodeInteraction&&(d.ctx.highlightManager.updateHighlight(`${d.id}-sync`,void 0,!0),d.ctx.tooltipManager.removeTooltip(`${d.id}-sync`,void 0,!0));return}const h=t.getGroupSyncMode(this.groupId)==="multi-series";this.findMatchingHighlightNodes(s,n,h?a:[],c,l,e)}findMatchingHighlightNodes(e,t,i,s,n,o){const{syncManager:a}=this.moduleContext;Ha("ChartSync.findMatchingHighlightNodes()",{mainDirection:e,secondaryKeys:i});for(const r of a.getGroupSiblings(this.groupId)){if(!r.modulesManager.getModule("sync")?.nodeInteraction)continue;let c=!1;for(const h of r.axes){if(!ZA.is(h)||h.direction!==e)continue;const d=r.series.filter(u=>{if(!u.visible)return!1;if(i.length>0){const[,p]=hF(u,e,t);return i.every(f=>p.includes(f))}return!0}).map(this.findMatchingNodes(h,e,s,n)).filter(St);if(d.length===1&&d[0]?.nodeDatum!==r.ctx.highlightManager.getActiveHighlight()){this.dispatchHighlightUpdate(r,d[0].nodeDatum),c=!0;break}}c||(Ha("ChartSync.findMatchingHighlightNodes() - no matching nodes",r.id,o),this.dispatchHighlightUpdate(r))}}findMatchingNodes(e,t,i,s){return n=>{if(n.getKeyAxis(e.direction)!==e.id)return;const a=n.contextNodeData?.nodeData??[];if(!a?.length)return;const r=a[0],l=`${t}Key`;if(!KS(r,l))return;const c=r[l],h=a.find(d=>{const u=d.datum[c];return i?u.getTime()===s:u===s});return h?{series:n,nodeDatum:h}:null}}dispatchHighlightUpdate(e,t){Ha("ChartSync.dispatchHighlightUpdate()",e.id,t);const i=t==null;e.ctx.highlightManager.updateHighlight(`${e.id}-sync`,t,i);const s=t?.series.tooltipEnabled??e.tooltip.enabled;if(t&&s){const n=e.seriesAreaBoundingBox,o=n.x+(t.midPoint?.x??t.point?.x??0),a=n.y+(t.midPoint?.y??t.point?.y??0),r=H8.makeTooltipMeta({type:"pointermove",canvasX:o,canvasY:a},t.series,t,void 0);e.ctx.tooltipManager.updateTooltip(`${e.id}-sync`,r,e.getTooltipContent(t.series,t.datumIndex,t,"tooltip"))}else e.ctx.tooltipManager.removeTooltip(`${e.id}-sync`,void 0,!0);this.updateChart(e,5)}async getSyncedDomain(e){if(!ZA.is(e)||this.axes!=="xy"&&this.axes!==e.direction)return;const{groupState:t,directionDomains:i,idDomains:s,positionDomains:n}=this.updateDomainState(e);return this.validateAxis(e,t),await this.waitForDomainsToBeReady(),this.domainMode==="position"?this.calculateDerivedDomain(e,n):this.domainMode==="direction"?this.calculateDerivedDomain(e,i):this.calculateDerivedDomain(e,s)}updateDomainState(e){var t,i,s,n,o;const{syncManager:a}=this.moduleContext,r=a.getChart().id,l=e.id,c=a.getGroupState(this.groupId);if(!c)throw new Error("AG Charts - no GroupState for groupId: "+this.groupId);const h=c.domains??(c.domains={}),d=h[t=e.direction]??(h[t]={derived:[],sources:{},dirty:!0}),u=(i=d.sources)[r]??(i[r]={});u[l]=e.dataDomain.domain,d.dirty=!0;const p=c.domainsById??(c.domainsById={}),f=p[l]??(p[l]={derived:[],sources:{},dirty:!0}),y=(s=f.sources)[r]??(s[r]={});y[l]=e.dataDomain.domain,f.dirty=!0;const b=c.domainsByPosition??(c.domainsByPosition={}),x=b[n=e.position]??(b[n]={derived:[],sources:{},dirty:!0}),v=(o=x.sources)[r]??(o[r]={});return v[l]=e.dataDomain.domain,x.dirty=!0,{groupState:c,directionDomains:d,idDomains:f,positionDomains:x}}validateAxis(e,t){const i=this.moduleContext.syncManager.getGroupSyncMode(this.groupId)==="multi-series";XA(this.axes).includes(e.direction)&&(i?this.validateMultiSeries(e,t):this.validateSingleSeries(e,t))}validateMultiSeries(e,t){const{min:i,max:s,nice:n,reverse:o}=e,a=new Set(e.boundSeries.flatMap(r=>r.getKeys(e.direction)));for(const r of t.members){const{axes:l,modulesManager:c}=r,h=c.getModule("sync"),d=XA(h?.axes),u=l.filter(f=>d.includes(f.direction)).filter(f=>f.boundSeries.some(y=>y.getKeys(f.direction).some(b=>a.has(b))));if(u.length===0)continue;const[p]=u;if(p.min!==i||p.max!==s||p.nice!==n||p.reverse!==o){j.warnOnce("To allow synchronization, ensure that all synchronized axes with matching keys have matching min, max, nice, and reverse properties."),this.enabled=!1;return}}}validateSingleSeries(e,t){const i=t.members,[{axes:s}]=i,{direction:n,min:o,max:a,nice:r,reverse:l}=e;for(const c of s)if(n===c.direction&&(r!==c.nice||l!==c.reverse||o!==c.min&&($e(o)||$e(c.min))||a!==c.max&&($e(a)||$e(c.max)))){j.warnOnce("To allow synchronization, ensure that all charts have matching min, max, nice, and reverse properties on the synchronized axes."),this.enabled=!1;return}}calculateDerivedDomain(e,t){if(!t.dirty)return t.derived;let i=t.derived;const s=Object.values(t.sources).map(o=>Object.values(o));let n;return cF.is(e.scale)?n=s.flat(2):n=s.flat().toSorted((o,a)=>o.length>a.length?-1:1).flat(),t.derived=Ap(n),cF.is(e.scale)&&(i=Tt(i),t.derived=Tt(t.derived)),t.dirty=!1,j8(e.scale,i,t.derived)&&(Ha(e.id,"updated",{before:i,after:t.derived}),this.updateSiblings()),t.derived}removeAxis(e){if(!ZA.is(e)||this.axes!=="xy"&&this.axes!==e.direction)return;const{syncManager:t}=this.moduleContext,i=t.getGroupState(this.groupId),s=t.getChart().id,n=e.id;delete i?.domains?.[e.direction]?.sources?.[s]?.[n],delete i?.domainsByPosition?.[e.position]?.sources?.[s]?.[n],delete i?.domainsById?.[n]?.sources?.[s]?.[n]}async waitForDomainsToBeReady(){const{syncManager:e}=this.moduleContext;let t=0;for(;e.getGroupMembers(this.groupId).some(i=>i.syncStatus==="init");)Ha("ChartSync.waitForDomainsToBeReady() - waiting for all domains to be calculated",this.groupId),await this.domainSync.waitForCompletion(),t++;t>0&&Ha("ChartSync.waitForDomainsToBeReady() - waited for",t,"iterations"),this.domainSync.notify()}prepareZoomUpdate(){const{zoomManager:e}=this.moduleContext,t=e.getZoom();return this.axes==="x"?delete t?.y:this.axes==="y"&&delete t?.x,Ji(t)}onEnabledChange(){const{syncManager:e,highlightManager:t}=this.moduleContext;this.enabled?(e.subscribe(this.groupId),t.unhighlightDelay=0):(e.unsubscribe(this.groupId),t.unhighlightDelay=100),this.updateSiblings(),this.onNodeInteractionChange(),this.onZoomChange()}onGroupIdChange(e,t){if(!this.enabled||e===t)return;const{syncManager:i}=this.moduleContext;i.unsubscribe(t),i.subscribe(e),this.updateSiblings(t),this.updateSiblings(e)}onAxesChange(){if(!this.enabled)return;const{syncManager:e}=this.moduleContext;this.updateChart(e.getChart())}onNodeInteractionChange(){this.enabled&&this.nodeInteraction?this.enabledNodeInteractionSync():this.disableNodeInteractionSync?.()}onZoomChange(){this.enabled&&this.zoom?this.enabledZoomSync():this.disableZoomSync?.()}destroy(){const{syncManager:e}=this.moduleContext;e.unsubscribe(this.groupId),this.updateSiblings(),this.disableZoomSync?.()}};pc.className="Sync",g([m,Wt(e=>e.onEnabledChange())],pc.prototype,"enabled",2),g([m,Wt((e,t,i)=>e.onGroupIdChange(t,i))],pc.prototype,"groupId",2),g([m,Wt(e=>e.onAxesChange())],pc.prototype,"axes",2),g([m,Wt(e=>e.onNodeInteractionChange())],pc.prototype,"nodeInteraction",2),g([m,Wt(e=>e.onZoomChange())],pc.prototype,"zoom",2),g([m,Wt(e=>e.onAxesChange())],pc.prototype,"domainMode",2);var qA={type:"plugin",name:"sync",chartType:"cartesian",enterprise:!0,version:ue,options:{enabled:R,groupId:N,axes:Z("x","y","xy"),nodeInteraction:R,zoom:R},themeTemplate:{enabled:!1},create:e=>new pc(e)},dF="#2196f3",W8="#8a8a8a",uF=class extends L.Rect{constructor(){super(),this.fill=dF,this.fillOpacity=.2,this.zIndex=5}updateValid(){this.fill=dF}updateInvalid(){this.fill=W8}};uF.className="ZoomRect";var QA=class extends K{constructor(e){super(),this.onChange=e,this.enabled=!1,this.padding=0}};g([m,He({changeValue(e){this.onChange({enabled:e,padding:this.padding})}})],QA.prototype,"enabled",2),g([m,He({changeValue(e){this.onChange({enabled:this.enabled,padding:e})}})],QA.prototype,"padding",2);var $8=class{constructor(e,t,i,s,n){this.properties=e,this.zoomManager=t,this.deps=i,this.manuallyAdjusted=!1,n.register(s.on("zoom:save-memento",o=>this.onSaveMemento(o)),s.on("zoom:load-memento",o=>this.onLoadMemento(o)),s.on("zoom:change-request",o=>this.onChangeRequest(o)))}get enabled(){return this.deps.enabled&&this.properties.enabled&&!this.manuallyAdjusted}onManualAdjustment(e){e==="y"&&(this.manuallyAdjusted=!0)}onChange(e){e.enabled&&this.zoomManager.updateChanges({source:"chart-update",sourceDetail:"internal-autoScaling",changes:this.autoScaleYZoom()??{},isReset:!1})}onChangeRequest(e){if(e.isReset)for(const t of e.changedAxes)e.state[t]?.direction==="y"&&(this.manuallyAdjusted=!1);if(this.enabled){const t=this.autoScaleYZoom(e.state);t&&e.constrainChanges(t)}}onSaveMemento(e){e.memento.autoScaledAxes=this.enabled?[]:["y"]}onLoadMemento(e){const{zoom:t,memento:i,navigatorModule:s,zoomModule:n}=e;if(!s||n){let o=i?.autoScaledAxes?.includes("y");if(i?.rangeY)o??(o=!1),t.y=this.zoomManager.rangeToRatioDirection("y",i.rangeY)??{min:0,max:1};else if(i?.ratioY)o??(o=!1),t.y={min:i.ratioY.start??0,max:i.ratioY.end??1};else{o??(o=!0);const a=o?this.getAutoScaleYZoom(t.x):void 0;t.y=a??{min:0,max:1}}o!=null&&(this.manuallyAdjusted=!o)}}getAutoScaleYZoom(e){if(!this.enabled)return;const{padding:t}=this.properties;let i;return this.deps.enableIndependentAxes?i=this.primaryAxisZoom("y",e,{padding:t}):i=this.combinedAxisZoom("y",e,{padding:t}),e.min===0&&e.max===1?i==null?void 0:{min:0,max:1}:i}autoScaleYZoom(e){const t=this.zoomManager.getZoom();if(t&&e){const s=this.zoomManager.getAxisZooms();for(const n of["x","y"])for(const o of To(e))if(s[o]?.direction===n){t[n]=e[o];break}}if(t?.x==null)return;const i=this.getAutoScaleYZoom(t.x);if(!(i==null||ii(t.y,i)))return this.zoomManager.toCoreZoomState({x:t.x,y:i})}zoomBounds(e,t,i,s){const n=e.scale,o=n.range;n.range=[0,1];const a=t.scale,r=a.range;a.range=[0,1];let l=1,c=!1,h=0,d=!1;for(const f of t.boundSeries){if(!f.visible)continue;const{connectsToYAxis:y}=f,b=f.getRange("y",[i.min,i.max]);for(const x of b){const v=a.convert(x);Number.isFinite(v)&&(v<l&&(l=v,c=!y||x<0),v>h&&(h=v,d=!y||x>0))}}if($e(t.min)&&(l=0),$e(t.max)&&(h=1),n.range=o,a.range=r,l>=h)return;const u=(c?s:0)+(d?s:0),p=Math.min((h-l)*(1+u),1);if(!(p<=0)){if(c&&d){const f=(h+l)/2;l=f-p/2,h=f+p/2}else!c&&d?h=l+p:c&&!d&&(l=h-p);return l<0?(h+=-l,l=0):h>1&&(l-=h-1,h=1),{min:l,max:h}}}primaryAxisZoom(e,t,{padding:i=0}={}){const s=e==="x"?"y":"x",n=this.zoomManager.getPrimaryAxis(s),o=this.zoomManager.getPrimaryAxis(e);if(!(n==null||o==null))return this.zoomBounds(n,o,t,i)}combinedAxisZoom(e,t,{padding:i=0}={}){const s=this.zoomManager.getAxes(),n=e==="x"?"y":"x",o=new Map;for(const c of s)if(c.direction===n)for(const h of c.boundSeries)o.set(h,c);let a=1,r=0;for(const c of s)if(c.direction===e)for(const h of c.boundSeries){const d=o.get(h);if(d==null)continue;const u=this.zoomBounds(d,c,t,i);if(u==null)return;a=Math.min(a,u.min),r=Math.max(r,u.max)}const l=1e-6;if(a<l&&(a=0),r>1-l&&(r=1),!(a>r))return{min:a,max:r}}},U8=class{update(e,t,i,s,n,o){return this.oldZoom??(this.oldZoom=Ji(t==="x"?{...n,x:o}:{...n,y:o})),this.updateCoords(e.offsetX,e.offsetY),this.updateZoom(t,i,s)}stop(){this.coords=void 0,this.oldZoom=void 0}updateCoords(e,t){this.coords?(this.coords.x2=e,this.coords.y2=t):this.coords={x1:e,y1:t,x2:e,y2:t}}updateZoom(e,t,i){const{coords:s,oldZoom:n}=this;let o=Ji(n);if(!s||!n)return e==="x"?o.x:o.y;const a=Xr(i,s.x1,s.y1),r=Xr(i,s.x2,s.y2);if(e==="x"){const c=(r.x-a.x)*Qi(n);return o.x.max+=c,o.x=$n(o.x,n.x,t,a.x),o=Do(o),o.x}const l=(r.y-a.y)*Wn(n);return o.y.max-=l,o.y=$n(o.y,n.y,t,a.y),o=Do(o),o.y}},{userInteraction:JA}=L,K8=class{constructor(e,t,i,s,n,o,a){this.eventsHub=e,this.contextMenuRegistry=t,this.zoomManager=i,this.getModuleProperties=s,this.getRect=n,this.updateZoom=o,this.isZoomValid=a}registerActions(e){const{contextMenuRegistry:t}=this,i=e?"show":"hide";if(t.toggle("zoom-to-cursor",i),t.toggle("pan-to-cursor",i),t.toggle("reset-zoom",i),!e)return;t.builtins.items["zoom-to-cursor"].action=this.onZoomToHere.bind(this),t.builtins.items["pan-to-cursor"].action=this.onPanToHere.bind(this),t.builtins.items["reset-zoom"].action=this.onResetZoom.bind(this);const s=a=>{const r=this.getRect();if(!r)return!0;const l=Xr(r,a.x,a.y);return this.iterateFindNextZoomAtPoint(l)!=null},n=()=>!bv(Ji(this.zoomManager.getZoom()),YA()),o=this.eventsHub.on("context-menu:setup",a=>{t.builtins.items["zoom-to-cursor"].enabled=s(a),t.builtins.items["pan-to-cursor"].enabled=n(),t.builtins.items["reset-zoom"].enabled=lF(this.zoomManager)});return()=>{o(),t.toggle("zoom-to-cursor","hide"),t.toggle("pan-to-cursor","hide"),t.toggle("reset-zoom","hide")}}computeOrigin(e){const t=this.getRect(),{enabled:i}=this.getModuleProperties();if(!i||!t||!e?.target||!(e instanceof MouseEvent))return;const s={x:0,y:0,width:t.width,height:t.height};return Xr(s,e.offsetX,e.offsetY)}onZoomToHere({event:e}){const t=this.computeOrigin(e);if(!t)return;const i=this.iterateFindNextZoomAtPoint(t);i!=null&&this.updateZoom(JA("contextmenu-zoom-to-cursor"),i)}onPanToHere({event:e}){const t=this.computeOrigin(e);if(!t)return;const i=Ji(this.zoomManager.getZoom()),s=Qi(i),n=Wn(i),o=t.x*s,a=t.y*n,r=Eh/2;let l={x:{min:t.x-r,max:t.x+r},y:{min:t.y-r,max:t.y+r}};l=rF(l,s,n),l=Ph(l,i.x.min-t.x+o,i.y.min-t.y+a),this.updateZoom(JA("contextmenu-pan-to-cursor"),Do(l))}onResetZoom(e){this.zoomManager.resetZoom(JA("contextmenu-reset"))}iterateFindNextZoomAtPoint(e){const{scrollingStep:t}=this.getModuleProperties();for(let i=t;i<=1-t;i+=t){const s=this.getNextZoomAtPoint(e,i);if(this.isZoomValid(s))return s}}getNextZoomAtPoint(e,t){const{isScalingX:i,isScalingY:s}=this.getModuleProperties(),n=Ji(this.zoomManager.getZoom()),o=e.x*Qi(n),a=e.y*Wn(n),r=Eh/2;let l={x:{min:e.x-r,max:e.x+r},y:{min:e.y-r,max:e.y+r}};return l=rF(l,i?Qi(n)*t:Eh,s?Wn(n)*t:Eh),l=Ph(l,n.x.min-e.x+o,n.y.min-e.y+a),Do(l)}},Y8=class{constructor(e){this.axesHandlers=e,this.axes=[],this.overlappingAxisIds=new Set}destroy(){for(const e of this.axes)e.div.destroy()}update(e,t,i,s,n){this.seriesRect=n;const o=!e||!t&&!i;for(const d of this.axes)d.div.setHidden(o);if(o)return;const{X:a,Y:r}=Jp,l=[...s.axisManager.getAxisContext(a),...s.axisManager.getAxisContext(r)],{removed:c,added:h}=this.diffAxisIds(l);c.length>0&&(this.axes=this.axes.filter(d=>c.includes(d.axisId)?(d.div.destroy(),this.overlappingAxisIds.delete(d.axisId),this.hoveredAxisId===d.axisId&&(this.hoveredAxisId=void 0),this.activeAxisId===d.axisId&&(this.activeAxisId=void 0),!1):!0));for(const d of h){const{axisId:u,direction:p}=d;this.axes.push(this.initAxis(s,u,this.axesHandlers,p))}for(const d of this.axes){const p=l.find(f=>f.axisId===d.axisId).getCanvasBounds();d.div.setHidden(u0(p)),p==null?d.bounds=void 0:(d.div.setBounds(p),d.bounds=new L.BBox(p.x,p.y,p.width,p.height))}this.updateOverlappingAxisPointerEvents(t,i)}setAxisCursor(e){this.cursor=e;for(const t of this.axes)t.div.setCursor(this.getCursor(t.direction))}toggleAxisDraggingCursor(e,t){for(const i of this.axes)i.direction===e&&i.div.setCursor(t?this.getCursor(e):void 0)}updateOverlappingAxisPointerEvents(e,t){this.overlappingAxisIds.clear();const i=(e||t)&&this.seriesRect;for(const s of this.axes){if(!i){s.div.setPointerEvents(void 0);continue}!!s.bounds?.collidesBBox(this.seriesRect)?(this.overlappingAxisIds.add(s.axisId),s.div.setPointerEvents("none")):s.div.setPointerEvents(void 0)}this.cleanupAxisState()}cleanupAxisState(){this.hoveredAxisId&&!this.overlappingAxisIds.has(this.hoveredAxisId)&&(this.hoveredAxisId=void 0),this.activeAxisId&&!this.overlappingAxisIds.has(this.activeAxisId)&&(this.activeAxisId=void 0)}pickAxisAtPoint(e,t){for(const i of this.axes)if(this.overlappingAxisIds.has(i.axisId)&&i.bounds?.containsPoint(e,t))return{axisId:i.axisId,direction:i.direction}}setHoveredAxis(e){this.overlappingAxisIds.has(e)&&(this.hoveredAxisId=e)}clearHoveredAxis(){this.activeAxisId||(this.hoveredAxisId=void 0)}beginDelegatedAxisDrag(e){return this.overlappingAxisIds.has(e)?(this.activeAxisId=e,this.hoveredAxisId=void 0,!0):!1}endDelegatedAxisDrag(e){this.activeAxisId===e&&(this.activeAxisId=void 0),this.hoveredAxisId=void 0}hasOverlappingAxes(){return this.overlappingAxisIds.size>0}getHoveredAxis(){if(!this.hoveredAxisId)return;const e=this.axes.find(t=>t.axisId===this.hoveredAxisId);return e?{axisId:e.axisId,direction:e.direction}:void 0}getCursor(e){return this.cursor?this.cursor:e==="x"?"ew-resize":"ns-resize"}initAxis(e,t,i,s){const n="afterend",o=e.proxyInteractionService.createProxyElement({type:"region",domManagerId:t,where:n});return o.setCursor(this.getCursor(s)),o.addListener("drag-start",a=>{a.device==="touch"&&a.sourceEvent.preventDefault(),this.activeAxisId=t,i.onAxisDragStart(s)}),o.addListener("drag-move",a=>i.onAxisDragMove(t,s,a)),o.addListener("drag-end",()=>{this.activeAxisId=void 0,this.hoveredAxisId=void 0,i.onAxisDragEnd()}),o.addListener("dblclick",()=>i.onAxisDoubleClick(t,s)),o.addListener("wheel",a=>i.onAxisWheel(s,a)),{axisId:t,div:o,direction:s}}diffAxisIds(e){const t=this.axes.map(o=>o.axisId),i=e.map(o=>o.axisId),s=t.filter(o=>!i.includes(o)),n=e.filter(o=>!t.includes(o.axisId));return{removed:s,added:n}}},{userInteraction:Z8}=L;function X8(e){return e.x.min===0&&e.x.max===1&&e.y.min===0&&e.y.max===1}function q8(e,t){return e.stickToEnd&&t.x.max===1}function pF(e,t,i){const{domainMin:s,domainMax:n}=t,o=n-s;return{axisId:e,visibleMin:s+o*i.min,visibleMax:s+o*i.max}}function gF(e,t){const{domainMin:i,domainMax:s}=e,{visibleMin:n,visibleMax:o}=t,a=s-i;return{direction:"x",min:ge(0,(n-i)/a,1),max:ge(0,(o-i)/a,1)}}var eC=class extends K{constructor(){super(...arguments),this.strategy="preserveDomain",this.stickToEnd=!1}};g([m],eC.prototype,"strategy",2),g([m],eC.prototype,"stickToEnd",2);var Q8=class{constructor(e,t,i,s){this.onConstrainChangesCallback=e,this.properties=t,this.ctx=i;const n=()=>{i.eventsHub.off("layout:complete",n),s.register(i.eventsHub.on("data:load",o=>this.onDataLoad(o)),i.eventsHub.on("data:update",o=>this.onDataUpdate(o)))};s.register(i.eventsHub.on("layout:complete",n),i.eventsHub.on("zoom:change-request",o=>this.onZoomChangeRequest(o)))}destroy(){}onDataLoad(e){this.performUpdateStrategy()}onDataUpdate(e){this.performUpdateStrategy()}onZoomChangeRequest(e){const t=this.popDesiredChanges();t&&(e.constrainChanges(t),this.onConstrainChangesCallback(e))}computeDomainMinMax(e){const t=this.ctx.axisManager.getAxisIdContext(e);if(!t?.continuous||t.scale.domain.length===0)return;const[i,s]=t.scale.getDomainMinMax();if(typeof i=="number"&&typeof s=="number")return{domainMin:i,domainMax:s};if(i instanceof Date&&s instanceof Date)return{domainMin:i.getTime(),domainMax:s.getTime()};j.error(`Unexpected range types: start (${typeof i}), end (${typeof s})`)}popDesiredChanges(){const{desiredChanges:e}=this;if(e)switch(this.desiredChanges=void 0,e.type){case"domain":{const i={};for(const s of e.domains){const n=this.computeDomainMinMax(s.axisId);n&&(i[s.axisId]=gF(n,s))}return i}case"stickToEnd":{const{axisId:i,difference:s}=e,n=this.computeDomainMinMax(i);if(n){const o={axisId:i,visibleMin:n.domainMax-s,visibleMax:n.domainMax};return{[i]:gF(n,o)}}break}default:return(i=>i)(e)}}performUpdateStrategy(){const e=Ji(this.ctx.zoomManager.getZoom());if(!X8(e)){if(q8(this.properties,e))return this.performStickToEnd();switch(this.properties.strategy){case"reset":return this.ctx.zoomManager.resetZoom(Z8("onDataChange-reset"));case"preserveRatios":return;case"preserveDomain":return this.performPreserveDomain();default:return(i=>i)(this.properties.strategy)}}}performPreserveDomain(){this.desiredChanges={type:"domain",domains:[]};const e=this.ctx.zoomManager.getAxes().filter(t=>t.direction==="x");for(const{id:t}of e){const i=this.computeDomainMinMax(t);if(i){const s=this.ctx.zoomManager.getAxisZoom(t),n=pF(t,i,s);this.desiredChanges.domains.push(n)}}}performStickToEnd(){const e=this.ctx.zoomManager.getPrimaryAxisId("x");if(!e)return;const t=this.computeDomainMinMax(e);if(!t)return;const i=this.ctx.zoomManager.getAxisZoom(e);if(!i)return;const{visibleMin:s,visibleMax:n}=pF(e,t,i),o=n-s;this.desiredChanges={type:"stickToEnd",axisId:e,difference:o}}},fF=16,J8={off:1,short:.01,long:.002},eQ=class{constructor(){this.deceleration=1,this.zoomCoordsHistoryIndex=0,this.coordsHistory=[]}get decelerationValue(){const{deceleration:e}=this;return Math.max(typeof e=="number"?e:J8[e]??1,1e-4)}addListener(e,t){return this.onUpdate=t,()=>{this.onUpdate=void 0}}stopInteractions(){this.inertiaHandle!=null&&(cancelAnimationFrame(this.inertiaHandle),this.inertiaHandle=void 0)}update(e){this.updateCoords(e.currentX,e.currentY);const{x1:t=0,y1:i=0,x2:s=0,y2:n=0}=this.coords??{};this.onUpdate?.({type:"update",deltaX:this.isPanningX()?t-s:0,deltaY:this.isPanningY()?i-n:0})}start(e){this.direction=e,this.coordsMonitorTimeout=setInterval(this.recordCurrentZoomCoords.bind(this),16)}stop(){const{coordsHistory:e}=this;let t=0,i=0,s=0;if(e.length>0){const n=this.zoomCoordsHistoryIndex%fF;let o=n-1;o<0&&(o=e.length-1);let a=n;a>=e.length&&(a=0);const r=e[o],l=e[a];t=this.isPanningX()?r.x-l.x:0,i=this.isPanningY()?r.y-l.y:0,s=r.t-l.t}if(this.coords=void 0,this.direction=void 0,clearInterval(this.coordsMonitorTimeout),this.coordsMonitorTimeout=void 0,this.zoomCoordsHistoryIndex=0,this.coordsHistory.length=0,s>0&&this.decelerationValue<1){const n=t/s,o=i/s,a=Math.hypot(n,o),r=Math.atan2(o,n),l=performance.now();this.inertiaHandle=Ve().requestAnimationFrame(c=>{this.animateInertia(c,c,l,a,r)})}}recordCurrentZoomCoords(){const{coords:e,coordsHistory:t,zoomCoordsHistoryIndex:i}=this;if(!e)return;const{x2:s,y2:n}=e,o=Date.now();t[i%fF]={x:s,y:n,t:o},this.zoomCoordsHistoryIndex+=1}animateInertia(e,t,i,s,n){const o=1-this.decelerationValue,a=-s/Math.log(o),r=s*(o**(t-i)-1)/Math.log(o),l=s*(o**(e-i)-1)/Math.log(o);this.onUpdate?.({type:"update",deltaX:this.isPanningX()?-Math.cos(n)*(l-r):0,deltaY:this.isPanningY()?-Math.sin(n)*(l-r):0}),!(l>=a-1)&&(this.inertiaHandle=requestAnimationFrame(c=>{this.animateInertia(c,e,i,s,n)}))}updateCoords(e,t){this.coords?this.coords={x1:this.coords.x2,y1:this.coords.y2,x2:e,y2:t}:this.coords={x1:e,y1:t,x2:e,y2:t}}isPanningX(){return this.direction==null||this.direction==="x"}isPanningY(){return this.direction==null||this.direction==="y"}translateZooms(e,t,i,s){const n=Xr(e,e.x+Math.abs(i),e.y+e.height-Math.abs(s)),o=Math.sign(i)*n.x,a=-Math.sign(s)*n.y,r={};for(const[l,c]of ht(t)){if(c==null||c.min===Mo&&c.max===qi)continue;const{direction:h}=c;let d=Ji({[h]:c});d=Do(Ph(d,o*Qi(d),a*Wn(d)));const{min:u,max:p}=d[h];r[l]={direction:h,min:u,max:p}}return r}},tQ=200,iQ=class{update(e,t,i,s){const n=e.deltaX*t*tQ;return this.translateZooms(i,s,n)}translateZooms(e,t,i){const s={},n=Xr(e,e.x+Math.abs(i),0),o=i<0?-n.x:n.x;for(const[a,r]of ht(t)){if(r?.direction!=="x")continue;const{direction:l,min:c,max:h}=r;let d=Ji({x:{min:c,max:h}});d=Do(Ph(d,o*Qi(d),0)),s[a]={direction:l,min:d.x.min,max:d.x.max}}return s}},sQ=class{updateAxes(e,t,i,s){const n=e.sourceEvent,o={},{anchorPointX:a,anchorPointY:r,isScalingX:l,isScalingY:c,scrollingStep:h}=t,d=Xr(i,n.offsetX??n.clientX,n.offsetY??n.clientY);for(const[u,p]of ht(s)){if(p==null)continue;const{direction:f,min:y,max:b}=p;let x={min:y,max:b};const v=h*e.deltaY*(b-y);if(f==="x"&&l)x.max+=v,x=$n(x,p,a,d.x);else if(f==="y"&&c)x.max+=v,x=$n(x,p,r,d.y);else continue;if(x.max<x.min)continue;const S=Mv(x);o[u]={direction:f,min:S.min,max:S.max}}return o}update(e,t,i,s){const{anchorPointX:n,anchorPointY:o,isScalingX:a,isScalingY:r,scrollingStep:l}=t,c=e.offsetX+i.x,h=e.offsetY+i.y,d=Xr(i,c,h),u=e.deltaY;let p=Ji(s);if(p.x.max+=a?l*u*Qi(s):0,p.y.max+=r?l*u*Wn(s):0,!(p.x.max<p.x.min||p.y.max<p.y.min))return a&&(p.x=$n(p.x,s.x,n,d.x)),r&&(p.y=$n(p.y,s.y,o,d.y)),p=Do(p),p}updateDelta(e,t,i){const{anchorPointX:s,anchorPointY:n,isScalingX:o,isScalingY:a,scrollingStep:r}=t;let l=Ji(i);return l.x.max+=o?r*-e*Qi(i):0,l.y.max+=a?r*-e*Wn(i):0,o&&(l.x=$n(l.x,i.x,s)),a&&(l.y=$n(l.y,i.y,n)),l=Do(l),l}},nQ=class{constructor(e,t,i){this.rect=e,this.getZoom=t,this.isZoomValid=i,this.rect.visible=!1}update(e,t,i){const s=e.currentX+(i?.x??0),n=e.currentY+(i?.y??0);this.rect.visible=!0,this.updateCoords(s,n,t,i),this.updateRect(i)}stop(e,t,i){let s=Ji();if(!e||!t)return s;this.coords&&(s=this.createZoomFromCoords(t,i));const n=t.width/e.width,o=t.height/e.height;if(s=Do(_8(s,n,o)),this.reset(),this.isZoomValid(s))return s}reset(){this.coords=void 0,this.rect.visible=!1}didUpdate(){return this.rect.visible&&this.rect.width>0&&this.rect.height>0}updateCoords(e,t,i,s){if(!this.coords){this.coords={x1:e,y1:t,x2:e,y2:t};return}const{coords:n}=this;if(n.x2=e,n.y2=t,!s)return;const{isScalingX:o,isScalingY:a,keepAspectRatio:r}=i,l=this.getNormalisedDimensions();if(r&&o&&a){const c=s.width/s.height;n.y2<n.y1?n.y2=Math.min(n.y1-l.width/c,n.y1):n.y2=Math.max(n.y1+l.width/c,n.y1)}o||(n.x1=s.x,n.x2=s.x+s.width),a||(n.y1=s.y,n.y2=s.y+s.height)}updateRect(e){if(!e)return;const{rect:t}=this,i=this.getNormalisedDimensions(),{width:s,height:n}=i;let{x:o,y:a}=i;o=Math.max(o,e.x),o-=Math.max(0,o+s-(e.x+e.width)),a=Math.max(a,e.y),a-=Math.max(0,a+n-(e.y+e.height)),t.x=o,t.y=a,t.width=s,t.height=n;const r=this.createZoomFromCoords(e,this.getZoom());this.isZoomValid(r)?t.updateValid():t.updateInvalid()}createZoomFromCoords(e,t){const i=Ji(t),s=this.getNormalisedDimensions(),n=Xr(e,s.x,s.y+s.height),o=s.width/e.width,a=s.height/e.height;let r=Sv(i,o,a);const l=n.x*Qi(i),c=n.y*Wn(i);return r=Ph(r,l,c),r=Do(r),r}getNormalisedDimensions(){const{x1:e=0,y1:t=0,x2:i=0,y2:s=0}=this.coords??{},n=Math.min(e,i),o=Math.min(t,s),a=e<=i?i-e:e-i,r=t<=s?s-t:t-s;return{x:n,y:o,width:a,height:r}}},{userInteraction:mF,NativeWidget:oQ,Toolbar:aQ}=L,tC=class extends Vo{};g([m],tC.prototype,"value",2),g([m],tC.prototype,"section",2);var gp=class extends K{constructor(e,t,i,s,n,o){super(),this.ctx=e,this.getModuleProperties=t,this.updateZoom=i,this.updateAxisZoom=s,this.resetZoom=n,this.isZoomValid=o,this.enabled=!1,this.buttons=new Pi(tC),this.visible="hover",this.verticalSpacing=10,this.detectionRange=38,this.cleanup=new pt,this.toggleButtonsDebounced=Np(this.toggleButtons.bind(this),oF,{leading:!0,trailing:!0}),this.container=new oQ(xe("div")),this.container.addClass("ag-charts-zoom-buttons"),e.domManager.addChild("canvas-overlay","zoom-buttons",this.container.getElement()),this.toolbar=new aQ(e,"ariaLabelZoomToolbar","horizontal"),this.container.addChild(this.toolbar),this.toolbar.getElement().style.transform="translateY(54px)",this.toolbar.setHidden(!this.enabled),this.toggleVisibility(this.visible==="always"),this.cleanup.register(this.toolbar.addToolbarListener("button-pressed",this.onButtonPress.bind(this)),this.toolbar.addToolbarListener("button-focused",this.onButtonFocus.bind(this)),e.widgets.containerWidget.addListener("mousemove",this.onHover.bind(this)),e.widgets.containerWidget.addListener("mouseleave",this.onLeave.bind(this)),e.eventsHub.on("layout:complete",this.onLayoutComplete.bind(this)),this.teardown.bind(this))}destroy(){this.cleanup.flush()}toggleVisibleZoomed(e){this.visible==="zoomed"&&this.toggleVisibility(!e)}teardown(){this.ctx.domManager.removeChild("canvas-overlay","zoom-buttons"),this.container.destroy()}onLayoutComplete(e){if(!this.enabled)return;const{buttons:t,container:i}=this,{rect:s}=e.series;for(const o of t)if(o.tooltip==null&&o.label==null){const a={"pan-end":"toolbarZoomPanEnd","pan-left":"toolbarZoomPanLeft","pan-right":"toolbarZoomPanRight","pan-start":"toolbarZoomPanStart","zoom-in":"toolbarZoomZoomIn","zoom-out":"toolbarZoomZoomOut",reset:"toolbarZoomReset"};o.tooltip=a[o.value]}this.toolbar.updateButtons(t),this.toggleButtonsDebounced();const n=i.getBounds().height;i.setBounds({y:s.y+s.height-n})}onHover(e){if(!this.enabled||this.visible!=="hover"||this.toolbar.isHidden())return;const{container:t,detectionRange:i,ctx:{scene:s}}=this,{currentY:n,sourceEvent:{target:o}}=e,a=t.getElement(),r=a.offsetTop-i,l=n>r&&n<s.canvas.element.offsetHeight||o===a;this.toggleVisibility(l)}onLeave(){this.visible==="hover"&&this.toggleVisibility(!1)}toggleVisibility(e,t=!1){const{container:i,toolbar:s,verticalSpacing:n}=this;s.toggleClass("ag-charts-zoom-buttons__toolbar--hidden",!e);const o=s.getElement();o.style.transitionDuration=t?"0s":"",o.style.transform=e?"translateY(0)":`translateY(${i.getBounds().height+n}px)`}toggleButtons(){const e=Ji(this.ctx.zoomManager.getZoom());if(!(this.previousZoom&&bv(this.previousZoom,e))){this.previousZoom=e;for(const[t,i]of this.buttons.entries()){let s=!0;switch(i?.value){case"pan-start":s=e.x.min>Mo;break;case"pan-end":s=e.x.max<qi;break;case"pan-left":s=e.x.min>Mo;break;case"pan-right":s=e.x.max<qi;break;case"zoom-out":s=!bv(e,YA());break;case"zoom-in":s=this.isZoomValid(this.getNextZoomStateUnified("zoom-in",e,this.getModuleProperties()));break;case"reset":s=lF(this.ctx.zoomManager);break}this.toolbar.toggleButtonEnabledByIndex(t,s)}}}onButtonPress({button:e}){if(!this.enabled||this.toolbar.isHidden())return;const t=this.getModuleProperties();if(t.independentAxes&&e.value!=="reset"){const i=this.ctx.zoomManager.getAxisZooms();for(const[s,n]of ht(i)){if(n==null)continue;const{direction:o,min:a,max:r}=n;this.onButtonPressAxis(e,t,s,o,{min:a,max:r})}}else this.onButtonPressUnified(e,t)}onButtonFocus(e){this.toggleVisibility(!0,!0)}onButtonPressAxis(e,t,i,s,n){const{isScalingX:o,isScalingY:a,scrollingStep:r}=t;let l={...n};const c=n.max-n.min;switch(e.value){case"pan-start":l.max=c,l.min=0;break;case"pan-end":l.min=l.max-c,l.max=qi;break;case"pan-left":l.min-=c*r,l.max-=c*r;break;case"pan-right":l.min+=c*r,l.max+=c*r;break;case"zoom-in":case"zoom-out":{const h=s==="x",d=h&&o||!h&&a;let u=e.value==="zoom-in"?1-r:1+r;d||(u=1);const p=h?this.getAnchorPointX(t):this.getAnchorPointY(t);l.max=l.min+(l.max-l.min)*u,l=$n(l,n,p);break}}this.updateAxisZoom(mF(`zoom-button-${e.value}`),i,s,Mv(l))}onButtonPressUnified(e,t){const{scrollingStep:i}=t,s=Ji(this.ctx.zoomManager.getZoom());let n=Ji(s);switch(e.value){case"reset":this.resetZoom("zoom-button-reset");return;case"pan-start":n.x.max=Qi(n),n.x.min=0;break;case"pan-end":n.x.min=qi-Qi(n),n.x.max=qi;break;case"pan-left":n=Ph(n,-Qi(n)*i,0);break;case"pan-right":n=Ph(n,Qi(n)*i,0);break;case"zoom-in":case"zoom-out":{n=this.getNextZoomStateUnified(e.value,s,t);break}}this.updateZoom(mF(`zoom-button-${e.value}`),Do(n))}getNextZoomStateUnified(e,t,i){const{isScalingX:s,isScalingY:n,scrollingStep:o}=i,a=e==="zoom-in"?1-o:1+o,r=Sv(t,s?a:1,n?a:1);return r.x=$n(r.x,t.x,this.getAnchorPointX(i)),r.y=$n(r.y,t.y,this.getAnchorPointY(i)),r}getAnchorPointX(e){const t=this.anchorPointX??e.anchorPointX;return t==="pointer"?sF:t}getAnchorPointY(e){const t=this.anchorPointY??e.anchorPointY;return t==="pointer"?nF:t}};g([m,He({changeValue(e){this.toolbar?.setHidden(!e)}})],gp.prototype,"enabled",2),g([m],gp.prototype,"buttons",2),g([m,He({changeValue(e,t){if(t==null)return;const i=e==="always",s=e==="zoomed"&&this.previousZoom!=null&&!vv(this.previousZoom);this.toggleVisibility(i||s)}})],gp.prototype,"visible",2),g([m],gp.prototype,"anchorPointX",2),g([m],gp.prototype,"anchorPointY",2);var Rh=1e6;function Dv({min:e,max:t},i,s,n){return n===0?0:Rh*((i-s)/n*(t-e)+e)}function rQ(e,t,i,s,n,o){[e,t]=[Math.min(e,t),Math.max(e,t)],[i,s]=[Math.min(i,s),Math.max(i,s)];const a=Rh*(i-n)/o,r=Rh*(s-n)/o,l=(i-n)/(s-n),c=(e-l*t)/(Rh-a+l*(r-Rh)),h=(t+(r-Rh)*c)/r;return{min:c,max:h}}function yF(e,t,i,s){t===0&&(t=30),s===0&&(s=30);const n=e-t,o=e+t,a=i-s,r=i+s;return!(o<a||r<n)}var lQ=class{constructor(){this.touchStart={origins:[{identifier:0,normalX:Number.NaN,normalY:Number.NaN},{identifier:0,normalX:Number.NaN,normalY:Number.NaN}]},this.initialZoom={x:{min:0,max:1},y:{min:0,max:1}},this.previous={a1:Number.NaN,a2:Number.NaN,b1:Number.NaN,b2:Number.NaN}}start(e,t,i){if(e.sourceEvent.targetTouches.length!==2)return!1;e.sourceEvent.preventDefault();const s=Array.from(e.sourceEvent.targetTouches),{x:n,y:o,width:a,height:r}=t.getBoundingClientRect();this.initialZoom.x.min=i.x?.min??0,this.initialZoom.x.max=i.x?.max??1,this.initialZoom.y.min=i.y?.min??0,this.initialZoom.y.max=i.y?.max??1;for(const f of this.touchStart.origins)f.identifier=0;this.previous.a1=Number.NaN,this.previous.a2=Number.NaN,this.previous.b1=Number.NaN,this.previous.b2=Number.NaN;for(const f of[0,1]){const y=s[f].clientX,b=o+r-s[f].clientY;this.touchStart.origins[f].identifier=s[f].identifier,this.touchStart.origins[f].normalX=Dv(this.initialZoom.x,y,n,a),this.touchStart.origins[f].normalY=Dv(this.initialZoom.y,b,o,r)}const[l,c]=s,[h,d]=this.touchStart.origins,u=yF(l.clientX,l.radiusX,c.clientX,c.radiusX);return yF(l.clientY,l.radiusY,c.clientY,c.radiusY)&&(h.normalY=d.normalY=(h.normalY+d.normalY)/2),u&&(h.normalX=d.normalX=(h.normalX+d.normalX)/2),!0}update(e,t){e.sourceEvent.preventDefault();const i=Array.from(e.sourceEvent.targetTouches),{x:s,y:n,width:o,height:a}=t.getBoundingClientRect(),{origins:r}=this.touchStart,l=[0,1].map(x=>i.find(v=>v.identifier===r[x].identifier)),c=r[0].normalX,h=r[1].normalX,d=l[0].clientX,u=l[1].clientX,p=r[0].normalY,f=r[1].normalY,y=n+a-l[0].clientY,b=n+a-l[1].clientY;return this.twitchTolerantZoomPan4(c,h,d,u,p,f,y,b,s,n,o,a)}end(e){const t=Array.from(e.sourceEvent.targetTouches).map(i=>i.identifier);return!t.includes(this.touchStart.origins[0].identifier)||!t.includes(this.touchStart.origins[1].identifier)}twitchTolerantZoomPan4(e,t,i,s,n,o,a,r,l,c,h,d){const{initialZoom:u,previous:p}=this,f=xF(e,t,i,s,p,"a1","a2",l,h,u.x),y=xF(n,o,a,r,p,"b1","b2",c,d,u.y);return{x:f,y}}};function xF(e,t,i,s,n,o,a,r,l,c){if(e==t){const h=Dv(c,i,r,l),d=Dv(c,s,r,l),u=(h+d)/2,p=(e-u)/Rh;return{min:c.min+p,max:c.max+p}}else{const h=n[o],d=n[a];return Math.abs(i-h)+Math.abs(s-d)<=1?(i=h,s=d):(n[o]=i,n[a]=s),rQ(e,t,i,s,r,l)}}var{userInteraction:Fh,InteractionState:Bf}=L,Iv=e=>ed(e,10),fp="zoom-cursor",_f="zoom-tooltip",ai=class extends bi{constructor(e){super(),this.ctx=e,this.enabled=!1,this.enableAxisDragging=!0,this.enableAxisScrolling=!0,this.enableDoubleClickToReset=!0,this.enablePanning=!0,this.enableScrolling=!0,this.enableSelecting=!1,this.enableTwoFingerZoom=!0,this.panKey="alt",this.axes="x",this.scrollingStep=Eh/10,this.keepAspectRatio=!1,this.minVisibleItems=2,this.anchorPointX=sF,this.anchorPointY=nF,this.autoScaling=new QA(s=>{this.autoScaler?.onChange(s)}),this.axisDraggingMode="zoom",this.buttons=new gp(this.ctx,this.getModuleProperties.bind(this),this.updateZoom.bind(this),this.updateAxisZoom.bind(this),this.resetZoom.bind(this),this.isZoomValid.bind(this)),this.onDataChange=new eC,this.axisDragger=new U8,this.panner=new eQ,this.scroller=new sQ,this.scrollPanner=new iQ,this.twoFingers=new lQ,this.deceleration="short",this.dragState=0,this.isState=s=>this.ctx.interactionManager.isState(s),this.destroyContextMenuActions=void 0,this.isFirstWheelEvent=!0,this.debouncedWheelReset=Np(()=>{this.isFirstWheelEvent=!0,this.wasFirstWheelEventZoomCapped=void 0},100),this.previousZoomValid=!0,this.previousAxisZoomValid={x:!0,y:!0},this.toggleAxisDraggingCursorsDebounced=Np(this.toggleAxisDraggingCursors.bind(this),oF,{leading:!0,trailing:!0}),this.autoScaler=new $8(this.autoScaling,e.zoomManager,this,e.eventsHub,this.cleanup);const t=new uF;this.selector=new nQ(t,this.getZoom.bind(this),this.isZoomValid.bind(this)),this.contextMenu=new K8(e.eventsHub,e.contextMenuRegistry,e.zoomManager,this.getModuleProperties.bind(this),()=>this.paddedRect,this.updateZoom.bind(this),this.isZoomValid.bind(this));const i=s=>{if(this.minVisibleItems>0){const n=s.stateAsDefinedZoom();s.constrainZoom(this.constrainZoom(n))}};this.dataChangeHandler=new Q8(i,this.onDataChange,this.ctx,this.cleanup),this.domProxy=new Y8({onAxisDragStart:s=>this.onAxisDragStart(s),onAxisDragMove:(s,n,o)=>this.onAxisDragMove(s,n,o),onAxisDragEnd:()=>this.onAxisDragEnd(),onAxisDoubleClick:s=>this.onAxisDoubleClick(s),onAxisWheel:(s,n)=>this.onAxisWheel(s,n)}),e.widgets.seriesDragInterpreter&&this.cleanup.register(e.widgets.seriesDragInterpreter.events.on("dblclick",s=>this.onSeriesAreaDoubleClick(s)),e.widgets.seriesDragInterpreter.events.on("drag-move",s=>this.onSeriesAreaDragMove(s)),e.widgets.seriesDragInterpreter.events.on("drag-start",s=>this.onSeriesAreaDragStart(s)),e.widgets.seriesDragInterpreter.events.on("drag-end",()=>this.onSeriesAreaDragEnd())),this.cleanup.register(e.scene.attachNode(t),e.eventsHub.on("series-area:hover",s=>this.onSeriesAreaHoverEvent(s)),e.eventsHub.on("series-area:click",s=>this.onSeriesAreaClickEvent(s)),e.eventsHub.on("series:keynav-zoom",s=>this.onNavZoom(s)),e.widgets.seriesWidget.addListener("wheel",s=>this.onWheel(s)),e.widgets.seriesWidget.addListener("touchstart",(s,n)=>this.onTouchStart(s,n)),e.widgets.seriesWidget.addListener("touchmove",(s,n)=>this.onTouchMove(s,n)),e.widgets.seriesWidget.addListener("touchend",s=>this.onTouchEnd(s)),e.widgets.seriesWidget.addListener("touchcancel",s=>this.onTouchEnd(s)),e.updateService.addListener("process-data",s=>this.onProcessData(s)),e.eventsHub.on("layout:complete",s=>this.onLayoutComplete(s)),e.eventsHub.on("zoom:change-request",s=>this.onZoomChangeRequested(s)),e.eventsHub.on("zoom:pan-start",s=>this.onZoomPanStart(s)),this.panner.addListener("update",s=>this.onPanUpdate(s)),()=>this.teardown())}teardown(){this.ctx.zoomManager.setZoomModuleEnabled(!1),this.buttons.destroy(),this.destroyContextMenuActions?.(),this.domProxy.destroy(),this.dataChangeHandler.destroy()}onEnabledChange(e){this.ctx.zoomManager.setZoomModuleEnabled(e),this.contextMenu&&(this.destroyContextMenuActions?.(),this.destroyContextMenuActions=this.contextMenu.registerActions(e))}isIgnoredTouch(e){return e?.device!=="touch"?!1:this.ctx.chartService.touch.dragAction!=="drag"?!0:this.enableSelecting?!1:this.enablePanning?vv(this.getZoom()):!0}onSeriesAreaDoubleClick(e){const{enabled:t,enableDoubleClickToReset:i}=this;!t||!i||e?.preventZoomDblClick||!this.isState(Bf.ZoomClickable)||this.resetZoom("zoom-seriesarea-dblclick")}onSeriesAreaHoverEvent(e){if(!this.shouldHandleAxisHover(e)){this.clearHoveredAxis();return}const t=this.domProxy.pickAxisAtPoint(e.x,e.y);t?(this.domProxy.setHoveredAxis(t.axisId),this.ctx.domManager.updateCursor(fp,this.domProxy.getCursor(t.direction))):this.clearHoveredAxis()}onSeriesAreaClickEvent(e){if(!this.shouldHandleAxisClick(e))return;const t=this.domProxy.pickAxisAtPoint(e.x,e.y);t&&e.sourceEvent?.type==="dblclick"&&this.onAxisDoubleClick(t.axisId)}shouldHandleAxisHover(e){const{enabled:t,enableAxisDragging:i,enableAxisScrolling:s,dragState:n}=this;return t&&(i||s)&&!e.consumed&&!this.activeAxis&&n===0&&this.domProxy.hasOverlappingAxes()}shouldHandleAxisClick(e){const{enabled:t,enableAxisDragging:i,enableAxisScrolling:s,enableDoubleClickToReset:n}=this;return t&&!this.activeAxis&&!e.consumed&&(i||s||n)}clearHoveredAxis(){this.activeAxis||(this.domProxy.clearHoveredAxis(),this.dragState===0&&this.ctx.domManager.updateCursor(fp))}tryBeginAxisDelegation(e){const t=this.domProxy.getHoveredAxis();if(!this.enabled||!this.enableAxisDragging||!t||!this.domProxy.beginDelegatedAxisDrag(t.axisId))return!1;this.activeAxis=t,this.onAxisDragStart(t.direction);const i=this.dragState===2?"grabbing":this.domProxy.getCursor(t.direction);return this.ctx.domManager.updateCursor(fp,i),e.device==="touch"&&e.sourceEvent.preventDefault(),!0}onSeriesAreaDragStart(e){const{enabled:t,enablePanning:i,enableSelecting:s,ctx:{domManager:n,zoomManager:o}}=this;if(!t||!this.isState(Bf.ZoomDraggable)||this.dragState!==0||this.isIgnoredTouch(e)||(this.panner.stopInteractions(),this.tryBeginAxisDelegation(e)))return;let a=0;const r=this.isPanningKeyPressed(e.sourceEvent);i&&(!s||r)?(n.updateCursor(fp,"grabbing"),a=2,this.panner.start()):s&&!r&&(a=3),(this.dragState=a)!==0&&o.fireZoomPanStartEvent("zoom")}onSeriesAreaDragMove(e){const{dragState:t,enabled:i,paddedRect:s,panner:n,selector:o,ctx:{interactionManager:a,tooltipManager:r,updateService:l}}=this;if(this.activeAxis){this.onAxisDragMove(this.activeAxis.axisId,this.activeAxis.direction,e);return}if(!(!i||!s||!this.isState(Bf.ZoomDraggable)||this.isIgnoredTouch(e))){switch(a.pushState(L.InteractionState.ZoomDrag),e.device==="touch"&&e.sourceEvent.preventDefault(),t){case 2:n.update(e);break;case 3:o.update(e,this.getModuleProperties(),s);break;case 0:return}r.updateTooltip(_f),l.update(4,{skipAnimations:!0})}}onSeriesAreaDragEnd(){const{ctx:{interactionManager:e}}=this;if(this.activeAxis){this.handleAxisDragEnd();return}e.popState(L.InteractionState.ZoomDrag),!(!this.enabled||this.dragState===0)&&(this.handleRegularDragEnd(),this.resetDragState())}handleAxisDragEnd(){this.onAxisDragEnd(),this.domProxy.endDelegatedAxisDrag(this.activeAxis.axisId),this.activeAxis=void 0,this.clearHoveredAxis()}handleRegularDragEnd(){const{panner:e,selector:t}=this;switch(this.dragState){case 2:e.stop();break;case 3:if(t.didUpdate()){const i=t.stop(this.seriesRect,this.paddedRect,this.getZoom());i?this.updateZoom(Fh("zoom-seriesarea-selector"),i):this.ctx.updateService.update()}break}}resetDragState(){this.dragState=0,this.ctx.domManager.updateCursor(fp),this.ctx.tooltipManager.removeTooltip(_f)}onAxisDoubleClick(e){const{enabled:t,enableDoubleClickToReset:i,ctx:{zoomManager:s}}=this;!t||!i||!this.isState(Bf.ZoomClickable)||(this.previousAxisZoomValid={x:!0,y:!0},s.resetAxisZoom({source:"user-interaction",sourceDetail:"zoom-axis-dblclick"},e))}onAxisDragStart(e){const{axisDraggingMode:t,domProxy:i,enabled:s,enableAxisDragging:n,panner:o,ctx:{zoomManager:a}}=this;!s||!n||(o.stopInteractions(),t==="pan"?(i.setAxisCursor("grabbing"),this.dragState=2,this.panner.start(e),a.fireZoomPanStartEvent("zoom")):this.dragState=1)}onAxisDragMove(e,t,i){const{anchorPointX:s,anchorPointY:n,axisDragger:o,dragState:a,enabled:r,enableAxisDragging:l,seriesRect:c,shouldFlipXY:h,ctx:{interactionManager:d,tooltipManager:u,updateService:p,zoomManager:f}}=this;if(!r||!l||!c)return;d.pushState(L.InteractionState.ZoomDrag),i.device==="touch"&&i.sourceEvent.preventDefault();const y=this.getZoom();if(a===2)this.panner.update({currentX:i.offsetX,currentY:i.offsetY});else{let b=t==="x"?s:n;h&&(b=t==="x"?n:s);const x=f.getAxisZoom(e),v=o.update(i,t,b,c,y,x);this.autoScaler.onManualAdjustment(t),this.updateAxisZoom(Fh("zoom-axis-drag"),e,t,v,{directional:!0})}u.updateTooltip(_f),p.update(4,{skipAnimations:!0})}onAxisDragEnd(){const{axisDraggingMode:e,axisDragger:t,dragState:i,domProxy:s,enabled:n,enableAxisDragging:o,ctx:{domManager:a,interactionManager:r,tooltipManager:l}}=this;r.popState(L.InteractionState.ZoomDrag),!(!n||!o||i===0)&&(this.dragState=0,e==="pan"&&(s.setAxisCursor("grab"),this.panner.stop()),t.stop(),a.updateCursor(fp),l.removeTooltip(_f))}onNavZoom(e){const{enabled:t,enableScrolling:i,scroller:s}=this;!this.ctx.interactionManager.isState(L.InteractionState.Default)||!t||!i||(e.widgetEvent.sourceEvent.preventDefault(),this.updateZoom(Fh(`keyboard(${e.delta})`),s.updateDelta(e.delta,this.getModuleProperties(),this.getZoom())))}onWheel(e){const{enabled:t,enablePanning:i,enableScrolling:s,paddedRect:n}=this;if(!t||!s||!n||!this.isState(Bf.ZoomWheelable))return;const{deltaX:o,deltaY:a}=e.sourceEvent,r=o!=null&&a!=null&&Math.abs(o)>Math.abs(a);i&&r?this.onWheelPanning(e):this.onWheelScrolling(e)}onWheelPanning(e){const{scrollingStep:t,scrollPanner:i,seriesRect:s,ctx:{zoomManager:n}}=this;if(!s)return;e.sourceEvent.preventDefault();const o=i.update(e,t,s,n.getAxisZooms());this.updateChanges(Fh("zoom-seriesarea-wheel"),o)}onWheelScrolling(e){const t=this.getZoom(),i=e.deltaY>0&&vv(t);this.handleWheelScrolling(e,i)}onAxisWheel(e,t){if(!this.enableAxisScrolling||e!=="x"&&e!=="y")return;const i=e==="x",s=!i,n=this.getModuleProperties({isScalingX:i,isScalingY:s}),o=this.getZoom(),a=t.deltaY>0&&o[e].min===Mo&&o[e].max===qi;this.autoScaler.onManualAdjustment(e),this.handleWheelScrolling(t,a,n)}handleWheelScrolling(e,t,i=this.getModuleProperties()){const{enableIndependentAxes:s,scroller:n,seriesRect:o,ctx:{zoomManager:a}}=this;if(!o)return;let r=!0;const l=Fh("zoom-axis-wheel");if(s===!0){const c=n.updateAxes(e,i,o,a.getAxisZooms());for(const[h,{direction:d,min:u,max:p}]of ht(c)){const f=d==="x"?this.constrainZoom({x:{min:u,max:p},y:{min:qi,max:qi}}).x:{min:u,max:p};r&&(r=this.updateAxisZoom(l,h,d,f))}}else{const c=n.update(e,i,o,this.getZoom());if(c==null)return;r=this.updateUnifiedZoom(l,c,{directional:!0})}t||(t=e.deltaY<0&&!r),this.firstWheelEventDirection!=null&&this.firstWheelEventDirection!==e.deltaY<0&&(this.isFirstWheelEvent=!0),this.isFirstWheelEvent?(this.wasFirstWheelEventZoomCapped=t,this.firstWheelEventDirection=e.deltaY<0,t||e.sourceEvent.preventDefault()):this.wasFirstWheelEventZoomCapped===!1&&e.sourceEvent.preventDefault(),this.isFirstWheelEvent=!1,this.debouncedWheelReset()}onTouchStart(e,t){!this.enableTwoFingerZoom||this.dragState!==0||this.twoFingers.start(e,t,this.getZoom())&&(this.dragState=4)}onTouchMove(e,t){if(!this.enableTwoFingerZoom||this.dragState!==4)return;const i=this.twoFingers.update(e,t);this.updateZoom(Fh("zoom-seriesarea-twofingers"),Do(i))}onTouchEnd(e){!this.enableTwoFingerZoom||this.dragState!==4||(e.sourceEvent.preventDefault(),this.twoFingers.end(e)&&(this.dragState=0))}onProcessData(e){this.shouldFlipXY=e.series.shouldFlipXY}onLayoutComplete(e){this.domProxy.update(this.enabled,this.enableAxisDragging,this.enableAxisScrolling,this.ctx,e.series.rect),this.enabled&&(this.seriesRect=e.series.rect,this.paddedRect=e.series.paddedRect,this.enableAxisDragging&&this.toggleAxisDraggingCursorsDebounced())}onZoomChangeRequested(e){e.sourceDetail!=="zoom-seriesarea-panner"&&this.panner.stopInteractions();const t=this.getZoom();this.buttons.toggleVisibleZoomed(vv(t))}onZoomPanStart(e){e.callerId==="zoom"&&this.panner.stopInteractions()}onPanUpdate(e){const{panner:t,seriesRect:i,ctx:{tooltipManager:s,zoomManager:n}}=this;if(!i)return;const o=t.translateZooms(i,n.getAxisZooms(),e.deltaX,e.deltaY);this.updateChanges(Fh("zoom-seriesarea-panner"),o),s.updateTooltip(_f)}isPanningKeyPressed(e){switch(this.panKey){case"alt":return e.altKey;case"ctrl":return e.ctrlKey;case"shift":return e.shiftKey;case"meta":return e.metaKey}}isScalingX(){return this.axes==="xy"?!0:this.shouldFlipXY?this.axes==="y":this.axes==="x"}isScalingY(){return this.axes==="xy"?!0:this.shouldFlipXY?this.axes==="x":this.axes==="y"}getAnchorPointX(){return this.shouldFlipXY?this.anchorPointY:this.anchorPointX}getAnchorPointY(){return this.shouldFlipXY?this.anchorPointX:this.anchorPointY}constrainZoom(e){return this.ctx.zoomManager.constrainZoomToItemCount(e,this.minVisibleItems,this.autoScaler.enabled)}isZoomValid(e,t){const{minVisibleItems:i,ctx:{zoomManager:s}}=this;if(i===0)return this.previousZoomValid=!0,!0;const n=this.getZoom(),o=Iv(Qi(e))<Iv(Qi(n)),a=Iv(Wn(e))<Iv(Wn(n));if(!o&&!a)return this.previousZoomValid=!0,!0;if(!this.previousZoomValid&&t?.directional)return!1;const r=t?.includeYVisibleRange??!1,l=this.autoScaler.enabled,c=s.isVisibleItemsCountAtLeast(e,i,{includeYVisibleRange:r,autoScaleYAxis:l});return this.previousZoomValid=t?.directional?c:!0,c}isAxisZoomValid(e,t,i){const{minVisibleItems:s,ctx:{zoomManager:n}}=this,o=this.getZoom(),a=t.max-t.min,r=o[e].max-o[e].min,l={...o,[e]:t};if(a>=r)return this.previousAxisZoomValid[e]=!0,!0;if(!this.previousAxisZoomValid[e]&&i?.directional)return!1;const c={includeYVisibleRange:!1,autoScaleYAxis:this.autoScaler.enabled},h=n.isVisibleItemsCountAtLeast(l,s,c);return this.previousAxisZoomValid[e]=i?.directional?h:!0,h}resetZoom(e){this.previousZoomValid=!0,this.previousAxisZoomValid={x:!0,y:!0},this.ctx.zoomManager.resetZoom({source:"user-interaction",sourceDetail:e})}updateSyncZoom(e){this.updateZoom({source:"sync",sourceDetail:"internal-updateSyncZoom"},e)}updateChanges(e,t){const i=this.ctx.zoomManager.toAxisZoomState(t)??{},s=Ji(this.ctx.zoomManager.getZoom());this.updateZoom(e,{x:i.x??s.x,y:i.y??s.y})}updateZoom(e,t){this.enableIndependentAxes?this.updatePrimaryAxisZooms(e,t):this.updateUnifiedZoom(e,t)}updateUnifiedZoom(e,t,i){return t=this.constrainZoom(t),this.isZoomValid(t,i)?(this.ctx.zoomManager.updateZoom(e,t),!0):(this.ctx.updateService.update(7,{skipAnimations:!0}),!1)}updatePrimaryAxisZooms(e,t){this.updatePrimaryAxisZoom(e,t,"x"),this.updatePrimaryAxisZoom(e,t,"y")}updatePrimaryAxisZoom(e,t,i){const s=this.ctx.zoomManager.getPrimaryAxisId(i);s!=null&&this.updateAxisZoom(e,s,i,t[i])}updateAxisZoom(e,t,i,s,n){const{enableIndependentAxes:o,ctx:{zoomManager:a}}=this;if(!s)return!1;const r=this.getZoom();if(o!==!0)return r[i]=s,this.updateUnifiedZoom(e,r,n);if(!this.isAxisZoomValid(i,s,n))return!1;const{source:l,sourceDetail:c}=e;return a.updateChanges({source:l,sourceDetail:c,changes:{[t]:s},isReset:!1}),!0}updateAxisCursor(e){if(!this.domProxy)return;const{enableAxisDragging:t=this.enableAxisDragging,enableAxisScrolling:i=this.enableAxisScrolling,axisDraggingMode:s=this.axisDraggingMode}=e;t?this.domProxy.setAxisCursor(s==="pan"?"grab":void 0):i?this.domProxy.setAxisCursor("default"):this.domProxy.setAxisCursor(void 0)}toggleAxisDraggingCursors(){const{anchorPointX:e,anchorPointY:t,domProxy:i}=this,s=this.getZoom();let n=Qi(s)!==Eh,o=Wn(s)!==Eh;if(!n){const a=Sv(s,.999,1);a.x=$n(a.x,s.x,e),n=this.isZoomValid(a,{includeYVisibleRange:!0})}if(!o){const a=Sv(s,1,.999);a.y=$n(a.y,s.y,t),o=this.isZoomValid(a,{includeYVisibleRange:!0})}i.toggleAxisDraggingCursor("x",n),i.toggleAxisDraggingCursor("y",o)}getZoom(){return Ji(this.ctx.zoomManager.getZoom())}getModuleProperties(e){return{anchorPointX:e?.anchorPointX??this.getAnchorPointX(),anchorPointY:e?.anchorPointY??this.getAnchorPointY(),enabled:e?.enabled??this.enabled,independentAxes:e?.independentAxes??this.enableIndependentAxes===!0,isScalingX:e?.isScalingX??this.isScalingX(),isScalingY:e?.isScalingY??this.isScalingY(),keepAspectRatio:e?.keepAspectRatio??this.keepAspectRatio,scrollingStep:e?.scrollingStep??this.scrollingStep}}};g([He({newValue(e){this.onEnabledChange(e)}}),m],ai.prototype,"enabled",2),g([He({changeValue(e){this.updateAxisCursor({enableAxisDragging:e})}}),m],ai.prototype,"enableAxisDragging",2),g([He({changeValue(e){this.updateAxisCursor({enableAxisScrolling:e})}}),m],ai.prototype,"enableAxisScrolling",2),g([m],ai.prototype,"enableDoubleClickToReset",2),g([He({changeValue(e){this.ctx.zoomManager.setIndependentAxes(!!e)}}),m],ai.prototype,"enableIndependentAxes",2),g([m],ai.prototype,"enablePanning",2),g([m],ai.prototype,"enableScrolling",2),g([m],ai.prototype,"enableSelecting",2),g([m],ai.prototype,"enableTwoFingerZoom",2),g([m],ai.prototype,"panKey",2),g([m],ai.prototype,"axes",2),g([m],ai.prototype,"scrollingStep",2),g([m],ai.prototype,"keepAspectRatio",2),g([m],ai.prototype,"minVisibleItems",2),g([m],ai.prototype,"anchorPointX",2),g([m],ai.prototype,"anchorPointY",2),g([m],ai.prototype,"autoScaling",2),g([He({changeValue(e){this.updateAxisCursor({axisDraggingMode:e})}}),m],ai.prototype,"axisDraggingMode",2),g([m],ai.prototype,"buttons",2),g([m],ai.prototype,"onDataChange",2),g([Bt("panner.deceleration"),m],ai.prototype,"deceleration",2);var kv=Z("pointer","start","middle","end"),mp={type:"plugin",name:"zoom",enterprise:!0,version:ue,options:{enabled:R,enableAxisDragging:R,enableAxisScrolling:R,enableDoubleClickToReset:R,enablePanning:R,enableScrolling:R,enableSelecting:R,enableTwoFingerZoom:R,keepAspectRatio:R,anchorPointX:kv,anchorPointY:kv,axisDraggingMode:Z("pan","zoom"),axes:Z("x","y","xy"),deceleration:Ae(Z("off","short","long"),ce),minVisibleItems:P,panKey:Z("alt","ctrl","meta","shift"),scrollingStep:ce,autoScaling:{enabled:R,padding:ce},onDataChange:{strategy:Mm()("reset","preserveDomain","preserveRatios"),stickToEnd:R},buttons:{enabled:R,buttons:Ft({...er,value:Z("reset","zoom-in","zoom-out","pan-left","pan-right","pan-start","pan-end"),section:N},"zoom button options array"),visible:Z("always","zoomed","hover")}},themeTemplate:{enabled:!1,enableAxisDragging:!0,enableAxisScrolling:!0,enableDoubleClickToReset:!0,enablePanning:!0,enableScrolling:!0,enableSelecting:!1,enableTwoFingerZoom:!0,deceleration:"short",minVisibleItems:2,panKey:"alt",scrollingStep:.1,autoScaling:{enabled:{$and:[{$eq:[{$path:"../axes"},"x"]},{$not:{$eq:[{$path:"/series/0/direction"},"horizontal"]}}]},padding:.05},onDataChange:{strategy:"preserveDomain",stickToEnd:!1},anchorPointX:"end",anchorPointY:"middle",axes:"x",buttons:{enabled:{$path:"../enabled"},visible:"hover",buttons:[{icon:"zoom-out",value:"zoom-out",section:"scale"},{icon:"zoom-in",value:"zoom-in",section:"scale"},{icon:"pan-left",value:"pan-left",section:"pan"},{icon:"pan-right",value:"pan-right",section:"pan"},{icon:"reset",value:"reset",section:"reset"}]}},create:e=>new ai(e)};mp.options.enableIndependentAxes=ee(R),mp.options.buttons.anchorPointX=ee(kv),mp.options.buttons.anchorPointY=ee(kv);function Vf(e,t,i){return as(e.chartService,t,i)}var{AxisInterval:cQ,AxisLabel:hQ,LinearScale:dQ,BBox:uQ,TranslatableGroup:pQ,Selection:gQ,Text:fQ}=L,Av=class gL{constructor(t,i){this.ctx=t,this.dataProvider=i,this.id=Mi(this),this.axisGroup=new pQ({name:`${this.id}-AxisTicks`,zIndex:3}),this.labelSelection=gQ.select(this.axisGroup,fQ),this.interval=new cQ,this.label=new hQ,this.scale=new dQ,this.placement="bottom",this.translationX=0,this.translationY=0,this.padding=0}get horizontal(){return this.placement.startsWith("top")||this.placement.startsWith("bottom")}attachAxis(t){t.appendChild(this.axisGroup)}calculateLayout(){const{placement:t,translationX:i,translationY:s,horizontal:n,label:o}=this;function a(u){}let r,l;switch(t){case"top":case"top-right":case"top-left":r="bottom",l="center",o.mirrored=!1,o.parallel=!0;break;case"bottom":case"bottom-right":case"bottom-left":r="top",l="center",o.mirrored=!1,o.parallel=!0;break;case"right":case"right-top":case"right-bottom":case"left":case"left-top":case"left-bottom":r="middle",l="left",o.mirrored=!0,o.parallel=!1;break;default:}const c=[],h=this.generateTicks(),{ticks:d}=h;return this.labelSelection.update(d,void 0,u=>u.tickId),this.axisGroup.setProperties({translationX:i,translationY:s}),this.labelSelection.each((u,p)=>{u.fontFamily=o.fontFamily,u.fontSize=o.fontSize,u.fontStyle=o.fontStyle,u.fontWeight=o.fontWeight,u.fill=o.color,u.textBaseline=r,u.textAlign=l,u.text=p.tickLabel,u.x=n?p.translation:0,u.y=n?0:p.translation,c.push(u.getBBox())}),c.length>0?uQ.merge(c).translate(i,s):void 0}tickFormatter(t,i,s,n){const{ctx:o}=this,{formatManager:a}=o,r=this.dataProvider.data.flatMap(l=>l.series);return(l,c)=>{const h={type:"number",value:l,datum:void 0,seriesId:void 0,legendItemName:void 0,key:void 0,source:"gradient-legend",property:"color",domain:t,boundSeries:r,fractionDigits:n};return this.label.formatValue((d,u)=>Vf(o,d,u),h,c)??a.format((d,u)=>Vf(o,d,u),h)??a.defaultFormat(h)}}inRange(t,i=.001){const[s,n]=Tt(this.scale.range);return t>=s-i&&t<=n+i}generateTicks(){const{minSpacing:t,maxSpacing:i}=this.interval,{maxTickCount:s,minTickCount:n,tickCount:o}=wy(da(this.scale.range),1,t,i,gL.DefaultTickCount,gL.DefaultMinSpacing),a=this.getTicksData({nice:[!0,!0],interval:this.interval.step,tickCount:o,minTickCount:n,maxTickCount:s});if(this.placement==="bottom"||this.placement==="top"){const r=Ze(this.label),{domain:l}=this.scale,h=l[0]>l[1]?-1:1;let d=-1/0*h;a.ticks=a.ticks.filter(u=>{if(Math.sign(u.translation-d)!==h)return!1;const{width:p}=Ce(u.tickLabel)?Ks(u.tickLabel,this.label):r.measureLines(Dt(u.tickLabel));return d=u.translation+p*h,!0})}return a}getTicksData(t){const i=[],s=t.nice?this.scale.niceDomain(t):this.scale.domain,n=this.scale.ticks(t,s)?.ticks??[],o=n.reduce((l,c)=>Math.max(l,vc(c)),0),a=Sg(),r=this.tickFormatter(s,n,!1,o);for(let l=0;l<n.length;l++){const c=n[l],h=this.scale.convert(c);if(!this.inRange(h))continue;const d=r(c,l);if(d==null||d==="")continue;const u=a(Pe(d));i.push({tick:c,tickId:u,tickLabel:d,translation:h})}return{rawTicks:n,fractionDigits:o,ticks:i}}};Av.className="AxisTicks",Av.DefaultTickCount=5,Av.DefaultMinSpacing=10;var mQ=Av,{LayoutElement:yQ,Group:xQ,Rect:bF,Marker:bQ,TranslatableGroup:vQ,BBox:iC}=L,sC=class extends K{constructor(){super(...arguments),this.thickness=16,this.preferredLength=100}};g([m],sC.prototype,"thickness",2),g([m],sC.prototype,"preferredLength",2);var Cv=class extends K{constructor(e){super(),this.axisTicks=e}};g([Bt("axisTicks.label")],Cv.prototype,"label",2),g([Bt("axisTicks.interval")],Cv.prototype,"interval",2),g([Bt("axisTicks.padding")],Cv.prototype,"padding",2);var Un=class extends K{constructor(e){super(),this.ctx=e,this.id=Mi(this),this.legendGroup=new vQ({name:"legend",zIndex:16}),this.containerNode=this.legendGroup.appendChild(new bF({name:"legend-container"})),this.gradientRect=new bF,this.arrow=new bQ({shape:"triangle"}),this.ticksGroup=new xQ({name:"legend-axis-group"}),this.cleanup=new pt,this.enabled=!1,this.position="bottom",this.reverseOrder=!1,this.gradient=new sC,this.spacing=20,this.border=new cr(this.containerNode),this.cornerRadius=0,this.fillOpacity=1,this.padding=4,this.data=[],this.highlightManager=e.highlightManager,this.axisTicks=new mQ(e,this),this.axisTicks.attachAxis(this.ticksGroup),this.scale=new Cv(this.axisTicks),this.legendGroup.append([this.gradientRect,this.arrow,this.ticksGroup]),this.cleanup.register(e.eventsHub.on("highlight:change",()=>this.onChartHoverChange()),e.layoutManager.registerElement(yQ.Legend,t=>this.onStartLayout(t)),()=>this.legendGroup.remove())}isVertical(){const{placement:e}=ll(this.position);return e.startsWith("right")||e.startsWith("left")}destroy(){this.cleanup.flush()}attachLegend(e){e.appendChild(this.legendGroup)}onStartLayout({layoutBox:e}){const[t]=this.data;if(!this.enabled||!t?.enabled||t.legendType!=="gradient"){this.legendGroup.visible=!1;return}const{colorRange:i}=this.normalizeColorArrays(t),{strokeWidth:s,padding:n}=this.getContainerStyles(),o=this.updateGradientRect(e,i),a=this.updateAxis(t,o)??new iC(0,0,0,0),r=iC.merge([o,a]);r.grow(n).grow(s);const{left:l,top:c}=this.getMeasurements(e,r);this.updateContainer(r),this.updateArrow(),this.legendGroup.visible=!0,this.legendGroup.translationX=l,this.legendGroup.translationY=c}normalizeColorArrays(e){let t=e.colorDomain.slice();const i=e.colorRange.slice();if(t.length===i.length)return{colorDomain:t,colorRange:i};t.length>i.length&&i.splice(t.length);const[s,n]=t,o=i.length;return t=i.map((a,r)=>r===0?s:r===o-1?n:s+(n-s)*r/(o-1)),{colorDomain:t,colorRange:i}}updateGradientRect(e,t){const{gradientRect:i,gradient:s}=this,{preferredLength:n,thickness:o}=s,a=new iC(0,0,0,0),r=Math.max(t.length-1,1);let l;return this.isVertical()?(l=0,a.width=o,a.height=Math.min(e.height,n)):(l=90,a.width=Math.min(e.width,n),a.height=o),i.x=a.x,i.y=a.y,i.width=a.width,i.height=a.height,i.fill={type:"gradient",gradient:"linear",colorSpace:"oklch",colorStops:t.map((c,h)=>({stop:h/r,color:c})),rotation:l},a}updateAxis(e,t){const{axisTicks:i,gradient:s,scale:n}=this,{placement:o}=ll(this.position),a=this.isVertical(),r=this.reverseOrder!==a;i.placement=o;const l=s.thickness+(n.padding??0);return i.translationX=a?l:t.x,i.translationY=a?t.y:l,i.scale.domain=r?e.colorDomain.slice().reverse():e.colorDomain,i.scale.range=a?[t.x,t.height]:[t.y,t.width],i.calculateLayout()}updateContainer(e){const t=this.getContainerStyles();this.containerNode.setStyleProperties(t),this.containerNode.cornerRadius=t.cornerRadius,this.containerNode.x=e.x,this.containerNode.y=e.y,this.containerNode.width=e.width,this.containerNode.height=e.height}updateArrow(){const e=this.highlightManager.getActiveHighlight(),{arrow:t}=this;if(e?.colorValue==null){t.visible=!1;return}const{scale:i,label:s}=this.axisTicks,n=s.fontSize??0,o=i.convert(e.colorValue);let{x:a,y:r}=this.gradientRect,l=Math.PI;this.isVertical()?(a-=n/2,r+=o,l/=2):(a+=o,r-=n/2),t.visible=!0,t.fill=s.color,t.rotation=l,t.size=n,t.translationX=a,t.translationY=r}getMeasurements(e,t){function i(u){}let{x:s,y:n}=e;const{width:o,height:a}=t,{placement:r,floating:l,xOffset:c,yOffset:h}=ll(this.position),d=this.getContainerStyles();switch(s+=d.strokeWidth+d.padding.left,n+=d.strokeWidth+d.padding.top,r){case"left":n+=e.height/2-a/2;break;case"right":s+=e.width-o,n+=e.height/2-a/2;break;case"top":s+=e.width/2-o/2;break;case"bottom":s+=e.width/2-o/2,n+=e.height-a;break;case"right-top":case"top-right":s+=e.width-o;break;case"right-bottom":case"bottom-right":s+=e.width-o,n+=e.height-a;break;case"left-bottom":case"bottom-left":n+=e.height-a;break;case"left-top":case"top-left":break;default:}if(!l)switch(r){case"left":case"left-top":case"left-bottom":e.shrink(o+this.spacing,"left");break;case"right":case"right-top":case"right-bottom":e.shrink(o+this.spacing,"right");break;case"top":case"top-left":case"top-right":e.shrink(a+this.spacing,"top");break;case"bottom":case"bottom-left":case"bottom-right":e.shrink(a+this.spacing,"bottom");break;default:}return s+=c,n+=h,{top:n,left:s}}getContainerStyles(){const{stroke:e,strokeOpacity:t,strokeWidth:i}=this.border,{cornerRadius:s,fill:n,fillOpacity:o,padding:a}=this,r=typeof a=="number";return{cornerRadius:s,fill:n,fillOpacity:o,padding:{top:r?a:a.top??0,right:r?a:a.right??0,bottom:r?a:a.bottom??0,left:r?a:a.left??0},stroke:e,strokeOpacity:t,strokeWidth:this.border.enabled?i:0}}onChartHoverChange(){this.enabled&&this.updateArrow()}};Un.className="GradientLegend",g([m],Un.prototype,"enabled",2),g([m],Un.prototype,"position",2),g([m],Un.prototype,"reverseOrder",2),g([m],Un.prototype,"gradient",2),g([m],Un.prototype,"spacing",2),g([m],Un.prototype,"border",2),g([m],Un.prototype,"cornerRadius",2),g([m],Un.prototype,"fill",2),g([m],Un.prototype,"fillOpacity",2),g([m],Un.prototype,"padding",2),g([m],Un.prototype,"scale",2);var Lv={type:"plugin",name:"gradientLegend",enterprise:!0,version:ue,options:{enabled:R,position:dd,spacing:P,reverseOrder:R,border:rl,cornerRadius:W,padding:al,fill:ks,fillOpacity:ce,gradient:{preferredLength:P,thickness:P},scale:{label:{...Ke,minSpacing:P,format:nn,formatter:ct},padding:P,interval:{step:W,values:sn,minSpacing:Ue(P,ss("maxSpacing")),maxSpacing:Ue(P,ns("minSpacing"))}}},themeTemplate:{...L.LEGEND_CONTAINER_THEME,enabled:!1,position:"bottom",spacing:20,scale:{padding:13,label:{color:{$ref:"textColor"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},minSpacing:5},interval:{minSpacing:15}},gradient:{preferredLength:100,thickness:16},reverseOrder:!1,fill:{$applySwitch:[{$path:"type"},{$ref:"chartBackgroundColour"},["gradient",L.FILL_GRADIENT_BLANK_DEFAULTS],["pattern",L.FILL_PATTERN_BLANK_DEFAULTS],["image",L.FILL_IMAGE_BLANK_DEFAULTS]]}},create:e=>{const t=new Un(e);return t.attachLegend(e.scene),t}},{OrdinalTimeScale:SQ,ApproximateOrdinalTimeScale:MQ,APPROXIMATE_THRESHOLD:DQ,TimeAxisParentLevel:IQ,minimumTimeAxisDatumGranularity:kQ}=L,wv=class extends L.DiscreteTimeAxis{constructor(e){const t=new SQ;super(e,t),this.parentLevel=new IQ,this.accurateScale=t,this.approximateScale=new MQ,this.approximateScale.setSourceScale(t),Object.defineProperty(this,"scale",{get:()=>this.getActiveScale(),configurable:!0})}get primaryLabel(){return this.parentLevel.enabled?this.parentLevel.label:void 0}get primaryTick(){return this.parentLevel.enabled?this.parentLevel.tick:void 0}getActiveScale(){const e=this.accurateScale.bandCount(this.visibleRange);return(this.accurateScale.getUniformityCache(this.visibleRange)?.isUniform??!1)&&e>=DQ?this.approximateScale:this.accurateScale}processData(){super.processData();const{boundSeries:e,direction:t}=this;this.minimumTimeGranularity=kQ(e,t,void 0,void 0)}tickFormatParams(e,t,i,s){s??(s=bg(t));const n=vg(e),o=ro(s),a=Fo(s),r=Sl(s);return{type:"date",unit:o,step:a,epoch:r,truncateDate:n}}datumFormatParams(e,t,i,s,n){if(typeof e=="number"&&(e=new Date(e)),s==null){const{minimumTimeGranularity:b}=this,x=$d(e);b!=null&&rs(b)<rs(x)?s=b:s=x}const{datum:o,seriesId:a,legendItemName:r,key:l,source:c,property:h,domain:d,boundSeries:u}=t,p=ro(s),f=Fo(s),y=Sl(s);return{type:"date",value:e,datum:o,seriesId:a,legendItemName:r,key:l,source:c,property:h,domain:d,boundSeries:u,unit:p,step:f,epoch:y,style:n}}};wv.className="OrdinalTimeAxis",wv.type="ordinal-time",g([m],wv.prototype,"parentLevel",2);var nC={type:"axis",name:"ordinal-time",chartType:"cartesian",enterprise:!0,version:ue,options:L.ordinalTimeAxisOptionsDefs,themeTemplate:{groupPaddingInner:0,label:{autoRotate:!1,minSpacing:40},gridLine:{enabled:!1},interval:{placement:"between"}},create:e=>new wv(e)},vF=[J2,nC].flat(),yp={$eq:[{$path:["/series/0/direction",void 0]},"horizontal"]},SF={autoRotate:{$path:"/series/0/stageLabel/autoRotate"},autoRotateAngle:{$path:"/series/0/stageLabel/autoRotateAngle"},avoidCollisions:{$path:["/series/0/stageLabel/avoidCollisions",!0]},border:{$path:["/series/0/stageLabel/border"]},color:{$path:["/series/0/stageLabel/color",{$ref:"textColor"}]},cornerRadius:{$path:["/series/0/stageLabel/cornerRadius"]},enabled:{$if:[{$eq:[{$path:"/series/0/stageLabel/enabled"},void 0]},!0,{$path:"/series/0/stageLabel/enabled"}]},fill:{$path:["/series/0/stageLabel/fill"]},fillOpacity:{$path:["/series/0/stageLabel/fillOpacity"]},fontSize:{$path:["/series/0/stageLabel/fontSize",{$ref:"fontSize"}]},fontStyle:{$path:["/series/0/stageLabel/fontStyle",{$ref:"fontStyle"}]},fontWeight:{$path:["/series/0/stageLabel/fontWeight",{$ref:"fontWeight"}]},format:{$path:"/series/0/stageLabel/format"},formatter:{$path:"/series/0/stageLabel/formatter"},itemStyler:{$path:"/series/0/stageLabel/itemStyler"},minSpacing:{$path:"/series/0/stageLabel/minSpacing"},padding:{$path:["/series/0/stageLabel/padding"]},rotation:{$path:["/series/0/stageLabel/rotation",0]}},MF={y:{type:{$if:[yp,"number","category"]},position:{$if:[yp,"left",{$if:[{$eq:[{$path:["/series/0/stageLabel/placement",void 0]},"after"]},"right","left"]}]},label:{$if:[yp,void 0,SF]}},x:{type:{$if:[yp,"category","number"]},position:{$if:[yp,{$if:[{$eq:[{$path:["/series/0/stageLabel/placement",void 0]},"before"]},"top","bottom"]},"bottom"]},label:{$if:[yp,SF,void 0]}}},AQ={series:{direction:"vertical",strokeWidth:{$isUserOption:["./strokes/0",2,0]},spacingRatio:.25,fills:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},[{$path:["/0",void 0,{$palette:"fills"}]}],{$applySwitch:[{$path:["/type",void 0,{$value:"$1"}]},{$value:"$1"},["gradient",L.FILL_GRADIENT_LINEAR_SINGLE_DEFAULTS],["pattern",L.FILL_PATTERN_SINGLE_DEFAULTS],["image",L.FILL_IMAGE_DEFAULTS]]}]},strokes:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},[{$path:["/0",void 0,{$palette:"strokes"}]}]]},label:{...L.LABEL_BOXING_DEFAULTS,enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"chartBackgroundColor"}},dropOff:{enabled:!0,fillOpacity:.2,strokeWidth:{$isUserOption:["./stroke",2,0]}},shadow:{enabled:!1,color:fa,xOffset:3,yOffset:3,blur:5},highlight:{unhighlightedItem:{opacity:.6}}},axes:{number:{nice:!1,gridLine:{enabled:!1},crosshair:{enabled:!1},label:{enabled:!1}},category:{line:{enabled:!1}}}},{NODE_UPDATE_STATE_TO_PHASE_MAPPING:CQ}=L;function DF(e,t,i,s){const{x0:n,y0:o,x1:a,y1:r,x2:l,y2:c,x3:h,y3:d,opacity:u}=e;return i?{x0:(n+h)/2,y0:(o+d)/2,x1:(a+l)/2,y1:(r+c)/2,x2:(a+l)/2,y2:(r+c)/2,x3:(n+h)/2,y3:(o+d)/2,opacity:u}:{x0:(n+a)/2,y0:(o+r)/2,x1:(n+a)/2,y1:(o+r)/2,x2:(l+h)/2,y2:(c+d)/2,x3:(l+h)/2,y3:(c+d)/2,opacity:u}}function LQ(e,t){const i=o=>o==null;return{fromFn:(o,a,r)=>{r==="updated"&&i(a)?r="removed":r==="updated"&&i(o.previousDatum)&&(r="added");let l;r==="added"&&o.previousDatum==null&&t==="fade"?l={...Gf(o,a),opacity:0}:r==="unknown"||r==="added"?l=DF(a,o.previousDatum,e,t):l={x0:o.x0,y0:o.y0,x1:o.x1,y1:o.y1,x2:o.x2,y2:o.y2,x3:o.x3,y3:o.y3,opacity:o.opacity};const c=CQ[r];return{...l,phase:c}},toFn:(o,a,r)=>{let l;return r==="removed"&&o.datum==null&&t==="fade"?l={...Gf(o,a),opacity:0}:r==="removed"||i(a)?l=DF(a,o.previousDatum,e,t):l=Gf(o,a),l}}}function Gf(e,t){const{x0:i,y0:s,x1:n,y1:o,x2:a,y2:r,x3:l,y3:c,opacity:h}=t;return{x0:i,y0:s,x1:n,y1:o,x2:a,y2:r,x3:l,y3:c,opacity:h}}var{SeriesNodePickMode:IF,valueProperty:wQ,keyProperty:TQ,updateLabelNode:NQ,SMALLEST_KEY_INTERVAL:OQ,LARGEST_KEY_INTERVAL:EQ,diff:PQ,fixNumericExtent:RQ,seriesLabelFadeInAnimation:kF,resetMotion:FQ,resetLabelFn:zQ,animationValidation:BQ,computeBarFocusBounds:_Q,ContinuousScale:VQ,Group:GQ,Selection:HQ,PointerEvents:AF,motion:jQ,checkCrisp:WQ,createDatumId:$Q}=L,UQ=class extends L.SeriesNodeEvent{constructor(e,t,i,s){super(e,t,i,s),this.xKey=s.properties.stageKey,this.yKey=s.properties.valueKey}},CF=class extends L.AbstractBarSeries{constructor({moduleCtx:e,animationResetFns:t}){super({moduleCtx:e,pickModes:[IF.AXIS_ALIGNED,IF.EXACT_SHAPE_MATCH],propertyKeys:{x:["stageKey"],y:["valueKey"]},propertyNames:{x:[],y:[]},categoryKey:"xValue",datumSelectionGarbageCollection:!1,animationResetFns:{datum:t.datum,label:zQ}}),this.NodeEvent=UQ,this.connectorNodeGroup=this.contentGroup.appendChild(new GQ({name:`${this.id}-series-connectorNodes`,zIndex:0})),this.connectorSelection=HQ.select(this.connectorNodeGroup,()=>this.connectionFactory()),this.connectorNodeGroup.pointerEvents=AF.None}get pickModeAxis(){return"main-category"}setZIndex(e){return super.setZIndex(e),this.connectorNodeGroup.zIndex=[0,e],!0}isVertical(){return!super.isVertical()}connectionFactory(){return new Ea}getKeyAxis(e){if(e==="x")return this.properties.xKeyAxis;if(e==="y")return this.properties.yKeyAxis}async processData(e){const{stageKey:t,valueKey:i}=this.properties,{visible:s,id:n}=this,o=(f,y,b)=>s&&this.ctx.legendManager.getItemEnabled({seriesId:n,itemId:b}),a=this.getCategoryAxis()?.scale,r=this.getValueAxis()?.scale,{isContinuousX:l,xScaleType:c,yScaleType:h}=this.getScaleInformation({xScale:a,yScale:r}),d=[];this.needsDataModelDiff()&&this.processedData&&d.push(PQ(this.id,this.processedData)),this.ctx.animationManager.isSkipped()||d.push(BQ());const u=this.visible?{}:{forceValue:0},{processedData:p}=await this.requestDataModel(e,this.data,{props:[TQ(t,c,{id:"xValue"}),wQ(i,h,{id:"yValue",...u,validation:o,invalidValue:0}),...l?[OQ,EQ]:[],...d],groupByKeys:!1});this.smallestDataInterval=p.reduced?.smallestKeyInterval,this.largestDataInterval=p.reduced?.largestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(e){const{processedData:t,dataModel:i,id:s,ctx:{legendManager:n}}=this;if(!t||!i)return{domain:[]};const{keys:[o]}=t.domain;if(e===this.getCategoryDirection()){const a=i.resolveProcessedDataDefById(this,"xValue");if(a?.def.type==="key"&&a?.def.valueType==="category"){if(!this.hasData)return{domain:[]};const r=o.filter((c,h)=>n.getItemEnabled({seriesId:s,itemId:h})),l=i.getKeySortMetadata(this,"xValue",t);return{domain:r,sortMetadata:l}}return{domain:this.padBandExtent(o)}}else{const a=this.domainForClippedRange(e,["yValue"],"xValue"),r=Math.max(...a),l=[-r,r];return{domain:RQ(l)}}}getSeriesRange(e,t){return[Number.NaN,Number.NaN]}createNodeData(){const{hasData:e,data:t,dataModel:i,groupScale:s,processedData:n,id:o,ctx:{legendManager:a}}=this,r=this.getCategoryAxis(),l=this.getValueAxis();if(!(e&&t&&r&&l&&i&&n?.type==="ungrouped"))return;const c=r.scale,h=l.scale,d=this.getBarDirection()==="x",{stageKey:u,valueKey:p}=this.properties,f=`${p}`,y={itemId:f,nodeData:[],labelData:[],connectorData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible},b=this.visible;if(!b)return y;const x=i.resolveKeysById(this,"xValue",n),v=i.resolveColumnById(this,"yValue",n),{barWidth:S,groupIndex:M}=this.updateGroupScale(r),D=VQ.is(c)?S*-.5:0,k=WQ(r?.scale,r?.visibleRange,this.smallestDataInterval,this.largestDataInterval);let I;const A=n.dataSources.get(this.id)?.data??[];for(const[C,w]of A.entries()){const T=b&&a.getItemEnabled({seriesId:o,itemId:C}),O=x[C];if(O==null)continue;const E=Math.round(c.convert(O))+s.convert(String(M))+D,z=v[C],F=Math.round(h.convert(-z)),_=Math.round(h.convert(z)),G=this.getItemStyle({datum:w,datumIndex:C},!1),B=Math.max(G.strokeWidth??0,Math.abs(_-F)),V={x:d?Math.min(_,F):E,y:d?E:Math.min(_,F),width:d?B:S,height:d?S:B},Y={x:V.x+V.width/2,y:V.y+V.height/2},X=this.createLabelData({datumIndex:C,rect:V,barAlongX:d,yDatum:z,datum:w,visible:T}),q={index:C,series:this,itemId:f,datum:w,datumIndex:C,xValue:O,yValue:z,xKey:u,yKey:p,x:V.x,y:V.y,width:V.width,height:V.height,midPoint:Y,crisp:k,label:X,visible:T};if(y.nodeData.push(q),X!=null&&y.labelData.push(X),I!=null){const te=I.rect,pe=I.nodeDatum,Se=I.datumIndex;d?y.connectorData.push({datum:pe,datumIndex:Se,x0:te.x,y0:te.y+te.height,x1:te.x+te.width,y1:te.y+te.height,x2:V.x+V.width,y2:V.y,x3:V.x,y3:V.y,opacity:1}):y.connectorData.push({datum:pe,datumIndex:Se,x0:te.x+te.width,y0:te.y,x1:V.x,y1:V.y,x2:V.x,y2:V.y+V.height,x3:te.x+te.width,y3:te.y+te.height,opacity:1})}T&&(I={itemId:f,rect:V,nodeDatum:q,datumIndex:C})}return y}updateNodes(e,t){super.updateNodes(e,t);const{connectorSelection:i}=this,s=this.contextNodeData?.connectorData??[];this.connectorSelection=this.updateConnectorSelection({connectorSelection:i,connectorData:s}),this.updateConnectorNodes({connectorSelection:i})}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e,s=t??[];return i.update(s,void 0,n=>this.getDatumId(n))}updateConnectorSelection(e){const{connectorData:t,connectorSelection:i}=e;return i.update(this.connectorEnabled()?t:[],void 0,s=>this.getDatumId(s.datum))}updateConnectorNodes(e){const t=this.getShapeFillBBox();e.connectorSelection.each((i,s)=>{const{fill:n,fillOpacity:o,stroke:a,strokeOpacity:r,strokeWidth:l,lineDash:c,lineDashOffset:h}=this.connectorStyle(s.datumIndex);i.setProperties(Gf(i,s)),i.setStyleProperties({fill:n,stroke:a,fillOpacity:o,strokeOpacity:r,strokeWidth:l,lineDash:c,lineDashOffset:h},t)})}updateLabelSelection(e){const t=this.properties.label.enabled?e.labelData:[];return e.labelSelection.update(t,i=>{i.pointerEvents=AF.None})}updateLabelNodes(e){const t={stageKey:this.properties.stageKey,valueKey:this.properties.valueKey},i=this.ctx.highlightManager?.getActiveHighlight(),{isHighlight:s=!1,labelSelection:n}=e;n.each((o,a)=>{const r=this.getHighlightStyle(s,a.datumIndex);o.visible=a.visible||s,o.fillOpacity=r.opacity??1,o.opacity=r.opacity??1,NQ(this,o,t,this.properties.label,a,s,i)})}getHighlightLabelData(e,t){if(t.label)return[{...t.label}]}getTooltipContent(e){const{id:t,dataModel:i,processedData:s,properties:n}=this,{stageKey:o,valueKey:a,tooltip:r,legendItemName:l}=n,c=this.getCategoryAxis(),h=this.getValueAxis();if(!i||!s||!c||!h)return;const d=s.dataSources.get(this.id)?.data[e],u=i.resolveKeysById(this,"xValue",s)[e],p=i.resolveColumnById(this,"yValue",s)[e];if(u!=null)return this.formatTooltipWithContext(r,{symbol:this.legendItemSymbol(e),data:[{label:this.getAxisValueText(c,"tooltip",u,d,o,l),value:this.getAxisValueText(h,"tooltip",p,d,a,l)}]},{seriesId:t,datum:d,title:o,stageKey:o,valueKey:a,...this.tooltipStyle(d,e)})}resetAllAnimation(e){super.resetAllAnimation(e),FQ([this.connectorSelection],Gf)}animateEmptyUpdateReady({labelSelection:e}){const{connectorSelection:t}=this,i=this.isVertical(),n=LQ(i,"normal");jQ.fromToMotion(this.id,"connectors",this.ctx.animationManager,[t],n),kF(this,"labels",this.ctx.animationManager,e)}animateWaitingUpdateReady(e){const{labelSelection:t}=e;this.ctx.animationManager.stopByAnimationGroupId(this.id),kF(this,"labels",this.ctx.animationManager,t)}getDatumId(e){return $Q(e.xValue)}isLabelEnabled(){return this.properties.label.enabled}computeFocusBounds({datumIndex:e}){return _Q(this,this.contextNodeData?.nodeData[e])}legendItemSymbol(e){const{strokeWidth:t,fillOpacity:i,strokeOpacity:s,lineDash:n,lineDashOffset:o,fill:a,stroke:r}=this.properties.getStyle(e);return{marker:{fill:a,fillOpacity:i,stroke:r,strokeWidth:t,strokeOpacity:s,lineDash:n,lineDashOffset:o}}}getLegendData(e){const{id:t,processedData:i,dataModel:s,ctx:{legendManager:n},visible:o}=this;if(!s||!i||e!=="category")return[];const{showInLegend:a}=this.properties,r=s.resolveKeysById(this,"xValue",i);return(i.dataSources.get(this.id)?.data??[]).map((l,c)=>{const h=r[c];if(h!=null)return{legendType:"category",id:t,datum:l,itemId:c,seriesId:t,enabled:o&&n.getItemEnabled({seriesId:t,itemId:c}),label:{text:String(h)},symbol:this.legendItemSymbol(c),skipAnimations:!0,hideInLegend:!a}}).filter(l=>l!=null)}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.label.itemStyler!=null}},{Label:KQ,AbstractBarSeriesProperties:YQ,makeSeriesTooltip:ZQ,AxisLabel:XQ}=L,oC=class extends KQ{constructor(){super(...arguments),this.spacing=0}};g([m],oC.prototype,"placement",2),g([m],oC.prototype,"spacing",2);var LF=class extends XQ{};g([m],LF.prototype,"placement",2);var Kn=class extends YQ{constructor(){super(...arguments),this.fills=[],this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.label=new oC,this.stageLabel=new LF,this.tooltip=ZQ()}getStyle(e){const{fills:t,strokes:i,fillOpacity:s,strokeWidth:n,strokeOpacity:o,lineDash:a,lineDashOffset:r}=this;return{fill:t[e],fillOpacity:s,stroke:i[e],strokeWidth:n,strokeOpacity:o,lineDash:a,lineDashOffset:r,opacity:1}}};g([m],Kn.prototype,"stageKey",2),g([m],Kn.prototype,"valueKey",2),g([m],Kn.prototype,"fills",2),g([m],Kn.prototype,"fillOpacity",2),g([m],Kn.prototype,"strokes",2),g([m],Kn.prototype,"strokeWidth",2),g([m],Kn.prototype,"strokeOpacity",2),g([m],Kn.prototype,"lineDash",2),g([m],Kn.prototype,"lineDashOffset",2),g([m],Kn.prototype,"label",2),g([m],Kn.prototype,"stageLabel",2),g([m],Kn.prototype,"tooltip",2);function wF(e,{x:t,y:i,width:s,height:n,opacity:o}){return{x1:t,y1:i,x2:t+s,y2:i+n,opacity:o??1}}var{Line:qQ}=L,aC=class extends CF{constructor(e){super({moduleCtx:e,animationResetFns:{datum:wF}}),this.properties=new Kn}get hasData(){const{id:e,ctx:{legendManager:t}}=this,i=this.data?.data.reduce((s,n,o)=>s+(t.getItemEnabled({seriesId:e,itemId:o})?1:0),0);return i!=null&&i>1}getBandScalePadding(){return{inner:1,outer:0}}connectorEnabled(){return!0}getItemStyle({datumIndex:e},t){return this.properties.getStyle(e)}connectorStyle(e){return this.properties.getStyle(e)}nodeFactory(){return new qQ}createLabelData({datumIndex:e,rect:t,barAlongX:i,yDatum:s,datum:n,visible:o}){const{stageKey:a,valueKey:r,label:l}=this.properties,{spacing:c,placement:h}=l;if(!l.enabled)return;let d,u,p,f;if(i)switch(d=t.x+t.width/2,p="center",h){case"before":u=t.y-c,f="bottom";break;case"after":u=t.y+t.height+c,f="top";break;default:u=t.y+t.height/2,f="middle"}else switch(u=t.y+t.height/2,f="middle",h){case"before":d=t.x-c,p="right";break;case"after":d=t.x+t.width+c,p="left";break;default:d=t.x+t.width/2,p="center"}const y=this.getSeriesDomain("y").domain,b=this.getLabelText(s,n,r,"y",y,l,{itemId:r,value:s,datum:n,stageKey:a,valueKey:r});return{x:d,y:u,textAlign:p,textBaseline:f,text:b,itemId:r,datum:n,datumIndex:e,series:this,visible:o}}updateDatumNodes(e){const t=this.getHighlightStyle(e.isHighlight);e.datumSelection.each((i,s)=>{i.setProperties(wF(i,s)),i.stroke=t?.stroke,i.strokeWidth=t?.strokeWidth??0,i.strokeOpacity=t?.strokeOpacity??1,i.lineDash=t?.lineDash,i.lineDashOffset=t?.lineDashOffset??0,i.opacity=t?.opacity??1})}tooltipStyle(e,t){const{fill:i,stroke:s,fillOpacity:n,strokeOpacity:o,strokeWidth:a,lineDash:r,lineDashOffset:l}=this.properties.getStyle(t);return{fill:i,fillOpacity:n,stroke:s,strokeOpacity:o,strokeWidth:a,lineDash:r,lineDashOffset:l}}hasItemStylers(){return this.properties.label.itemStyler!=null}};aC.className="ConeFunnelSeries",aC.type="cone-funnel";var{coneFunnelSeriesThemeableOptionsDef:QQ}=L,JQ={...Q(et,["showInLegend"]),...QQ,type:$(Le("cone-funnel")),stageKey:$(N),valueKey:$(N)},e7={series:{direction:"vertical",fills:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"secondSequentialColors"},L.SAFE_RANGE2_OPERATION]},{$applySwitch:[{$path:["/type",void 0,{$value:"$1"}]},{$value:"$1"},["gradient",L.FILL_GRADIENT_LINEAR_SINGLE_DEFAULTS],["pattern",L.FILL_PATTERN_SINGLE_DEFAULTS],["image",L.FILL_IMAGE_DEFAULTS]]}]},strokes:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"secondSequentialColors"},L.SAFE_RANGE2_OPERATION]}]},strokeWidth:{$isUserOption:["./strokes/0",2,0]},label:{...L.LABEL_BOXING_DEFAULTS,enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},placement:"before",spacing:4},tooltip:{range:{$path:["/tooltip/range","nearest"]}},highlight:{highlightedItem:{stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2}}},seriesArea:{padding:{top:20,bottom:20}},axes:{number:{nice:!1,gridLine:{enabled:!1},crosshair:{enabled:!1},label:{enabled:!1}},category:{line:{enabled:!1}}}},TF={type:"series",name:"cone-funnel",chartType:"cartesian",enterprise:!0,solo:!0,version:ue,dependencies:[oi],options:JQ,defaultAxes:MF,themeTemplate:e7,create:e=>new aC(e)},{Label:t7,DropShadow:i7,AbstractBarSeriesProperties:s7,makeSeriesTooltip:n7,AxisLabel:o7}=L,a7=class extends t7{},NF=class extends o7{};g([m],NF.prototype,"placement",2);var qr=class extends K{constructor(){super(...arguments),this.enabled=!0,this.fill=void 0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}getStyle(){const{fill:e,stroke:t,fillOpacity:i,strokeWidth:s,strokeOpacity:n,lineDash:o,lineDashOffset:a}=this;return{fill:e,fillOpacity:i,stroke:t,strokeWidth:s,strokeOpacity:n,lineDash:o,lineDashOffset:a,opacity:1}}};g([m],qr.prototype,"enabled",2),g([m],qr.prototype,"fill",2),g([m],qr.prototype,"fillOpacity",2),g([m],qr.prototype,"stroke",2),g([m],qr.prototype,"strokeWidth",2),g([m],qr.prototype,"strokeOpacity",2),g([m],qr.prototype,"lineDash",2),g([m],qr.prototype,"lineDashOffset",2);var bs=class extends s7{constructor(){super(...arguments),this.fills=[],this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.spacingRatio=0,this.dropOff=new qr,this.shadow=new i7().set({enabled:!1}),this.label=new a7,this.stageLabel=new NF,this.tooltip=n7()}getStyle(e){const{fills:t,strokes:i,fillOpacity:s,strokeWidth:n,strokeOpacity:o,lineDash:a,lineDashOffset:r}=this;return{fill:t[e],fillOpacity:s,stroke:i[e],strokeWidth:n,strokeOpacity:o,lineDash:a,lineDashOffset:r,opacity:1}}};g([m],bs.prototype,"stageKey",2),g([m],bs.prototype,"valueKey",2),g([m],bs.prototype,"fills",2),g([m],bs.prototype,"fillOpacity",2),g([m],bs.prototype,"strokes",2),g([m],bs.prototype,"strokeWidth",2),g([m],bs.prototype,"strokeOpacity",2),g([m],bs.prototype,"lineDash",2),g([m],bs.prototype,"lineDashOffset",2),g([m],bs.prototype,"spacingRatio",2),g([m],bs.prototype,"itemStyler",2),g([m],bs.prototype,"dropOff",2),g([m],bs.prototype,"shadow",2),g([m],bs.prototype,"label",2),g([m],bs.prototype,"stageLabel",2),g([m],bs.prototype,"tooltip",2);var{resetBarSelectionsFn:r7,prepareBarAnimationFunctions:OF,midpointStartingBarPosition:EF,createDatumId:l7,Rect:c7,motion:PF}=L,rC=class extends CF{constructor(e){super({moduleCtx:e,animationResetFns:{datum:r7}}),this.properties=new bs}getBandScalePadding(){return{inner:this.properties.spacingRatio,outer:0}}connectorEnabled(){return this.properties.dropOff.enabled}connectorStyle(e){return oe(this.properties.dropOff.getStyle(),this.properties.getStyle(e))}nodeFactory(){return new c7}createLabelData({datumIndex:e,rect:t,yDatum:i,datum:s,visible:n}){const{valueKey:o,stageKey:a,label:r}=this.properties;if(!r.enabled)return;const l=this.getSeriesDomain("y").domain,c=this.getLabelText(i,s,o,"y",l,r,{itemId:o,value:i,datum:s,stageKey:a,valueKey:o});return{x:t.x+t.width/2,y:t.y+t.height/2,textAlign:"center",textBaseline:"middle",text:c,itemId:a,datum:s,datumIndex:e,series:this,visible:n}}getItemStyle({datum:e,datumIndex:t},i){const{id:s,properties:n}=this,{stageKey:o,valueKey:a,itemStyler:r}=n,l=this.getHighlightStyle(i,t);let h=oe(l,n.getStyle(t));if(r!=null){const d=this.ctx.highlightManager?.getActiveHighlight(),u=this.cachedDatumCallback(l7(t,i?"highlight":"node"),()=>{const p=this.getHighlightStateString(d,i,t);return this.callWithContext(r,{seriesId:s,datum:e,highlightState:p,stageKey:o,valueKey:a,...h})});u&&(h=oe(u,h))}return h}updateDatumNodes({datumSelection:e,isHighlight:t}){const{contextNodeData:i}=this;if(!i)return;const{shadow:s}=this.properties,n=this.getCategoryDirection()==="x",o=this.getShapeFillBBox();e.each((a,r)=>{const l=this.getItemStyle(r,t);a.setStyleProperties(l,o),a.visible=n?r.width>0:r.height>0,a.crisp=r.crisp,a.fillShadow=s})}tooltipStyle(e,t){return this.getItemStyle({datum:e,datumIndex:t},!1)}animateEmptyUpdateReady(e){super.animateEmptyUpdateReady(e);const{datumSelection:t}=e,i=this.isVertical(),n=OF(EF(i,"normal"),"unknown");PF.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],n)}animateWaitingUpdateReady(e){super.animateWaitingUpdateReady(e);const{datumSelection:t}=e,{processedData:i}=this,s=i?.reduced?.diff?.[this.id],n=OF(EF(this.isVertical(),"fade"),"added");PF.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],n,(o,a)=>a.xValue,s)}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.label.itemStyler!=null}};rC.className="FunnelSeries",rC.type="funnel";var{funnelSeriesThemeableOptionsDef:h7}=L,d7={...h7,...Q(et,["showInLegend"]),type:$(Le("funnel")),stageKey:$(N),valueKey:$(N)},RF={type:"series",name:"funnel",chartType:"cartesian",enterprise:!0,solo:!0,version:ue,dependencies:[oi],options:d7,defaultAxes:MF,themeTemplate:AQ,create:e=>new rC(e)},FF=[eE,uA,rv,TF,RF,SA,lv,pv,gv,GA].flat(),zF=[vF,FF,Mf,Jk,eA,ev,Pf,nA,iv,oA,iR,Lv,HA,$A,KA,qA,mp].flat(),{DEFAULT_ANNOTATION_HANDLE_FILL:u7,DEFAULT_ANNOTATION_STATISTICS_COLOR:p7,DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE:g7,DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL:BF,DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE:_F,DEFAULT_ANNOTATION_STATISTICS_FILL:f7,DEFAULT_ANNOTATION_STATISTICS_STROKE:m7,DEFAULT_FIBONACCI_STROKES:VF,DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL:xp,DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR:Qr,DEFAULT_TEXTBOX_COLOR:y7,DEFAULT_TEXTBOX_FILL:x7,DEFAULT_TEXTBOX_STROKE:b7,DEFAULT_TEXT_ANNOTATION_COLOR:v7}=xL,Io={stroke:Qr},vs={fill:u7},GF={color:"white",fill:Qr},Jr={color:Qr},zh={color:v7,fontSize:{$rem:Si.LARGE},fontFamily:{$ref:"fontFamily"}},lC={...zh,fontSize:{$ref:"fontSize"},color:p7,fill:f7,stroke:m7,strokeWidth:1,divider:{stroke:g7,strokeWidth:1,strokeOpacity:.5}},cC={...Io,background:{fill:xp,fillOpacity:.2},handle:{...vs},text:{...Jr},statistics:{...lC}},S7={line:{...Io,handle:{...vs},text:{...Jr}},"horizontal-line":{...Io,handle:{...vs},axisLabel:{...GF},text:{...Jr}},"vertical-line":{...Io,handle:{...vs},axisLabel:{...GF},text:{...Jr}},"disjoint-channel":{...Io,background:{fill:xp,fillOpacity:.2},handle:{...vs},text:{...Jr}},"parallel-channel":{...Io,background:{fill:xp,fillOpacity:.2},handle:{...vs},text:{...Jr}},"fibonacci-retracement":{...Io,strokes:VF,rangeStroke:Qr,handle:{...vs},text:{...Jr,position:"center"},label:{...zh,color:void 0,fontSize:{$rem:Si.SMALLER}}},"fibonacci-retracement-trend-based":{...Io,strokes:VF,rangeStroke:Qr,handle:{...vs},text:{...Jr,position:"center"},label:{...zh,color:void 0,fontSize:{$rem:Si.SMALLER}}},callout:{...Io,...zh,color:{$ref:"textColor"},handle:{...vs},fill:xp,fillOpacity:.2},comment:{...zh,color:"white",fontWeight:700,handle:{...vs},fill:Qr},note:{...zh,color:y7,fill:Qr,stroke:{$ref:"chartBackgroundColor"},strokeWidth:1,strokeOpacity:1,handle:{...vs},background:{fill:x7,stroke:b7,strokeWidth:1}},text:{...zh,handle:{...vs}},arrow:{...Io,handle:{...vs},text:{...Jr}},"arrow-up":{fill:{$palette:"up.fill"},handle:{...vs,stroke:Qr}},"arrow-down":{fill:{$palette:"down.fill"},handle:{...vs,stroke:Qr}},"date-range":{...cC},"price-range":{...cC},"date-price-range":{...cC},"quick-date-price-range":{up:{...Io,fill:xp,fillOpacity:.2,handle:{...vs},statistics:{...lC,color:"#fff",fill:xp,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}}},down:{...Io,stroke:_F,fill:BF,fillOpacity:.2,handle:{...vs,stroke:_F},statistics:{...lC,color:"#fff",fill:BF,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}}}},axesButtons:{enabled:!0}},{SAFE_STROKE_FILL_OPERATION:M7}=L,D7=["ohlc","line","step-line","hlc","high-low","candlestick","hollow-candlestick"],I7=[{icon:"trend-line-drawing",tooltip:"toolbarAnnotationsLineAnnotations",value:"line-menu"},{icon:"fibonacci-retracement-drawing",tooltip:"toolbarAnnotationsFibonacciAnnotations",value:"fibonacci-menu"},{icon:"text-annotation",tooltip:"toolbarAnnotationsTextAnnotations",value:"text-menu"},{icon:"arrow-drawing",tooltip:"toolbarAnnotationsShapeAnnotations",value:"shape-menu"},{icon:"measurer-drawing",tooltip:"toolbarAnnotationsMeasurerAnnotations",value:"measurer-menu"},{icon:"delete",tooltip:"toolbarAnnotationsClearAll",value:"clear"}];function k7(e,t,i){const{dateKey:s="date",highKey:n="high",openKey:o="open",lowKey:a="low",closeKey:r="close",volumeKey:l="volume",chartType:c="candlestick",navigator:h=!1,volume:d=!0,rangeButtons:u=!0,statusBar:p=!0,toolbar:f=!0,zoom:y=!0,sync:b=!1,theme:x,data:v,formatter:S,...M}=e,D=C7(c,s,n,a,o,r),k=A7(i,s,o,r,d,l),A={navigator:{enabled:h,...d?{miniChart:{enabled:h,series:[{type:"line",xKey:s,yKey:l,stroke:M7,marker:{enabled:!1}}]},height:40,minHandle:{height:46},maxHandle:{height:46}}:null}},C={annotations:{enabled:f,optionsToolbar:{enabled:f},snap:!0,toolbar:{enabled:f,buttons:I7,padding:0},data:v,xKey:s,volumeKey:d?l:void 0}},w=p?{statusBar:{enabled:!0,highKey:n,openKey:o,lowKey:a,closeKey:r,volumeKey:d?l:void 0}}:null,T={zoom:{enabled:y,autoScaling:{enabled:!0},onDataChange:{stickToEnd:!0},enableIndependentAxes:!0}},O={ranges:{enabled:u}},E=b?{sync:{enabled:b,nodeInteraction:!0,zoom:!0}}:null,z=d?{yVolume:{type:"number",position:"left",label:{enabled:!1},crosshair:{enabled:!1},gridLine:{enabled:!1},nice:!1,layoutConstraints:{stacked:!1,width:20,unit:"percent",align:"end"}}}:{};return{theme:{baseTheme:typeof x=="string"?x:"ag-financial",...oe(typeof x=="object"?x:null,{overrides:{common:{title:{padding:4},padding:{top:6,right:8,bottom:6},chartToolbar:{enabled:f},annotations:{...S7},axes:{number:{interval:{maxSpacing:45},label:{format:".2f"}},category:{gridLine:{enabled:!0}},time:{gridLine:{enabled:!0}},"unit-time":{gridLine:{enabled:!0}},"ordinal-time":{gridLine:{enabled:!0}}}},bar:{series:{fillOpacity:.5,highlight:{unhighlightedItem:{opacity:1},unhighlightedSeries:{opacity:1}}}},line:{series:{marker:{enabled:!1},highlight:{unhighlightedSeries:{opacity:1}},...Tv(c,{hlc:{stroke:{$palette:"altNeutral.stroke"},strokeWidth:2},line:{stroke:{$palette:"neutral.stroke"}},"step-line":{stroke:{$palette:"neutral.stroke"},interpolation:{type:"step"}}})}},candlestick:{series:{highlight:{unhighlightedItem:{opacity:1},unhighlightedSeries:{opacity:1}},...Tv(c,{"hollow-candlestick":{item:{up:{fill:"transparent"}}}})}},ohlc:{series:{highlight:{unhighlightedItem:{opacity:1},unhighlightedSeries:{opacity:1}}}},"range-area":{series:{fillOpacity:.3,strokeWidth:2,highlight:{bringToFront:!1,unhighlightedItem:{opacity:1},unhighlightedSeries:{opacity:1}},...Tv(c,{hlc:{fill:{$if:[{$eq:[{$value:"$index"},1]},{$palette:"up.fill"},{$palette:"down.fill"}]},stroke:{$if:[{$eq:[{$value:"$index"},1]},{$palette:"up.stroke"},{$palette:"down.stroke"}]}}})}},"range-bar":{series:{highlight:{unhighlightedItem:{opacity:1},unhighlightedSeries:{opacity:1}},...Tv(c,{"high-low":{fill:{$palette:"neutral.fill"},stroke:{$palette:"neutral.stroke"}}})}}}})},animation:{enabled:!1},legend:{enabled:!1},series:[...k,...D],axes:{y:{type:"number",position:"right",crosshair:{enabled:!0,snap:!1},layoutConstraints:{stacked:!1,width:100,unit:"percent",align:"start"}},...z,x:{type:"ordinal-time",position:"bottom",line:{enabled:!1},label:{enabled:!0},crosshair:{enabled:!0}}},tooltip:{enabled:!1},data:v,formatter:S,...C,...A,...w,...T,...O,...E,...M}}function A7(e,t,i,s,n,o){return n?[{type:"bar",xKey:t,yKey:o,yKeyAxis:"yVolume",tooltip:{enabled:!1},simpleItemStyler(a){const{up:r,down:l}=e().palette;return{fill:a[i]<a[s]?r?.fill:l?.fill}},focusPriority:1,highlight:{unhighlightedSeries:{opacity:1}}}]:[]}var HF="range-area";function C7(e,t,i,s,n,o){const a={xKey:t,openKey:n,closeKey:o,highKey:i,lowKey:s},r={xKey:t,yKey:o},l={pickOutsideVisibleMinorAxis:!0};switch(e??"candlestick"){case"ohlc":return L7(l,a);case"line":case"step-line":return w7(l,r);case"hlc":return T7(l,r,a);case"high-low":return N7(l,a);case"candlestick":case"hollow-candlestick":return jF(l,a);default:return j.warnOnce(`unknown chart type: ${e}; expected one of: ${D7.join(", ")}`),jF(l,a)}}function L7(e,t){return[{type:"ohlc",focusPriority:0,...e,...t}]}function w7(e,t){return[{type:"line",focusPriority:0,...e,...t}]}function T7(e,t,{xKey:i,highKey:s,closeKey:n,lowKey:o}){return[{type:HF,focusPriority:0,...e,xKey:i,yHighKey:s,yLowKey:n},{type:HF,focusPriority:0,...e,xKey:i,yHighKey:n,yLowKey:o},{type:"line",...e,...t}]}function N7(e,{xKey:t,highKey:i,lowKey:s}){return[{type:"range-bar",...e,xKey:t,yHighKey:i,yLowKey:s,tooltip:{range:"nearest"},focusPriority:0}]}function jF(e,t){return[{type:"candlestick",focusPriority:0,...e,...t}]}function Tv(e,t){return t[e]??t.default}var O7={chartType:Z("candlestick","hollow-candlestick","ohlc","line","step-line","hlc","high-low"),dateKey:N,openKey:N,highKey:N,lowKey:N,closeKey:N,volumeKey:N,navigator:R,volume:R,rangeButtons:R,statusBar:R,toolbar:R,zoom:R,sync:R,theme:le,container:le,width:le,height:le,minWidth:le,minHeight:le,listeners:le,initialState:le,title:le,data:sn,formatter:le},E7={theme:le,container:le,animation:le,background:le,contextMenu:le,context:()=>!0,listeners:le,locale:le,width:le,height:le,minWidth:le,minHeight:le,title:le,subtitle:le,footnote:le,padding:le,tooltip:{...Ye,...we.tooltip}};E7.overrideDevicePixelRatio=ee(P);var P7={type:"preset",name:"price-volume",enterprise:!0,dependencies:[ev,KA],version:ue,options:O7,create:k7},WF=[P7,sb,lb,rv,lv,gv,pv,Mf,Jk,eA,ev,Pf,nA,iv,oA,Lv,HA,$A,qA,mp,nC,QI,qI];function $F(e){const{enabled:t,mode:i,showArrow:s,range:n,position:o,pagination:a,delay:r,wrapping:l,interaction:c,renderer:h,...d}=e,u={enabled:t,showArrow:s,range:n,position:o,interaction:c,renderer:h,...d};return{chartTooltipOptions:{mode:i,pagination:a,delay:r,wrapping:l,...d},seriesTooltipOptions:u}}function R7(e){const{animation:t,background:i,container:s,contextMenu:n,context:o,footnote:a,height:r,listeners:l,locale:c,minHeight:h,minWidth:d,overrideDevicePixelRatio:u,padding:p,subtitle:f,theme:y,title:b,width:x,type:v,cursor:S,nodeClickRange:M,tooltip:D,value:k,scale:I={},startAngle:A,endAngle:C,highlight:w,segmentation:T,bar:O,needle:E,targets:z,outerRadius:F,innerRadius:_,outerRadiusRatio:G,innerRadiusRatio:B,cornerRadius:V,cornerMode:Y,label:X,secondaryLabel:q,spacing:te,...pe}=e,Se=D!=null,ve=D??{},{chartTooltipOptions:ae,seriesTooltipOptions:Ie}=$F(ve),ze={...pe,type:v,cursor:S,context:o,nodeClickRange:M,value:k,scale:I,startAngle:A,endAngle:C,highlight:w,segmentation:T,bar:O,targets:z,outerRadius:F,innerRadius:_,outerRadiusRatio:G,innerRadiusRatio:B,cornerRadius:V,cornerMode:Y,label:X,secondaryLabel:q,spacing:te};return Se&&(ze.tooltip=Ie),E!=null&&(ze.needle={enabled:!0,...E}),{animation:t,background:i,container:s,contextMenu:n,context:o,footnote:a,height:r,listeners:l,locale:c,minHeight:h,minWidth:d,overrideDevicePixelRatio:u,padding:p,subtitle:f,theme:y,title:b,width:x,...Se?{tooltip:ae}:{},series:[ze]}}function F7(e){const{animation:t,background:i,container:s,contextMenu:n,context:o,footnote:a,height:r,listeners:l,locale:c,minHeight:h,minWidth:d,overrideDevicePixelRatio:u,padding:p,subtitle:f,theme:y,title:b,width:x,type:v,cursor:S,nodeClickRange:M,tooltip:D,value:k,scale:I={},direction:A="vertical",thickness:C,highlight:w,segmentation:T,bar:O,targets:E,cornerRadius:z,cornerMode:F,label:_,...G}=e,B=D!=null,V=D??{},{chartTooltipOptions:Y,seriesTooltipOptions:X}=$F(V),q={...G,type:v,cursor:S,nodeClickRange:M,value:k,scale:I,direction:A,thickness:C,highlight:w,segmentation:T,bar:O,targets:E,cornerRadius:z,cornerMode:F,label:_};return B&&(q.tooltip=X),{animation:t,background:i,container:s,contextMenu:n,context:o,footnote:a,height:r,listeners:l,locale:c,minHeight:h,minWidth:d,overrideDevicePixelRatio:u,padding:p,subtitle:f,theme:y,title:b,width:x,...B?{tooltip:Y}:{},series:[q]}}function UF(e,t){if(t==null)return e;const{targets:i,...s}=t;return e=oe(e,s),e.targets!=null&&i!=null&&(e.type,e.targets=Om(e.targets,i)),e}function z7(e,t){switch(e.type){case"radial-gauge":return R7(UF(e,t));case"linear-gauge":return F7(UF(e,t));default:return{series:[]}}}var hC={theme:le,container:le,animation:le,background:le,contextMenu:le,context:()=>!0,listeners:le,locale:le,width:le,height:le,minWidth:le,minHeight:le,title:le,subtitle:le,footnote:le,padding:le,tooltip:{...Ye,...we.tooltip}};hC.overrideDevicePixelRatio=ee(P);var KF={type:"preset",name:"gauge-preset",enterprise:!0,version:ue,dependencies:[Wu],options:nl({"linear-gauge":{...Q(ha,["type"]),...hC},"radial-gauge":{...Q(Ic,["type"]),...hC}},"gauge options"),create:z7},YF=class{*[Symbol.iterator](){const{node:e,datum:t}=this;e&&t&&(yield{node:e,datum:t})}nodes(){return this.node?[this.node]:[]}update(e,t,i,s){const n=e.nodes();if(n.length===0)this.node?.remove(),this.node=void 0;else{this.node===void 0&&(this.node=new i,this.node.fillOpacity=0,this.node.strokeOpacity=0,t.appendChild(this.node));const o=n[0],a=n.toReversed().find(r=>r.datum.datum.value>r.datum.datum.segmentStart)??n.at(-1);this.node.datum=this.datum=o.datum,s(this.node,o,a)}}},ZF={fromFn:()=>({opacity:0,phase:"initial"}),toFn:()=>({opacity:1})};function XF(e,t){if(e==null)return"";const{min:i,max:s}=t,n=i===0?0:Math.ceil(Math.log10(Math.abs(i))),o=s===0?0:Math.ceil(Math.log10(Math.abs(s))),a=Math.max(2-Math.max(n,o),0);return e.toFixed(a)}function Hf(e,t,i,s){if(i.text!=null)return i.text;const n=s??i.value;let o;return i?.formatter!=null&&(o=Vf(t,i.formatter,{seriesId:e,datum:void 0,value:n})),o==null||Ce(o)?o:String(o)}function qF({path:e,x:t,y:i,size:s}){e.moveTo(t,i-s/2),e.lineTo(t,i+s/2)}function QF(e,t){const i=or(e.datumUnion.nodes(),e.targetSelection.nodes());return e.pickNodeNearestDistantObject(t,i)}function JF(e,t){const i=[{data:e.contextNodeData?.nodeData,selection:e.datumUnion},{data:e.contextNodeData?.targetData,selection:e.targetSelection}].filter(l=>l.data&&l.data.length>0),s=ge(0,t.otherIndex+t.otherIndexDelta,i.length-1);if(i.length===0)return;const{data:n,selection:o}=i[s];if(n==null||n.length===0)return;const a=ge(0,t.datumIndex,n.length-1),r=n[a];for(const l of o)if(l.datum===r)return{bounds:l.node,clipFocusBox:!0,datum:r,datumIndex:a,otherIndex:s}}var Nv=class extends K{getSegments(e,t){const{values:i,step:s,count:n}=this,o=Math.min(...e.domain),a=Math.max(...e.domain);let r;if(i!=null){const l=i.filter(c=>c>o&&c<a).sort((c,h)=>c-h);r=[o,...l,a]}else if(s!=null){const l=[];for(let c=o;c<a;c+=s)l.push(c);l.push(a),r=l}else if(n==null){const l=e.ticks({nice:[!0,!0],interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0})?.ticks?.filter(c=>c>o&&c<a);r=l==null?void 0:[o,...l,a]}else{const l=n+1;r=Array.from({length:l+1},(c,h)=>h/l*(a-o)+o)}return r!=null&&r.length>t&&(j.warnOnce("the configured segmentation results in more than 1 item per pixel, ignoring. Supply a segmentation configuration that results in larger segments or omit this configuration"),r=void 0),r??(r=[o,a]),r}};g([m],Nv.prototype,"values",2),g([m],Nv.prototype,"step",2),g([m],Nv.prototype,"count",2);var jf=class extends K{constructor(){super(...arguments),this.enabled=!1,this.interval=new Nv,this.spacing=0}};g([m],jf.prototype,"enabled",2),g([m],jf.prototype,"interval",2),g([m],jf.prototype,"spacing",2);var{makeSeriesTooltip:B7,SeriesProperties:_7,Label:V7,AxisLabel:G7,getColorStops:H7}=L,ez=class extends V7{};g([m],ez.prototype,"spacing",2);var Ss=class extends K{constructor(){super(...arguments),this.value=0,this.label=new ez}getStyle(e){const{fill:t=e.fill??"black",fillOpacity:i=e.fillOpacity??1,stroke:s=e.stroke??"black",strokeWidth:n=e.strokeWidth??0,strokeOpacity:o=e.strokeOpacity??1,lineDash:a=e.lineDash??[0],lineDashOffset:r=e.lineDashOffset??0}=this;return{fill:t,fillOpacity:i,stroke:s,strokeWidth:n,strokeOpacity:o,lineDash:a,lineDashOffset:r}}};g([m],Ss.prototype,"text",2),g([m],Ss.prototype,"value",2),g([m],Ss.prototype,"shape",2),g([m],Ss.prototype,"placement",2),g([m],Ss.prototype,"spacing",2),g([m],Ss.prototype,"size",2),g([m],Ss.prototype,"rotation",2),g([m],Ss.prototype,"fill",2),g([m],Ss.prototype,"fillOpacity",2),g([m],Ss.prototype,"stroke",2),g([m],Ss.prototype,"strokeWidth",2),g([m],Ss.prototype,"strokeOpacity",2),g([m],Ss.prototype,"lineDash",2),g([m],Ss.prototype,"lineDashOffset",2),g([m],Ss.prototype,"label",2);var Yn=class extends K{constructor(){super(...arguments),this.enabled=!0,this.thicknessRatio=1,this.fills=new Pi(L.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}getStyle(e,t,i){const{fill:s,fills:n,fillMode:o,fillOpacity:a,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}=this;return{fill:s??iz(n,o,e,i,t),fillOpacity:a,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}}};g([m],Yn.prototype,"enabled",2),g([m],Yn.prototype,"thickness",2),g([m],Yn.prototype,"thicknessRatio",2),g([m],Yn.prototype,"fills",2),g([m],Yn.prototype,"fillMode",2),g([m],Yn.prototype,"fill",2),g([m],Yn.prototype,"fillOpacity",2),g([m],Yn.prototype,"stroke",2),g([m],Yn.prototype,"strokeWidth",2),g([m],Yn.prototype,"strokeOpacity",2),g([m],Yn.prototype,"lineDash",2),g([m],Yn.prototype,"lineDashOffset",2);var Wf=class extends K{constructor(){super(...arguments),this.values=void 0,this.step=void 0,this.minSpacing=0,this.maxSpacing=1e3}};g([m],Wf.prototype,"values",2),g([m],Wf.prototype,"step",2),g([m],Wf.prototype,"minSpacing",2),g([m],Wf.prototype,"maxSpacing",2);var tz=class extends G7{constructor(){super(...arguments),this.placement=void 0}};g([m],tz.prototype,"placement",2);var zs=class extends K{constructor(){super(...arguments),this.min=0,this.max=1,this.fills=new Pi(L.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.defaultFill="black",this.interval=new Wf,this.label=new tz}getStyle(e,t,i,s){const{fill:n,fills:o,defaultFill:a,fillMode:r,fillOpacity:l,stroke:c,strokeWidth:h,strokeOpacity:d,lineDash:u,lineDashOffset:p}=this;return{fill:n??(e&&o.length===0?a:void 0)??iz(o,r,t,s,i),fillOpacity:l,stroke:c,strokeWidth:h,strokeOpacity:d,lineDash:u,lineDashOffset:p}}};g([m],zs.prototype,"min",2),g([m],zs.prototype,"max",2),g([m],zs.prototype,"fills",2),g([m],zs.prototype,"fillMode",2),g([m],zs.prototype,"fill",2),g([m],zs.prototype,"fillOpacity",2),g([m],zs.prototype,"stroke",2),g([m],zs.prototype,"strokeWidth",2),g([m],zs.prototype,"strokeOpacity",2),g([m],zs.prototype,"lineDash",2),g([m],zs.prototype,"lineDashOffset",2),g([m],zs.prototype,"defaultFill",2),g([m],zs.prototype,"interval",2),g([m],zs.prototype,"label",2);var Ov=class extends Ku{constructor(){super(...arguments),this.placement="inside-center",this.avoidCollisions=!0}};g([m],Ov.prototype,"text",2),g([m],Ov.prototype,"placement",2),g([m],Ov.prototype,"avoidCollisions",2);var Bs=class extends _7{constructor(){super(...arguments),this.value=0,this.segmentation=new jf,this.defaultColorRange=[],this.targets=new Pi(Ss),this.defaultTarget=new Ss,this.defaultScale=new zs,this.direction="vertical",this.thickness=1,this.cornerRadius=0,this.cornerMode="container",this.margin=0,this.scale=new zs,this.bar=new Yn,this.label=new Ov,this.tooltip=B7()}};g([m],Bs.prototype,"value",2),g([m],Bs.prototype,"segmentation",2),g([m],Bs.prototype,"defaultColorRange",2),g([m],Bs.prototype,"targets",2),g([m],Bs.prototype,"defaultTarget",2),g([m],Bs.prototype,"defaultScale",2),g([m],Bs.prototype,"direction",2),g([m],Bs.prototype,"thickness",2),g([m],Bs.prototype,"cornerRadius",2),g([m],Bs.prototype,"cornerMode",2),g([m],Bs.prototype,"margin",2),g([m],Bs.prototype,"scale",2),g([m],Bs.prototype,"bar",2),g([m],Bs.prototype,"label",2),g([m],Bs.prototype,"tooltip",2);function iz(e,t,i,s,n){return{type:"gradient",gradient:"linear",colorSpace:"oklch",colorStops:H7(e,i,s.domain,t),rotation:n?90:0,bounds:"series"}}var{BBox:j7}=L;function dC(e){const{x0:t,y0:i,x1:s,y1:n,horizontalInset:o,verticalInset:a}=e,r=Math.min(t,s)+o,l=Math.min(i,n)+a,c=Math.max(Math.abs(s-t)-2*o,0),h=Math.max(Math.abs(n-i)-2*a,0);return{x:r,y:l,width:c,height:h}}function W7(e,t){if(t==null)return!0;const i=dC(e),s=1e-6,n=i.x+s,o=i.y+s,a=i.x+i.width-s,r=i.y+i.height-s,l=t.x,c=t.x+t.width,h=t.y,d=t.y+t.height;return Math.max(n,l)<=Math.min(a,c)&&Math.max(o,h)<=Math.min(r,d)}function uC(e){const{clipX0:t,clipX1:i,clipY0:s,clipY1:n}=e;return t!=null&&i!=null||s!=null&&n!=null}function $7(e){if(!uC(e))return;const{x0:t,y0:i,x1:s,y1:n}=e,{x:o,y:a,width:r,height:l}=dC(e);let{clipX0:c,clipX1:h,clipY0:d,clipY1:u}=e;(c==null||h==null)&&(c=t,h=s),(d==null||u==null)&&(d=i,u=n);const p=Math.min(c,h),f=Math.min(d,u),y=Math.abs(h-c),b=Math.abs(u-d);return c=Math.max(o,p),d=Math.max(a,f),h=Math.min(o+r,p+y),u=Math.min(a+l,f+b),new j7(Math.min(c,h),Math.min(d,u),Math.abs(h-c),Math.abs(u-d))}function sz(e,t){const i=e?"initial":"update";return{node:{fromFn(n,o){const a=n.previousDatum;let{x0:r,y0:l,x1:c,y1:h,clipX0:d,clipY0:u,clipX1:p,clipY1:f}=a??o;const{horizontalInset:y,verticalInset:b}=o,x=a!=null&&uC(a),v=uC(o);return x&&v||(!x&&v?({x0:r,y0:l,x1:c,y1:h,clipX0:d,clipY0:u,clipX1:p,clipY1:f}=o,e&&(t?p=o.clipX0:f=o.clipY0)):x&&!v?({x0:r,y0:l,x1:c,y1:h}=o,d=void 0,u=void 0,p=void 0,f=void 0):e&&(t?c=r:h=l)),{x0:r,y0:l,x1:c,y1:h,clipX0:d,clipY0:u,clipX1:p,clipY1:f,horizontalInset:y,verticalInset:b,phase:i}},toFn(n,o){const{x0:a,y0:r,x1:l,y1:c,clipX0:h,clipY0:d,clipX1:u,clipY1:p,horizontalInset:f,verticalInset:y}=o;return{x0:a,y0:r,x1:l,y1:c,clipX0:h,clipY0:d,clipX1:u,clipY1:p,horizontalInset:f,verticalInset:y}},applyFn(n,o){n.setProperties($f(n,o))}}}}function $f(e,t){const{x:i,y:s,width:n,height:o}=dC(t),a=$7(t),r=W7(t,a);return{x:i,y:s,width:n,height:o,clipBBox:a,visible:r}}var U7={Before:"right",Center:"center",After:"left"},K7={Before:"top",Center:"middle",After:"bottom"},Y7={Before:-1,Center:-.5,After:0},Z7={Before:0,Center:-.5,After:-1};function X7(e,t,i,s,n,o){const{seriesRect:a,gaugeRect:r,barRect:l}=n,{padding:c,horizontal:h}=s;i.each((d,u)=>{const p=Hf(e.id,t,u,o?.label);let f,y;u.placement==="outside-start"?h?(f=r.x,y=a.height):(f=a.width,y=a.height-(r.y+r.height)):u.placement==="outside-end"?h?(f=a.width-(r.x+r.width),y=a.height):(f=a.width,y=r.y):u.avoidCollisions&&(f=r.width,y=r.height);let b;if(p==null)return;if(f!=null&&y!=null){const F=()=>({width:f,height:y,meta:null});b=bf(Pe(p),u,{padding:c},F)?.[0]}else{const F=Ze(u),{width:_,height:G}=Ce(p)?Ks(p,u):F.measureLines(Dt(p));b={text:p,fontSize:u.fontSize,lineHeight:u.lineHeight??F.lineHeight(),width:_,height:G}}if(b==null){d.visible=!1;return}const x=h?r.x:r.y+r.height,v=h?r.x+r.width:r.y,S=h?l.x:l.y+l.height,M=h?l.x+l.width:l.y,D=u.spacing*(h?1:-1);let k,I,A,C;switch(u.placement){case"outside-start":k=-1/0,I=1/0,A=x-D,C="Before";break;case"outside-end":k=-1/0,I=1/0,A=v+D,C="After";break;case"inside-start":k=x,I=M,A=x+D,C="After";break;case"inside-end":k=M,I=v,A=v-D,C="Before";break;case"inside-center":k=x,I=v,A=(x+v)/2,C="Center";break;case"bar-inside":k=S,I=M,A=(S+M)/2,C="Center";break;case"bar-inside-end":k=S,I=M,A=M-D,C="Before";break;case"bar-outside-end":k=M,I=v,A=M+D,C="After";break;case"bar-end":k=-1/0,I=1/0,A=M,C="Center";break}const w=h?A:r.x+r.width/2,T=h?r.y+r.height/2:A;let O,E;h?(O=w+Y7[C]*b.width,E=O+b.width):(O=T+Z7[C]*b.height,E=O+b.height);const z=Math.min(O,E)>=Math.min(k,I)&&Math.max(O,E)<=Math.max(k,I);if(u.avoidCollisions&&!z){d.visible=!1;return}d.visible=!0,d.text=b.text,d.fontSize=b.fontSize,d.lineHeight=b.lineHeight,d.textAlign=h?U7[C]:"center",d.textBaseline=h?"middle":K7[C],d.x=w,d.y=T})}var{fromToMotion:pC,resetMotion:q7,SeriesNodePickMode:nz,createDatumId:oz,BBox:ja,Group:Bh,PointerEvents:az,Selection:_h,Rect:Q7,Text:rz,TransformableText:J7,Marker:eJ,LinearScale:tJ,generateTicks:iJ,NiceMode:lz}=L,sJ={before:180,middle:0,after:0},nJ={before:90,middle:0,after:-90},gC=class extends L.Series{constructor(e){super({moduleCtx:e,pickModes:[nz.EXACT_SHAPE_MATCH,nz.NEAREST_NODE]}),this.properties=new Bs,this.seriesRect=ja.NaN,this.gaugeRect=ja.NaN,this.scale=new tJ,this.originX=0,this.originY=0,this.scaleGroup=this.contentGroup.appendChild(new Bh({name:"scaleGroup"})),this.itemGroup=this.contentGroup.appendChild(new Bh({name:"itemGroup"})),this.itemTargetGroup=this.contentGroup.appendChild(new Bh({name:"itemTargetGroup"})),this.itemTargetLabelGroup=this.contentGroup.appendChild(new Bh({name:"itemTargetLabelGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new Bh({name:"itemLabelGroup"})),this.highlightTargetGroup=this.highlightGroup.appendChild(new Bh({name:"itemTargetLabelGroup"})),this.tickGroup=this.contentGroup.appendChild(new Bh({name:"tickGroup"})),this.scaleSelection=_h.select(this.scaleGroup,()=>this.nodeFactory()),this.datumSelection=_h.select(this.itemGroup,()=>this.nodeFactory()),this.targetSelection=_h.select(this.itemTargetGroup,()=>this.markerFactory()),this.targetLabelSelection=_h.select(this.itemTargetLabelGroup,rz),this.labelSelection=_h.select(this.itemLabelGroup,rz),this.highlightTargetSelection=_h.select(this.highlightTargetGroup,()=>this.markerFactory()),this.tickSelection=_h.select(this.tickGroup,J7),this.datumUnion=new YF,this.animationState=new he("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.animateReadyResize(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateWaitingUpdateReady()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty"},reset:"empty",skip:"ready"}}),this.scaleGroup.pointerEvents=az.None,this.tickGroup.pointerEvents=az.None}get range(){return this.horizontal?[0,this.gaugeRect.width]:[0,this.gaugeRect.height]}get horizontal(){return this.properties.direction==="horizontal"}get hasData(){return!0}nodeFactory(){const e=new Q7;return e.crisp=!0,e}markerFactory(){return new eJ}processData(){this.nodeDataRefresh=!0,this.animationState.transition("updateData")}formatLabel(e){return XF(e,this.properties.scale)}getShapeFillBBox(){const{properties:e,originX:t,originY:i,horizontal:s,scale:n}=this,{thickness:o}=e,a=da(n.range),r=new ja(t,i,s?a:o,s?o:a);return{axis:r,series:r}}getTargets(){const{properties:e}=this,t=e.defaultTarget;return Array.from(e.targets).map(i=>{const{text:s=t.text,value:n=t.value??0,shape:o=t.shape??"triangle",rotation:a=t.rotation??0,placement:r=t.placement??"middle",spacing:l=t.spacing??0,size:c=t.size??0}=i,{enabled:h=t.label.enabled,color:d=t.label.color??"black",fontStyle:u=t.label.fontStyle??"normal",fontWeight:p=t.label.fontWeight??"normal",fontSize:f=t.label.fontSize,fontFamily:y=t.label.fontFamily,spacing:b=t.label.spacing??0}=i.label;return{text:s,value:n,shape:o,placement:r,spacing:l,size:c,rotation:a,label:{enabled:h,color:d,fontStyle:u,fontWeight:p,fontSize:f,fontFamily:y,spacing:b},style:i.getStyle(t)}})}getTargetPoint(e){const{properties:t,originX:i,originY:s,horizontal:n,scale:o,gaugeRect:a}=this,{thickness:r}=t,{value:l,placement:c,spacing:h,size:d}=e,u=o.convert(l);let p;switch(c){case"before":p=-(h+d/2);break;case"after":p=r+h+d/2;break;default:p=r/2;break}return{x:i+a.x+(n?u:p),y:s+a.y+(n?p:u)}}getTargetLabel(e){const{size:t,placement:i,label:s}=e,{spacing:n,color:o,fontStyle:a,fontWeight:r,fontSize:l,fontFamily:c}=s,h=void 0,d=t/2+n;let u,p,f=0,y=0;return this.horizontal?(u="center",i==="after"?(p="top",y=d):(p="bottom",y=-d)):(p="middle",i==="before"?(u="right",f=-d):(u="left",f=d)),{offsetX:f,offsetY:y,fill:o,textAlign:u,textBaseline:p,fontStyle:a,fontWeight:r,fontSize:l,fontFamily:c,lineHeight:h}}labelDatum(e,t){const{placement:i,avoidCollisions:s,spacing:n,text:o,color:a,fontSize:r,minimumFontSize:l,fontStyle:c,fontWeight:h,fontFamily:d,lineHeight:u,wrapping:p,overflowStrategy:f,formatter:y=b=>this.formatLabel(b.value)}=e;return{placement:i,avoidCollisions:s,spacing:n,text:o,value:t,fill:a,fontSize:r,minimumFontSize:l,fontStyle:c,fontWeight:h,fontFamily:d,lineHeight:u,wrapping:p,overflowStrategy:f,formatter:y}}verticalLabelInset(){const{label:e}=this.properties,t=Ze(e),i=e.text?.split(`
`),s=(e.lineHeight??t.lineHeight())*(i?.length??1);return e.spacing+s}horizontalLabelInset(){const{scale:e,properties:t}=this,{scale:i,label:s}=t,n=s.text?.split(`
`),o=Ze(s),a=i.interval.values??e.ticks({nice:[!1,!1],interval:i.interval.step,minTickCount:0,maxTickCount:6,tickCount:5})?.ticks??[],l=(n??a?.map(c=>Hf(this.id,this.ctx,this.labelDatum(s,c))??"")).reduce((c,h)=>{const{width:d}=Ce(h)?Ks(h,s):o.measureLines(Dt(h));return Math.max(c,d)},0);return s.spacing+l}tickFormatter(e,t){const{format:i,formatter:s}=this.properties.scale.label;let n;return i!=null&&(n=Cy(t,typeof i=="string"?i:void 0)),(o,a)=>{let r;return s&&(r??(r=Vf(this.ctx,s,{value:o,index:a,domain:e,boundSeries:void 0}))),r??(r=n?.(o)),r??this.formatLabel(o)}}createNodeData(){const{id:e,properties:t,horizontal:i,scale:s,seriesRect:n}=this,{value:o,segmentation:a,thickness:r,cornerRadius:l,cornerMode:c,bar:h,scale:d,label:u,defaultColorRange:p}=t;s.domain=[d.min,d.max],s.range=i?[0,n.width]:[n.height,0];let f,y;i?(y=1,f=Math.PI/2):d.label.placement==="before"?(y=1,f=0):(y=-1,f=0);let b,x,v,S;i?(b=0,x=n.width,v=(n.height-r)/2,S=v+r,u.placement==="outside-start"?b+=this.horizontalLabelInset():u.placement==="outside-end"&&(x-=this.horizontalLabelInset())):(b=(n.width-r)/2,x=b+r,S=0,v=n.height,u.placement==="outside-start"?v-=this.verticalLabelInset():u.placement==="outside-end"&&(S+=this.verticalLabelInset())),this.gaugeRect=new ja(Math.min(b,x),Math.min(v,S),Math.abs(x-b),Math.abs(S-v));const M=0,D=0;s.domain=[d.min,d.max],s.range=i?[b,x]:[v,S];const{tickData:{ticks:k}}=iJ({scale:s,label:this.properties.scale.label,interval:this.properties.scale.interval,tickFormatter:(Te,de)=>this.tickFormatter(Te,de),domain:s.domain,range:this.range,reverse:!1,primaryTickCount:void 0,defaultTickMinSpacing:0,visibleRange:[0,1],niceMode:[lz.Off,lz.Off],labelOffset:0,axisRotation:f,sideFlag:y}),I=!1,A=this.getTargets(),C=[],w=[],T=[],O=[],[E,z]=s.range,F=Math.abs(z-E),_=i?s.convert(o):x,G=i?S:s.convert(o),B=a.enabled?a.spacing/2:0,V=i?B:0,Y=i?0:B,X=Math.min(h.thickness??Math.round(h.thicknessRatio*r),r),q=-(r-X)/2,te=i?0:q,pe=i?q:0,Se=c==="item",ve=Math.ceil(F);let ae=a.enabled?a.interval.getSegments(s,ve):void 0;const Ie=h.getStyle(p,i,s),ze=d.getStyle(h.enabled,p,i,s);if(ae==null&&Se){const Te=Math.min(...s.domain),de=Math.max(...s.domain),De={value:o,segmentStart:Te,segmentEnd:de};if(h.enabled){const We=Math.min(l,X/2,F/2)*(I?-1:1),rt=i?We:0,wt=i?0:We;C.push({series:this,itemId:"value",datum:De,datumIndex:{type:0},type:0,x0:M+b-rt-te,y0:D+v-wt-pe,x1:M+_+rt+te,y1:D+G+wt+pe,clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:l,topRightCornerRadius:l,bottomRightCornerRadius:l,bottomLeftCornerRadius:l,horizontalInset:V,verticalInset:Y,style:Ie})}const Ee=Math.min(l,r/2,F/2)*(I?-1:1),Ne=i?Ee:0,xt=i?0:Ee;O.push({series:this,itemId:"scale",datum:De,datumIndex:{type:0},type:0,x0:M+b-Ne,y0:D+v-xt,x1:M+x+Ne,y1:D+S+xt,clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:l,topRightCornerRadius:l,bottomRightCornerRadius:l,bottomLeftCornerRadius:l,horizontalInset:V,verticalInset:Y,style:ze})}else{ae??(ae=s.domain);const Te=M+b-te,de=D+v-pe,De=M+_+te,ye=D+G+pe;for(let Ee=0;Ee<ae.length-1;Ee+=1){const Ne=ae[Ee+0],xt=ae[Ee+1],nt={value:o,segmentStart:Ne,segmentEnd:xt},We=Ee===0,rt=Ee===ae.length-2,wt=s.convert(Ne),vt=s.convert(xt),Ds=Se||We?l:0,Zn=Se||rt?l:0,oa=i?Ds:Zn,yn=Zn,Xn=i?Zn:Ds,Dp=Ds;h.enabled&&C.push({series:this,itemId:`value-${Ee}`,datum:nt,datumIndex:{type:0},type:0,x0:M+(i?wt:b),y0:D+(i?v:wt),x1:M+(i?vt:x),y1:D+(i?S:vt),clipX0:Te,clipY0:de,clipX1:De,clipY1:ye,topLeftCornerRadius:oa,topRightCornerRadius:yn,bottomRightCornerRadius:Xn,bottomLeftCornerRadius:Dp,horizontalInset:V,verticalInset:Y,style:Ie}),O.push({series:this,itemId:`scale-${Ee}`,datum:nt,datumIndex:{type:0},type:0,x0:M+(i?wt:b),y0:D+(i?v:wt),x1:M+(i?vt:x),y1:D+(i?S:vt),clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:oa,topRightCornerRadius:yn,bottomRightCornerRadius:Xn,bottomLeftCornerRadius:Dp,horizontalInset:V,verticalInset:Y,style:ze})}}u.enabled&&T.push(this.labelDatum(u,o));const Xe=i?sJ:nJ;for(let Te=0;Te<A.length;Te+=1){const de=A[Te],{value:De,text:ye,shape:Ee,size:Ne,style:xt}=de,nt=this.getTargetPoint(de),We=mt(de.rotation+Xe[de.placement]);w.push({series:this,itemId:`target-${Te}`,midPoint:nt,datum:{value:De},datumIndex:{type:1,index:Te},type:1,value:De,text:ye,x:nt.x,y:nt.y,shape:Ee,size:Ne,rotation:We,label:this.getTargetLabel(de),style:xt})}return{itemId:e,nodeData:C,tickData:k,targetData:w,labelData:T,scaleData:O}}updateSelections(e){(this.nodeDataRefresh||e)&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}highlightDatum(e){if(e!=null&&e.series===this&&e.type===1)return e}update({seriesRect:e}){const{datumSelection:t,labelSelection:i,targetSelection:s,targetLabelSelection:n,scaleSelection:o,highlightTargetSelection:a,tickSelection:r}=this;this.seriesRect=e??ja.NaN;const l=this.checkResize(e);this.updateSelections(l),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();const c=this.contextNodeData?.nodeData??[],h=this.contextNodeData?.labelData??[],d=this.contextNodeData?.targetData??[],u=this.contextNodeData?.scaleData??[],p=this.contextNodeData?.tickData??[],f=this.highlightDatum(this.ctx.highlightManager.getActiveHighlight());this.scaleSelection=this.updateScaleSelection({scaleData:u,scaleSelection:o}),this.updateScaleNodes({scaleSelection:o}),this.targetSelection=this.updateTargetSelection({targetData:d,targetSelection:s}),this.updateTargetNodes({targetSelection:s,isHighlight:!1}),this.targetLabelSelection=this.updateTargetLabelSelection({targetData:d,targetLabelSelection:n}),this.updateTargetLabelNodes({targetLabelSelection:n}),this.datumSelection=this.updateDatumSelection({nodeData:c,datumSelection:t}),this.updateDatumNodes({datumSelection:t}),this.labelSelection=this.updateLabelSelection({labelData:h,labelSelection:i}),this.updateLabelNodes({labelSelection:i}),this.highlightTargetSelection=this.updateTargetSelection({targetData:f==null?[]:[f],targetSelection:a}),this.updateTargetNodes({targetSelection:a,isHighlight:!0}),this.tickSelection=this.updateTickSelection({tickData:p,tickSelection:r}),this.updateTickNodes({tickSelection:r}),l&&this.animationState.transition("resize"),this.animationState.transition("update")}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>oz(e.nodeData.length,t.itemId))}updateDatumNodes(e){const{datumSelection:t}=e,{ctx:i}=this,s=i.animationManager.isSkipped(),n=this.getShapeFillBBox();t.each((a,r)=>{const{topLeftCornerRadius:l,topRightCornerRadius:c,bottomRightCornerRadius:h,bottomLeftCornerRadius:d}=r;a.setStyleProperties(r.style,n),a.topLeftCornerRadius=l,a.topRightCornerRadius=c,a.bottomRightCornerRadius=h,a.bottomLeftCornerRadius=d,a.pointerEvents=this.properties.bar.enabled?L.PointerEvents.All:L.PointerEvents.None,(s||a.previousDatum==null)&&a.setProperties($f(a,r))});const{horizontal:o}=this;this.datumUnion.update(t,this.itemGroup,L.Rect,(a,r,l)=>{const c=Math.min(r.x,l.x),h=Math.max(r.x+r.width,l.x+l.width),d=Math.min(r.y,l.y),u=Math.max(r.y+r.height,l.y+l.height),p=h-c,f=u-d;a.pointerEvents=L.PointerEvents.None,a.x=c,a.y=d,a.width=p,a.height=f,a.topLeftCornerRadius=o?r.topLeftCornerRadius:l.topLeftCornerRadius,a.topRightCornerRadius=l.topRightCornerRadius,a.bottomRightCornerRadius=o?l.bottomRightCornerRadius:r.bottomRightCornerRadius,a.bottomLeftCornerRadius=r.bottomLeftCornerRadius;const y=r.clipBBox,b=l.clipBBox??y;y&&b?a.clipBBox=ja.merge([y,b]).intersection(o?new ja(c,-1/0,p,1/0):new ja(-1/0,d,1/0,f)):a.clipBBox=void 0})}updateScaleSelection(e){return e.scaleSelection.update(e.scaleData,void 0,t=>oz(e.scaleData.length,t.itemId))}updateScaleNodes(e){const{scaleSelection:t}=e,i=this.getShapeFillBBox();t.each((s,n)=>{const{topLeftCornerRadius:o,topRightCornerRadius:a,bottomRightCornerRadius:r,bottomLeftCornerRadius:l}=n;s.setStyleProperties(n.style,i),s.setProperties($f(s,n)),s.topLeftCornerRadius=o,s.topRightCornerRadius=a,s.bottomRightCornerRadius=r,s.bottomLeftCornerRadius=l,s.setProperties($f(s,n))})}updateTargetSelection(e){return e.targetSelection.update(e.targetData,void 0,t=>t.itemId)}updateTargetNodes(e){const{targetSelection:t,isHighlight:i}=e;t.each((s,n)=>{const{x:o,y:a,shape:r,size:l,rotation:c}=n,h=this.getTargetStyle(i,n);s.setStyleProperties(h),s.size=l,s.shape=r==="line"?qF:r,s.translationX=o,s.translationY=a,s.rotation=c})}getTargetStyle(e,{datumIndex:t,style:i}){const s=this.getHighlightStyle(e,t);return oe(s,{...i,opacity:1})}updateTargetLabelSelection(e){return e.targetLabelSelection.update(e.targetData)}updateTargetLabelNodes(e){const{targetLabelSelection:t}=e;t.each((i,s)=>{const{x:n,y:o,text:a}=s,{offsetX:r,offsetY:l,fill:c,fontStyle:h,fontWeight:d,fontSize:u,fontFamily:p,textAlign:f,textBaseline:y}=s.label;i.visible=!0,i.x=n+r,i.y=o+l,i.text=a,i.fill=c,i.fontStyle=h,i.fontWeight=d,i.fontSize=u,i.fontFamily=p,i.textAlign=f,i.textBaseline=y})}updateTickSelection(e){return e.tickSelection.update(e.tickData,void 0,t=>t.tickId)}updateTickNodes(e){const{gaugeRect:t,properties:i}=this,s=i.defaultScale,{enabled:n,color:o,fontFamily:a=s.label.fontFamily,fontSize:r=s.label.fontSize,fontStyle:l,fontWeight:c=s.label.fontWeight,spacing:h}=i.scale.label;let{placement:d}=i.scale.label;const u=mt(i.scale.label.rotation??0);let p,f,y,b;this.horizontal?(d??(d="after"),p="center",f=d==="before"?"bottom":"top",b=this.originY+t.y+(d==="before"?-h:t.height+h)):(d??(d="before"),p=d==="before"?"end":"start",f="middle",y=this.originX+t.x+(d==="before"?-h:t.width+h)),e.tickSelection.each((x,v)=>{if(!n){x.visible=!1;return}const S=y??v.translation,M=b??v.translation;x.visible=!0,x.text=v.tickLabel,x.fill=o,x.fontFamily=a,x.fontSize=r,x.fontStyle=l,x.fontWeight=c,x.textBaseline=f,x.textAlign=p,x.x=S,x.y=M,x.rotationCenterX=S,x.rotationCenterY=M,x.rotation=u})}updateLabelSelection(e){return e.labelSelection.update(e.labelData,void 0,t=>"primary")}updateLabelNodes(e){const{labelSelection:t}=e,i=this.ctx.animationManager.isSkipped();t.each((s,n)=>{s.fill=n.fill,s.fontStyle=n.fontStyle,s.fontWeight=n.fontWeight,s.fontFamily=n.fontFamily}),(i||this.labelsHaveExplicitText())&&this.formatLabelText()}labelsHaveExplicitText(){for(const{datum:e}of this.labelSelection)if(e.text==null)return!1;return!0}formatLabelText(e){const{labelSelection:t,horizontal:i,scale:s,seriesRect:n,gaugeRect:o}=this,{x:a,y:r,width:l,height:c}=o,h=e?.label??this.properties.value;let d;if(i){const f=s.convert(h);d=new ja(a,r,f-a,c)}else{const f=s.convert(h);d=new ja(a,f,l,c-f)}const u={seriesRect:n,gaugeRect:o,barRect:d},{margin:p}=this.properties;X7(this,this.ctx,t,{padding:p,horizontal:i},u,e)}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),q7([this.datumSelection],$f),this.formatLabelText()}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"&&this.animationState.transition("skip")}animateLabelText(e={}){const{animationManager:t}=this.ctx;let i=0,s=0;if(this.labelSelection.each((n,o)=>{n.opacity=1,i=n.previousDatum?.value??e.from??o.value,s=o.value}),!this.labelsHaveExplicitText())if(i===s)this.formatLabelText({label:s});else{const n=`${this.id}_labels`;t.animate({id:n,groupId:"label",from:{label:i},to:{label:s},phase:e.phase??"update",ease:xr,onUpdate:o=>this.formatLabelText(o),onStop:()=>this.formatLabelText({label:s})})}}animateEmptyUpdateReady(){const{animationManager:e}=this.ctx,{node:t}=sz(!0,this.horizontal);pC(this.id,"node",e,[this.datumSelection],t,(i,s)=>s.itemId),pC(this.id,"label",e,[this.labelSelection],ZF,()=>"primary"),this.animateLabelText({from:0,phase:"initial"})}animateWaitingUpdateReady(){const{animationManager:e}=this.ctx,{node:t}=sz(!1,this.horizontal);pC(this.id,"node",e,[this.datumSelection],t,(i,s)=>s.itemId),this.animateLabelText()}animateReadyResize(){this.resetAllAnimation()}getSeriesDomain(){return{domain:[0,1]}}dataCount(){return Number.NaN}getSeriesRange(){return[Number.NaN,Number.NaN]}getLegendData(){return[]}getTooltipContent(e){const{id:t,properties:i}=this,{tooltip:s}=i;if(e==null)return;let n,o,a;if(e.type===0?(n=i.value,o=i.label.text,a=this.ctx.localeManager.t("ariaLabelGaugeValue")):({value:n,text:o}=i.targets[e.index],a=this.ctx.localeManager.t("ariaLabelGaugeTarget")),n!=null)return this.formatTooltipWithContext(s,{data:[{label:o,fallbackLabel:a,value:this.formatLabel(n)}]},{seriesId:t,title:void 0,datum:void 0,value:n})}pickNodeClosestDatum(e){return QF(this,e)}pickFocus(e){return JF(this,e)}getCaptionText(){return this.formatLabel(this.properties.value)}getCategoryValue(e){}datumIndexForCategoryValue(e){}hasItemStylers(){return this.properties.label.itemStyler!=null}};gC.className="LinearGaugeSeries",gC.type="linear-gauge";var oJ={minWidth:200,minHeight:200,tooltip:{enabled:!1},series:{thickness:50,defaultColorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$interpolate:[{$palette:"secondDivergingColors"},5]},L.SAFE_RANGE2_OPERATION]},scale:{defaultFill:{$path:["/1",{$palette:"fill"},{$palette:"hierarchyColors"}]},stroke:{$path:["/2",L.SAFE_STROKE_FILL_OPERATION,{$palette:"hierarchyColors"}]},strokeWidth:{$isUserOption:["./stroke",2,0]},label:{spacing:11}},bar:{strokeWidth:{$isUserOption:["./stroke",2,0]}},segmentation:{enabled:!1,interval:{},spacing:1},defaultTarget:{fill:{$ref:"foregroundColor"},stroke:{$ref:"foregroundColor"},size:10,shape:"triangle",placement:"after",spacing:5,label:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},spacing:5}},defaultScale:{label:{fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"}}},label:{...L.LABEL_BOXING_DEFAULTS,enabled:!1,placement:"inside-start",fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},fontSize:{$rem:2},minimumFontSize:12,spacing:18,color:{$ref:"chartBackgroundColor"}},margin:4,tooltip:{range:{$path:["/tooltip/range",10]}}}},cz={type:"series",name:"linear-gauge",chartType:"standalone",enterprise:!0,dependencies:[KF],version:ue,options:ha,themeTemplate:oJ,create:e=>new gC(e)},{LinearScale:fC}=L,hz=class fL extends fC{constructor(){super(...arguments),this.arcLength=0}static getNiceStepAndTickCount(t,i){const[s,n]=i;let o=fC.getTickStep(s,n,t);const a=Number.isNaN(t.maxTickCount)?1/0:t.maxTickCount,r=Math.abs(n-s)/o;let l=Math.pow(2,Math.ceil(Math.log(r)/Math.log(2)));return l>a&&(l/=2,o*=2),{count:l,step:o}}ticks(t,i=this.domain){const{arcLength:s}=this;if(!i||i.length<2||i.some(h=>!Number.isFinite(h))||s<=0)return{ticks:[],count:0};const{nice:n,interval:o}=t,[a,r]=i;if(o){const h=Math.abs(o),d=this.getPixelRange();if(!Ml((r-a)/h,d)){const u=zc(a,r,h);return{ticks:u.ticks,count:u.count}}}let l;if(n&&this.hasNiceRange()){const h=super.niceDomain(t,i);l=fL.getNiceStepAndTickCount(t,h).step}else l=fC.getTickStep(a,r,t);const c=zc(a,r,l);return{ticks:c.ticks,count:c.count}}hasNiceRange(){const t=this.range.slice().sort((s,n)=>s-n);return[Math.PI,2*Math.PI].some(s=>qe(s,t[1]-t[0]))}niceDomain(t,i=this.domain){const s=super.niceDomain(t,i);if(!this.hasNiceRange())return s;const n=s[0]>s[1],o=n?s[1]:s[0],{step:a,count:r}=fL.getNiceStepAndTickCount(t,s),l=1/a,c=a>=1?Math.ceil(o/a+r)*a:Math.ceil((o+r*a)*l)/l;return n?[c,o]:[o,c]}getPixelRange(){return this.arcLength}},{SvgPath:aJ,Rotatable:rJ,Translatable:lJ,Scalable:cJ}=L,mC=class extends rJ(cJ(lJ(aJ))){constructor(){super(...arguments),this.scalingCenterX=.5,this.scalingCenterY=.5,this.rotationCenterX=.5,this.rotationCenterY=.5}};mC.defaultPathData="M0.50245 0.53745C0.481767 0.53745 0.465 0.520683 0.465 0.5C0.465 0.479317 0.481767 0.46255 0.50245 0.46255L1 0.500012L0.50245 0.53745Z";var{getColorStops:hJ}=L,{makeSeriesTooltip:dJ,SeriesProperties:uJ,AxisLabel:pJ,Label:gJ}=L,dz=class extends gJ{};g([m],dz.prototype,"spacing",2);var Ms=class extends K{constructor(){super(...arguments),this.label=new dz}getStyle(){const{fill:e="black",fillOpacity:t=1,stroke:i="black",strokeWidth:s=0,strokeOpacity:n=1,lineDash:o=[0],lineDashOffset:a=0}=this;return{fill:e,fillOpacity:t,stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:o,lineDashOffset:a}}};g([m],Ms.prototype,"text",2),g([m],Ms.prototype,"value",2),g([m],Ms.prototype,"shape",2),g([m],Ms.prototype,"placement",2),g([m],Ms.prototype,"spacing",2),g([m],Ms.prototype,"size",2),g([m],Ms.prototype,"rotation",2),g([m],Ms.prototype,"fill",2),g([m],Ms.prototype,"fillOpacity",2),g([m],Ms.prototype,"stroke",2),g([m],Ms.prototype,"strokeWidth",2),g([m],Ms.prototype,"strokeOpacity",2),g([m],Ms.prototype,"lineDash",2),g([m],Ms.prototype,"lineDashOffset",2),g([m],Ms.prototype,"label",2);var ia=class extends K{constructor(){super(...arguments),this.enabled=!0,this.fills=new Pi(L.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}getStyle(e,t){const{enabled:i,fill:s,fills:n,fillMode:o,fillOpacity:a,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}=this;return{fill:i?s??gz(n,o,e,t):"none",fillOpacity:a,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}}};g([m],ia.prototype,"enabled",2),g([m],ia.prototype,"fills",2),g([m],ia.prototype,"fillMode",2),g([m],ia.prototype,"fill",2),g([m],ia.prototype,"fillOpacity",2),g([m],ia.prototype,"stroke",2),g([m],ia.prototype,"strokeWidth",2),g([m],ia.prototype,"strokeOpacity",2),g([m],ia.prototype,"lineDash",2),g([m],ia.prototype,"lineDashOffset",2);var Uf=class extends K{constructor(){super(...arguments),this.values=void 0,this.step=void 0,this.minSpacing=0,this.maxSpacing=1e3}};g([m],Uf.prototype,"values",2),g([m],Uf.prototype,"step",2),g([m],Uf.prototype,"minSpacing",2),g([m],Uf.prototype,"maxSpacing",2);var fJ=class extends pJ{},tn=class extends K{constructor(){super(...arguments),this.min=0,this.max=1,this.fills=new Pi(L.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.defaultFill="black",this.interval=new Uf,this.label=new fJ}getStyle(e,t,i){const{fill:s,fills:n,defaultFill:o,fillMode:a,fillOpacity:r,stroke:l,strokeWidth:c,strokeOpacity:h,lineDash:d,lineDashOffset:u}=this;return{fill:s??(e&&n.length===0?o:void 0)??gz(n,a,t,i),fillOpacity:r,stroke:l,strokeWidth:c,strokeOpacity:h,lineDash:d,lineDashOffset:u}}};g([m],tn.prototype,"min",2),g([m],tn.prototype,"max",2),g([m],tn.prototype,"fills",2),g([m],tn.prototype,"fillMode",2),g([m],tn.prototype,"fill",2),g([m],tn.prototype,"fillOpacity",2),g([m],tn.prototype,"stroke",2),g([m],tn.prototype,"strokeWidth",2),g([m],tn.prototype,"strokeOpacity",2),g([m],tn.prototype,"lineDash",2),g([m],tn.prototype,"lineDashOffset",2),g([m],tn.prototype,"defaultFill",2),g([m],tn.prototype,"interval",2),g([m],tn.prototype,"label",2);var sa=class extends K{constructor(){super(...arguments),this.enabled=!0,this.spacing=0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};g([m],sa.prototype,"enabled",2),g([m],sa.prototype,"radiusRatio",2),g([m],sa.prototype,"spacing",2),g([m],sa.prototype,"fill",2),g([m],sa.prototype,"fillOpacity",2),g([m],sa.prototype,"stroke",2),g([m],sa.prototype,"strokeWidth",2),g([m],sa.prototype,"strokeOpacity",2),g([m],sa.prototype,"lineDash",2),g([m],sa.prototype,"lineDashOffset",2);var uz=class extends Ku{};g([m],uz.prototype,"text",2);var pz=class extends vb{};g([m],pz.prototype,"text",2);var xi=class extends uJ{constructor(){super(...arguments),this.startAngle=0,this.endAngle=0,this.segmentation=new jf,this.defaultColorRange=[],this.targets=new Pi(Ms),this.defaultTarget=new Ms,this.outerRadiusRatio=1,this.innerRadiusRatio=1,this.cornerRadius=0,this.cornerMode="container",this.spacing=0,this.scale=new tn,this.bar=new ia,this.needle=new sa,this.label=new uz,this.secondaryLabel=new pz,this.tooltip=dJ()}};g([m],xi.prototype,"value",2),g([m],xi.prototype,"startAngle",2),g([m],xi.prototype,"endAngle",2),g([m],xi.prototype,"segmentation",2),g([m],xi.prototype,"defaultColorRange",2),g([m],xi.prototype,"targets",2),g([m],xi.prototype,"defaultTarget",2),g([m],xi.prototype,"outerRadiusRatio",2),g([m],xi.prototype,"innerRadiusRatio",2),g([m],xi.prototype,"outerRadius",2),g([m],xi.prototype,"innerRadius",2),g([m],xi.prototype,"cornerRadius",2),g([m],xi.prototype,"cornerMode",2),g([m],xi.prototype,"spacing",2),g([m],xi.prototype,"scale",2),g([m],xi.prototype,"bar",2),g([m],xi.prototype,"needle",2),g([m],xi.prototype,"label",2),g([m],xi.prototype,"secondaryLabel",2),g([m],xi.prototype,"tooltip",2);function gz(e,t,i,s){const{domain:n,range:o}=s,[a,r]=o,l=tt((a+r)/2+Math.PI),c=Ld(r-a);return{type:"gradient",gradient:"conic",colorSpace:"oklch",colorStops:hJ(e,i,n,t).map(({color:d,stop:u})=>(u=Math.min(Math.max(u,0),1),u=(a+c*u-l)/(2*Math.PI),u=(u%1+1)%1,{stop:u,color:d})),bounds:"series",rotation:c0(l)+90}}var{SectorBox:yC}=L;function mJ(e){const{startAngle:t,endAngle:i,clipStartAngle:s,clipEndAngle:n,innerRadius:o,outerRadius:a}=e;if(!(s==null||n==null))return new yC(Math.max(s,t),Math.min(n,i),o,a)}function fz(e,t,i){return Math.max(e,i.startAngle)<=Math.min(t,i.endAngle)}function xC(e){return e.clipStartAngle!=null&&e.clipEndAngle!=null}function bC(e,t){const{clipStartAngle:i,clipEndAngle:s,innerRadius:n,outerRadius:o}=e;return new yC(i,t?i:s,n,o)}function mz(e,t){const i=e?"initial":"update";return{node:{fromFn(o,a){const r=o.previousDatum;let{startAngle:l,endAngle:c}=r??a;const h=r!=null&&xC(r)?bC(r,e):void 0,d=xC(a)?bC(a,e):void 0;let u;return h!=null&&d!=null?u=h:h==null&&d!=null?(u=d,l=a.startAngle,c=a.endAngle):h!=null&&d==null?(u=void 0,l=a.startAngle,c=a.endAngle):e&&(c=l),{startAngle:l,endAngle:c,clipSector:u,phase:i}},toFn(o,a){const{startAngle:r,endAngle:l}=a;let c;return xC(a)&&(c=bC(a,!1)),{startAngle:r,endAngle:l,clipSector:c}},applyFn(o,a){const{startAngle:r,endAngle:l}=a;let{clipSector:c}=a;c!=null&&(c=new yC(Math.max(r,c.startAngle),Math.min(l,c.endAngle),c.innerRadius,c.outerRadius));const h=c==null||fz(r,l,c);o.startAngle=r,o.endAngle=l,o.clipSector=c,o.visible=h}},needle:{fromFn(o){let{angle:a}=o.previousDatum??o.datum;return e&&(a=t),{rotation:a,phase:i}},toFn(o,a){const{angle:r}=a;return{rotation:r}}}}}function vC(e,t){const{startAngle:i,endAngle:s}=t,n=mJ(t),o=n==null||fz(i,s,n);return{startAngle:i,endAngle:s,clipSector:n,visible:o}}function yz(e,t){const{angle:i}=t;return{rotation:i}}var yJ={top:0,middle:.5,bottom:1};function xJ(e,t,i,s,n,o){const{padding:a,textAlign:r,verticalAlign:l}=s;let c,h;if(i.each((D,k)=>{k.label==="primary"?c=k:k.label==="secondary"&&(h=k)}),c==null)return;const d=Hf(e.id,t,c,o?.label);if(d==null)return;const u=h==null?void 0:Hf(e.id,t,h,o?.secondaryLabel),p={padding:a},f=r==="center"?2:1,y=l==="middle"?2:1,b=D=>({width:Math.sqrt(Math.max(n**2-(D/y)**2,0))*f,height:Math.min(D,y*n),meta:null});let x,v,S;if(h!=null&&u!=null){const D=DE(Pe(d),c,Pe(u),h,p,b);x=D?.label,v=D?.secondaryLabel,S=D?.height??0}else{const D=bf(Pe(d),c,p,b);x=D?.[0],v=void 0,S=D?.[0].height??0}const M=S*yJ[l];i.each((D,k)=>{let I;if(k.label==="primary"?I=x:k.label==="secondary"&&(I=v),I==null){D.visible=!1;return}D.visible=!0,D.text=I.text,D.fontSize=I.fontSize,D.lineHeight=I.lineHeight,D.textAlign=r,D.textBaseline="middle";const A=k.label==="primary"?I.height/2:S-I.height/2;D.y=k.centerY+A-M,D.x=k.centerX})}var{fromToMotion:Kf,resetMotion:xz,SeriesNodePickMode:bz,createDatumId:SC,sectorBox:bJ,BBox:vJ,Group:gc,PointerEvents:Ev,Selection:fc,Sector:SJ,SectorBox:MJ,Text:vz,Marker:DJ}=L,IJ={inside:90,middle:0,outside:-90},kJ=[{textAlign:"left",textBaseline:"top"},{textAlign:"right",textBaseline:"top"},{textAlign:"right",textBaseline:"bottom"},{textAlign:"left",textBaseline:"bottom"}],AJ=[{textAlign:"right",textBaseline:"bottom"},{textAlign:"left",textBaseline:"bottom"},{textAlign:"left",textBaseline:"top"},{textAlign:"right",textBaseline:"top"}],MC=class extends L.Series{constructor(e){super({moduleCtx:e,pickModes:[bz.EXACT_SHAPE_MATCH,bz.NEAREST_NODE]}),this.centerX=0,this.centerY=0,this.radius=0,this.textAlign="center",this.verticalAlign="middle",this.properties=new xi,this.scale=new hz,this.scaleGroup=this.contentGroup.appendChild(new gc({name:"scaleGroup"})),this.itemGroup=this.contentGroup.appendChild(new gc({name:"itemGroup"})),this.itemNeedleGroup=this.contentGroup.appendChild(new gc({name:"itemNeedleGroup"})),this.itemTargetGroup=this.contentGroup.appendChild(new gc({name:"itemTargetGroup"})),this.itemTargetLabelGroup=this.contentGroup.appendChild(new gc({name:"itemTargetLabelGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new gc({name:"itemLabelGroup"})),this.highlightTargetGroup=this.highlightGroup.appendChild(new gc({name:"itemTargetLabelGroup"})),this.tickGroup=this.contentGroup.appendChild(new gc({name:"tickGroup"})),this.scaleSelection=fc.select(this.scaleGroup,()=>this.nodeFactory()),this.datumSelection=fc.select(this.itemGroup,()=>this.nodeFactory()),this.needleSelection=fc.select(this.itemNeedleGroup,mC),this.targetSelection=fc.select(this.itemTargetGroup,()=>this.markerFactory()),this.targetLabelSelection=fc.select(this.itemTargetLabelGroup,vz),this.labelSelection=fc.select(this.itemLabelGroup,vz),this.highlightTargetSelection=fc.select(this.highlightTargetGroup,()=>this.markerFactory()),this.tickSelection=fc.select(this.tickGroup,L.TransformableText),this.datumUnion=new YF,this.animationState=new he("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.animateReadyResize(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateWaitingUpdateReady()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty"},reset:"empty",skip:"ready"}}),this.scaleGroup.pointerEvents=Ev.None,this.tickGroup.pointerEvents=Ev.None,this.itemNeedleGroup.pointerEvents=Ev.None,this.itemLabelGroup.pointerEvents=Ev.None}get hasData(){return this.properties.value!=null}nodeFactory(){return new SJ}markerFactory(){const e=new DJ;return e.size=1,e}processData(){this.nodeDataRefresh=!0,this.animationState.transition("updateData")}formatLabel(e){const{min:t,max:i}=this.properties.scale;return XF(e,{min:t,max:i})}layoutScale(){const{scale:e,properties:t}=this,{seriesRectWidth:i,seriesRectHeight:s}=this.nodeDataDependencies,{scale:n,outerRadius:o}=this.properties,{min:a,max:r,label:l,interval:c}=n,h=mt(t.startAngle-90),d=mt(t.endAngle-90),p=Ld(d-h)>Math.PI,f=p||Us(1.5*Math.PI,h,d),y=p||Us(0*Math.PI,h,d),b=p||Us(.5*Math.PI,h,d),x=p||Us(1*Math.PI,h,d);let v;x&&!y?v="right":!x&&y?v="left":v="center";let S;f&&!b?S="bottom":!f&&b?S="top":S="middle";const M=bJ({startAngle:h,endAngle:d,innerRadius:0,outerRadius:.5}),D=-(M.x+M.width/2)*2,k=-(M.y+M.height/2)*2,I=Math.min(i/M.width,s/M.height);e.domain=[a,r],e.range=[h,d],e.arcLength=I/2;const{maxSpacing:A,minSpacing:C}=c,{arcLength:w}=e,T=A?Math.floor(w/A):1,O=C?Math.floor(w/C):1/0,E=Math.floor(4/Math.PI*Math.abs(e.range[0]-e.range[1])),z=Math.max(T,Math.min(O,E)),F=c.values??e.ticks({nice:[!1,!1],interval:c.step,minTickCount:T,maxTickCount:O,tickCount:z})?.ticks??[],_=Cy(F,typeof l.format=="string"?l.format:void 0),G=Ze(l),B=F.map((pe,Se)=>{let ve;if(l.formatter&&(ve=Vf(this.ctx,l.formatter,{value:pe,index:Se,domain:e.domain,boundSeries:void 0})),ve??(ve=_?.(pe)),ve==null)return;const{width:ae,height:Ie}=Ce(ve)?Ks(ve,l):G.measureLines(Dt(ve));return{index:Se,value:pe,text:ve,width:ae,height:Ie}}).filter(pe=>pe!=null),V=B.reduce((pe,Se)=>Math.max(pe,Se.width),0),Y=B.reduce((pe,Se)=>Math.max(pe,Se.height),0),X=l.enabled?Math.max(V,Y)+l.spacing:0,q=Math.max(.5*I-X,0),te=o??q;return this.centerX=i/2+D*te,this.centerY=s/2+k*te,this.radius=te,this.textAlign=v,this.verticalAlign=S,B}getShapeFillBBox(){const{centerX:e,centerY:t,radius:i}=this,s=new vJ(e-i,t-i,2*i,2*i);return{series:s,axis:s}}getTargets(){const{properties:e}=this,t=e.defaultTarget;return Array.from(e.targets).map(i=>{const{text:s=t.text,value:n=t.value??0,shape:o=t.shape??"triangle",rotation:a=t.rotation??0,placement:r=t.placement??"middle",spacing:l=t.spacing??0,size:c=t.size??0}=i,{enabled:h=t.label.enabled,color:d=t.label.color??"black",fontStyle:u=t.label.fontStyle??"normal",fontWeight:p=t.label.fontWeight??"normal",fontSize:f=t.label.fontSize,fontFamily:y=t.label.fontFamily,spacing:b=t.label.spacing??0}=i.label;return{text:s,value:n,shape:o,placement:r,spacing:l,size:c,rotation:a,label:{enabled:h,color:d,fontStyle:u,fontWeight:p,fontSize:f,fontFamily:y,spacing:b},style:i.getStyle()}})}getTargetRadius(e){const{radius:t,properties:i}=this,{innerRadiusRatio:s,outerRadiusRatio:n}=i,{placement:o,spacing:a,size:r}=e,l=t*n,c=t*s;switch(o){case"inside":return Math.max(c-a-r/2,0);case"outside":return l+a+r/2;default:return(c+l)/2}}getTargetLabel(e){const{scale:t}=this,{value:i,size:s,placement:n,label:o}=e,{spacing:a,color:r,fontStyle:l,fontWeight:c,fontSize:h,fontFamily:d}=o,u=void 0,p=t.convert(i),f=Math.trunc(tt(p)/(Math.PI/2)),y=s/2+a;let b,x,v,S;switch(n){case"outside":({textAlign:b,textBaseline:x}=kJ[f]),v=y*Math.cos(p),S=y*Math.sin(p);break;case"inside":({textAlign:b,textBaseline:x}=AJ[f]),v=-y*Math.cos(p),S=-y*Math.sin(p);break;default:b="center",x="bottom",v=0,S=-y;break}return{offsetX:v,offsetY:S,fill:r,textAlign:b,textBaseline:x,fontStyle:l,fontWeight:c,fontSize:h,fontFamily:d,lineHeight:u}}createNodeData(){const e=this.layoutScale(),{id:t,scale:i,properties:s,radius:n,centerX:o,centerY:a}=this,{value:r,innerRadiusRatio:l,outerRadiusRatio:c,segmentation:h,cornerRadius:d,cornerMode:u,needle:p,bar:f,scale:y,label:b,secondaryLabel:x}=s,{outerRadius:v=n*c,innerRadius:S=n*l,defaultColorRange:M}=s,D=this.getTargets(),k=[],I=[],A=[],C=[],w=[],T=u==="item",O=i.convert(i.domain[0]),E=i.convert(r),z=Math.ceil(Ld(E-O)*n);let F=h.enabled?h.interval.getSegments(i,z):void 0;const _=f.getStyle(M,i),G=y.getStyle(f.enabled,M,i);if(F==null&&T){const B=Math.min(...i.domain),V=Math.max(...i.domain),Y={value:r,segmentStart:B,segmentEnd:V},q=Math.min(d,(v-S)/2)/((S+v)/2);k.push({series:this,itemId:"value",datum:Y,datumIndex:{type:0},type:0,centerX:o,centerY:a,outerRadius:v,innerRadius:S,startAngle:O-q,endAngle:E+q,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:d,endCornerRadius:d,style:_}),w.push({series:this,itemId:"scale",datum:Y,datumIndex:{type:0},type:0,centerX:o,centerY:a,outerRadius:v,innerRadius:S,startAngle:i.range[0]-q,endAngle:i.range[1]+q,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:d,endCornerRadius:d,style:G})}else{F??(F=i.domain);for(let B=0;B<F.length-1;B++){const V=F[B],Y=F[B+1],X={value:r,segmentStart:V,segmentEnd:Y},q=B===0,te=B===F.length-2,pe=i.convert(V),Se=i.convert(Y);k.push({series:this,itemId:`value-${B}`,datum:X,datumIndex:{type:0},type:0,centerX:o,centerY:a,outerRadius:v,innerRadius:S,startAngle:pe,endAngle:Se,clipStartAngle:O,clipEndAngle:E,startCornerRadius:T||q?d:0,endCornerRadius:T||te?d:0,style:_}),w.push({series:this,itemId:`scale-${B}`,datum:X,datumIndex:{type:0},type:0,centerX:o,centerY:a,outerRadius:v,innerRadius:S,startAngle:pe,endAngle:Se,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:T||q?d:0,endCornerRadius:T||te?d:0,style:G})}}if(!p.enabled&&b.enabled){const{text:B,color:V,fontSize:Y,minimumFontSize:X,fontStyle:q,fontWeight:te,fontFamily:pe,lineHeight:Se,formatter:ve=ae=>this.formatLabel(ae.value)}=b;C.push({label:"primary",centerX:o,centerY:a,text:B,value:r,fill:V,fontSize:Y,minimumFontSize:X,fontStyle:q,fontWeight:te,fontFamily:pe,lineHeight:Se,formatter:ve})}if(!p.enabled&&x.enabled){const{text:B,color:V,fontSize:Y,minimumFontSize:X,fontStyle:q,fontWeight:te,fontFamily:pe,lineHeight:Se,formatter:ve}=x;C.push({label:"secondary",centerX:o,centerY:a,text:B,value:r,fill:V,fontSize:Y,minimumFontSize:X,fontStyle:q,fontWeight:te,fontFamily:pe,lineHeight:Se,formatter:ve})}if(p.enabled){let B=p.radiusRatio==null?S:n*p.radiusRatio;B=Math.max(B-p.spacing,0);const V=i.convert(r);A.push({centerX:o,centerY:a,radius:B,angle:V,series:this})}for(let B=0;B<D.length;B+=1){const V=D[B],{value:Y,text:X,size:q,shape:te,style:pe}=V;if(Y<Math.min(...i.domain)||Y>Math.max(...i.domain))continue;const Se=this.getTargetRadius(V),ve=i.convert(Y),ae=mt(V.rotation+IJ[V.placement]);I.push({series:this,itemId:`target-${B}`,midPoint:{x:Se*Math.cos(ve)+o,y:Se*Math.sin(ve)+a},datum:{value:Y},datumIndex:{type:1,index:B},type:1,value:Y,text:X,centerX:o,centerY:a,shape:te,radius:Se,angle:ve,rotation:ae,size:q,label:this.getTargetLabel(V),style:pe})}return{itemId:t,nodeData:k,needleData:A,targetData:I,labelData:C,scaleData:w,tickData:e}}updateSelections(e){(this.nodeDataRefresh||e)&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}highlightDatum(e){if(e!=null&&e.series===this&&e.type===1)return e}update({seriesRect:e}){const{datumSelection:t,labelSelection:i,needleSelection:s,targetSelection:n,targetLabelSelection:o,scaleSelection:a,highlightTargetSelection:r,tickSelection:l}=this,c=this.checkResize(e);this.updateSelections(c),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();const h=this.contextNodeData?.nodeData??[],d=this.contextNodeData?.labelData??[],u=this.contextNodeData?.needleData??[],p=this.contextNodeData?.targetData??[],f=this.contextNodeData?.scaleData??[],y=this.contextNodeData?.tickData??[],b=this.highlightDatum(this.ctx.highlightManager.getActiveHighlight());this.scaleSelection=this.updateScaleSelection({scaleData:f,scaleSelection:a}),this.updateScaleNodes({scaleSelection:a}),this.needleSelection=this.updateNeedleSelection({needleData:u,needleSelection:s}),this.updateNeedleNodes({needleSelection:s}),this.targetSelection=this.updateTargetSelection({targetData:p,targetSelection:n}),this.updateTargetStyles({targetSelection:n,isHighlight:!1}),this.updateTargetNodes({targetSelection:n}),this.targetLabelSelection=this.updateTargetLabelSelection({targetData:p,targetLabelSelection:o}),this.updateTargetLabelNodes({targetLabelSelection:o}),this.datumSelection=this.updateDatumSelection({nodeData:h,datumSelection:t}),this.updateDatumNodes({datumSelection:t}),this.labelSelection=this.updateLabelSelection({labelData:d,labelSelection:i}),this.updateLabelNodes({labelSelection:i}),this.highlightTargetSelection=this.updateTargetSelection({targetData:b==null?[]:[b],targetSelection:r}),this.updateTargetStyles({targetSelection:r,isHighlight:!0}),this.updateTargetNodes({targetSelection:r}),this.tickSelection=this.updateTickSelection({tickData:y,tickSelection:l}),this.updateTickNodes({tickSelection:l}),c&&this.animationState.transition("resize"),this.animationState.transition("update")}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>SC(e.nodeData.length,t.itemId))}updateDatumNodes(e){const{datumSelection:t}=e,{ctx:i,properties:s}=this,{segmentation:n}=s,o=n.spacing??0,a=i.animationManager.isSkipped(),r=this.getShapeFillBBox();t.each((l,c)=>{const{centerX:h,centerY:d,innerRadius:u,outerRadius:p,startCornerRadius:f,endCornerRadius:y}=c;l.centerX=h,l.centerY=d,l.innerRadius=u,l.outerRadius=p,l.pointerEvents=this.properties.bar.enabled?L.PointerEvents.All:L.PointerEvents.None,l.setStyleProperties(c.style,r),l.startOuterCornerRadius=f,l.startInnerCornerRadius=f,l.endOuterCornerRadius=y,l.endInnerCornerRadius=y,l.radialEdgeInset=(o+l.strokeWidth)/2,l.concentricEdgeInset=l.strokeWidth/2,(a||l.previousDatum==null)&&l.setProperties(vC(l,c))}),this.datumUnion.update(t,this.itemGroup,L.Sector,(l,c,h)=>{l.clipSector??(l.clipSector=new MJ(Number.NaN,Number.NaN,Number.NaN,Number.NaN)),l.centerX=c.centerX,l.centerY=c.centerY,l.outerRadius=l.clipSector.outerRadius=c.outerRadius,l.innerRadius=l.clipSector.innerRadius=c.innerRadius,l.startAngle=l.clipSector.startAngle=c.startAngle,l.startInnerCornerRadius=c.startInnerCornerRadius,l.startOuterCornerRadius=c.startOuterCornerRadius,l.endAngle=h.endAngle,l.clipSector.endAngle=h.clipSector?.endAngle??h.endAngle,l.endInnerCornerRadius=h.endInnerCornerRadius,l.endOuterCornerRadius=h.endOuterCornerRadius,l.pointerEvents=L.PointerEvents.None})}updateScaleSelection(e){return e.scaleSelection.update(e.scaleData,void 0,t=>SC(e.scaleData.length,t.itemId))}updateScaleNodes(e){const{scaleSelection:t}=e,{segmentation:i}=this.properties,s=i.spacing??0,n=this.getShapeFillBBox();t.each((o,a)=>{const{centerX:r,centerY:l,innerRadius:c,outerRadius:h,startCornerRadius:d,endCornerRadius:u}=a;o.centerX=r,o.centerY=l,o.innerRadius=c,o.outerRadius=h,o.setStyleProperties(a.style,n),o.startOuterCornerRadius=d,o.startInnerCornerRadius=d,o.endOuterCornerRadius=u,o.endInnerCornerRadius=u,o.radialEdgeInset=(s+o.strokeWidth)/2,o.concentricEdgeInset=o.strokeWidth/2,o.setProperties(vC(o,a))})}updateNeedleSelection(e){return e.needleSelection.update(e.needleData,void 0,()=>SC(0))}updateNeedleNodes(e){const{needleSelection:t}=e,{fill:i,fillOpacity:s,stroke:n,strokeOpacity:o,strokeWidth:a,lineDash:r,lineDashOffset:l}=this.properties.needle,c=this.ctx.animationManager.isSkipped();t.each((h,d)=>{const{centerX:u,centerY:p,radius:f}=d,y=f*2;h.d=mC.defaultPathData,h.setStyleProperties({fill:i,fillOpacity:s,stroke:n,strokeOpacity:o,strokeWidth:a/y,lineDash:r.map(b=>b/y),lineDashOffset:l/y}),h.translationX=u,h.translationY=p,h.scalingX=y,h.scalingY=y,c&&h.setProperties(yz(h,d))})}updateTargetSelection(e){return e.targetSelection.update(e.targetData,void 0,t=>t.itemId)}updateTargetStyles({targetSelection:e,isHighlight:t}){e.each((i,s)=>{s.style=this.getTargetStyle(t,s)})}updateTargetNodes({targetSelection:e}){e.each((t,i)=>{const{centerX:s,centerY:n,angle:o,radius:a,shape:r,size:l,rotation:c}=i;t.setStyleProperties(i.style),t.size=l,t.shape=r==="line"?qF:r,t.translationX=s+a*Math.cos(o),t.translationY=n+a*Math.sin(o),t.rotation=o+c})}getTargetStyle(e,{datumIndex:t,style:i}){const s=this.getHighlightStyle(e,t);return oe(s,{...i,opacity:1})}updateTargetLabelSelection(e){return e.targetLabelSelection.update(e.targetData,void 0,t=>t.itemId)}updateTargetLabelNodes(e){const{targetLabelSelection:t}=e;t.each((i,s)=>{const{centerX:n,centerY:o,radius:a,angle:r,text:l}=s,{offsetX:c,offsetY:h,fill:d,fontStyle:u,fontWeight:p,fontSize:f,fontFamily:y,textAlign:b,textBaseline:x}=s.label;if(l==null){i.visible=!1;return}i.visible=!0,i.x=n+a*Math.cos(r)+c,i.y=o+a*Math.sin(r)+h,i.text=l,i.fill=d,i.fontStyle=u,i.fontWeight=p,i.fontSize=f,i.fontFamily=y,i.textAlign=b,i.textBaseline=x})}updateLabelSelection(e){return e.labelSelection.update(e.labelData,void 0,t=>t.label)}updateLabelNodes(e){const{labelSelection:t}=e,i=this.ctx.animationManager.isSkipped();t.each((s,n)=>{s.fill=n.fill,s.fontStyle=n.fontStyle,s.fontWeight=n.fontWeight,s.fontFamily=n.fontFamily}),(i||this.labelsHaveExplicitText())&&this.formatLabelText()}updateTickSelection(e){return e.tickSelection.update(e.tickData,void 0,t=>t.index)}updateTickNodes(e){const{scale:t,radius:i,centerX:s,centerY:n,properties:o}=this,{enabled:a,color:r,fontFamily:l,fontSize:c,fontStyle:h,fontWeight:d,spacing:u}=o.scale.label,p=mt(o.scale.label.rotation??0);e.tickSelection.each((f,y)=>{if(!a){f.visible=!1;return}f.visible=!0,f.text=y.text,f.fill=r,f.fontFamily=l,f.fontSize=c,f.fontStyle=h,f.fontWeight=d,f.textAlign="center",f.textBaseline="middle";const b=t.convert(y.value),{width:x,height:v}=y,S=Math.abs(i*Math.cos(b)),M=Math.abs(i*Math.sin(b)),D=Math.min(Math.max(Math.abs(i/Math.tan(b)),S-x/2),S+x/2),k=Math.min(Math.max(Math.abs(i*Math.tan(b)),M-v/2),M+v/2),I=Math.hypot(D,k),A=s+(I+u)*Math.cos(b),C=n+(I+u)*Math.sin(b);f.x=A,f.y=C,f.rotationCenterX=A,f.rotationCenterY=C,f.rotation=p})}labelsHaveExplicitText(){for(const{datum:e}of this.labelSelection)if(e.text==null)return!1;return!0}formatLabelText(e){const{labelSelection:t,radius:i,textAlign:s,verticalAlign:n}=this,{spacing:o,innerRadiusRatio:a}=this.properties;xJ(this,this.ctx,t,{padding:o,textAlign:s,verticalAlign:n},i*a,e)}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),xz([this.datumSelection],vC),xz([this.needleSelection],yz),this.formatLabelText()}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"&&this.animationState.transition("skip")}animateLabelText(e={}){const{animationManager:t}=this.ctx;let i,s,n,o;if(this.labelSelection.each((a,r)=>{a.opacity=1,r.label==="primary"?(i=a.previousDatum?.value??e.from??r.value,s=r.value):r.label==="secondary"&&(n=a.previousDatum?.value??e.from??r.value,o=r.value)}),!this.labelsHaveExplicitText())if(s==null||o==null)this.formatLabelText();else if(i===s&&n===o)this.formatLabelText({label:s,secondaryLabel:o});else{const a=`${this.id}_labels`;t.animate({id:a,groupId:"label",from:{label:i,secondaryLabel:n},to:{label:s,secondaryLabel:o},phase:e.phase??"update",onUpdate:r=>this.formatLabelText(r),onStop:()=>this.formatLabelText({label:s,secondaryLabel:o})})}}animateEmptyUpdateReady(){const{animationManager:e}=this.ctx,{node:t,needle:i}=mz(!0,this.scale.range[0]);Kf(this.id,"node",e,[this.datumSelection],t,(s,n)=>n.itemId),Kf(this.id,"needle",e,[this.needleSelection],i,()=>"needle"),Kf(this.id,"label",e,[this.labelSelection],ZF,(s,n)=>n.label),this.animateLabelText({from:this.properties.scale.min,phase:"initial"})}animateWaitingUpdateReady(){const{animationManager:e}=this.ctx,{node:t,needle:i}=mz(!1,this.scale.range[0]);Kf(this.id,"node",e,[this.datumSelection],t,(s,n)=>n.itemId),Kf(this.id,"needle",e,[this.needleSelection],i,()=>"needle"),this.animateLabelText()}animateReadyResize(){this.resetAllAnimation()}dataCount(){return Number.NaN}getSeriesDomain(){return{domain:[Number.NaN,Number.NaN]}}getSeriesRange(){return[Number.NaN,Number.NaN]}getLegendData(){return[]}getTooltipContent(e){const{id:t,properties:i}=this,{tooltip:s}=i;let n,o,a;if(e.type===0?(n=i.value,o=i.label.text,a=this.ctx.localeManager.t("ariaLabelGaugeValue")):({value:n,text:o}=i.targets[e.index],a=this.ctx.localeManager.t("ariaLabelGaugeTarget")),n!=null)return this.formatTooltipWithContext(s,{data:[{label:o,fallbackLabel:a,value:this.formatLabel(n)}]},{seriesId:t,title:void 0,datum:void 0,value:n})}pickNodeClosestDatum(e){return QF(this,e)}pickFocus(e){return JF(this,e)}getCaptionText(){const{value:e}=this.properties,t=[];return t.push(this.formatLabel(e)),this.labelSelection.each((i,s)=>{const n=Hf(this.id,this.ctx,s);n!=null&&t.push(Pe(n))}),t.join(". ")}getCategoryValue(e){}datumIndexForCategoryValue(e){}hasItemStylers(){return this.properties.label.itemStyler!=null}};MC.className="RadialGaugeSeries",MC.type="radial-gauge";var Sz={type:"series",name:"radial-gauge",chartType:"standalone",enterprise:!0,dependencies:[KF],version:ue,options:Ic,themeTemplate:{minWidth:200,minHeight:200,tooltip:{enabled:!1},series:{outerRadiusRatio:1,innerRadiusRatio:.8,startAngle:270,endAngle:450,defaultColorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$interpolate:[{$palette:"secondDivergingColors"},5]},L.SAFE_RANGE2_OPERATION]},scale:{defaultFill:{$path:["/1",{$palette:"fill"},{$palette:"hierarchyColors"}]},stroke:{$path:["/2",L.SAFE_STROKE_FILL_OPERATION,{$palette:"hierarchyColors"}]},strokeWidth:{$isUserOption:["./stroke",2,0]},label:{fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},spacing:12}},bar:{strokeWidth:{$isUserOption:["./stroke",2,0]}},segmentation:{enabled:!1,interval:{},spacing:2},defaultTarget:{fill:{$ref:"foregroundColor"},stroke:{$ref:"foregroundColor"},size:10,shape:"triangle",placement:"outside",spacing:5,label:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},spacing:5}},needle:{enabled:!1,fill:{$ref:"foregroundColor"},spacing:10},label:{...L.LABEL_BOXING_DEFAULTS,enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:56,minimumFontSize:18/56,fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"}},secondaryLabel:{...L.LABEL_BOXING_DEFAULTS,enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:Si.LARGE},minimumFontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"subtleTextColor"}},tooltip:{range:{$path:["/tooltip/range",10]}}}},create:e=>new MC(e)},Mz=[cz,Sz];function DC(e,t,i){const s=(o,a,r,l)=>{let c=e[0];for(let h=o;r>0?h<=a:h>a;h+=r){const d=e[h];if(l(c,d))return!0;c=d}return!1},n=Math.floor(e.length/2);return s(t,n,t,i)?!0:s(e.length-t,n,-t,i)}var{AxisInterval:CJ}=L,IC=class extends CJ{};g([m],IC.prototype,"minSpacing",2);var{Group:kC}=L,na=class extends K{constructor(){super(...arguments),this.fontSize=14,this.fontFamily="Verdana, sans-serif",this.padding=5,this.color="rgba(87, 87, 87, 1)"}};g([m],na.prototype,"enabled",2),g([m],na.prototype,"text",2),g([m],na.prototype,"fontStyle",2),g([m],na.prototype,"fontWeight",2),g([m],na.prototype,"fontSize",2),g([m],na.prototype,"fontFamily",2),g([m],na.prototype,"padding",2),g([m],na.prototype,"color",2),g([m],na.prototype,"parallel",2);var _s=class extends K{constructor(){super(...arguments),this.id=Mi(this),this.defaultColorRange=[],this.shape="polygon",this.label=new na,this.scale=void 0,this.clippedRange=[-1/0,1/0],this.gridLength=0,this.sideFlag=-1,this.parallelFlipRotation=0,this.regularFlipRotation=0,this.direction="angle",this.axisInnerRadius=0,this.axisOuterRadius=0,this.lineGroup=new kC({name:this.id}),this.rangeGroup=new kC({name:this.id}),this.labelGroup=new kC({name:this.id}),this._isRange=void 0}assignCrossLineGroup(e,t){e!==this._isRange&&(e?this.rangeGroup.appendChild(t):this.lineGroup.appendChild(t)),this._isRange=e}setSectorNodeProps(e){e.fill=this.fill,e.fillOpacity=this.fillOpacity??1,e.stroke=this.stroke,e.strokeOpacity=this.strokeOpacity??1,e.strokeWidth=this.strokeWidth??1,e.lineDash=this.lineDash}setLabelNodeProps(e,t,i,s,n){const{label:o}=this;e.x=t,e.y=i,e.text=o.text,e.textAlign="center",e.textBaseline=s,e.rotation=n,e.rotationCenterX=t,e.rotationCenterY=i,e.fill=o.color,e.fontFamily=o.fontFamily,e.fontSize=o.fontSize,e.fontStyle=o.fontStyle,e.visible=!0}};_s.className="PolarCrossLine",g([m],_s.prototype,"enabled",2),g([m],_s.prototype,"type",2),g([m],_s.prototype,"range",2),g([m],_s.prototype,"value",2),g([m],_s.prototype,"defaultColorRange",2),g([m],_s.prototype,"fill",2),g([m],_s.prototype,"fillOpacity",2),g([m],_s.prototype,"stroke",2),g([m],_s.prototype,"strokeWidth",2),g([m],_s.prototype,"strokeOpacity",2),g([m],_s.prototype,"lineDash",2),g([m],_s.prototype,"shape",2),g([m],_s.prototype,"label",2);var{getCrossLineValue:LJ,validateCrossLineValue:wJ,Group:TJ,Path:Dz,Sector:NJ,RotatableText:OJ,ContinuousScale:EJ}=L,AC=class extends _s{constructor(){super(),this.direction="angle",this.polygonNode=new Dz,this.sectorNode=new NJ,this.lineNode=new Dz,this.crossLineRange=new TJ,this.labelNode=new OJ,this.ticks=[],this.crossLineRange.append(this.polygonNode),this.crossLineRange.append(this.sectorNode),this.crossLineRange.append(this.lineNode),this.labelGroup.append(this.labelNode)}visibilityCheck(){if(!EJ.is(this.scale))return!0;const[e,t]=this.scale.domain,i=LJ(this);if(this.type==="range"){const[s,n]=i;return s>=e&&s<=t&&n>=s&&n<=t}else return i>=e&&i<=t}update(e){const{scale:t}=this;if(!t||!wJ(this,t)||!this.visibilityCheck()){this.rangeGroup.visible=!1,this.lineGroup.visible=!1,this.labelGroup.visible=!1;return}this.rangeGroup.visible=e,this.lineGroup.visible=e,this.labelGroup.visible=e,this.updateLineNode(e),this.updatePolygonNode(e),this.updateSectorNode(e),this.updateLabelNode(e)}updateLineNode(e){const{scale:t,type:i,value:s,lineNode:n}=this;if(!e||i!=="line"||!t){n.visible=!1;return}const o=t.convert(s);if(Number.isNaN(o)){n.visible=!1;return}const{axisInnerRadius:a,axisOuterRadius:r}=this;n.visible=!0,n.stroke=this.stroke,n.strokeOpacity=this.strokeOpacity??1,n.strokeWidth=this.strokeWidth??1,n.fill=void 0,n.lineDash=this.lineDash;const l=r*Math.cos(o),c=r*Math.sin(o),h=a*Math.cos(o),d=a*Math.sin(o);n.path.clear(!0),n.path.moveTo(h,d),n.path.lineTo(l,c),this.assignCrossLineGroup(!1,this.crossLineRange)}updatePolygonNode(e){const{polygonNode:t,range:i,scale:s,shape:n,type:o,ticks:a}=this;if(!e||o!=="range"||n!=="polygon"||!s||!i){t.visible=!1;return}const{axisInnerRadius:r,axisOuterRadius:l}=this,c=a.indexOf(i[0]),h=a.indexOf(i[1]),u=(c<=h?a.slice(c,h+1):a.slice(c).concat(a.slice(0,h+1))).map(f=>s.convert(f));t.visible=!0,this.setSectorNodeProps(t);const{path:p}=t;p.clear(!0);for(const[f,y]of u.entries()){const b=l*Math.cos(y),x=l*Math.sin(y);f===0?p.moveTo(b,x):p.lineTo(b,x)}if(r===0)p.lineTo(0,0);else{const f=u.slice().reverse();for(const y of f){const b=r*Math.cos(y),x=r*Math.sin(y);p.lineTo(b,x)}}t.path.closePath(),this.assignCrossLineGroup(!0,this.crossLineRange)}updateSectorNode(e){const{sectorNode:t,range:i,scale:s,shape:n,type:o}=this;if(!e||o!=="range"||n!=="circle"||!s||!i){t.visible=!1;return}const{axisInnerRadius:a,axisOuterRadius:r}=this,l=i.map(d=>s.convert(d)),c=s.step??0,h=s instanceof L.BandScale?c/2:0;t.visible=!0,this.setSectorNodeProps(t),t.centerX=0,t.centerY=0,t.innerRadius=a,t.outerRadius=r,t.startAngle=l[0]-h,t.endAngle=l[1]+h,this.assignCrossLineGroup(!0,this.crossLineRange)}updateLabelNode(e){const{label:t,labelNode:i,range:s,scale:n,type:o,ticks:a}=this;if(!e||t.enabled===!1||!t.text||!n||o==="range"&&!s){i.visible=!1;return}i.visible=!0;const{axisInnerRadius:r,axisOuterRadius:l}=this;let c,h,d,u;if(o==="line"){const p=tt(n.convert(this.value)),f=1.5*Math.PI,y=qe(p,f)||p>f||p<Math.PI/2,b=(r+l)/2*Math.cos(p),x=(r+l)/2*Math.sin(p);c=b+t.padding*Math.cos(p+Math.PI/2),h=x+t.padding*Math.sin(p+Math.PI/2),u=y?"top":"bottom",d=y?p:p-Math.PI}else{const[p,f]=s.map(v=>tt(n.convert(v)));let y=(p+f)/2;p>f&&(y-=Math.PI),y=tt(y);const b=(qe(y,0)||y>0)&&y<Math.PI;let x;this.shape==="circle"||a.length<3?x=l-t.padding:x=l*Math.cos(Math.PI/a.length)-t.padding,c=x*Math.cos(y),h=x*Math.sin(y),u=b?"bottom":"top",d=b?y-Math.PI/2:y+Math.PI/2}this.setLabelNodeProps(i,c,h,u,d)}};AC.className="AngleCrossLine";var{Path:PJ,RotatableText:RJ,Transformable:FJ,BBox:zJ,Selection:Iz,Line:kz}=L,CC=class extends L.AxisLabel{constructor(){super(...arguments),this.orientation="fixed"}};g([m],CC.prototype,"orientation",2);var Yf=class extends L.PolarAxis{constructor(e,t){super(e,t),this.startAngle=0,this.endAngle=void 0,this.tickLineGroupSelection=Iz.select(this.tickLineGroup,kz,!1),this.gridLineGroupSelection=Iz.select(this.gridLineGroup,kz,!1),this.labelData=[],this.tickData=[],this.radiusLineGroup=this.axisGroup.appendChild(new L.TransformableGroup),this.radiusLine=this.radiusLineGroup.appendChild(new PJ),this.includeInvisibleDomains=!0}get direction(){return"angle"}createLabel(){return new CC}calculateRotations(){const e=mt(this.startAngle),t=tt(e),i=tt(e-Math.PI/2);return{rotation:e,parallelFlipRotation:t,regularFlipRotation:i}}calculateTickLayout(e){const{nice:t,scale:i}=this,s={nice:[t,t],interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0},n=t?i.niceDomain(s,e):e,o=this.generateAngleTicks(n);this.tickData=o;const a=o.map(l=>l.value),r=a.reduce((l,c)=>Math.max(typeof c=="number"?vc(c):0,l),0);return{niceDomain:n,tickDomain:n,ticks:a,rawTickCount:void 0,fractionDigits:r,timeInterval:void 0,bbox:this.getBBox()}}update(){super.update(),this.updateRadiusLine(),this.updateGridLines(),this.updateTickLines()}normalizedAngles(){const e=tt(-Math.PI/2+mt(this.startAngle)),t=this.endAngle==null?2*Math.PI:Ld(mt(this.endAngle)-mt(this.startAngle)),i=e+t;return[e,i]}computeRange(){this.range=this.normalizedAngles()}updateSelections(){const e=this.tickData;this.gridLineGroupSelection.update(this.gridLength&&this.gridLine.enabled?e:[]),this.tickLineGroupSelection.update(this.tick.enabled?e:[]),this.tickLabelGroupSelection.update(this.label.enabled?e:[]),this.gridLineGroupSelection.cleanup(),this.tickLineGroupSelection.cleanup(),this.tickLabelGroupSelection.cleanup()}updatePosition(){super.updatePosition();const{translation:e,radiusLineGroup:t}=this,i=Math.floor(e.x),s=Math.floor(e.y);t.translationX=i,t.translationY=s}updateRadiusLine(){const e=this.radiusLine,{path:t}=e;t.clear(!0);const{points:i,closePath:s}=this.getAxisLinePoints();for(const{x:n,y:o,moveTo:a,arc:r,radius:l=0,startAngle:c=0,endAngle:h=0}of i)r?t.arc(n,o,l,c,h):a?t.moveTo(n,o):t.lineTo(n,o);s&&t.closePath(),e.visible=this.line.enabled,e.stroke=this.line.stroke,e.strokeWidth=this.line.width,e.fill=void 0}getAxisLinePoints(){const{scale:e,shape:t,gridLength:i}=this,[s,n]=this.range,o=qe(n-s,2*Math.PI),a=[];if(t==="circle")o?a.push({x:i,y:0,moveTo:!0},{x:0,y:0,radius:i,startAngle:0,endAngle:2*Math.PI,arc:!0,moveTo:!1}):a.push({x:i*Math.cos(s),y:i*Math.sin(s),moveTo:!0},{x:0,y:0,radius:i,startAngle:tt(s),endAngle:tt(n),arc:!0,moveTo:!1});else if(t==="polygon"){const r=e.ticks({nice:[this.nice,this.nice],interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0})?.ticks?.map(l=>e.convert(l));if(r&&r.length>2)for(const[l,c]of r.entries()){const h=i*Math.cos(c),d=i*Math.sin(c),u=l===0;a.push({x:h,y:d,moveTo:u})}}return{points:a,closePath:o}}updateGridLines(){const{scale:e,gridLength:t,gridLine:{style:i,width:s},innerRadiusRatio:n}=this;if(!(i&&t>0))return;const o=t*n,a=i.length;this.gridLineGroupSelection.each((r,l,c)=>{const{value:h}=l,{stroke:d,lineDash:u}=i[c%a],p=e.convert(h);r.x1=o*Math.cos(p),r.y1=o*Math.sin(p),r.x2=t*Math.cos(p),r.y2=t*Math.sin(p),r.stroke=d,r.strokeWidth=s,r.lineDash=u,r.fill=void 0}),this.gridLineGroupSelection.cleanup()}updateLabels(){const{label:e,tickLabelGroupSelection:t}=this;t.each((i,s,n)=>{const o=this.labelData[n];if(!o||o.hidden){i.visible=!1;return}i.text=o.text,i.setFont(e),i.fill=e.color,i.x=o.x,i.y=o.y,i.setAlign(o),i.setBoxing(e),i.visible=!0,o.rotation?(i.rotation=o.rotation,i.rotationCenterX=o.x,i.rotationCenterY=o.y):i.rotation=0})}updateTickLines(){const{scale:e,gridLength:t,tick:i,tickLineGroupSelection:s}=this;s.each((n,o)=>{const{value:a}=o,r=e.convert(a),l=Math.cos(r),c=Math.sin(r);n.x1=t*l,n.y1=t*c,n.x2=(t+i.size)*l,n.y2=(t+i.size)*c,n.stroke=i.stroke,n.strokeWidth=i.width})}createLabelNodeData(e,t,i){const{label:s,gridLength:n,scale:o,tick:a}=this;if(!s.enabled)return[];const r=new RJ,l=i.x-this.translation.x,c=i.x+i.width-this.translation.x,{fractionDigits:h}=this.layout.label,d=this.tickFormatter(this.scale.domain,this.tickData,!1,h),u=e.map((p,f)=>{const{value:y}=p,b=n+s.spacing+a.size,x=o.convert(y),v=Math.cos(x),S=Math.sin(x),M=b*v,D=b*S,{textAlign:k,textBaseline:I}=this.getLabelAlign(x),A=f===e.length-1&&y!==e[0]&&qe(tt(x),tt(o.convert(e[0]))),C=this.getLabelRotation(x);let w=d(y,f);r.text=w,r.x=M,r.y=D,r.setFont(s),r.textAlign=k,r.textBaseline=I,r.rotation=C,C&&(r.rotationCenterX=M,r.rotationCenterY=D);let T=C?FJ.toCanvas(r):r.getBBox();if(T&&t.hideWhenNecessary&&!C){const O=l-T.x,E=T.x+T.width-c,z=1;if(O>z||E>z){const _={maxWidth:T.width-Math.max(O,E),font:s,textWrap:"never"};w=Rd(w,_),r.text=w,T=r.getBBox()}}return{text:w,x:M,y:D,textAlign:k,textBaseline:I,hidden:w===""||(p.hidden??A),rotation:C,box:T}});return s.avoidCollisions&&this.avoidLabelCollisions(u),u}computeLabelsBBox(e,t){this.labelData=this.createLabelNodeData(this.tickData,e,t);const i=this.labelData.map(({box:s})=>s).filter(s=>s!=null);return!this.label.enabled||i.length===0?null:zJ.merge(i)}getLabelOrientation(){const{label:e}=this;return e instanceof CC?e.orientation:"fixed"}getLabelRotation(e){let t=mt(this.label.rotation??0);e=tt(e);const i=this.getLabelOrientation();return i==="parallel"?(t+=e,e>=0&&e<Math.PI?t-=Math.PI/2:t+=Math.PI/2):i==="perpendicular"&&(t+=e,e>=Math.PI/2&&e<1.5*Math.PI&&(t+=Math.PI)),t}getLabelAlign(e){const t=Math.cos(e),i=Math.sin(e);let s,n;const o=this.getLabelOrientation(),a=qe(t,0),r=qe(i,0),l=qe(t,1),c=qe(i,-1),h=t>0&&!a,d=i>0&&!r;return o==="parallel"?(s="center",n=l&&r||d?"top":"bottom"):o==="perpendicular"?(s=c||h?"left":"right",n="middle"):(s="right",a?s="center":h&&(s="left"),n="bottom",r?n="middle":d&&(n="top")),{textAlign:s,textBaseline:n}}updateCrossLines(){const{shape:e,gridLength:t,innerRadiusRatio:i}=this;for(const s of this.crossLines)s instanceof AC&&(s.ticks=this.tickData.map(n=>n.value),s.shape=e,s.axisOuterRadius=t,s.axisInnerRadius=t*i);super.updateCrossLines()}};Yf.CrossLineConstructor=AC,g([m],Yf.prototype,"startAngle",2),g([m],Yf.prototype,"endAngle",2);var{CategoryScale:BJ}=L,Vh=class extends Yf{constructor(e){super(e,new BJ),this.groupPaddingInner=0,this.paddingInner=0,this.interval=new IC}hasDefinedDomain(){return!1}generateAngleTicks(e){const{scale:t,gridLength:i}=this,{values:s,minSpacing:n}=this.interval,o={nice:[this.nice,this.nice],interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0},a=s??t.ticks(o,e)?.ticks??[];if(a.length<2||n==null)return a.map(d=>({value:d,visible:!0}));const r=a[0],l=t.convert(r),c=i*Math.cos(l),h=i*Math.sin(l);for(let d=1;d<a.length-1;d++){const u=a[d],p=t.convert(u);if(p-l>Math.PI)break;const f=i*Math.cos(p),y=i*Math.sin(p);if(Math.hypot(f-c,y-h)>n){const x=new Set([r]);return DC(a,d,(v,S)=>{x.add(S)}),a.map(v=>{const S=x.has(v);return{value:v,visible:S}})}}return[{value:r,visible:!0}]}avoidLabelCollisions(e){const{minSpacing:t}=this.label;if(e.length<3)return;const i=(l,c)=>{if(l.hidden||c.hidden)return!1;if(t==null)return l.box.collidesBBox(c.box);const h=l.box.clone().grow(t/2),d=c.box.clone().grow(t/2);return h.collidesBBox(d)},s=e[0],n=e.at(-1),o=new Set([s]),a=qe(s.x,n.x)&&qe(s.y,n.y),r=Math.floor(e.length/2);for(let l=1;l<=r;l++){const c=a?e.slice(0,-1):e;if(!DC(c,l,i)){DC(c,l,(d,u)=>{o.add(u)});break}}for(const l of e)o.has(l)||(l.hidden=!0,l.box=void 0)}tickFormatParams(){return{type:"category"}}datumFormatParams(e,t){const{datum:i,seriesId:s,legendItemName:n,key:o,source:a,property:r,domain:l,boundSeries:c}=t;return{type:"category",value:e,datum:i,seriesId:s,legendItemName:n,key:o,source:a,property:r,domain:l,boundSeries:c}}};Vh.className="AngleCategoryAxis",Vh.type="angle-category",g([m],Vh.prototype,"groupPaddingInner",2),g([m],Vh.prototype,"paddingInner",2),g([m],Vh.prototype,"interval",2);var Az={type:"axis",name:"angle-category",chartType:"polar",enterprise:!0,version:ue,options:L.angleCategoryAxisOptionsDefs,themeTemplate:{label:{spacing:5},gridLine:{enabled:!1},shape:{$findFirstSiblingNotOperation:void 0}},create:e=>new Vh(e)},mc=class extends Yf{constructor(e){super(e,new hz),this.shape="circle",this.interval=new IC}hasDefinedDomain(){const{min:e,max:t}=this;return e!=null&&t!=null&&e<t}normaliseDataDomain(e){const{min:t,max:i,preferredMin:s,preferredMax:n}=this,{extent:o,clipped:a}=Ec(e.domain,t,i,s,n,void 0,e.sortMetadata?.sortOrder);return{domain:o,clipped:a}}getDomainExtentsNice(){return[this.min==null&&this.nice,this.max==null&&this.nice]}updateScale(){super.updateScale(),this.scale.arcLength=this.getRangeArcLength()}getRangeArcLength(){const{range:e}=this,t=Math.min(...e),i=Math.max(...e),s=Eo(t,i)||2*Math.PI,n=this.gridLength;return s*n}generateAngleTicks(e){const{scale:t,range:i,nice:s}=this,{values:n,step:o,minSpacing:a,maxSpacing:r}=this.interval;let l;if(n==null){const{arcLength:c}=t,h=r?Math.floor(c/r):1,d=a?Math.floor(c/a):1/0,u=Math.floor(4/Math.PI*Math.abs(i[0]-i[1])),p=Math.max(h,Math.min(d,u)),f={nice:[s,s],interval:o,tickCount:p,minTickCount:h,maxTickCount:d};l=t.ticks(f,e)?.ticks??[]}else{const[c,h]=Tt(e.map(Number));l=n.filter(d=>d>=c&&d<=h).sort((d,u)=>d-u)}return l.map(c=>({value:c,visible:!0}))}avoidLabelCollisions(e){const{minSpacing:t}=this.label,i=(o,a)=>{if(o.hidden||a.hidden)return!1;if(t==null)return o.box.collidesBBox(a.box);const r=o.box.clone().grow(t/2),l=a.box.clone().grow(t/2);return r.collidesBBox(l)},s=e[0],n=e.at(-1);s!==n&&qe(s.x,n.x)&&qe(s.y,n.y)&&(n.hidden=!0);for(let o=1;o<e.length;o*=2){let a=!1;for(let r=o;r<e.length;r+=o){const l=e[r],c=e[r-o];if(i(c,l)){a=!0;break}}if(!a){for(const[r,l]of e.entries())r%o>0&&(l.hidden=!0,l.box=void 0);return}}for(const[o,a]of e.entries())o>0&&(a.hidden=!0,a.box=void 0)}tickFormatParams(e,t,i){return{type:"number",fractionDigits:i}}datumFormatParams(e,t,i){const{datum:s,seriesId:n,legendItemName:o,key:a,source:r,property:l,domain:c,boundSeries:h}=t;return{type:"number",value:e,datum:s,seriesId:n,legendItemName:o,key:a,source:r,property:l,domain:c,boundSeries:h,fractionDigits:i}}};mc.className="AngleNumberAxis",mc.type="angle-number",g([m],mc.prototype,"min",2),g([m],mc.prototype,"max",2),g([m],mc.prototype,"preferredMin",2),g([m],mc.prototype,"preferredMax",2),g([m],mc.prototype,"interval",2);var Cz={type:"axis",name:"angle-number",chartType:"polar",enterprise:!0,version:ue,options:L.angleNumberAxisOptionsDefs,themeTemplate:{label:{spacing:5},gridLine:{enabled:!1}},create:e=>new mc(e)},{validateCrossLineValue:_J,Group:VJ,Path:GJ,Sector:HJ,RotatableText:jJ}=L,Lz=class extends na{constructor(){super(...arguments),this.positionAngle=void 0}};g([m],Lz.prototype,"positionAngle",2);var LC=class extends _s{constructor(){super(),this.direction="radius",this.label=new Lz,this.polygonNode=new GJ,this.sectorNode=new HJ,this.crossLineRange=new VJ,this.labelNode=new jJ,this.outerRadius=0,this.innerRadius=0,this.crossLineRange.append(this.polygonNode),this.crossLineRange.append(this.sectorNode),this.labelGroup.append(this.labelNode)}update(e){const{scale:t}=this;if(!t||!_J(this,t)){this.rangeGroup.visible=!1,this.lineGroup.visible=!1,this.labelGroup.visible=!1;return}this.updateRadii();const{innerRadius:i,outerRadius:s}=this;e&&(e=i>=this.axisInnerRadius&&s<=this.axisOuterRadius),this.rangeGroup.visible=e,this.lineGroup.visible=e,this.labelGroup.visible=e,this.updatePolygonNode(e),this.updateSectorNode(e),this.updateLabelNode(e),this.assignCrossLineGroup(this.type==="range",this.crossLineRange)}updateRadii(){const{range:e,scale:t,type:i,axisInnerRadius:s,axisOuterRadius:n}=this;if(!t)return{innerRadius:0,outerRadius:0};const o=l=>n+s-l;let a,r;if(i==="line")a=o(t.convert(this.value)),r=a;else{const l=Math.abs(t?.bandwidth??0),c=e.map(h=>t.convert(h));a=o(Math.max(...c)),r=o(Math.min(...c))+l}this.outerRadius=a,this.innerRadius=r}drawPolygon(e,t,i){for(const[s,n]of t.entries()){const o=e*Math.cos(n),a=e*Math.sin(n);s===0?i.path.moveTo(o,a):i.path.lineTo(o,a)}i.path.closePath()}updatePolygonNode(e){const{gridAngles:t,polygonNode:i,scale:s,shape:n,type:o,innerRadius:a,outerRadius:r}=this;if(!e||n!=="polygon"||!s||!t){i.visible=!1;return}i.visible=!0;const l=this.getPadding();i.path.clear(!0),this.drawPolygon(r-l,t,i);const c=t.slice().reverse(),h=o==="line"?r-l:a+l;this.drawPolygon(h,c,i),this.setSectorNodeProps(i)}updateSectorNode(e){const{axisInnerRadius:t,axisOuterRadius:i,scale:s,sectorNode:n,shape:o,innerRadius:a,outerRadius:r}=this;if(!e||o!=="circle"||!s){n.visible=!1;return}n.visible=!0,n.startAngle=0,n.endAngle=2*Math.PI;const l=this.getPadding(),c=ge(t,a+l,i),h=ge(t,r-l,i);n.innerRadius=Math.min(c,h),n.outerRadius=Math.max(c,h),this.setSectorNodeProps(n)}updateLabelNode(e){const{innerRadius:t,label:i,labelNode:s,scale:n,shape:o,type:a}=this;if(!e||i.enabled===!1||!i.text||!n){s.visible=!1;return}const r=Po((i.positionAngle??0)-90),l=(qe(r,0)||r>0)&&r<Math.PI,c=l?r-Math.PI/2:r+Math.PI/2;let h;const d=this.gridAngles??[];a==="line"?h=t+i.padding:o==="circle"||d.length<3?h=t-i.padding:h=t*Math.cos(Math.PI/d.length)-i.padding;const u=h*Math.cos(r),p=h*Math.sin(r);let f;a==="line"?f=l?"top":"bottom":f=l?"bottom":"top",this.setLabelNodeProps(s,u,p,f,c)}getPadding(){const{scale:e}=this;if(!e)return 0;const t=Math.abs(e.bandwidth??0),i=Math.abs(e.step??0);return e instanceof L.BandScale?(i-t)/2:0}};LC.className="RadiusCrossLine";var{Caption:WJ,Group:$J,TransformableGroup:wz,Path:UJ,Line:Tz,Selection:Nz,generateTicks:KJ,AxisGroupZIndexMap:YJ}=L,wC=class extends L.AxisLabel{constructor(){super(...arguments),this.autoRotateAngle=335}};g([m],wC.prototype,"autoRotate",2),g([m],wC.prototype,"autoRotateAngle",2);var Pv=class extends L.PolarAxis{constructor(e,t){super(e,t),this.positionAngle=0,this.gridLineGroupSelection=Nz.select(this.gridLineGroup,Tz,!1),this.generatedTicks=void 0,this.headingLabelGroup=this.axisGroup.appendChild(new wz({name:`${this.id}-Axis-heading`})),this.lineNodeGroup=this.axisGroup.appendChild(new wz({name:`${this.id}-Axis-line`})),this.lineNode=this.lineNodeGroup.appendChild(new Tz({name:`${this.id}-Axis-line`,zIndex:YJ.AxisLine})),this.gridPathGroup=this.gridGroup.appendChild(new $J({name:`${this.id}-gridPaths`,zIndex:2})),this.gridPathSelection=Nz.select(this.gridPathGroup,UJ),this.headingLabelGroup.appendChild(this.title.caption.node),this.cleanup.register(this.title.caption.registerInteraction(this.moduleCtx,"afterend"))}get direction(){return"radius"}getAxisTransform(){const e=this.scale.range[0],{translation:t,positionAngle:i,innerRadiusRatio:s}=this,n=e*s,o=mt(i);return{translationX:t.x,translationY:t.y-e-n,rotation:o,rotationCenterX:0,rotationCenterY:e+n}}update(){super.update(),this.updateTitle(),this.updateGridLines();const{enabled:e,stroke:t,width:i}=this.line;this.lineNode.setProperties({stroke:t,strokeWidth:e?i:0,x1:0,y1:this.range[0],x2:0,y2:this.range[1]})}updatePosition(){super.updatePosition();const e=this.getAxisTransform();this.tickLineGroup.setProperties(e),this.tickLabelGroup.setProperties(e),this.lineNodeGroup.setProperties(e),this.headingLabelGroup.setProperties(e)}calculateRotations(){return{rotation:0,parallelFlipRotation:0,regularFlipRotation:-Math.PI/2}}calculateTickLayout(e,t,i){const s=[0,1],n=this.label.getSideFlag(),o=n*(this.getTickSize()+this.label.spacing+this.seriesAreaPadding),{range:a,reverse:r,defaultTickMinSpacing:l}=this,c=KJ({scale:this.scale,label:this.label,interval:this.interval,tickFormatter:(...v)=>this.tickFormatter(...v),domain:e,range:a,reverse:r,niceMode:t,visibleRange:s,defaultTickMinSpacing:l,labelOffset:o,sideFlag:n,axisRotation:0,sizeLimit:void 0,primaryTickCount:void 0}),{tickData:h}=c,{ticks:d,rawTicks:u,rawTickCount:p,tickDomain:f,fractionDigits:y,niceDomain:b=e}=h,x=d.map(v=>this.getTickLabelProps(v,c));return this.generatedTicks={ticks:d,labels:x},{ticks:u,tickDomain:f,niceDomain:b,rawTickCount:p,fractionDigits:y,timeInterval:void 0}}updateSelections(){const{generatedTicks:e}=this;if(!e)return;const{ticks:t,labels:i}=e;this.gridLineGroupSelection.update(this.gridLength?t:[]),this.tickLabelGroupSelection.update(i),this.gridPathSelection.update(this.gridLine.enabled?this.prepareGridPathTickData(t):[]),this.gridLineGroupSelection.cleanup(),this.tickLabelGroupSelection.cleanup(),this.gridPathSelection.cleanup()}updateLabels(){if(!this.label.enabled)return;const e=L.resetAxisLabelSelectionFn();this.tickLabelGroupSelection.each((t,i)=>{t.fill=i.color,t.text=i.text,t.textBaseline=i.textBaseline,t.textAlign=i.textAlign??"center",t.setFont(i),t.setBoxing(i),t.setProperties(e(t,i))})}updateGridLines(){const{gridLine:{style:e,width:t},shape:i,generatedTicks:s}=this;if(!e||!s)return;const n=e.length,o=(u,p)=>{const{stroke:f,lineDash:y}=e[p%n];u.stroke=f,u.strokeWidth=t,u.lineDash=y,u.fill=void 0},[a,r]=this.gridRange??[0,2*Math.PI],l=qe(r-a,2*Math.PI),d=i==="circle"?(u,p)=>{const{path:f}=u;f.clear(!0);const y=this.getTickRadius(p);l?(f.moveTo(y,0),f.arc(0,0,y,0,2*Math.PI)):(f.moveTo(y*Math.cos(a),y*Math.sin(a)),f.arc(0,0,y,tt(a),tt(r))),l&&f.closePath()}:(u,p)=>{const{path:f}=u,y=this.gridAngles;if(f.clear(!0),!y||y.length<3)return;const b=this.getTickRadius(p);for(const[x,v]of y.entries()){const S=b*Math.cos(v),M=b*Math.sin(v);x===0?f.moveTo(S,M):f.lineTo(S,M);for(const[D,k]of y.entries()){const I=b*Math.cos(k),A=b*Math.sin(k);D===0?f.moveTo(I,A):f.lineTo(I,A)}f.closePath()}f.closePath()};this.gridPathSelection.each((u,p,f)=>{o(u,f),d(u,p)})}updateTitle(){const e=a=>a.defaultValue,{title:t,range:i}=this,{formatter:s=e}=this.title;t.caption.enabled=t.enabled,t.caption.fontFamily=t.fontFamily,t.caption.fontSize=t.fontSize,t.caption.fontStyle=t.fontStyle,t.caption.fontWeight=t.fontWeight,t.caption.color=t.color,t.caption.wrapping=t.wrapping;let n=!1;const o=t.caption.node;t.enabled&&(n=!0,o.rotation=Math.PI/2,o.x=Math.floor((i[0]+i[1])/2),o.y=-WJ.SMALL_PADDING,o.textAlign="center",o.textBaseline="bottom",o.text=this.cachedCallWithContext(s,this.getTitleFormatterParams(this.scale.domain))),o.visible=n}updateCrossLines(){for(const e of this.crossLines)if(e instanceof LC){const{shape:t,gridAngles:i,range:s,innerRadiusRatio:n}=this,o=s[0];e.shape=t,e.gridAngles=i,e.axisOuterRadius=o,e.axisInnerRadius=o*n}super.updateCrossLines()}createLabel(){return new wC}getTickLabelProps(e,t){const{label:i}=this,{rotation:s,textBaseline:n,textAlign:o}=t,a=this.scale.range,r=e.tickLabel??"",c=i.getSideFlag()*(this.getTickSize()+i.spacing+this.seriesAreaPadding),h=r!==""&&r!=null,d=s;return{...this.getLabelStyles({value:e.tick,formattedValue:e.tickLabel}),tickId:e.tickId,rotation:d,text:r,textAlign:o,textBaseline:n,visible:h,x:c,y:e.translation,rotationCenterX:c,rotationCenterY:e.translation,range:a}}};Pv.CrossLineConstructor=LC,g([m],Pv.prototype,"positionAngle",2);var{CategoryScale:Oz}=L,Gh=class extends Pv{constructor(e){super(e,new Oz),this.shape="circle",this.groupPaddingInner=0,this.paddingInner=0,this.paddingOuter=0}hasDefinedDomain(){return!1}normaliseDataDomain(e){return{domain:e.domain,clipped:!1}}prepareGridPathTickData(e){return e.slice().reverse()}getTickRadius(e){const{scale:t,innerRadiusRatio:i}=this,s=t.range[0],n=s*i;if(Oz.is(t)){const o=t.domain,a=o.length-1-o.indexOf(e.tick);return a===0?n:t.inset+t.step*(a-.5)+t.bandwidth/2}else{const o=(s-n)/t.domain.length;return s-e.translation+n-o/2}}tickFormatParams(){return{type:"category"}}datumFormatParams(e,t){const{datum:i,seriesId:s,legendItemName:n,key:o,source:a,property:r,domain:l,boundSeries:c}=t;return{type:"category",value:e,datum:i,seriesId:s,legendItemName:n,key:o,source:a,property:r,domain:l,boundSeries:c}}};Gh.className="RadiusCategoryAxis",Gh.type="radius-category",g([m],Gh.prototype,"groupPaddingInner",2),g([kt("scale","paddingInner"),m],Gh.prototype,"paddingInner",2),g([kt("scale","paddingOuter"),m],Gh.prototype,"paddingOuter",2);var Ez={type:"axis",name:"radius-category",chartType:"polar",enterprise:!0,version:ue,options:L.radiusCategoryAxisOptionsDefs,themeTemplate:{positionAngle:0,line:{enabled:!1},label:{minSpacing:5}},create:e=>new Gh(e)},{LinearScale:ZJ}=L,Hh=class extends Pv{constructor(e){super(e,new ZJ),this.shape="polygon"}hasDefinedDomain(){const{min:e,max:t}=this;return e!=null&&t!=null&&e<t}prepareGridPathTickData(e){const{scale:t}=this,i=t.domain[1];return e.filter(({tick:s})=>s!==i).sort((s,n)=>n.tick-s.tick)}getTickRadius(e){const{scale:t}=this,i=t.range[0],s=i*this.innerRadiusRatio;return i-e.translation+s}normaliseDataDomain(e){const{min:t,max:i,preferredMin:s,preferredMax:n}=this,{extent:o,clipped:a}=Ec(e.domain,t,i,s,n,void 0,e.sortMetadata?.sortOrder);return{domain:o,clipped:a}}getDomainExtentsNice(){return[this.min==null&&this.nice,this.max==null&&this.nice]}tickFormatParams(e,t,i){return{type:"number",fractionDigits:i}}datumFormatParams(e,t,i){const{datum:s,seriesId:n,legendItemName:o,key:a,source:r,property:l,domain:c,boundSeries:h}=t;return{type:"number",value:e,datum:s,seriesId:n,legendItemName:o,key:a,source:r,property:l,domain:c,boundSeries:h,fractionDigits:i}}};Hh.className="RadiusNumberAxis",Hh.type="radius-number",g([m],Hh.prototype,"min",2),g([m],Hh.prototype,"max",2),g([m],Hh.prototype,"preferredMin",2),g([m],Hh.prototype,"preferredMax",2);var Pz={type:"axis",name:"radius-number",chartType:"polar",enterprise:!0,version:ue,options:L.radiusNumberAxisOptionsDefs,themeTemplate:{positionAngle:0,line:{enabled:!1},shape:{$findFirstSiblingNotOperation:void 0},label:{minSpacing:5}},create:e=>new Hh(e)},{createDatumId:XJ,toHighlightString:qJ}=L;function QJ(e,t){const{id:i}=e,{angleKey:s,cornerRadius:n,fill:o,fillOpacity:a,lineDash:r,lineDashOffset:l,radiusKey:c,stackGroup:h,stroke:d,strokeOpacity:u,strokeWidth:p}=e.properties,f=qJ(t??L.HighlightState.None);return{angleKey:s,cornerRadius:n,fill:o,fillOpacity:a,highlightState:f,lineDash:r,lineDashOffset:l,radiusKey:c,seriesId:i,stackGroup:h,stroke:d,strokeOpacity:u,strokeWidth:p}}function TC(e,t,i){const{styler:s}=e.properties;let n={};if(!t&&s){const o=QJ(e,i);n=e.ctx.optionsGraphService.resolvePartial(["series",`${e.declarationOrder}`],e.cachedCallWithContext(s,o)??{},{pick:!1})??{}}return{cornerRadius:n.cornerRadius??e.properties.cornerRadius,fill:n.fill??e.properties.fill,fillOpacity:n.fillOpacity??e.properties.fillOpacity,lineDash:n.lineDash??e.properties.lineDash,lineDashOffset:n.lineDashOffset??e.properties.lineDashOffset,stroke:n.stroke??e.properties.stroke,strokeOpacity:n.strokeOpacity??e.properties.strokeOpacity,strokeWidth:n.strokeWidth??e.properties.strokeWidth,opacity:1}}function JJ(e,t,i,s){const{id:n,properties:o}=e,{angleKey:a,radiusKey:r}=o,l=e.ctx.highlightManager?.getActiveHighlight(),c=e.getHighlightStateString(l,i,t.datumIndex),h=e.filterItemStylerFillParams(s.fill)??s.fill;return{seriesId:n,datum:t.datum,highlightState:c,angleKey:a,radiusKey:r,...s,fill:h}}function bp(e,t,i,s){const{properties:n}=e,{itemStyler:o}=n,a=e.getHighlightStyle(i,t?.datumIndex,s);let l=oe(a,TC(e,t===void 0,s));if(o!=null&&t!=null){const c=e.cachedDatumCallback(XJ(e.getDatumId(t),i?"highlight":"node"),()=>{const h=JJ(e,t,i,l);return e.callWithContext(o,h)});c&&(l=oe(c,l))}return l}var{DEFAULT_POLAR_DIRECTION_KEYS:eee,DEFAULT_POLAR_DIRECTION_NAMES:tee,PolarAxis:iee,diff:see,fixNumericExtent:nee,groupAccumulativeValueProperty:Rz,keyProperty:oee,normaliseGroupTo:aee,resetLabelFn:ree,seriesLabelFadeInAnimation:lee,seriesLabelFadeOutAnimation:cee,valueProperty:hee,animationValidation:dee,createDatumId:uee,SeriesNodePickMode:Fz,CategoryScale:pee,motion:zz,updateLabelNode:Bz,getItemStyles:gee}=L,fee=class extends L.SeriesNodeEvent{constructor(e,t,i,s){super(e,t,i,s),this.angleKey=s.properties.angleKey,this.radiusKey=s.properties.radiusKey}},_z=class extends L.PolarSeries{constructor(e,{animationResetFns:t}){super({moduleCtx:e,categoryKey:"angleValue",propertyKeys:eee,propertyNames:tee,canHaveAxes:!0,pickModes:[Fz.NEAREST_NODE,Fz.EXACT_SHAPE_MATCH],animationResetFns:{...t,label:ree}}),this.NodeEvent=fee,this.groupScale=new pee,this.circleCache={r:0,cx:0,cy:0}}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;if(!i||!t)return{domain:[]};if(e==="angle")return t.getDomain(this,"angleValue","key",i);{const s=t.getDomain(this,"radiusValue-end","value",i).domain,n=Number.isFinite(s[1]-s[0])?[Math.min(s[0],0),Math.max(s[1],0)]:[];return{domain:nee(n)}}}async processData(e){const{angleKey:t,radiusKey:i,normalizedTo:s}=this.properties,n=!this.ctx.animationManager.isSkipped(),o=this.getStackId(),a=`${o}-trailing`,r=[];St(s)&&r.push(aee([o,a],Math.abs(s))),this.needsDataModelDiff()&&this.processedData&&r.push(see(this.id,this.processedData)),n&&r.push(dee());const l=this.visible?{}:{forceValue:0},c=this.axes.radius?.scale.type,h=this.axes.angle?.scale.type;await this.requestDataModel(e,this.data,{props:[oee(t,h,{id:"angleValue"}),hee(i,c,{id:"radiusValue-raw",invalidValue:null,...l}),...Rz(i,"normal",{id:"radiusValue-end",rangeId:"radiusValue-range",invalidValue:null,groupId:o,separateNegative:!0,...l},c),...Rz(i,"trailing",{id:"radiusValue-start",invalidValue:null,groupId:a,separateNegative:!0,...l},c),...r],groupByKeys:!0,groupByData:!1}),this.animationState.transition("updateData")}didCircleChange(){const e=this.radius,t=this.centerX,i=this.centerY,s=this.circleCache;return e!==s.r||t!==s.cx||i!==s.cy?(this.circleCache={r:e,cx:t,cy:i},!0):!1}isRadiusAxisReversed(){return this.axes.radius?.isReversed()}maybeRefreshNodeData(){!this.didCircleChange()&&!this.nodeDataRefresh||(this.contextNodeData=this.createNodeData(),this.nodeData=this.contextNodeData?.nodeData??[],this.nodeDataRefresh=!1)}getAxisInnerRadius(){const e=this.axes.radius;return e instanceof iee?this.radius*e.innerRadiusRatio:0}createNodeData(){const{processedData:e,dataModel:t,groupScale:i}=this;if(!t||!e||e.type!=="grouped")return;const s=this.axes.angle,n=this.axes.radius,o=s?.scale,a=n?.scale;if(!o||!a)return;const r=t.resolveKeysById(this,"angleValue",e),l=t.resolveColumnById(this,"radiusValue-start",e),c=t.resolveColumnById(this,"radiusValue-end",e),h=t.resolveColumnById(this,"radiusValue-raw",e);let d=0,u=0;s instanceof Vh&&(d=s.groupPaddingInner,u=s.paddingInner);const f=(o.bandwidth??0)*(1-u),{index:y,visibleGroupCount:b}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);i.domain=Array.from({length:b}).map((B,V)=>String(V)),i.range=[-f/2,f/2],i.paddingInner=b>1?d:0;const x=this.isRadiusAxisReversed(),v=this.getAxisInnerRadius(),S=this.radius,M=S+v,{angleKey:D,radiusKey:k,angleName:I,radiusName:A,legendItemName:C,label:w}=this.properties,T=this.getSeriesDomain("radius").domain,O=(B,V,Y,X)=>{const q=this.getLabelText(V,B,k,"radius",T,w,{value:V,datum:B,angleKey:D,radiusKey:k,angleName:I,radiusName:A,legendItemName:C});if(q)return{x:Y,y:X,text:q,textAlign:"center",textBaseline:"middle"}},E=[],z=gee((B,V,Y)=>bp(this,B,V,Y)),F={itemId:k,nodeData:E,labelData:E,styles:z};if(!this.visible)return F;const{dataSources:_}=e,G=_.get(this.id)?.data??[];for(const{datumIndex:B}of t.forEachGroupDatum(this,e)){const V=G[B],Y=r[B];if(Y==null)return;const X=h[B],q=X>=0&&!Object.is(X,-0),te=l[B],pe=c[B],Se=q===x;if(te===void 0||pe===void 0)return;let ve,ae,Ie;if(G.length===1)ve=-.5*Math.PI,ae=1.5*Math.PI,Ie=ve;else{const Ne=o.convert(Y);ve=tt(Ne+i.convert(String(y))),ae=tt(ve+i.bandwidth),Ie=ve+i.bandwidth/2}const ze=M-a.convert(te),Xe=M-a.convert(pe),Te=(ze+Xe)/2,de=Math.cos(Ie)*Te,De=Math.sin(Ie)*Te,ye=this.properties.label.enabled?O(V,X,de,De):void 0,Ee=this.getColumnWidth(ve,ae);E.push({series:this,datum:V,datumIndex:B,point:{x:de,y:De,size:0},midPoint:{x:de,y:De},label:ye,angleValue:Y,radiusValue:X,negative:Se,innerRadius:ze,outerRadius:Xe,stackInnerRadius:ze,stackOuterRadius:Xe,startAngle:ve,endAngle:ae,midAngle:Ie,axisInnerRadius:v,axisOuterRadius:S,columnWidth:Ee,index:B})}return{itemId:k,nodeData:E,labelData:E,styles:z}}getColumnWidth(e,t){return Number.NaN}update({seriesRect:e}){const t=this.checkResize(e);this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updateSectorSelection(this.itemSelection,!1),this.updateSectorSelection(this.highlightSelection,!0),this.updateLabels(),t&&this.animationState.transition("resize"),this.animationState.transition("update")}updateSectorSelection(e,t){const{contextNodeData:i}=this;if(!i)return;const s=this.ctx.highlightManager.getActiveHighlight();let n=[];const o=this.ctx.highlightManager?.getActiveHighlight();t?o?.datum&&o.series===this&&n.push(o):n=this.nodeData;const a=this.isRadiusAxisReversed(),r=a?this.radius:this.getAxisInnerRadius(),l=a?this.getAxisInnerRadius():this.radius,c=this.getShapeFillBBox(),h=this.hasItemStylers();e.update(n,void 0,d=>this.getDatumId(d)).each((d,u)=>{const{midPoint:p}=u;if(h){const v=this.getHighlightState(o,t,u.datumIndex);u.style=bp(this,u,t,v)}const f=u.style??i.styles[this.getHighlightState(s,t,u.datumIndex)],y=f.fill,x=Ut(y)&&y.bounds==="item"?{centerX:p?.x??0,centerY:p?.y??0}:{centerX:0,centerY:0,innerRadius:r,outerRadius:l};this.updateItemPath(d,u,t),d.setStyleProperties(f,c,x),d.cornerRadius=f.cornerRadius??0,d.lineJoin="round"})}updateLabels(){const e=this.ctx.highlightManager?.getActiveHighlight(),t=e?.series===this&&e?.datum?e:void 0,i=t?[t]:[];this.labelSelection.update(this.nodeData).each((s,n)=>{Bz(this,s,this.properties,this.properties.label,n.label,!1,e),s.fillOpacity=this.getHighlightStyle(!1,n.datumIndex).opacity??1}),this.highlightLabelSelection.update(i,void 0,s=>this.getDatumId(s)).each((s,n)=>{Bz(this,s,this.properties,this.properties.label,n.label,!0,e),s.fillOpacity=this.getHighlightStyle(!0,n.datumIndex).opacity??1})}animateEmptyUpdateReady(){const{labelSelection:e}=this,t=this.getColumnTransitionFunctions();zz.fromToMotion(this.id,"datums",this.ctx.animationManager,[this.itemSelection],t),lee(this,"labels",this.ctx.animationManager,e,this.highlightLabelSelection)}animateClearingUpdateEmpty(){const{itemSelection:e}=this,{animationManager:t}=this.ctx,i=this.getColumnTransitionFunctions();zz.fromToMotion(this.id,"datums",t,[e],i),cee(this,"labels",t,this.labelSelection,this.highlightLabelSelection)}getTooltipContent(e){const{id:t,dataModel:i,processedData:s,axes:n,properties:o}=this,{angleKey:a,angleName:r,radiusKey:l,radiusName:c,legendItemName:h,tooltip:d}=o,u=n.angle,p=n.radius,f=this.nodeData?.[e];if(!i||!s||!u||!p||!f)return;const y=s.dataSources.get(this.id)?.data[e],b=i.resolveKeysById(this,"angleValue",s)[e],x=i.resolveColumnById(this,"radiusValue-raw",s)[e];if(b==null)return;const v=bp(this,f,!1);return this.formatTooltipWithContext(d,{heading:this.getAxisValueText(u,"tooltip",b,y,a,void 0),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:l,value:this.getAxisValueText(p,"tooltip",x,y,l,void 0),missing:L.isTooltipValueMissing(x)}]},{seriesId:t,datum:y,title:r,angleKey:a,angleName:r,radiusKey:l,radiusName:c,legendItemName:h,...v})}pickNodeClosestDatum(e){return this.pickNodeNearestDistantObject(e,this.itemSelection.nodes())}legendItemSymbol(){const{fill:e,stroke:t,fillOpacity:i,strokeOpacity:s,strokeWidth:n,lineDash:o,lineDashOffset:a}=TC(this,!1,L.HighlightState.None),r={fill:e??"rgba(0, 0, 0, 0)",stroke:t??"rgba(0, 0, 0, 0)",fillOpacity:i,strokeOpacity:s,strokeWidth:n,lineDash:o,lineDashOffset:a};return Ut(r.fill)&&(r.fill={...r.fill,gradient:"linear",rotation:0,reverse:!1}),{marker:r}}getLegendData(e){if(e!=="category")return[];const{id:t,visible:i}=this,{radiusKey:s,radiusName:n,legendItemName:o,showInLegend:a}=this.properties;return[{legendType:"category",id:t,itemId:s,seriesId:t,enabled:i,label:{text:o??n??s},symbol:this.legendItemSymbol(),legendItemName:o,hideInLegend:!a}]}getDatumId(e){return uee(e.angleValue)}computeLabelsBBox(){return null}},{SeriesProperties:mee,makeSeriesTooltip:yee,Label:xee}=L,Ht=class extends mee{constructor(){super(...arguments),this.angleKeyAxis="angle",this.radiusKeyAxis="radius",this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.label=new xee,this.tooltip=yee()}getStyle(){const{fill:e,fillOpacity:t,stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:o,lineDashOffset:a,cornerRadius:r}=this;return{fill:e,fillOpacity:t,stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:o,lineDashOffset:a,cornerRadius:r,opacity:1}}};g([m],Ht.prototype,"angleKey",2),g([m],Ht.prototype,"angleName",2),g([m],Ht.prototype,"radiusKey",2),g([m],Ht.prototype,"radiusName",2),g([m],Ht.prototype,"angleKeyAxis",2),g([m],Ht.prototype,"radiusKeyAxis",2),g([m],Ht.prototype,"legendItemName",2),g([m],Ht.prototype,"fill",2),g([m],Ht.prototype,"fillOpacity",2),g([m],Ht.prototype,"stroke",2),g([m],Ht.prototype,"strokeWidth",2),g([m],Ht.prototype,"strokeOpacity",2),g([m],Ht.prototype,"lineDash",2),g([m],Ht.prototype,"lineDashOffset",2),g([m],Ht.prototype,"cornerRadius",2),g([m],Ht.prototype,"styler",2),g([m],Ht.prototype,"itemStyler",2),g([m],Ht.prototype,"rotation",2),g([m],Ht.prototype,"stackGroup",2),g([m],Ht.prototype,"normalizedTo",2),g([m],Ht.prototype,"label",2),g([m],Ht.prototype,"tooltip",2);var{motion:bee}=L;function Vz(){const e={startAngle:new Map,endAngle:new Map},t=["startAngle","endAngle"],i=(a,r,l)=>{for(const c of t){const h=e[c];let d=(l==="removed"||l==="updated"?a:r)[c],u=(l==="removed"?a:r)[c];Number.isNaN(u)&&(u=a.previousDatum?.[c]??Number.NaN);const p=d-u;Math.abs(p)>Math.PI&&(d-=Math.sign(p)*2*Math.PI),h.set(r,{from:d,to:u})}},s=(a,r)=>({startAngle:e.startAngle.get(a)[r],endAngle:e.endAngle.get(a)[r]});return{calculate:i,from:a=>s(a,"from"),to:a=>s(a,"to")}}function Gz(e,t,i){if(i==="updated"){if(e.previousDatum==null||Number.isNaN(e.previousDatum.startAngle)||Number.isNaN(e.previousDatum.endAngle))return"added";if(Number.isNaN(t.startAngle)||Number.isNaN(t.endAngle))return"removed"}return i==="added"&&e.previousDatum!=null?"updated":i}function vee(e){const t=Vz();return{toFn:(n,o,a)=>{const{startAngle:r,endAngle:l}=t.to(o);let c,h,d,u,p;return a==="removed"?(c=n.innerRadius,h=n.innerRadius,d=n.columnWidth,u=n.axisInnerRadius,p=n.axisOuterRadius):(c=Number.isNaN(o.innerRadius)?e:o.innerRadius,h=Number.isNaN(o.outerRadius)?e:o.outerRadius,d=Number.isNaN(o.columnWidth)?n.columnWidth:o.columnWidth,u=o.axisInnerRadius,p=o.axisOuterRadius),{innerRadius:c,outerRadius:h,columnWidth:d,axisInnerRadius:u,axisOuterRadius:p,startAngle:r,endAngle:l}},fromFn:(n,o,a)=>{a=Gz(n,o,a),t.calculate(n,o,a);const{startAngle:r,endAngle:l}=t.from(o);let c,h,d,u,p;a==="removed"||a==="updated"?(c=n.innerRadius,h=n.outerRadius,d=n.columnWidth,u=n.axisInnerRadius,p=n.axisOuterRadius):(c=e,h=e,d=o.columnWidth,u=o.axisInnerRadius,p=o.axisOuterRadius);const f=bee.NODE_UPDATE_STATE_TO_PHASE_MAPPING[a];return{innerRadius:c,outerRadius:h,columnWidth:d,axisInnerRadius:u,axisOuterRadius:p,startAngle:r,endAngle:l,phase:f}}}}function See(e,{innerRadius:t,outerRadius:i,columnWidth:s,axisInnerRadius:n,axisOuterRadius:o,startAngle:a,endAngle:r}){return{innerRadius:t,outerRadius:i,columnWidth:s,axisInnerRadius:n,axisOuterRadius:o,startAngle:a,endAngle:r}}var{SectorBox:Rv,motion:Mee}=L;function NC(e){const{negative:t,innerRadius:i,outerRadius:s,stackInnerRadius:n,stackOuterRadius:o}=e;return{innerRadius:t?o:n,outerRadius:t?n:o,clipInnerRadius:t?s:i,clipOuterRadius:t?i:s}}function Dee(e){const t=Vz();return{toFn:(n,o,a)=>{const{startAngle:r,endAngle:l}=t.to(o);let c,h,d;if(a==="removed")c=e,h=e,d=new Rv(r,l,c,h);else{let u,p;({innerRadius:c,outerRadius:h,clipInnerRadius:u,clipOuterRadius:p}=NC(o)),Number.isNaN(c)&&(c=e),Number.isNaN(h)&&(h=e),Number.isNaN(u)&&(u=e),Number.isNaN(p)&&(p=e),d=new Rv(r,l,u,p)}return{innerRadius:c,outerRadius:h,startAngle:r,endAngle:l,clipSector:d}},fromFn:(n,o,a)=>{a=Gz(n,o,a),t.calculate(n,o,a);const{startAngle:r,endAngle:l}=t.from(o);let c,h,d;a==="removed"||a==="updated"?(c=n.innerRadius,h=n.outerRadius,d=n.clipSector):(c=e,h=e),d??(d=new Rv(r,l,c,h));const u=Mee.NODE_UPDATE_STATE_TO_PHASE_MAPPING[a];return{innerRadius:c,outerRadius:h,startAngle:r,endAngle:l,clipSector:d,phase:u}}}}function Iee(e,t){const{startAngle:i,endAngle:s}=t,{innerRadius:n,outerRadius:o,clipInnerRadius:a,clipOuterRadius:r}=NC(t),l=new Rv(i,s,a,r);return{innerRadius:n,outerRadius:o,startAngle:i,endAngle:s,clipSector:l}}var{Sector:kee,SectorBox:Aee}=L,OC=class extends _z{constructor(e){super(e,{animationResetFns:{item:Iee}}),this.properties=new Ht}setZIndex(e){return super.setZIndex(e),this.contentGroup.zIndex=[0,1,e],this.highlightGroup.zIndex=[0,2,e],this.labelGroup.zIndex=[0,3,e],!0}getStackId(){return`nightingale-stack-${this.seriesGrouping?.groupIndex??this.id}-yValues`}nodeFactory(){return new kee}updateItemPath(e,t,i){const{negative:s}=t;if(e.centerX=0,e.centerY=0,e.startOuterCornerRadius=s?0:this.properties.cornerRadius,e.endOuterCornerRadius=s?0:this.properties.cornerRadius,e.startInnerCornerRadius=s?this.properties.cornerRadius:0,e.endInnerCornerRadius=s?this.properties.cornerRadius:0,i){const{startAngle:n,endAngle:o}=t,{innerRadius:a,outerRadius:r,clipInnerRadius:l,clipOuterRadius:c}=NC(t);e.innerRadius=a,e.outerRadius=r,e.startAngle=n,e.endAngle=o,e.clipSector=new Aee(n,o,l,c)}}getColumnTransitionFunctions(){const e=this.isRadiusAxisReversed()?this.radius:this.getAxisInnerRadius();return Dee(e)}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.styler!=null||this.properties.label.itemStyler!=null}};OC.className="NightingaleSeries",OC.type="nightingale";var{nightingaleSeriesThemeableOptionsDef:Cee}=L,EC={...et,...Cee,type:$(Le("nightingale")),angleKey:$(N),radiusKey:$(N),angleName:N,radiusName:N,legendItemName:N,grouped:R,stacked:R,stackGroup:N,normalizedTo:W};EC.angleKeyAxis=ee(N),EC.radiusKeyAxis=ee(N);var{FILL_GRADIENT_RADIAL_SERIES_DEFAULTS:Lee,FILL_IMAGE_DEFAULTS:wee,FILL_PATTERN_DEFAULTS:Tee}=L,Nee={series:{fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",Lee],["image",wee],["pattern",Tee]]},stroke:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$ref:"chartBackgroundColor"},{$palette:"stroke"}]},strokeWidth:1,label:{...L.LABEL_BOXING_DEFAULTS,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},highlight:{...L.multiSeriesHighlightStyle(),bringToFront:!1}},axes:{"angle-category":{shape:{$findFirstSiblingNotOperation:"circle"},groupPaddingInner:0,paddingInner:0,label:{spacing:10}},"radius-number":{shape:{$findFirstSiblingNotOperation:"circle"}}}},Hz={type:"series",name:"nightingale",chartType:"polar",enterprise:!0,stackable:!0,groupable:!0,stackedByDefault:!0,version:ue,dependencies:[Nr],options:EC,defaultAxes:{angle:{type:"angle-category"},radius:{type:"radius-number"}},axisKeys:{x:"xKeyAxis",y:"yKeyAxis"},themeTemplate:Nee,create:e=>new OC(e)},jz={series:{stroke:{$palette:"stroke"},label:{...L.LABEL_BOXING_DEFAULTS,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},marker:{enabled:!0,fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",L.FILL_GRADIENT_RADIAL_REVERSED_DEFAULTS],["image",L.FILL_IMAGE_DEFAULTS],["pattern",L.FILL_PATTERN_DEFAULTS]]},stroke:{$palette:"stroke"},fillOpacity:1,shape:"circle",size:6,strokeOpacity:1,strokeWidth:{$isUserOption:["./stroke",1,0]}},highlight:L.markerSeriesHighlightStyle(),tooltip:{range:{$path:["/tooltip/range","nearest"]}}},axes:{"angle-category":{label:{spacing:10}}}},Oee=oe({series:{stroke:L.SAFE_STROKE_FILL_OPERATION,strokeWidth:2}},jz),Eee=oe({series:{fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",L.FILL_GRADIENT_LINEAR_DEFAULTS],["image",L.FILL_IMAGE_DEFAULTS],["pattern",L.FILL_PATTERN_DEFAULTS]]},fillOpacity:.8,strokeWidth:2,marker:{enabled:!1}}},jz),{Label:Pee,SeriesMarker:Ree,SeriesProperties:Fee,makeSeriesTooltip:zee}=L,Ti=class extends Fee{constructor(){super(...arguments),this.angleKeyAxis="angle",this.radiusKeyAxis="radius",this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.rotation=0,this.marker=new Ree,this.label=new Pee,this.tooltip=zee(),this.connectMissingData=!1}};g([m],Ti.prototype,"angleKey",2),g([m],Ti.prototype,"radiusKey",2),g([m],Ti.prototype,"angleName",2),g([m],Ti.prototype,"radiusName",2),g([m],Ti.prototype,"angleKeyAxis",2),g([m],Ti.prototype,"radiusKeyAxis",2),g([m],Ti.prototype,"legendItemName",2),g([m],Ti.prototype,"stroke",2),g([m],Ti.prototype,"strokeWidth",2),g([m],Ti.prototype,"strokeOpacity",2),g([m],Ti.prototype,"lineDash",2),g([m],Ti.prototype,"lineDashOffset",2),g([m],Ti.prototype,"rotation",2),g([m],Ti.prototype,"styler",2),g([m],Ti.prototype,"marker",2),g([m],Ti.prototype,"label",2),g([m],Ti.prototype,"tooltip",2),g([m],Ti.prototype,"connectMissingData",2);var{DEFAULT_POLAR_DIRECTION_KEYS:Bee,DEFAULT_POLAR_DIRECTION_NAMES:_ee,PolarAxis:Vee,SeriesNodePickMode:Wz,valueProperty:$z,fixNumericExtent:Gee,seriesLabelFadeInAnimation:Hee,markerFadeInAnimation:jee,resetMarkerFn:Wee,resetLabelFn:$ee,animationValidation:Uee,computeMarkerFocusBounds:Kee,BBox:Yee,Group:Zee,Path:Xee,Selection:PC,Text:qee,Marker:Qee,updateLabelNode:Uz,getMarkerStyles:Jee}=L,ete=class extends L.SeriesNodeEvent{constructor(e,t,i,s){super(e,t,i,s),this.angleKey=s.properties.angleKey,this.radiusKey=s.properties.radiusKey}},RC=class extends L.PolarSeries{constructor(e){super({moduleCtx:e,categoryKey:"angleValue",propertyKeys:Bee,propertyNames:_ee,pickModes:[Wz.NEAREST_NODE,Wz.EXACT_SHAPE_MATCH],canHaveAxes:!0,animationResetFns:{item:Wee,label:$ee},clipFocusBox:!1}),this.NodeEvent=ete,this.lineGroup=this.contentGroup.appendChild(new Zee({name:"radar-line"})),this.lineSelection=PC.select(this.lineGroup,Xee),this.resetInvalidToZero=!1,this.circleCache={r:0,cx:0,cy:0},this.lineGroup.zIndex=0,this.itemGroup.zIndex=1}nodeFactory(){return new Qee}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;if(!i||!t)return{domain:[]};if(e==="angle"){const s=t.getDomain(this,"angleValue","value",i).domain,n=t.getKeySortMetadata(this,"angleValue",i);return{domain:s,sortMetadata:n}}else{const s=t.getDomain(this,"radiusValue","value",i).domain,n=Ro(s.length===0?s:[0].concat(s));return{domain:Gee(n)}}}async processData(e){const{angleKey:t,radiusKey:i}=this.properties,s=[];this.ctx.animationManager.isSkipped()||s.push(Uee());const n=this.axes.radius?.scale.type,o=this.axes.angle?.scale.type;await this.requestDataModel(e,this.data,{props:[$z(t,o,{id:"angleValue"}),$z(i,n,{id:"radiusValue",invalidValue:void 0}),...s]}),this.animationState.transition("updateData")}didCircleChange(){const e=this.radius,t=this.centerX,i=this.centerY,s=this.circleCache;return e===s.r&&t===s.cx&&i===s.cy?!1:(this.circleCache={r:e,cx:t,cy:i},!0)}getAxisInnerRadius(){const e=this.axes.radius;return e instanceof Vee?this.radius*e.innerRadiusRatio:0}maybeRefreshNodeData(){!this.didCircleChange()&&!this.nodeDataRefresh||(this.contextNodeData=this.createNodeData(),this.nodeData=this.contextNodeData?.nodeData??[],this.nodeDataRefresh=!1)}createNodeData(){const{processedData:e,dataModel:t}=this;if(!e||!t)return;const{angleKey:i,radiusKey:s,angleName:n,radiusName:o,legendItemName:a,marker:r,label:l}=this.properties,c=this.axes.angle?.scale,h=this.axes.radius?.scale;if(!c||!h)return;const d=t.resolveColumnById(this,"angleValue",e),u=t.resolveColumnById(this,"radiusValue",e),p=this.getAxisInnerRadius(),f=this.getSeriesDomain("radius").domain,b=(e.dataSources.get(this.id)?.data??[]).map((x,v)=>{const S=d[v],M=u[v],D=c.convert(S),k=this.radius+p-h.convert(M),I=Math.cos(D),A=Math.sin(D),C=I*k,w=A*k;let T;if(l.enabled){const O=this.getLabelText(M,x,s,"radius",f,l,{value:M,datum:x,angleKey:i,radiusKey:s,angleName:n,radiusName:o,legendItemName:a});if(O){let E="right";qe(I,0)?E="center":I>0&&(E="left");let z="bottom";qe(A,0)?z="middle":A>0&&(z="top"),T={x:C+I*r.size,y:w+A*r.size,text:O,textAlign:E,textBaseline:z}}}return{series:this,datum:x,datumIndex:v,index:v,point:{x:C,y:w,size:r.size},midPoint:{x:C,y:w},label:T,angleValue:S,radiusValue:M,missing:!$e(D)||!$e(k)}});return{itemId:s,nodeData:b,labelData:b,styles:Jee(this,this.properties,r)}}update({seriesRect:e}){const t=this.checkResize(e),i=!this.ctx.animationManager.isSkipped(),{series:s}=this.ctx.highlightManager?.getActiveHighlight()??{};this.highlightGroup.visible=(i||this.visible)&&s===this,this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updatePathSelections(),this.updateMarkerSelection(),this.updateHighlightSelection(),this.updatePathNodes(),this.hasItemStylers()&&(this.updateDatumStyles(this.itemSelection,!1),this.updateDatumStyles(this.highlightSelection,!0)),this.updateMarkers(this.itemSelection,!1),this.updateMarkers(this.highlightSelection,!0),this.updateLabels(),t&&this.animationState.transition("resize"),this.animationState.transition("update")}updatePathSelections(){const e=this.visible?[!0]:[];this.lineSelection.update(e)}updateMarkerSelection(){const{marker:e,styler:t}=this.properties;e.isDirty()&&(this.itemSelection.clear(),this.itemSelection.cleanup(),this.itemSelection=PC.select(this.itemGroup,()=>this.nodeFactory(),!1));const i=t==null?e.enabled:this.getStyle().marker.enabled,s=this.visible&&e.shape&&i?this.nodeData:[];this.itemSelection.update(s)}updateHighlightSelection(){const{marker:e,styler:t}=this.properties;e.isDirty()&&(this.highlightSelection.clear(),this.highlightSelection.cleanup(),this.highlightSelection=PC.select(this.highlightGroup,()=>this.nodeFactory(),!1));const i=t==null?e.enabled:this.getStyle().marker.enabled,s=this.ctx.highlightManager?.getActiveHighlight(),n=this.visible&&e.shape&&i&&s?.datum?[{...s}]:[];this.highlightSelection.update(n)}getMarkerFill(e){return e?.fill??this.getStyle().marker.fill}getDatumStylerProperties(e){const{id:t,properties:i}=this,{angleKey:s,radiusKey:n}=i;return{seriesId:t,datum:e,angleKey:s,radiusKey:n}}updateDatumStyles(e,t){const i=this.ctx.highlightManager.getActiveHighlight();e.each((s,n)=>{const o=this.getHighlightState(i,t,n.datumIndex),a=this.getStyle(o),{stroke:r,strokeWidth:l,strokeOpacity:c}=a;n.style=this.getMarkerStyle(this.properties.marker,n,this.getDatumStylerProperties(n.datum),{isHighlight:t,highlightState:o},a.marker,{stroke:r,strokeWidth:l,strokeOpacity:c})})}updateMarkers(e,t){const i=this.getShapeFillBBox(),{contextNodeData:s}=this;if(!s)return;const n=this.ctx.highlightManager.getActiveHighlight();e.each((o,a)=>{const r=a.style??s.styles[this.getHighlightState(n,t,a.datumIndex)];this.applyMarkerStyle(r,o,a.point,i)})}updateLabels(){const{properties:e}=this,t=this.ctx.highlightManager?.getActiveHighlight(),i=t?.series===this&&t?.datum?[{...t}]:[];this.labelSelection.update(this.nodeData).each((s,n)=>{n.label&&(s.fillOpacity=this.getHighlightStyle(!1,n.datumIndex).opacity??1,Uz(this,s,e,e.label,n.label,!1,t))}),this.highlightLabelSelection.update(i).each((s,n)=>{n.label&&(s.fillOpacity=this.getHighlightStyle(!0,n.datumIndex).opacity??1,Uz(this,s,e,e.label,n.label,!0,t))})}getTooltipContent(e){const{id:t,dataModel:i,processedData:s,axes:n,properties:o}=this,{angleKey:a,angleName:r,radiusKey:l,radiusName:c,legendItemName:h,tooltip:d,marker:u}=o,p=n.angle,f=n.radius;if(!i||!s||!p||!f)return;const y=s.dataSources.get(this.id)?.data[e],b=i.resolveColumnById(this,"angleValue",s)[e],x=i.resolveColumnById(this,"radiusValue",s)[e];if(b==null)return;const v=this.getMarkerStyle(u,{datum:y,datumIndex:e},this.getDatumStylerProperties(y),{isHighlight:!1});return this.formatTooltipWithContext(d,{heading:this.getAxisValueText(p,"tooltip",b,y,a,void 0),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:l,value:this.getAxisValueText(f,"tooltip",x,y,l,void 0),missing:L.isTooltipValueMissing(x)}]},{seriesId:t,datum:y,title:r,angleKey:a,radiusKey:l,angleName:r,radiusName:c,legendItemName:h,...v})}legendItemSymbol(){const{stroke:e,strokeWidth:t,strokeOpacity:i,lineDash:s,marker:n}=this.getStyle();return{marker:{shape:n.shape,enabled:n.enabled||t<=0,fill:this.getMarkerFill()??n.stroke??e??"rgba(0, 0, 0, 0)",stroke:n.stroke??e??"rgba(0, 0, 0, 0)",fillOpacity:n.fillOpacity,strokeOpacity:n.strokeOpacity,strokeWidth:n.strokeWidth,lineDash:n.lineDash,lineDashOffset:n.lineDashOffset},line:{enabled:!0,stroke:e,strokeOpacity:i,strokeWidth:t,lineDash:s}}}getLegendData(e){if(e!=="category")return[];const{id:t,ctx:{legendManager:i},visible:s}=this,{radiusKey:n,radiusName:o,legendItemName:a,showInLegend:r}=this.properties;return[{legendType:"category",id:t,itemId:n,seriesId:t,enabled:s&&i.getItemEnabled({seriesId:t,itemId:n}),label:{text:a??o??n},symbol:this.legendItemSymbol(),legendItemName:a,hideInLegend:!r}]}pickNodeClosestDatum(e){const{nodeData:t,centerX:i,centerY:s}=this,{x:n,y:o}=e,a=this.radius;if(Math.hypot(n-i,o-s)>a+this.maxChartMarkerSize)return;let l=1/0,c;for(const h of t){const{point:{x:d=Number.NaN,y:u=Number.NaN}={}}=h;if(Number.isNaN(d)||Number.isNaN(u))continue;const p=Math.hypot(e.x-d-i,e.y-u-s);p<l&&(l=p,c=h)}if(c){const h=Math.max(l-(c.point?.size??0)/2,0);return{datum:c,distance:h}}}computeLabelsBBox(){const{label:e}=this.properties;this.maybeRefreshNodeData();const t=[],i=new qee;for(const s of this.nodeData){if(!e.enabled||!s.label)continue;i.text=s.label.text,i.x=s.label.x,i.y=s.label.y,i.setFont(e),i.setAlign(s.label);const n=i.getBBox();t.push(n)}return t.length===0?null:Yee.merge(t)}getLineNode(){return this.lineSelection?.at(0)}beforePathAnimation(){this.updatePathNodes()}getPathNodesStyle(){const e=this.ctx.highlightManager?.getActiveHighlight(),t=this.getHighlightState(e),i=this.getHighlightStyle(void 0,void 0,t),s=this.getStyle(t);return oe(i,s)}getLinePoints(){const{nodeData:e,resetInvalidToZero:t}=this,{connectMissingData:i}=this.properties;if(e.length===0)return[];const s=this.axes.radius,o=this.axes.angle?.isReversed(),r=s?.isReversed()&&!o?[...e].reverse():e,l=[];let c=!1,h;for(const[d,u]of r.entries()){let{x:p,y:f}=u.point;const y=Number.isNaN(p)||Number.isNaN(f);y||(h??(h=u)),y&&!i&&(p=0,f=0);const b=d===0||!t&&!i&&(y||c);l.push({x:p,y:f,moveTo:b}),c=y}return h!==void 0&&l.push({x:h.point.x,y:h.point.y,moveTo:!1}),l}animateSinglePath(e,t,i){const{path:s}=e;s.clear(!0);const n=this.getAxisInnerRadius(),o=this.axes.radius,r=o?.isReversed()?this.radius+n-o?.scale.convert(0):n;for(const l of t){const{x:c,y:h,arc:d,radius:u=0,startAngle:p=0,endAngle:f=0,moveTo:y}=l,b=Math.atan2(h,c),x=r*Math.cos(b),v=r*Math.sin(b),S=i,M=x*(1-S)+c*S,D=v*(1-S)+h*S;d?s.arc(c,h,u,p,f):y?s.moveTo(M,D):s.lineTo(M,D)}e.checkPathDirty()}animatePaths(e){const t=this.getLinePoints(),i=this.getLineNode();i&&this.animateSinglePath(i,t,e)}animateEmptyUpdateReady(){const{itemSelection:e,labelSelection:t}=this,{animationManager:i}=this.ctx;this.beforePathAnimation(),i.animate({id:`${this.id}_'path`,groupId:this.id,from:0,to:1,phase:"initial",collapsable:!1,onUpdate:s=>this.animatePaths(s),onStop:()=>this.animatePaths(1)}),jee(this,i,"added",e),Hee(this,"labels",i,t,this.highlightLabelSelection)}animateWaitingUpdateReady(e){super.animateWaitingUpdateReady(e),this.resetPaths()}animateReadyResize(e){super.animateReadyResize(e),this.resetPaths()}resetPaths(){const e=this.getLineNode();if(e){const{path:t}=e,i=this.getLinePoints(),s=this.getStyle();e.fill=void 0,e.stroke=s.stroke,e.strokeWidth=s.strokeWidth,e.strokeOpacity=s.strokeOpacity,e.lineDash=s.lineDash,e.lineDashOffset=s.lineDashOffset,t.clear(!0);for(const{x:n,y:o,moveTo:a}of i)a?t.moveTo(n,o):t.lineTo(n,o);return e.checkPathDirty(),s}}getStylerResult(e,t){const{styler:i}=this.properties;if(i){const s=this.makeStylerParams(t),n=this.cachedCallWithContext(i,s)??{},o=this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],n,{pick:!1});o&&(e=o)}return e}getFormattedMarkerStyle(e){const{angleKey:t,radiusKey:i}=this.properties;return this.getMarkerStyle(this.properties.marker,e,{angleKey:t,radiusKey:i},{isHighlight:!0})}computeFocusBounds(e){return Kee(this,e)}hasItemStylers(){return this.properties.styler!=null||this.properties.marker.itemStyler!=null||this.properties.label.itemStyler!=null}};RC.className="RadarSeries";var FC=class extends Ti{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1}};g([m],FC.prototype,"fill",2),g([m],FC.prototype,"fillOpacity",2);var{Group:tte,HighlightState:ite,Path:ste,PointerEvents:Kz,Selection:nte,toHighlightString:ote}=L,zC=class extends RC{constructor(e){super(e),this.properties=new FC,this.areaGroup=this.contentGroup.appendChild(new tte({name:"radar-area"})),this.areaSelection=nte.select(this.areaGroup,ste),this.resetInvalidToZero=!0,this.areaGroup.zIndex=-1}updatePathSelections(){const e=this.visible?[!0]:[];this.areaSelection.update(e),super.updatePathSelections()}getAreaNode(){return this.areaSelection.at(0)}getMarkerFill(e){if(e?.fill!=null)return e.fill;const t=this.getStyle();return t.marker.fill??t.fill}updatePathNodes(){const e=this.getPathNodesStyle(),{fill:t,fillOpacity:i,strokeWidth:s,stroke:n,strokeOpacity:o,lineDash:a,lineDashOffset:r,opacity:l}=e,c=this.getLineNode();c&&c.setProperties({fill:void 0,lineJoin:"round",lineCap:"round",pointerEvents:Kz.None,opacity:l,stroke:n,strokeWidth:s,strokeOpacity:o,lineDash:a,lineDashOffset:r});const h=this.getAreaNode();h&&(h.setStyleProperties({fill:t,fillOpacity:i,stroke:void 0},this.getShapeFillBBox()),h.setProperties({lineJoin:"round",pointerEvents:Kz.None,opacity:l}))}animatePaths(e){super.animatePaths(e);const t=this.getAreaNode();t&&this.animateSinglePath(t,this.getAreaPoints(),e)}getAreaPoints(){const e=this.getLinePoints(),t=a=>{const r=this.axes[a];return r instanceof L.PolarAxis?r:void 0},i=t("radius"),s=t("angle");if(!i?.isReversed())return e;const o=s?.getAxisLinePoints()?.points??[];return e.concat(...o)}resetPaths(){const e=super.resetPaths(),t=this.getAreaNode();if(t){const{path:i}=t,s=this.getAreaPoints(),n=e??this.getStyle(),o=this.getShapeFillBBox();t.setStyleProperties({fill:n.fill,stroke:void 0,fillOpacity:n.fillOpacity,lineDash:n.lineDash,lineDashOffset:n.lineDashOffset},o),t.lineJoin=t.lineCap="round",i.clear(!0);for(const{x:a,y:r,moveTo:l,arc:c,radius:h=0,startAngle:d=0,endAngle:u=0}of s)c?i.arc(a,r,h,d,u):l?i.moveTo(a,r):i.lineTo(a,r);return i.closePath(),t.checkPathDirty(),n}}makeStylerParams(e){const{properties:t}=this,i=ote(e??ite.None);return{marker:{fill:t.marker.fill,fillOpacity:t.marker.fillOpacity,size:t.marker.size,shape:t.marker.shape,stroke:t.marker.stroke,strokeOpacity:t.marker.strokeOpacity,strokeWidth:t.marker.strokeWidth,lineDash:t.marker.lineDash,lineDashOffset:t.marker.lineDashOffset},highlightState:i,fill:t.fill,fillOpacity:t.fillOpacity,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,seriesId:this.id,stroke:t.stroke,strokeOpacity:t.strokeOpacity,strokeWidth:t.strokeWidth,angleKey:t.angleKey,radiusKey:t.radiusKey}}getStyle(e){const{marker:t,fill:i,fillOpacity:s,lineDash:n,lineDashOffset:o,stroke:a,strokeOpacity:r,strokeWidth:l}=this.properties,{size:c,shape:h,fill:d="transparent",fillOpacity:u}=t,p=this.getStylerResult({},e);return p.marker??(p.marker={}),{fill:p.fill??i,fillOpacity:p.fillOpacity??s,lineDash:p.lineDash??n,lineDashOffset:p.lineDashOffset??o,stroke:p.stroke??a,strokeOpacity:p.strokeOpacity??r,strokeWidth:p.strokeWidth??l,marker:{enabled:p.marker.enabled??t.enabled,fill:p.marker.fill??d,fillOpacity:p.marker.fillOpacity??u,shape:p.marker.shape??h,size:p.marker.size??c,lineDash:p.marker.lineDash??t.lineDash??n,lineDashOffset:p.marker.lineDashOffset??t.lineDashOffset??o,stroke:p.marker.stroke??t.stroke??a,strokeOpacity:p.marker.strokeOpacity??t.strokeOpacity??r,strokeWidth:p.marker.strokeWidth??t.strokeWidth??l}}}};zC.className="RadarAreaSeries",zC.type="radar-area";var{radarAreaSeriesThemeableOptionsDef:ate}=L,BC={...et,...ate,type:$(Le("radar-area")),angleKey:$(N),radiusKey:$(N),angleName:N,radiusName:N,legendItemName:N};BC.angleKeyAxis=ee(N),BC.radiusKeyAxis=ee(N);var Yz={type:"series",name:"radar-area",chartType:"polar",enterprise:!0,version:ue,dependencies:[Nr],options:BC,defaultAxes:{angle:{type:"angle-category"},radius:{type:"radius-number"}},axisKeys:{angle:"angleKeyAxis",radius:"radiusKeyAxis"},themeTemplate:Eee,create:e=>new zC(e)},{HighlightState:rte,PointerEvents:lte,toHighlightString:cte}=L,_C=class extends RC{constructor(){super(...arguments),this.properties=new Ti}updatePathSelections(){this.lineSelection.update(this.visible?[!0]:[])}updatePathNodes(){const e=this.getLineNode();if(!e)return;const t=this.getPathNodesStyle(),{strokeWidth:i,stroke:s,strokeOpacity:n,lineDash:o,lineDashOffset:a,opacity:r}=t;e.setProperties({fill:void 0,lineJoin:"round",lineCap:"round",pointerEvents:lte.None,opacity:r,stroke:s,strokeWidth:i,strokeOpacity:n,lineDash:o,lineDashOffset:a})}makeStylerParams(e){const{properties:t}=this,i=cte(e??rte.None);return{marker:{fill:t.marker.fill,fillOpacity:t.marker.fillOpacity,size:t.marker.size,shape:t.marker.shape,stroke:t.marker.stroke,strokeOpacity:t.marker.strokeOpacity,strokeWidth:t.marker.strokeWidth,lineDash:t.marker.lineDash,lineDashOffset:t.marker.lineDashOffset},highlightState:i,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,seriesId:this.id,stroke:t.stroke,strokeOpacity:t.strokeOpacity,strokeWidth:t.strokeWidth,angleKey:t.angleKey,radiusKey:t.radiusKey}}getStyle(e){const{marker:t,lineDash:i,lineDashOffset:s,stroke:n,strokeOpacity:o,strokeWidth:a}=this.properties,{size:r,shape:l,fill:c="transparent",fillOpacity:h}=t,d=this.getStylerResult({},e);return d.marker??(d.marker={}),{lineDash:d.lineDash??i,lineDashOffset:d.lineDashOffset??s,stroke:d.stroke??n,strokeOpacity:d.strokeOpacity??o,strokeWidth:d.strokeWidth??a,marker:{enabled:d.marker.enabled??t.enabled,fill:d.marker.fill??c,fillOpacity:d.marker.fillOpacity??h,shape:d.marker.shape??l,size:d.marker.size??r,lineDash:d.marker.lineDash??t.lineDash??i,lineDashOffset:d.marker.lineDashOffset??t.lineDashOffset??s,stroke:d.marker.stroke??t.stroke??n,strokeOpacity:d.marker.strokeOpacity??t.strokeOpacity??o,strokeWidth:d.marker.strokeWidth??t.strokeWidth??a}}}};_C.className="RadarLineSeries",_C.type="radar-line";var{radarLineSeriesThemeableOptionsDef:hte}=L,VC={...et,...hte,type:$(Le("radar-line")),angleKey:$(N),radiusKey:$(N),angleName:N,radiusName:N,legendItemName:N};VC.angleKeyAxis=ee(N),VC.radiusKeyAxis=ee(N);var Zz={type:"series",name:"radar-line",chartType:"polar",enterprise:!0,version:ue,dependencies:[Nr],options:VC,defaultAxes:{angle:{type:"angle-category"},radius:{type:"radius-number"}},axisKeys:{angle:"angleKeyAxis",radius:"radiusKeyAxis"},themeTemplate:Oee,create:e=>new _C(e)},{SeriesProperties:dte,makeSeriesTooltip:ute,Label:pte}=L,ei=class extends dte{constructor(){super(...arguments),this.angleKeyAxis="angle",this.radiusKeyAxis="radius",this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.label=new pte,this.tooltip=ute()}getStyle(){const{fill:e,fillOpacity:t,stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:o,lineDashOffset:a,cornerRadius:r}=this;return{fill:e,fillOpacity:t,stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:o,lineDashOffset:a,cornerRadius:r,opacity:1}}};g([m],ei.prototype,"angleKey",2),g([m],ei.prototype,"radiusKey",2),g([m],ei.prototype,"angleName",2),g([m],ei.prototype,"radiusName",2),g([m],ei.prototype,"angleKeyAxis",2),g([m],ei.prototype,"radiusKeyAxis",2),g([m],ei.prototype,"legendItemName",2),g([m],ei.prototype,"fill",2),g([m],ei.prototype,"fillOpacity",2),g([m],ei.prototype,"stroke",2),g([m],ei.prototype,"strokeWidth",2),g([m],ei.prototype,"strokeOpacity",2),g([m],ei.prototype,"lineDash",2),g([m],ei.prototype,"lineDashOffset",2),g([m],ei.prototype,"cornerRadius",2),g([m],ei.prototype,"styler",2),g([m],ei.prototype,"itemStyler",2),g([m],ei.prototype,"rotation",2),g([m],ei.prototype,"stackGroup",2),g([m],ei.prototype,"normalizedTo",2),g([m],ei.prototype,"label",2),g([m],ei.prototype,"tooltip",2);var{SectorBox:Xz,motion:gte}=L;function fte(e,t,i){if(i==="updated"){if(e.previousDatum==null||Number.isNaN(e.previousDatum.innerRadius)||Number.isNaN(e.previousDatum.outerRadius))return"added";if(Number.isNaN(t.innerRadius)||Number.isNaN(t.outerRadius))return"removed"}return i==="added"&&e.previousDatum!=null?"updated":i}function qz(e){return{toFn:(s,n,o)=>{let a,r,l,c,h;return o==="removed"?(a=e,r=e,l=n.innerRadius,c=n.outerRadius,h=new Xz(a,r,l,c)):(a=n.startAngle,r=n.endAngle,l=Number.isNaN(n.innerRadius)?s.innerRadius:n.innerRadius,c=Number.isNaN(n.outerRadius)?s.outerRadius:n.outerRadius,h=n.clipSector),{startAngle:a,endAngle:r,innerRadius:l,outerRadius:c,clipSector:h}},fromFn:(s,n,o)=>{o=fte(s,n,o);let a,r,l,c,h;o==="removed"||o==="updated"?(a=s.startAngle,r=s.endAngle,l=s.innerRadius,c=s.outerRadius,h=s.clipSector):(a=e,r=e,l=n.innerRadius,c=n.outerRadius),h??(h=new Xz(a,r,l,c));const d=gte.NODE_UPDATE_STATE_TO_PHASE_MAPPING[o];return{startAngle:a,endAngle:r,innerRadius:l,outerRadius:c,clipSector:h,phase:d}}}}function mte(e,t){return{centerX:0,centerY:0,innerRadius:t.innerRadius,outerRadius:t.outerRadius,startAngle:t.startAngle,endAngle:t.endAngle,clipSector:t.clipSector}}var{DEFAULT_POLAR_DIRECTION_KEYS:yte,DEFAULT_POLAR_DIRECTION_NAMES:xte,PolarAxis:bte,diff:vte,groupAccumulativeValueProperty:Qz,keyProperty:Ste,normaliseGroupTo:Mte,valueProperty:Dte,fixNumericExtent:Ite,resetLabelFn:kte,seriesLabelFadeInAnimation:Ate,seriesLabelFadeOutAnimation:Cte,animationValidation:Lte,createDatumId:wte,CategoryScale:Tte,Sector:Nte,SectorBox:Ote,motion:Jz,updateLabelNode:eB,getItemStyles:Ete}=L,Pte=class extends L.SeriesNodeEvent{constructor(e,t,i,s){super(e,t,i,s),this.angleKey=s.properties.angleKey,this.radiusKey=s.properties.radiusKey}},GC=class extends L.PolarSeries{constructor(e){super({moduleCtx:e,categoryKey:"radiusValue",propertyKeys:yte,propertyNames:xte,canHaveAxes:!0,animationResetFns:{item:mte,label:kte}}),this.properties=new ei,this.NodeEvent=Pte,this.groupScale=new Tte,this.circleCache={r:0,cx:0,cy:0}}nodeFactory(){return new Nte}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;if(!i||!t)return{domain:[]};if(e==="angle"){const s=t.getDomain(this,"angleValue-end","value",i).domain,n=[Math.min(s[0],0),Math.max(s[1],0)];return{domain:Ite(n)}}else return t.getDomain(this,"radiusValue","key",i)}async processData(e){const{angleKey:t,radiusKey:i,normalizedTo:s}=this.properties,n=!this.ctx.animationManager.isSkipped(),o=this.getStackId(),a=`${o}-trailing`,r=[];St(s)&&r.push(Mte([o,a],Math.abs(s))),this.needsDataModelDiff()&&this.processedData&&r.push(vte(this.id,this.processedData)),n&&r.push(Lte());const l=this.visible?{}:{forceValue:0},c=this.axes.radius?.scale.type,h=this.axes.angle?.scale.type;await this.requestDataModel(e,this.data,{props:[Ste(i,c,{id:"radiusValue"}),Dte(t,h,{id:"angleValue-raw",invalidValue:null,...l}),...Qz(t,"normal",{id:"angleValue-end",rangeId:"angleValue-range",invalidValue:null,groupId:o,separateNegative:!0,...l},h),...Qz(t,"trailing",{id:"angleValue-start",invalidValue:null,groupId:a,separateNegative:!0,...l},h),...r],groupByKeys:!0,groupByData:!1}),this.animationState.transition("updateData")}didCircleChange(){const e=this.radius,t=this.centerX,i=this.centerY,s=this.circleCache;return e===s.r&&t===s.cx&&i===s.cy?!1:(this.circleCache={r:e,cx:t,cy:i},!0)}maybeRefreshNodeData(){!this.didCircleChange()&&!this.nodeDataRefresh||(this.contextNodeData=this.createNodeData(),this.nodeData=this.contextNodeData?.nodeData??[],this.nodeDataRefresh=!1)}getAxisInnerRadius(){const e=this.axes.radius;return e instanceof bte?this.radius*e.innerRadiusRatio:0}createNodeData(){const{processedData:e,dataModel:t}=this;if(!t||!e||e.type!=="grouped")return;const i=this.axes.angle,s=this.axes.radius,n=i?.scale,o=s?.scale;if(!n||!o)return;const a=t.resolveKeysById(this,"radiusValue",e),r=t.resolveColumnById(this,"angleValue-start",e),l=t.resolveColumnById(this,"angleValue-end",e),c=t.resolveColumnById(this,"angleValue-raw",e),h=t.resolveProcessedDataIndexById(this,"angleValue-range");let d=0;s instanceof Gh&&(d=s.groupPaddingInner);const{groupScale:u}=this,{index:p,visibleGroupCount:f}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);u.domain=Array.from({length:f}).map((B,V)=>String(V)),u.range=[0,Math.abs(o.bandwidth??0)],u.paddingInner=f>1?d:0;const y=u.bandwidth>=1?u.bandwidth:u.rawBandwidth,b=i.isReversed(),x=s.isReversed(),v=x?this.radius:this.getAxisInnerRadius(),M=(x?this.getAxisInnerRadius():this.radius)+v,D=this.getSeriesDomain("angle").domain,{angleKey:k,radiusKey:I,angleName:A,radiusName:C,legendItemName:w,label:T}=this.properties,O=(B,V,Y,X)=>{const q=this.getLabelText(V,B,k,"angle",D,T,{value:V,datum:B,angleKey:k,radiusKey:I,angleName:A,radiusName:C,legendItemName:w});if(q)return{x:Y,y:X,text:q,textAlign:"center",textBaseline:"middle"}},E=[],z=Ete((B,V,Y)=>bp(this,B,V,Y)),F={itemId:I,nodeData:E,labelData:E,styles:z};if(!this.visible)return F;const{dataSources:_}=e,G=_.get(this.id)?.data??[];for(const{datumIndex:B,group:V}of t.forEachGroupDatum(this,e)){const Y=G[B],X=a[B];if(X==null)return;const q=c[B],te=r[B],pe=l[B],Se=q>=0&&!Object.is(q,-0),ve=V.aggregation[h][Se?1:0],ae=Se===b;let Ie=n.convert(te,{clamp:!0}),ze=n.convert(pe,{clamp:!0}),Xe=n.convert(0,{clamp:!0}),Te=n.convert(ve,{clamp:!0});ae&&([Xe,Te]=[Te,Xe],[Ie,ze]=[ze,Ie]);const De=M-o.convert(X)+u.convert(String(p)),ye=De+y,Ee=(De+ye)/2,Ne=Ie+Eo(Ie,ze)/2,xt=Math.cos(Ne)*Ee,nt=Math.sin(Ne)*Ee,We=this.properties.label.enabled?O(Y,q,xt,nt):void 0,rt=new Ote(Ie,ze,De,ye);E.push({series:this,datum:Y,datumIndex:B,point:{x:xt,y:nt,size:0},midPoint:{x:xt,y:nt},label:We,angleValue:q,radiusValue:X,innerRadius:De,outerRadius:ye,startAngle:Xe,endAngle:Te,clipSector:rt,reversed:ae,index:B})}return F}update({seriesRect:e}){const t=this.checkResize(e);this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updateSectorSelection(this.itemSelection,!1),this.updateSectorSelection(this.highlightSelection,!0),this.updateLabels(),t&&this.animationState.transition("resize"),this.animationState.transition("update")}updateSectorSelection(e,t){let i=[];const s=this.ctx.highlightManager?.getActiveHighlight();t?s?.datum&&s.series===this&&i.push(s):i=this.nodeData;const{contextNodeData:n}=this;if(!n)return;const o=this.ctx.highlightManager.getActiveHighlight(),a=this.getShapeFillBBox(),r=this.hasItemStylers();e.update(i,void 0,l=>this.getDatumId(l)).each((l,c)=>{const h=Rf(c);if(h==null)return;if(r){const y=this.getHighlightState(s,t,c.datumIndex);c.style=bp(this,c,t,y)}const d=c.style??n.styles[this.getHighlightState(o,t,c.datumIndex)],u=d.cornerRadius,p=d.fill,f=Ut(p)&&p.bounds!=="item"?{centerX:0,centerY:0}:void 0;l.setStyleProperties(d,a,f),l.lineJoin="round",l.inset=l.stroke==null?0:l.strokeWidth/2,l.startInnerCornerRadius=h.reversed?u:0,l.startOuterCornerRadius=h.reversed?u:0,l.endInnerCornerRadius=h.reversed?0:u,l.endOuterCornerRadius=h.reversed?0:u,t&&(l.startAngle=c.startAngle,l.endAngle=c.endAngle,l.clipSector=c.clipSector,l.innerRadius=c.innerRadius,l.outerRadius=c.outerRadius)})}updateLabels(){const{properties:e}=this,t=this.ctx.highlightManager?.getActiveHighlight(),i=t?.series===this&&t?.datum?t:void 0,s=i?[i]:[];this.labelSelection.update(this.nodeData).each((n,o)=>{eB(this,n,e,e.label,o.label,!1,t),n.fillOpacity=this.getHighlightStyle(!1,o.datumIndex).opacity??1}),this.highlightLabelSelection.update(s,void 0,n=>this.getDatumId(n)).each((n,o)=>{eB(this,n,e,e.label,o.label,!0,t),n.fillOpacity=this.getHighlightStyle(!0,o.datumIndex).opacity??1})}getBarTransitionFunctions(){const e=this.axes.angle?.scale;let t=0;if(!e)return qz(t);const i=Math.min(e.domain[0],e.domain[1]),s=Math.max(e.domain[0],e.domain[1]);return i<=0&&s>=0&&(t=e.convert(0)),qz(t)}animateEmptyUpdateReady(){const{labelSelection:e}=this,t=this.getBarTransitionFunctions();Jz.fromToMotion(this.id,"datums",this.ctx.animationManager,[this.itemSelection],t),Ate(this,"labels",this.ctx.animationManager,e,this.highlightLabelSelection)}animateClearingUpdateEmpty(){const{itemSelection:e}=this,{animationManager:t}=this.ctx,i=this.getBarTransitionFunctions();Jz.fromToMotion(this.id,"datums",t,[e],i),Cte(this,"labels",t,this.labelSelection,this.highlightLabelSelection)}getTooltipContent(e){const{id:t,dataModel:i,processedData:s,axes:n,properties:o}=this,{angleKey:a,angleName:r,radiusKey:l,radiusName:c,legendItemName:h,tooltip:d}=o,u=n.angle,p=n.radius,f=this.nodeData?.[e];if(!i||!s||!u||!p||!f)return;const y=s.dataSources.get(this.id)?.data[e],b=i.resolveKeysById(this,"radiusValue",s)[e],x=i.resolveColumnById(this,"angleValue-raw",s)[e];if(b==null)return;const v=bp(this,f,!1);return this.formatTooltipWithContext(d,{heading:this.getAxisValueText(p,"tooltip",b,y,l,void 0),symbol:this.legendItemSymbol(),data:[{label:r,fallbackLabel:a,value:this.getAxisValueText(u,"tooltip",x,y,a,void 0),missing:L.isTooltipValueMissing(x)}]},{seriesId:t,datum:y,title:r,angleKey:a,angleName:r,radiusKey:l,radiusName:c,legendItemName:h,...v})}pickNodeClosestDatum(e){return this.pickNodeNearestDistantObject(e,this.itemSelection.nodes())}legendItemSymbol(){const{fill:e,stroke:t,fillOpacity:i,strokeOpacity:s,strokeWidth:n,lineDash:o,lineDashOffset:a}=TC(this,!1,L.HighlightState.None),r={fill:e??"rgba(0, 0, 0, 0)",stroke:t??"rgba(0, 0, 0, 0)",fillOpacity:i,strokeOpacity:s,strokeWidth:n,lineDash:o,lineDashOffset:a};return Ut(r.fill)&&(r.fill={...r.fill,gradient:"linear",rotation:0,reverse:!1}),{marker:r}}getLegendData(e){if(e!=="category")return[];const{id:t,visible:i}=this,{angleKey:s,angleName:n,legendItemName:o,showInLegend:a}=this.properties;return[{legendType:"category",id:t,itemId:s,seriesId:t,enabled:i,label:{text:o??n??s},symbol:this.legendItemSymbol(),legendItemName:o,hideInLegend:!a}]}getDatumId(e){return wte(e.radiusValue)}computeLabelsBBox(){return null}getStackId(){return`radialBar-stack-${this.seriesGrouping?.groupIndex??this.id}-xValues`}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.styler!=null||this.properties.label.itemStyler!=null}};GC.className="RadialBarSeries",GC.type="radial-bar";var{radialBarSeriesThemeableOptionsDef:Rte}=L,HC={...et,...Rte,type:$(Le("radial-bar")),angleKey:$(N),radiusKey:$(N),angleName:N,radiusName:N,legendItemName:N,grouped:R,stacked:R,stackGroup:N,normalizedTo:W};HC.angleKeyAxis=ee(N),HC.radiusKeyAxis=ee(N);var{FILL_GRADIENT_CONIC_SERIES_DEFAULTS:Fte,FILL_IMAGE_DEFAULTS:zte,FILL_PATTERN_DEFAULTS:Bte}=L,_te={series:{fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",Fte],["image",zte],["pattern",Bte]]},stroke:{$palette:"stroke"},strokeWidth:{$isUserOption:["./stroke",1,0]},label:{...L.LABEL_BOXING_DEFAULTS,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"chartBackgroundColor"}},highlight:L.multiSeriesHighlightStyle()},axes:{"radius-category":{innerRadiusRatio:.2,groupPaddingInner:.2,paddingInner:.2,paddingOuter:.1}}},tB={type:"series",name:"radial-bar",chartType:"polar",enterprise:!0,stackable:!0,groupable:!0,version:ue,dependencies:[Nr],options:HC,defaultAxes:{angle:{type:"angle-number"},radius:{type:"radius-category"}},axisKeys:{angle:"angleKeyAxis",radius:"radiusKeyAxis"},themeTemplate:_te,create:e=>new GC(e)},jC=class extends Ht{};g([m],jC.prototype,"columnWidthRatio",2),g([m],jC.prototype,"maxColumnWidthRatio",2);var{PolarAxis:Vte,RadialColumnShape:Gte,getRadialColumnWidth:Hte}=L,WC=class extends _z{constructor(e){super(e,{animationResetFns:{item:See}}),this.properties=new jC}getStackId(){return`radarColumn-stack-${this.seriesGrouping?.groupIndex??this.id}-yValues`}nodeFactory(){return new Gte}getColumnTransitionFunctions(){const e=this.isRadiusAxisReversed()?this.radius:this.getAxisInnerRadius();return vee(e)}isRadiusAxisCircle(){const e=this.axes.radius;return e instanceof Vte?e.shape==="circle":!1}updateItemPath(e,t,i){e.isBeveled=this.isRadiusAxisCircle(),i&&(e.innerRadius=t.innerRadius,e.outerRadius=t.outerRadius,e.startAngle=t.startAngle,e.endAngle=t.endAngle,e.columnWidth=t.columnWidth,e.axisInnerRadius=t.axisInnerRadius,e.axisOuterRadius=t.axisOuterRadius)}getColumnWidth(e,t){const{columnWidthRatio:i=.5,maxColumnWidthRatio:s=.5}=this.properties;return Hte(e,t,this.radius,i,s)}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.styler!=null||this.properties.label.itemStyler!=null}};WC.className="RadialColumnSeries",WC.type="radial-column";var{radialColumnSeriesThemeableOptionsDef:jte}=L,$C={...et,...jte,type:$(Le("radial-column")),angleKey:$(N),radiusKey:$(N),angleName:N,radiusName:N,legendItemName:N,grouped:R,stacked:R,stackGroup:N,normalizedTo:W};$C.angleKeyAxis=ee(N),$C.radiusKeyAxis=ee(N);var{FILL_GRADIENT_RADIAL_SERIES_DEFAULTS:Wte,FILL_IMAGE_DEFAULTS:$te,FILL_PATTERN_DEFAULTS:Ute}=L,Kte={series:{fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",Wte],["image",$te],["pattern",Ute]]},stroke:{$palette:"stroke"},columnWidthRatio:.5,maxColumnWidthRatio:.5,strokeWidth:{$isUserOption:["./stroke",1,0]},label:{...L.LABEL_BOXING_DEFAULTS,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},highlight:L.multiSeriesHighlightStyle()},axes:{"angle-category":{shape:{$findFirstSiblingNotOperation:"circle"},groupPaddingInner:0,paddingInner:0,label:{spacing:10}},"radius-number":{shape:{$findFirstSiblingNotOperation:"circle"},innerRadiusRatio:.5}}},iB={type:"series",name:"radial-column",chartType:"polar",enterprise:!0,stackable:!0,groupable:!0,version:ue,dependencies:[Nr],options:$C,defaultAxes:{angle:{type:"angle-category"},radius:{type:"radius-number"}},axisKeys:{angle:"angleKeyAxis",radius:"radiusKeyAxis"},themeTemplate:Kte,create:e=>new WC(e)},sB=[tE,Cz,Az,Pz,Ez,Hz,Yz,Zz,tB,iB,Mf,Pf,iv,Lv].flat(),{Chart:Yte,MercatorScale:nB}=L;function Zte(e){return e.type==="map-shape"||e.type==="map-line"||e.type==="map-marker"||e.type==="map-shape-background"||e.type==="map-line-background"}var Fv=class extends Yte{constructor(e,t){super(e,t),this.xAxis={id:Mi(L.Axis),direction:"x"},this.yAxis={id:Mi(L.Axis),direction:"y"},this.ctx.zoomManager.setAxes([this.xAxis,this.yAxis])}getChartType(){return"topology"}updateData(){super.updateData();const e=this.getOptions();this.topology!==e.topology&&(this.topology=e.topology);const{topology:t}=this;for(const i of this.series)Zte(i)&&i.setChartTopology(t)}performLayout(e){const{seriesRoot:t,annotationRoot:i}=this,s=e.layoutBox.clone().shrink(this.seriesArea.getPadding());this.seriesRect=s,this.animationRect=s;const n=this.series,o=n.reduce((l,c)=>{if(!c.visible)return l;const h=c.topologyBounds;return h==null?l:l==null?h:l.merge(h)},void 0);let a;if(o!=null){const{lon0:l,lat0:c,lon1:h,lat1:d}=o,u=[[l,c],[h,d]],p=nB.bounds(u),{width:f,height:y}=s,b=Math.min(f/p.width,y/p.height),x=p.width*b,v=p.height*b,S=(f-x)/2,M=(y-v)/2,D=S,k=M,I=S+x,A=M+v,C=this.ctx.zoomManager.getAxisZoom(this.xAxis.id),w=this.ctx.zoomManager.getAxisZoom(this.yAxis.id),T=(I-D)/(C.max-C.min),O=D-T*C.min,E=(A-k)/(1-w.min-(1-w.max)),z=k-E*(1-w.max);a=new nB(u,[[O,z],[O+T,z+E]])}for(const l of n)l.scale=a;const r=this.series.some(l=>l.visible);t.visible=r;for(const l of[t,i])l.translationX=Math.floor(s.x),l.translationY=Math.floor(s.y),l.setClipRect(s.clone());this.ctx.layoutManager.emitLayoutComplete(e,{series:{visible:r,rect:s,paddedRect:e.layoutBox}})}};Fv.className="TopologyChart",Fv.type="topology",g([m],Fv.prototype,"topology",2);var{topologyChartOptionsDefs:Xte}=L,Zf={type:"chart",name:"topology",enterprise:!0,version:ue,options:Xte,create(e,t){return new Fv(e,t)}},Xf={zoom:{axes:"xy",anchorPointX:"pointer",anchorPointY:"pointer",buttons:{anchorPointX:"middle",anchorPointY:"middle"}},legend:{enabled:!1}};function Wa(e){const t=Re(e);return ya(t,i=>{typeof i=="object"&&"$palette"in i&&(i.$mapPalette=i.$palette,delete i.$palette)}),t}var qte=1e-9;function oB(e,t,i,s){const[n,o]=e,[a,r]=t,l=a-n,c=r-o,h=l*l+c*c;let d,u;if(Math.abs(h)<qte)d=n,u=o;else{let y=((i-n)*l+(s-o)*c)/h;y=Math.max(0,Math.min(1,y)),d=n+y*(a-n),u=o+y*(r-o)}const p=i-d,f=s-u;return p*p+f*f}function aB(e,t,i){let s=1/0,n=e.at(-1);for(const o of e)s=Math.min(s,oB(n,o,t,i)),n=o;return Math.sqrt(s)}function UC(e){let[t,i]=e[0],s=0;for(let n=1;n<e.length;n+=1){const[o,a]=e[n],r=Math.hypot(o-t,a-i);s+=r,t=o,i=a}return s}function zv(e){if(e.length===0)return;const t=UC(e)/2;let[i,s]=e[0],n=0;for(let o=1;o<e.length;o+=1){const[a,r]=e[o],l=Math.hypot(a-i,r-s),c=n+l;if(c>t){const h=(t-n)/l,d=[i+(a-i)*h,s+(r-s)*h],u=Math.atan2(r-s,a-i);return{point:d,angle:u}}n=c,i=a,s=r}}function vp(e,t){for(const i of e){const[s,n]=i;t=Tc.extend(t,s,n,s,n)}return t}function Qte(e){if(e.length===0)return;let t=0,i=0,s=0,[n,o]=e.at(-1);for(const[a,r]of e){const l=n*r-a*o;s+=l,t+=(n+a)*l,i+=(o+r)*l,n=a,o=r}return s*=3,[t/s,i/s]}function Bv(e,t,i){let s=!1,n=1/0;for(const o of e){let a=o.at(-1),[r,l]=a;for(const c of o){const[h,d]=c;d>i!=l>i&&t<(r-h)*(i-d)/(l-d)+h&&(s=!s),n=Math.min(n,oB(a,c,t,i)),a=c,r=h,l=d}}return(s?-1:1)*Math.sqrt(n)}var{Path:Jte,ExtendedPath2D:eie,BBox:tie}=L,Sp=class extends Jte{constructor(){super(...arguments),this.projectedGeometry=void 0,this.renderMode=3,this.strokePath=new eie}computeBBox(){return(this.dirtyPath||this.isDirtyPath())&&(this.updatePath(),this.dirtyPath=!1),this.bbox?.clone()}updatePath(){const{projectedGeometry:e}=this;this.strokePath.clear(),this.path.clear(),this.bbox=e==null?void 0:this.drawGeometry(e,void 0)}drawPath(e){super.drawPath(e),this.renderStroke(e,this.strokePath.getPath2D())}containsPoint(e,t){const{projectedGeometry:i}=this;return i==null||!this.getBBox().containsPoint(e,t)?!1:this.geometryDistance(i,e,t)<=0}distanceSquared(e,t){const{projectedGeometry:i}=this;if(i==null)return 1/0;const s=this.geometryDistance(i,e,t);return s>0?s*s:0}geometryDistance(e,t,i){const{renderMode:s,strokeWidth:n}=this,o=(s&1)!==0,a=(s&2)!==0,r=Math.max(n/2,1)+1;switch(e.type){case"GeometryCollection":return e.geometries.reduce((l,c)=>Math.min(l,this.geometryDistance(c,t,i)),1/0);case"MultiPolygon":return o?e.coordinates.reduce((l,c)=>Math.min(l,Math.max(Bv(c,t,i),0)),1/0):1/0;case"Polygon":return o?Math.max(Bv(e.coordinates,t,i),0):1/0;case"MultiLineString":return a?e.coordinates.reduce((l,c)=>Math.min(l,Math.max(aB(c,t,i)-r,0)),1/0):1/0;case"LineString":return a?Math.max(aB(e.coordinates,t,i)-r,0):1/0;case"MultiPoint":case"Point":default:return 1/0}}shouldDrawPolygons(){return(this.renderMode&1)!==0}shouldDrawLines(){return(this.renderMode&2)!==0}drawGeometryCollection(e,t){for(const i of e)t=this.drawGeometry(i,t);return t}drawMultiPolygon(e,t){if(!this.shouldDrawPolygons())return t;for(const i of e)t=this.drawPolygon(this.path,i,t);return t}drawSinglePolygon(e,t){return this.shouldDrawPolygons()?this.drawPolygon(this.path,e,t):t}drawMultiLineString(e,t){if(!this.shouldDrawLines())return t;for(const i of e)t=this.drawLineString(this.strokePath,i,t,!1);return t}drawSingleLineString(e,t){return this.shouldDrawLines()?this.drawLineString(this.strokePath,e,t,!1):t}drawGeometry(e,t){switch(e.type){case"GeometryCollection":return this.drawGeometryCollection(e.geometries,t);case"MultiPolygon":return this.drawMultiPolygon(e.coordinates,t);case"Polygon":return this.drawSinglePolygon(e.coordinates,t);case"MultiLineString":return this.drawMultiLineString(e.coordinates,t);case"LineString":return this.drawSingleLineString(e.coordinates,t);case"Point":case"MultiPoint":return t}}drawPolygon(e,t,i){if(t.length<1)return i;i=this.drawLineString(e,t[0],i,!0);for(let s=1;s<t.length;s+=1){const n=t[s];this.drawLineString(e,n,void 0,!0)}return i}drawLineString(e,t,i,s){if(t.length<2)return i;const n=s?t.length-1:t.length;for(let o=0;o<n;o+=1){const[a,r]=t[o];if(o===0?e.moveTo(a,r):e.lineTo(a,r),i==null)i=new tie(a,r,0,0);else{const{x:l,y:c}=i,h=l+i.width,d=c+i.height;i.x=Math.min(l,a),i.y=Math.min(c,r),i.width=Math.max(h,a)-i.x,i.height=Math.max(d,r)-i.y}}return s&&e.closePath(),i}};g([br({equals:ii})],Sp.prototype,"projectedGeometry",2),g([U()],Sp.prototype,"renderMode",2);function rB(e){const t=vp(e[0],void 0);return t==null?0:Math.abs(t.lat1-t.lat0)*Math.abs(t.lon1-t.lon0)}function _v(e,t){let i,s;for(const n of e){const o=t(n);o!=null&&(i==null||o>i)&&(i=o,s=n)}return s}function Mp(e,t){if(e.bbox!=null){const[i,s,n,o]=e.bbox;return t=Tc.extend(t,i,s,n,o),t}switch(e.type){case"GeometryCollection":for(const i of e.geometries)t=Mp(i,t);break;case"MultiPolygon":for(const i of e.coordinates)i.length>0&&(t=vp(i[0],t));break;case"Polygon":e.coordinates.length>0&&(t=vp(e.coordinates[0],t));break;case"MultiLineString":for(const i of e.coordinates)t=vp(i,t);break;case"LineString":t=vp(e.coordinates,t);break;case"MultiPoint":for(const i of e.coordinates){const[s,n]=i;t=Tc.extend(t,s,n,s,n)}break;case"Point":{const[i,s]=e.coordinates;t=Tc.extend(t,i,s,i,s);break}}return t}function Vv(e){switch(e.type){case"Polygon":return e.coordinates;case"MultiPolygon":return _v(e.coordinates,rB);case"GeometryCollection":{const t=e.geometries.map(Vv).filter(i=>i!=null);return _v(t,rB)}case"MultiLineString":case"LineString":case"MultiPoint":case"Point":return}}function Gv(e){switch(e.type){case"LineString":return e.coordinates;case"MultiLineString":return _v(e.coordinates,UC);case"GeometryCollection":{const t=e.geometries.map(Gv).filter(i=>i!=null);return _v(t,UC)}case"MultiPolygon":case"Polygon":case"MultiPoint":case"Point":return}}function KC(e,t){if(e==null)return!1;switch(e.type){case"GeometryCollection":return e.geometries.some(i=>KC(i,t));case"MultiPolygon":case"Polygon":return(t&1)!==0;case"MultiLineString":case"LineString":return(t&2)!==0;case"MultiPoint":case"Point":return(t&4)!==0}}function jh(e,t){switch(e.type){case"GeometryCollection":return{type:"GeometryCollection",geometries:e.geometries.map(i=>jh(i,t))};case"Polygon":return{type:"Polygon",coordinates:YC(e.coordinates,t)};case"MultiPolygon":return{type:"MultiPolygon",coordinates:iie(e.coordinates,t)};case"MultiLineString":return{type:"MultiLineString",coordinates:YC(e.coordinates,t)};case"LineString":return{type:"LineString",coordinates:ZC(e.coordinates,t)};case"MultiPoint":return{type:"MultiPoint",coordinates:ZC(e.coordinates,t)};case"Point":return{type:"Point",coordinates:t.convert(e.coordinates)}}}function iie(e,t){return e.map(i=>YC(i,t))}function YC(e,t){return e.map(i=>ZC(i,t))}function ZC(e,t){return e.map(i=>t.convert(i))}var rse=class extends L.SeriesProperties{},qf=class extends L.DataModelSeries{constructor(e){super(e),this.cleanup.register(this.ctx.eventsHub.on("data:update",()=>{}),this.ctx.eventsHub.on("legend:item-click",t=>{this.onLegendItemClick(t)}),this.ctx.eventsHub.on("legend:item-double-click",t=>{this.onLegendItemDoubleClick(t)}))}getSeriesDomain(){return{domain:[Number.NaN,Number.NaN]}}getSeriesRange(){return[Number.NaN,Number.NaN]}getHighlightedDatum(){let e=this.ctx.highlightManager?.getActiveHighlight();const{legendItemName:t}=this.properties,i=t!=null&&e?.datum==null&&t===e?.legendItemName;return e!=null&&(e.series!==this&&!i||e.datum==null)&&(e=void 0),e}},{SeriesProperties:sie,makeSeriesTooltip:nie}=L,yc=class extends sie{constructor(){super(...arguments),this.topology=void 0,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.tooltip=nie()}};g([m],yc.prototype,"topology",2),g([m],yc.prototype,"stroke",2),g([m],yc.prototype,"strokeOpacity",2),g([m],yc.prototype,"strokeWidth",2),g([m],yc.prototype,"lineDash",2),g([m],yc.prototype,"lineDashOffset",2),g([m],yc.prototype,"tooltip",2);var{createDatumId:oie,Group:aie,Selection:rie,PointerEvents:lB}=L,XC=class extends qf{constructor(e){super({moduleCtx:e,categoryKey:void 0,pickModes:[]}),this.properties=new yc,this._chartTopology=void 0,this.itemGroup=this.contentGroup.appendChild(new aie({name:"itemGroup"})),this.datumSelection=rie.select(this.itemGroup,()=>this.nodeFactory()),this.itemGroup.pointerEvents=lB.None}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get focusable(){return!1}setOptionsData(){}setChartData(){}get hasData(){return!1}renderToOffscreenCanvas(){return!0}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}setZIndex(e){return super.setZIndex(e),this.contentGroup.zIndex=[0,e,0],this.highlightGroup.zIndex=[0,e,1],!0}nodeFactory(){const e=new Sp;return e.renderMode=2,e.lineJoin="round",e.lineCap="round",e.pointerEvents=lB.None,e}processData(){const{topology:e}=this;this.topologyBounds=e?.features.reduce((t,i)=>{const s=i.geometry;return s==null?t:Mp(s,t)},void 0),e==null&&j.warnOnce("no topology was provided for [MapShapeBackgroundSeries]; nothing will be rendered.")}createNodeData(){const{id:e,topology:t,scale:i,properties:s}=this;if(t==null)return;const{stroke:n,strokeOpacity:o,lineDash:a,lineDashOffset:r,strokeWidth:l}=s,c=[],h=[];for(const[d,u]of t.features.entries()){const{geometry:p}=u,f=p!=null&&i!=null?jh(p,i):void 0;f!=null&&c.push({series:this,itemId:d,datum:u,datumIndex:0,index:d,projectedGeometry:f,style:{stroke:n,strokeOpacity:o,lineDash:a,lineDashOffset:r,strokeWidth:l}})}return{itemId:e,nodeData:c,labelData:h}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){const{datumSelection:e}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.labelGroup.visible=this.visible;const{nodeData:t=[]}=this.contextNodeData??{};this.datumSelection=this.updateDatumSelection({nodeData:t,datumSelection:e}),this.updateDatumNodes({datumSelection:e})}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>oie(t.index))}updateDatumNodes(e){const{datumSelection:t}=e;t.each((i,s)=>{const{projectedGeometry:n}=s;if(n==null){i.visible=!1,i.projectedGeometry=void 0;return}i.visible=!0,i.projectedGeometry=n,i.setProperties(s.style)})}resetAnimation(){}getLegendData(){return[]}getTooltipContent(e){}computeFocusBounds(e){}hasItemStylers(){return!1}};XC.className="MapLineBackgroundSeries",XC.type="map-line-background";var{mapLineBackgroundSeriesThemeableOptionsDef:lie}=L,cie={...lie,type:$(Le("map-line-background")),topology:ml},cB={type:"series",name:"map-line-background",chartType:"topology",enterprise:!0,version:ue,dependencies:[Zf],options:cie,themeTemplate:{...Xf,series:{stroke:{$path:["/1",{$mapPalette:"stroke"},{$mapPalette:"secondHierarchyColors"}]},strokeWidth:1,lineDash:[0],lineDashOffset:0}},create:e=>new XC(e)};function hie(){return{fromFn:(i,s,n)=>n==="removed"?{scalingX:1,scalingY:1}:i.previousDatum==null?{scalingX:0,scalingY:0}:{scalingX:i.scalingX,scalingY:i.scalingY},toFn:(i,s,n)=>n==="removed"?{scalingX:0,scalingY:0}:{scalingX:1,scalingY:1}}}function hB(e,t){const i=e.contextNodeData?.nodeData[t.datumIndex];if(i!==void 0){for(const s of e.datumSelection.nodes())if(s.datum===i)return s}}var{SeriesProperties:die,makeSeriesTooltip:uie,Label:pie}=L,jt=class extends die{constructor(){super(...arguments),this.topology=void 0,this.idKey="",this.topologyIdKey="name",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.maxStrokeWidth=void 0,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.label=new pie,this.tooltip=uie()}getStyle(){const{stroke:e,strokeOpacity:t,strokeWidth:i,lineDash:s,lineDashOffset:n}=this;return{stroke:e,strokeOpacity:t,strokeWidth:i,lineDash:s,lineDashOffset:n,opacity:1}}};g([m],jt.prototype,"topology",2),g([m],jt.prototype,"title",2),g([m],jt.prototype,"legendItemName",2),g([m],jt.prototype,"idKey",2),g([m],jt.prototype,"topologyIdKey",2),g([m],jt.prototype,"idName",2),g([m],jt.prototype,"labelKey",2),g([m],jt.prototype,"labelName",2),g([m],jt.prototype,"sizeKey",2),g([m],jt.prototype,"sizeName",2),g([m],jt.prototype,"colorKey",2),g([m],jt.prototype,"colorName",2),g([m],jt.prototype,"sizeDomain",2),g([m],jt.prototype,"colorRange",2),g([m],jt.prototype,"maxStrokeWidth",2),g([m],jt.prototype,"stroke",2),g([m],jt.prototype,"strokeOpacity",2),g([m],jt.prototype,"strokeWidth",2),g([m],jt.prototype,"lineDash",2),g([m],jt.prototype,"lineDashOffset",2),g([m],jt.prototype,"itemStyler",2),g([m],jt.prototype,"label",2),g([m],jt.prototype,"tooltip",2);var{getMissCount:gie,getLabelStyles:fie,createDatumId:dB,SeriesNodePickMode:uB,valueProperty:Qf,ColorScale:mie,LinearScale:yie,Selection:Hv,Text:pB,Transformable:xie}=L,qC=class extends qf{constructor(e){super({moduleCtx:e,categoryKey:void 0,propertyKeys:{size:["colorKey"],color:["colorKey"],label:["labelKey"]},propertyNames:{size:["sizeName"],color:["colorName"],label:["labelName"]},pickModes:[uB.EXACT_SHAPE_MATCH,uB.NEAREST_NODE],usesPlacedLabels:!0}),this.properties=new jt,this._chartTopology=void 0,this.colorScale=new mie,this.sizeScale=new yie,this.datumSelection=Hv.select(this.contentGroup,()=>this.nodeFactory()),this.labelSelection=Hv.select(this.labelGroup,pB),this.highlightDatumSelection=Hv.select(this.highlightNodeGroup,()=>this.nodeFactory()),this.highlightLabelSelection=Hv.select(this.highlightLabelGroup,pB),this.placedLabelData=[],this._previousDatumMidPoint=void 0}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){return super.hasData&&this.topology!=null}renderToOffscreenCanvas(){return!0}setZIndex(e){return super.setZIndex(e),this.contentGroup.zIndex=[1,e],this.highlightGroup.zIndex=[4,e],!0}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}nodeFactory(){const e=new Sp;return e.renderMode=2,e.lineJoin="round",e.lineCap="round",e}async processData(e){if(this.data==null)return;const{data:t,topology:i,sizeScale:s,colorScale:n}=this,{topologyIdKey:o,idKey:a,sizeKey:r,colorKey:l,labelKey:c,sizeDomain:h,colorRange:d}=this.properties,u=new Map;for(const S of i?.features.values()??[]){const M=S.properties?.[o];M==null||!KC(S.geometry,2)||u.set(M,S)}const p=this.sizeScale.type,f=this.colorScale.type,y=this.scale?.type,{dataModel:b,processedData:x}=await this.requestDataModel(e,t,{props:[Qf(a,y,{id:"idValue",includeProperty:!1}),Qf(a,y,{id:"featureValue",includeProperty:!1,processor:()=>S=>u.get(S)}),...c==null?[]:[Qf(c,"category",{id:"labelValue"})],...r==null?[]:[Qf(r,p,{id:"sizeValue"})],...l==null?[]:[Qf(l,f,{id:"colorValue"})]]}),v=b.resolveColumnById(this,"featureValue",x);if(this.topologyBounds=v.reduce((S,M)=>{const D=M?.geometry;return D==null?S:Mp(D,S)},void 0),r!=null){const S=b.resolveProcessedDataIndexById(this,"sizeValue"),M=x.domain.values[S]??[];s.domain=h??M}if(d!=null&&this.isColorScaleValid()){const S=b.resolveProcessedDataIndexById(this,"colorValue");n.domain=x.domain.values[S],n.range=d,n.update()}i==null&&j.warnOnce("no topology was provided for [MapLineSeries]; nothing will be rendered.")}isColorScaleValid(){const{colorKey:e}=this.properties;if(!e)return!1;const{dataModel:t,processedData:i}=this;if(!t||!i)return!1;const s=t.resolveProcessedDataIndexById(this,"colorValue"),n=i.input.count,o=gie(this,i.defs.values[s].missing);return!(n===0||n===o)}getLabelDatum(e,t,i,s,n,o){if(s==null||n==null||i==null)return;const a=Gv(n);if(a==null)return;const{idKey:r,idName:l,sizeKey:c,sizeName:h,colorKey:d,colorName:u,labelKey:p,labelName:f,label:y}=this.properties;if(p==null||!y.enabled)return;const b=this.getLabelText(s,e,p,"label",[],y,{value:s,datum:e,idKey:r,idName:l,sizeKey:c,sizeName:h,colorKey:d,colorName:u,labelKey:p,labelName:f});if(b==null)return;const x=o.measureLines(String(b)),v=zv(a);if(v==null)return;const[S,M]=v.point,{width:D,height:k}=x;return{point:{x:S,y:M,size:0},label:{width:D,height:k,text:b},anchor:void 0,placement:void 0,datumIndex:t,idValue:i}}resolveColumn(e,t,i){if(!(e==null||this.dataModel==null))return this.dataModel.resolveColumnById(this,t,i)}resolveLineDataColumns(e){const{sizeKey:t,colorKey:i,labelKey:s}=this.properties;return{idValues:this.dataModel.resolveColumnById(this,"idValue",e),featureValues:this.dataModel.resolveColumnById(this,"featureValue",e),labelValues:this.resolveColumn(s,"labelValue",e),sizeValues:this.resolveColumn(t,"sizeValue",e),colorValues:this.resolveColumn(i,"colorValue",e)}}prepareProjectedLineGeometries(e,t,i){const s=new Map;for(const[n]of i.dataSources.get(this.id)?.data.entries()??[]){const o=e[n],a=t[n]?.geometry,r=a!=null&&this.scale!=null?jh(a,this.scale):void 0;o!=null&&r!=null&&s.set(o,r)}return s}warnMissingGeometries(e){if(e.length===0)return;const t=10;if(e.length>t){const i=e.length-t;e.length=t,e.push(`(+${i} more)`)}j.warnOnce("some data items do not have matches in the provided topology",e)}createNodeData(){const{id:e,dataModel:t,processedData:i,sizeScale:s,properties:n}=this,{idKey:o,label:a,legendItemName:r,colorKey:l}=n;if(t==null||i==null)return;const c=this.resolveLineDataColumns(i),h=n.maxStrokeWidth??n.strokeWidth;s.range=[Math.min(n.strokeWidth,h),h];const d=Ze(a),u=this.prepareProjectedLineGeometries(c.idValues,c.featureValues,i),p=[],f=[],y=[],b=i.dataSources.get(this.id)?.data??[];for(const[x,v]of b.entries()){const S={idValue:c.idValues[x],colorValue:c.colorValues?.[x],sizeValue:c.sizeValues?.[x],labelValue:c.labelValues?.[x]},M=u.get(S.idValue);if(M==null&&y.push(S.idValue),l!=null&&S.colorValue==null)continue;const D=this.getLabelDatum(v,x,S.idValue,S.labelValue,M,d);D!=null&&f.push(D),p.push({series:this,itemId:o,datum:v,datumIndex:x,...S,projectedGeometry:M,legendItemName:r,style:this.getItemStyle({datumIndex:x,datum:v,colorValue:S.colorValue,sizeValue:S.sizeValue},!1)})}return this.warnMissingGeometries(y),{itemId:e,nodeData:p,labelData:f}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){const{datumSelection:e,highlightDatumSelection:t}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.labelGroup.visible=this.visible;const i=this.ctx.chartService.highlight?.drawingMode??"overlay",s=this.getHighlightedDatum(),n=this.contextNodeData?.nodeData??[];this.datumSelection=this.updateDatumSelection({nodeData:n,datumSelection:e}),this.updateDatumStyles({datumSelection:e,isHighlight:!1}),this.updateDatumNodes({datumSelection:e,isHighlight:!1,drawingMode:"overlay"}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:s==null?[]:[s],datumSelection:t}),this.updateDatumStyles({datumSelection:t,isHighlight:!0}),this.updateDatumNodes({datumSelection:t,isHighlight:!0,drawingMode:i}),this.updateLabelNodes({labelSelection:this.labelSelection,isHighlight:!1}),this.updateHighlightLabelSelection(s)}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>dB(t.idValue))}getItemStyle({datumIndex:e=0,datum:t,colorValue:i,sizeValue:s},n){const{properties:o,colorScale:a,sizeScale:r}=this,{colorRange:l,itemStyler:c}=o,h=o.getStyle();i!=null&&(h.stroke=this.isColorScaleValid()?a.convert(i):l?.[0]??o.stroke);const d=this.getHighlightStyle(n,e),u=oe(d,h);s!=null&&(u.strokeWidth=r.convert(s,{clamp:!0}));let p;return c!=null&&(p=this.cachedDatumCallback(dB(e,n?"highlight":"node"),()=>{const f=this.makeItemStylerParams(t,e,n,u);return this.callWithContext(c,f)})),p?oe(u,p):u}makeItemStylerParams(e,t,i,s){const{id:n}=this,o=this.ctx.highlightManager?.getActiveHighlight(),a=this.getHighlightStateString(o,i,t);return{seriesId:n,datum:e,highlightState:a,...s}}updateDatumStyles({datumSelection:e,isHighlight:t}){e.each((i,s)=>{s.style=this.getItemStyle(s,t)})}updateDatumNodes({datumSelection:e,drawingMode:t}){e.each((i,s)=>{const{projectedGeometry:n,style:o}=s;if(n==null){i.visible=!1,i.projectedGeometry=void 0;return}i.visible=!0,i.projectedGeometry=n,i.setProperties(o),i.drawingMode=t})}updatePlacedLabelData(e){this.placedLabelData=e,this.labelSelection=this.labelSelection.update(e,t=>{t.pointerEvents=L.PointerEvents.None}),this.updateLabelNodes({labelSelection:this.labelSelection,isHighlight:!1}),this.updateHighlightLabelSelection()}updateLabelNodes({isHighlight:e,labelSelection:t}){const{properties:i}=this,s=this.getHighlightedDatum();t.each((n,o)=>{const{x:a,y:r,width:l,height:c,text:h,datum:d}=o,u=fie(this,void 0,i,i.label,e,s),{color:p,fontStyle:f,fontWeight:y,fontSize:b,fontFamily:x}=u;n.visible=!0,n.x=a+l/2,n.y=r+c/2,n.text=h,n.fill=p,n.fontStyle=f,n.fontWeight=y,n.fontSize=b,n.fontFamily=x,n.textAlign="center",n.textBaseline="middle";const v=d?.datumIndex;n.fillOpacity=this.getHighlightStyle(e,v).opacity??1,n.setBoxing(u)})}updateHighlightLabelSelection(e=this.getHighlightedDatum()){const t=e?.idValue,i=t==null||!this.isLabelEnabled()?[]:this.placedLabelData.filter(s=>s.datum.idValue===t);this.highlightLabelSelection=this.highlightLabelSelection.update(i),i.length===0&&this.highlightLabelSelection.cleanup(),this.updateLabelNodes({labelSelection:this.highlightLabelSelection,isHighlight:!0})}resetAnimation(){}getLabelData(){return this.isLabelEnabled()?this.contextNodeData?.labelData??[]:[]}pickNodeClosestDatum({x:e,y:t}){let i=1/0,s;return this.datumSelection.each((n,o)=>{const a=n.distanceSquared(e,t);a<i&&(i=a,s=o)}),s==null?void 0:{datum:s,distance:Math.sqrt(i)}}datumMidPoint(e){const{_previousDatumMidPoint:t}=this;if(t?.datum===e)return t.point;const i=e.projectedGeometry,s=i==null?void 0:Gv(i),n=s==null?void 0:zv(s)?.point,o=n==null?void 0:{x:n[0],y:n[1]};return this._previousDatumMidPoint={datum:e,point:o},o}legendItemSymbol(e){const{dataModel:t,processedData:i,properties:s}=this,{strokeWidth:n,strokeOpacity:o,lineDash:a}=s;let{stroke:r}=s;if(e!=null&&this.isColorScaleValid()){const c=t.resolveColumnById(this,"colorValue",i)[e];c!=null&&(r=this.colorScale.convert(c))}return{marker:{fill:void 0,fillOpacity:0,stroke:void 0,strokeWidth:0,strokeOpacity:0,lineDash:[0],lineDashOffset:0,enabled:!1},line:{enabled:!0,stroke:r,strokeWidth:n,strokeOpacity:o,lineDash:a}}}getLegendData(e){const{processedData:t,dataModel:i}=this;if(t==null||i==null)return[];const{id:s,visible:n}=this,{title:o,legendItemName:a,idKey:r,idName:l,colorKey:c,colorRange:h,showInLegend:d}=this.properties;if(e==="gradient"&&c!=null&&h!=null){const u=t.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:n,seriesId:s,series:this.getFormatterContext("color"),colorRange:h,colorDomain:u}]}else return e==="category"?[{legendType:"category",id:s,itemId:s,seriesId:s,enabled:n,label:{text:a??o??l??r},symbol:this.legendItemSymbol(),legendItemName:a,hideInLegend:!d}]:[]}getTooltipContent(e){const{id:t,dataModel:i,processedData:s,properties:n,ctx:{formatManager:o}}=this,{idKey:a,idName:r,colorKey:l,colorName:c,sizeKey:h,sizeName:d,labelKey:u,labelName:p,title:f,legendItemName:y,tooltip:b}=n;if(!i||!s)return;const x=s.dataSources.get(this.id)?.data[e],v=i.resolveColumnById(this,"idValue",s),S=h==null?void 0:i.resolveColumnById(this,"sizeValue",s)[e],M=l==null?void 0:i.resolveColumnById(this,"colorValue",s)[e];if(l!=null&&M==null)return;const D=[];if(this.isLabelEnabled()&&u!=null&&u!==a){const I=i.resolveColumnById(this,"labelValue",s)[e],A=o.format(this.callWithContext.bind(this),{type:"category",value:I,datum:x,seriesId:t,legendItemName:y,key:u,source:"tooltip",property:"label",domain:[],boundSeries:this.getFormatterContext("label")});D.push({label:p,fallbackLabel:u,value:A??I})}if(S!=null&&h!=null){const I=i.getDomain(this,"sizeValue","value",s).domain,A=o.format(this.callWithContext.bind(this),{type:"number",value:S,datum:x,seriesId:t,legendItemName:y,key:h,source:"tooltip",property:"size",domain:I,boundSeries:this.getFormatterContext("size"),fractionDigits:void 0});D.push({label:d,fallbackLabel:h,value:A??String(S)})}if(M!=null&&l!=null){const I=i.getDomain(this,"colorValue","value",s).domain,A=o.format(this.callWithContext.bind(this),{type:"number",value:M,datum:x,seriesId:t,legendItemName:y,key:l,source:"tooltip",property:"color",domain:I,boundSeries:this.getFormatterContext("color"),fractionDigits:void 0});D.push({label:c,fallbackLabel:l,value:A??String(M)})}const k=this.getItemStyle({datumIndex:e,datum:x,colorValue:M,sizeValue:S},!1);return this.formatTooltipWithContext(b,{heading:v[e],title:f??y,symbol:this.legendItemSymbol(e),data:D},{seriesId:t,datum:x,title:f,idKey:a,idName:r,colorKey:l,colorName:c,sizeKey:h,sizeName:d,labelKey:u,labelName:p,...k})}computeFocusBounds(e){const t=hB(this,e);return t?xie.toCanvas(this.contentGroup,t.getBBox()):void 0}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.label.itemStyler!=null}};qC.className="MapLineSeries",qC.type="map-line";var{mapLineSeriesThemeableOptionsDef:bie}=L,gB={...Q(et,["highlightStyle","highlight"]),...bie,type:$(Le("map-line")),idKey:$(N),sizeKey:N,colorKey:N,labelKey:N,idName:N,sizeName:N,colorName:N,labelName:N,topology:ml,topologyIdKey:N,legendItemName:N,title:N};gB.colorRange=ee(Ue(be(ie),qa(1)));var fB={type:"series",name:"map-line",chartType:"topology",enterprise:!0,version:ue,dependencies:[Zf],options:gB,themeTemplate:{...Xf,series:{stroke:Wa(L.SAFE_STROKE_FILL_OPERATION),colorRange:{$if:[{$eq:[{$mapPalette:"type"},"inbuilt"]},{$mapPalette:"divergingColors"},Wa(L.SAFE_RANGE2_OPERATION)]},strokeWidth:1,maxStrokeWidth:3,lineDash:[0],lineDashOffset:0,label:{...L.LABEL_BOXING_DEFAULTS,enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},highlight:Wa(L.multiSeriesHighlightStyle())},tooltip:{range:"exact"}},create:e=>new qC(e)};function mB(e,t,i){const s=vp(e[0],void 0);if(s==null)return;const n=(s.lon0+s.lon1)/2,o=(s.lat0+s.lat1)/2,a=Math.abs(s.lon1-s.lon0),r=Math.abs(s.lat1-s.lat0),l=Qte(e[0]),[c,h]=l,d=-Bv(e,c,h);let u;const p=(D,k)=>{const A=Math.max(k-d,0);return D-.5*A},f=(D,k,I)=>{const{distance:A,maxDistance:C}=i(e,D,k,I),w=Math.hypot(c-D,h-k),T=Math.min(Math.max(c,D-I/2),D+I/2),O=Math.min(Math.max(h,k-I/2),k+I/2),E=Math.hypot(c-T,h-O),z=p(A,w),F=p(C,E);return{distance:A,maxDistance:C,value:z,maxValue:F,x:D,y:k,stride:I}},y=(D,k,I,A)=>{const C=f(k,I,A);C.maxDistance>=0&&D.push(C)},b=Math.min(a,r)/2;let x={value:f(n,o,b),next:null};for(;x!=null;){const D=x.value,{distance:k,value:I,maxValue:A,x:C,y:w,stride:T}=D;if(x=x.next,k>0&&(u==null||I>u.value)&&(u=D),u!=null&&A-u.value<=t)continue;const O=T/2,E=[];y(E,C-O,w-O,O),y(E,C+O,w-O,O),y(E,C-O,w+O,O),y(E,C+O,w+O,O),E.sort(yB),x=fy(x,E,yB)}if(u==null)return;const{distance:v,x:S,y:M}=u;return{x:S,y:M,distance:v}}var yB=(e,t)=>t.maxValue-e.maxValue;function QC(e,t){const i=mB(e,t,(o,a,r,l)=>{const c=-Bv(o,a,r),h=c+l*Math.SQRT2;return{distance:c,maxDistance:h}});if(i==null)return;const{x:s,y:n}=i;return[s,n]}function xB(e,t){let i;switch(e.type){case"GeometryCollection":return e.geometries.flatMap(s=>xB(s,t));case"MultiPoint":return e.coordinates;case"Point":return[e.coordinates];case"MultiPolygon":{const s=Vv(e);i=s==null?void 0:QC(s,t);break}case"Polygon":{const s=e.coordinates;i=s==null?void 0:QC(s,t);break}case"MultiLineString":{const s=Gv(e);i=s==null?void 0:zv(s)?.point;break}case"LineString":{const s=e.coordinates;i=zv(s)?.point;break}}return i==null?[]:[i]}var{BBox:vie}=L;function bB(e){if(!e)return;const{range:t}=e,i=t[0][0],s=t[0][1],n=t[1][0]-i,o=t[1][1]-s,a=new vie(i,s,n,o);return{series:a,axis:a}}var{SeriesProperties:Sie,makeSeriesTooltip:Mie,Label:Die}=L,vB=class extends Die{constructor(){super(...arguments),this.placement="bottom"}};g([m],vB.prototype,"placement",2);var ut=class extends Sie{constructor(){super(...arguments),this.topology=void 0,this.idKey=void 0,this.topologyIdKey="name",this.idName=void 0,this.latitudeKey=void 0,this.latitudeName=void 0,this.longitudeKey=void 0,this.longitudeName=void 0,this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.shape="circle",this.size=6,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.label=new vB,this.tooltip=Mie()}getStyle(){const{size:e,shape:t,fill:i,fillOpacity:s,stroke:n,strokeWidth:o,strokeOpacity:a,lineDash:r,lineDashOffset:l}=this;return{size:e,shape:t,fill:i,fillOpacity:s,opacity:1,stroke:n,strokeWidth:o,strokeOpacity:a,lineDash:r,lineDashOffset:l}}};g([m],ut.prototype,"topology",2),g([m],ut.prototype,"title",2),g([m],ut.prototype,"legendItemName",2),g([m],ut.prototype,"idKey",2),g([m],ut.prototype,"topologyIdKey",2),g([m],ut.prototype,"idName",2),g([m],ut.prototype,"latitudeKey",2),g([m],ut.prototype,"latitudeName",2),g([m],ut.prototype,"longitudeKey",2),g([m],ut.prototype,"longitudeName",2),g([m],ut.prototype,"labelKey",2),g([m],ut.prototype,"labelName",2),g([m],ut.prototype,"sizeKey",2),g([m],ut.prototype,"sizeName",2),g([m],ut.prototype,"colorKey",2),g([m],ut.prototype,"colorName",2),g([m],ut.prototype,"colorRange",2),g([m],ut.prototype,"shape",2),g([m],ut.prototype,"size",2),g([m],ut.prototype,"maxSize",2),g([m],ut.prototype,"sizeDomain",2),g([m],ut.prototype,"fill",2),g([m],ut.prototype,"fillOpacity",2),g([m],ut.prototype,"stroke",2),g([m],ut.prototype,"strokeWidth",2),g([m],ut.prototype,"strokeOpacity",2),g([m],ut.prototype,"lineDash",2),g([m],ut.prototype,"lineDashOffset",2),g([m],ut.prototype,"itemStyler",2),g([m],ut.prototype,"label",2),g([m],ut.prototype,"tooltip",2);var{fromToMotion:Iie,getMissCount:kie,createDatumId:jv,SeriesNodePickMode:SB,valueProperty:Wh,computeMarkerFocusBounds:Aie,ColorScale:Cie,LinearScale:Lie,Group:wie,Selection:Wv,Text:MB,Marker:JC,getLabelStyles:Tie}=L,eL=class extends qf{constructor(e){super({moduleCtx:e,categoryKey:void 0,propertyKeys:{size:["colorKey"],color:["colorKey"],label:["labelKey"]},propertyNames:{size:["sizeName"],color:["colorName"],label:["labelName"]},pickModes:[SB.EXACT_SHAPE_MATCH,SB.NEAREST_NODE],usesPlacedLabels:!0}),this.properties=new ut,this._chartTopology=void 0,this.colorScale=new Cie,this.sizeScale=new Lie,this.markerGroup=this.contentGroup.appendChild(new wie({name:"markerGroup"})),this.labelSelection=Wv.select(this.labelGroup,MB,!1),this.highlightLabelSelection=Wv.select(this.highlightLabelGroup,MB,!1),this.markerSelection=Wv.select(this.markerGroup,JC,!1),this.highlightMarkerSelection=Wv.select(this.highlightNodeGroup,JC),this.placedLabelData=[],this.animationState=new he("empty",{empty:{update:{target:"ready",action:()=>this.animateMarkers()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.resetAllAnimation(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateMarkers()},resize:{target:"ready",action:()=>this.resetAllAnimation()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:()=>this.resetAllAnimation()},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){const e=this.properties.latitudeKey!=null&&this.properties.longitudeKey!=null;return super.hasData&&(this.topology!=null||e)}renderToOffscreenCanvas(){return!0}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}setZIndex(e){return super.setZIndex(e),this.contentGroup.zIndex=[2,e],this.highlightGroup.zIndex=[3,e],!0}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}async processData(e){if(this.data==null)return;const{data:t,sizeScale:i,colorScale:s}=this,{topologyIdKey:n,idKey:o,latitudeKey:a,longitudeKey:r,sizeKey:l,colorKey:c,labelKey:h,sizeDomain:d,colorRange:u}=this.properties,p=this.buildFeatureMap(n),f=this.sizeScale.type,y=this.colorScale.type,b=this.scale?.type,x=a!=null&&r!=null,{dataModel:v,processedData:S}=await this.requestDataModel(e,t,{props:[...o==null?[]:[Wh(o,b,{id:"idValue",includeProperty:!1}),Wh(o,b,{id:"featureValue",includeProperty:!1,processor:()=>I=>p.get(I)})],...x?[Wh(a,b,{id:"latValue"}),Wh(r,b,{id:"lonValue"})]:[],...h?[Wh(h,"category",{id:"labelValue"})]:[],...l?[Wh(l,f,{id:"sizeValue"})]:[],...c?[Wh(c,y,{id:"colorValue"})]:[]]}),M=o==null?void 0:v.resolveColumnById(this,"featureValue",S),D=x?v.resolveColumnById(this,"latValue",S):void 0,k=x?v.resolveColumnById(this,"lonValue",S):void 0;if(this.topologyBounds=S.dataSources.get(this.id)?.data.reduce((I,A,C)=>{const T=M?.[C]?.geometry;if(T!=null&&(I=Mp(T,I)),D!=null&&k!=null){const O=k[C],E=D[C];I=Tc.extend(I,O,E,O,E)}return I},void 0),l!=null){const I=v.resolveProcessedDataIndexById(this,"sizeValue"),A=S.domain.values[I]??[];i.domain=d??A}if(u!=null&&this.isColorScaleValid()){const I=v.resolveProcessedDataIndexById(this,"colorValue");s.domain=S.domain.values[I],s.range=u,s.update()}this.animationState.transition("updateData")}isColorScaleValid(){const{colorKey:e}=this.properties;if(!e)return!1;const{dataModel:t,processedData:i}=this;if(!t||!i)return!1;const s=t.resolveProcessedDataIndexById(this,"colorValue"),n=i.input.count,o=kie(this,i.defs.values[s].missing);return!(n===0||n===o)}getLabelDatum(e,t,i){if(t==null)return;const{idKey:s,idName:n,latitudeKey:o,latitudeName:a,longitudeKey:r,longitudeName:l,sizeKey:c,sizeName:h,colorKey:d,colorName:u,labelKey:p,labelName:f,label:y,shape:b}=this.properties;if(p==null||!y.enabled)return;const{datum:x,datumIndex:v,index:S,idValue:M,lonValue:D,latValue:k,point:I}=e,{placement:A}=y,C=this.getLabelText(t,x,p,"label",[],y,{value:t,datum:x,idKey:s,idName:n,latitudeKey:o,latitudeName:a,longitudeKey:r,longitudeName:l,sizeKey:c,sizeName:h,colorKey:d,colorName:u,labelKey:p,labelName:f});if(C==null)return;const{width:w,height:T}=i.measureLines(String(C)),O=JC.anchor(b);return{point:{x:I.x,y:I.y,size:I.size},label:{width:w,height:T,text:C},anchor:O,placement:A,datumIndex:v,datumId:jv(S,M,D,k)}}resolveColumn(e,t,i){if(!(e==null||this.dataModel==null))return this.dataModel.resolveColumnById(this,t,i)}resolveDataColumns(e){const{idKey:t,latitudeKey:i,longitudeKey:s,sizeKey:n,colorKey:o,labelKey:a}=this.properties,r=i!=null&&s!=null;return{idValues:this.resolveColumn(t,"idValue",e),featureValues:this.resolveColumn(t,"featureValue",e),latValues:r?this.resolveColumn(i,"latValue",e):void 0,lonValues:r?this.resolveColumn(s,"lonValue",e):void 0,labelValues:this.resolveColumn(a,"labelValue",e),sizeValues:this.resolveColumn(n,"sizeValue",e),colorValues:this.resolveColumn(o,"colorValue",e)}}prepareProjectedGeometries(e,t,i){if(e==null||t==null||this.scale==null)return;const s=new Map;for(const[n]of i.dataSources.get(this.id)?.data.entries()??[]){const o=e[n],a=t[n]?.geometry,r=a==null?void 0:jh(a,this.scale);o!=null&&r!=null&&s.set(o,r)}return s}calculateMarkerSize(e){return e==null?this.properties.size:this.sizeScale.convert(e,{clamp:!0})}buildNodeDatum(e,t,i,s,n){return{series:this,itemId:this.properties.latitudeKey,datum:e,datumIndex:t,index:i,...n,point:s,midPoint:{x:s.x,y:s.y},legendItemName:this.properties.legendItemName,style:this.getMarkerItemStyle({datumIndex:t,datum:e,colorValue:n.colorValue,sizeValue:n.sizeValue},!1)}}createNodeFromLatLon(e,t,i,s,n,o,a){if(this.scale==null)throw new Error("Scale is required for createNodeFromLatLon");const[r,l]=this.scale.convert([i,s]),c={x:r,y:l,size:o},h=this.buildNodeDatum(e,t,-1,c,n),d=this.getLabelDatum(h,n.labelValue,a)??void 0;return{node:h,label:d}}createNodesFromGeometry(e,t,i,s,n,o){const a=[],r=[];for(const[l,[c,h]]of xB(i,1).entries()){const d={x:c,y:h,size:n},u=this.buildNodeDatum(e,t,l,d,s);a.push(u);const p=this.getLabelDatum(u,s.labelValue,o);p&&r.push(p)}return{nodes:a,labels:r}}warnMissingGeometries(e){if(e.length===0)return;const t=10;if(e.length>t){const i=e.length-t;e.length=t,e.push(`(+${i} more)`)}j.warnOnce("some data items do not have matches in the provided topology",e)}buildFeatureMap(e){const t=new Map;for(const i of this.topology?.features.values()??[]){const s=i.properties?.[e];s!=null&&t.set(s,i)}return t}createNodeData(){const{id:e,dataModel:t,processedData:i,sizeScale:s,properties:n,scale:o}=this,{label:a}=n;if(t==null||i==null||o==null)return;const r=this.resolveDataColumns(i),l=n.maxSize??n.size;s.range=[Math.min(n.size,l),l];const c=Ze(a),h=this.prepareProjectedGeometries(r.idValues,r.featureValues,i),d=[],u=[],p=[],f=i.dataSources.get(this.id)?.data??[];for(const[y,b]of f.entries()){const x={idValue:r.idValues?.[y],lonValue:r.lonValues?.[y],latValue:r.latValues?.[y],colorValue:r.colorValues?.[y],sizeValue:r.sizeValues?.[y],labelValue:r.labelValues?.[y]},v=this.calculateMarkerSize(x.sizeValue),S=x.idValue==null?void 0:h?.get(x.idValue);if(x.idValue!=null&&h!=null&&S==null&&p.push(x.idValue),x.lonValue!=null&&x.latValue!=null){const M=this.createNodeFromLatLon(b,y,x.lonValue,x.latValue,x,v,c);d.push(M.node),M.label&&u.push(M.label)}else if(S!=null){const M=this.createNodesFromGeometry(b,y,S,x,v,c);d.push(...M.nodes),u.push(...M.labels)}}return this.warnMissingGeometries(p),{itemId:e,nodeData:d,labelData:u}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}checkScaleChange(){return this.previousScale===this.scale?!1:(this.previousScale=this.scale,!0)}update({seriesRect:e}){const t=this.checkResize(e),i=this.checkScaleChange(),{markerSelection:s,highlightMarkerSelection:n}=this,o=this.ctx.chartService.highlight?.drawingMode??"overlay";this.updateSelections(),this.contentGroup.visible=this.visible,this.labelGroup.visible=this.visible;const a=this.getHighlightedDatum(),r=this.contextNodeData?.nodeData??[];this.markerSelection=this.updateMarkerSelection({markerData:r,markerSelection:s}),this.updateMarkerNodes({markerSelection:s,isHighlight:!1,highlightedDatum:a,drawingMode:"overlay"}),this.highlightMarkerSelection=this.updateMarkerSelection({markerData:a==null?[]:[a],markerSelection:n}),this.updateMarkerNodes({markerSelection:n,isHighlight:!0,highlightedDatum:a,drawingMode:o}),this.updateLabelNodes({labelSelection:this.labelSelection,isHighlight:!1}),this.updateHighlightLabelSelection(a),(i||t)&&this.animationState.transition("resize"),this.animationState.transition("update")}updatePlacedLabelData(e){this.placedLabelData=e,this.labelSelection=this.labelSelection.update(e,t=>{t.pointerEvents=L.PointerEvents.None}),this.updateLabelNodes({labelSelection:this.labelSelection,isHighlight:!1}),this.updateHighlightLabelSelection()}updateLabelNodes({isHighlight:e,labelSelection:t}){const{properties:i}=this,s=this.ctx.highlightManager?.getActiveHighlight();t.each((n,o)=>{const{x:a,y:r,width:l,height:c,text:h,datum:d}=o,u=Tie(this,void 0,i,i.label,e,s),{color:p,fontStyle:f,fontWeight:y,fontSize:b,fontFamily:x}=u;n.visible=!0,n.x=a+l/2,n.y=r+c/2,n.text=h,n.fill=p,n.fontStyle=f,n.fontWeight=y,n.fontSize=b,n.fontFamily=x,n.textAlign="center",n.textBaseline="middle";const v=d?.datumIndex;n.fillOpacity=this.getHighlightStyle(e,v).opacity??1,n.setBoxing(u)})}getHighlightedLabelId(e=this.getHighlightedDatum()){if(e!=null)return jv(e.index,e.idValue,e.lonValue,e.latValue)}updateHighlightLabelSelection(e=this.getHighlightedDatum()){const t=this.getHighlightedLabelId(e),i=t==null||!this.isLabelEnabled()?[]:this.placedLabelData.filter(s=>s.datum.datumId===t);if(this.highlightLabelSelection=this.highlightLabelSelection.update(i),i.length===0){this.highlightLabelSelection.cleanup(),this.highlightLabelGroup.visible=!1;return}this.highlightLabelGroup.visible=!0,this.updateLabelNodes({labelSelection:this.highlightLabelSelection,isHighlight:!0})}updateMarkerSelection(e){const{markerData:t,markerSelection:i}=e;return i.update(t,void 0,s=>jv(s.index,s.idValue,s.lonValue,s.latValue))}getMarkerItemStyle({datumIndex:e,datum:t,colorValue:i,sizeValue:s},n){const{properties:o,colorScale:a,sizeScale:r}=this,{colorRange:l,itemStyler:c}=o,h=this.getHighlightStyle(n,e),d=oe(h,o.getStyle());!n&&i!=null&&(d.fill=this.isColorScaleValid()?a.convert(i):l?.[0]??d.fill),s!=null&&(d.size=r.convert(s,{clamp:!0}));let u=d;if(c!=null&&e!=null){const p=this.cachedDatumCallback(jv(e,n?"highlight":"node"),()=>{const f=this.makeItemStylerParams(t,e,n,u);return this.callWithContext(c,f)});p&&(u=oe(p,d))}return u}makeItemStylerParams(e,t,i,s){const{id:n}=this,o=this.ctx.highlightManager?.getActiveHighlight(),a=this.getHighlightStateString(o,i,t),r=this.filterItemStylerFillParams(s.fill)??s.fill;return{seriesId:n,datum:e,highlightState:a,...s,fill:r}}updateMarkerNodes(e){const{markerSelection:t,isHighlight:i,highlightedDatum:s,drawingMode:n}=e,o=bB(this.scale);t.each((a,r)=>{const{datum:l,point:c}=r,h=this.getMarkerItemStyle(r,i);a.shape=h.shape,a.size=h.size,a.setStyleProperties(h,o),a.x=c.x,a.y=c.y,a.scalingCenterX=c.x,a.scalingCenterY=c.y,a.zIndex=!i&&s!=null&&l===s.datum?1:0,a.drawingMode=n})}isProcessedDataAnimatable(){return!0}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"&&this.animationState.transition("skip")}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),this.ctx.animationManager.skipCurrentBatch(),this.labelSelection.cleanup(),this.markerSelection.cleanup(),this.highlightMarkerSelection.cleanup(),this.highlightLabelSelection.cleanup(),this.highlightLabelGroup.visible=!1,this.placedLabelData=[]}animateMarkers(){const{animationManager:e}=this.ctx,t=hie();Iie(this.id,"markers",e,[this.markerSelection,this.highlightMarkerSelection],t)}getLabelData(){return this.isLabelEnabled()?this.contextNodeData?.labelData??[]:[]}pickNodeClosestDatum(e){const{x:t,y:i}=e;let s=1/0,n;for(const o of this.contextNodeData?.nodeData??[]){const{x:a,y:r,size:l}=o.point,c=Math.max(Math.abs(a-t)-l,0),h=Math.max(Math.abs(r-i)-l,0),d=c*c+h*h;d<s&&(s=d,n=o)}return n==null?void 0:{datum:n,distance:Math.sqrt(s)}}legendItemSymbol(e){const{dataModel:t,processedData:i,properties:s}=this,{shape:n,fillOpacity:o,stroke:a,strokeWidth:r,strokeOpacity:l,lineDash:c,lineDashOffset:h}=s;let{fill:d}=s;if(e!=null&&this.isColorScaleValid()){const p=t.resolveColumnById(this,"colorValue",i)[e];d=this.colorScale.convert(p)}return{marker:{shape:n,fill:d,fillOpacity:o,stroke:a,strokeWidth:r,strokeOpacity:l,lineDash:c,lineDashOffset:h}}}getLegendData(e){const{processedData:t,dataModel:i}=this;if(t==null||i==null)return[];const{id:s,visible:n}=this,{title:o,legendItemName:a,idName:r,idKey:l,colorKey:c,colorRange:h,showInLegend:d}=this.properties;if(e==="gradient"&&c!=null&&h!=null){const u=t.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:n,seriesId:s,series:this.getFormatterContext("color"),colorRange:h,colorDomain:u}]}else return e==="category"?[{legendType:"category",id:s,itemId:s,seriesId:s,enabled:n,label:{text:a??o??r??l??s},symbol:this.legendItemSymbol(),legendItemName:a,hideInLegend:!d}]:[]}getTooltipContent(e){const{id:t,dataModel:i,processedData:s,properties:n,ctx:{formatManager:o}}=this,{idKey:a,idName:r,latitudeKey:l,latitudeName:c,longitudeKey:h,longitudeName:d,colorKey:u,colorName:p,sizeKey:f,sizeName:y,labelKey:b,labelName:x,title:v,legendItemName:S,tooltip:M}=n;if(!i||!s)return;const D=s.dataSources.get(this.id)?.data[e],k=f==null?void 0:i.resolveColumnById(this,"sizeValue",s)[e],I=u==null?void 0:i.resolveColumnById(this,"colorValue",s)[e],A=[];if(this.isLabelEnabled()&&b!=null&&b!==a){const T=i.resolveColumnById(this,"labelValue",s)[e],O=o.format(this.callWithContext.bind(this),{type:"category",value:T,datum:D,seriesId:t,legendItemName:S,key:b,source:"tooltip",property:"label",domain:[],boundSeries:this.getFormatterContext("label")});A.push({label:x,fallbackLabel:b,value:O??T})}if(f!=null&&k!=null){const T=i.getDomain(this,"sizeValue","value",s).domain,O=o.format(this.callWithContext.bind(this),{type:"number",value:k,datum:D,seriesId:t,legendItemName:S,key:f,source:"tooltip",property:"size",domain:T,boundSeries:this.getFormatterContext("size"),fractionDigits:void 0});A.push({label:y,fallbackLabel:f,value:O??String(k)})}if(u!=null&&I!=null){const T=i.getDomain(this,"colorValue","value",s).domain,O=o.format(this.callWithContext.bind(this),{type:"number",value:I,datum:D,seriesId:t,legendItemName:S,key:u,source:"tooltip",property:"color",domain:T,boundSeries:this.getFormatterContext("color"),fractionDigits:void 0});A.push({label:p,fallbackLabel:u,value:O??String(I)})}let C;if(a!=null)C=i.resolveColumnById(this,"idValue",s)[e];else if(l!=null&&h!=null){const T=i.resolveColumnById(this,"latValue",s)[e],O=i.resolveColumnById(this,"lonValue",s)[e];C=`${Math.abs(T).toFixed(4)}\xB0 ${T>=0?"N":"S"}, ${Math.abs(O).toFixed(4)}\xB0 ${O>=0?"W":"E"}`}const w=this.getMarkerItemStyle({datumIndex:e,datum:D,colorValue:I,sizeValue:k},!1);return this.formatTooltipWithContext(M,{heading:C,title:v??S,symbol:this.legendItemSymbol(e),data:A},{seriesId:t,datum:D,title:v,idKey:a,idName:r,latitudeKey:l,latitudeName:c,longitudeKey:h,longitudeName:d,colorKey:u,colorName:p,sizeKey:f,sizeName:y,labelKey:b,labelName:x,...w})}getFormattedMarkerStyle(e){const t=this.getMarkerItemStyle(e,!1);return{size:t.size,shape:t.shape}}computeFocusBounds(e){return Aie(this,e)}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.label.itemStyler!=null}};eL.className="MapMarkerSeries",eL.type="map-marker";var{mapMarkerSeriesThemeableOptionsDef:Nie}=L,Oie={...Q(et,["highlightStyle","highlight"]),...Nie,type:$(Le("map-marker")),idKey:N,latitudeKey:N,longitudeKey:N,sizeKey:N,colorKey:N,labelKey:N,idName:N,latitudeName:N,longitudeName:N,sizeName:N,colorName:N,labelName:N,topology:ml,topologyIdKey:N,legendItemName:N,title:N},DB={type:"series",name:"map-marker",chartType:"topology",enterprise:!0,version:ue,dependencies:[Zf],options:Oie,themeTemplate:{...Xf,series:{shape:"circle",maxSize:30,fill:Wa({$applySwitch:[{$path:"type"},{$mapPalette:"fill"},["gradient",L.FILL_GRADIENT_RADIAL_REVERSED_DEFAULTS],["image",L.FILL_IMAGE_DEFAULTS],["pattern",L.FILL_PATTERN_DEFAULTS]]}),stroke:{$mapPalette:"stroke"},colorRange:{$if:[{$eq:[{$mapPalette:"type"},"inbuilt"]},{$mapPalette:"divergingColors"},Wa(L.SAFE_RANGE2_OPERATION)]},fillOpacity:.5,label:{...L.LABEL_BOXING_DEFAULTS,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},highlight:Wa(L.multiSeriesHighlightStyle())},tooltip:{range:"exact"}},create:e=>new eL(e),validate(e,t,i){const s=Ei(e,t,i),{cleared:n,invalid:o}=s;if(n?.idKey==null&&(n?.latitudeKey==null||n?.longitudeKey==null)){const a=l=>i?`${i}.${l}`:l,r=`Either \`${a("idKey")}\` or both \`${a("latitudeKey")}\` and \`${a("longitudeKey")}\` are required.`;o.push(new la("required",r,null,i))}return s}},{SeriesProperties:Eie,makeSeriesTooltip:Pie}=L,$a=class extends Eie{constructor(){super(...arguments),this.topology=void 0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.tooltip=Pie()}};g([m],$a.prototype,"topology",2),g([m],$a.prototype,"fill",2),g([m],$a.prototype,"fillOpacity",2),g([m],$a.prototype,"stroke",2),g([m],$a.prototype,"strokeOpacity",2),g([m],$a.prototype,"strokeWidth",2),g([m],$a.prototype,"lineDash",2),g([m],$a.prototype,"lineDashOffset",2),g([m],$a.prototype,"tooltip",2);var{createDatumId:Rie,Selection:Fie,Group:zie,PointerEvents:IB}=L,tL=class extends qf{constructor(e){super({moduleCtx:e,categoryKey:void 0,pickModes:[]}),this.properties=new $a,this._chartTopology=void 0,this.itemGroup=this.contentGroup.appendChild(new zie({name:"itemGroup"})),this.datumSelection=Fie.select(this.itemGroup,()=>this.nodeFactory()),this.itemGroup.pointerEvents=IB.None}get topology(){return this.properties.topology??this._chartTopology}get focusable(){return!1}setOptionsData(){}setChartData(){}getNodeData(){}get hasData(){return!1}renderToOffscreenCanvas(){return!0}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}setZIndex(e){return super.setZIndex(e),this.contentGroup.zIndex=[0,e,0],this.highlightGroup.zIndex=[0,e,1],!0}nodeFactory(){const e=new Sp;return e.renderMode=1,e.lineJoin="round",e.pointerEvents=IB.None,e}processData(){const{topology:e}=this;this.topologyBounds=e?.features.reduce((t,i)=>{const s=i.geometry;return s==null?t:Mp(s,t)},void 0),e==null&&j.warnOnce("no topology was provided for [MapShapeBackgroundSeries]; nothing will be rendered.")}createNodeData(){const{id:e,topology:t,scale:i,properties:s}=this;if(t==null)return;const{fill:n,fillOpacity:o,stroke:a,strokeWidth:r,strokeOpacity:l,lineDash:c,lineDashOffset:h}=s,d=[],u=[];for(const[p,f]of t.features.entries()){const{geometry:y}=f,b=y!=null&&i!=null?jh(y,i):void 0;b!=null&&d.push({series:this,itemId:p,datum:f,datumIndex:0,index:p,projectedGeometry:b,style:{fill:n,fillOpacity:o,stroke:a,strokeWidth:r,strokeOpacity:l,lineDash:c,lineDashOffset:h}})}return{itemId:e,nodeData:d,labelData:u}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){const{datumSelection:e}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.labelGroup.visible=this.visible;const{nodeData:t=[]}=this.contextNodeData??{};this.datumSelection=this.updateDatumSelection({nodeData:t,datumSelection:e}),this.updateDatumNodes({datumSelection:e})}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>Rie(t.index))}updateDatumNodes(e){const{datumSelection:t}=e;t.each((i,s)=>{const{projectedGeometry:n}=s;if(n==null){i.visible=!1,i.projectedGeometry=void 0;return}i.visible=!0,i.projectedGeometry=n,i.setProperties(s.style)})}resetAnimation(){}getLegendData(){return[]}getTooltipContent(e){}pickFocus(){}computeFocusBounds(e){}hasItemStylers(){return!1}};tL.className="MapShapeBackgroundSeries",tL.type="map-shape-background";var{mapShapeBackgroundSeriesThemeableOptionsDef:Bie}=L,_ie={...Bie,...et,type:$(Le("map-shape-background")),topology:ml},kB={type:"series",name:"map-shape-background",chartType:"topology",enterprise:!0,version:ue,dependencies:[Zf],options:_ie,themeTemplate:{...Xf,series:{fill:Wa({$applySwitch:[{$path:"type"},{$path:["/1",{$mapPalette:"fill"},{$mapPalette:"hierarchyColors"}]},["gradient",L.FILL_GRADIENT_LINEAR_HIERARCHY_DEFAULTS],["image",L.FILL_IMAGE_DEFAULTS],["pattern",L.FILL_PATTERN_HIERARCHY_DEFAULTS]]}),stroke:{$ref:"chartBackgroundColor"},strokeWidth:1}},create:e=>new tL(e)};function Vie(e,{aspectRatio:t,precision:i}){const s=mB(e,i,(l,c,h,d)=>{const u=Hie(l,c,h,t),p=u+2*d*t,f=u*Math.SQRT2,y=p*Math.SQRT2;return{distance:f,maxDistance:y}});if(s==null)return;const{x:n,y:o,distance:a}=s,r=a/Math.SQRT2;return{x:n,y:o,maxWidth:r}}function Gie(e,t,i,s,n){const[o,a]=e,[r,l]=t,c=1/n,h=r-o,d=l-a,[u,p]=a<=l?e:t,[f,y]=o<=r?e:t,[b,x]=a<=l?t:e,[v,S]=o<=r?t:e;let M=1/0;if(h===0)for(let w=0;w<=1;w+=1){const O=(w===0?c:-c)*(o-i)+s;if(O>=p&&O<=x){const z=Math.abs(s-O)*2*n;M=Math.min(M,z)}}else{const w=d/h;for(let T=0;T<=1;T+=1){const O=T===0?c:-c,E=(w*o-a-O*i+s)/(w-O);if(E>=f&&E<=v){const z=Math.abs(i-E)*2;M=Math.min(M,z)}}}const D=n,k=Math.abs((u-i)/(p-s)),I=Math.abs((b-i)/(x-s));if(x<s&&I<D){const T=Math.abs(s-x)*2*n;M=Math.min(M,T)}else if(p>s&&k<D){const T=Math.abs(s-p)*2*n;M=Math.min(M,T)}const A=Math.abs((y-s)/(f-i)),C=Math.abs((S-s)/(v-i));if(v<i&&C<c){const w=Math.abs(i-v)*2;M=Math.min(M,w)}else if(f>i&&A<c){const w=Math.abs(i-f)*2;M=Math.min(M,w)}return M}function Hie(e,t,i,s){let n=!1,o=1/0;for(const a of e){let r=a.at(-1),[l,c]=r;for(const h of a){const[d,u]=h;u>i!=c>i&&t<(l-d)*(i-u)/(c-u)+d&&(n=!n);const p=Gie(r,h,t,i,s);o=Math.min(o,p),r=h,l=d,c=u}}return(n?1:-1)*o}function $v(e,t,i){i>=t&&(e.maxX=Math.min(e.maxX,i-t)),i<=t&&(e.minX=Math.max(e.minX,i-t))}function jie(e,t,i,s,n,o){const a=n-o/2,r=n+o/2,[l,c]=t,[h,d]=i,u=h-l,p=d-c,[f,y]=l<=h?t:i,[b,x]=l<=h?i:t;if(u!==0){const v=p/u;for(let S=0;S<=1;S+=1){const D=((S===0?a:r)-c)/v+l;D>=f&&D<=b&&$v(e,s,D)}}else Math.max(a,Math.min(c,d))<=Math.min(r,Math.max(c,d))&&$v(e,s,l);return b<s&&x>=a&&x<=r?$v(e,s,b):f>s&&y>=a&&y<=r&&$v(e,s,f),e}function Wie(e,t,i,s){const n={minX:-1/0,maxX:1/0};for(const r of e){let l=r.at(-1);for(const c of r)jie(n,l,c,t,i,s),l=c}const{minX:o,maxX:a}=n;return Number.isFinite(o)&&Number.isFinite(a)?{x:t+(o+a)/2,width:a-o}:{x:t,width:0}}var{SeriesProperties:$ie,makeSeriesTooltip:Uie}=L,ti=class extends $ie{constructor(){super(...arguments),this.topology=void 0,this.idKey="",this.idName=void 0,this.topologyIdKey="name",this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.padding=0,this.label=new vb,this.tooltip=Uie()}getStyle(){const{fill:e,fillOpacity:t,stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:o,lineDashOffset:a}=this;return{fill:e,fillOpacity:t,stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:o,lineDashOffset:a,opacity:1}}};g([m],ti.prototype,"topology",2),g([m],ti.prototype,"title",2),g([m],ti.prototype,"legendItemName",2),g([m],ti.prototype,"idKey",2),g([m],ti.prototype,"idName",2),g([m],ti.prototype,"topologyIdKey",2),g([m],ti.prototype,"labelKey",2),g([m],ti.prototype,"labelName",2),g([m],ti.prototype,"colorKey",2),g([m],ti.prototype,"colorName",2),g([m],ti.prototype,"colorRange",2),g([m],ti.prototype,"fill",2),g([m],ti.prototype,"fillOpacity",2),g([m],ti.prototype,"stroke",2),g([m],ti.prototype,"strokeOpacity",2),g([m],ti.prototype,"strokeWidth",2),g([m],ti.prototype,"lineDash",2),g([m],ti.prototype,"lineDashOffset",2),g([m],ti.prototype,"padding",2),g([m],ti.prototype,"itemStyler",2),g([m],ti.prototype,"label",2),g([m],ti.prototype,"tooltip",2);var{getMissCount:Kie,createDatumId:Uv,SeriesNodePickMode:AB,valueProperty:Kv,ColorScale:Yie,Group:CB,Selection:Yv,Text:LB,PointerEvents:Zie,getLabelStyles:Xie}=L,wB=L.MercatorScale.fixedScale(),iL=class extends qf{constructor(e){super({moduleCtx:e,categoryKey:void 0,propertyKeys:{color:["colorKey"],label:["labelKey"]},propertyNames:{color:["colorName"],label:["labelName"]},pickModes:[AB.EXACT_SHAPE_MATCH,AB.NEAREST_NODE]}),this.properties=new ti,this._chartTopology=void 0,this.colorScale=new Yie,this.itemGroup=this.contentGroup.appendChild(new CB({name:"itemGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new CB({name:"itemLabelGroup"})),this.datumSelection=Yv.select(this.itemGroup,()=>this.nodeFactory()),this.labelSelection=Yv.select(this.itemLabelGroup,LB),this.highlightDatumSelection=Yv.select(this.highlightNodeGroup,()=>this.nodeFactory()),this.highlightLabelSelection=Yv.select(this.highlightLabelGroup,LB),this.previousLabelLayouts=void 0,this._previousDatumMidPoint=void 0,this.itemLabelGroup.pointerEvents=Zie.None}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){return super.hasData&&this.topology!=null}renderToOffscreenCanvas(){return!0}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}setZIndex(e){return super.setZIndex(e),this.contentGroup.zIndex=[1,e],this.highlightGroup.zIndex=[4,e],!0}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}nodeFactory(){const e=new Sp;return e.renderMode=1,e.lineJoin="round",e}async processData(e){if(this.data==null)return;const{data:t,topology:i,colorScale:s}=this,{topologyIdKey:n,idKey:o,colorKey:a,labelKey:r,colorRange:l}=this.properties,c=new Map;for(const y of i?.features.values()??[]){const b=y.properties?.[n];b==null||!KC(y.geometry,1)||c.set(b,y)}const h=this.colorScale.type,d=this.scale?.type,{dataModel:u,processedData:p}=await this.requestDataModel(e,t,{props:[Kv(o,d,{id:"idValue",includeProperty:!1}),Kv(o,d,{id:"featureValue",includeProperty:!1,processor:()=>y=>c.get(y)}),...r?[Kv(r,"category",{id:"labelValue"})]:[],...a?[Kv(a,h,{id:"colorValue"})]:[]]}),f=u.resolveColumnById(this,"featureValue",p);if(this.topologyBounds=f.reduce((y,b)=>{const x=b?.geometry;return x==null?y:Mp(x,y)},void 0),l!=null&&this.isColorScaleValid()){const y=u.resolveProcessedDataIndexById(this,"colorValue");s.domain=p.domain.values[y],s.range=l,s.update()}i==null&&j.warnOnce("no topology was provided for [MapShapeSeries]; nothing will be rendered.")}isColorScaleValid(){const{colorKey:e}=this.properties;if(!e)return!1;const{dataModel:t,processedData:i}=this;if(!t||!i)return!1;const s=t.resolveProcessedDataIndexById(this,"colorValue"),n=i.input.count,o=Kie(this,i.defs.values[s].missing);return!(n===0||n===o)}getLabelLayout(e,t,i,s,n){if(t==null||s==null)return;const{idKey:o,idName:a,colorKey:r,colorName:l,labelKey:c,labelName:h,padding:d,label:u}=this.properties;if(c==null||!u.enabled)return;const p=this.getLabelText(t,e,c,"label",[],u,{value:t,datum:e,idKey:o,idName:a,colorKey:r,colorName:l,labelKey:c,labelName:h});if(p==null)return;const f=Ce(p)?Ks(p,u):i.measureLines(String(p)),y=(f.width+2*d)/(f.height+2*d);if(n?.geometry===s&&n?.labelText===p&&n?.aspectRatio===y)return n;const b=jh(s,wB),x=Vv(b);if(x==null)return;const v=Vie(x,{aspectRatio:y,precision:.001});if(v==null)return;const{x:S,y:M,maxWidth:D}=v;return{geometry:s,labelText:p,aspectRatio:y,x:S,y:M,maxWidth:D,fixedPolygon:x}}getLabelDatum(e,t,i,s){const{scale:n}=this;if(n==null)return;const{padding:o,label:a}=this.properties,{labelText:r,aspectRatio:l,x:c,y:h,maxWidth:d,fixedPolygon:u}=e,p={width:Math.ceil(d*t),height:Math.ceil(d*t/l),meta:c},f=bf(Pe(r),a,{padding:o},(k,I)=>{if(!I)return p;const A=Wie(u,c,h,k/t);return{width:A.width*t,height:k,meta:A.x}});if(f==null)return;const[{text:y,fontSize:b,lineHeight:x,width:v},S]=f,M=v<p.width?c:S,D=this.scale.convert(wB.invert([M,h]));return{x:D[0],y:D[1],text:y,fontSize:b,lineHeight:x,datumIndex:i,idValue:s,datumId:Uv(s)}}resolveColumn(e,t,i){if(!(e==null||this.dataModel==null))return this.dataModel.resolveColumnById(this,t,i)}resolveShapeDataColumns(e){const{colorKey:t,labelKey:i}=this.properties;return{idValues:this.dataModel.resolveColumnById(this,"idValue",e),featureValues:this.dataModel.resolveColumnById(this,"featureValue",e),labelValues:this.resolveColumn(i,"labelValue",e),colorValues:this.resolveColumn(t,"colorValue",e)}}warnMissingGeometries(e){if(e.length===0)return;const t=10;if(e.length>t){const i=e.length-t;e.length=t,e.push(`(+${i} more)`)}j.warnOnce("some data items do not have matches in the provided topology",e)}createNodeData(){const{id:e,dataModel:t,processedData:i,properties:s,scale:n,previousLabelLayouts:o}=this,{idKey:a,label:r,legendItemName:l,colorKey:c}=s;if(t==null||i==null)return;const h=n==null?Number.NaN:(n.range[1][0]-n.range[0][0])/n.bounds.width,d=this.resolveShapeDataColumns(i),u=Ze(r),p=new Map;this.previousLabelLayouts=p;const f=[],y=[],b=[],x=i.dataSources.get(this.id)?.data??[];for(const[v,S]of x.entries()){const M={idValue:d.idValues[v],colorValue:d.colorValues?.[v],labelValue:d.labelValues?.[v]},D=d.featureValues[v]?.geometry??void 0;if(D==null&&b.push(M.idValue),c!=null&&M.colorValue==null)continue;const k=this.getLabelLayout(S,M.labelValue,u,D,o?.get(M.idValue));k!=null&&p.set(M.idValue,k);const I=k!=null&&n!=null?this.getLabelDatum(k,h,v,M.idValue):void 0;I!=null&&y.push(I);const A=D!=null&&n!=null?jh(D,n):void 0;f.push({series:this,itemId:a,datum:S,datumIndex:v,...M,projectedGeometry:A,legendItemName:l,style:this.getItemStyle({datum:S,datumIndex:v,colorValue:M.colorValue},!1)})}return this.warnMissingGeometries(b),{itemId:e,nodeData:f,labelData:y}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){const{datumSelection:e,labelSelection:t,highlightDatumSelection:i}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.labelGroup.visible=this.visible;const s=this.ctx.chartService.highlight?.drawingMode??"overlay",n=this.getHighlightedDatum(),o=this.contextNodeData?.nodeData??[],a=this.contextNodeData?.labelData??[];this.datumSelection=this.updateDatumSelection({nodeData:o,datumSelection:e}),this.updateDatumStyles({datumSelection:e,isHighlight:!1}),this.updateDatumNodes({datumSelection:e,drawingMode:"overlay"}),this.labelSelection=this.updateLabelSelection({labelData:a,labelSelection:t});const r=this.getHighlightLabelData(a,n);this.highlightLabelSelection=this.updateLabelSelection({labelData:r,labelSelection:this.highlightLabelSelection}),this.updateLabelNodes({labelSelection:this.labelSelection,isHighlight:!1}),this.updateLabelNodes({labelSelection:this.highlightLabelSelection,isHighlight:!0}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:n==null?[]:[n],datumSelection:i}),this.updateDatumStyles({datumSelection:i,isHighlight:!0}),this.updateDatumNodes({datumSelection:i,drawingMode:s})}getHighlightLabelData(e,t){if(e.length===0)return[];const i=Uv(t?.idValue);return e.filter(s=>s.datumId===i&&s.datumIndex===t?.datumIndex)}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>Uv(t.idValue))}getItemStyle({datumIndex:e,datum:t,colorValue:i},s){const{properties:n,colorScale:o}=this,{colorRange:a,itemStyler:r}=n,l=n.getStyle();if(i!=null){const d=this.isColorScaleValid()?o.convert(i):a?.[0];d!=null&&(l.fill=d)}const c=this.getHighlightStyle(s,e);let h=oe(c,l);if(r!=null&&e!=null){const d=this.cachedDatumCallback(Uv(e,s?"highlight":"node"),()=>{const u=this.makeItemStylerParams(t,e,s,h);return this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],this.callWithContext(r,u))});d&&(h=oe(d,h))}return h}makeItemStylerParams(e,t,i,s){const{id:n}=this,o=this.ctx.highlightManager?.getActiveHighlight(),a=this.getHighlightStateString(o,i,t),r=this.filterItemStylerFillParams(s.fill)??s.fill;return{seriesId:n,datum:e,highlightState:a,...s,fill:r}}updateDatumStyles({datumSelection:e,isHighlight:t}){e.each((i,s)=>{s.style=this.getItemStyle(s,t)})}updateDatumNodes({datumSelection:e,drawingMode:t}){const i=bB(this.scale);e.each((s,n)=>{const{projectedGeometry:o}=n;if(o==null){s.visible=!1,s.projectedGeometry=void 0;return}s.visible=!0,s.projectedGeometry=o,s.setStyleProperties(n.style,i),s.drawingMode=t})}updateLabelSelection(e){const t=this.isLabelEnabled()?e.labelData:[];return e.labelSelection.update(t)}updateLabelNodes({isHighlight:e,labelSelection:t}){const{properties:i}=this,s=this.ctx.highlightManager?.getActiveHighlight();t.each((n,o)=>{const{x:a,y:r,text:l,fontSize:c,lineHeight:h,datumIndex:d}=o,u=Xie(this,void 0,i,i.label,e,s),{color:p,fontStyle:f,fontWeight:y,fontFamily:b}=u;n.visible=!0,n.x=a,n.y=r,n.text=l,n.fill=p,n.fontStyle=f,n.fontWeight=y,n.fontSize=c,n.lineHeight=h,n.fontFamily=b,n.textAlign="center",n.textBaseline="middle",n.fillOpacity=this.getHighlightStyle(e,d).opacity??1,n.setBoxing(u)})}resetAnimation(){}pickNodeClosestDatum({x:e,y:t}){let i=1/0,s;return this.datumSelection.each((n,o)=>{const a=n.distanceSquared(e,t);a<i&&(i=a,s=o)}),s==null?void 0:{datum:s,distance:Math.sqrt(i)}}datumMidPoint(e){const{_previousDatumMidPoint:t}=this;if(t?.datum===e)return t.point;const i=e.projectedGeometry,s=i==null?void 0:Vv(i),n=s==null?void 0:QC(s,2),o=n==null?void 0:{x:n[0],y:n[1]};return this._previousDatumMidPoint={datum:e,point:o},o}legendItemSymbol(e){const{dataModel:t,processedData:i,properties:s}=this,{fillOpacity:n,stroke:o,strokeWidth:a,strokeOpacity:r,lineDash:l,lineDashOffset:c}=s;let{fill:h}=s;if(e!=null&&this.isColorScaleValid()){const u=t.resolveColumnById(this,"colorValue",i)[e];u!=null&&(h=this.colorScale.convert(u))}return{marker:{fill:h,fillOpacity:n,stroke:o,strokeWidth:a,strokeOpacity:r,lineDash:l,lineDashOffset:c}}}getLegendData(e){const{processedData:t,dataModel:i}=this;if(t==null||i==null)return[];const{id:s,visible:n}=this,{title:o,legendItemName:a,idKey:r,idName:l,colorKey:c,colorRange:h,showInLegend:d}=this.properties;if(e==="gradient"&&c!=null&&h!=null){const u=t.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:n,seriesId:s,series:this.getFormatterContext("color"),colorRange:h,colorDomain:u}]}else return e==="category"?[{legendType:"category",id:s,itemId:s,seriesId:s,enabled:n,label:{text:a??o??l??r},symbol:this.legendItemSymbol(),legendItemName:a,hideInLegend:!d}]:[]}getTooltipContent(e){const{id:t,dataModel:i,processedData:s,properties:n,ctx:{formatManager:o}}=this,{idKey:a,idName:r,colorKey:l,colorName:c,labelKey:h,labelName:d,legendItemName:u,title:p,tooltip:f}=n;if(!i||!s)return;const y=s.dataSources.get(this.id)?.data[e],b=i.resolveColumnById(this,"idValue",s)[e],x=l==null?void 0:i.resolveColumnById(this,"colorValue",s)[e];if(l!=null&&x==null)return;const v=[];if(this.isLabelEnabled()&&h!=null&&h!==a){const M=i.resolveColumnById(this,"labelValue",s)[e],D=o.format(this.callWithContext.bind(this),{type:"category",value:M,datum:y,seriesId:t,legendItemName:u,key:h,source:"tooltip",property:"label",domain:[],boundSeries:this.getFormatterContext("label")});v.push({label:d,fallbackLabel:h,value:D??M})}if(x!=null){const M=i.getDomain(this,"colorValue","value",s).domain,D=o.format(this.callWithContext.bind(this),{type:"number",value:x,datum:y,seriesId:t,legendItemName:u,key:l,source:"tooltip",property:"color",domain:M,boundSeries:this.getFormatterContext("color"),fractionDigits:void 0});v.push({label:c,fallbackLabel:l,value:D??String(x)})}const S=this.getItemStyle({datum:y,datumIndex:e,colorValue:x},!1);return this.formatTooltipWithContext(f,{heading:b,title:p??u,symbol:this.legendItemSymbol(e),data:v},{seriesId:t,datum:y,title:p,idKey:a,idName:r,colorKey:l,colorName:c,labelKey:h,labelName:d,...S})}computeFocusBounds(e){return hB(this,e)}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.label.itemStyler!=null}};iL.className="MapShapeSeries",iL.type="map-shape";var{mapShapeSeriesThemeableOptionsDef:qie}=L,Qie={...Q(et,["highlightStyle","highlight"]),...qie,type:$(Le("map-shape")),idKey:$(N),colorKey:N,labelKey:N,idName:N,colorName:N,labelName:N,topology:ml,topologyIdKey:N,legendItemName:N,title:N},TB={type:"series",name:"map-shape",chartType:"topology",enterprise:!0,version:ue,dependencies:[Zf],options:Qie,themeTemplate:{...Xf,series:{fill:Wa({$applySwitch:[{$path:"type"},{$mapPalette:"fill"},["gradient",L.FILL_GRADIENT_LINEAR_DEFAULTS],["image",L.FILL_IMAGE_DEFAULTS],["pattern",L.FILL_PATTERN_DEFAULTS]]}),stroke:{$ref:"chartBackgroundColor"},colorRange:{$if:[{$eq:[{$mapPalette:"type"},"inbuilt"]},{$mapPalette:"divergingColors"},Wa(L.SAFE_RANGE2_OPERATION)]},fillOpacity:1,strokeWidth:1,lineDash:[0],lineDashOffset:0,padding:2,label:{...L.LABEL_BOXING_DEFAULTS,enabled:!0,color:{$ref:"chartBackgroundColor"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:"bold",overflowStrategy:"hide"},highlight:Wa(L.multiSeriesHighlightStyle())},tooltip:{range:"exact"}},create:e=>new iL(e)},NB=[fB,cB,DB,TB,kB],sL=[JI,zF,sB,NB,Mz,WF,lE,mE,ME,wE,PE].flat(),Ua=class extends K{constructor(){super(),this.opacity=1,this.loadedSynchronously=!0,this.containerWidth=0,this.containerHeight=0,this.onLoad=void 0,this.onImageLoad=()=>{this.loadedSynchronously||(this.node.visible=!1,this.performLayout(this.containerWidth,this.containerHeight),this.onLoad?.())},this.imageElement=xe("img"),this.imageElement.onload=this.onImageLoad,this.node=new L.Image(this.imageElement)}get complete(){return this.imageElement.width>0&&this.imageElement.height>0}performLayout(e,t){this.containerWidth=e,this.containerHeight=t;const i={width:e,height:t},s=my(this.imageElement.width,this.imageElement.height,i,this);return this.node.setProperties(this.complete?{visible:!0,opacity:this.opacity,...s}:{visible:!1}),s}};g([m],Ua.prototype,"top",2),g([m],Ua.prototype,"right",2),g([m],Ua.prototype,"bottom",2),g([m],Ua.prototype,"left",2),g([m],Ua.prototype,"width",2),g([m],Ua.prototype,"height",2),g([m],Ua.prototype,"opacity",2),g([Bt("imageElement.src"),Wt(e=>e.loadedSynchronously=e.complete)],Ua.prototype,"url",2);var nL=class extends L.Background{constructor(){super(...arguments),this.image=new Ua}onLayoutComplete(e){if(super.onLayoutComplete(e),this.image){const{width:t,height:i}=e.chart;this.image.performLayout(t,i)}}onImageLoad(){this.ctx.updateService.update(7)}};g([m,He({newValue(e){this.node.appendChild(e.node),e.onLoad=()=>this.onImageLoad()},oldValue(e){e.node.remove(),e.onLoad=void 0}})],nL.prototype,"image",2);var Jf=class extends L.Background{constructor(){super(...arguments),this.image=new Ua,this.fill="transparent",this.fillOpacity=void 0}createNode(){return new L.Group({name:"foreground",zIndex:18})}onLayoutComplete(e){super.onLayoutComplete(e);const{width:t,height:i}=e.chart,s=this.image.performLayout(t,i);this.text&&this.updateTextNode(s)}onImageLoad(){this.ctx.updateService.update(7)}updateTextNode(e){const{textNode:t}=this;t.fontWeight="bold",t.fontFamily="Impact, sans-serif",t.fontSize=19,t.opacity=.7,t.fill="#9b9b9b",t.textBaseline="top";const{width:i}=t.getBBox(),s=10;t.x=e.x+e.width/2-i/2,t.y=e.y+e.height+s}};g([m,He({newValue(e){this.node.appendChild(e.node),e.onLoad=()=>this.onImageLoad()},oldValue(e){e.node.remove(),e.onLoad=void 0}})],Jf.prototype,"image",2),g([m,kt("rectNode","fill")],Jf.prototype,"fill",2),g([m,kt("rectNode","fillOpacity")],Jf.prototype,"fillOpacity",2);var Jie=class{constructor(){this.ieCompatibility=!1}init(){this.ieCompatibility=this.md5("hello")!="5d41402abc4b2a76b9719d911017c592"}md5cycle(e,t){let i=e[0],s=e[1],n=e[2],o=e[3];i=this.ff(i,s,n,o,t[0],7,-680876936),o=this.ff(o,i,s,n,t[1],12,-389564586),n=this.ff(n,o,i,s,t[2],17,606105819),s=this.ff(s,n,o,i,t[3],22,-1044525330),i=this.ff(i,s,n,o,t[4],7,-176418897),o=this.ff(o,i,s,n,t[5],12,1200080426),n=this.ff(n,o,i,s,t[6],17,-1473231341),s=this.ff(s,n,o,i,t[7],22,-45705983),i=this.ff(i,s,n,o,t[8],7,1770035416),o=this.ff(o,i,s,n,t[9],12,-1958414417),n=this.ff(n,o,i,s,t[10],17,-42063),s=this.ff(s,n,o,i,t[11],22,-1990404162),i=this.ff(i,s,n,o,t[12],7,1804603682),o=this.ff(o,i,s,n,t[13],12,-40341101),n=this.ff(n,o,i,s,t[14],17,-1502002290),s=this.ff(s,n,o,i,t[15],22,1236535329),i=this.gg(i,s,n,o,t[1],5,-165796510),o=this.gg(o,i,s,n,t[6],9,-1069501632),n=this.gg(n,o,i,s,t[11],14,643717713),s=this.gg(s,n,o,i,t[0],20,-373897302),i=this.gg(i,s,n,o,t[5],5,-701558691),o=this.gg(o,i,s,n,t[10],9,38016083),n=this.gg(n,o,i,s,t[15],14,-660478335),s=this.gg(s,n,o,i,t[4],20,-405537848),i=this.gg(i,s,n,o,t[9],5,568446438),o=this.gg(o,i,s,n,t[14],9,-1019803690),n=this.gg(n,o,i,s,t[3],14,-187363961),s=this.gg(s,n,o,i,t[8],20,1163531501),i=this.gg(i,s,n,o,t[13],5,-1444681467),o=this.gg(o,i,s,n,t[2],9,-51403784),n=this.gg(n,o,i,s,t[7],14,1735328473),s=this.gg(s,n,o,i,t[12],20,-1926607734),i=this.hh(i,s,n,o,t[5],4,-378558),o=this.hh(o,i,s,n,t[8],11,-2022574463),n=this.hh(n,o,i,s,t[11],16,1839030562),s=this.hh(s,n,o,i,t[14],23,-35309556),i=this.hh(i,s,n,o,t[1],4,-1530992060),o=this.hh(o,i,s,n,t[4],11,1272893353),n=this.hh(n,o,i,s,t[7],16,-155497632),s=this.hh(s,n,o,i,t[10],23,-1094730640),i=this.hh(i,s,n,o,t[13],4,681279174),o=this.hh(o,i,s,n,t[0],11,-358537222),n=this.hh(n,o,i,s,t[3],16,-722521979),s=this.hh(s,n,o,i,t[6],23,76029189),i=this.hh(i,s,n,o,t[9],4,-640364487),o=this.hh(o,i,s,n,t[12],11,-421815835),n=this.hh(n,o,i,s,t[15],16,530742520),s=this.hh(s,n,o,i,t[2],23,-995338651),i=this.ii(i,s,n,o,t[0],6,-198630844),o=this.ii(o,i,s,n,t[7],10,1126891415),n=this.ii(n,o,i,s,t[14],15,-1416354905),s=this.ii(s,n,o,i,t[5],21,-57434055),i=this.ii(i,s,n,o,t[12],6,1700485571),o=this.ii(o,i,s,n,t[3],10,-1894986606),n=this.ii(n,o,i,s,t[10],15,-1051523),s=this.ii(s,n,o,i,t[1],21,-2054922799),i=this.ii(i,s,n,o,t[8],6,1873313359),o=this.ii(o,i,s,n,t[15],10,-30611744),n=this.ii(n,o,i,s,t[6],15,-1560198380),s=this.ii(s,n,o,i,t[13],21,1309151649),i=this.ii(i,s,n,o,t[4],6,-145523070),o=this.ii(o,i,s,n,t[11],10,-1120210379),n=this.ii(n,o,i,s,t[2],15,718787259),s=this.ii(s,n,o,i,t[9],21,-343485551),e[0]=this.add32(i,e[0]),e[1]=this.add32(s,e[1]),e[2]=this.add32(n,e[2]),e[3]=this.add32(o,e[3])}cmn(e,t,i,s,n,o){return t=this.add32(this.add32(t,e),this.add32(s,o)),this.add32(t<<n|t>>>32-n,i)}ff(e,t,i,s,n,o,a){return this.cmn(t&i|~t&s,e,t,n,o,a)}gg(e,t,i,s,n,o,a){return this.cmn(t&s|i&~s,e,t,n,o,a)}hh(e,t,i,s,n,o,a){return this.cmn(t^i^s,e,t,n,o,a)}ii(e,t,i,s,n,o,a){return this.cmn(i^(t|~s),e,t,n,o,a)}md51(e){const t=e.length,i=[1732584193,-271733879,-1732584194,271733878];let s;for(s=64;s<=e.length;s+=64)this.md5cycle(i,this.md5blk(e.substring(s-64,s)));e=e.substring(s-64);const n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(s=0;s<e.length;s++)n[s>>2]|=e.charCodeAt(s)<<(s%4<<3);if(n[s>>2]|=128<<(s%4<<3),s>55)for(this.md5cycle(i,n),s=0;s<16;s++)n[s]=0;return n[14]=t*8,this.md5cycle(i,n),i}md5blk(e){const t=[];for(let i=0;i<64;i+=4)t[i>>2]=e.charCodeAt(i)+(e.charCodeAt(i+1)<<8)+(e.charCodeAt(i+2)<<16)+(e.charCodeAt(i+3)<<24);return t}rhex(e){const t="0123456789abcdef".split("");let i="",s=0;for(;s<4;s++)i+=t[e>>s*8+4&15]+t[e>>s*8&15];return i}hex(e){for(let t=0;t<e.length;t++)e[t]=this.rhex(e[t]);return e.join("")}md5(e){return this.hex(this.md51(e))}add32(e,t){return this.ieCompatibility?this.add32Compat(e,t):this.add32Std(e,t)}add32Std(e,t){return e+t&4294967295}add32Compat(e,t){const i=(e&65535)+(t&65535);return(e>>16)+(t>>16)+(i>>16)<<16|i&65535}};function oL(e){return e==null||e.length===0}var Zv={"01":"GRID","02":"CHARTS","0102":"BOTH"},OB="https://www.ag-grid.com/charts/licensing/",aL=class Ni{constructor(t){this.watermarkMessage=void 0,this.totalMessageLength=124,this.document=t,this.md5=new Jie,this.md5.init()}validateLicense(){const t=this.getLicenseDetails(Ni.licenseKey,Ni.gridContext),i=`AG ${t.currentLicenseType==="BOTH"?"Grid and ":""}Charts Enterprise`;let s="";if(t.suppliedLicenseType==="BOTH"?s="AG Grid and AG Charts Enterprise":t.suppliedLicenseType==="GRID"?s="AG Grid Enterprise":t.suppliedLicenseType!==void 0&&(s="AG Charts Enterprise"),t.missing)(!this.isWebsiteUrl()||this.isForceWatermark())&&this.outputMissingLicenseKey(i);else if(t.expired){const n=Ni.getChartsReleaseDate(),o=Ni.formatDate(n);this.outputExpiredKey(t.expiry,o,s)}else t.valid?t.isTrial&&t.trialExpired&&this.outputExpiredTrialKey(t.expiry,i,s):this.outputInvalidLicenseKey(!!t.incorrectLicenseType,i,s)}static extractExpiry(t){const i=t.substring(t.lastIndexOf("_")+1,t.length);return new Date(Number.parseInt(Ni.decode(i),10))}static extractLicenseComponents(t){let i=t.replaceAll(/[\u200B-\u200D\uFEFF]/g,"");if(i=i.replaceAll(/\r?\n|\r/g,""),t.length<=32)return{md5:null,license:t,version:null,isTrial:null};const s=i.length-32,n=i.substring(s),o=i.substring(0,s),[a,r,l]=Ni.extractBracketedInformation(i);return{md5:n,license:o,version:a,isTrial:r,type:l}}getLicenseDetails(t,i=!1){const s="CHARTS";if(oL(t))return{licenseKey:t,valid:!1,missing:!0,currentLicenseType:s};const n=Ni.getChartsReleaseDate(),{md5:o,license:a,version:r,isTrial:l,type:c}=Ni.extractLicenseComponents(t);let h=o===this.md5.md5(a)&&!t.includes("For_Trialing_ag-Grid_Only"),d,u,p=null,f=!1,y;function b(){d=p<new Date,u=void 0}if(h&&(p=Ni.extractExpiry(a),h=!Number.isNaN(p.getTime()),h))switch(u=n>p,r){case"legacy":case"2":{h=!1;break}case"3":oL(c)?h=!1:(y=c,c!==Zv["02"]&&c!==Zv["0102"]?(h=!1,f=!0):l&&b())}return h?{licenseKey:t,valid:h,expiry:Ni.formatDate(p),expired:u,version:r,isTrial:l,trialExpired:d,invalidLicenseTypeForCombo:i?y!=="BOTH":void 0,incorrectLicenseType:f,currentLicenseType:s,suppliedLicenseType:y}:{licenseKey:t,valid:h,incorrectLicenseType:f,currentLicenseType:s,suppliedLicenseType:y}}isDisplayWatermark(){return this.isForceWatermark()||!this.isLocalhost()&&!this.isE2ETest()&&!this.isWebsiteUrl()&&!oL(this.watermarkMessage)}getWatermarkMessage(){return this.watermarkMessage??""}getHostname(){if(!this.document)return"localhost";const t=this.document.defaultView??globalThis;if(!t)return"localhost";const i=t.location,{hostname:s=""}=i;return s}isForceWatermark(){if(!this.document)return!1;const t=this.document?.defaultView??globalThis.window!=null?globalThis:void 0;if(!t)return!1;const{pathname:i}=t.location;return i?i.includes("forceWatermark"):!1}isWebsiteUrl(){const t=this.getHostname();return/^((?:[\w-]+\.)?ag-grid\.com)$/.exec(t)!==null}isLocalhost(){const t=this.getHostname();return/^(?:127\.0\.0\.1|localhost)$/.exec(t)!==null}isE2ETest(){const t=this.getHostname();return/^(?:172\.17\.0\.1|host\.docker\.internal)$/.exec(t)!==null}static formatDate(t){const i=["January","February","March","April","May","June","July","August","September","October","November","December"],s=t.getDate(),n=t.getMonth(),o=t.getFullYear();return s+" "+i[n]+" "+o}static getChartsReleaseDate(){return new Date(Number.parseInt(Ni.decode(Ni.RELEASE_INFORMATION),10))}static decode(t){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let s="",n,o,a,r,l,c,h,d=0;const u=t.replaceAll(/[^A-Za-z0-9+/=]/g,"");for(;d<u.length;)r=i.indexOf(u.charAt(d++)),l=i.indexOf(u.charAt(d++)),c=i.indexOf(u.charAt(d++)),h=i.indexOf(u.charAt(d++)),n=r<<2|l>>4,o=(l&15)<<4|c>>2,a=(c&3)<<6|h,s=s+String.fromCodePoint(n),c!=64&&(s=s+String.fromCodePoint(o)),h!=64&&(s=s+String.fromCodePoint(a));return s=Ni.utf8_decode(s),s}static utf8_decode(t){t=t.replaceAll("rn","n");let i="";for(let s=0;s<t.length;s++){const n=t.codePointAt(s);n<128?i+=String.fromCodePoint(n):n>127&&n<2048?(i+=String.fromCodePoint(n>>6|192),i+=String.fromCodePoint(n&63|128)):(i+=String.fromCodePoint(n>>12|224),i+=String.fromCodePoint(n>>6&63|128),i+=String.fromCodePoint(n&63|128))}return i}static setGridContext(t=!1){Ni.gridContext=t}static setLicenseKey(t){this.licenseKey&&this.licenseKey!==t&&console.warn("License Key being set multiple times with different values. This can result in an incorrect license key being used."),Ni.licenseKey=t}static extractBracketedInformation(t){if(!t.includes("["))return["legacy",!1,void 0];const i=t.match(/\[(.*?)\]/g).map(r=>r.replace("[","").replace("]",""));if(!i||i.length===0)return["legacy",!1,void 0];const s=i.filter(r=>r==="TRIAL").length===1,n=i.find(r=>r.startsWith("v")),o=n?n.replace("v",""):"legacy",a=Zv[i.find(r=>Zv[r])];return[o,s,a]}centerPadAndOutput(t){const i=this.totalMessageLength-t.length;console.error(t.padStart(i/2+t.length,"*").padEnd(this.totalMessageLength,"*"))}padAndOutput(t,i="*",s=""){console.error(t.padEnd(this.totalMessageLength-s.length,i)+s)}outputInvalidLicenseKey(t,i,s){Ni.gridContext||(t?(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Incompatible License Key "),this.padAndOutput(`* Your license key is for ${s} only and does not cover you for ${i}.`," ","*"),this.padAndOutput(`* To troubleshoot your license key visit ${OB}.`," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")):(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Invalid License Key "),this.padAndOutput("* Your license key is not valid."," ","*"),this.padAndOutput(`* To troubleshoot your license key visit ${OB}.`," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput(""))),this.watermarkMessage="Invalid License"}outputExpiredTrialKey(t,i,s){Ni.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Trial Period Expired. "),this.padAndOutput(`* Your trial only license for ${s} expired on ${t}.`," ","*"),this.padAndOutput("* Please email info@ag-grid.com to purchase a license."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="Trial Period Expired"}outputMissingLicenseKey(t){Ni.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${t} License `),this.centerPadAndOutput(" License Key Not Found "),this.padAndOutput(`* All ${t} features are unlocked for trial.`," ","*"),this.padAndOutput("* If you want to hide the watermark please email info@ag-grid.com for a trial license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="For Trial Use Only"}outputExpiredKey(t,i,s){Ni.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${s} License `),this.centerPadAndOutput(" Incompatible Software Version "),this.padAndOutput(`* Your license key works with versions of ${s} released before ${t}.`," ","*"),this.padAndOutput(`* The version you are trying to use was released on ${i}.`," ","*"),this.padAndOutput("* Please contact info@ag-grid.com to renew your license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="License Expired"}};aL.RELEASE_INFORMATION="MTc2NTM1NzM1MTg1Nw==",aL.gridContext=!1;var $h=aL;function EB(e,t){const i=e.addChild("canvas-overlay","watermark"),s=xe("span");s.innerText=t,i.addEventListener("animationend",()=>{e.removeChild("canvas-overlay","watermark"),e.removeStyles("watermark")}),i.classList.add("ag-watermark"),i.appendChild(s)}var PB=`.ag-watermark{position:absolute;bottom:20px;right:25px;font-weight:700;font-family:Impact,sans-serif;font-size:19px;opacity:.7;animation:1s ease-out 3s ag-watermark-fadeout;color:#9b9b9b;pointer-events:none;&:before{content:"";display:block;height:40px;width:170px;background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU4IiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMjU4IDQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMjUuNzc5IDI4LjY1N0gxMy4zNTlMMTEuMTczIDM0LjAxMkg1LjY3Mjk3TDE3LjE4MiA3LjA1OTk5SDIxLjk1M0wzMy40NjIgMzQuMDEySDI3Ljk2MkwyNS43NzYgMjguNjU3SDI1Ljc3OVpNMjQuMDY4IDI0LjM5N0wxOS41ODggMTMuNDM0TDE1LjEwNyAyNC4zOTdIMjQuMDY4Wk02Mi4wOTIgMTguODIzSDQ5LjgxN1YyMy4wODZINTYuNzc1QzU2LjU1NSAyNS4yMjIgNTUuNzU1IDI2LjkyNyA1NC4zNzIgMjguMjAyQzUyLjk4OSAyOS40NzYgNTEuMTY2IDMwLjExNSA0OC45MDkgMzAuMTE1QzQ3LjYyMiAzMC4xMTUgNDYuNDUgMjkuODg1IDQ1LjM5MyAyOS40MjNDNDQuMzU4MyAyOC45NzgxIDQzLjQzMjYgMjguMzEzOCA0Mi42OCAyNy40NzZDNDEuOTI3IDI2LjYzOSA0MS4zNDQgMjUuNjMxIDQwLjkzMSAyNC40NTNDNDAuNTE5IDIzLjI3NSA0MC4zMTEgMjEuOTcgNDAuMzExIDIwLjUzN0M0MC4zMTEgMTkuMTA1IDQwLjUxNiAxNy44IDQwLjkzMSAxNi42MjFDNDEuMzQ0IDE1LjQ0MyA0MS45MjcgMTQuNDM2IDQyLjY4IDEzLjU5OEM0My40Mzc2IDEyLjc1NzcgNDQuMzY5NiAxMi4wOTMyIDQ1LjQxMSAxMS42NTFDNDYuNDc4IDExLjE4OSA0Ny42NTYgMTAuOTYgNDguOTQ2IDEwLjk2QzUxLjYxMiAxMC45NiA1My42MzcgMTEuNjAyIDU1LjAyIDEyLjg4NUw1OC4zIDkuNjA0OTlDNTUuODE3IDcuNjY5OTkgNTIuNjc2IDYuNjk5OTkgNDguODcyIDYuNjk5OTlDNDYuNzYgNi42OTk5OSA0NC44NTMgNy4wMzQ5OSA0My4xNTQgNy43MDA5OUM0MS40NTUgOC4zNjc5OSAzOS45OTggOS4zMDM5OSAzOC43ODMgMTAuNTA0QzM3LjU2NyAxMS43MDcgMzYuNjM0IDEzLjE1OCAzNS45NzcgMTQuODU3QzM1LjMxOSAxNi41NTYgMzQuOTk0IDE4LjQ1MSAzNC45OTQgMjAuNTRDMzQuOTk0IDIyLjYzIDM1LjMyOSAyNC40OTQgMzUuOTk1IDI2LjIwNUMzNi42NjIgMjcuOTE2IDM3LjYwNSAyOS4zNzQgMzguODE3IDMwLjU3N0M0MC4wMzIgMzEuNzggNDEuNDg2IDMyLjcxMyA0My4xODggMzMuMzgzQzQ0Ljg4OCAzNC4wNDkgNDYuNzgyIDM0LjM4NCA0OC44NzIgMzQuMzg0QzUwLjk2MSAzNC4zODQgNTIuNzUgMzQuMDQ5IDU0LjM5IDMzLjM4M0M1Ni4wMzEgMzIuNzE2IDU3LjQyNiAzMS43OCA1OC41NzkgMzAuNTc3QzU5LjczMyAyOS4zNzQgNjAuNjE5IDI3LjkxNiA2MS4yMzkgMjYuMjA1QzYxLjg2IDI0LjQ5NCA2Mi4xNyAyMi42MDUgNjIuMTcgMjAuNTRDNjIuMTY5NiAxOS45Njg4IDYyLjE0NDUgMTkuMzk4IDYyLjA5NSAxOC44MjlMNjIuMDkyIDE4LjgyM1pNMTUxLjgxIDE2Ljk4MUMxNTMuNDEgMTQuNjA5IDE1Ny40MTkgMTQuMzU4IDE1OS4wMjIgMTQuMzU4VjE4LjkxQzE1Ni45NTcgMTguOTEgMTU0Ljk4NSAxOC45OTYgMTUzLjc1NyAxOS44OTJDMTUyLjUyOSAyMC43OTIgMTUxLjkxOSAyMS45ODIgMTUxLjkxOSAyMy40NjRWMzMuOTlIMTQ2Ljk2NFYxNC4zNThIMTUxLjczNkwxNTEuODEgMTYuOTgxWk0xNDMuMDExIDE0LjM2MVYzNC4wMzFIMTM4LjI0TDEzOC4xMzEgMzEuMDQ1QzEzNy40NjYgMzIuMDc2IDEzNi41NTEgMzIuOTIxOSAxMzUuNDcxIDMzLjUwNEMxMzQuMzc2IDM0LjA5OSAxMzMuMDY4IDM0LjM5NiAxMzEuNTM2IDM0LjM5NkMxMzAuMiAzNC4zOTYgMTI4Ljk2MyAzNC4xNTIgMTI3LjgyMiAzMy42NjhDMTI2LjcgMzMuMTk2NCAxMjUuNjg5IDMyLjQ5NSAxMjQuODU1IDMxLjYwOUMxMjQuMDE4IDMwLjcyMiAxMjMuMzU0IDI5LjY2MiAxMjIuODcxIDI4LjQyMkMxMjIuMzg0IDI3LjE4NSAxMjIuMTQyIDI1LjgxMSAxMjIuMTQyIDI0LjMwNEMxMjIuMTQyIDIyLjc5OCAxMjIuMzg0IDIxLjM3OCAxMjIuODcxIDIwLjExNkMxMjMuMzU3IDE4Ljg1NCAxMjQuMDE4IDE3Ljc3MiAxMjQuODU1IDE2Ljg3M0MxMjUuNjg4IDE1Ljk3NjQgMTI2LjY5OCAxNS4yNjM2IDEyNy44MjIgMTQuNzhDMTI4Ljk2MyAxNC4yODEgMTMwLjIwMyAxNC4wMzMgMTMxLjUzNiAxNC4wMzNDMTMzLjA0MyAxNC4wMzMgMTM0LjMzIDE0LjMxOCAxMzUuMzk3IDE0Ljg4OEMxMzYuNDYyIDE1LjQ1ODkgMTM3LjM3NSAxNi4yNzggMTM4LjA1NyAxNy4yNzZWMTQuMzYxSDE0My4wMTFaTTEzMi42MzEgMzAuMTMzQzEzNC4yNTYgMzAuMTMzIDEzNS41NjcgMjkuNTk0IDEzNi41NjUgMjguNTEyQzEzNy41NjEgMjcuNDMgMTM4LjA2IDI1Ljk5MSAxMzguMDYgMjQuMTk2QzEzOC4wNiAyMi40MDEgMTM3LjU2MSAyMC45OSAxMzYuNTY1IDE5Ljg5OUMxMzUuNTcgMTguODA3IDEzNC4yNTkgMTguMjU4IDEzMi42MzEgMTguMjU4QzEzMS4wMDMgMTguMjU4IDEyOS43MjkgMTguODA0IDEyOC43MzQgMTkuODk5QzEyNy43MzggMjAuOTkzIDEyNy4yMzkgMjIuNDM4IDEyNy4yMzkgMjQuMjMzQzEyNy4yMzkgMjYuMDI4IDEyNy43MzUgMjcuNDMzIDEyOC43MzQgMjguNTE1QzEyOS43MjkgMjkuNTk0IDEzMS4wMjggMzAuMTM2IDEzMi42MzEgMzAuMTM2VjMwLjEzM1pNOTMuNjk4IDI3Ljg3NkM5My41Nzk1IDI4LjAwMjUgOTMuNDU2NCAyOC4xMjQ2IDkzLjMyOSAyOC4yNDJDOTEuOTQ3IDI5LjUxNiA5MC4xMjMgMzAuMTU1IDg3Ljg2NiAzMC4xNTVDODYuNTggMzAuMTU1IDg1LjQwOCAyOS45MjYgODQuMzUgMjkuNDY0QzgzLjMxNTUgMjkuMDE4OSA4Mi4zODk4IDI4LjM1NDYgODEuNjM3IDI3LjUxN0M4MC44ODQgMjYuNjc5IDgwLjMwMSAyNS42NzIgNzkuODg5IDI0LjQ5NEM3OS40NzYgMjMuMzE1IDc5LjI2OSAyMi4wMSA3OS4yNjkgMjAuNTc4Qzc5LjI2OSAxOS4xNDUgNzkuNDczIDE3Ljg0IDc5Ljg4OSAxNi42NjJDODAuMzAxIDE1LjQ4NCA4MC44ODQgMTQuNDc2IDgxLjYzNyAxMy42MzlDODIuMzk0OSAxMi43OTg3IDgzLjMyNzMgMTIuMTM0MiA4NC4zNjkgMTEuNjkyQzg1LjQzNiAxMS4yMyA4Ni42MTQgMTEgODcuOTAzIDExQzkwLjU3IDExIDkyLjU5NSAxMS42NDIgOTMuOTc3IDEyLjkyNkw5Ny4yNTggOS42NDQ5OUM5NC43NzQgNy43MTA5OSA5MS42MzMgNi43Mzk5OSA4Ny44MjkgNi43Mzk5OUM4NS43MTggNi43Mzk5OSA4My44MTEgNy4wNzQ5OSA4Mi4xMTIgNy43NDE5OUM4MC40MTMgOC40MDc5OSA3OC45NTYgOS4zNDQ5OSA3Ny43NCAxMC41NDVDNzYuNTI1IDExLjc0NyA3NS41OTIgMTMuMTk5IDc0LjkzNCAxNC44OThDNzQuMjc3IDE2LjU5NyA3My45NTEgMTguNDkxIDczLjk1MSAyMC41ODFDNzMuOTUxIDIyLjY3IDc0LjI4NiAyNC41MzQgNzQuOTUzIDI2LjI0NUM3NS42MTkgMjcuOTU3IDc2LjU2MiAyOS40MTQgNzcuNzc0IDMwLjYxN0M3OC45OSAzMS44MiA4MC40NDQgMzIuNzUzIDgyLjE0NiAzMy40MjNDODMuODQ1IDM0LjA5IDg1LjczOSAzNC40MjQgODcuODI5IDM0LjQyNEM4OS45MTkgMzQuNDI0IDkxLjcwOCAzNC4wOSA5My4zNDggMzMuNDIzQzk0LjcxOCAzMi44NjUgOTUuOTE4IDMyLjEyMSA5Ni45NDggMzEuMTkxQzk3LjE0OSAzMS4wMDggOTcuMzQ4IDMwLjgxNSA5Ny41MzcgMzAuNjJMOTMuNzAxIDI3Ljg4NUw5My42OTggMjcuODc2Wk0xMTAuODAyIDE0LjAxNUMxMDkuMTk5IDE0LjAxNSAxMDYuODM2IDE0LjQ3MSAxMDUuNjExIDE2LjE1OEwxMDUuNTM3IDYuMDE1OTlIMTAwLjc2NVYzMy45MzlIMTA1LjcyVjIyLjY0MUMxMDUuNzcxIDIxLjQ2MDcgMTA2LjI4OCAyMC4zNDg4IDEwNy4xNTcgMTkuNTQ4OUMxMDguMDI3IDE4Ljc0OTEgMTA5LjE3OCAxOC4zMjY2IDExMC4zNTggMTguMzc0QzExMy4zOTcgMTguMzc0IDExNC4yNjggMjEuMTU5IDExNC4yNjggMjIuNjQxVjMzLjkzOUgxMTkuMjIzVjIxLjA1OUMxMTkuMjIzIDIxLjA1OSAxMTkuMTQyIDE0LjAxNSAxMTAuODAyIDE0LjAxNVpNMTczLjc2MyAxNC4zNThIMTY5Ljk5OVY4LjcxNDk5SDE2NS4wNDhWMTQuMzU4SDE2MS4yODRWMTguOTE2SDE2NS4wNDhWMzQuMDAzSDE2OS45OTlWMTguOTE2SDE3My43NjNWMTQuMzU4Wk0xOTAuNzg3IDI1LjI2MkMxOTAuMTI5IDI0LjUwMTQgMTg5LjMwNyAyMy44OTk0IDE4OC4zODQgMjMuNTAxQzE4Ny40ODggMjMuMTE3IDE4Ni4zMzEgMjIuNzMyIDE4NC45NDggMjIuMzY0QzE4NC4xNjUgMjIuMTQzOSAxODMuMzkgMjEuODk3OCAxODIuNjIzIDIxLjYyNkMxODIuMTYzIDIxLjQ2MjEgMTgxLjc0MSAyMS4yMDY2IDE4MS4zODMgMjAuODc1QzE4MS4yMzUgMjAuNzQyMSAxODEuMTE4IDIwLjU3ODkgMTgxLjAzOSAyMC4zOTY0QzE4MC45NjEgMjAuMjE0IDE4MC45MjIgMjAuMDE2NiAxODAuOTI3IDE5LjgxOEMxODAuOTI3IDE5LjI3MiAxODEuMTU2IDE4Ljg0NCAxODEuNjI1IDE4LjUxQzE4Mi4xMjEgMTguMTU2IDE4Mi44NjIgMTcuOTc2IDE4My44MjYgMTcuOTc2QzE4NC43OSAxNy45NzYgMTg1LjU4NyAxOC4yMDkgMTg2LjE0OCAxOC42NjhDMTg2LjcwNiAxOS4xMjQgMTg3LjAwNyAxOS43MjUgMTg3LjA3MiAyMC41TDE4Ny4wOTQgMjAuNzgySDE5MS42MzNMMTkxLjYxNyAyMC40NkMxOTEuNTIxIDE4LjQ4NSAxOTAuNzcxIDE2LjkgMTg5LjM4NSAxNS43NUMxODguMDEyIDE0LjYxMiAxODYuMTg1IDE0LjAzMyAxODMuOTYyIDE0LjAzM0MxODIuNDc3IDE0LjAzMyAxODEuMTQxIDE0LjI4NyAxNzkuOTk0IDE0Ljc4NkMxNzguODMxIDE1LjI5MSAxNzcuOTI2IDE1Ljk5NSAxNzcuMjk2IDE2Ljg4MkMxNzYuNjczIDE3Ljc0NTUgMTc2LjMzOCAxOC43ODQgMTc2LjM0MSAxOS44NDlDMTc2LjM0MSAyMS4xNjcgMTc2LjY5OCAyMi4yNDkgMTc3LjM5OSAyMy4wNjRDMTc4LjA2IDIzLjg0MzIgMTc4Ljg5OCAyNC40NTM0IDE3OS44NDIgMjQuODQ0QzE4MC43NDQgMjUuMjE2IDE4MS45MjggMjUuNjA3IDE4My4zNjEgMjZDMTg0LjgwNiAyNi40MSAxODUuODcyIDI2Ljc4NSAxODYuNTMgMjcuMTIzQzE4Ny4xIDI3LjQxNCAxODcuMzc5IDI3Ljg0NSAxODcuMzc5IDI4LjQ0NEMxODcuMzc5IDI5LjA0MiAxODcuMTIyIDI5LjQ2NyAxODYuNTk1IDI5LjgzOUMxODYuMDQzIDMwLjIyNiAxODUuMjM3IDMwLjQyNSAxODQuMjAxIDMwLjQyNUMxODMuMTY2IDMwLjQyNSAxODIuMzk0IDMwLjE3NCAxODEuNzQ5IDI5LjY3NEMxODEuMTEzIDI5LjE4MSAxODAuNzcyIDI4LjU4OSAxODAuNzEgMjcuODY0TDE4MC42ODUgMjcuNTgySDE3Ni4wMTNMMTc2LjAyNSAyNy45MDFDMTc2LjA2NyAyOS4wOTU1IDE3Ni40NzIgMzAuMjQ4NyAxNzcuMTg4IDMxLjIwNkMxNzcuOTA3IDMyLjE4IDE3OC44OTMgMzIuOTU4IDE4MC4xMTggMzMuNTE5QzE4MS4zMzYgMzQuMDc3IDE4Mi43MzIgMzQuMzYyIDE4NC4yNjYgMzQuMzYyQzE4NS44MDEgMzQuMzYyIDE4Ny4xMDkgMzQuMTA4IDE4OC4yMzggMzMuNjA5QzE4OS4zNzYgMzMuMTA0IDE5MC4yNzIgMzIuMzk0IDE5MC45MDEgMzEuNDk0QzE5MS41MzQgMzAuNTkyIDE5MS44NTMgMjkuNTU0IDE5MS44NTMgMjguNDAzQzE5MS44MjggMjcuMTEgMTkxLjQ2NiAyNi4wNTMgMTkwLjc3NyAyNS4yNjJIMTkwLjc4N1oiIGZpbGw9IiM5QjlCOUIiLz4KPHBhdGggZD0iTTI0MS45ODIgMjUuNjU4MlYxNy43MTE3SDIyOC40NDFMMjIwLjQ5NCAyNS42NTgySDI0MS45ODJaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNTcuMjM5IDUuOTUwODFIMjQwLjI2NUwyMzIuMjU1IDEzLjg5NzNIMjU3LjIzOVY1Ljk1MDgxWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjEyLjYxMSAzMy42MDQ4TDIxNi42OCAyOS41MzYxSDIzMC40MTJWMzcuNDgyN0gyMTIuNjExVjMzLjYwNDhaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yMTUuNTk5IDIxLjc4MDNIMjI0LjM3MkwyMzIuMzgyIDEzLjgzMzdIMjE1LjU5OVYyMS43ODAzWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjA2IDMzLjYwNDdIMjEyLjYxMUwyMjAuNDk0IDI1LjY1ODJIMjA2VjMzLjYwNDdaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNDAuMjY1IDUuOTUwODFMMjM2LjE5NyAxMC4wMTk0SDIxMC4yNTlWMi4wNzI4OEgyNDAuMjY1VjUuOTUwODFaIiBmaWxsPSIjOUI5QjlCIi8+Cjwvc3ZnPgo=);background-repeat:no-repeat;background-size:170px 40px}>span{padding-left:.7rem}}@keyframes ag-watermark-fadeout{0%{opacity:.5}to{opacity:0}}.ag-charts-dialog{display:flex;flex-direction:column;font-size:var(--ag-charts-chrome-font-size-large)}.ag-charts-dialog__tabs{display:flex;flex-direction:column}.ag-charts-dialog__header{border-bottom:1px solid var(--ag-charts-border-color);display:flex}.ag-charts-dialog__tab-list{display:flex;gap:calc(var(--ag-charts-spacing) * 2)}.ag-charts-dialog__drag-handle{align-items:center;color:inherit;cursor:grab;display:flex;padding:1px 6px;text-align:center}.ag-charts-dialog__drag-handle--dragging{cursor:grabbing}.ag-charts-dialog__tab-button{background:none;border:0;border-bottom:2px solid transparent;border-radius:0;color:var(--ag-charts-panel-subtle-text-color);margin-bottom:-1px;padding:var(--input-padding) calc(var(--input-padding) / 2)}.ag-charts-dialog__tab-button:hover{background:none}.ag-charts-dialog__tab-button--active{border-color:var(--ag-charts-accent-color);color:inherit}.ag-charts-dialog__drag-handle+.ag-charts-dialog__tab-button{margin-left:calc(var(--ag-charts-spacing) * -2)}.ag-charts-button.ag-charts-dialog__close-button{background:none;border:0;margin-left:auto;padding:1px 6px}.ag-charts-dialog__close-button:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:calc(var(--ag-charts-layer-ui-overlay) + 1)}.ag-charts-dialog__tab-panel{display:none;flex-direction:column;gap:calc(var(--ag-charts-spacing) * 4);margin:0 calc(var(--ag-charts-spacing) * 4);padding:calc(var(--ag-charts-spacing) * 4) 0}.ag-charts-dialog__tab-panel--active{display:flex}.ag-charts-dialog__input-group-line{display:flex;gap:16px 18px;flex-wrap:wrap}.ag-charts-dialog__input-group{align-items:center;display:flex;font-size:var(--ag-charts-chrome-font-size)}.ag-charts-dialog__input-group-label{color:var(--ag-charts-panel-subtle-text-color);margin-right:5px}.ag-charts-dialog__input-group-label[for]{cursor:pointer}.ag-charts-dialog__button{border-radius:0;margin-right:-1px}.ag-charts-dialog__button.ag-charts-dialog__button--active{background:var(--ag-charts-button-focus-background-color);border-color:var(--ag-charts-input-focus-border-color);color:var(--ag-charts-input-focus-text-color);z-index:var(--input-layer-active)}.ag-charts-dialog__button:first-child,.ag-charts-dialog__input-group-label+.ag-charts-dialog__button{border-bottom-left-radius:var(--ag-charts-input-border-radius);border-top-left-radius:var(--ag-charts-input-border-radius)}.ag-charts-dialog__button:last-child{border-bottom-right-radius:var(--ag-charts-input-border-radius);border-top-right-radius:var(--ag-charts-input-border-radius)}.ag-charts-dialog__color-picker-button{--color: #000;background:var(--color);border:none;color:transparent;height:26px;width:26px}.ag-charts-dialog__color-picker-button:hover{background:var(--color)}.ag-charts-dialog__color-picker-button--multi-color,.ag-charts-dialog__color-picker-button--multi-color:hover{background:linear-gradient(135deg,red 0%,#ff0 calc(100% * 1 / 6),#0f0 calc(100% * 2 / 6),#0ff 50%,#00f calc(100% * 4 / 6),#f0f calc(100% * 5 / 6),red 100%)}.ag-charts-color-picker{width:190px;padding:8px;cursor:default;--h: 0;--s: 0;--v: 0;--a: 0;--color: #000;--color-a: #000;--thumb-size: 18px;--inner-width: 172px;--track-height: 12px;--palette-height: 136px;--checker: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="4" height="4"><rect x="0" y="0" width="4" height="4" fill="%23fff"/><path d="M0 0H2V4H4V2H0Z" fill="%23b2b2b2"/></svg>');--multi-color: linear-gradient( 135deg, #f00 0% , #ff0 calc(100% * 1 / 6), #0f0 calc(100% * 2 / 6), #0ff 50% , #00f calc(100% * 4 / 6), #f0f calc(100% * 5 / 6), #f00 100% )}.ag-charts-color-picker__content{display:flex;flex-direction:column}.ag-charts-color-picker__palette{position:relative;width:100%;height:var(--palette-height);margin-bottom:8px;background:linear-gradient(to bottom,#0000,#000),linear-gradient(to right,#fff,#fff0) hsl(var(--h),100%,50%);border-radius:calc(var(--ag-charts-border-radius) * 1.5);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__palette:after{content:"";position:absolute;display:block;top:calc(var(--thumb-size) * -.5 + (1 - var(--v)) * 100%);left:calc(var(--thumb-size) * -.5 + var(--s) * 100%);background:var(--color);width:var(--thumb-size);height:var(--thumb-size);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:var(--box-shadow);--box-shadow: inset 0 0 0 3px white, inset 0 0 1px 3px #0006, 0 0 5px #00000038}.ag-charts-color-picker__palette:focus-visible:after{outline:var(--ag-charts-focus-border);box-shadow:var(--box-shadow),0 0 0 2px #fff8,var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__color-row{display:flex;gap:8px;align-items:center;margin-bottom:4px;--inset: calc((var(--thumb-size) - var(--track-height)) / 2)}.ag-charts-color-picker__hue-input,.ag-charts-color-picker__alpha-input{-webkit-appearance:none;display:block;position:relative;padding:0;margin:0 calc(var(--inset) * -1);border:0;height:var(--thumb-size);width:auto;background:transparent;--inset: calc((var(--thumb-size) - var(--track-height)) / 2)}.ag-charts-color-picker__hue-input::-moz-range-thumb,.ag-charts-color-picker__alpha-input::-moz-range-thumb{appearance:none;width:var(--thumb-size);height:var(--thumb-size);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:var(--box-shadow);--box-shadow: inset 0 0 0 3px white, inset 0 0 1px 3px #0006, 0 0 5px #00000038}.ag-charts-color-picker__hue-input::-webkit-slider-thumb,.ag-charts-color-picker__alpha-input::-webkit-slider-thumb{-webkit-appearance:none;width:var(--thumb-size);height:var(--thumb-size);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:var(--box-shadow);--box-shadow: inset 0 0 0 3px white, inset 0 0 1px 3px #0006, 0 0 5px #00000038;transform:translateZ(0)}.ag-charts-color-picker__hue-input::-moz-range-thumb{background:hsl(var(--h),100%,50%)}.ag-charts-color-picker__hue-input::-webkit-slider-thumb{background:hsl(var(--h),100%,50%)}.ag-charts-color-picker__alpha-input::-moz-range-thumb{background:transparent}.ag-charts-color-picker__alpha-input::-webkit-slider-thumb{background:transparent}.ag-charts-color-picker__alpha-input--opaque::-moz-range-thumb{background:var(--color)}.ag-charts-color-picker__alpha-input--opaque::-webkit-slider-thumb{background:var(--color)}.ag-charts-color-picker__hue-input:focus-visible::-moz-range-thumb,.ag-charts-color-picker__alpha-input:focus-visible::-moz-range-thumb{outline:var(--ag-charts-focus-border);box-shadow:var(--box-shadow),var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__hue-input:focus-visible::-webkit-slider-thumb,.ag-charts-color-picker__alpha-input:focus-visible::-webkit-slider-thumb{outline:var(--ag-charts-focus-border);box-shadow:var(--box-shadow),var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__hue-input::-moz-range-track,.ag-charts-color-picker__alpha-input::-moz-range-track{position:absolute;content:"";display:block;top:calc(50% - var(--track-height) / 2);left:var(--inset);right:var(--inset);height:var(--track-height);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__hue-input:before,.ag-charts-color-picker__alpha-input:before{position:absolute;content:"";display:block;top:calc(50% - var(--track-height) / 2);left:var(--inset);right:var(--inset);height:var(--track-height);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__multi-color-button{width:36px;margin-left:var(--inset);height:var(--track-height);border-radius:calc(var(--ag-charts-border-radius) * 99);border:0;background:var(--multi-color);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__multi-color-button--hidden{display:none}.ag-charts-color-picker__multi-color-button--active{box-shadow:inset 0 0 0 1px #0003;outline-offset:1px;outline:2px solid #2196f3}.ag-charts-color-picker__hue-input{flex:1 0 0}.ag-charts-color-picker__hue-input::-moz-range-track{background:linear-gradient(to right,red,red calc((100% - var(--track-height)) * 0 / 6 + var(--track-height) / 2),#ff0 calc((100% - var(--track-height)) * 1 / 6 + var(--track-height) / 2),#0f0 calc((100% - var(--track-height)) * 2 / 6 + var(--track-height) / 2),#0ff calc((100% - var(--track-height)) * 3 / 6 + var(--track-height) / 2),#00f calc((100% - var(--track-height)) * 4 / 6 + var(--track-height) / 2),#f0f calc((100% - var(--track-height)) * 5 / 6 + var(--track-height) / 2),red calc((100% - var(--track-height)) * 6 / 6 + var(--track-height) / 2))}.ag-charts-color-picker__hue-input:before{background:linear-gradient(to right,red,red calc((100% - var(--track-height)) * 0 / 6 + var(--track-height) / 2),#ff0 calc((100% - var(--track-height)) * 1 / 6 + var(--track-height) / 2),#0f0 calc((100% - var(--track-height)) * 2 / 6 + var(--track-height) / 2),#0ff calc((100% - var(--track-height)) * 3 / 6 + var(--track-height) / 2),#00f calc((100% - var(--track-height)) * 4 / 6 + var(--track-height) / 2),#f0f calc((100% - var(--track-height)) * 5 / 6 + var(--track-height) / 2),red calc((100% - var(--track-height)) * 6 / 6 + var(--track-height) / 2))}.ag-charts-color-picker__alpha-input{margin-bottom:7px}.ag-charts-color-picker__alpha-input::-moz-range-track{background:linear-gradient(to right,transparent,var(--color)),var(--checker) top left / 4px 4px}.ag-charts-color-picker__alpha-input:before{background:linear-gradient(to right,transparent,var(--color)),var(--checker) top left / 4px 4px}.ag-charts-color-picker__color-field{display:flex;border:var(--ag-charts-border);background:var(--ag-charts-background-color);border-radius:var(--ag-charts-border-radius);overflow:hidden}.ag-charts-color-picker__color-field:has(:focus-visible){border-color:var(--ag-charts-accent-color);box-shadow:var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__color-label{width:16px;height:16px;margin:7px 0 7px 7px;color:transparent;background:linear-gradient(to right,var(--color-a),var(--color-a)),var(--checker) top left / 4px 4px;border-radius:calc(var(--ag-charts-border-radius) / 2);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__color-label--multi-color{background:var(--multi-color)}.ag-charts-color-picker__color-input{flex:1;min-width:0;padding:7px 7px 7px 8px;border:0;margin:0;color:inherit;background:transparent;font-variant:tabular-nums}.ag-charts-color-picker__color-input:focus-visible{border:none;outline:none}.ag-charts-annotations__line-stroke-width-menu,.ag-charts-annotations__line-style-type-menu,.ag-charts-annotations__text-size-menu{border-top-left-radius:0;border-top-right-radius:0;.ag-charts-menu__row:first-child{border-radius:0}}.ag-charts-annotations__text-size-menu{--item-padding: 4px 8px;min-width:34px;text-align:center}.ag-charts-annotations__line-stroke-width-menu{--item-padding: 6px;column-gap:6px}.ag-charts-annotations__line-style-type-menu{--item-padding: 6px;column-gap:0}.ag-charts-annotations__stroke-width-button:before{background:var(--ag-charts-foreground-color);content:"";margin-right:var(--toolbar-button-padding);height:min(var(--stroke-width),20px);width:12px}.ag-charts-annotations__stroke-width-button[aria-disabled=true]:before{filter:grayscale(1);opacity:.5}.ag-charts-annotations__color-picker-button{--emblem: var(--color)}.ag-charts-annotations__color-picker-button--multi-color{--emblem: linear-gradient( to right, #f00 0% , #ff0 calc(100% * 1 / 6), #0f0 calc(100% * 2 / 6), #0ff 50% , #00f calc(100% * 4 / 6), #f0f calc(100% * 5 / 6), #f00 100% )}.ag-charts-annotations__color-picker-button:after{content:"";display:block;position:absolute;bottom:3px;left:5px;right:5px;height:4px;border-radius:99px;box-shadow:inset 0 0 0 1px color-mix(in srgb,var(--ag-charts-foreground-color) 10%,transparent);background:var(--emblem)}.ag-charts-annotations__color-picker-button[aria-disabled=true]:after{filter:grayscale(1);opacity:.5}.ag-charts-annotations__toolbar-menu{min-width:200px}.ag-charts-annotations__axis-button--hidden{display:none}.ag-charts-annotations__axis-button{background-color:var(--ag-charts-crosshair-label-background-color);border-radius:calc(var(--ag-charts-border-radius) / 2);border:none;box-sizing:border-box;color:var(--ag-charts-crosshair-label-text-color);cursor:pointer;font-family:var(--ag-charts-button-font-family);font-size:var(--ag-charts-button-font-size);font-weight:var(--ag-charts-button-font-weight);left:0;line-height:16px;overflow:hidden;padding:0;position:absolute;top:0;user-select:none;white-space:nowrap;z-index:var(--ag-charts-layer-annotations)}.ag-charts-annotations__axis-button:hover{opacity:.8;color:var(--ag-charts-background-color)}.ag-charts-dialog--annotation-settings{min-height:233px;width:289px}.ag-charts-dialog--annotation-settings .ag-charts-textarea{height:calc(10px * 2 + var(--textarea-line-height) * 1em * 3 + 2px);overflow-y:auto;resize:vertical}.ag-charts-context-menu{font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size);font-weight:var(--ag-charts-chrome-font-weight);z-index:var(--ag-charts-layer-ui-overlay)}.ag-charts-context-menu__cover{position:fixed;left:0;top:0}.ag-charts-context-menu__menu{background:var(--ag-charts-menu-background-color);border-radius:var(--ag-charts-border-radius);border:var(--ag-charts-menu-border);box-shadow:var(--ag-charts-popup-shadow);color:var(--ag-charts-menu-text-color);display:flex;flex-direction:column;padding:.5em 0;transition:transform .1s ease;white-space:nowrap}.ag-charts-context-menu__menu:focus{outline:none}.ag-charts-context-menu__item{align-items:center;background:none;border:none;box-sizing:border-box;color:inherit;cursor:pointer;display:flex;font:inherit;justify-content:space-between;text-align:left;width:100%;-webkit-appearance:none;-moz-appearance:none}.ag-charts-context-menu__icon>img{width:var(--ag-charts-icon-size);height:var(--ag-charts-icon-size)}.ag-charts-context-menu__icon,.ag-charts-context-menu__cell{display:flex;align-items:center;flex-shrink:0}.ag-charts-context-menu__cell{flex-grow:1}.ag-charts-context-menu__cellpadding{padding:.5em 1em}.ag-charts-context-menu__icon{padding-right:0}.ag-charts-context-menu__item[data-focus-override=true],.ag-charts-context-menu__item:focus,.ag-charts-context-menu__item:active{background:var(--ag-charts-focus-color)}.ag-charts-context-menu__item[data-focus-override=false]{background:inherit}.ag-charts-context-menu__item[data-focus-visible-override=true]:focus,.ag-charts-context-menu__item:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:calc(var(--ag-charts-layer-ui-overlay) + 1)}.ag-charts-context-menu__item[data-focus-visible-override=false]{outline:inherit;box-shadow:inherit;z-index:inherit}.ag-charts-context-menu__item[aria-disabled=true]{border:none;color:color-mix(in srgb,var(--ag-charts-input-text-color) 50%,transparent)}.ag-charts-context-menu__item[aria-disabled=true]:focus{background:inherit;cursor:inherit}.ag-charts-context-menu__divider{padding:5px 0}.ag-charts-context-menu__divider:after{content:"";display:block;border-top:1px solid var(--ag-charts-border-color)}.ag-charts-crosshair-label{position:absolute;left:0;top:0;user-select:none;pointer-events:none;font-family:var(--ag-charts-font-family);font-size:var(--ag-charts-font-size);font-weight:var(--ag-charts-font-weight);overflow:hidden;white-space:nowrap;z-index:var(--ag-charts-layer-crosshair);box-sizing:border-box}.ag-charts-crosshair-label-content{padding:0 8px;border-radius:calc(var(--ag-charts-border-radius) / 2);line-height:calc(var(--ag-charts-font-size) + 8px);background-color:var(--ag-charts-crosshair-label-background-color);color:var(--ag-charts-crosshair-label-text-color)}.ag-charts-crosshair-label--hidden{visibility:hidden!important}.ag-charts-text-input{position:absolute}.ag-charts-text-input__textarea{--placeholder-text-color: var(--ag-charts-input-placeholder-text-color);display:block;height:100%;width:100%;border:0;background:none;line-height:1.38;outline:none;transform:translateY(.09em)}.ag-charts-text-input__textarea[placeholder]:empty:before{content:attr(placeholder);color:var(--placeholder-text-color);font-weight:400}.ag-charts-text-input__textarea[placeholder]:not(:empty):before{content:""}.ag-charts-chart-toolbar__menu{min-width:200px}.ag-charts-range-buttons .ag-charts-toolbar__button{padding:var(--toolbar-button-padding) calc(var(--toolbar-button-padding) * 1.5)}.ag-charts-zoom-buttons{align-items:center;display:flex;height:44px;justify-content:center;overflow:hidden;padding-bottom:10px;pointer-events:none;width:100%;.ag-charts-toolbar{--toolbar-size: 24px;--toolbar-button-padding: 1px;display:flex;font-size:var(--ag-charts-chrome-font-size);height:var(--toolbar-size);justify-content:center;opacity:1;pointer-events:auto;transition:opacity .2s ease-in-out,transform .4s ease-in-out;.ag-charts-toolbar__button--first{border-bottom-left-radius:var(--ag-charts-border-radius);border-top-left-radius:var(--ag-charts-border-radius)}.ag-charts-toolbar__button--last{border-bottom-right-radius:var(--ag-charts-border-radius);border-top-right-radius:var(--ag-charts-border-radius)}.ag-charts-toolbar__label{padding-left:var(--ag-charts-spacing);padding-right:var(--ag-charts-spacing)}.ag-charts-toolbar__icon+.ag-charts-toolbar__label{padding-left:0}.ag-charts-toolbar__button--gap{margin-left:var(--toolbar-gap)}&.ag-charts-zoom-buttons__toolbar--hidden{opacity:0;transition:opacity .4s ease-in-out,transform .4s ease-in-out}}}.ag-charts-shared-toolbar{gap:var(--toolbar-gap);.ag-charts-toolbar__button{border-radius:var(--ag-charts-border-radius);margin:0}.ag-charts-toolbar__button--active+.ag-charts-toolbar__button{border-left-color:var(--ag-charts-border-color)}}
`;function ese(){me.registerModules(sL),Oi.styles=PB,Oi.licenseManager=e=>new $h(e.container?.ownerDocument??(typeof document>"u"?void 0:document)),Oi.injectWatermark=EB,Oi.createBackground=e=>new nL(e),Oi.createForeground=e=>new Jf(e)}var tse={setLicenseKey(e){$h.setLicenseKey(e)}},ise={VERSION:ue,_Scene:hb,_Theme:db,_Util:ub,create:fo.create.bind(fo),createSparkline:fo.__createSparkline.bind(fo),setup:()=>{me.setRegistryMode(me.RegistryMode.Integrated),ese()},setGridContext:$h.setGridContext.bind($h),setLicenseKey:$h.setLicenseKey.bind($h),isEnterprise:!0};if(me.setRegistryMode(me.RegistryMode.Enterprise),Oi.styles=PB,Oi.licenseManager=e=>new $h(e.container?.ownerDocument??(typeof document>"u"?void 0:document)),Oi.injectWatermark=EB,Oi.createBackground=e=>new nL(e),Oi.createForeground=e=>new Jf(e),me.setRegistryMode(me.RegistryMode.UMD),me.registerModules(sL),typeof aa.exports=="object"&&typeof kp=="object"){var sse=(e,t,i,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Object.getOwnPropertyNames(t))!Object.prototype.hasOwnProperty.call(e,n)&&n!==i&&Object.defineProperty(e,n,{get:()=>t[n],enumerable:!(s=Object.getOwnPropertyDescriptor(t,n))||s.enumerable});return e};aa.exports=sse(aa.exports,kp)}return aa.exports});
