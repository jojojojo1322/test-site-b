var qA=Object.defineProperty,QA=Object.getOwnPropertyDescriptor,p=(e,t,i,o)=>{for(var s=o>1?void 0:o?QA(t,i):t,a=e.length-1,n;a>=0;a--)(n=e[a])&&(s=(o?n(t,i,s):n(s))||s);return o&&s&&qA(t,i,s),s};import{ModuleRegistry as sm,enterpriseRegistry as Mn}from"ag-charts-core";import{_ModuleSupport as JA}from"ag-charts-community";import{ActionOnSet as eM,ChartUpdateType as tM,Property as iM}from"ag-charts-core";import{_ModuleSupport as oM}from"ag-charts-community";import{BaseProperties as sM,ObserveChanges as aM,Property as xs,ProxyProperty as nM,calculatePlacement as rM,createElement as lM}from"ag-charts-core";var Bi=class extends sM{constructor(){super(),this.opacity=1,this.loadedSynchronously=!0,this.containerWidth=0,this.containerHeight=0,this.onLoad=void 0,this.onImageLoad=()=>{this.loadedSynchronously||(this.node.visible=!1,this.performLayout(this.containerWidth,this.containerHeight),this.onLoad?.())},this.imageElement=lM("img"),this.imageElement.onload=this.onImageLoad,this.node=new oM.Image(this.imageElement)}get complete(){return this.imageElement.width>0&&this.imageElement.height>0}performLayout(e,t){this.containerWidth=e,this.containerHeight=t;const i={width:e,height:t},o=rM(this.imageElement.width,this.imageElement.height,i,this);return this.node.setProperties(this.complete?{visible:!0,opacity:this.opacity,...o}:{visible:!1}),o}};p([xs],Bi.prototype,"top",2),p([xs],Bi.prototype,"right",2),p([xs],Bi.prototype,"bottom",2),p([xs],Bi.prototype,"left",2),p([xs],Bi.prototype,"width",2),p([xs],Bi.prototype,"height",2),p([xs],Bi.prototype,"opacity",2),p([nM("imageElement.src"),aM(e=>e.loadedSynchronously=e.complete)],Bi.prototype,"url",2);var yh=class extends JA.Background{constructor(){super(...arguments),this.image=new Bi}onLayoutComplete(e){if(super.onLayoutComplete(e),this.image){const{width:t,height:i}=e.chart;this.image.performLayout(t,i)}}onImageLoad(){this.ctx.updateService.update(tM.SCENE_RENDER)}};p([iM,eM({newValue(e){this.node.appendChild(e.node),e.onLoad=()=>this.onImageLoad()},oldValue(e){e.node.remove(),e.onLoad=void 0}})],yh.prototype,"image",2);import{_ModuleSupport as am}from"ag-charts-community";import{ActionOnSet as cM,ChartUpdateType as hM,Property as fh,ProxyPropertyOnWrite as nm,ZIndexMap as dM}from"ag-charts-core";var In=class extends am.Background{constructor(){super(...arguments),this.image=new Bi,this.fill="transparent",this.fillOpacity=void 0}createNode(){return new am.Group({name:"foreground",zIndex:dM.FOREGROUND})}onLayoutComplete(e){super.onLayoutComplete(e);const{width:t,height:i}=e.chart,o=this.image.performLayout(t,i);this.text&&this.updateTextNode(o)}onImageLoad(){this.ctx.updateService.update(hM.SCENE_RENDER)}updateTextNode(e){const{textNode:t}=this;t.fontWeight="bold",t.fontFamily="Impact, sans-serif",t.fontSize=19,t.opacity=.7,t.fill="#9b9b9b",t.textBaseline="top";const{width:i}=t.getBBox(),o=10;t.x=e.x+e.width/2-i/2,t.y=e.y+e.height+o}};p([fh,cM({newValue(e){this.node.appendChild(e.node),e.onLoad=()=>this.onImageLoad()},oldValue(e){e.node.remove(),e.onLoad=void 0}})],In.prototype,"image",2),p([fh,nm("rectNode","fill")],In.prototype,"fill",2),p([fh,nm("rectNode","fillOpacity")],In.prototype,"fillOpacity",2);var pM=class{constructor(){this.ieCompatibility=!1}init(){this.ieCompatibility=this.md5("hello")!="5d41402abc4b2a76b9719d911017c592"}md5cycle(e,t){let i=e[0],o=e[1],s=e[2],a=e[3];i=this.ff(i,o,s,a,t[0],7,-680876936),a=this.ff(a,i,o,s,t[1],12,-389564586),s=this.ff(s,a,i,o,t[2],17,606105819),o=this.ff(o,s,a,i,t[3],22,-1044525330),i=this.ff(i,o,s,a,t[4],7,-176418897),a=this.ff(a,i,o,s,t[5],12,1200080426),s=this.ff(s,a,i,o,t[6],17,-1473231341),o=this.ff(o,s,a,i,t[7],22,-45705983),i=this.ff(i,o,s,a,t[8],7,1770035416),a=this.ff(a,i,o,s,t[9],12,-1958414417),s=this.ff(s,a,i,o,t[10],17,-42063),o=this.ff(o,s,a,i,t[11],22,-1990404162),i=this.ff(i,o,s,a,t[12],7,1804603682),a=this.ff(a,i,o,s,t[13],12,-40341101),s=this.ff(s,a,i,o,t[14],17,-1502002290),o=this.ff(o,s,a,i,t[15],22,1236535329),i=this.gg(i,o,s,a,t[1],5,-165796510),a=this.gg(a,i,o,s,t[6],9,-1069501632),s=this.gg(s,a,i,o,t[11],14,643717713),o=this.gg(o,s,a,i,t[0],20,-373897302),i=this.gg(i,o,s,a,t[5],5,-701558691),a=this.gg(a,i,o,s,t[10],9,38016083),s=this.gg(s,a,i,o,t[15],14,-660478335),o=this.gg(o,s,a,i,t[4],20,-405537848),i=this.gg(i,o,s,a,t[9],5,568446438),a=this.gg(a,i,o,s,t[14],9,-1019803690),s=this.gg(s,a,i,o,t[3],14,-187363961),o=this.gg(o,s,a,i,t[8],20,1163531501),i=this.gg(i,o,s,a,t[13],5,-1444681467),a=this.gg(a,i,o,s,t[2],9,-51403784),s=this.gg(s,a,i,o,t[7],14,1735328473),o=this.gg(o,s,a,i,t[12],20,-1926607734),i=this.hh(i,o,s,a,t[5],4,-378558),a=this.hh(a,i,o,s,t[8],11,-2022574463),s=this.hh(s,a,i,o,t[11],16,1839030562),o=this.hh(o,s,a,i,t[14],23,-35309556),i=this.hh(i,o,s,a,t[1],4,-1530992060),a=this.hh(a,i,o,s,t[4],11,1272893353),s=this.hh(s,a,i,o,t[7],16,-155497632),o=this.hh(o,s,a,i,t[10],23,-1094730640),i=this.hh(i,o,s,a,t[13],4,681279174),a=this.hh(a,i,o,s,t[0],11,-358537222),s=this.hh(s,a,i,o,t[3],16,-722521979),o=this.hh(o,s,a,i,t[6],23,76029189),i=this.hh(i,o,s,a,t[9],4,-640364487),a=this.hh(a,i,o,s,t[12],11,-421815835),s=this.hh(s,a,i,o,t[15],16,530742520),o=this.hh(o,s,a,i,t[2],23,-995338651),i=this.ii(i,o,s,a,t[0],6,-198630844),a=this.ii(a,i,o,s,t[7],10,1126891415),s=this.ii(s,a,i,o,t[14],15,-1416354905),o=this.ii(o,s,a,i,t[5],21,-57434055),i=this.ii(i,o,s,a,t[12],6,1700485571),a=this.ii(a,i,o,s,t[3],10,-1894986606),s=this.ii(s,a,i,o,t[10],15,-1051523),o=this.ii(o,s,a,i,t[1],21,-2054922799),i=this.ii(i,o,s,a,t[8],6,1873313359),a=this.ii(a,i,o,s,t[15],10,-30611744),s=this.ii(s,a,i,o,t[6],15,-1560198380),o=this.ii(o,s,a,i,t[13],21,1309151649),i=this.ii(i,o,s,a,t[4],6,-145523070),a=this.ii(a,i,o,s,t[11],10,-1120210379),s=this.ii(s,a,i,o,t[2],15,718787259),o=this.ii(o,s,a,i,t[9],21,-343485551),e[0]=this.add32(i,e[0]),e[1]=this.add32(o,e[1]),e[2]=this.add32(s,e[2]),e[3]=this.add32(a,e[3])}cmn(e,t,i,o,s,a){return t=this.add32(this.add32(t,e),this.add32(o,a)),this.add32(t<<s|t>>>32-s,i)}ff(e,t,i,o,s,a,n){return this.cmn(t&i|~t&o,e,t,s,a,n)}gg(e,t,i,o,s,a,n){return this.cmn(t&o|i&~o,e,t,s,a,n)}hh(e,t,i,o,s,a,n){return this.cmn(t^i^o,e,t,s,a,n)}ii(e,t,i,o,s,a,n){return this.cmn(i^(t|~o),e,t,s,a,n)}md51(e){const t=e.length,i=[1732584193,-271733879,-1732584194,271733878];let o;for(o=64;o<=e.length;o+=64)this.md5cycle(i,this.md5blk(e.substring(o-64,o)));e=e.substring(o-64);const s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(o=0;o<e.length;o++)s[o>>2]|=e.charCodeAt(o)<<(o%4<<3);if(s[o>>2]|=128<<(o%4<<3),o>55)for(this.md5cycle(i,s),o=0;o<16;o++)s[o]=0;return s[14]=t*8,this.md5cycle(i,s),i}md5blk(e){const t=[];for(let i=0;i<64;i+=4)t[i>>2]=e.charCodeAt(i)+(e.charCodeAt(i+1)<<8)+(e.charCodeAt(i+2)<<16)+(e.charCodeAt(i+3)<<24);return t}rhex(e){const t="0123456789abcdef".split("");let i="",o=0;for(;o<4;o++)i+=t[e>>o*8+4&15]+t[e>>o*8&15];return i}hex(e){for(let t=0;t<e.length;t++)e[t]=this.rhex(e[t]);return e.join("")}md5(e){return this.hex(this.md51(e))}add32(e,t){return this.ieCompatibility?this.add32Compat(e,t):this.add32Std(e,t)}add32Std(e,t){return e+t&4294967295}add32Compat(e,t){const i=(e&65535)+(t&65535);return(e>>16)+(t>>16)+(i>>16)<<16|i&65535}};function xh(e){return e==null||e.length===0}var Rr={"01":"GRID","02":"CHARTS","0102":"BOTH"},rm="https://www.ag-grid.com/charts/licensing/",Sh=class Ue{constructor(t){this.watermarkMessage=void 0,this.totalMessageLength=124,this.document=t,this.md5=new pM,this.md5.init()}validateLicense(){const t=this.getLicenseDetails(Ue.licenseKey,Ue.gridContext),i=`AG ${t.currentLicenseType==="BOTH"?"Grid and ":""}Charts Enterprise`;let o="";if(t.suppliedLicenseType==="BOTH"?o="AG Grid and AG Charts Enterprise":t.suppliedLicenseType==="GRID"?o="AG Grid Enterprise":t.suppliedLicenseType!==void 0&&(o="AG Charts Enterprise"),t.missing)(!this.isWebsiteUrl()||this.isForceWatermark())&&this.outputMissingLicenseKey(i);else if(t.expired){const s=Ue.getChartsReleaseDate(),a=Ue.formatDate(s);this.outputExpiredKey(t.expiry,a,o)}else t.valid?t.isTrial&&t.trialExpired&&this.outputExpiredTrialKey(t.expiry,i,o):this.outputInvalidLicenseKey(!!t.incorrectLicenseType,i,o)}static extractExpiry(t){const i=t.substring(t.lastIndexOf("_")+1,t.length);return new Date(Number.parseInt(Ue.decode(i),10))}static extractLicenseComponents(t){let i=t.replaceAll(/[\u200B-\u200D\uFEFF]/g,"");if(i=i.replaceAll(/\r?\n|\r/g,""),t.length<=32)return{md5:null,license:t,version:null,isTrial:null};const o=i.length-32,s=i.substring(o),a=i.substring(0,o),[n,r,l]=Ue.extractBracketedInformation(i);return{md5:s,license:a,version:n,isTrial:r,type:l}}getLicenseDetails(t,i=!1){const o="CHARTS";if(xh(t))return{licenseKey:t,valid:!1,missing:!0,currentLicenseType:o};const s=Ue.getChartsReleaseDate(),{md5:a,license:n,version:r,isTrial:l,type:c}=Ue.extractLicenseComponents(t);let h=a===this.md5.md5(n)&&!t.includes("For_Trialing_ag-Grid_Only"),d,u,g=null,m=!1,y;function S(){d=g<new Date,u=void 0}if(h&&(g=Ue.extractExpiry(n),h=!Number.isNaN(g.getTime()),h))switch(u=s>g,r){case"legacy":case"2":{h=!1;break}case"3":xh(c)?h=!1:(y=c,c!==Rr["02"]&&c!==Rr["0102"]?(h=!1,m=!0):l&&S())}return h?{licenseKey:t,valid:h,expiry:Ue.formatDate(g),expired:u,version:r,isTrial:l,trialExpired:d,invalidLicenseTypeForCombo:i?y!=="BOTH":void 0,incorrectLicenseType:m,currentLicenseType:o,suppliedLicenseType:y}:{licenseKey:t,valid:h,incorrectLicenseType:m,currentLicenseType:o,suppliedLicenseType:y}}isDisplayWatermark(){return this.isForceWatermark()||!this.isLocalhost()&&!this.isE2ETest()&&!this.isWebsiteUrl()&&!xh(this.watermarkMessage)}getWatermarkMessage(){return this.watermarkMessage??""}getHostname(){if(!this.document)return"localhost";const t=this.document.defaultView??globalThis;if(!t)return"localhost";const i=t.location,{hostname:o=""}=i;return o}isForceWatermark(){if(!this.document)return!1;const t=this.document?.defaultView??globalThis.window!=null?globalThis:void 0;if(!t)return!1;const{pathname:i}=t.location;return i?i.includes("forceWatermark"):!1}isWebsiteUrl(){const t=this.getHostname();return/^((?:[\w-]+\.)?ag-grid\.com)$/.exec(t)!==null}isLocalhost(){const t=this.getHostname();return/^(?:127\.0\.0\.1|localhost)$/.exec(t)!==null}isE2ETest(){const t=this.getHostname();return/^(?:172\.17\.0\.1|host\.docker\.internal)$/.exec(t)!==null}static formatDate(t){const i=["January","February","March","April","May","June","July","August","September","October","November","December"],o=t.getDate(),s=t.getMonth(),a=t.getFullYear();return o+" "+i[s]+" "+a}static getChartsReleaseDate(){return new Date(Number.parseInt(Ue.decode(Ue.RELEASE_INFORMATION),10))}static decode(t){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let o="",s,a,n,r,l,c,h,d=0;const u=t.replaceAll(/[^A-Za-z0-9+/=]/g,"");for(;d<u.length;)r=i.indexOf(u.charAt(d++)),l=i.indexOf(u.charAt(d++)),c=i.indexOf(u.charAt(d++)),h=i.indexOf(u.charAt(d++)),s=r<<2|l>>4,a=(l&15)<<4|c>>2,n=(c&3)<<6|h,o=o+String.fromCodePoint(s),c!=64&&(o=o+String.fromCodePoint(a)),h!=64&&(o=o+String.fromCodePoint(n));return o=Ue.utf8_decode(o),o}static utf8_decode(t){t=t.replaceAll("rn","n");let i="";for(let o=0;o<t.length;o++){const s=t.codePointAt(o);s<128?i+=String.fromCodePoint(s):s>127&&s<2048?(i+=String.fromCodePoint(s>>6|192),i+=String.fromCodePoint(s&63|128)):(i+=String.fromCodePoint(s>>12|224),i+=String.fromCodePoint(s>>6&63|128),i+=String.fromCodePoint(s&63|128))}return i}static setGridContext(t=!1){Ue.gridContext=t}static setLicenseKey(t){this.licenseKey&&this.licenseKey!==t&&console.warn("License Key being set multiple times with different values. This can result in an incorrect license key being used."),Ue.licenseKey=t}static extractBracketedInformation(t){if(!t.includes("["))return["legacy",!1,void 0];const i=t.match(/\[(.*?)\]/g).map(r=>r.replace("[","").replace("]",""));if(!i||i.length===0)return["legacy",!1,void 0];const o=i.filter(r=>r==="TRIAL").length===1,s=i.find(r=>r.startsWith("v")),a=s?s.replace("v",""):"legacy",n=Rr[i.find(r=>Rr[r])];return[a,o,n]}centerPadAndOutput(t){const i=this.totalMessageLength-t.length;console.error(t.padStart(i/2+t.length,"*").padEnd(this.totalMessageLength,"*"))}padAndOutput(t,i="*",o=""){console.error(t.padEnd(this.totalMessageLength-o.length,i)+o)}outputInvalidLicenseKey(t,i,o){Ue.gridContext||(t?(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Incompatible License Key "),this.padAndOutput(`* Your license key is for ${o} only and does not cover you for ${i}.`," ","*"),this.padAndOutput(`* To troubleshoot your license key visit ${rm}.`," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")):(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Invalid License Key "),this.padAndOutput("* Your license key is not valid."," ","*"),this.padAndOutput(`* To troubleshoot your license key visit ${rm}.`," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput(""))),this.watermarkMessage="Invalid License"}outputExpiredTrialKey(t,i,o){Ue.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Trial Period Expired. "),this.padAndOutput(`* Your trial only license for ${o} expired on ${t}.`," ","*"),this.padAndOutput("* Please email info@ag-grid.com to purchase a license."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="Trial Period Expired"}outputMissingLicenseKey(t){Ue.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${t} License `),this.centerPadAndOutput(" License Key Not Found "),this.padAndOutput(`* All ${t} features are unlocked for trial.`," ","*"),this.padAndOutput("* If you want to hide the watermark please email info@ag-grid.com for a trial license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="For Trial Use Only"}outputExpiredKey(t,i,o){Ue.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${o} License `),this.centerPadAndOutput(" Incompatible Software Version "),this.padAndOutput(`* Your license key works with versions of ${o} released before ${t}.`," ","*"),this.padAndOutput(`* The version you are trying to use was released on ${i}.`," ","*"),this.padAndOutput("* Please contact info@ag-grid.com to renew your license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="License Expired"}};Sh.RELEASE_INFORMATION="MTc2NTM1NzM1MTg1Nw==",Sh.gridContext=!1;var Ss=Sh;import{createElement as uM}from"ag-charts-core";function lm(e,t){const i=e.addChild("canvas-overlay","watermark"),o=uM("span");o.innerText=t,i.addEventListener("animationend",()=>{e.removeChild("canvas-overlay","watermark"),e.removeStyles("watermark")}),i.classList.add("ag-watermark"),i.appendChild(o)}var cm=`.ag-watermark{position:absolute;bottom:20px;right:25px;font-weight:700;font-family:Impact,sans-serif;font-size:19px;opacity:.7;animation:1s ease-out 3s ag-watermark-fadeout;color:#9b9b9b;pointer-events:none;&:before{content:"";display:block;height:40px;width:170px;background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU4IiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMjU4IDQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMjUuNzc5IDI4LjY1N0gxMy4zNTlMMTEuMTczIDM0LjAxMkg1LjY3Mjk3TDE3LjE4MiA3LjA1OTk5SDIxLjk1M0wzMy40NjIgMzQuMDEySDI3Ljk2MkwyNS43NzYgMjguNjU3SDI1Ljc3OVpNMjQuMDY4IDI0LjM5N0wxOS41ODggMTMuNDM0TDE1LjEwNyAyNC4zOTdIMjQuMDY4Wk02Mi4wOTIgMTguODIzSDQ5LjgxN1YyMy4wODZINTYuNzc1QzU2LjU1NSAyNS4yMjIgNTUuNzU1IDI2LjkyNyA1NC4zNzIgMjguMjAyQzUyLjk4OSAyOS40NzYgNTEuMTY2IDMwLjExNSA0OC45MDkgMzAuMTE1QzQ3LjYyMiAzMC4xMTUgNDYuNDUgMjkuODg1IDQ1LjM5MyAyOS40MjNDNDQuMzU4MyAyOC45NzgxIDQzLjQzMjYgMjguMzEzOCA0Mi42OCAyNy40NzZDNDEuOTI3IDI2LjYzOSA0MS4zNDQgMjUuNjMxIDQwLjkzMSAyNC40NTNDNDAuNTE5IDIzLjI3NSA0MC4zMTEgMjEuOTcgNDAuMzExIDIwLjUzN0M0MC4zMTEgMTkuMTA1IDQwLjUxNiAxNy44IDQwLjkzMSAxNi42MjFDNDEuMzQ0IDE1LjQ0MyA0MS45MjcgMTQuNDM2IDQyLjY4IDEzLjU5OEM0My40Mzc2IDEyLjc1NzcgNDQuMzY5NiAxMi4wOTMyIDQ1LjQxMSAxMS42NTFDNDYuNDc4IDExLjE4OSA0Ny42NTYgMTAuOTYgNDguOTQ2IDEwLjk2QzUxLjYxMiAxMC45NiA1My42MzcgMTEuNjAyIDU1LjAyIDEyLjg4NUw1OC4zIDkuNjA0OTlDNTUuODE3IDcuNjY5OTkgNTIuNjc2IDYuNjk5OTkgNDguODcyIDYuNjk5OTlDNDYuNzYgNi42OTk5OSA0NC44NTMgNy4wMzQ5OSA0My4xNTQgNy43MDA5OUM0MS40NTUgOC4zNjc5OSAzOS45OTggOS4zMDM5OSAzOC43ODMgMTAuNTA0QzM3LjU2NyAxMS43MDcgMzYuNjM0IDEzLjE1OCAzNS45NzcgMTQuODU3QzM1LjMxOSAxNi41NTYgMzQuOTk0IDE4LjQ1MSAzNC45OTQgMjAuNTRDMzQuOTk0IDIyLjYzIDM1LjMyOSAyNC40OTQgMzUuOTk1IDI2LjIwNUMzNi42NjIgMjcuOTE2IDM3LjYwNSAyOS4zNzQgMzguODE3IDMwLjU3N0M0MC4wMzIgMzEuNzggNDEuNDg2IDMyLjcxMyA0My4xODggMzMuMzgzQzQ0Ljg4OCAzNC4wNDkgNDYuNzgyIDM0LjM4NCA0OC44NzIgMzQuMzg0QzUwLjk2MSAzNC4zODQgNTIuNzUgMzQuMDQ5IDU0LjM5IDMzLjM4M0M1Ni4wMzEgMzIuNzE2IDU3LjQyNiAzMS43OCA1OC41NzkgMzAuNTc3QzU5LjczMyAyOS4zNzQgNjAuNjE5IDI3LjkxNiA2MS4yMzkgMjYuMjA1QzYxLjg2IDI0LjQ5NCA2Mi4xNyAyMi42MDUgNjIuMTcgMjAuNTRDNjIuMTY5NiAxOS45Njg4IDYyLjE0NDUgMTkuMzk4IDYyLjA5NSAxOC44MjlMNjIuMDkyIDE4LjgyM1pNMTUxLjgxIDE2Ljk4MUMxNTMuNDEgMTQuNjA5IDE1Ny40MTkgMTQuMzU4IDE1OS4wMjIgMTQuMzU4VjE4LjkxQzE1Ni45NTcgMTguOTEgMTU0Ljk4NSAxOC45OTYgMTUzLjc1NyAxOS44OTJDMTUyLjUyOSAyMC43OTIgMTUxLjkxOSAyMS45ODIgMTUxLjkxOSAyMy40NjRWMzMuOTlIMTQ2Ljk2NFYxNC4zNThIMTUxLjczNkwxNTEuODEgMTYuOTgxWk0xNDMuMDExIDE0LjM2MVYzNC4wMzFIMTM4LjI0TDEzOC4xMzEgMzEuMDQ1QzEzNy40NjYgMzIuMDc2IDEzNi41NTEgMzIuOTIxOSAxMzUuNDcxIDMzLjUwNEMxMzQuMzc2IDM0LjA5OSAxMzMuMDY4IDM0LjM5NiAxMzEuNTM2IDM0LjM5NkMxMzAuMiAzNC4zOTYgMTI4Ljk2MyAzNC4xNTIgMTI3LjgyMiAzMy42NjhDMTI2LjcgMzMuMTk2NCAxMjUuNjg5IDMyLjQ5NSAxMjQuODU1IDMxLjYwOUMxMjQuMDE4IDMwLjcyMiAxMjMuMzU0IDI5LjY2MiAxMjIuODcxIDI4LjQyMkMxMjIuMzg0IDI3LjE4NSAxMjIuMTQyIDI1LjgxMSAxMjIuMTQyIDI0LjMwNEMxMjIuMTQyIDIyLjc5OCAxMjIuMzg0IDIxLjM3OCAxMjIuODcxIDIwLjExNkMxMjMuMzU3IDE4Ljg1NCAxMjQuMDE4IDE3Ljc3MiAxMjQuODU1IDE2Ljg3M0MxMjUuNjg4IDE1Ljk3NjQgMTI2LjY5OCAxNS4yNjM2IDEyNy44MjIgMTQuNzhDMTI4Ljk2MyAxNC4yODEgMTMwLjIwMyAxNC4wMzMgMTMxLjUzNiAxNC4wMzNDMTMzLjA0MyAxNC4wMzMgMTM0LjMzIDE0LjMxOCAxMzUuMzk3IDE0Ljg4OEMxMzYuNDYyIDE1LjQ1ODkgMTM3LjM3NSAxNi4yNzggMTM4LjA1NyAxNy4yNzZWMTQuMzYxSDE0My4wMTFaTTEzMi42MzEgMzAuMTMzQzEzNC4yNTYgMzAuMTMzIDEzNS41NjcgMjkuNTk0IDEzNi41NjUgMjguNTEyQzEzNy41NjEgMjcuNDMgMTM4LjA2IDI1Ljk5MSAxMzguMDYgMjQuMTk2QzEzOC4wNiAyMi40MDEgMTM3LjU2MSAyMC45OSAxMzYuNTY1IDE5Ljg5OUMxMzUuNTcgMTguODA3IDEzNC4yNTkgMTguMjU4IDEzMi42MzEgMTguMjU4QzEzMS4wMDMgMTguMjU4IDEyOS43MjkgMTguODA0IDEyOC43MzQgMTkuODk5QzEyNy43MzggMjAuOTkzIDEyNy4yMzkgMjIuNDM4IDEyNy4yMzkgMjQuMjMzQzEyNy4yMzkgMjYuMDI4IDEyNy43MzUgMjcuNDMzIDEyOC43MzQgMjguNTE1QzEyOS43MjkgMjkuNTk0IDEzMS4wMjggMzAuMTM2IDEzMi42MzEgMzAuMTM2VjMwLjEzM1pNOTMuNjk4IDI3Ljg3NkM5My41Nzk1IDI4LjAwMjUgOTMuNDU2NCAyOC4xMjQ2IDkzLjMyOSAyOC4yNDJDOTEuOTQ3IDI5LjUxNiA5MC4xMjMgMzAuMTU1IDg3Ljg2NiAzMC4xNTVDODYuNTggMzAuMTU1IDg1LjQwOCAyOS45MjYgODQuMzUgMjkuNDY0QzgzLjMxNTUgMjkuMDE4OSA4Mi4zODk4IDI4LjM1NDYgODEuNjM3IDI3LjUxN0M4MC44ODQgMjYuNjc5IDgwLjMwMSAyNS42NzIgNzkuODg5IDI0LjQ5NEM3OS40NzYgMjMuMzE1IDc5LjI2OSAyMi4wMSA3OS4yNjkgMjAuNTc4Qzc5LjI2OSAxOS4xNDUgNzkuNDczIDE3Ljg0IDc5Ljg4OSAxNi42NjJDODAuMzAxIDE1LjQ4NCA4MC44ODQgMTQuNDc2IDgxLjYzNyAxMy42MzlDODIuMzk0OSAxMi43OTg3IDgzLjMyNzMgMTIuMTM0MiA4NC4zNjkgMTEuNjkyQzg1LjQzNiAxMS4yMyA4Ni42MTQgMTEgODcuOTAzIDExQzkwLjU3IDExIDkyLjU5NSAxMS42NDIgOTMuOTc3IDEyLjkyNkw5Ny4yNTggOS42NDQ5OUM5NC43NzQgNy43MTA5OSA5MS42MzMgNi43Mzk5OSA4Ny44MjkgNi43Mzk5OUM4NS43MTggNi43Mzk5OSA4My44MTEgNy4wNzQ5OSA4Mi4xMTIgNy43NDE5OUM4MC40MTMgOC40MDc5OSA3OC45NTYgOS4zNDQ5OSA3Ny43NCAxMC41NDVDNzYuNTI1IDExLjc0NyA3NS41OTIgMTMuMTk5IDc0LjkzNCAxNC44OThDNzQuMjc3IDE2LjU5NyA3My45NTEgMTguNDkxIDczLjk1MSAyMC41ODFDNzMuOTUxIDIyLjY3IDc0LjI4NiAyNC41MzQgNzQuOTUzIDI2LjI0NUM3NS42MTkgMjcuOTU3IDc2LjU2MiAyOS40MTQgNzcuNzc0IDMwLjYxN0M3OC45OSAzMS44MiA4MC40NDQgMzIuNzUzIDgyLjE0NiAzMy40MjNDODMuODQ1IDM0LjA5IDg1LjczOSAzNC40MjQgODcuODI5IDM0LjQyNEM4OS45MTkgMzQuNDI0IDkxLjcwOCAzNC4wOSA5My4zNDggMzMuNDIzQzk0LjcxOCAzMi44NjUgOTUuOTE4IDMyLjEyMSA5Ni45NDggMzEuMTkxQzk3LjE0OSAzMS4wMDggOTcuMzQ4IDMwLjgxNSA5Ny41MzcgMzAuNjJMOTMuNzAxIDI3Ljg4NUw5My42OTggMjcuODc2Wk0xMTAuODAyIDE0LjAxNUMxMDkuMTk5IDE0LjAxNSAxMDYuODM2IDE0LjQ3MSAxMDUuNjExIDE2LjE1OEwxMDUuNTM3IDYuMDE1OTlIMTAwLjc2NVYzMy45MzlIMTA1LjcyVjIyLjY0MUMxMDUuNzcxIDIxLjQ2MDcgMTA2LjI4OCAyMC4zNDg4IDEwNy4xNTcgMTkuNTQ4OUMxMDguMDI3IDE4Ljc0OTEgMTA5LjE3OCAxOC4zMjY2IDExMC4zNTggMTguMzc0QzExMy4zOTcgMTguMzc0IDExNC4yNjggMjEuMTU5IDExNC4yNjggMjIuNjQxVjMzLjkzOUgxMTkuMjIzVjIxLjA1OUMxMTkuMjIzIDIxLjA1OSAxMTkuMTQyIDE0LjAxNSAxMTAuODAyIDE0LjAxNVpNMTczLjc2MyAxNC4zNThIMTY5Ljk5OVY4LjcxNDk5SDE2NS4wNDhWMTQuMzU4SDE2MS4yODRWMTguOTE2SDE2NS4wNDhWMzQuMDAzSDE2OS45OTlWMTguOTE2SDE3My43NjNWMTQuMzU4Wk0xOTAuNzg3IDI1LjI2MkMxOTAuMTI5IDI0LjUwMTQgMTg5LjMwNyAyMy44OTk0IDE4OC4zODQgMjMuNTAxQzE4Ny40ODggMjMuMTE3IDE4Ni4zMzEgMjIuNzMyIDE4NC45NDggMjIuMzY0QzE4NC4xNjUgMjIuMTQzOSAxODMuMzkgMjEuODk3OCAxODIuNjIzIDIxLjYyNkMxODIuMTYzIDIxLjQ2MjEgMTgxLjc0MSAyMS4yMDY2IDE4MS4zODMgMjAuODc1QzE4MS4yMzUgMjAuNzQyMSAxODEuMTE4IDIwLjU3ODkgMTgxLjAzOSAyMC4zOTY0QzE4MC45NjEgMjAuMjE0IDE4MC45MjIgMjAuMDE2NiAxODAuOTI3IDE5LjgxOEMxODAuOTI3IDE5LjI3MiAxODEuMTU2IDE4Ljg0NCAxODEuNjI1IDE4LjUxQzE4Mi4xMjEgMTguMTU2IDE4Mi44NjIgMTcuOTc2IDE4My44MjYgMTcuOTc2QzE4NC43OSAxNy45NzYgMTg1LjU4NyAxOC4yMDkgMTg2LjE0OCAxOC42NjhDMTg2LjcwNiAxOS4xMjQgMTg3LjAwNyAxOS43MjUgMTg3LjA3MiAyMC41TDE4Ny4wOTQgMjAuNzgySDE5MS42MzNMMTkxLjYxNyAyMC40NkMxOTEuNTIxIDE4LjQ4NSAxOTAuNzcxIDE2LjkgMTg5LjM4NSAxNS43NUMxODguMDEyIDE0LjYxMiAxODYuMTg1IDE0LjAzMyAxODMuOTYyIDE0LjAzM0MxODIuNDc3IDE0LjAzMyAxODEuMTQxIDE0LjI4NyAxNzkuOTk0IDE0Ljc4NkMxNzguODMxIDE1LjI5MSAxNzcuOTI2IDE1Ljk5NSAxNzcuMjk2IDE2Ljg4MkMxNzYuNjczIDE3Ljc0NTUgMTc2LjMzOCAxOC43ODQgMTc2LjM0MSAxOS44NDlDMTc2LjM0MSAyMS4xNjcgMTc2LjY5OCAyMi4yNDkgMTc3LjM5OSAyMy4wNjRDMTc4LjA2IDIzLjg0MzIgMTc4Ljg5OCAyNC40NTM0IDE3OS44NDIgMjQuODQ0QzE4MC43NDQgMjUuMjE2IDE4MS45MjggMjUuNjA3IDE4My4zNjEgMjZDMTg0LjgwNiAyNi40MSAxODUuODcyIDI2Ljc4NSAxODYuNTMgMjcuMTIzQzE4Ny4xIDI3LjQxNCAxODcuMzc5IDI3Ljg0NSAxODcuMzc5IDI4LjQ0NEMxODcuMzc5IDI5LjA0MiAxODcuMTIyIDI5LjQ2NyAxODYuNTk1IDI5LjgzOUMxODYuMDQzIDMwLjIyNiAxODUuMjM3IDMwLjQyNSAxODQuMjAxIDMwLjQyNUMxODMuMTY2IDMwLjQyNSAxODIuMzk0IDMwLjE3NCAxODEuNzQ5IDI5LjY3NEMxODEuMTEzIDI5LjE4MSAxODAuNzcyIDI4LjU4OSAxODAuNzEgMjcuODY0TDE4MC42ODUgMjcuNTgySDE3Ni4wMTNMMTc2LjAyNSAyNy45MDFDMTc2LjA2NyAyOS4wOTU1IDE3Ni40NzIgMzAuMjQ4NyAxNzcuMTg4IDMxLjIwNkMxNzcuOTA3IDMyLjE4IDE3OC44OTMgMzIuOTU4IDE4MC4xMTggMzMuNTE5QzE4MS4zMzYgMzQuMDc3IDE4Mi43MzIgMzQuMzYyIDE4NC4yNjYgMzQuMzYyQzE4NS44MDEgMzQuMzYyIDE4Ny4xMDkgMzQuMTA4IDE4OC4yMzggMzMuNjA5QzE4OS4zNzYgMzMuMTA0IDE5MC4yNzIgMzIuMzk0IDE5MC45MDEgMzEuNDk0QzE5MS41MzQgMzAuNTkyIDE5MS44NTMgMjkuNTU0IDE5MS44NTMgMjguNDAzQzE5MS44MjggMjcuMTEgMTkxLjQ2NiAyNi4wNTMgMTkwLjc3NyAyNS4yNjJIMTkwLjc4N1oiIGZpbGw9IiM5QjlCOUIiLz4KPHBhdGggZD0iTTI0MS45ODIgMjUuNjU4MlYxNy43MTE3SDIyOC40NDFMMjIwLjQ5NCAyNS42NTgySDI0MS45ODJaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNTcuMjM5IDUuOTUwODFIMjQwLjI2NUwyMzIuMjU1IDEzLjg5NzNIMjU3LjIzOVY1Ljk1MDgxWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjEyLjYxMSAzMy42MDQ4TDIxNi42OCAyOS41MzYxSDIzMC40MTJWMzcuNDgyN0gyMTIuNjExVjMzLjYwNDhaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yMTUuNTk5IDIxLjc4MDNIMjI0LjM3MkwyMzIuMzgyIDEzLjgzMzdIMjE1LjU5OVYyMS43ODAzWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjA2IDMzLjYwNDdIMjEyLjYxMUwyMjAuNDk0IDI1LjY1ODJIMjA2VjMzLjYwNDdaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNDAuMjY1IDUuOTUwODFMMjM2LjE5NyAxMC4wMTk0SDIxMC4yNTlWMi4wNzI4OEgyNDAuMjY1VjUuOTUwODFaIiBmaWxsPSIjOUI5QjlCIi8+Cjwvc3ZnPgo=);background-repeat:no-repeat;background-size:170px 40px}>span{padding-left:.7rem}}@keyframes ag-watermark-fadeout{0%{opacity:.5}to{opacity:0}}.ag-charts-dialog{display:flex;flex-direction:column;font-size:var(--ag-charts-chrome-font-size-large)}.ag-charts-dialog__tabs{display:flex;flex-direction:column}.ag-charts-dialog__header{border-bottom:1px solid var(--ag-charts-border-color);display:flex}.ag-charts-dialog__tab-list{display:flex;gap:calc(var(--ag-charts-spacing) * 2)}.ag-charts-dialog__drag-handle{align-items:center;color:inherit;cursor:grab;display:flex;padding:1px 6px;text-align:center}.ag-charts-dialog__drag-handle--dragging{cursor:grabbing}.ag-charts-dialog__tab-button{background:none;border:0;border-bottom:2px solid transparent;border-radius:0;color:var(--ag-charts-panel-subtle-text-color);margin-bottom:-1px;padding:var(--input-padding) calc(var(--input-padding) / 2)}.ag-charts-dialog__tab-button:hover{background:none}.ag-charts-dialog__tab-button--active{border-color:var(--ag-charts-accent-color);color:inherit}.ag-charts-dialog__drag-handle+.ag-charts-dialog__tab-button{margin-left:calc(var(--ag-charts-spacing) * -2)}.ag-charts-button.ag-charts-dialog__close-button{background:none;border:0;margin-left:auto;padding:1px 6px}.ag-charts-dialog__close-button:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:calc(var(--ag-charts-layer-ui-overlay) + 1)}.ag-charts-dialog__tab-panel{display:none;flex-direction:column;gap:calc(var(--ag-charts-spacing) * 4);margin:0 calc(var(--ag-charts-spacing) * 4);padding:calc(var(--ag-charts-spacing) * 4) 0}.ag-charts-dialog__tab-panel--active{display:flex}.ag-charts-dialog__input-group-line{display:flex;gap:16px 18px;flex-wrap:wrap}.ag-charts-dialog__input-group{align-items:center;display:flex;font-size:var(--ag-charts-chrome-font-size)}.ag-charts-dialog__input-group-label{color:var(--ag-charts-panel-subtle-text-color);margin-right:5px}.ag-charts-dialog__input-group-label[for]{cursor:pointer}.ag-charts-dialog__button{border-radius:0;margin-right:-1px}.ag-charts-dialog__button.ag-charts-dialog__button--active{background:var(--ag-charts-button-focus-background-color);border-color:var(--ag-charts-input-focus-border-color);color:var(--ag-charts-input-focus-text-color);z-index:var(--input-layer-active)}.ag-charts-dialog__button:first-child,.ag-charts-dialog__input-group-label+.ag-charts-dialog__button{border-bottom-left-radius:var(--ag-charts-input-border-radius);border-top-left-radius:var(--ag-charts-input-border-radius)}.ag-charts-dialog__button:last-child{border-bottom-right-radius:var(--ag-charts-input-border-radius);border-top-right-radius:var(--ag-charts-input-border-radius)}.ag-charts-dialog__color-picker-button{--color: #000;background:var(--color);border:none;color:transparent;height:26px;width:26px}.ag-charts-dialog__color-picker-button:hover{background:var(--color)}.ag-charts-dialog__color-picker-button--multi-color,.ag-charts-dialog__color-picker-button--multi-color:hover{background:linear-gradient(135deg,red 0%,#ff0 calc(100% * 1 / 6),#0f0 calc(100% * 2 / 6),#0ff 50%,#00f calc(100% * 4 / 6),#f0f calc(100% * 5 / 6),red 100%)}.ag-charts-color-picker{width:190px;padding:8px;cursor:default;--h: 0;--s: 0;--v: 0;--a: 0;--color: #000;--color-a: #000;--thumb-size: 18px;--inner-width: 172px;--track-height: 12px;--palette-height: 136px;--checker: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="4" height="4"><rect x="0" y="0" width="4" height="4" fill="%23fff"/><path d="M0 0H2V4H4V2H0Z" fill="%23b2b2b2"/></svg>');--multi-color: linear-gradient( 135deg, #f00 0% , #ff0 calc(100% * 1 / 6), #0f0 calc(100% * 2 / 6), #0ff 50% , #00f calc(100% * 4 / 6), #f0f calc(100% * 5 / 6), #f00 100% )}.ag-charts-color-picker__content{display:flex;flex-direction:column}.ag-charts-color-picker__palette{position:relative;width:100%;height:var(--palette-height);margin-bottom:8px;background:linear-gradient(to bottom,#0000,#000),linear-gradient(to right,#fff,#fff0) hsl(var(--h),100%,50%);border-radius:calc(var(--ag-charts-border-radius) * 1.5);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__palette:after{content:"";position:absolute;display:block;top:calc(var(--thumb-size) * -.5 + (1 - var(--v)) * 100%);left:calc(var(--thumb-size) * -.5 + var(--s) * 100%);background:var(--color);width:var(--thumb-size);height:var(--thumb-size);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:var(--box-shadow);--box-shadow: inset 0 0 0 3px white, inset 0 0 1px 3px #0006, 0 0 5px #00000038}.ag-charts-color-picker__palette:focus-visible:after{outline:var(--ag-charts-focus-border);box-shadow:var(--box-shadow),0 0 0 2px #fff8,var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__color-row{display:flex;gap:8px;align-items:center;margin-bottom:4px;--inset: calc((var(--thumb-size) - var(--track-height)) / 2)}.ag-charts-color-picker__hue-input,.ag-charts-color-picker__alpha-input{-webkit-appearance:none;display:block;position:relative;padding:0;margin:0 calc(var(--inset) * -1);border:0;height:var(--thumb-size);width:auto;background:transparent;--inset: calc((var(--thumb-size) - var(--track-height)) / 2)}.ag-charts-color-picker__hue-input::-moz-range-thumb,.ag-charts-color-picker__alpha-input::-moz-range-thumb{appearance:none;width:var(--thumb-size);height:var(--thumb-size);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:var(--box-shadow);--box-shadow: inset 0 0 0 3px white, inset 0 0 1px 3px #0006, 0 0 5px #00000038}.ag-charts-color-picker__hue-input::-webkit-slider-thumb,.ag-charts-color-picker__alpha-input::-webkit-slider-thumb{-webkit-appearance:none;width:var(--thumb-size);height:var(--thumb-size);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:var(--box-shadow);--box-shadow: inset 0 0 0 3px white, inset 0 0 1px 3px #0006, 0 0 5px #00000038;transform:translateZ(0)}.ag-charts-color-picker__hue-input::-moz-range-thumb{background:hsl(var(--h),100%,50%)}.ag-charts-color-picker__hue-input::-webkit-slider-thumb{background:hsl(var(--h),100%,50%)}.ag-charts-color-picker__alpha-input::-moz-range-thumb{background:transparent}.ag-charts-color-picker__alpha-input::-webkit-slider-thumb{background:transparent}.ag-charts-color-picker__alpha-input--opaque::-moz-range-thumb{background:var(--color)}.ag-charts-color-picker__alpha-input--opaque::-webkit-slider-thumb{background:var(--color)}.ag-charts-color-picker__hue-input:focus-visible::-moz-range-thumb,.ag-charts-color-picker__alpha-input:focus-visible::-moz-range-thumb{outline:var(--ag-charts-focus-border);box-shadow:var(--box-shadow),var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__hue-input:focus-visible::-webkit-slider-thumb,.ag-charts-color-picker__alpha-input:focus-visible::-webkit-slider-thumb{outline:var(--ag-charts-focus-border);box-shadow:var(--box-shadow),var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__hue-input::-moz-range-track,.ag-charts-color-picker__alpha-input::-moz-range-track{position:absolute;content:"";display:block;top:calc(50% - var(--track-height) / 2);left:var(--inset);right:var(--inset);height:var(--track-height);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__hue-input:before,.ag-charts-color-picker__alpha-input:before{position:absolute;content:"";display:block;top:calc(50% - var(--track-height) / 2);left:var(--inset);right:var(--inset);height:var(--track-height);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__multi-color-button{width:36px;margin-left:var(--inset);height:var(--track-height);border-radius:calc(var(--ag-charts-border-radius) * 99);border:0;background:var(--multi-color);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__multi-color-button--hidden{display:none}.ag-charts-color-picker__multi-color-button--active{box-shadow:inset 0 0 0 1px #0003;outline-offset:1px;outline:2px solid #2196f3}.ag-charts-color-picker__hue-input{flex:1 0 0}.ag-charts-color-picker__hue-input::-moz-range-track{background:linear-gradient(to right,red,red calc((100% - var(--track-height)) * 0 / 6 + var(--track-height) / 2),#ff0 calc((100% - var(--track-height)) * 1 / 6 + var(--track-height) / 2),#0f0 calc((100% - var(--track-height)) * 2 / 6 + var(--track-height) / 2),#0ff calc((100% - var(--track-height)) * 3 / 6 + var(--track-height) / 2),#00f calc((100% - var(--track-height)) * 4 / 6 + var(--track-height) / 2),#f0f calc((100% - var(--track-height)) * 5 / 6 + var(--track-height) / 2),red calc((100% - var(--track-height)) * 6 / 6 + var(--track-height) / 2))}.ag-charts-color-picker__hue-input:before{background:linear-gradient(to right,red,red calc((100% - var(--track-height)) * 0 / 6 + var(--track-height) / 2),#ff0 calc((100% - var(--track-height)) * 1 / 6 + var(--track-height) / 2),#0f0 calc((100% - var(--track-height)) * 2 / 6 + var(--track-height) / 2),#0ff calc((100% - var(--track-height)) * 3 / 6 + var(--track-height) / 2),#00f calc((100% - var(--track-height)) * 4 / 6 + var(--track-height) / 2),#f0f calc((100% - var(--track-height)) * 5 / 6 + var(--track-height) / 2),red calc((100% - var(--track-height)) * 6 / 6 + var(--track-height) / 2))}.ag-charts-color-picker__alpha-input{margin-bottom:7px}.ag-charts-color-picker__alpha-input::-moz-range-track{background:linear-gradient(to right,transparent,var(--color)),var(--checker) top left / 4px 4px}.ag-charts-color-picker__alpha-input:before{background:linear-gradient(to right,transparent,var(--color)),var(--checker) top left / 4px 4px}.ag-charts-color-picker__color-field{display:flex;border:var(--ag-charts-border);background:var(--ag-charts-background-color);border-radius:var(--ag-charts-border-radius);overflow:hidden}.ag-charts-color-picker__color-field:has(:focus-visible){border-color:var(--ag-charts-accent-color);box-shadow:var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__color-label{width:16px;height:16px;margin:7px 0 7px 7px;color:transparent;background:linear-gradient(to right,var(--color-a),var(--color-a)),var(--checker) top left / 4px 4px;border-radius:calc(var(--ag-charts-border-radius) / 2);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__color-label--multi-color{background:var(--multi-color)}.ag-charts-color-picker__color-input{flex:1;min-width:0;padding:7px 7px 7px 8px;border:0;margin:0;color:inherit;background:transparent;font-variant:tabular-nums}.ag-charts-color-picker__color-input:focus-visible{border:none;outline:none}.ag-charts-annotations__line-stroke-width-menu,.ag-charts-annotations__line-style-type-menu,.ag-charts-annotations__text-size-menu{border-top-left-radius:0;border-top-right-radius:0;.ag-charts-menu__row:first-child{border-radius:0}}.ag-charts-annotations__text-size-menu{--item-padding: 4px 8px;min-width:34px;text-align:center}.ag-charts-annotations__line-stroke-width-menu{--item-padding: 6px;column-gap:6px}.ag-charts-annotations__line-style-type-menu{--item-padding: 6px;column-gap:0}.ag-charts-annotations__stroke-width-button:before{background:var(--ag-charts-foreground-color);content:"";margin-right:var(--toolbar-button-padding);height:min(var(--stroke-width),20px);width:12px}.ag-charts-annotations__stroke-width-button[aria-disabled=true]:before{filter:grayscale(1);opacity:.5}.ag-charts-annotations__color-picker-button{--emblem: var(--color)}.ag-charts-annotations__color-picker-button--multi-color{--emblem: linear-gradient( to right, #f00 0% , #ff0 calc(100% * 1 / 6), #0f0 calc(100% * 2 / 6), #0ff 50% , #00f calc(100% * 4 / 6), #f0f calc(100% * 5 / 6), #f00 100% )}.ag-charts-annotations__color-picker-button:after{content:"";display:block;position:absolute;bottom:3px;left:5px;right:5px;height:4px;border-radius:99px;box-shadow:inset 0 0 0 1px color-mix(in srgb,var(--ag-charts-foreground-color) 10%,transparent);background:var(--emblem)}.ag-charts-annotations__color-picker-button[aria-disabled=true]:after{filter:grayscale(1);opacity:.5}.ag-charts-annotations__toolbar-menu{min-width:200px}.ag-charts-annotations__axis-button--hidden{display:none}.ag-charts-annotations__axis-button{background-color:var(--ag-charts-crosshair-label-background-color);border-radius:calc(var(--ag-charts-border-radius) / 2);border:none;box-sizing:border-box;color:var(--ag-charts-crosshair-label-text-color);cursor:pointer;font-family:var(--ag-charts-button-font-family);font-size:var(--ag-charts-button-font-size);font-weight:var(--ag-charts-button-font-weight);left:0;line-height:16px;overflow:hidden;padding:0;position:absolute;top:0;user-select:none;white-space:nowrap;z-index:var(--ag-charts-layer-annotations)}.ag-charts-annotations__axis-button:hover{opacity:.8;color:var(--ag-charts-background-color)}.ag-charts-dialog--annotation-settings{min-height:233px;width:289px}.ag-charts-dialog--annotation-settings .ag-charts-textarea{height:calc(10px * 2 + var(--textarea-line-height) * 1em * 3 + 2px);overflow-y:auto;resize:vertical}.ag-charts-context-menu{font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size);font-weight:var(--ag-charts-chrome-font-weight);z-index:var(--ag-charts-layer-ui-overlay)}.ag-charts-context-menu__cover{position:fixed;left:0;top:0}.ag-charts-context-menu__menu{background:var(--ag-charts-menu-background-color);border-radius:var(--ag-charts-border-radius);border:var(--ag-charts-menu-border);box-shadow:var(--ag-charts-popup-shadow);color:var(--ag-charts-menu-text-color);display:flex;flex-direction:column;padding:.5em 0;transition:transform .1s ease;white-space:nowrap}.ag-charts-context-menu__menu:focus{outline:none}.ag-charts-context-menu__item{align-items:center;background:none;border:none;box-sizing:border-box;color:inherit;cursor:pointer;display:flex;font:inherit;justify-content:space-between;text-align:left;width:100%;-webkit-appearance:none;-moz-appearance:none}.ag-charts-context-menu__icon>img{width:var(--ag-charts-icon-size);height:var(--ag-charts-icon-size)}.ag-charts-context-menu__icon,.ag-charts-context-menu__cell{display:flex;align-items:center;flex-shrink:0}.ag-charts-context-menu__cell{flex-grow:1}.ag-charts-context-menu__cellpadding{padding:.5em 1em}.ag-charts-context-menu__icon{padding-right:0}.ag-charts-context-menu__item[data-focus-override=true],.ag-charts-context-menu__item:focus,.ag-charts-context-menu__item:active{background:var(--ag-charts-focus-color)}.ag-charts-context-menu__item[data-focus-override=false]{background:inherit}.ag-charts-context-menu__item[data-focus-visible-override=true]:focus,.ag-charts-context-menu__item:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:calc(var(--ag-charts-layer-ui-overlay) + 1)}.ag-charts-context-menu__item[data-focus-visible-override=false]{outline:inherit;box-shadow:inherit;z-index:inherit}.ag-charts-context-menu__item[aria-disabled=true]{border:none;color:color-mix(in srgb,var(--ag-charts-input-text-color) 50%,transparent)}.ag-charts-context-menu__item[aria-disabled=true]:focus{background:inherit;cursor:inherit}.ag-charts-context-menu__divider{padding:5px 0}.ag-charts-context-menu__divider:after{content:"";display:block;border-top:1px solid var(--ag-charts-border-color)}.ag-charts-crosshair-label{position:absolute;left:0;top:0;user-select:none;pointer-events:none;font-family:var(--ag-charts-font-family);font-size:var(--ag-charts-font-size);font-weight:var(--ag-charts-font-weight);overflow:hidden;white-space:nowrap;z-index:var(--ag-charts-layer-crosshair);box-sizing:border-box}.ag-charts-crosshair-label-content{padding:0 8px;border-radius:calc(var(--ag-charts-border-radius) / 2);line-height:calc(var(--ag-charts-font-size) + 8px);background-color:var(--ag-charts-crosshair-label-background-color);color:var(--ag-charts-crosshair-label-text-color)}.ag-charts-crosshair-label--hidden{visibility:hidden!important}.ag-charts-text-input{position:absolute}.ag-charts-text-input__textarea{--placeholder-text-color: var(--ag-charts-input-placeholder-text-color);display:block;height:100%;width:100%;border:0;background:none;line-height:1.38;outline:none;transform:translateY(.09em)}.ag-charts-text-input__textarea[placeholder]:empty:before{content:attr(placeholder);color:var(--placeholder-text-color);font-weight:400}.ag-charts-text-input__textarea[placeholder]:not(:empty):before{content:""}.ag-charts-chart-toolbar__menu{min-width:200px}.ag-charts-range-buttons .ag-charts-toolbar__button{padding:var(--toolbar-button-padding) calc(var(--toolbar-button-padding) * 1.5)}.ag-charts-zoom-buttons{align-items:center;display:flex;height:44px;justify-content:center;overflow:hidden;padding-bottom:10px;pointer-events:none;width:100%;.ag-charts-toolbar{--toolbar-size: 24px;--toolbar-button-padding: 1px;display:flex;font-size:var(--ag-charts-chrome-font-size);height:var(--toolbar-size);justify-content:center;opacity:1;pointer-events:auto;transition:opacity .2s ease-in-out,transform .4s ease-in-out;.ag-charts-toolbar__button--first{border-bottom-left-radius:var(--ag-charts-border-radius);border-top-left-radius:var(--ag-charts-border-radius)}.ag-charts-toolbar__button--last{border-bottom-right-radius:var(--ag-charts-border-radius);border-top-right-radius:var(--ag-charts-border-radius)}.ag-charts-toolbar__label{padding-left:var(--ag-charts-spacing);padding-right:var(--ag-charts-spacing)}.ag-charts-toolbar__icon+.ag-charts-toolbar__label{padding-left:0}.ag-charts-toolbar__button--gap{margin-left:var(--toolbar-gap)}&.ag-charts-zoom-buttons__toolbar--hidden{opacity:0;transition:opacity .4s ease-in-out,transform .4s ease-in-out}}}.ag-charts-shared-toolbar{gap:var(--toolbar-gap);.ag-charts-toolbar__button{border-radius:var(--ag-charts-border-radius);margin:0}.ag-charts-toolbar__button--active+.ag-charts-toolbar__button{border-left-color:var(--ag-charts-border-color)}}
`,gM=void 0,mM=void 0;mM=gM;var yM=void 0,fM=void 0;fM=yM;var hm=(e=>(e.POINTER="pointer",e.NODE="node",e.CHART="chart",e))(hm||{}),dm=(e=>(e.TOP="top",e.RIGHT="right",e.BOTTOM="bottom",e.LEFT="left",e.TOP_RIGHT="top-right",e.BOTTOM_RIGHT="bottom-right",e.BOTTOM_LEFT="bottom-left",e.TOP_LEFT="top-left",e.CENTER="center",e))(dm||{}),xM=void 0,SM=void 0;SM=xM;var bM=void 0,vM=void 0;vM=bM;export*from"ag-charts-community";import{VERSION as kM,_ModuleSupport as DM}from"ag-charts-community";import{_ModuleSupport as AM}from"ag-charts-community";import{Property as bh,isNumberEqual as pm}from"ag-charts-core";function vh(e,t,i){const o=(a,n,r,l)=>{let c=e[0];for(let h=a;r>0?h<=n:h>n;h+=r){const d=e[h];if(l(c,d))return!0;c=d}return!1},s=Math.floor(e.length/2);return o(t,s,t,i)?!0:o(e.length-t,s,-t,i)}import{_ModuleSupport as MM}from"ag-charts-community";import{Property as IM}from"ag-charts-core";var{AxisInterval:LM}=MM,kh=class extends LM{};p([IM],kh.prototype,"minSpacing",2);import{_ModuleSupport as Er}from"ag-charts-community";import{ChartAxisDirection as NM,Property as Dh,countFractionDigits as CM,isNumberEqual as ya,normalizeAngle360 as Oo,normalizeAngle360Inclusive as TM,toRadians as Ln,wrapTextOrSegments as wM}from"ag-charts-core";import{_ModuleSupport as um}from"ag-charts-community";import{ChartAxisDirection as PM,isNumberEqual as gm,normalizeAngle360 as Ah}from"ag-charts-core";import{_ModuleSupport as OM}from"ag-charts-community";import{BaseProperties as mm,ChartAxisDirection as RM,FONT_SIZE as EM,Property as Ce,createId as _M}from"ag-charts-core";var{Group:Mh}=OM,Ai=class extends mm{constructor(){super(...arguments),this.fontSize=EM.LARGE,this.fontFamily="Verdana, sans-serif",this.padding=5,this.color="rgba(87, 87, 87, 1)"}};p([Ce],Ai.prototype,"enabled",2),p([Ce],Ai.prototype,"text",2),p([Ce],Ai.prototype,"fontStyle",2),p([Ce],Ai.prototype,"fontWeight",2),p([Ce],Ai.prototype,"fontSize",2),p([Ce],Ai.prototype,"fontFamily",2),p([Ce],Ai.prototype,"padding",2),p([Ce],Ai.prototype,"color",2),p([Ce],Ai.prototype,"parallel",2);var yt=class extends mm{constructor(){super(...arguments),this.id=_M(this),this.defaultColorRange=[],this.shape="polygon",this.label=new Ai,this.scale=void 0,this.clippedRange=[-1/0,1/0],this.gridLength=0,this.sideFlag=-1,this.parallelFlipRotation=0,this.regularFlipRotation=0,this.direction=RM.Angle,this.axisInnerRadius=0,this.axisOuterRadius=0,this.lineGroup=new Mh({name:this.id}),this.rangeGroup=new Mh({name:this.id}),this.labelGroup=new Mh({name:this.id}),this._isRange=void 0}assignCrossLineGroup(e,t){e!==this._isRange&&(e?this.rangeGroup.appendChild(t):this.lineGroup.appendChild(t)),this._isRange=e}setSectorNodeProps(e){e.fill=this.fill,e.fillOpacity=this.fillOpacity??1,e.stroke=this.stroke,e.strokeOpacity=this.strokeOpacity??1,e.strokeWidth=this.strokeWidth??1,e.lineDash=this.lineDash}setLabelNodeProps(e,t,i,o,s){const{label:a}=this;e.x=t,e.y=i,e.text=a.text,e.textAlign="center",e.textBaseline=o,e.rotation=s,e.rotationCenterX=t,e.rotationCenterY=i,e.fill=a.color,e.fontFamily=a.fontFamily,e.fontSize=a.fontSize,e.fontStyle=a.fontStyle,e.visible=!0}};yt.className="PolarCrossLine",p([Ce],yt.prototype,"enabled",2),p([Ce],yt.prototype,"type",2),p([Ce],yt.prototype,"range",2),p([Ce],yt.prototype,"value",2),p([Ce],yt.prototype,"defaultColorRange",2),p([Ce],yt.prototype,"fill",2),p([Ce],yt.prototype,"fillOpacity",2),p([Ce],yt.prototype,"stroke",2),p([Ce],yt.prototype,"strokeWidth",2),p([Ce],yt.prototype,"strokeOpacity",2),p([Ce],yt.prototype,"lineDash",2),p([Ce],yt.prototype,"shape",2),p([Ce],yt.prototype,"label",2);var{getCrossLineValue:BM,validateCrossLineValue:VM,Group:zM,Path:ym,Sector:FM,RotatableText:HM,ContinuousScale:WM}=um,Ih=class extends yt{constructor(){super(),this.direction=PM.Angle,this.polygonNode=new ym,this.sectorNode=new FM,this.lineNode=new ym,this.crossLineRange=new zM,this.labelNode=new HM,this.ticks=[],this.crossLineRange.append(this.polygonNode),this.crossLineRange.append(this.sectorNode),this.crossLineRange.append(this.lineNode),this.labelGroup.append(this.labelNode)}visibilityCheck(){if(!WM.is(this.scale))return!0;const[e,t]=this.scale.domain,i=BM(this);if(this.type==="range"){const[o,s]=i;return o>=e&&o<=t&&s>=o&&s<=t}else return i>=e&&i<=t}update(e){const{scale:t}=this;if(!t||!VM(this,t)||!this.visibilityCheck()){this.rangeGroup.visible=!1,this.lineGroup.visible=!1,this.labelGroup.visible=!1;return}this.rangeGroup.visible=e,this.lineGroup.visible=e,this.labelGroup.visible=e,this.updateLineNode(e),this.updatePolygonNode(e),this.updateSectorNode(e),this.updateLabelNode(e)}updateLineNode(e){const{scale:t,type:i,value:o,lineNode:s}=this;if(!e||i!=="line"||!t){s.visible=!1;return}const a=t.convert(o);if(Number.isNaN(a)){s.visible=!1;return}const{axisInnerRadius:n,axisOuterRadius:r}=this;s.visible=!0,s.stroke=this.stroke,s.strokeOpacity=this.strokeOpacity??1,s.strokeWidth=this.strokeWidth??1,s.fill=void 0,s.lineDash=this.lineDash;const l=r*Math.cos(a),c=r*Math.sin(a),h=n*Math.cos(a),d=n*Math.sin(a);s.path.clear(!0),s.path.moveTo(h,d),s.path.lineTo(l,c),this.assignCrossLineGroup(!1,this.crossLineRange)}updatePolygonNode(e){const{polygonNode:t,range:i,scale:o,shape:s,type:a,ticks:n}=this;if(!e||a!=="range"||s!=="polygon"||!o||!i){t.visible=!1;return}const{axisInnerRadius:r,axisOuterRadius:l}=this,c=n.indexOf(i[0]),h=n.indexOf(i[1]),u=(c<=h?n.slice(c,h+1):n.slice(c).concat(n.slice(0,h+1))).map(m=>o.convert(m));t.visible=!0,this.setSectorNodeProps(t);const{path:g}=t;g.clear(!0);for(const[m,y]of u.entries()){const S=l*Math.cos(y),x=l*Math.sin(y);m===0?g.moveTo(S,x):g.lineTo(S,x)}if(r===0)g.lineTo(0,0);else{const m=u.slice().reverse();for(const y of m){const S=r*Math.cos(y),x=r*Math.sin(y);g.lineTo(S,x)}}t.path.closePath(),this.assignCrossLineGroup(!0,this.crossLineRange)}updateSectorNode(e){const{sectorNode:t,range:i,scale:o,shape:s,type:a}=this;if(!e||a!=="range"||s!=="circle"||!o||!i){t.visible=!1;return}const{axisInnerRadius:n,axisOuterRadius:r}=this,l=i.map(d=>o.convert(d)),c=o.step??0,h=o instanceof um.BandScale?c/2:0;t.visible=!0,this.setSectorNodeProps(t),t.centerX=0,t.centerY=0,t.innerRadius=n,t.outerRadius=r,t.startAngle=l[0]-h,t.endAngle=l[1]+h,this.assignCrossLineGroup(!0,this.crossLineRange)}updateLabelNode(e){const{label:t,labelNode:i,range:o,scale:s,type:a,ticks:n}=this;if(!e||t.enabled===!1||!t.text||!s||a==="range"&&!o){i.visible=!1;return}i.visible=!0;const{axisInnerRadius:r,axisOuterRadius:l}=this;let c,h,d,u;if(a==="line"){const g=Ah(s.convert(this.value)),m=1.5*Math.PI,y=gm(g,m)||g>m||g<Math.PI/2,S=(r+l)/2*Math.cos(g),x=(r+l)/2*Math.sin(g);c=S+t.padding*Math.cos(g+Math.PI/2),h=x+t.padding*Math.sin(g+Math.PI/2),u=y?"top":"bottom",d=y?g:g-Math.PI}else{const[g,m]=o.map(b=>Ah(s.convert(b)));let y=(g+m)/2;g>m&&(y-=Math.PI),y=Ah(y);const S=(gm(y,0)||y>0)&&y<Math.PI;let x;this.shape==="circle"||n.length<3?x=l-t.padding:x=l*Math.cos(Math.PI/n.length)-t.padding,c=x*Math.cos(y),h=x*Math.sin(y),u=S?"bottom":"top",d=S?y-Math.PI/2:y+Math.PI/2}this.setLabelNodeProps(i,c,h,u,d)}};Ih.className="AngleCrossLine";var{Path:KM,RotatableText:GM,Transformable:$M,BBox:YM,Selection:fm,Line:xm}=Er,Lh=class extends Er.AxisLabel{constructor(){super(...arguments),this.orientation="fixed"}};p([Dh],Lh.prototype,"orientation",2);var Nn=class extends Er.PolarAxis{constructor(e,t){super(e,t),this.startAngle=0,this.endAngle=void 0,this.tickLineGroupSelection=fm.select(this.tickLineGroup,xm,!1),this.gridLineGroupSelection=fm.select(this.gridLineGroup,xm,!1),this.labelData=[],this.tickData=[],this.radiusLineGroup=this.axisGroup.appendChild(new Er.TransformableGroup),this.radiusLine=this.radiusLineGroup.appendChild(new KM),this.includeInvisibleDomains=!0}get direction(){return NM.Angle}createLabel(){return new Lh}calculateRotations(){const e=Ln(this.startAngle),t=Oo(e),i=Oo(e-Math.PI/2);return{rotation:e,parallelFlipRotation:t,regularFlipRotation:i}}calculateTickLayout(e){const{nice:t,scale:i}=this,o={nice:[t,t],interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0},s=t?i.niceDomain(o,e):e,a=this.generateAngleTicks(s);this.tickData=a;const n=a.map(l=>l.value),r=n.reduce((l,c)=>Math.max(typeof c=="number"?CM(c):0,l),0);return{niceDomain:s,tickDomain:s,ticks:n,rawTickCount:void 0,fractionDigits:r,timeInterval:void 0,bbox:this.getBBox()}}update(){super.update(),this.updateRadiusLine(),this.updateGridLines(),this.updateTickLines()}normalizedAngles(){const e=Oo(-Math.PI/2+Ln(this.startAngle)),t=this.endAngle==null?2*Math.PI:TM(Ln(this.endAngle)-Ln(this.startAngle)),i=e+t;return[e,i]}computeRange(){this.range=this.normalizedAngles()}updateSelections(){const e=this.tickData;this.gridLineGroupSelection.update(this.gridLength&&this.gridLine.enabled?e:[]),this.tickLineGroupSelection.update(this.tick.enabled?e:[]),this.tickLabelGroupSelection.update(this.label.enabled?e:[]),this.gridLineGroupSelection.cleanup(),this.tickLineGroupSelection.cleanup(),this.tickLabelGroupSelection.cleanup()}updatePosition(){super.updatePosition();const{translation:e,radiusLineGroup:t}=this,i=Math.floor(e.x),o=Math.floor(e.y);t.translationX=i,t.translationY=o}updateRadiusLine(){const e=this.radiusLine,{path:t}=e;t.clear(!0);const{points:i,closePath:o}=this.getAxisLinePoints();for(const{x:s,y:a,moveTo:n,arc:r,radius:l=0,startAngle:c=0,endAngle:h=0}of i)r?t.arc(s,a,l,c,h):n?t.moveTo(s,a):t.lineTo(s,a);o&&t.closePath(),e.visible=this.line.enabled,e.stroke=this.line.stroke,e.strokeWidth=this.line.width,e.fill=void 0}getAxisLinePoints(){const{scale:e,shape:t,gridLength:i}=this,[o,s]=this.range,a=ya(s-o,2*Math.PI),n=[];if(t==="circle")a?n.push({x:i,y:0,moveTo:!0},{x:0,y:0,radius:i,startAngle:0,endAngle:2*Math.PI,arc:!0,moveTo:!1}):n.push({x:i*Math.cos(o),y:i*Math.sin(o),moveTo:!0},{x:0,y:0,radius:i,startAngle:Oo(o),endAngle:Oo(s),arc:!0,moveTo:!1});else if(t==="polygon"){const r=e.ticks({nice:[this.nice,this.nice],interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0})?.ticks?.map(l=>e.convert(l));if(r&&r.length>2)for(const[l,c]of r.entries()){const h=i*Math.cos(c),d=i*Math.sin(c),u=l===0;n.push({x:h,y:d,moveTo:u})}}return{points:n,closePath:a}}updateGridLines(){const{scale:e,gridLength:t,gridLine:{style:i,width:o},innerRadiusRatio:s}=this;if(!(i&&t>0))return;const a=t*s,n=i.length;this.gridLineGroupSelection.each((r,l,c)=>{const{value:h}=l,{stroke:d,lineDash:u}=i[c%n],g=e.convert(h);r.x1=a*Math.cos(g),r.y1=a*Math.sin(g),r.x2=t*Math.cos(g),r.y2=t*Math.sin(g),r.stroke=d,r.strokeWidth=o,r.lineDash=u,r.fill=void 0}),this.gridLineGroupSelection.cleanup()}updateLabels(){const{label:e,tickLabelGroupSelection:t}=this;t.each((i,o,s)=>{const a=this.labelData[s];if(!a||a.hidden){i.visible=!1;return}i.text=a.text,i.setFont(e),i.fill=e.color,i.x=a.x,i.y=a.y,i.setAlign(a),i.setBoxing(e),i.visible=!0,a.rotation?(i.rotation=a.rotation,i.rotationCenterX=a.x,i.rotationCenterY=a.y):i.rotation=0})}updateTickLines(){const{scale:e,gridLength:t,tick:i,tickLineGroupSelection:o}=this;o.each((s,a)=>{const{value:n}=a,r=e.convert(n),l=Math.cos(r),c=Math.sin(r);s.x1=t*l,s.y1=t*c,s.x2=(t+i.size)*l,s.y2=(t+i.size)*c,s.stroke=i.stroke,s.strokeWidth=i.width})}createLabelNodeData(e,t,i){const{label:o,gridLength:s,scale:a,tick:n}=this;if(!o.enabled)return[];const r=new GM,l=i.x-this.translation.x,c=i.x+i.width-this.translation.x,{fractionDigits:h}=this.layout.label,d=this.tickFormatter(this.scale.domain,this.tickData,!1,h),u=e.map((g,m)=>{const{value:y}=g,S=s+o.spacing+n.size,x=a.convert(y),b=Math.cos(x),f=Math.sin(x),v=S*b,k=S*f,{textAlign:A,textBaseline:M}=this.getLabelAlign(x),I=m===e.length-1&&y!==e[0]&&ya(Oo(x),Oo(a.convert(e[0]))),D=this.getLabelRotation(x);let L=d(y,m);r.text=L,r.x=v,r.y=k,r.setFont(o),r.textAlign=A,r.textBaseline=M,r.rotation=D,D&&(r.rotationCenterX=v,r.rotationCenterY=k);let N=D?$M.toCanvas(r):r.getBBox();if(N&&t.hideWhenNecessary&&!D){const T=l-N.x,O=N.x+N.width-c,R=1;if(T>R||O>R){const E={maxWidth:N.width-Math.max(T,O),font:o,textWrap:"never"};L=wM(L,E),r.text=L,N=r.getBBox()}}return{text:L,x:v,y:k,textAlign:A,textBaseline:M,hidden:L===""||(g.hidden??I),rotation:D,box:N}});return o.avoidCollisions&&this.avoidLabelCollisions(u),u}computeLabelsBBox(e,t){this.labelData=this.createLabelNodeData(this.tickData,e,t);const i=this.labelData.map(({box:o})=>o).filter(o=>o!=null);return!this.label.enabled||i.length===0?null:YM.merge(i)}getLabelOrientation(){const{label:e}=this;return e instanceof Lh?e.orientation:"fixed"}getLabelRotation(e){let t=Ln(this.label.rotation??0);e=Oo(e);const i=this.getLabelOrientation();return i==="parallel"?(t+=e,e>=0&&e<Math.PI?t-=Math.PI/2:t+=Math.PI/2):i==="perpendicular"&&(t+=e,e>=Math.PI/2&&e<1.5*Math.PI&&(t+=Math.PI)),t}getLabelAlign(e){const t=Math.cos(e),i=Math.sin(e);let o,s;const a=this.getLabelOrientation(),n=ya(t,0),r=ya(i,0),l=ya(t,1),c=ya(i,-1),h=t>0&&!n,d=i>0&&!r;return a==="parallel"?(o="center",s=l&&r||d?"top":"bottom"):a==="perpendicular"?(o=c||h?"left":"right",s="middle"):(o="right",n?o="center":h&&(o="left"),s="bottom",r?s="middle":d&&(s="top")),{textAlign:o,textBaseline:s}}updateCrossLines(){const{shape:e,gridLength:t,innerRadiusRatio:i}=this;for(const o of this.crossLines)o instanceof Ih&&(o.ticks=this.tickData.map(s=>s.value),o.shape=e,o.axisOuterRadius=t,o.axisInnerRadius=t*i);super.updateCrossLines()}};Nn.CrossLineConstructor=Ih,p([Dh],Nn.prototype,"startAngle",2),p([Dh],Nn.prototype,"endAngle",2);var{CategoryScale:UM}=AM,bs=class extends Nn{constructor(e){super(e,new UM),this.groupPaddingInner=0,this.paddingInner=0,this.interval=new kh}hasDefinedDomain(){return!1}generateAngleTicks(e){const{scale:t,gridLength:i}=this,{values:o,minSpacing:s}=this.interval,a={nice:[this.nice,this.nice],interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0},n=o??t.ticks(a,e)?.ticks??[];if(n.length<2||s==null)return n.map(d=>({value:d,visible:!0}));const r=n[0],l=t.convert(r),c=i*Math.cos(l),h=i*Math.sin(l);for(let d=1;d<n.length-1;d++){const u=n[d],g=t.convert(u);if(g-l>Math.PI)break;const m=i*Math.cos(g),y=i*Math.sin(g);if(Math.hypot(m-c,y-h)>s){const x=new Set([r]);return vh(n,d,(b,f)=>{x.add(f)}),n.map(b=>{const f=x.has(b);return{value:b,visible:f}})}}return[{value:r,visible:!0}]}avoidLabelCollisions(e){const{minSpacing:t}=this.label;if(e.length<3)return;const i=(l,c)=>{if(l.hidden||c.hidden)return!1;if(t==null)return l.box.collidesBBox(c.box);const h=l.box.clone().grow(t/2),d=c.box.clone().grow(t/2);return h.collidesBBox(d)},o=e[0],s=e.at(-1),a=new Set([o]),n=pm(o.x,s.x)&&pm(o.y,s.y),r=Math.floor(e.length/2);for(let l=1;l<=r;l++){const c=n?e.slice(0,-1):e;if(!vh(c,l,i)){vh(c,l,(d,u)=>{a.add(u)});break}}for(const l of e)a.has(l)||(l.hidden=!0,l.box=void 0)}tickFormatParams(){return{type:"category"}}datumFormatParams(e,t){const{datum:i,seriesId:o,legendItemName:s,key:a,source:n,property:r,domain:l,boundSeries:c}=t;return{type:"category",value:e,datum:i,seriesId:o,legendItemName:s,key:a,source:n,property:r,domain:l,boundSeries:c}}};bs.className="AngleCategoryAxis",bs.type="angle-category",p([bh],bs.prototype,"groupPaddingInner",2),p([bh],bs.prototype,"paddingInner",2),p([bh],bs.prototype,"interval",2);var Sm={type:"axis",name:"angle-category",chartType:"polar",enterprise:!0,version:kM,options:DM.angleCategoryAxisOptionsDefs,themeTemplate:{label:{spacing:5},gridLine:{enabled:!1},shape:{$findFirstSiblingNotOperation:void 0}},create:e=>new bs(e)};import{VERSION as jM,_ModuleSupport as XM}from"ag-charts-community";import"ag-charts-community";import{Property as Cn,angleBetween as ZM,findMinMax as qM,isNumberEqual as bm,normalisedExtentWithMetadata as QM}from"ag-charts-core";import{_ModuleSupport as JM}from"ag-charts-community";import{isDenseInterval as e0,isNumberEqual as t0,range as vm}from"ag-charts-core";var{LinearScale:Nh}=JM,km=class tm extends Nh{constructor(){super(...arguments),this.arcLength=0}static getNiceStepAndTickCount(t,i){const[o,s]=i;let a=Nh.getTickStep(o,s,t);const n=Number.isNaN(t.maxTickCount)?1/0:t.maxTickCount,r=Math.abs(s-o)/a;let l=Math.pow(2,Math.ceil(Math.log(r)/Math.log(2)));return l>n&&(l/=2,a*=2),{count:l,step:a}}ticks(t,i=this.domain){const{arcLength:o}=this;if(!i||i.length<2||i.some(h=>!Number.isFinite(h))||o<=0)return{ticks:[],count:0};const{nice:s,interval:a}=t,[n,r]=i;if(a){const h=Math.abs(a),d=this.getPixelRange();if(!e0((r-n)/h,d)){const u=vm(n,r,h);return{ticks:u.ticks,count:u.count}}}let l;if(s&&this.hasNiceRange()){const h=super.niceDomain(t,i);l=tm.getNiceStepAndTickCount(t,h).step}else l=Nh.getTickStep(n,r,t);const c=vm(n,r,l);return{ticks:c.ticks,count:c.count}}hasNiceRange(){const t=this.range.slice().sort((o,s)=>o-s);return[Math.PI,2*Math.PI].some(o=>t0(o,t[1]-t[0]))}niceDomain(t,i=this.domain){const o=super.niceDomain(t,i);if(!this.hasNiceRange())return o;const s=o[0]>o[1],a=s?o[1]:o[0],{step:n,count:r}=tm.getNiceStepAndTickCount(t,o),l=1/n,c=n>=1?Math.ceil(a/n+r)*n:Math.ceil((a+r*n)*l)/l;return s?[c,a]:[a,c]}getPixelRange(){return this.arcLength}},Ro=class extends Nn{constructor(e){super(e,new km),this.shape="circle",this.interval=new kh}hasDefinedDomain(){const{min:e,max:t}=this;return e!=null&&t!=null&&e<t}normaliseDataDomain(e){const{min:t,max:i,preferredMin:o,preferredMax:s}=this,{extent:a,clipped:n}=QM(e.domain,t,i,o,s,void 0,e.sortMetadata?.sortOrder);return{domain:a,clipped:n}}getDomainExtentsNice(){return[this.min==null&&this.nice,this.max==null&&this.nice]}updateScale(){super.updateScale(),this.scale.arcLength=this.getRangeArcLength()}getRangeArcLength(){const{range:e}=this,t=Math.min(...e),i=Math.max(...e),o=ZM(t,i)||2*Math.PI,s=this.gridLength;return o*s}generateAngleTicks(e){const{scale:t,range:i,nice:o}=this,{values:s,step:a,minSpacing:n,maxSpacing:r}=this.interval;let l;if(s==null){const{arcLength:c}=t,h=r?Math.floor(c/r):1,d=n?Math.floor(c/n):1/0,u=Math.floor(4/Math.PI*Math.abs(i[0]-i[1])),g=Math.max(h,Math.min(d,u)),m={nice:[o,o],interval:a,tickCount:g,minTickCount:h,maxTickCount:d};l=t.ticks(m,e)?.ticks??[]}else{const[c,h]=qM(e.map(Number));l=s.filter(d=>d>=c&&d<=h).sort((d,u)=>d-u)}return l.map(c=>({value:c,visible:!0}))}avoidLabelCollisions(e){const{minSpacing:t}=this.label,i=(a,n)=>{if(a.hidden||n.hidden)return!1;if(t==null)return a.box.collidesBBox(n.box);const r=a.box.clone().grow(t/2),l=n.box.clone().grow(t/2);return r.collidesBBox(l)},o=e[0],s=e.at(-1);o!==s&&bm(o.x,s.x)&&bm(o.y,s.y)&&(s.hidden=!0);for(let a=1;a<e.length;a*=2){let n=!1;for(let r=a;r<e.length;r+=a){const l=e[r],c=e[r-a];if(i(c,l)){n=!0;break}}if(!n){for(const[r,l]of e.entries())r%a>0&&(l.hidden=!0,l.box=void 0);return}}for(const[a,n]of e.entries())a>0&&(n.hidden=!0,n.box=void 0)}tickFormatParams(e,t,i){return{type:"number",fractionDigits:i}}datumFormatParams(e,t,i){const{datum:o,seriesId:s,legendItemName:a,key:n,source:r,property:l,domain:c,boundSeries:h}=t;return{type:"number",value:e,datum:o,seriesId:s,legendItemName:a,key:n,source:r,property:l,domain:c,boundSeries:h,fractionDigits:i}}};Ro.className="AngleNumberAxis",Ro.type="angle-number",p([Cn],Ro.prototype,"min",2),p([Cn],Ro.prototype,"max",2),p([Cn],Ro.prototype,"preferredMin",2),p([Cn],Ro.prototype,"preferredMax",2),p([Cn],Ro.prototype,"interval",2);var Dm={type:"axis",name:"angle-number",chartType:"polar",enterprise:!0,version:jM,options:XM.angleNumberAxisOptionsDefs,themeTemplate:{label:{spacing:5},gridLine:{enabled:!1}},create:e=>new Ro(e)};import{VERSION as i0,_ModuleSupport as o0}from"ag-charts-community";import{_ModuleSupport as Am}from"ag-charts-community";import{Property as s0,dateTruncationForDomain as a0,intervalEpoch as Mm,intervalMilliseconds as Im,intervalStep as Lm,intervalUnit as Nm,lowestGranularityUnitForTicks as n0,lowestGranularityUnitForValue as r0}from"ag-charts-core";var{OrdinalTimeScale:l0,ApproximateOrdinalTimeScale:c0,APPROXIMATE_THRESHOLD:h0,TimeAxisParentLevel:d0,minimumTimeAxisDatumGranularity:p0}=Am,_r=class extends Am.DiscreteTimeAxis{constructor(e){const t=new l0;super(e,t),this.parentLevel=new d0,this.accurateScale=t,this.approximateScale=new c0,this.approximateScale.setSourceScale(t),Object.defineProperty(this,"scale",{get:()=>this.getActiveScale(),configurable:!0})}get primaryLabel(){return this.parentLevel.enabled?this.parentLevel.label:void 0}get primaryTick(){return this.parentLevel.enabled?this.parentLevel.tick:void 0}getActiveScale(){const e=this.accurateScale.bandCount(this.visibleRange);return(this.accurateScale.getUniformityCache(this.visibleRange)?.isUniform??!1)&&e>=h0?this.approximateScale:this.accurateScale}processData(){super.processData();const{boundSeries:e,direction:t}=this;this.minimumTimeGranularity=p0(e,t,void 0,void 0)}tickFormatParams(e,t,i,o){o??(o=n0(t));const s=a0(e),a=Nm(o),n=Lm(o),r=Mm(o);return{type:"date",unit:a,step:n,epoch:r,truncateDate:s}}datumFormatParams(e,t,i,o,s){if(typeof e=="number"&&(e=new Date(e)),o==null){const{minimumTimeGranularity:S}=this,x=r0(e);S!=null&&Im(S)<Im(x)?o=S:o=x}const{datum:a,seriesId:n,legendItemName:r,key:l,source:c,property:h,domain:d,boundSeries:u}=t,g=Nm(o),m=Lm(o),y=Mm(o);return{type:"date",value:e,datum:a,seriesId:n,legendItemName:r,key:l,source:c,property:h,domain:d,boundSeries:u,unit:g,step:m,epoch:y,style:s}}};_r.className="OrdinalTimeAxis",_r.type="ordinal-time",p([s0],_r.prototype,"parentLevel",2);var Ch={type:"axis",name:"ordinal-time",chartType:"cartesian",enterprise:!0,version:i0,options:o0.ordinalTimeAxisOptionsDefs,themeTemplate:{groupPaddingInner:0,label:{autoRotate:!1,minSpacing:40},gridLine:{enabled:!1},interval:{placement:"between"}},create:e=>new _r(e)};import{VERSION as u0,_ModuleSupport as g0}from"ag-charts-community";import{_ModuleSupport as m0}from"ag-charts-community";import{Property as Th,ProxyPropertyOnWrite as Cm}from"ag-charts-core";import{_ModuleSupport as Br}from"ag-charts-community";import{ChartAxisDirection as y0,Property as wh,ZIndexMap as f0,isNumberEqual as x0,normalizeAngle360 as Tm,toRadians as S0}from"ag-charts-core";import{_ModuleSupport as wm}from"ag-charts-community";import{ChartAxisDirection as b0,Property as v0,clamp as Pm,isNumberEqual as k0,normalizeAngle360FromDegrees as D0}from"ag-charts-core";var{validateCrossLineValue:A0,Group:M0,Path:I0,Sector:L0,RotatableText:N0}=wm,Om=class extends Ai{constructor(){super(...arguments),this.positionAngle=void 0}};p([v0],Om.prototype,"positionAngle",2);var Ph=class extends yt{constructor(){super(),this.direction=b0.Radius,this.label=new Om,this.polygonNode=new I0,this.sectorNode=new L0,this.crossLineRange=new M0,this.labelNode=new N0,this.outerRadius=0,this.innerRadius=0,this.crossLineRange.append(this.polygonNode),this.crossLineRange.append(this.sectorNode),this.labelGroup.append(this.labelNode)}update(e){const{scale:t}=this;if(!t||!A0(this,t)){this.rangeGroup.visible=!1,this.lineGroup.visible=!1,this.labelGroup.visible=!1;return}this.updateRadii();const{innerRadius:i,outerRadius:o}=this;e&&(e=i>=this.axisInnerRadius&&o<=this.axisOuterRadius),this.rangeGroup.visible=e,this.lineGroup.visible=e,this.labelGroup.visible=e,this.updatePolygonNode(e),this.updateSectorNode(e),this.updateLabelNode(e),this.assignCrossLineGroup(this.type==="range",this.crossLineRange)}updateRadii(){const{range:e,scale:t,type:i,axisInnerRadius:o,axisOuterRadius:s}=this;if(!t)return{innerRadius:0,outerRadius:0};const a=l=>s+o-l;let n,r;if(i==="line")n=a(t.convert(this.value)),r=n;else{const l=Math.abs(t?.bandwidth??0),c=e.map(h=>t.convert(h));n=a(Math.max(...c)),r=a(Math.min(...c))+l}this.outerRadius=n,this.innerRadius=r}drawPolygon(e,t,i){for(const[o,s]of t.entries()){const a=e*Math.cos(s),n=e*Math.sin(s);o===0?i.path.moveTo(a,n):i.path.lineTo(a,n)}i.path.closePath()}updatePolygonNode(e){const{gridAngles:t,polygonNode:i,scale:o,shape:s,type:a,innerRadius:n,outerRadius:r}=this;if(!e||s!=="polygon"||!o||!t){i.visible=!1;return}i.visible=!0;const l=this.getPadding();i.path.clear(!0),this.drawPolygon(r-l,t,i);const c=t.slice().reverse(),h=a==="line"?r-l:n+l;this.drawPolygon(h,c,i),this.setSectorNodeProps(i)}updateSectorNode(e){const{axisInnerRadius:t,axisOuterRadius:i,scale:o,sectorNode:s,shape:a,innerRadius:n,outerRadius:r}=this;if(!e||a!=="circle"||!o){s.visible=!1;return}s.visible=!0,s.startAngle=0,s.endAngle=2*Math.PI;const l=this.getPadding(),c=Pm(t,n+l,i),h=Pm(t,r-l,i);s.innerRadius=Math.min(c,h),s.outerRadius=Math.max(c,h),this.setSectorNodeProps(s)}updateLabelNode(e){const{innerRadius:t,label:i,labelNode:o,scale:s,shape:a,type:n}=this;if(!e||i.enabled===!1||!i.text||!s){o.visible=!1;return}const r=D0((i.positionAngle??0)-90),l=(k0(r,0)||r>0)&&r<Math.PI,c=l?r-Math.PI/2:r+Math.PI/2;let h;const d=this.gridAngles??[];n==="line"?h=t+i.padding:a==="circle"||d.length<3?h=t-i.padding:h=t*Math.cos(Math.PI/d.length)-i.padding;const u=h*Math.cos(r),g=h*Math.sin(r);let m;n==="line"?m=l?"top":"bottom":m=l?"bottom":"top",this.setLabelNodeProps(o,u,g,m,c)}getPadding(){const{scale:e}=this;if(!e)return 0;const t=Math.abs(e.bandwidth??0),i=Math.abs(e.step??0);return e instanceof wm.BandScale?(i-t)/2:0}};Ph.className="RadiusCrossLine";var{Caption:C0,Group:T0,TransformableGroup:Rm,Path:w0,Line:Em,Selection:_m,generateTicks:P0,AxisGroupZIndexMap:O0}=Br,Oh=class extends Br.AxisLabel{constructor(){super(...arguments),this.autoRotateAngle=335}};p([wh],Oh.prototype,"autoRotate",2),p([wh],Oh.prototype,"autoRotateAngle",2);var Vr=class extends Br.PolarAxis{constructor(e,t){super(e,t),this.positionAngle=0,this.gridLineGroupSelection=_m.select(this.gridLineGroup,Em,!1),this.generatedTicks=void 0,this.headingLabelGroup=this.axisGroup.appendChild(new Rm({name:`${this.id}-Axis-heading`})),this.lineNodeGroup=this.axisGroup.appendChild(new Rm({name:`${this.id}-Axis-line`})),this.lineNode=this.lineNodeGroup.appendChild(new Em({name:`${this.id}-Axis-line`,zIndex:O0.AxisLine})),this.gridPathGroup=this.gridGroup.appendChild(new T0({name:`${this.id}-gridPaths`,zIndex:f0.AXIS_GRID})),this.gridPathSelection=_m.select(this.gridPathGroup,w0),this.headingLabelGroup.appendChild(this.title.caption.node),this.cleanup.register(this.title.caption.registerInteraction(this.moduleCtx,"afterend"))}get direction(){return y0.Radius}getAxisTransform(){const e=this.scale.range[0],{translation:t,positionAngle:i,innerRadiusRatio:o}=this,s=e*o,a=S0(i);return{translationX:t.x,translationY:t.y-e-s,rotation:a,rotationCenterX:0,rotationCenterY:e+s}}update(){super.update(),this.updateTitle(),this.updateGridLines();const{enabled:e,stroke:t,width:i}=this.line;this.lineNode.setProperties({stroke:t,strokeWidth:e?i:0,x1:0,y1:this.range[0],x2:0,y2:this.range[1]})}updatePosition(){super.updatePosition();const e=this.getAxisTransform();this.tickLineGroup.setProperties(e),this.tickLabelGroup.setProperties(e),this.lineNodeGroup.setProperties(e),this.headingLabelGroup.setProperties(e)}calculateRotations(){return{rotation:0,parallelFlipRotation:0,regularFlipRotation:-Math.PI/2}}calculateTickLayout(e,t,i){const o=[0,1],s=this.label.getSideFlag(),a=s*(this.getTickSize()+this.label.spacing+this.seriesAreaPadding),{range:n,reverse:r,defaultTickMinSpacing:l}=this,c=P0({scale:this.scale,label:this.label,interval:this.interval,tickFormatter:(...b)=>this.tickFormatter(...b),domain:e,range:n,reverse:r,niceMode:t,visibleRange:o,defaultTickMinSpacing:l,labelOffset:a,sideFlag:s,axisRotation:0,sizeLimit:void 0,primaryTickCount:void 0}),{tickData:h}=c,{ticks:d,rawTicks:u,rawTickCount:g,tickDomain:m,fractionDigits:y,niceDomain:S=e}=h,x=d.map(b=>this.getTickLabelProps(b,c));return this.generatedTicks={ticks:d,labels:x},{ticks:u,tickDomain:m,niceDomain:S,rawTickCount:g,fractionDigits:y,timeInterval:void 0}}updateSelections(){const{generatedTicks:e}=this;if(!e)return;const{ticks:t,labels:i}=e;this.gridLineGroupSelection.update(this.gridLength?t:[]),this.tickLabelGroupSelection.update(i),this.gridPathSelection.update(this.gridLine.enabled?this.prepareGridPathTickData(t):[]),this.gridLineGroupSelection.cleanup(),this.tickLabelGroupSelection.cleanup(),this.gridPathSelection.cleanup()}updateLabels(){if(!this.label.enabled)return;const e=Br.resetAxisLabelSelectionFn();this.tickLabelGroupSelection.each((t,i)=>{t.fill=i.color,t.text=i.text,t.textBaseline=i.textBaseline,t.textAlign=i.textAlign??"center",t.setFont(i),t.setBoxing(i),t.setProperties(e(t,i))})}updateGridLines(){const{gridLine:{style:e,width:t},shape:i,generatedTicks:o}=this;if(!e||!o)return;const s=e.length,a=(u,g)=>{const{stroke:m,lineDash:y}=e[g%s];u.stroke=m,u.strokeWidth=t,u.lineDash=y,u.fill=void 0},[n,r]=this.gridRange??[0,2*Math.PI],l=x0(r-n,2*Math.PI),d=i==="circle"?(u,g)=>{const{path:m}=u;m.clear(!0);const y=this.getTickRadius(g);l?(m.moveTo(y,0),m.arc(0,0,y,0,2*Math.PI)):(m.moveTo(y*Math.cos(n),y*Math.sin(n)),m.arc(0,0,y,Tm(n),Tm(r))),l&&m.closePath()}:(u,g)=>{const{path:m}=u,y=this.gridAngles;if(m.clear(!0),!y||y.length<3)return;const S=this.getTickRadius(g);for(const[x,b]of y.entries()){const f=S*Math.cos(b),v=S*Math.sin(b);x===0?m.moveTo(f,v):m.lineTo(f,v);for(const[k,A]of y.entries()){const M=S*Math.cos(A),I=S*Math.sin(A);k===0?m.moveTo(M,I):m.lineTo(M,I)}m.closePath()}m.closePath()};this.gridPathSelection.each((u,g,m)=>{a(u,m),d(u,g)})}updateTitle(){const e=n=>n.defaultValue,{title:t,range:i}=this,{formatter:o=e}=this.title;t.caption.enabled=t.enabled,t.caption.fontFamily=t.fontFamily,t.caption.fontSize=t.fontSize,t.caption.fontStyle=t.fontStyle,t.caption.fontWeight=t.fontWeight,t.caption.color=t.color,t.caption.wrapping=t.wrapping;let s=!1;const a=t.caption.node;t.enabled&&(s=!0,a.rotation=Math.PI/2,a.x=Math.floor((i[0]+i[1])/2),a.y=-C0.SMALL_PADDING,a.textAlign="center",a.textBaseline="bottom",a.text=this.cachedCallWithContext(o,this.getTitleFormatterParams(this.scale.domain))),a.visible=s}updateCrossLines(){for(const e of this.crossLines)if(e instanceof Ph){const{shape:t,gridAngles:i,range:o,innerRadiusRatio:s}=this,a=o[0];e.shape=t,e.gridAngles=i,e.axisOuterRadius=a,e.axisInnerRadius=a*s}super.updateCrossLines()}createLabel(){return new Oh}getTickLabelProps(e,t){const{label:i}=this,{rotation:o,textBaseline:s,textAlign:a}=t,n=this.scale.range,r=e.tickLabel??"",c=i.getSideFlag()*(this.getTickSize()+i.spacing+this.seriesAreaPadding),h=r!==""&&r!=null,d=o;return{...this.getLabelStyles({value:e.tick,formattedValue:e.tickLabel}),tickId:e.tickId,rotation:d,text:r,textAlign:a,textBaseline:s,visible:h,x:c,y:e.translation,rotationCenterX:c,rotationCenterY:e.translation,range:n}}};Vr.CrossLineConstructor=Ph,p([wh],Vr.prototype,"positionAngle",2);var{CategoryScale:Bm}=m0,vs=class extends Vr{constructor(e){super(e,new Bm),this.shape="circle",this.groupPaddingInner=0,this.paddingInner=0,this.paddingOuter=0}hasDefinedDomain(){return!1}normaliseDataDomain(e){return{domain:e.domain,clipped:!1}}prepareGridPathTickData(e){return e.slice().reverse()}getTickRadius(e){const{scale:t,innerRadiusRatio:i}=this,o=t.range[0],s=o*i;if(Bm.is(t)){const a=t.domain,n=a.length-1-a.indexOf(e.tick);return n===0?s:t.inset+t.step*(n-.5)+t.bandwidth/2}else{const a=(o-s)/t.domain.length;return o-e.translation+s-a/2}}tickFormatParams(){return{type:"category"}}datumFormatParams(e,t){const{datum:i,seriesId:o,legendItemName:s,key:a,source:n,property:r,domain:l,boundSeries:c}=t;return{type:"category",value:e,datum:i,seriesId:o,legendItemName:s,key:a,source:n,property:r,domain:l,boundSeries:c}}};vs.className="RadiusCategoryAxis",vs.type="radius-category",p([Th],vs.prototype,"groupPaddingInner",2),p([Cm("scale","paddingInner"),Th],vs.prototype,"paddingInner",2),p([Cm("scale","paddingOuter"),Th],vs.prototype,"paddingOuter",2);var Vm={type:"axis",name:"radius-category",chartType:"polar",enterprise:!0,version:u0,options:g0.radiusCategoryAxisOptionsDefs,themeTemplate:{positionAngle:0,line:{enabled:!1},label:{minSpacing:5}},create:e=>new vs(e)};import{VERSION as R0,_ModuleSupport as E0}from"ag-charts-community";import{_ModuleSupport as _0}from"ag-charts-community";import{Property as zr,normalisedExtentWithMetadata as B0}from"ag-charts-core";var{LinearScale:V0}=_0,ks=class extends Vr{constructor(e){super(e,new V0),this.shape="polygon"}hasDefinedDomain(){const{min:e,max:t}=this;return e!=null&&t!=null&&e<t}prepareGridPathTickData(e){const{scale:t}=this,i=t.domain[1];return e.filter(({tick:o})=>o!==i).sort((o,s)=>s.tick-o.tick)}getTickRadius(e){const{scale:t}=this,i=t.range[0],o=i*this.innerRadiusRatio;return i-e.translation+o}normaliseDataDomain(e){const{min:t,max:i,preferredMin:o,preferredMax:s}=this,{extent:a,clipped:n}=B0(e.domain,t,i,o,s,void 0,e.sortMetadata?.sortOrder);return{domain:a,clipped:n}}getDomainExtentsNice(){return[this.min==null&&this.nice,this.max==null&&this.nice]}tickFormatParams(e,t,i){return{type:"number",fractionDigits:i}}datumFormatParams(e,t,i){const{datum:o,seriesId:s,legendItemName:a,key:n,source:r,property:l,domain:c,boundSeries:h}=t;return{type:"number",value:e,datum:o,seriesId:s,legendItemName:a,key:n,source:r,property:l,domain:c,boundSeries:h,fractionDigits:i}}};ks.className="RadiusNumberAxis",ks.type="radius-number",p([zr],ks.prototype,"min",2),p([zr],ks.prototype,"max",2),p([zr],ks.prototype,"preferredMin",2),p([zr],ks.prototype,"preferredMax",2);var zm={type:"axis",name:"radius-number",chartType:"polar",enterprise:!0,version:R0,options:E0.radiusNumberAxisOptionsDefs,themeTemplate:{positionAngle:0,line:{enabled:!1},shape:{$findFirstSiblingNotOperation:void 0},label:{minSpacing:5}},create:e=>new ks(e)};import{VERSION as z0}from"ag-charts-community";import{boolean as F0,positiveNumber as Fm,undocumented as H0}from"ag-charts-core";import"ag-charts-community";import{AbstractModuleInstance as W0,ObserveChanges as Rh,Property as Eh}from"ag-charts-core";var Fr=class extends W0{constructor(e){super(),this.ctx=e,this.enabled=!0,e.animationManager.skip(!1),this.cleanup.register(()=>e.animationManager.skip(!0))}};p([Rh((e,t)=>{e.ctx.animationManager.skip(!t)}),Eh],Fr.prototype,"enabled",2),p([Rh((e,t)=>{t!=null&&(e.ctx.animationManager.defaultDuration=t)}),Eh],Fr.prototype,"duration",2),p([Rh((e,t)=>{e.ctx.animationManager.maxAnimatableItems=t??1/0}),Eh],Fr.prototype,"maxAnimatableItems",2);var Tn={type:"plugin",name:"animation",enterprise:!0,version:z0,options:{enabled:F0,duration:Fm},themeTemplate:{enabled:!0},create:e=>new Fr(e)};Tn.options.maxAnimatableItems=H0(Fm);import{VERSION as K0,_ModuleSupport as G0}from"ag-charts-community";import"ag-charts-core";import{_ModuleSupport as $0}from"ag-charts-community";import{AbstractModuleInstance as Y0}from"ag-charts-core";var Hm=class wr extends Y0{constructor(t){super(),this.ctx=t,this.activeSections=new Set,this.sectionButtons={annotations:[],chartToolbar:[]},this.container=this.ctx.domManager.addChild("canvas-overlay","shared-toolbar"),this.container.role="presentation"}getSharedToolbar(t){return this.sharedToolbar||this.createSharedToolbar(),t==="chartToolbar"&&this.sharedToolbar&&this.sharedToolbar.setAriaLabelId("ariaLabelFinancialCharts"),this.toolbarWithSection(t)}createSharedToolbar(){this.sharedToolbar=new $0.Toolbar(this.ctx,"ariaLabelAnnotationsToolbar","vertical"),this.sharedToolbar.addClass("ag-charts-shared-toolbar"),this.container.append(this.sharedToolbar.getElement()),this.cleanup.register(()=>{this.sharedToolbar&&(this.sharedToolbar.getElement().remove(),this.sharedToolbar.destroy(),this.sharedToolbar=void 0)})}toolbarWithSection(t){const i=this.sharedToolbar,o={layout:(s,a)=>{if(this.firstLayoutSection!=null&&this.firstLayoutSection!==t&&this.activeSections.has(this.firstLayoutSection))return;this.firstLayoutSection=t;const n=i.getBounds().width;i.setBounds({x:s.x,y:s.y,width:n}),s.shrink({left:n+i.horizontalSpacing+(a??0)})},addToolbarListener:(s,a)=>i.addToolbarListener(s,n=>{const r=this.getSectionIndex(t,n.button.index);if(r<0)return;const l={...n,button:this.sectionButtons[t][r]};a(l)}),updateButtons:s=>{this.sectionButtons[t]=s;const a=wr.SECTION_ORDER.flatMap(n=>this.sectionButtons[n]);i.updateButtons(a)},updateButtonByIndex:(s,a)=>{i.updateButtonByIndex(this.getIndex(t,s),a)},toggleActiveButtonByIndex:s=>{i.toggleActiveButtonByIndex(this.getIndex(t,s))},toggleButtonEnabledByIndex:(s,a)=>{i.toggleButtonEnabledByIndex(this.getIndex(t,s),a)},setHidden:s=>{s?this.activeSections.delete(t):this.activeSections.add(t);let a=0;for(const n of wr.SECTION_ORDER){if(n!==t){a+=this.sectionButtons[n].length;continue}for(const r of this.sectionButtons[t].keys())i.setButtonHiddenByIndex(a+r,s)}},destroy:()=>{o.setHidden(!0),this.activeSections.size===0&&this.destroy()},clearActiveButton:i.clearActiveButton.bind(i),addListener:i.addListener.bind(i),removeListener:i.removeListener.bind(i)};return o.setHidden(!1),o}getIndex(t,i){let o=0;for(const s of wr.SECTION_ORDER){if(s===t)return o+i;o+=this.sectionButtons[s].length}return-1}getSectionIndex(t,i){let o=0;for(const s of wr.SECTION_ORDER){if(s===t)return i>=o+this.sectionButtons[t].length?-1:i-o;o+=this.sectionButtons[s].length}return-1}};Hm.SECTION_ORDER=["chartToolbar","annotations"];var Wm=Hm;import{_ModuleSupport as Hr}from"ag-charts-community";import{AbstractModuleInstance as U0,ChartAxisDirection as _h,ChartUpdateType as j0,ObserveChanges as X0,PropertiesArray as Z0,Property as wn,Vec2 as Ds,isValidDate as Bh}from"ag-charts-core";import{_ModuleSupport as q0}from"ag-charts-community";import{CleanupRegistry as Q0,attachListener as J0,focusCursorAtEnd as eI,setAttributes as tI}from"ag-charts-core";var iI='<div contenteditable="plaintext-only" class="ag-charts-text-input__textarea" tabindex="0"></div>',Km="text-input",Gm="canvas-overlay",oI=class{constructor(e){this.ctx=e,this.cleanup=new Q0,this.layout={getTextInputCoords:()=>({x:0,y:0}),getTextPosition:()=>"center",alignment:"center",textAlign:"center"},this.visible=!1,this.element=e.domManager.addChild(Gm,Km),this.element.classList.add("ag-charts-text-input"),this.cleanup.register(()=>e.domManager.removeChild(Gm,Km))}setKeyDownHandler(e){this.cleanup.register(J0(this.element,"keydown",e))}show(e){this.element.innerHTML=iI;const t=this.element.firstElementChild;tI(t,{role:"textbox","data-preventdefault":!1}),t.isContentEditable||(t.contentEditable="true"),t.setAttribute("placeholder",this.ctx.localeManager.t(e.placeholderText??"inputTextareaPlaceholder")),e.styles?.placeholderColor&&t.style.setProperty("--placeholder-text-color",e.styles?.placeholderColor),t.innerText=e.text??"",t.style.color=e.styles?.color??"inherit",t.style.fontFamily=e.styles?.fontFamily??"inherit",t.style.fontSize=e.styles?.fontSize?`${e.styles.fontSize}px`:"inherit",t.style.fontStyle=e.styles?.fontStyle??"inherit",t.style.fontWeight=typeof e.styles?.fontWeight=="number"?`${e.styles.fontWeight}`:e.styles?.fontWeight??"inherit",eI(t),t.addEventListener("input",()=>{this.updatePosition(),e.onChange?.(this.getValue(),this.getBBox())}),t.addEventListener("click",i=>{i.stopPropagation()}),e.layout&&(this.layout=e.layout,this.updatePosition()),e.onChange?.(this.getValue(),this.getBBox()),this.visible=!0}hide(){this.element.innerHTML="",this.layout={getTextInputCoords:()=>({x:0,y:0}),getTextPosition:()=>"center",alignment:"center",textAlign:"center"},this.visible=!1}isVisible(){return this.visible}updateColor(e){this.element.firstElementChild&&(this.element.firstElementChild.style.color=e)}updateFontSize(e){if(this.element.firstElementChild)return this.element.firstElementChild.style.fontSize=`${e}px`,this.updatePosition(),this.getBBox()}getValue(){if(this.element.firstElementChild)return this.element.firstElementChild.innerText.trim()}updatePosition(){const{element:e}=this,t=e.firstElementChild;if(!t)return;const i=this.ctx.domManager.getBoundingClientRect(),{width:o,getTextInputCoords:s,getTextPosition:a,alignment:n,textAlign:r}=this.layout;e.style.setProperty("width",o?`${o}px`:"unset");const l=t.getBoundingClientRect(),c=s(l.height);let h=c.x;n==="center"?h-=(o??l.width)/2:n==="right"&&(h-=o??l.width);const d=a();let u=c.y;d==="center"?u-=l.height/2:d==="bottom"&&(u-=l.height),e.style.setProperty("top",`${u}px`),e.style.setProperty("left",`${h}px`),e.style.setProperty("max-width",`${i.width-h}px`),e.style.setProperty("text-align",n),t.style.setProperty("text-align",r)}getBBox(){const{left:e,top:t,width:i,height:o}=this.element.getBoundingClientRect();return new q0.BBox(e,t,i,o)}destroy(){this.cleanup.flush()}};import{BaseProperties as sI,Property as $m}from"ag-charts-core";var Vh=class extends sI{constructor(){super(...arguments),this.enabled=!1,this.axes="y"}};p([$m],Vh.prototype,"enabled",2),p([$m],Vh.prototype,"axes",2);import"ag-charts-community";import{deepClone as ri}from"ag-charts-core";var zh=(e=>(e.Line="line",e.HorizontalLine="horizontal-line",e.VerticalLine="vertical-line",e.DisjointChannel="disjoint-channel",e.ParallelChannel="parallel-channel",e.FibonacciRetracement="fibonacci-retracement",e.FibonacciRetracementTrendBased="fibonacci-retracement-trend-based",e.Callout="callout",e.Comment="comment",e.Note="note",e.Text="text",e.Arrow="arrow",e.ArrowUp="arrow-up",e.ArrowDown="arrow-down",e.DateRange="date-range",e.PriceRange="price-range",e.DatePriceRange="date-price-range",e.QuickDatePriceRange="quick-date-price-range",e))(zh||{}),aI=Object.values(zh);function nI(e){for(const t of aI)if(t===e)return t}import{isObject as rI}from"ag-charts-core";import{Color as Ym,Property as lI,isObject as cI}from"ag-charts-core";import"ag-charts-community";import{BaseProperties as Eo,FONT_SIZE as hI,Property as Z,generateUUID as dI}from"ag-charts-core";var Pn=class extends Eo{};p([Z],Pn.prototype,"x",2),p([Z],Pn.prototype,"y",2);var pI=class extends ft(no(Zm(Eo))){},Fh=class extends ft(no(Vi(Kh(Is(Eo))))){constructor(){super(...arguments),this.cornerRadius=2}};p([Z],Fh.prototype,"enabled",2),p([Z],Fh.prototype,"cornerRadius",2);var uI=class extends Vi(Eo){},gI=class extends ft(no(Vi(Eo))){},As=class extends Is(Eo){constructor(){super(...arguments),this.label="",this.position="top",this.alignment="left"}};p([Z],As.prototype,"label",2),p([Z],As.prototype,"position",2),p([Z],As.prototype,"alignment",2);var mI=class extends Is(Eo){},On=class extends Is(Eo){constructor(){super(...arguments),this.label=""}};p([Z],On.prototype,"label",2),p([Z],On.prototype,"position",2),p([Z],On.prototype,"alignment",2);function Ms(e){class t extends fI(Zm(e)){constructor(){super(...arguments),this.id=dI()}}return t}function Hh(e){class t extends e{constructor(){super(...arguments),this.start=new Pn,this.end=new Pn}}return p([Z],t.prototype,"start",2),p([Z],t.prototype,"end",2),t}function Um(e){class t extends e{}return p([Z],t.prototype,"x",2),p([Z],t.prototype,"y",2),t}function jm(e){class t extends e{}return p([Z],t.prototype,"value",2),t}function Wh(e){class t extends e{constructor(){super(...arguments),this.background=new uI}}return p([Z],t.prototype,"background",2),t}function _o(e){class t extends e{constructor(){super(...arguments),this.handle=new gI}}return p([Z],t.prototype,"handle",2),t}function Xm(e){class t extends e{constructor(){super(...arguments),this.axisLabel=new Fh}}return p([Z],t.prototype,"axisLabel",2),t}function Kh(e){class t extends e{constructor(){super(...arguments),this.padding=void 0,this.textAlign="center",this.formatter=void 0}}return p([Z],t.prototype,"padding",2),p([Z],t.prototype,"textAlign",2),p([Z],t.prototype,"formatter",2),t}function yI(e){class t extends e{}return t}function Gh(e){class t extends e{}return p([Z],t.prototype,"extendStart",2),p([Z],t.prototype,"extendEnd",2),t}function fI(e){class t extends e{isWriteable(){return!this.locked&&!this.readOnly}isHoverable(){return!this.readOnly}}return p([Z],t.prototype,"locked",2),p([Z],t.prototype,"readOnly",2),t}function $h(e){class t extends e{setLocaleManager(o){this.localeManager??(this.localeManager=o)}}return t}function Zm(e){class t extends e{}return p([Z],t.prototype,"visible",2),t}function Vi(e){class t extends e{}return p([Z],t.prototype,"fill",2),p([Z],t.prototype,"fillOpacity",2),t}function ft(e){class t extends e{}return p([Z],t.prototype,"stroke",2),p([Z],t.prototype,"strokeOpacity",2),p([Z],t.prototype,"strokeWidth",2),t}function no(e){class t extends e{constructor(){super(...arguments),this.lineCap=void 0,this.computedLineDash=void 0}}return p([Z],t.prototype,"lineDash",2),p([Z],t.prototype,"lineDashOffset",2),p([Z],t.prototype,"lineStyle",2),t}function Is(e){class t extends e{constructor(){super(...arguments),this.fontSize=hI.SMALL,this.fontFamily="Verdana, sans-serif"}}return p([Z],t.prototype,"fontStyle",2),p([Z],t.prototype,"fontWeight",2),p([Z],t.prototype,"fontSize",2),p([Z],t.prototype,"fontFamily",2),p([Z],t.prototype,"color",2),t}import{Property as xI}from"ag-charts-core";import{isDate as SI,isNumber as bI,isString as vI}from"ag-charts-core";function qm(e){return bI(e)||vI(e)||SI(e)?{value:e,groupPercentage:0}:e??{value:void 0,groupPercentage:0}}function We(e){return qm(e)?.value}function Mt(e,t){if(e.start==null||e.end==null)return;const i=De(e.start,t),o=De(e.end,t);if(!(i==null||o==null))return{x1:i.x,y1:i.y,x2:o.x,y2:o.y}}function De(e,t){const i=ro(e.x,t.xAxis),o=ro(e.y,t.yAxis);return{x:i,y:o}}function ro(e,t){if(e==null)return 0;const{value:i,groupPercentage:o}=qm(e),{scale:s,snapToGroup:a}=t,n=s.bandwidth===0?s.step??0:s.bandwidth??0,r=a?n/2:n*o;return s.convert(i)+r}function It(e,t){const i=Wr(e.x,t.xAxis),o=Wr(e.y,t.yAxis);return{x:i,y:o}}function Wr(e,t){const{scale:i}=t;if(t.continuous&&i.step==null)return t.scaleInvert(e);const o=t.scaleInvertNearest(e),s=i.bandwidth===0?i.step:i.bandwidth??0,a=i.convert(o),n=a+s,r=a===n?0:(e-a)/(n-a);return{value:o,groupPercentage:r}}import{BaseProperties as kI}from"ag-charts-core";var Yh=class extends Ms(Hh(_o(kI))){constructor(){super(...arguments),this.snapToAngle=45}getDefaultColor(e){}getDefaultOpacity(e){}},Qm=class extends $h(Kh(Is(Yh))){constructor(){super(...arguments),this.text="",this.position="top",this.alignment="left",this.placement="inside",this.placeholderText="inputTextareaPlaceholder"}getDefaultColor(e){return this.color}getDefaultOpacity(e){}getPlaceholderColor(){}getPadding(){const{padding:e=0}=this;return{top:e,right:e,bottom:e,left:e}}getText(){const e=this.text.length==0;let t=this.text;return e&&(t=this.placeholderText??"",this.localeManager&&(t=this.localeManager.t(t))),{text:t,isPlaceholder:e}}getTextInputCoords(e,t){return De(this.end,e)}getTextPosition(){return this.position}};p([xI],Qm.prototype,"text",2);var DI={top:6,right:12,bottom:9,left:12},Mi=class extends Vi(ft(Qm)){constructor(){super(...arguments),this.type="callout",this.position="bottom",this.alignment="left"}static is(e){return cI(e)&&e.type==="callout"}getDefaultColor(e){switch(e){case"fill-color":return this.fill;case"line-color":return this.stroke;case"text-color":default:return this.color}}getDefaultOpacity(e){switch(e){case"fill-color":return this.fillOpacity;case"line-color":return this.strokeOpacity;case"text-color":default:return}}getPlaceholderColor(){const{r:e,g:t,b:i}=Ym.fromString(this.color??"#888888");return new Ym(e,t,i,.66).toString()}getPadding(){const{padding:e}=this;return e==null?{...DI}:{top:e,right:e,bottom:e,left:e}}getTextInputCoords(e,t){const i=super.getTextInputCoords(e,t),o=this.getPadding(),s=o.left??0,a=o.bottom??0;return{x:i.x+s,y:i.y-a}}};p([lI],Mi.prototype,"type",2);import{Color as Jm,Property as AI,isObject as MI}from"ag-charts-core";import{BaseProperties as II,Property as LI}from"ag-charts-core";var Kr=class extends Ms(Um(_o(Kh(Is(II))))){constructor(){super(...arguments),this.text="",this.position="top",this.alignment="left",this.placement="inside",this.placeholderText="inputTextareaPlaceholder"}getDefaultColor(e){return this.color}getDefaultOpacity(e){}getPlaceholderColor(){}getPadding(){const{padding:e=0}=this;return{top:e,right:e,bottom:e,left:e}}getText(){const e=this.text.length==0;return{text:e?this.placeholderText??"":this.text,isPlaceholder:e}}getTextInputCoords(e,t){return De(this,e)}getTextPosition(){return this.position}};p([LI],Kr.prototype,"text",2);var Gr={top:8,right:14,bottom:8,left:14},zi=class extends Vi(ft(Kr)){constructor(){super(...arguments),this.type="comment",this.position="bottom",this.alignment="left"}static is(e){return MI(e)&&e.type==="comment"}getDefaultColor(e){switch(e){case"fill-color":return this.fill;case"line-color":return this.stroke;case"text-color":default:return this.color}}getDefaultOpacity(e){switch(e){case"fill-color":return this.fillOpacity;case"line-color":return this.strokeOpacity;case"text-color":default:return}}getPlaceholderColor(){const{r:e,g:t,b:i}=Jm.fromString(this.color??"#888888");return new Jm(e,t,i,.66).toString()}getPadding(){const{padding:e,fontSize:t}=this;return e==null?{top:Math.max(t*.4,Gr.top),bottom:Math.max(t*.4,Gr.bottom),left:Math.max(t*.8,Gr.left),right:Math.max(t*.8,Gr.right)}:{top:e,right:e,bottom:e,left:e}}getTextInputCoords(e,t){const i=super.getTextInputCoords(e,t),o=this.getPadding();return{x:i.x+o.left,y:i.y-o.bottom}}};p([AI],zi.prototype,"type",2);import"ag-charts-community";import{BaseProperties as Uh,Property as Rt,isObject as $r}from"ag-charts-core";import{Vec2 as Ls}from"ag-charts-core";function Rn(e,t){return e?"dashed":t??"solid"}function ey(e,t){switch(t){case"solid":return[];case"dashed":return[e*4,e*2];case"dotted":return[0,e*2]}}function fa(e,t,i,o){const s=Rn(e,i);return t??e??ey(o??1,s)}function xa(e,t,i){const o=Rn(t,i);return e??o==="dotted"?"round":void 0}function NI(e,t){const[i,o]=Ls.from(e),s=t.height,a=Ls.gradient(o,i,s),n=Ls.intercept(o,a,s),r=[{x:i.x,y:s??0},{x:i.x,y:s==null?t.height:s-t.height}];if(a===1/0)return r;let l=[Ls.intersectAtY(a,n,0,s),Ls.intersectAtY(a,n,t.height,s),Ls.intersectAtX(a,n,0,s),Ls.intersectAtX(a,n,t.width,s)];return l=l.filter(c=>c.x>=t.x&&c.x<=t.width&&c.y>=t.y&&c.y<=t.height).sort((c,h)=>c.x===h.x?0:c.x<h.x?-1:1),l.length!==2?r:l}var CI=class extends ft(Uh){},jh=class extends Is(Vi(ft(Uh))){constructor(){super(...arguments),this.divider=new CI}};p([Rt],jh.prototype,"divider",2);var Xh=class extends Vi(ft(_o(Uh))){constructor(){super(...arguments),this.statistics=new jh}};p([Rt],Xh.prototype,"statistics",2);var Sa=class extends $h(Wh(ft(no(Yh)))){constructor(){super(...arguments),this.direction="both",this.hasDateRange=!1,this.hasPriceRange=!1,this.statistics=new jh,this.getVolume=()=>{},this.text=new As}getDefaultColor(e){switch(e){case"fill-color":return this.background.fill;case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(e){switch(e){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return fa(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return xa(this.lineCap,this.lineDash,this.lineStyle)}};p([Rt],Sa.prototype,"statistics",2),p([Rt],Sa.prototype,"text",2);function Zh(e){class t extends e{constructor(){super(...arguments),this.hasDateRange=!0}}return t}function qh(e){class t extends e{constructor(){super(...arguments),this.hasPriceRange=!0}}return t}var li=class extends Zh(Sa){constructor(){super(...arguments),this.type="date-range",this.direction="horizontal"}static is(e){return $r(e)&&e.type==="date-range"}};p([Rt],li.prototype,"type",2),p([Rt],li.prototype,"extendAbove",2),p([Rt],li.prototype,"extendBelow",2);var ci=class extends qh(Sa){constructor(){super(...arguments),this.type="price-range",this.direction="vertical"}static is(e){return $r(e)&&e.type==="price-range"}};p([Rt],ci.prototype,"type",2),p([Rt],ci.prototype,"extendLeft",2),p([Rt],ci.prototype,"extendRight",2);var lo=class extends Zh(qh(Sa)){constructor(){super(...arguments),this.type="date-price-range",this.direction="both"}static is(e){return $r(e)&&e.type==="date-price-range"}};p([Rt],lo.prototype,"type",2);var Gt=class extends Zh(qh(Sa)){constructor(){super(...arguments),this.type="quick-date-price-range",this.up=new Xh,this.down=new Xh,this.direction="both"}static is(e){return $r(e)&&e.type==="quick-date-price-range"}};p([Rt],Gt.prototype,"type",2),p([Rt],Gt.prototype,"up",2),p([Rt],Gt.prototype,"down",2);import{BaseProperties as TI,Property as ty,clamp as wI,isObject as PI}from"ag-charts-core";import{_ModuleSupport as OI}from"ag-charts-community";import{cachedTextMeasurer as RI,calcLineHeight as iy,wrapText as EI}from"ag-charts-core";var{BBox:_I}=OI,Yr=1.38;function Ur(e,t,i){return i?EI(t,{maxWidth:i,font:e,textWrap:"always",avoidOrphans:!1}):t}function BI(e,t){const{lineMetrics:i,width:o}=RI(e).measureLines(t),s=i.length*iy(e.fontSize,Yr);return{width:o,height:s}}function Qh(e,t,i,o){let s=o?.width??0,a=o?.height??0;if(!o){const n=e.width==null?t:Ur(e,t,e.width);({width:s,height:a}=BI(e,n))}return new _I(i.x,i.y,s,a)}function oy(e,t,i,o,{x:s,y:a},n){const{visible:r=!0,fontFamily:l,fontSize:c=14,fontStyle:h,fontWeight:d,textAlign:u}=o,g=iy(c,Yr);n??(n=o.position=="center"?"middle":o.position);const m=i?o.getPlaceholderColor():o.color;e.setProperties({x:s,y:a,visible:r,text:t,fill:m,fontFamily:l,fontSize:c,fontStyle:h,fontWeight:d,textAlign:u,lineHeight:g,textBaseline:n})}var VI=10,zI=11,sy=20,FI=22,HI=10,ay=sy+HI,ny=34,WI=class extends Vi(ft(TI)){},Et=class extends Vi(ft(Kr)){constructor(){super(...arguments),this.type="note",this.background=new WI,this.position="bottom",this.alignment="center",this.width=200}static is(e){return PI(e)&&e.type==="note"}getDefaultColor(e){switch(e){case"line-color":return this.fill;case"text-color":return this.color}}getDefaultOpacity(e){switch(e){case"line-color":return this.fillOpacity;case"text-color":return}}getPadding(){const e=this.padding??VI;return{top:e,right:e,bottom:e,left:e}}getTextInputCoords(e,t){const{width:i,text:o}=this,s=super.getTextInputCoords(e,t),a=this.getPadding().top,n=Qh(this,o,s);n.x=wI(i/2,n.x,e.seriesRect.width-i/2);const r=n.y-ay-a*2,l=n.y+zI+a*2,c=Math.max(n.height,t);return r-c-ny<0?(n.y=l,this.position="top"):(n.y=r+a,this.position="bottom"),{x:n.x,y:n.y}}isHoverable(){return!0}};p([ty],Et.prototype,"type",2),p([ty],Et.prototype,"background",2);import{BaseProperties as KI}from"ag-charts-core";var GI=class extends Ms(Um(_o(KI))){getDefaultColor(e){}getDefaultOpacity(e){}},Jh=class UA extends Vi(GI){constructor(){super(...arguments),this.size=32}static is(t){return t instanceof UA}getDefaultColor(t){return t==="fill-color"?this.fill:void 0}getDefaultOpacity(t){return t==="fill-color"?this.fillOpacity:void 0}};import"ag-charts-community";import{BaseProperties as ry,Property as jr,isObject as ly}from"ag-charts-core";var xt=class extends Ms(jm(_o(Xm(ft(no(ry)))))){constructor(){super(...arguments),this.direction="horizontal",this.type="horizontal-line",this.text=new As}static is(e){return ly(e)&&e.type==="horizontal-line"}getDefaultColor(){return this.stroke}getDefaultOpacity(){return this.strokeOpacity}getLineDash(){return fa(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return xa(this.lineCap,this.lineDash,this.lineStyle)}};p([jr],xt.prototype,"type",2),p([jr],xt.prototype,"text",2);var Fi=class extends Ms(jm(_o(Xm(ft(no(ry)))))){constructor(){super(...arguments),this.direction="vertical",this.type="vertical-line",this.text=new As}static is(e){return ly(e)&&e.type==="vertical-line"}getDefaultColor(){return this.stroke}getDefaultOpacity(){return this.strokeOpacity}getLineDash(){return fa(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return xa(this.lineCap,this.lineDash,this.lineStyle)}};p([jr],Fi.prototype,"type",2),p([jr],Fi.prototype,"text",2);import"ag-charts-community";import{BaseProperties as $I,Logger as YI,Property as Xr,isObject as UI}from"ag-charts-core";var hi=class extends Ms(Wh(Hh(_o(Gh(ft(no($I))))))){constructor(){super(...arguments),this.type="disjoint-channel",this.text=new On,this.snapToAngle=45}static is(e){return UI(e)&&e.type==="disjoint-channel"}get bottom(){const e={start:{x:this.start.x,y:this.start.y},end:{x:this.end.x,y:this.end.y}};return typeof e.start.y=="number"&&typeof e.end.y=="number"?(e.start.y-=this.startHeight,e.end.y-=this.endHeight):YI.warnOnce(`Annotation [${this.type}] can only be used with a numeric y-axis.`),e}getDefaultColor(e){switch(e){case"fill-color":return this.background.fill;case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(e){switch(e){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return fa(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return xa(this.lineCap,this.lineDash,this.lineStyle)}};p([Xr],hi.prototype,"type",2),p([Xr],hi.prototype,"startHeight",2),p([Xr],hi.prototype,"endHeight",2),p([Xr],hi.prototype,"text",2);import{Property as cy,isObject as jI}from"ag-charts-core";import{Property as Ns}from"ag-charts-core";import"ag-charts-community";import{Property as ed,isObject as hy}from"ag-charts-core";var Zr=class extends $h(yI(Gh(ft(no(Yh))))){constructor(){super(...arguments),this.text=new As}getDefaultColor(e){switch(e){case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(){return this.strokeOpacity}getLineDash(){return fa(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return xa(this.lineCap,this.lineDash,this.lineStyle)}};p([ed],Zr.prototype,"text",2);var co=class extends Zr{constructor(){super(...arguments),this.type="arrow",this.endCap="arrow"}static is(e){return hy(e)&&e.type==="arrow"}};p([ed],co.prototype,"type",2);var ho=class extends Zr{constructor(){super(...arguments),this.type="line"}static is(e){return hy(e)&&e.type==="line"}};p([ed],ho.prototype,"type",2);var po=class extends Zr{constructor(){super(...arguments),this.label=new mI,this.reverse=!1,this.showFill=!0,this.isMultiColor=!0,this.strokes=[],this.bands=10}getDefaultColor(e){switch(e){case"line-color":return this.rangeStroke??this.stroke;case"text-color":return this.text.color}}};p([Ns],po.prototype,"label",2),p([Ns],po.prototype,"reverse",2),p([Ns],po.prototype,"showFill",2),p([Ns],po.prototype,"isMultiColor",2),p([Ns],po.prototype,"strokes",2),p([Ns],po.prototype,"rangeStroke",2),p([Ns],po.prototype,"bands",2);var Hi=class extends po{constructor(){super(...arguments),this.type="fibonacci-retracement-trend-based",this.endRetracement=new Pn}static is(e){return jI(e)&&e.type==="fibonacci-retracement-trend-based"}};p([cy],Hi.prototype,"type",2),p([cy],Hi.prototype,"endRetracement",2);import{Property as XI,isObject as ZI}from"ag-charts-core";var uo=class extends po{constructor(){super(...arguments),this.type="fibonacci-retracement"}static is(e){return ZI(e)&&e.type==="fibonacci-retracement"}};p([XI],uo.prototype,"type",2);import"ag-charts-community";import{BaseProperties as qI,Logger as QI,Property as qr,isObject as JI}from"ag-charts-core";var di=class extends Ms(Wh(Hh(_o(Gh(ft(no(qI))))))){constructor(){super(...arguments),this.type="parallel-channel",this.middle=new pI,this.text=new On,this.snapToAngle=45}static is(e){return JI(e)&&e.type==="parallel-channel"}get bottom(){const e={start:{x:this.start.x,y:this.start.y},end:{x:this.end.x,y:this.end.y}};return typeof e.start.y=="number"&&typeof e.end.y=="number"?(e.start.y-=this.height,e.end.y-=this.height):QI.warnOnce(`Annotation [${this.type}] can only be used with a numeric y-axis.`),e}getDefaultColor(e){switch(e){case"fill-color":return this.background.fill;case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(e){switch(e){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return fa(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return xa(this.lineCap,this.lineDash,this.lineStyle)}};p([qr],di.prototype,"type",2),p([qr],di.prototype,"height",2),p([qr],di.prototype,"middle",2),p([qr],di.prototype,"text",2);import{Property as eL,isObject as tL}from"ag-charts-core";var go=class extends Kr{constructor(){super(...arguments),this.type="text",this.position="bottom"}static is(e){return tL(e)&&e.type==="text"}};p([eL],go.prototype,"type",2);function Bo(e){return Gt.is(e)}function Qr(e){return ho.is(e)||xt.is(e)||Fi.is(e)||co.is(e)||dy(e)}function mo(e){return hi.is(e)||di.is(e)}function dy(e){return uo.is(e)||Hi.is(e)}function Wi(e){return Mi.is(e)||zi.is(e)||Et.is(e)||go.is(e)}function En(e){return li.is(e)||ci.is(e)||lo.is(e)||Gt.is(e)}function td(e){return Wi(e)&&!Et.is(e)}function Vo(e){return Qr(e)||mo(e)||En(e)&&!Gt.is(e)}function iL(e){return Qr(e)||mo(e)||En(e)||Mi.is(e)||Et.is(e)}function oL(e){return Et.is(e)}function sL(e){return mo(e)||En(e)||Mi.is(e)||zi.is(e)||Jh.is(e)}function aL(e){return Wi(e)&&!Et.is(e)}function ba(e){return(Qr(e)||mo(e)||En(e))&&!Bo(e)&&rI(e.text)}function nL(e,t){"fontSize"in e&&(e.fontSize=t),ba(e)&&(e.text.fontSize=t)}function py(e,t){const i=t?.strokeWidth??e.strokeWidth??1,o=t?.type??e.lineStyle,s=o??Rn(e.lineDash,o),a=ey(i,s);e.strokeWidth=i,e.computedLineDash=a,e.lineStyle=s,e.lineCap=s==="dotted"?"round":void 0}function Jr(e,t,i,o,s,a){switch(t){case"fill-color":{"fill"in e&&(e.fill=o),"fillOpacity"in e&&(e.fillOpacity=s),"background"in e&&(e.background.fill=o,e.background.fillOpacity=s);break}case"line-color":{"axisLabel"in e&&(e.axisLabel.fill=o,e.axisLabel.fillOpacity=s,e.axisLabel.stroke=o,e.axisLabel.strokeOpacity=s),"fill"in e&&"fillOpacity"in e&&oL(e)?(e.fill=o,e.fillOpacity=s):("strokeOpacity"in e&&(e.strokeOpacity=s),"isMultiColor"in e&&"rangeStroke"in e?(e.isMultiColor=a,e.rangeStroke=o):"stroke"in e&&(e.stroke=o));break}case"text-color":{"color"in e&&(e.color=i),ba(e)&&(e.text.color=o);break}}}var rL=class{constructor(){this.mementoOriginatorKey="annotation-defaults",this.colors=new Map(Object.values(zh).map(e=>[e,new Map([["line-color",void 0],["fill-color",void 0],["text-color",void 0]])])),this.fontSizes=new Map([["callout",void 0],["comment",void 0],["text",void 0],["arrow",void 0],["line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineStyles=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineTextAlignments=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineTextPositions=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.fibonacciOptions=new Map([["fibonacci-retracement",{bands:void 0,reverse:void 0,showFill:void 0}],["fibonacci-retracement-trend-based",{bands:void 0,reverse:void 0,showFill:void 0}]])}createMemento(){return{colors:ri(this.colors),fontSizes:ri(this.fontSizes),lineStyles:ri(this.lineStyles),lineTextAlignments:ri(this.lineTextAlignments),lineTextPositions:ri(this.lineTextPositions),fibonacciOptions:ri(this.fibonacciOptions)}}guardMemento(e){return!0}restoreMemento(e,t,i){this.colors=ri(i.colors),this.fontSizes=ri(i.fontSizes),this.lineStyles=ri(i.lineStyles),this.lineTextAlignments=ri(i.lineTextAlignments),this.lineTextPositions=ri(i.lineTextPositions),this.fibonacciOptions=ri(i.fibonacciOptions)}setDefaultColor(e,t,i,o,s,a){this.colors.get(e)?.set(t,[i,o,s,a])}setDefaultFontSize(e,t){this.fontSizes.set(e,t)}setDefaultLineStyleType(e,t){const i=this.lineStyles.get(e);i?i.type=t:this.lineStyles.set(e,{type:t})}setDefaultLineStyleWidth(e,t){const i=this.lineStyles.get(e);i?i.strokeWidth=t:this.lineStyles.set(e,{strokeWidth:t})}setDefaultLineTextAlignment(e,t){this.lineTextAlignments.set(e,t)}setDefaultLineTextPosition(e,t){this.lineTextPositions.set(e,t)}setDefaultFibonacciOptions(e,t,i){if(e!="fibonacci-retracement"&&e!="fibonacci-retracement-trend-based")return;const o=this.fibonacciOptions.get(e);o[t]=i,this.fibonacciOptions.set(e,o)}applyDefaults(e){for(const[t,i]of this.colors)if(e.type===t)for(const[o,[s,a,n,r]=[]]of i)s&&a&&n!=null&&r!=null&&Jr(e,o,s,a,n,r);for(const[t,i]of this.fontSizes)e.type!==t||i==null||nL(e,i);for(const[t,i]of this.lineStyles)e.type!==t||i==null||py(e,i);for(const[t,i]of this.lineTextPositions)e.type!==t||i==null||(e.text.position=i);for(const[t,i]of this.lineTextAlignments)e.type!==t||i==null||(e.text.alignment=i);for(const[t,i]of this.fibonacciOptions)if(!(e.type!==t||i==null))for(const o of Object.keys(i)){const s=i[o];s!=null&&e.set({[o]:s})}}};import{_ModuleSupport as lL}from"ag-charts-community";import{BaseProperties as cL,CleanupRegistry as hL,Color as uy,EventEmitter as dL,PropertiesArray as pL,Property as Cs,ToolbarButtonProperties as gy}from"ag-charts-core";import{_ModuleSupport as uL}from"ag-charts-community";import{Color as id,attachListener as gL,clamp as el,createElement as mL,getWindow as my}from"ag-charts-core";var yL='<div class="ag-charts-color-picker__palette" role="slider" tabindex="0"></div><div class="ag-charts-color-picker__color-row" role="presentation"><button class="ag-charts-color-picker__multi-color-button" tabindex="0" type="button" role="switch"></button> <input class="ag-charts-color-picker__hue-input" tabindex="0" type="range" min="0" max="360" value="0"></div><input class="ag-charts-color-picker__alpha-input" tabindex="0" type="range" min="0" max="1" value="1" step="0.01"> <label class="ag-charts-color-picker__color-field" role="presentation"><span class="ag-charts-color-picker__color-label" aria-hidden="true"></span> <input class="ag-charts-color-picker__color-input" tabindex="0" value="#000"></label>',yy=e=>{try{const t=id.fromString(e),[i,o,s]=t.toHSB();return[i,o,s,t.a]}catch{return}},fy=class extends uL.AnchoredPopover{constructor(e,t){super(e,"color-picker",t),this.hasChanged=!1,this.hideFns.push(()=>{this.i18nUpdater=void 0,this.hasChanged&&this.onChangeHide?.()}),this.cleanup.register(this.ctx.eventsHub.on("locale:change",()=>this.i18nUpdater?.()))}show(e){this.hasChanged=!1,this.onChangeHide=e.onChangeHide;const{element:t,initialFocus:i}=this.createColorPicker(e),o=this.showWithChildren([t],{initialFocus:i,...e});o.classList.add("ag-charts-color-picker"),o.setAttribute("role","dialog")}createColorPicker(e){const{localeManager:t}=this.ctx;let i=e.isMultiColor??!1,[o,s,a,n]=yy(e.color??"#f00")??[0,1,.5,1];n=e.opacity??n;const r=mL("div","ag-charts-color-picker__content");r.innerHTML=yL,r.ariaLabel=this.ctx.localeManager.t("ariaLabelColorPicker");const l=r.querySelector(".ag-charts-color-picker__palette"),c=r.querySelector(".ag-charts-color-picker__hue-input"),h=r.querySelector(".ag-charts-color-picker__multi-color-button"),d=r.querySelector(".ag-charts-color-picker__alpha-input"),u=r.querySelector(".ag-charts-color-picker__color-input"),g=r.querySelector(".ag-charts-color-picker__color-label"),m=f=>{const v={s:"ariaValueColorPalette",v:"ariaValueColorPaletteFirstV"}[f];l.ariaValueText=t.t(v,{s,v:a})};this.i18nUpdater=()=>{l.ariaRoleDescription=t.t("ariaRoleDescription2DSlider"),l.ariaLabel=t.t("ariaLabelColorPickerPalette"),c.ariaLabel=t.t("ariaLabelColorPickerHue"),h.ariaLabel=t.t("ariaLabelColorPickerMultiColor"),d.ariaLabel=t.t("ariaLabelColorPickerAlpha"),u.ariaLabel=t.t("ariaLabelColor"),m("s")},this.i18nUpdater(),h.classList.toggle("ag-charts-color-picker__multi-color-button--hidden",!e.hasMultiColorOption);const y=(f=!0)=>{const k=id.fromHSB(o,s,a,n).toHexString();if(r.style.setProperty("--h",`${o}`),r.style.setProperty("--s",`${s}`),r.style.setProperty("--v",`${a}`),r.style.setProperty("--a",`${n}`),r.style.setProperty("--color",k.slice(0,7)),r.style.setProperty("--color-a",k),c.value=`${o}`,d.value=`${n}`,d.classList.toggle("ag-charts-color-picker__alpha-input--opaque",n===1),h.classList.toggle("ag-charts-color-picker__multi-color-button--active",i),g.classList.toggle("ag-charts-color-picker__color-label--multi-color",i),document.activeElement!==u&&(h.ariaChecked=i.toString(),u.value=i?t.t("ariaLabelColorPickerMultiColor"):k.toUpperCase()),f||e.color==null){const A=id.fromHSB(o,s,a,1).toHexString();e.onChange?.(k,A,n,i)}f&&(this.hasChanged=!0)};y(!1);const S=f=>f.preventDefault(),x=f=>f.stopPropagation(),b=f=>{f.preventDefault();const v=f.currentTarget;v.focus();const k=v.getBoundingClientRect(),A=({clientX:I,clientY:D})=>{i=!1,s=Math.min(Math.max((I-k.left)/k.width,0),1),a=1-Math.min(Math.max((D-k.top)/k.height,0),1),y(),m("s")};A(f);const M=gL(my(),"pointermove",A);my().addEventListener("pointerup",M,{once:!0})};return r.addEventListener("mousedown",x),r.addEventListener("touchstart",x),r.addEventListener("touchmove",x),r.addEventListener("keydown",f=>{switch(f.stopPropagation(),f.key){case"Enter":case"Escape":this.hide();break;default:return}f.preventDefault()}),l.addEventListener("pointerdown",b),l.addEventListener("touchstart",S,{passive:!1}),l.addEventListener("touchmove",S,{passive:!1}),l.addEventListener("keydown",f=>{if(f.key==="ArrowLeft")s=el(0,s-.01,1),m("s");else if(f.key==="ArrowRight")s=el(0,s+.01,1),m("s");else if(f.key==="ArrowUp")a=el(0,a+.01,1),m("v");else if(f.key==="ArrowDown")a=el(0,a-.01,1),m("v");else return;f.preventDefault(),y()}),l.addEventListener("focus",()=>{m("s")}),h.addEventListener("click",()=>{i=!i,y()}),c.addEventListener("input",f=>{i=!1,o=f.currentTarget.valueAsNumber??0,y()}),d.addEventListener("input",f=>{i=!1,n=f.currentTarget.valueAsNumber??0,y()}),u.addEventListener("input",f=>{i=!1;const v=yy(f.currentTarget.value);v!=null&&([o,s,a,n]=v,y())}),u.addEventListener("blur",()=>y()),u.addEventListener("keydown",f=>{f.key==="Enter"&&(f.currentTarget.blur(),y())}),{element:r,initialFocus:l}}};import{_ModuleSupport as xy}from"ag-charts-community";function Sy(e){return!(e instanceof xy.LogScale)&&!(e instanceof xy.BandScale)}var fL=[{label:"toolbarAnnotationsTrendLine",icon:"trend-line-drawing",value:"line"},{label:"toolbarAnnotationsHorizontalLine",icon:"horizontal-line-drawing",value:"horizontal-line"},{label:"toolbarAnnotationsVerticalLine",icon:"vertical-line-drawing",value:"vertical-line"},{label:"toolbarAnnotationsParallelChannel",icon:"parallel-channel-drawing",value:"parallel-channel",visible:Sy},{label:"toolbarAnnotationsDisjointChannel",icon:"disjoint-channel-drawing",value:"disjoint-channel",visible:Sy}],xL=[{label:"toolbarAnnotationsFibonacciRetracement",icon:"fibonacci-retracement-drawing",value:"fibonacci-retracement"},{label:"toolbarAnnotationsFibonacciRetracementTrendBased",icon:"fibonacci-retracement-trend-based-drawing",value:"fibonacci-retracement-trend-based"}],SL=[{label:"Fibonacci - Extended",value:10},{label:"Fibonacci - 6 Band",value:6},{label:"Fibonacci - 4 Band",value:4}],bL=[{label:"toolbarAnnotationsText",icon:"text-annotation",value:"text"},{label:"toolbarAnnotationsComment",icon:"comment-annotation",value:"comment"},{label:"toolbarAnnotationsCallout",icon:"callout-annotation",value:"callout"},{label:"toolbarAnnotationsNote",icon:"note-annotation",value:"note"}],vL=[{label:"toolbarAnnotationsArrow",icon:"arrow-drawing",value:"arrow"},{label:"toolbarAnnotationsArrowUp",icon:"arrow-up-drawing",value:"arrow-up"},{label:"toolbarAnnotationsArrowDown",icon:"arrow-down-drawing",value:"arrow-down"}],kL=[{label:"toolbarAnnotationsQuickDatePriceRange",icon:"measurer-drawing",value:"quick-date-price-range"},{label:"toolbarAnnotationsDateRange",icon:"date-range-drawing",value:"date-range"},{label:"toolbarAnnotationsPriceRange",icon:"price-range-drawing",value:"price-range"},{label:"toolbarAnnotationsDatePriceRange",icon:"date-price-range-drawing",value:"date-price-range"}],by=[{strokeWidth:1,label:"1",value:1},{strokeWidth:2,label:"2",value:2},{strokeWidth:3,label:"3",value:3},{strokeWidth:4,label:"4",value:4},{strokeWidth:8,label:"8",value:8}],_n=[{icon:"line-style-solid",altText:"iconAltTextLineStyleSolid",value:"solid"},{icon:"line-style-dashed",altText:"iconAltTextLineStyleDashed",value:"dashed"},{icon:"line-style-dotted",altText:"iconAltTextLineStyleDotted",value:"dotted"}],vy=[{label:"10",value:10},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"22",value:22},{label:"28",value:28},{label:"36",value:36},{label:"46",value:46}],{FloatingToolbar:DL,Menu:od,ToolbarButtonWidget:AL}=lL,va=class extends gy{constructor(){super(...arguments),this.checkedOverrides=new gy}};p([Cs],va.prototype,"value",2),p([Cs],va.prototype,"checkedOverrides",2),p([Cs],va.prototype,"color",2),p([Cs],va.prototype,"strokeWidth",2),p([Cs],va.prototype,"isMultiColor",2);var ML=class extends AL{update(e){super.update(e),e.value==="line-stroke-width"&&this.updateLineStrokeWidth(e),(e.value==="fill-color"||e.value==="line-color"||e.value==="text-color")&&this.updateFillColor(e)}updateFillColor(e){const t=this.getElement();t.classList.add("ag-charts-annotations__color-picker-button"),t.classList.toggle("ag-charts-annotations__color-picker-button--multi-color",e.isMultiColor),t.style.setProperty("--color",e.color??null)}updateLineStrokeWidth(e){const t=this.getElement();t.classList.add("ag-charts-annotations__stroke-width-button"),t.style.setProperty("--stroke-width",`${e.strokeWidth}px`)}},IL=class extends DL{createButtonWidget(){return new ML(this.localeManager)}},sd=class extends cL{constructor(e,t){super(),this.ctx=e,this.getActiveDatum=t,this.enabled=!0,this.buttons=new pL(va),this.cleanup=new hL,this.events=new dL,this.visibleButtons=[],this.toolbar=new IL(this.ctx,"ariaLabelAnnotationOptionsToolbar","annotation-options"),this.colorPicker=new fy(this.ctx),this.textSizeMenu=new od(this.ctx,"text-size"),this.lineStyleTypeMenu=new od(this.ctx,"annotations-line-style-type"),this.lineStrokeWidthMenu=new od(this.ctx,"annotations-line-stroke-width"),this.cleanup.register(this.toolbar.addToolbarListener("button-pressed",this.onButtonPress.bind(this)),this.toolbar.addToolbarListener("toolbar-moved",this.onToolbarMoved.bind(this)),e.widgets.seriesWidget.addListener("drag-start",this.onDragStart.bind(this)),e.widgets.seriesWidget.addListener("drag-end",this.onDragEnd.bind(this)),()=>{this.colorPicker.destroy(),this.toolbar.destroy()})}onDragStart(){this.toolbar.ignorePointerEvents()}onDragEnd(){this.toolbar.capturePointerEvents()}destroy(){this.cleanup.flush()}show(){this.enabled&&this.toolbar.show()}hide(){this.toolbar.hide()}updateButtons(e){if(!this.enabled)return;const t={"line-style-type":Vo(e),"line-stroke-width":Vo(e),"line-color":iL(e),"text-color":aL(e),"fill-color":sL(e),"text-size":td(e),settings:ba(e),lock:!0,delete:!0};this.visibleButtons=this.buttons.filter(i=>t[i.value]),this.toolbar.clearButtons(),this.toolbar.updateButtons(this.visibleButtons),this.refreshButtons(e)}setAnchorScene(e){this.toolbar.hasBeenDragged()||this.toolbar.setAnchor(e.getAnchor())}hideOverlays(){this.toolbar.clearActiveButton(),this.colorPicker.hide({lastFocus:null}),this.textSizeMenu.hide(),this.lineStyleTypeMenu.hide(),this.lineStrokeWidthMenu.hide(),this.events.emit("hid-overlays",null)}clearActiveButton(){this.toolbar.clearActiveButton()}updateColors(e){this.updateColorPickerColor("line-color",e.getDefaultColor("line-color"),e.getDefaultOpacity("line-color"),"isMultiColor"in e&&e?.isMultiColor),this.updateColorPickerColor("fill-color",e.getDefaultColor("fill-color"),e.getDefaultOpacity("fill-color"),"isMultiColor"in e&&e?.isMultiColor),this.updateColorPickerColor("text-color",e.getDefaultColor("text-color"),e.getDefaultOpacity("text-color"),"isMultiColor"in e&&e?.isMultiColor)}updateColorPickerColor(e,t,i,o){if(t!=null&&i!=null){const{r:s,g:a,b:n}=uy.fromString(t);t=uy.fromArray([s,a,n,i]).toHexString()}this.updateButtonByValue(e,{color:t,isMultiColor:o})}updateFontSize(e){this.updateButtonByValue("text-size",{label:e==null?void 0:String(e)})}updateLineStyleType(e){this.updateButtonByValue("line-style-type",{icon:e.icon})}updateStrokeWidth(e){this.updateButtonByValue("line-stroke-width",{label:e.label,strokeWidth:e.value})}onButtonPress({event:e,button:t,buttonWidget:i}){const o=this.getActiveDatum();if(o)switch(this.hideOverlays(),t.value){case"line-style-type":{const s=Vo(o)?Rn(o.lineDash,o.lineStyle):void 0;this.lineStyleTypeMenu.show(i,{items:_n,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsLineStyle"),value:s,onPress:a=>this.onLineStyleTypeMenuPress(a,o),class:"ag-charts-annotations__line-style-type-menu"});break}case"line-stroke-width":{const s=Vo(o)?o.strokeWidth:void 0;this.lineStrokeWidthMenu.show(i,{items:by,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsLineStrokeWidth"),value:s,onPress:a=>this.onLineStrokeWidthMenuPress(a,o),class:"ag-charts-annotations__line-stroke-width-menu"});break}case"line-color":case"fill-color":case"text-color":{this.toolbar.toggleActiveButtonByIndex(t.index),this.colorPicker.show({color:o?.getDefaultColor(t.value),opacity:o?.getDefaultOpacity(t.value),sourceEvent:e.sourceEvent,hasMultiColorOption:"isMultiColor"in o,isMultiColor:"isMultiColor"in o&&o?.isMultiColor,onChange:o==null?void 0:this.onColorPickerChange.bind(this,t.value,o),onChangeHide:(s=>{this.events.emit("saved-color",{type:o.type,colorPickerType:t.value,color:o.getDefaultColor(s)})}).bind(this,t.value)});break}case"text-size":{const s=Wi(o)?o.fontSize:void 0;this.textSizeMenu.show(i,{items:vy,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsTextSize"),value:s,onPress:a=>this.onTextSizeMenuPress(a,o),class:"ag-charts-annotations__text-size-menu"});break}case"delete":{this.events.emit("pressed-delete",null);break}case"lock":{o.locked=!o.locked,this.refreshButtons(o),this.events.emit("pressed-lock",{locked:o.locked});break}case"settings":{this.toolbar.toggleActiveButtonByIndex(t.index),this.events.emit("pressed-settings",e);break}}}onToolbarMoved(e){const{buttonBounds:t,popoverBounds:i}=e,o={x:i.x,y:i.y+i.height+4},s={y:i.y-4};this.colorPicker.setAnchor(o,s);for(const[a,n]of t.entries()){const r=this.visibleButtons.at(a);if(!r)continue;const l={x:n.x,y:n.y+n.height-1},c={y:n.y};switch(r.value){case"line-stroke-width":this.lineStrokeWidthMenu.setAnchor(l,c);break;case"line-style-type":this.lineStyleTypeMenu.setAnchor(l,c);break;case"text-size":this.textSizeMenu.setAnchor(l,c);break}}}onColorPickerChange(e,t,i,o,s,a){this.events.emit("updated-color",{type:t.type,colorPickerType:e,colorOpacity:i,color:o,opacity:s,isMultiColor:a}),this.updateColorPickerColor(e,i,s,a)}onTextSizeMenuPress(e,t){if(!td(t))return;const i=e.value;this.events.emit("updated-font-size",{type:t.type,fontSize:i}),this.textSizeMenu.hide(),this.updateFontSize(i)}onLineStyleTypeMenuPress(e,t){if(!Vo(t))return;const i=e.value;this.events.emit("updated-line-style",{type:t.type,lineStyleType:i}),this.lineStyleTypeMenu.hide(),this.updateLineStyleType(e)}onLineStrokeWidthMenuPress(e,t){if(!Vo(t))return;const i=e.value;this.events.emit("updated-line-width",{type:t.type,strokeWidth:i}),this.lineStrokeWidthMenu.hide(),this.updateStrokeWidth(e)}refreshButtons(e){const t=e.locked??!1;for(const[i,o]of this.visibleButtons.entries())o&&(o.value==="lock"?(this.toolbar.toggleSwitchCheckedByIndex(i,t),this.updateButtonByIndex(i,t?o.checkedOverrides.toJson():o.toJson())):this.toolbar.toggleButtonEnabledByIndex(i,!t));td(e)&&this.updateFontSize(e.fontSize),this.updateColors(e),this.updateLineStyles(e)}updateLineStyles(e){if(!Vo(e))return;const t=e.strokeWidth??1,i=Rn(e.lineDash,e.lineStyle);this.updateStrokeWidth({strokeWidth:t,value:t,label:String(t)}),this.updateLineStyleType(_n.find(o=>o.value===i)??_n[0])}updateButtonByValue(e,t){const i=this.visibleButtons.findIndex(o=>o.value===e);i!==-1&&this.updateButtonByIndex(i,t)}updateButtonByIndex(e,t){const i=this.visibleButtons.at(e);i&&this.toolbar.updateButtonByIndex(e,{...i.toJson(),...t,value:t.value??i.value})}};p([Cs],sd.prototype,"enabled",2),p([Cs],sd.prototype,"buttons",2);import{Debug as LL,StateMachine as ky,StateMachineProperty as ad,Vec2 as Dy}from"ag-charts-core";var _e=class extends ky{constructor(e){const t=({context:i})=>{this.node?.drag(this.datum,this.offset,i,this.snapping),e.update()};super("idle",{idle:{dragStart:{target:"dragging",action:({offset:i,context:o})=>{this.hasMoved=!1,this.dragStart=i,this.offset=i,this.node?.dragStart(this.datum,i,o)}}},dragging:{keyDown:t,keyUp:t,drag:({offset:i,context:o})=>{this.hasMoved=Dy.lengthSquared(Dy.sub(i,this.dragStart))>0,this.offset=i,this.node?.drag(this.datum,i,o,this.snapping),e.update()},dragEnd:{target:ky.parent,action:()=>{this.node?.stopDragging(),this.hasMoved&&e.recordAction("Move annotation"),e.update()}}}}),this.debug=LL.create(!0,"annotations"),this.hasMoved=!1,this.snapping=!1}};p([ad()],_e.prototype,"snapping",2),p([ad()],_e.prototype,"datum",2),p([ad()],_e.prototype,"node",2);import{Property as NL,isObject as CL}from"ag-charts-core";var zo=class extends Jh{constructor(){super(...arguments),this.type="arrow-down"}static is(e){return CL(e)&&e.type==="arrow-down"}};p([NL],zo.prototype,"type",2);import{_ModuleSupport as TL}from"ag-charts-community";import{_ModuleSupport as wL}from"ag-charts-community";import{_ModuleSupport as nd}from"ag-charts-community";import{ZIndexMap as PL,isObject as OL}from"ag-charts-core";import{_ModuleSupport as rd}from"ag-charts-community";import{_ModuleSupport as RL}from"ag-charts-community";var ka=class extends RL.Marker{isPointInPath(e,t){return this.updatePathIfDirty(),this.path.closedPath&&this.path.isPointInPath(e,t)}},Ay=class jA extends rd.Group{constructor(){super(...arguments),this.active=!1,this.locked=!1,this.visible=!1,this.zIndex=1}drag(t){const{handle:i,locked:o}=this;return o?{point:{x:i.x,y:i.y},offset:{x:0,y:0}}:{point:t,offset:{x:t.x-i.x,y:t.y-i.y}}}toggleActive(t){this.active=t,t||(this.handle.strokeWidth=jA.INACTIVE_STROKE_WIDTH)}toggleHovered(t){this.glow.visible=!this.locked&&t,this.glow.dirtyPath=!0}toggleDragging(t){this.locked||(this.handle.visible=!t,this.glow.visible=this.glow.visible&&!t,this.handle.dirtyPath=!0,this.glow.dirtyPath=!0)}toggleLocked(t){this.locked=t}getCursor(){}containsPoint(t,i){return this.handle.containsPoint(t,i)}};Ay.INACTIVE_STROKE_WIDTH=2;var Fo=Ay,ld=class XA extends Fo{constructor(){super(),this.handle=new ka({shape:"circle"}),this.glow=new ka({shape:"circle"}),this.append([this.handle]),this.handle.size=XA.HANDLE_SIZE,this.handle.strokeWidth=Fo.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2}update(t){this.handle.setProperties({...t,strokeWidth:Fo.INACTIVE_STROKE_WIDTH})}drag(t){return{point:t,offset:{x:0,y:0}}}};ld.HANDLE_SIZE=7,ld.GLOW_SIZE=9;var Ho=ld,tl=class Kt extends Fo{constructor(){super(),this.handle=new rd.Rect,this.glow=new rd.Rect,this.gradient="horizontal",this.append([this.glow,this.handle]),this.handle.cornerRadius=Kt.CORNER_RADIUS,this.handle.width=Kt.HANDLE_SIZE,this.handle.height=Kt.HANDLE_SIZE,this.handle.strokeWidth=Fo.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2,this.glow.cornerRadius=Kt.CORNER_RADIUS,this.glow.width=Kt.GLOW_SIZE,this.glow.height=Kt.GLOW_SIZE,this.glow.strokeWidth=0,this.glow.fillOpacity=.2,this.glow.zIndex=1,this.glow.visible=!1}toggleLocked(t){if(super.toggleLocked(t),t){const i=(Kt.HANDLE_SIZE-Ho.HANDLE_SIZE)/2;this.handle.cornerRadius=1,this.handle.fill=this.handle.stroke,this.handle.strokeWidth=0,this.handle.x+=i,this.handle.y+=i,this.handle.width=Ho.HANDLE_SIZE,this.handle.height=Ho.HANDLE_SIZE,this.glow.width=Ho.GLOW_SIZE,this.glow.height=Ho.GLOW_SIZE}else this.handle.cornerRadius=Kt.CORNER_RADIUS,this.handle.width=Kt.HANDLE_SIZE,this.handle.height=Kt.HANDLE_SIZE,this.glow.width=Kt.GLOW_SIZE,this.glow.height=Kt.GLOW_SIZE,this.cachedStyles&&this.handle.setProperties(this.cachedStyles)}update(t){if(this.cachedStyles={...t},this.active||delete t.strokeWidth,this.locked){delete t.fill,delete t.strokeWidth;const i=(Kt.HANDLE_SIZE-Ho.HANDLE_SIZE)/2;t.x-=i,t.y-=i,this.cachedStyles.x-=i,this.cachedStyles.y-=i}this.handle.setProperties(t),this.glow.setProperties({...t,x:(t.x??this.glow.x)-2,y:(t.y??this.glow.y)-2,strokeWidth:0,fill:t.stroke})}drag(t){return this.locked?{point:t,offset:{x:0,y:0}}:this.gradient==="vertical"?{point:{x:t.x,y:this.handle.y},offset:{x:t.x-this.handle.x,y:0}}:{point:{x:this.handle.x,y:t.y},offset:{x:0,y:t.y-this.handle.y}}}getCursor(){if(!this.locked)return this.gradient==="vertical"?"col-resize":"row-resize"}};tl.HANDLE_SIZE=12,tl.GLOW_SIZE=16,tl.CORNER_RADIUS=4;var Da=tl,cd=class Pr extends Fo{constructor(){super(),this.handle=new ka({shape:"circle"}),this.glow=new ka({shape:"circle"}),this.append([this.glow,this.handle]),this.handle.size=Pr.HANDLE_SIZE,this.handle.strokeWidth=Fo.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2,this.glow.size=Pr.GLOW_SIZE,this.glow.strokeWidth=0,this.glow.fillOpacity=.2,this.glow.zIndex=1,this.glow.visible=!1}toggleLocked(t){super.toggleLocked(t),t?(this.handle.fill=this.handle.stroke,this.handle.strokeWidth=0,this.handle.size=Ho.HANDLE_SIZE,this.glow.size=Ho.GLOW_SIZE):(this.handle.size=Pr.HANDLE_SIZE,this.glow.size=Pr.GLOW_SIZE,this.cachedStyles&&this.handle.setProperties(this.cachedStyles))}update(t){this.cachedStyles={...t},this.active||delete t.strokeWidth,this.locked&&(delete t.fill,delete t.strokeWidth),this.handle.setProperties(t),this.glow.setProperties({...t,strokeWidth:0,fill:t.stroke})}getCursor(){return"pointer"}};cd.HANDLE_SIZE=11,cd.GLOW_SIZE=17;var Ae=cd,Qe=class extends nd.Group{constructor(){super(...arguments),this.name="AnnotationScene",this.zIndex=PL.CHART_ANNOTATION}static isCheck(e,t){return OL(e)&&Object.hasOwn(e,"type")&&e.type===t}toggleHovered(e,t,i){i!==!0&&this.toggleHandles(e||t)}computeBBoxWithoutHandles(){return nd.Transformable.toCanvas(this,nd.Group.computeChildrenBBox(this.excludeChildren({instance:Fo})))}updateNode(e,t,i){if(!i&&t){t.remove();return}return i&&t==null&&(t=new e,this.appendChild(t)),t}};import{Vec2 as EL}from"ag-charts-core";import{_ModuleSupport as _L}from"ag-charts-community";import{Vec2 as pi,entries as BL,toRadians as VL}from"ag-charts-core";var{ContinuousScale:zL}=_L;function Bn(e,t,i=!1,o,s=1){if(!i)return It(e,t);const a=o?De(o,t):pi.origin();return It(il(e,a,s),t)}function il(e,t,i){const o=pi.sub(e,t),s=VL(i),a=Math.round(pi.angle(o)/s)*s;return pi.rotate(o,a,t)}function ol(e,t){const i={};for(const[o,s]of BL(e))i[o]=De(s,t);return i}function yo(e,t,i,o={overflowContinuous:0,translateVectors:void 0,invertYVectors:void 0,snap:void 0}){const{xAxis:s,yAxis:a}=i,n=Object.keys(e),r=[],l=[],c=new Set(o.translateVectors??n),h=new Set(o.invertYVectors??[]),d=new Set([...c,...h]),u=pi.multiply(t,pi.from(1,-1));for(const x of n)d.has(x)&&(e[x]=pi.add(e[x],h.has(x)?u:t),o.snap&&(e[x]=il(e[x],o.snap.vectors[x],o.snap.angle))),r.push(s.getRangeOverflow(e[x].x)),l.push(a.getRangeOverflow(e[x].y));const g=(x,b)=>Math.abs(x)-Math.abs(b),m=(x,b,f)=>o.overflowContinuous===0||!zL.is(x)?f.toSorted(g).at(-1)??0:n.length===d.size?f.toSorted(g).at(-o.overflowContinuous-1)??0:f.filter(k=>k!==0).length<=o.overflowContinuous?0:f.filter((k,A)=>k!==0&&Math.abs(k)<=Math.abs(b)&&d.has(n[A])).toSorted(g).at(-1)??0,y=pi.from(m(s.scale,t.x,r),m(a.scale,t.y,l));if(!pi.equal(y,pi.origin()))for(const x of n)d.has(x)&&(e[x]=pi.round(pi.sub(e[x],y),4));const S={};for(const x of n)S[x]=It(e[x],i);return S}var My=class extends Qe{constructor(){super(...arguments),this.handle=new Ae,this.anchor={x:0,y:0,position:"above"}}update(e,t){const i=De(e,t);this.updateHandle(e,i),this.anchor=this.updateAnchor(e,i,t)}dragStart(e,t,i){this.dragState={offset:t,...ol({handle:e},i)}}drag(e,t,i){const{dragState:o}=this;if(!e.isWriteable()||!o)return;const{point:s}=yo({point:o.handle},EL.sub(t,o.offset),i);e.x=s.x,e.y=s.y}translate(e,t,i){if(!e.isWriteable())return;const{point:o}=yo({point:De(e,i)},t,i);e.x=o.x,e.y=o.y}toggleHandles(e){this.handle.visible=!!e,this.handle.toggleHovered(this.activeHandle==="handle")}toggleActive(e){this.toggleHandles(e),this.handle.toggleActive(e)}stopDragging(){this.handle.toggleDragging(!1)}copy(e,t,i){const o=De(e,i),s=It({x:o.x-30,y:o.y-30},i);return t.x=s.x,t.y=s.y,t}getAnchor(){return this.anchor}getCursor(){return"pointer"}containsPoint(e,t){const{handle:i}=this;return this.activeHandle=void 0,i.containsPoint(e,t)?(this.activeHandle="handle",!0):!1}getNodeAtCoords(e,t){if(this.handle.containsPoint(e,t))return"handle"}updateHandle(e,t,i){const{x:o,y:s}=this.getHandleCoords(e,t,i),a=this.getHandleStyles(e);this.handle.update({...a,x:o,y:s}),this.handle.toggleLocked(e.locked??!1)}updateAnchor(e,t,i){const o=this.getHandleCoords(e,t);return{x:o.x+i.seriesRect.x,y:o.y+i.seriesRect.y,position:this.anchor.position}}getHandleCoords(e,t,i){return{x:t.x,y:t.y}}getHandleStyles(e){return{fill:e.handle.fill,stroke:e.handle.stroke,strokeOpacity:e.handle.strokeOpacity,strokeWidth:e.handle.strokeWidth}}},Iy=class extends My{constructor(){super(),this.append([this.handle])}update(e,t){super.update(e,t);const i=De(e,t);this.updateShape(e,i)}updateShape(e,t){this.updateShapeStyles(e),this.updateShapePath(e,t)}updateShapeStyles(e){const{shape:t}=this;t.fill=e.fill,t.fillOpacity=e.fillOpacity??1}updateShapePath(e,t){const{shape:i}=this;i.x=t.x,i.y=t.y,i.size=e.size}containsPoint(e,t){return super.containsPoint(e,t)||this.shape.containsPoint(e,t)}getNodeAtCoords(e,t){return this.shape.containsPoint(e,t)?"shape":super.getNodeAtCoords(e,t)}},Ly=[[.5,0],[1,.5],[.75,.5],[.75,1],[.25,1],[.25,.5],[0,.5]];function Ny(e){wL.drawMarkerUnitPolygon(e,Ly)}Ny.anchor={x:.5,y:0};var sl=class extends Iy{constructor(){super(),this.type="arrow-up",this.shape=new ka({shape:Ny}),this.append([this.shape])}static is(e){return Qe.isCheck(e,"arrow-up")}getHandleCoords(e,t){const i=Ae.HANDLE_SIZE/2,o=super.getHandleCoords(e,t);return o.y-=i,o}},FL=Ly.map(([e,t])=>[e,1-t]);function Cy(e){TL.drawMarkerUnitPolygon(e,FL)}Cy.anchor={x:.5,y:1};var al=class extends Iy{constructor(){super(),this.type="arrow-down",this.shape=new ka({shape:Cy}),this.append([this.shape])}static is(e){return Qe.isCheck(e,"arrow-down")}updateAnchor(e,t,i){const o=super.updateAnchor(e,t,i);return o.y-=e.size,o}getHandleCoords(e,t){const i=Ae.HANDLE_SIZE/2,o=super.getHandleCoords(e,t);return o.y+=i,o}};import{Debug as HL,StateMachine as nl,StateMachineProperty as WL}from"ag-charts-core";var hd=class extends nl{constructor(e){const t=({point:o})=>{const s=this.createDatum();s.set({x:o.x,y:o.y}),e.create(s)},i=()=>{this.node?.toggleActive(!0),e.showAnnotationOptions(),e.update()};super("start",{start:{click:{target:"waiting-first-render",action:t},drag:{target:"waiting-first-render",action:t},cancel:nl.parent,reset:nl.parent},"waiting-first-render":{render:{target:nl.parent,action:i}}}),this.debug=HL.create(!0,"annotations")}};p([WL()],hd.prototype,"node",2);var KL=class extends hd{createDatum(){return new zo}},Ty={type:"arrow-down",datum:zo,scene:al,isDatum:zo.is,translate:(e,t,i,o)=>{zo.is(t)&&al.is(e)&&e.translate(t,i,o)},copy:(e,t,i,o)=>{if(zo.is(t)&&zo.is(i)&&al.is(e))return e.copy(t,i,o)},update:(e,t,i)=>{zo.is(t)&&al.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new KL({...e,create:t("arrow-down")}),dragState:e=>new _e(e)};import{Property as GL,isObject as $L}from"ag-charts-core";var Wo=class extends Jh{constructor(){super(...arguments),this.type="arrow-up"}static is(e){return $L(e)&&e.type==="arrow-up"}};p([GL],Wo.prototype,"type",2);var YL=class extends hd{createDatum(){return new Wo}},wy={type:"arrow-up",datum:Wo,scene:sl,isDatum:Wo.is,translate:(e,t,i,o)=>{Wo.is(t)&&sl.is(e)&&e.translate(t,i,o)},copy:(e,t,i,o)=>{if(Wo.is(t)&&Wo.is(i)&&sl.is(e))return e.copy(t,i,o)},update:(e,t,i)=>{Wo.is(t)&&sl.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new YL({...e,create:t("arrow-up")}),dragState:e=>new _e(e)};import{_ModuleSupport as UL}from"ag-charts-community";import{_ModuleSupport as jL}from"ag-charts-community";import{Vec4 as Py}from"ag-charts-core";import{Vec2 as XL,Vec4 as Oy,entries as ZL}from"ag-charts-core";import{Vec2 as qL,Vec4 as Ry}from"ag-charts-core";var Ey=class extends Qe{constructor(){super(...arguments),this.overflowContinuous=0}extendLine({x1:e,y1:t,x2:i,y2:o},s,a){const n={x1:e,y1:t,x2:i,y2:o};if(!s.extendStart&&!s.extendEnd)return n;const[r,l]=NI(n,a.yAxis.bounds),c=n.x2<n.x1,h=n.y1>=n.y2,d=n.x2===n.x1;return s.extendEnd&&(d?n.y2=h?l.y:r.y:(n.x2=c?r.x:l.x,n.y2=c?r.y:l.y)),s.extendStart&&(d?n.y1=h?r.y:l.y:(n.x1=c?l.x:r.x,n.y1=c?l.y:r.y)),n}dragStart(e,t,i){this.dragState={offset:t,...ol({start:e.start,end:e.end},i)}}drag(e,t,i,o){e.isWriteable()&&(this.activeHandle?this.dragHandle(e,t,i,o):this.dragAll(e,t,i))}dragAll(e,t,i){const{dragState:o}=this;o&&this.translatePoints(e,o.start,o.end,qL.sub(t,o.offset),i)}translate(e,t,i){e.isWriteable()&&this.translatePoints(e,De(e.start,i),De(e.end,i),t,i)}copy(e,t,i){const o=Mt(e,i);if(!o)return;const s=this.computeBBoxWithoutHandles(),a={x:-s.width/2,y:-s.height/2};return this.translatePoints(t,Ry.start(o),Ry.end(o),a,i),t}translatePoints(e,t,i,o,s){const a=this.getTranslatePointsVectors(t,i),n=yo(a,o,s,{overflowContinuous:this.overflowContinuous});e.start.x=n.start.x,e.end.x=n.end.x,e.start.y=n.start.y,e.end.y=n.end.y}getTranslatePointsVectors(e,t){return{start:e,end:t}}},dd=class extends Ey{constructor(){super(...arguments),this.start=new Ae,this.end=new Ae,this.anchor={x:0,y:0,position:"above"}}update(e,t){const i=Mt(e,t);i!=null&&(this.updateHandles(e,i),this.updateAnchor(e,i,t))}toggleHandles(e){if(typeof e=="boolean")this.start.visible=e,this.end.visible=e;else for(const[t,i]of ZL(e))this[t].visible=i;this.start.toggleHovered(this.activeHandle==="start"),this.end.toggleHovered(this.activeHandle==="end")}toggleActive(e){this.toggleHandles(e),this.start.toggleActive(e),this.end.toggleActive(e)}dragHandle(e,t,i,o){const{activeHandle:s,dragState:a}=this;if(!s||!a)return;this[s].toggleDragging(!0);const n=s==="start"?"end":"start",r=o?{vectors:{[s]:De(e[n],i)},angle:e.snapToAngle}:void 0,{[s]:l}=yo({[s]:a[s]},XL.sub(t,a.offset),i,{overflowContinuous:0,snap:r});e[s].x=l.x,e[s].y=l.y}stopDragging(){this.start.toggleDragging(!1),this.end.toggleDragging(!1)}getAnchor(){return this.anchor}getCursor(){return"pointer"}containsPoint(e,t){const{start:i,end:o}=this;return this.activeHandle=void 0,i.containsPoint(e,t)?(this.activeHandle="start",!0):o.containsPoint(e,t)?(this.activeHandle="end",!0):!1}getNodeAtCoords(e,t){if(this.start.containsPoint(e,t)||this.end.containsPoint(e,t))return"handle"}updateHandles(e,t,i){this.start.update({...this.getHandleStyles(e,"start"),...this.getHandleCoords(e,t,"start")}),this.end.update({...this.getHandleStyles(e,"end"),...this.getHandleCoords(e,t,"end",i)}),this.start.toggleLocked(e.locked??!1),this.end.toggleLocked(e.locked??!1)}updateAnchor(e,t,i,o){this.anchor={x:t.x1+i.seriesRect.x,y:t.y1+i.seriesRect.y,position:this.anchor.position}}getHandleCoords(e,t,i,o){return i==="start"?Oy.start(t):Oy.end(t)}getHandleStyles(e,t){return{fill:e.handle.fill,stroke:e.handle.stroke,strokeOpacity:e.handle.strokeOpacity,strokeWidth:e.handle.strokeWidth}}},QL=class extends dd{constructor(){super(...arguments),this.label=new jL.Text({zIndex:1}),this.anchor={x:0,y:0,position:"above-left"}}setTextInputBBox(e){this.textInputBBox=e,this.markDirty("TextualStartEndScene")}update(e,t){const i=Mt(e,t);if(i==null)return;const o=this.getTextBBox(e,i);this.updateLabel(e,o,i),this.updateHandles(e,i,o),this.updateShape(e,o,i),this.updateAnchor(e,i,t,o)}containsPoint(e,t){return super.containsPoint(e,t)||this.label.containsPoint(e,t)}getNodeAtCoords(e,t){return this.label.containsPoint(e,t)?"text":super.getNodeAtCoords(e,t)}getTextBBox(e,t){const{text:i}=e.getText();return Qh(e,i,Py.end(t),this.textInputBBox)}updateLabel(e,t,i){const{text:o,isPlaceholder:s}=e.getText();oy(this.label,o,s,e,this.getLabelCoords(e,t,i))}updateShape(e,t,i){}getLabelCoords(e,t,i){return Py.end(i)}getHandleStyles(e,t){return{...super.getHandleStyles(e,t),stroke:e.handle.stroke??e.color}}},{drawCorner:JL,Path:e2}=UL,rl=class extends QL{constructor(){super(),this.type="callout",this.shape=new e2,this.append([this.shape,this.label,this.start,this.end])}static is(e){return Qe.isCheck(e,"callout")}drag(e,t,i,o){e.isWriteable()&&(this.activeHandle==="end"?this.dragHandle(e,t,i,o):this.dragAll(e,t,i))}getLabelCoords(e,t,i){const o=e.getPadding(),{bodyBounds:s={x:0,y:0,width:0,height:0}}=this.getDimensions(e,t,i)??{};return{x:s.x+o.left,y:s.y-o.bottom}}getHandleStyles(e,t){return t==="start"?{fill:e.handle.fill,stroke:e.handle.stroke??e.stroke,strokeOpacity:e.handle.strokeOpacity,strokeWidth:e.handle.strokeWidth}:{fill:void 0,strokeWidth:0}}updateAnchor(e,t,i,o){const{bodyBounds:s}=this.getDimensions(e,o,t)??{},a=s??o;this.anchor={x:a.x+i.seriesRect.x,y:a.y+i.seriesRect.y-a.height,position:this.anchor.position}}updateShape(e,t,i){const{shape:o}=this;o.fill=e.fill,o.fillOpacity=e.fillOpacity??1,o.stroke=e.stroke,o.strokeWidth=e.strokeWidth??1,o.strokeOpacity=e.strokeOpacity??1;const{tailPoint:s,bodyBounds:a}=this.getDimensions(e,t,i)??{};!s||!a||this.updatePath(s,a)}updatePath(e,t){const{x:i,y:o}=e,{x:s,y:a,width:n,height:r}=t,l=a-r,c=s+n,h=this.calculateCalloutPlacement({x:i,y:o},t),d=8,u=[{coordinates:{x0:s,x1:s+d,y0:l+d,y1:l,cx:h==="topLeft"?i:s+d,cy:h==="topLeft"?o:l+d},type:h==="topLeft"?"calloutCorner":"corner"},{coordinates:{x0:s+d,x1:c-d,y0:l,y1:l,cx:i,cy:o},type:h==="top"?"calloutSide":"side"},{coordinates:{x0:c-d,x1:c,y0:l,y1:l+d,cx:h==="topRight"?i:c-d,cy:h==="topRight"?o:l+d},type:h==="topRight"?"calloutCorner":"corner"},{coordinates:{x0:c,x1:c,y0:l+d,y1:a-d,cx:i,cy:o},type:h==="right"?"calloutSide":"side"},{coordinates:{x0:c,x1:c-d,y0:a-d,y1:a,cx:h==="bottomRight"?i:c-d,cy:h==="bottomRight"?o:a-d},type:h==="bottomRight"?"calloutCorner":"corner"},{coordinates:{x0:c-d,x1:s+d,y0:a,y1:a,cx:i,cy:o},type:h==="bottom"?"calloutSide":"side"},{coordinates:{x0:s+d,x1:s,y0:a,y1:a-d,cx:h==="bottomLeft"?i:s+d,cy:h==="bottomLeft"?o:a-d},type:h==="bottomLeft"?"calloutCorner":"corner"},{coordinates:{x0:s,x1:s,y0:a-d,y1:l+d,cx:i,cy:o},type:h==="left"?"calloutSide":"side"}],{path:g}=this.shape;g.clear(),g.moveTo(s,l+d);for(const{coordinates:m,type:y}of u)this.drawPath(g,m,d,y);g.closePath()}drawPath(e,{x0:t,y0:i,x1:o,y1:s,cx:a,cy:n},r,l){switch(l){case"calloutCorner":{e.lineTo(a,n),e.lineTo(o,s);break}case"corner":{JL(e,{x0:t,x1:o,y0:i,y1:s,cx:a,cy:n},r,!1);break}case"calloutSide":{if(t===o){const h=i>s?-1:1,d=Math.min(i,s)+Math.abs(i-s)/2;e.lineTo(t,d-6*h),e.lineTo(a,n),e.lineTo(t,d+6*h),e.lineTo(o,s)}else{const h=t>o?-1:1,d=Math.min(t,o)+Math.abs(o-t)/2;e.lineTo(d-6*h,i),e.lineTo(a,n),e.lineTo(d+6*h,i),e.lineTo(o,s)}break}case"side":default:{e.lineTo(o,s);break}}}calculateCalloutPlacement(e,t){const i=t.x+t.width,o=t.y-t.height;let s,a;return e.x>i?s="right":e.x<t.x&&(s="left"),e.y>t.y?a="bottom":e.y<o&&(a="top"),s&&a?`${a}${s[0].toUpperCase()}${s.substring(1)}`:a??s}getDimensions(e,t,i){const{fontSize:o}=e,s=e.getPadding(),a=s.left+s.right,n=s.top+s.bottom,r=t.width+a,l=Math.max(t.height+n,o+n);return{tailPoint:{x:i.x1,y:i.y1},bodyBounds:{x:t.x,y:t.y,width:r,height:l}}}containsPoint(e,t){const{start:i,end:o,shape:s}=this;if(this.activeHandle=void 0,i.containsPoint(e,t))return this.activeHandle="start",!0;const a=o.containsPoint(e,t)||s.containsPoint(e,t);return a&&(this.activeHandle="end"),a}};import"ag-charts-community";import{Debug as t2,StateMachine as Ii,StateMachineProperty as _y}from"ag-charts-core";function pd({key:e}){return e==="Escape"}function ud({key:e,shiftKey:t}){return!t&&e==="Enter"}var gd=class extends Ii{constructor(e){const t=({point:u})=>{const g=this.createDatum();g.set({start:u,end:u,visible:!0}),e.create(g)},i=()=>{const{node:u}=this;u?.toggleActive(!0),u?.toggleHandles({start:!0})},o=()=>{e.showTextInput(),this.datum&&(this.datum.visible=!1)},s=()=>{e.hideTextInput(),this.datum&&(this.datum.visible=!0),e.deselect()},a=u=>{this.node?.setTextInputBBox(u),e.update()},n=({point:u})=>{const{datum:g,node:m}=this;g?.set({end:u}),m?.toggleActive(!0),m?.toggleHandles({end:!1}),e.update()},r=()=>{e.showAnnotationOptions(),this.node?.toggleHandles({end:!0})},l=({colorPickerType:u,colorOpacity:g,color:m,opacity:y,isMultiColor:S})=>{const{datum:x}=this;x&&(u==="text-color"&&e.updateTextInputColor(m),Jr(x,u,g,m,y,S),e.update())},c=u=>{const{datum:g,node:m}=this;!g||!m||!Wi(g)||(g.fontSize=u,e.updateTextInputFontSize(u),e.update())},h=()=>{e.delete()},d=({textInputValue:u,bbox:g})=>{const{datum:m}=this;if(g!=null&&u!=null&&u.length>0){if(!Wi(m))return;const y=Ur(m,u,g.width);m?.set({text:y}),e.update(),e.recordAction(`Create ${m?.type} annotation`)}else e.delete()};super("start",{start:{click:{target:"waiting-first-render",action:t},dragStart:{target:"waiting-first-render",action:t},cancel:Ii.parent,reset:Ii.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:n,drag:n,click:{target:"edit",action:r},dragEnd:{target:"edit",action:r},reset:{target:Ii.parent,action:h},cancel:{target:Ii.parent,action:h}},edit:{onEnter:o,updateTextInputBBox:a,color:l,fontSize:c,textInput:[{guard:pd,target:Ii.parent,action:h},{guard:ud,target:Ii.parent,action:d}],click:{target:Ii.parent,action:d},dragStart:{target:Ii.parent,action:d},resize:{target:Ii.parent,action:d},onExit:s,cancel:{target:Ii.parent,action:h}}}),this.debug=t2.create(!0,"annotations")}};p([_y()],gd.prototype,"datum",2),p([_y()],gd.prototype,"node",2);var i2=class extends gd{createDatum(){return new Mi}},By={type:"callout",datum:Mi,scene:rl,isDatum:Mi.is,translate:(e,t,i,o)=>{if(Mi.is(t)&&rl.is(e))return e.translate(t,i,o)},copy:(e,t,i,o)=>{if(Mi.is(t)&&Mi.is(i)&&rl.is(e))return e.copy(t,i,o)},update:(e,t,i)=>{Mi.is(t)&&rl.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new i2({...e,create:t("callout")}),dragState:e=>new _e(e)};import{_ModuleSupport as Vy}from"ag-charts-community";import{calcLineHeight as o2}from"ag-charts-core";import{_ModuleSupport as s2}from"ag-charts-community";var md=class extends My{constructor(){super(...arguments),this.label=new s2.Text({zIndex:1}),this.anchor={x:0,y:0,position:"above-left"}}setTextInputBBox(e){this.textInputBBox=e,this.markDirty("TextualPointScene")}update(e,t){const i=De(e,t),o=this.getTextBBox(e,i,t);this.updateLabel(e,o),this.updateHandle(e,i,o),this.updateShape(e,o),this.anchor=this.updateAnchor(e,o,t)}copy(e,t,i){const o=De(e,i),s=this.getTextBBox(e,o,i),a=e.getPadding(),n=a.left+a.right,r=a.top+a.bottom,l=(s.width+n)/2,c=s.height+r,h=It({x:o.x-l,y:o.y-c},i);return t.x=h.x,t.y=h.y,t}containsPoint(e,t){const{label:i}=this;return super.containsPoint(e,t)||i.visible&&i.containsPoint(e,t)}getNodeAtCoords(e,t){return this.label.visible&&this.label.containsPoint(e,t)?"text":super.getNodeAtCoords(e,t)}getTextBBox(e,t,i){const{text:o}=e.getText();return Qh(e,o,{x:t.x,y:t.y},this.textInputBBox)}updateLabel(e,t){const{text:i,isPlaceholder:o}=e.getText();oy(this.label,i,o,e,this.getLabelCoords(e,t),this.getTextBaseline(e))}updateShape(e,t){}updateAnchor(e,t,i){return{x:t.x+i.seriesRect.x,y:t.y+i.seriesRect.y-t.height,position:this.anchor.position}}getLabelCoords(e,t){return t}getTextBaseline(e){return e.position=="center"?"middle":e.position}getHandleCoords(e,t,i){return i}getHandleStyles(e){const t=super.getHandleStyles(e);return t.stroke=e.handle.stroke??e.color,t}},{drawCorner:yd}=Vy,ll=class extends md{constructor(){super(),this.type="comment",this.shape=new Vy.Path,this.append([this.shape,this.label,this.handle])}static is(e){return Qe.isCheck(e,"comment")}updateShape(e,t){const{shape:i}=this;i.fill=e.fill,i.fillOpacity=e.fillOpacity??1,i.stroke=e.stroke??"transparent",i.strokeWidth=e.strokeWidth??1,i.strokeOpacity=e.strokeOpacity??1,this.updatePath(e,t)}getLabelCoords(e,t){const i=e.getPadding();return{x:t.x+i.left,y:t.y-i.bottom}}getHandleStyles(e){return{fill:e.handle.fill,stroke:e.handle.stroke??e.stroke??e.fill,strokeOpacity:e.handle.strokeOpacity,strokeWidth:e.handle.strokeWidth}}updateAnchor(e,t,i){const o=super.updateAnchor(e,t,i),s=e.getPadding();return o.y-=s.bottom+s.top,o}updatePath(e,t){const i=e.getPadding(),{x:o,y:s}=t;let{width:a,height:n}=t;const{fontSize:r}=e,l=i.left+i.right,c=i.top+i.bottom;a=a+l,n=Math.max(n+c,r+c);const h=s-n,d=o+a,u=(o2(r,Yr)+c)/2,{path:g}=this.shape;g.clear(),g.moveTo(o,s),g.lineTo(o,h+u),yd(g,{x0:o,x1:o+u,y0:h+u,y1:h,cx:o+u,cy:h+u},u,!1),g.lineTo(d-u,h),yd(g,{x0:d-u,x1:d,y0:h,y1:h+u,cx:d-u,cy:h+u},u,!1),g.lineTo(d,s-u),yd(g,{x0:d,x1:d-u,y0:s-u,y1:s,cx:d-u,cy:s-u},u,!1),g.closePath()}containsPoint(e,t){return super.containsPoint(e,t)||this.shape.containsPoint(e,t)}};import"ag-charts-community";import{Debug as a2,StateMachine as fo,StateMachineProperty as zy}from"ag-charts-core";var Vn=class extends fo{constructor(e){const t=({point:h})=>{const d=this.createDatum();d.set({x:h.x,y:h.y}),e.create(d)},i=()=>{this.node?.toggleActive(!0),e.showAnnotationOptions(),e.update()},o=()=>{e.showTextInput(),this.datum&&(this.datum.visible=!1)},s=()=>{e.hideTextInput(),this.datum&&(this.datum.visible=!0),e.deselect()},a=h=>{this.node?.setTextInputBBox(h),e.update()},n=({colorPickerType:h,colorOpacity:d,color:u,opacity:g,isMultiColor:m})=>{this.datum&&(h==="text-color"&&e.updateTextInputColor(u),Jr(this.datum,h,d,u,g,m),e.update())},r=h=>{const{datum:d,node:u}=this;!d||!u||!Wi(d)||(d.fontSize=h,e.updateTextInputFontSize(h),e.update())},l=()=>{e.delete()},c=({textInputValue:h,bbox:d})=>{if(d!=null&&h!=null&&h.length>0){const{datum:u}=this;if(!Wi(u))return;const g=Ur(u,h,d.width);u?.set({text:g}),e.update(),e.recordAction(`Create ${u?.type} annotation`)}else e.delete()};super("start",{start:{click:{target:"waiting-first-render",action:t},dragStart:{target:"waiting-first-render",action:t},cancel:fo.parent,reset:fo.parent},"waiting-first-render":{render:{target:"edit",action:i}},edit:{onEnter:o,updateTextInputBBox:a,color:n,fontSize:r,textInput:[{guard:pd,target:fo.parent,action:l},{guard:ud,target:fo.parent,action:c}],click:{target:fo.parent,action:c},dragStart:{target:fo.parent,action:c},resize:{target:fo.parent,action:c},onExit:s,cancel:{target:fo.parent,action:l}}}),this.debug=a2.create(!0,"annotations")}};p([zy()],Vn.prototype,"datum",2),p([zy()],Vn.prototype,"node",2);var n2=class extends Vn{createDatum(){return new zi}},Fy={type:"comment",datum:zi,scene:ll,isDatum:zi.is,translate:(e,t,i,o)=>{zi.is(t)&&ll.is(e)&&e.translate(t,i,o)},copy:(e,t,i,o)=>{if(zi.is(t)&&zi.is(i)&&ll.is(e))return e.copy(t,i,o)},update:(e,t,i)=>{zi.is(t)&&ll.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new n2({...e,create:t("comment")}),dragState:e=>new _e(e)};import"ag-charts-community";import{ChartAxisDirection as r2,Vec2 as Ts,Vec4 as fd}from"ag-charts-core";import{_ModuleSupport as cl}from"ag-charts-community";var{calculateLabelTranslation:l2}=cl,Hy=class extends cl.Group{constructor(){super({name:"AnnotationAxisLabelGroup"}),this.label=new cl.Text({zIndex:1}),this.rect=new cl.Rect;const{label:e}=this;e.fontSize=12,e.fontFamily="Verdana, sans-serif",e.fill="black",e.textBaseline="middle",e.textAlign="center",this.append([this.rect,this.label])}update(e){this.updateLabel(e),this.updateRect(e),this.updatePosition(e)}updateLabel({value:e,styles:t,context:i}){const{fontWeight:o,fontSize:s,fontStyle:a,fontFamily:n,textAlign:r,color:l="white",formatter:c}=t,h=c?c({value:e}):i.formatScaleValue(e,"annotation-label");this.label.setProperties({fontWeight:o,fontSize:s,fontStyle:a,fontFamily:n,textAlign:r,fill:l,text:h})}updateRect({styles:e}){const{rect:t}=this,{cornerRadius:i,fill:o,fillOpacity:s,stroke:a,strokeOpacity:n}=e;t.fill=o,t.fillOpacity=s??1,t.stroke=a,t.strokeOpacity=n??1,t.cornerRadius=i??0}updatePosition({x:e,y:t,context:i,styles:{padding:o}}){const{label:s,rect:a}=this,n=s.getBBox()?.clone(),r=o??8,l=o??4,{xTranslation:c,yTranslation:h}=l2({yDirection:!0,padding:i.labelPadding,position:i.position??"left",bbox:n});n.grow(r,"horizontal"),n.grow(l,"vertical");const d=e+c,u=t+h;s.x=d,s.y=u,a.y=u-Math.round(n.height/2),a.x=d-Math.round(n.width/2),a.height=n.height,a.width=n.width}};Hy.className="AxisLabel";import{_ModuleSupport as Wy}from"ag-charts-community";import{Vec2 as Ki,jsonDiff as c2}from"ag-charts-core";var _t=class extends Wy.Line{constructor(){super(...arguments),this.growCollisionBox=9,this.clipMask=new Map}setProperties(e){return super.setProperties(e),this.updateCollisionBBox(),this}updateCollisionBBox(){const{growCollisionBox:e,strokeWidth:t,x1:i,y1:o,x2:s,y2:a}=this;let n=t+e;n%2===0&&(n+=1);const r=Ki.from(i,o-Math.floor(n/2)),l=Ki.from(s,a),c=Ki.distance(r,l);this.collisionBBox=new Wy.BBox(r.x,r.y,c,n)}isPointInPath(e,t){const{collisionBBox:i,x1:o,y1:s,x2:a,y2:n}=this;if(!i)return!1;const r=Ki.from(o,s),l=Ki.from(a,n),c=Ki.sub(Ki.from(e,t),r),h=Ki.sub(l,r),d=Ki.rotate(c,Ki.angle(c,h),r);return i.containsPoint(d.x,d.y)??!1}render(e){const{clipMask:t}=this,{ctx:i}=e;if(t.size===0){super.render(e);return}i.save();try{for(const o of this.clipMask.values()){const{x:s,y:a,radius:n}=o;i.beginPath(),i.rect(0,0,i.canvas.width,i.canvas.height),i.ellipse(s,a,n,n,0,Math.PI*2,0,!0),i.clip()}super.render(e)}finally{i.restore()}}setClipMask(e,t){const i=this.clipMask.get(e);c2(i,t)!=null&&this.markDirty("CollidableLine"),t?this.clipMask.set(e,t):this.clipMask.delete(e)}};import{_ModuleSupport as h2}from"ag-charts-community";var ws=class extends h2.TransformableText{constructor(){super(...arguments),this.growCollisionBox={top:4,right:4,bottom:4,left:4}}isPointInPath(e,t){const i=this.fromParentPoint(e,t),o=this.computeBBoxWithoutTransforms();return o?o.grow(this.growCollisionBox).containsPoint(i.x,i.y):!1}};import{Vec2 as St}from"ag-charts-core";function Aa(e,t,i,o,s,a,n){if(!a||!s||!o){t.setClipMask(e);return}const{alignment:r,position:l}=o,c=Gy(i,o.fontSize,n),{point:h,textBaseline:d}=$y(c,l,r);Yy(s,a,o,h,c.angle,d);const{x:u,y:g,width:m,height:y}=s.getBBox(),S=St.length(St.from(m,y)),x={x:u+m/2,y:g+y/2,radius:S/2+St.length(c.offset)};return l==="center"?t.setClipMask(e,x):t.setClipMask(e),{clipMask:x,numbers:c}}function Ky(e,t,i,o,s,a,n){if(!n||!a)return;const{alignment:r,position:l}=o,[c,h]=t.y1<=i.y1?[t,i]:[i,t];let d=c;l==="bottom"?d=h:l==="inside"&&(d={x1:(c.x1+h.x1)/2,y1:(c.y1+h.y1)/2,x2:(c.x2+h.x2)/2,y2:(c.y2+h.y2)/2});const u=Gy(d,o.fontSize,s),{point:g,textBaseline:m}=$y(u,l==="inside"?"center":l,r,e);Yy(a,n,o,g,u.angle,m)}function Gy(e,t,i){let[o,s]=St.from(e);o.x>s.x&&([o,s]=[s,o]);const a=St.normalized(St.sub(s,o)),n=St.angle(a),r=St.multiply(a,Ae.HANDLE_SIZE/2+(t??14)/2),l=St.multiply(a,(i??2)/2+(t??14)/3);return{left:o,right:s,normal:a,angle:n,inset:r,offset:l}}function $y({left:e,right:t,normal:i,angle:o,inset:s,offset:a},n,r,l){let c;r==="right"?c=St.sub(t,s):r==="center"?c=St.add(e,St.multiply(i,St.distance(e,t)/2)):c=St.add(e,s);let h="bottom";return n==="bottom"?(c=St.rotate(a,o+Math.PI/2,c),h="top"):n==="center"&&!l?h="middle":c=St.rotate(a,o-Math.PI/2,c),{point:c,textBaseline:h}}function Yy(e,t,i,o,s,a){e.setProperties({text:t,x:o.x,y:o.y,rotation:s,rotationCenterX:o.x,rotationCenterY:o.y,fill:i.color,fontFamily:i.fontFamily,fontSize:i.fontSize,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textAlign:i.alignment,textBaseline:a})}var Ko=class extends Qe{constructor(){super(),this.type="cross-line",this.line=new _t,this.middle=new Da,this.isHorizontal=!1,this.append([this.line,this.middle])}static is(e){return Qe.isCheck(e,"cross-line")}update(e,t){const{seriesRect:i}=t;this.seriesRect=i,this.isHorizontal=xt.is(e);const o=this.isHorizontal?t.yAxis:t.xAxis,s=this.convertCrossLine(e,o);if(s==null){this.visible=!1;return}this.visible=e.visible??!0,this.visible&&(this.updateLine(e,s),this.updateHandle(e,s),this.updateText(e,s),this.updateAxisLabel(e,o,s))}updateLine(e,t){const{line:i}=this,{lineDashOffset:o,stroke:s,strokeWidth:a,strokeOpacity:n}=e,{x1:r,y1:l,x2:c,y2:h}=t;i.setProperties({x1:r,y1:l,x2:c,y2:h,lineCap:e.getLineCap(),lineDash:e.getLineDash(),lineDashOffset:o,stroke:s,strokeWidth:a,strokeOpacity:n,fillOpacity:0})}updateHandle(e,t){const{middle:i}=this,{locked:o,stroke:s,strokeWidth:a,strokeOpacity:n}=e,r={fill:e.handle.fill,stroke:e.handle.stroke??s,strokeOpacity:e.handle.strokeOpacity??n,strokeWidth:e.handle.strokeWidth??a},l=Ts.sub(fd.center(t),Ts.from(i.handle.width/2,i.handle.height/2));i.gradient=this.isHorizontal?"horizontal":"vertical",i.update({...r,...l}),i.toggleLocked(o??!1)}updateText(e,t){this.text=this.updateNode(ws,this.text,!!e.text.label),Aa(this.line.id,this.line,t,e.text,this.text,e.text.label,e.strokeWidth)}createAxisLabel(e){const t=new Hy;return e.attachLabel(t),t}updateAxisLabel(e,t,i){this.axisLabel??(this.axisLabel=this.createAxisLabel(t));const{axisLabel:o,seriesRect:s}=this,{direction:a,position:n}=t;if(e.axisLabel.enabled){o.visible=this.visible;const r=n==="left"||n==="top"?fd.start(i):fd.end(i),l=a===r2.X?r.x:r.y;if(!t.inRange(l)){o.visible=!1;return}const c=We(e.value);o.update({...Ts.add(r,Ts.required(s)),value:c,styles:e.axisLabel,context:t})}else o.visible=!1}setAxisLabelOpacity(e){this.axisLabel&&(this.axisLabel.opacity=e)}setAxisLabelVisible(e){this.axisLabel&&(this.axisLabel.visible=e)}toggleHandles(e){this.middle.visible=e,this.middle.toggleHovered(this.activeHandle==="middle")}destroy(){super.destroy(),this.axisLabel?.destroy()}toggleActive(e){this.toggleHandles(e),this.middle.toggleActive(e)}dragStart(e,t,i){const o=xt.is(e)?{x:t.x,y:ro(e.value,i.yAxis)}:{x:ro(e.value,i.xAxis),y:t.y};this.dragState={offset:t,middle:o}}drag(e,t,i){const{activeHandle:o,dragState:s}=this;!e.isWriteable()||!s||(o&&this[o].toggleDragging(!0),this.translatePoint(e,s.middle,Ts.sub(t,s.offset),i))}translate(e,t,i){if(!e.isWriteable())return;const o=xt.is(e)?Ts.from(0,ro(e.value,i.yAxis)):Ts.from(ro(e.value,i.xAxis),0);this.translatePoint(e,o,t,i)}translatePoint(e,t,i,o){const s=xt.is(e);s?i.x=0:i.y=0;const{point:a}=yo({point:t},i,o);e.value=s?a.y:a.x}stopDragging(){this.middle.toggleDragging(!1)}copy(e,t,i){const o=xt.is(e),s=this.isHorizontal?i.yAxis:i.xAxis,a=this.convertCrossLine(e,s);if(!a)return;const n=o?-30:0,r=o?0:-30,l=It({x:a.x1+r,y:a.y1+n},i);return t.set({value:o?l.y:l.x}),t}getCursor(){return this.activeHandle==null?"pointer":this[this.activeHandle].getCursor()}containsPoint(e,t){const{middle:i,line:o,text:s}=this;return this.activeHandle=void 0,i.containsPoint(e,t)?(this.activeHandle="middle",!0):o.isPointInPath(e,t)||!!s?.containsPoint(e,t)}getNodeAtCoords(e,t){if(this.text?.containsPoint(e,t))return"text";if(this.line.isPointInPath(e,t))return"line";if(this.middle.containsPoint(e,t))return"handle"}getAnchor(){const e=this.computeBBoxWithoutHandles();return this.isHorizontal?{x:e.x+e.width/2,y:e.y}:{x:e.x+e.width,y:e.y+e.height/2,position:"right"}}convertCrossLine(e,t){if(e.value==null)return;let i=0,o=0,s,a;const{bounds:n}=t,r=ro(e.value,t);return xt.is(e)?(s=n.width,o=r,a=r):(i=r,s=r,a=n.height),{x1:i,y1:o,x2:s,y2:a}}};import"ag-charts-community";import{Debug as d2,StateMachine as hl,StateMachineProperty as p2}from"ag-charts-core";var xd=class extends hl{constructor(e,t){const i=({point:s})=>{const a=e==="horizontal",n=a?new xt:new Fi;n.set({value:a?s.y:s.x}),t.create(n),t.recordAction(`Create ${a?"horizontal-line":"vertical-line"} annotation`)},o=()=>{this.node?.toggleActive(!0),t.showAnnotationOptions(),t.update()};super("start",{start:{click:{target:"waiting-first-render",action:i},drag:{target:"waiting-first-render",action:i},reset:hl.parent,cancel:hl.parent},"waiting-first-render":{render:{target:hl.parent,action:o}}}),this.debug=d2.create(!0,"annotations")}};p([p2()],xd.prototype,"node",2);var Uy={type:"horizontal-line",datum:xt,scene:Ko,isDatum:xt.is,translate:(e,t,i,o)=>{xt.is(t)&&Ko.is(e)&&e.translate(t,i,o)},copy:(e,t,i,o)=>{if(xt.is(t)&&xt.is(i)&&Ko.is(e))return e.copy(t,i,o)},update:(e,t,i)=>{xt.is(t)&&Ko.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new xd("horizontal",{...e,create:t("horizontal-line")}),dragState:e=>new _e(e)},jy={type:"vertical-line",datum:Fi,scene:Ko,isDatum:Fi.is,translate:(e,t,i,o)=>{Fi.is(t)&&Ko.is(e)&&e.translate(t,i,o)},copy:(e,t,i,o)=>{if(Fi.is(t)&&Fi.is(i)&&Ko.is(e))return e.copy(t,i,o)},update:(e,t,i)=>{Fi.is(t)&&Ko.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new xd("vertical",{...e,create:t("vertical-line")}),dragState:e=>new _e(e)};import{Vec2 as ui,Vec4 as Go}from"ag-charts-core";import{_ModuleSupport as Xy}from"ag-charts-community";import{Vec4 as u2}from"ag-charts-core";var Zy=class{static updateBackground(e,t,i,o){const{background:s}=this,{seriesRect:a}=o;s.path.clear(!0);const n=u2.from(0,0,a.width,a.height),r=this.getBackgroundPoints(e,t,i,n);for(let c=0;c<r.length;c++){const h=r[c];c===0?s.path.moveTo(h.x,h.y):s.path.lineTo(h.x,h.y)}s.path.closePath(),s.checkPathDirty();const l=this.getBackgroundStyles?.(e)??e.background;s.fill=l.fill,s.fillOpacity=l.fillOpacity??1}},qy=class extends Ey{constructor(){super(...arguments),this.handles={},this.overflowContinuous=2,this.topLine=new _t,this.bottomLine=new _t,this.background=new Xy.Path({zIndex:-1}),this.anchor={x:0,y:0},this.updateBackground=Zy.updateBackground.bind(this)}update(e,t){const{locked:i,visible:o}=e,s=Mt(e,t),a=Mt(e.bottom,t);if(s==null||a==null){this.visible=!1;return}else this.visible=o??!0;const n=this.extendLine(s,e,t),r=this.extendLine(a,e,t);this.updateLines(e,n,r,t,s,a),this.updateHandles(e,s,a),this.updateText(e,s,a),this.updateBackground(e,n,r,t),this.updateAnchor(s,a);for(const l of Object.values(this.handles))l.toggleLocked(i??!1)}toggleHandles(e){const{handles:t}=this;if(typeof e=="boolean"){for(const[i,o]of Object.entries(t))o.visible=e,o.toggleHovered(this.activeHandle===i);return}for(const[i,o]of Object.entries(e)){const s=t[i];s.visible=o??!0,s.toggleHovered(this.activeHandle===i)}}toggleActive(e){this.toggleHandles(e);for(const t of Object.values(this.handles))t.toggleActive(e)}stopDragging(){const{activeHandle:e,handles:t}=this;e!=null&&t[e].toggleDragging(!1)}getAnchor(){return this.anchor}getCursor(){return this.activeHandle==null?"pointer":this.handles[this.activeHandle].getCursor()}containsPoint(e,t){const{handles:i,topLine:o,bottomLine:s,text:a}=this;this.activeHandle=void 0;for(const[n,r]of Object.entries(i))if(r.containsPoint(e,t))return this.activeHandle=n,!0;return o.containsPoint(e,t)||s.containsPoint(e,t)||!!a?.containsPoint(e,t)}getNodeAtCoords(e,t){if(this.text?.containsPoint(e,t))return"text";if(this.topLine.containsPoint(e,t)||this.bottomLine.containsPoint(e,t))return"line";for(const[,i]of Object.entries(this.handles))if(i.containsPoint(e,t))return"handle"}updateAnchor(e,t){const{x:i,y:o}=Xy.Transformable.toCanvasPoint(this.topLine,(e.x1+e.x2)/2,Math.min(e.y1,e.y2,t.y1,t.y2));this.anchor.x=i,this.anchor.y=o}},dl=class extends qy{constructor(){super(),this.type="disjoint-channel",this.handles={topLeft:new Ae,topRight:new Ae,bottomLeft:new Ae,bottomRight:new Da},this.append([this.background,this.topLine,this.bottomLine,...Object.values(this.handles)])}static is(e){return Qe.isCheck(e,"disjoint-channel")}dragHandle(e,t,i,o){const{activeHandle:s,handles:a}=this;if(s==null)return;const{offset:n}=a[s].drag(t);a[s].toggleDragging(!0),s==="bottomRight"&&(n.x=0);let r=[],l=[],c=o;switch(s){case"topLeft":r=["topLeft"],l=["bottomLeft"];break;case"bottomLeft":r=["bottomLeft"],l=["topLeft"];break;case"topRight":r=["topRight"],l=["bottomRight"];break;case"bottomRight":r=["bottomLeft","bottomRight"],c=!1;break}const h=Mt(e,i),d=Mt(e.bottom,i);if(!h||!d)return;const u={topLeft:Go.start(h),topRight:Go.end(h),bottomLeft:Go.start(d),bottomRight:Go.end(d)},g={vectors:{topLeft:u.topRight,bottomLeft:u.bottomRight,topRight:u.topLeft,bottomRight:u.bottomLeft},angle:e.snapToAngle},m=yo(u,n,i,{overflowContinuous:this.overflowContinuous,translateVectors:r,invertYVectors:l,snap:c?g:void 0});e.start.x=m.topLeft.x,e.start.y=m.topLeft.y,e.end.x=m.topRight.x,e.end.y=m.topRight.y,e.startHeight=m.topLeft.y-m.bottomLeft.y,e.endHeight=m.topRight.y-m.bottomRight.y}getTranslatePointsVectors(e,t){const{bottomLeft:i,bottomRight:o,topLeft:s,topRight:a}=this.handles,n=i.getBBox().y-s.getBBox().y,r=o.getBBox().y-a.getBBox().y,l=ui.add(e,ui.from(0,n)),c=ui.add(t,ui.from(0,r));return{start:e,end:t,bottomStart:l,bottomEnd:c}}updateLines(e,t,i){const{topLine:o,bottomLine:s}=this,{lineDashOffset:a,stroke:n,strokeOpacity:r,strokeWidth:l}=e,c={lineCap:e.getLineCap(),lineDash:e.getLineDash(),lineDashOffset:a,stroke:n,strokeOpacity:r,strokeWidth:l};o.setProperties({...t,...c}),s.setProperties({...i,...c})}updateHandles(e,t,i){const{handles:{topLeft:o,topRight:s,bottomLeft:a,bottomRight:n}}=this,r={fill:e.handle.fill,stroke:e.handle.stroke??e.stroke,strokeOpacity:e.handle.strokeOpacity??e.strokeOpacity,strokeWidth:e.handle.strokeWidth??e.strokeWidth};o.update({...r,...Go.start(t)}),s.update({...r,...Go.end(t)}),a.update({...r,...Go.start(i)}),n.update({...r,...ui.sub(Go.end(i),ui.from(n.handle.width/2,n.handle.height/2))})}updateText(e,t,i){this.text=this.updateNode(ws,this.text,!!e.text.label),Ky(!1,t,i,e.text,e.strokeWidth,this.text,e.text.label)}getBackgroundPoints(e,t,i,o){const s=t.x1>t.x2,a=t.y1>t.y2,n=a?o.y2:o.y1,r=a?o.y1:o.y2,l=ui.from(t);return e.extendEnd&&t.y2===r&&l.push(ui.from(s?o.x1:o.x2,a?o.y1:o.y2)),e.extendEnd&&i.y2===n&&l.push(ui.from(s?o.x1:o.x2,a?o.y2:o.y1)),l.push(...ui.from(i).reverse()),e.extendStart&&i.y1===r&&l.push(ui.from(s?o.x2:o.x1,a?o.y1:o.y2)),e.extendStart&&t.y1===n&&l.push(ui.from(s?o.x2:o.x1,a?o.y2:o.y1)),l}};import{Debug as g2,StateMachine as $o,StateMachineProperty as Sd,isNumber as Ma}from"ag-charts-core";var pl=class extends $o{constructor(e){const t=({point:l})=>{const c=new hi;c.set({start:l,end:l,startHeight:0,endHeight:0}),e.create(c)},i=()=>{const{node:l}=this;l?.toggleActive(!0),l?.toggleHandles({topLeft:!0,topRight:!1,bottomLeft:!1,bottomRight:!1})},o=({offset:l,context:c})=>{const{datum:h,snapping:d}=this;h&&(h.set({end:Bn(l,c,d,h.start,h.snapToAngle)}),e.update())},s=()=>{this.node?.toggleHandles({topRight:!0}),e.update()},a=({point:l})=>{const{datum:c,node:h}=this,d=We(c?.end.y),u=We(c?.start.y),{y:g}=l;if(c==null||!Ma(u)||!Ma(d)||!Ma(g))return;const m=d-(g??0),y=(u-d)*2+m,S={x:c?.start.x,y:u-y},x={x:c?.end.x,y:l.y};h?.toggleHandles({bottomLeft:!0,bottomRight:!0}),!(!e.validatePoint(S,{overflowContinuous:!0})||!e.validatePoint(x,{overflowContinuous:!0}))&&(c.set({startHeight:y,endHeight:m}),e.update())},n=({point:l})=>{const{datum:c,node:h}=this,d=We(c?.end.y),u=We(c?.start.y),{y:g}=l;if(c==null||!Ma(u)||!Ma(d)||!Ma(g))return;const m=d-(g??0),y=(u-d)*2+m,S={x:c.start.x,y:u-m},x={x:c.end.x,y:l.y};h?.toggleHandles(!0),!(!e.validatePoint(S,{overflowContinuous:!0})||!e.validatePoint(x,{overflowContinuous:!0}))&&(c.set({startHeight:y,endHeight:m}),e.recordAction("Create disjoint-channel annotation"),e.showAnnotationOptions(),e.update())},r=()=>e.delete();super("start",{start:{click:{target:"waiting-first-render",action:t},drag:{target:"waiting-first-render",action:t},reset:$o.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:o,drag:o,click:{target:"height",action:s},dragEnd:{target:"height",action:s},reset:{target:$o.parent,action:r},cancel:{target:$o.parent,action:r}},height:{hover:a,click:{target:$o.parent,action:n},drag:{target:$o.parent,action:n},reset:{target:$o.parent,action:r},cancel:{target:$o.parent,action:r}}}),this.debug=g2.create(!0,"annotations"),this.snapping=!1}};p([Sd()],pl.prototype,"datum",2),p([Sd()],pl.prototype,"node",2),p([Sd()],pl.prototype,"snapping",2);var Qy={type:"disjoint-channel",datum:hi,scene:dl,isDatum:hi.is,translate:(e,t,i,o)=>{hi.is(t)&&dl.is(e)&&e.translate(t,i,o)},copy:(e,t,i,o)=>{if(hi.is(t)&&hi.is(i)&&dl.is(e))return e.copy(t,i,o)},update:(e,t,i)=>{hi.is(t)&&dl.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new pl({...e,create:t("disjoint-channel")}),dragState:e=>new _e(e)};import{Vec2 as m2,Vec4 as Ps,entries as y2}from"ag-charts-core";import{_ModuleSupport as Yo}from"ag-charts-community";import{Vec2 as f2,Vec4 as Jy}from"ag-charts-core";var bd=[0,23.6,38.2,50,61.8,78.6,100],x2=[161.8,261.8,361.8,423.6],S2=[...bd,...x2],b2={10:S2,6:bd,4:bd.filter(e=>e!==78.6&&e!==23.6)},v2=10;function k2(e,t){const{x2:i,y1:o,y2:s}=e,a=o-s;return t==null?{x1:i,x2:i,y1:s-a,y2:s}:{x1:t.x1,x2:t.x2,y1:t.y2-a,y2:t.y2}}function ef({x1:e,y1:t,x2:i,y2:o},s,a,n,r=10){const l=t-o,c=a?-1:1;let h=n;const d=[];for(const[u,g]of b2[r].entries()){const m=n+l*(g/100)*c,y=s.yAxis.scaleInvert(m);d.push({id:u,x1:e,x2:i,y1:h,y2:m,tag:g==100?0:1,label:{x1:Math.min(e,i)-v2,x2:i,y1:m,y2:m,text:`${(g/100).toFixed(3)} (${y.toFixed(2)})`}}),h=m}return d}var tf=class extends Qe{constructor(){super(),this.trendLine=new _t,this.rangeFillsGroup=new Yo.Group({name:`${this.id}-range-fills`}),this.rangeFillsGroupSelection=Yo.Selection.select(this.rangeFillsGroup,Yo.Range),this.rangeStrokesGroup=new Yo.Group({name:`${this.id}-range-strokes`}),this.rangeStrokesGroupSelection=Yo.Selection.select(this.rangeStrokesGroup,_t),this.labelsGroup=new Yo.Group({name:`${this.id}-ranges-labels`}),this.labelsGroupSelection=Yo.Selection.select(this.labelsGroup,ws),this.anchor={x:0,y:0,position:"above"},this.append([this.trendLine,this.rangeFillsGroup,this.rangeStrokesGroup,this.labelsGroup])}update(e,t){let i=Mt(e,t);if(i==null){this.visible=!1;return}if(i=Jy.round(i),this.visible=e.visible??!0,!this.visible)return;this.updateLine(e,i,this.trendLine),this.updateHandles(e,i),this.updateAnchor(e,i,t);const{reverse:o}=e,s=this.extendLine(i,e,t),a=o?s.y1:s.y2,n=o?s.y2:s.y1,r=ef(s,t,e.reverse,a,e.bands);this.updateRanges(e,r,t);const l={...s,y1:n,y2:n};this.updateText(e,l)}extendLine({x1:e,y1:t,x2:i,y2:o},s,a){const n={x1:e,y1:t,x2:i,y2:o};if(!s.extendStart&&!s.extendEnd)return n;const{x:r,width:l}=a.xAxis.bounds;return s.extendEnd&&(n[e>i?"x1":"x2"]=r+l),s.extendStart&&(n[e>i?"x2":"x1"]=r),n}updateLine(e,t,i){if(!t||!i)return;const{lineDashOffset:o,strokeWidth:s,strokeOpacity:a,stroke:n}=e;i.setProperties({...t,lineCap:e.getLineCap(),lineDash:[3,4],lineDashOffset:o,strokeWidth:s,strokeOpacity:a,fillOpacity:0,stroke:n})}updateRangeStrokes(e){const{lineDashOffset:t,strokeWidth:i,strokeOpacity:o,strokes:s,rangeStroke:a,isMultiColor:n}=e;this.rangeStrokesGroupSelection.each((r,{x1:l,x2:c,y2:h,tag:d},u)=>{const g=h,m=n?s[u%s.length]:a;r.setProperties({x1:l,x2:c,y1:g,y2:g,stroke:m,strokeOpacity:o,strokeWidth:i,lineCap:e.getLineCap(),lineDash:e.getLineDash(),lineDashOffset:t,tag:d})})}updateRanges(e,t,i){const o=s=>s.id;this.rangeFillsGroupSelection.update(t,void 0,o),this.rangeStrokesGroupSelection.update(t,void 0,o),this.labelsGroupSelection.update(t,void 0,o),this.updateRangeFills(e),this.updateRangeStrokes(e),this.updateRangeLabels(e,i)}updateRangeFills(e){const{lineDashOffset:t,strokeWidth:i,strokeOpacity:o,strokes:s,rangeStroke:a,showFill:n,isMultiColor:r}=e;this.rangeFillsGroupSelection.each((l,{x1:c,x2:h,y1:d,y2:u},g)=>{const m=r?s[g%s.length]:a;if(!n){l.visible=!1;return}l.setProperties({x1:c,x2:h,y1:d,y2:u,startLine:!1,endLine:!1,stroke:m,strokeOpacity:o,fill:m,fillOpacity:(o??1)*.15,strokeWidth:i,lineCap:e.getLineCap(),lineDash:e.getLineDash(),lineDashOffset:t,visible:!0})})}updateRangeLabels(e,{xAxis:t}){const{rangeStrokesGroupSelection:i}=this,{strokes:o,strokeWidth:s,rangeStroke:a,isMultiColor:n,label:{fontFamily:r,fontSize:l,fontStyle:c,fontWeight:h,color:d}}=e,u={fontFamily:r,fontSize:l,fontStyle:c,fontWeight:h},g=this.checkWithinBounds(t,u,this.labelsGroupSelection.at(0));this.labelsGroupSelection.each((m,y,S)=>{const x=d??(n?o[S%o.length]:a),b=i.at(S);if(!b)return;const{text:f,...v}=y.label;if(g)m.setProperties({...u,text:f,x:v.x1,y:v.y1,textBaseline:"middle",textAlign:"end",fill:x}),Aa(m.id,b,v);else{const k={...u,label:f,position:"center",alignment:"left",color:x};Aa(m.id,b,v,k,m,f,s)}})}checkWithinBounds(e,t,i){if(!i)return!1;const{text:o,...s}=i.datum.label;i.setProperties({...t,text:o,x:s.x1,y:s.y1,textBaseline:"middle",textAlign:"end"});const{x:a}=i.getBBox();return a>=e.bounds.x&&a<=e.bounds.x+e.bounds.width}updateText(e,t){const i=this.rangeStrokesGroupSelection.selectByTag(0)[0];if(!i)return;const{text:o,strokeWidth:s}=e;this.text=this.updateNode(ws,this.text,!!o.label),Aa(i.id,i,t,o,this.text,o.label,s)}updateAnchor(e,t,i,o){const s=Jy.topCenter(t);f2.apply(this.anchor,Yo.Transformable.toCanvasPoint(this.trendLine,s.x,s.y))}containsPoint(e,t){const{trendLine:i,rangeStrokesGroupSelection:o,text:s}=this;let a=!1;return o.each(n=>a||(a=n.isPointInPath(e,t))),a||i.isPointInPath(e,t)||!!s?.containsPoint(e,t)}getNodeAtCoords(e,t){if(this.text?.containsPoint(e,t))return"text";if(this.trendLine.isPointInPath(e,t))return"line"}getHandleStyles(e){return{fill:e.handle.fill,stroke:e.handle.stroke??e.stroke,strokeOpacity:e.handle.strokeOpacity??e.strokeOpacity,strokeWidth:e.handle.strokeWidth??e.strokeWidth}}drag(e,t,i,o){e.isWriteable()&&(this.activeHandle?this.dragHandle(e,t,i,o):this.dragAll(e,t,i))}getAnchor(){return this.anchor}getCursor(){return"pointer"}};import{_ModuleSupport as D2}from"ag-charts-community";import{Logger as of}from"ag-charts-core";var{ContinuousScale:sf}=D2;function ul(e,t,i={overflowContinuous:!1},o){if(t.x==null||t.y==null)return o&&of.warnOnce(`${o}requires both an [x] and [y] property, ignoring.`),!1;const{xAxis:s,yAxis:a}=e,n=i.overflowContinuous&&sf.is(s.scale),r=i.overflowContinuous&&sf.is(a.scale),l=n||af(t.x,s),c=r||af(t.y,a);if(l&&c)return!0;if(o){let h="x & y domains";l&&(h="y domain"),c&&(h="x domain");const d=We(t.x),u=We(t.y);of.warnOnce(`${o}is outside the ${h}, ignoring. - x: [${d}], y: ${u}]`)}return!1}function af(e,t){const{domain:i}=t.scale,o=We(e);return i&&o!=null&&t.continuous?o>=i[0]&&o<=i.at(-1):!0}var gl=class extends tf{constructor(){super(),this.type="fibonacci-retracement-trend-based",this.endRetracementLine=new _t,this.start=new Ae,this.end=new Ae,this.endRetracement=new Ae,this.append([this.endRetracementLine,this.start,this.end,this.endRetracement])}static is(e){return Qe.isCheck(e,"fibonacci-retracement-trend-based")}update(e,t){let{coords1:i,coords2:o}=this.getCoords(e,t);if(i==null||o==null){this.visible=!1;return}if(i=Ps.round(i),o=Ps.round(o),this.visible=e.visible??!0,!this.visible)return;(e.endRetracement.x==null||e.endRetracement.y==null)&&(o=void 0),this.updateLine(e,i,this.trendLine),this.updateLine(e,o,this.endRetracementLine),this.updateHandles(e,i,o),this.updateAnchor(e,o??i,t);const{reverse:s,bands:a}=e,n=k2(i,o),r=this.extendLine(n,e,t),l=r.y2,c=r.y1,h=o?ef(r,t,s,l,a):[];this.updateRanges(e,h,t);const d={...r,y1:c,y2:c};this.updateText(e,d)}containsPoint(e,t){const{start:i,end:o,endRetracement:s,endRetracementLine:a}=this;return this.activeHandle=void 0,i.containsPoint(e,t)?(this.activeHandle="start",!0):o.containsPoint(e,t)?(this.activeHandle="end",!0):s.containsPoint(e,t)?(this.activeHandle="endRetracement",!0):a.isPointInPath(e,t)||super.containsPoint(e,t)}getNodeAtCoords(e,t){return this.start.containsPoint(e,t)||this.end.containsPoint(e,t)||this.endRetracement.containsPoint(e,t)?"handle":this.endRetracementLine.isPointInPath(e,t)?"line":super.getNodeAtCoords(e,t)}dragStart(e,t,i){this.dragState={offset:t,...ol({start:e.start,end:e.end,endRetracement:e.endRetracement},i)}}stopDragging(){this.start.toggleDragging(!1),this.end.toggleDragging(!1),this.endRetracement.toggleDragging(!1)}dragAll(e,t,i){const{dragState:o}=this;o&&this.translatePoints({datum:e,start:o.start,end:o.end,endRetracement:o.endRetracement,translation:m2.sub(t,o.offset),context:i})}dragHandle(e,t,i,o){const{activeHandle:s,dragState:a}=this;if(!s||!a)return;this[s].toggleDragging(!0);const n=o?this.snapToAngle(e,t,i):It(this[s].drag(t).point,i);!n||!ul(i,n)||(e[s].x=n.x,e[s].y=n.y)}snapToAngle(e,t,i){const{activeHandle:o}=this,s=["start","end","endRetracement"];if(!o)return;const a=(s.indexOf(o)+1)%s.length,n=s[a];this[o].toggleDragging(!0);const r=De(e[n],i);return It(il(t,r,e.snapToAngle),i)}translatePoints({datum:e,start:t,end:i,endRetracement:o,translation:s,context:a}){const n=yo({start:t,end:i,endRetracement:o},s,a,{overflowContinuous:2});e.start.x=n.start.x,e.end.x=n.end.x,e.endRetracement.x=n.endRetracement.x,e.start.y=n.start.y,e.end.y=n.end.y,e.endRetracement.y=n.endRetracement.y}translate(e,t,i){this.translatePoints({datum:e,start:De(e.start,i),end:De(e.end,i),endRetracement:De(e.endRetracement,i),translation:t,context:i})}copy(e,t,i){const{coords1:o,coords2:s}=this.getCoords(e,i);if(!o||!s)return;const a=this.computeBBoxWithoutHandles();return this.translatePoints({datum:t,start:Ps.start(o),end:Ps.end(o),endRetracement:Ps.end(s),translation:{x:-a.width/2,y:-a.height/2},context:i}),t}getCoords(e,t){return{coords1:Mt(e,t),coords2:Mt({start:e.end,end:e.endRetracement},t)}}toggleHandles(e){if(typeof e=="boolean")this.start.visible=e,this.end.visible=e,this.endRetracement.visible=e;else for(const[t,i]of y2(e))this[t].visible=i;this.start.toggleHovered(this.activeHandle==="start"),this.end.toggleHovered(this.activeHandle==="end"),this.endRetracement.toggleHovered(this.activeHandle==="endRetracement")}toggleActive(e){this.toggleHandles(e),this.start.toggleActive(e),this.end.toggleActive(e),this.endRetracement.toggleActive(e)}updateHandles(e,t,i,o){this.start.update({...this.getHandleStyles(e),...this.getHandleCoords(e,t,"start")}),this.end.update({...this.getHandleStyles(e),...this.getHandleCoords(e,t,"end",o)}),i&&this.endRetracement.update({...this.getHandleStyles(e),...this.getHandleCoords(e,i,"endRetracement",o)}),this.start.toggleLocked(e.locked??!1),this.end.toggleLocked(e.locked??!1),this.endRetracement.toggleLocked(e.locked??!1)}getHandleCoords(e,t,i,o){return i==="start"?Ps.start(t):Ps.end(t)}};import{Debug as A2,StateMachine as Uo,StateMachineProperty as vd}from"ag-charts-core";var ml=class extends Uo{constructor(e){const t=({point:c})=>{const h=this.createDatum();h.set({start:c,end:c}),e.create(h)},i=()=>{const{node:c}=this;c?.toggleActive(!0),c?.toggleHandles({start:!0,end:!1,endRetracement:!1})},o=({offset:c,context:h})=>{const{datum:d,snapping:u}=this;d&&(d.set({end:Bn(c,h,u,d.start,d.snapToAngle)}),e.update())},s=()=>{const{datum:c}=this;c&&(c.endRetracement.x=c.end.x,c.endRetracement.y=c.end.y,this.node?.toggleHandles({end:!0}),e.update())},a=({offset:c,context:h})=>{const{datum:d,snapping:u}=this;d&&(d.set({endRetracement:Bn(c,h,u,d.end,d.snapToAngle)}),e.update())},n=()=>{this.node?.toggleHandles({endRetracement:!0}),e.update()},r=()=>e.delete(),l=()=>{e.showAnnotationOptions(),e.recordAction(`Create ${this.datum?.type} annotation`)};super("start",{start:{click:{target:"waiting-first-render",action:t},drag:{target:"waiting-first-render",action:t},reset:Uo.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:o,click:{target:"endRetracement",action:s},drag:o,dragEnd:{target:"endRetracement",action:s},reset:{target:Uo.parent,action:r},cancel:{target:Uo.parent,action:r},onExit:l},endRetracement:{hover:a,click:{target:Uo.parent,action:n},drag:{target:Uo.parent,action:n},reset:{target:Uo.parent,action:r},cancel:{target:Uo.parent,action:r}}}),this.debug=A2.create(!0,"annotations"),this.snapping=!1}createDatum(){return new Hi}};p([vd()],ml.prototype,"datum",2),p([vd()],ml.prototype,"node",2),p([vd()],ml.prototype,"snapping",2);var nf={type:"fibonacci-retracement-trend-based",datum:Hi,scene:gl,isDatum:Hi.is,translate:(e,t,i,o)=>{Hi.is(t)&&gl.is(e)&&e.translate(t,i,o)},copy:(e,t,i,o)=>{if(Hi.is(t)&&Hi.is(i)&&gl.is(e))return e.copy(t,i,o)},update:(e,t,i)=>{Hi.is(t)&&gl.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new ml({...e,create:t("fibonacci-retracement-trend-based")}),dragState:e=>new _e(e)};import{Vec2 as M2,Vec4 as rf,entries as I2}from"ag-charts-core";var yl=class extends tf{constructor(){super(),this.type="fibonacci-retracement",this.start=new Ae,this.end=new Ae,this.append([this.start,this.end])}static is(e){return Qe.isCheck(e,"fibonacci-retracement")}containsPoint(e,t){const{start:i,end:o}=this;return this.activeHandle=void 0,i.containsPoint(e,t)?(this.activeHandle="start",!0):o.containsPoint(e,t)?(this.activeHandle="end",!0):super.containsPoint(e,t)}getNodeAtCoords(e,t){return this.start.containsPoint(e,t)||this.end.containsPoint(e,t)?"handle":super.getNodeAtCoords(e,t)}dragStart(e,t,i){this.dragState={offset:t,...ol({start:e.start,end:e.end},i)}}stopDragging(){this.start.toggleDragging(!1),this.end.toggleDragging(!1)}dragAll(e,t,i){const{dragState:o}=this;o&&this.translatePoints({datum:e,start:o.start,end:o.end,translation:M2.sub(t,o.offset),context:i})}dragHandle(e,t,i,o){const{activeHandle:s,dragState:a}=this;if(!s||!a)return;this[s].toggleDragging(!0);const n=o?this.snapToAngle(e,t,i):It(this[s].drag(t).point,i);!n||!ul(i,n)||(e[s].x=n.x,e[s].y=n.y)}snapToAngle(e,t,i){const{activeHandle:o}=this,a=["start","end"].find(r=>r!==o);if(!o||!a)return;this[o].toggleDragging(!0);const n=De(e[a],i);return It(il(t,n,e.snapToAngle),i)}translatePoints({datum:e,start:t,end:i,translation:o,context:s}){const a=yo({start:t,end:i},o,s,{overflowContinuous:1});e.start.x=a.start.x,e.end.x=a.end.x,e.start.y=a.start.y,e.end.y=a.end.y}translate(e,t,i){this.translatePoints({datum:e,start:De(e.start,i),end:De(e.end,i),translation:t,context:i})}copy(e,t,i){const o=Mt(e,i);if(!o)return;const s=this.computeBBoxWithoutHandles();return this.translatePoints({datum:t,start:{x:o.x1,y:o.y1},end:{x:o.x2,y:o.y2},translation:{x:-s.width/2,y:-s.height/2},context:i}),t}toggleHandles(e){if(typeof e=="boolean")this.start.visible=e,this.end.visible=e;else for(const[t,i]of I2(e))this[t].visible=i;this.start.toggleHovered(this.activeHandle==="start"),this.end.toggleHovered(this.activeHandle==="end")}toggleActive(e){this.toggleHandles(e),this.start.toggleActive(e),this.end.toggleActive(e)}updateHandles(e,t,i,o){this.start.update({...this.getHandleStyles(e),...this.getHandleCoords(e,t,"start")}),this.end.update({...this.getHandleStyles(e),...this.getHandleCoords(e,t,"end",o)}),this.start.toggleLocked(e.locked??!1),this.end.toggleLocked(e.locked??!1)}getHandleCoords(e,t,i,o){return i==="start"?rf.start(t):rf.end(t)}};import{Debug as L2,StateMachine as Ia,StateMachineProperty as kd}from"ag-charts-core";var La=class extends Ia{constructor(e){const t=({point:r})=>{const l=this.createDatum();l.set({start:r,end:r}),e.create(l)},i=()=>{const{node:r}=this;r?.toggleActive(!0),r?.toggleHandles({start:!0,end:!1})},o=({offset:r,context:l})=>{const{datum:c,snapping:h}=this;c&&(c.set({end:Bn(r,l,h,c.start,c.snapToAngle)}),e.update())},s=()=>{this.node?.toggleHandles({end:!0}),e.update()},a=()=>e.delete(),n=()=>{e.showAnnotationOptions(),e.recordAction(`Create ${this.datum?.type} annotation`)};super("start",{start:{click:{target:"waiting-first-render",action:t},drag:{target:"waiting-first-render",action:t},reset:Ia.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:o,click:{target:Ia.parent,action:s},drag:o,dragEnd:{target:Ia.parent,action:s},reset:{target:Ia.parent,action:a},cancel:{target:Ia.parent,action:a},onExit:n}}),this.debug=L2.create(!0,"annotations"),this.snapping=!1}};p([kd()],La.prototype,"datum",2),p([kd()],La.prototype,"node",2),p([kd()],La.prototype,"snapping",2);var N2=class extends La{createDatum(){return new co}},C2=class extends La{createDatum(){return new ho}},T2=class extends La{createDatum(){return new uo}},lf={type:"fibonacci-retracement",datum:uo,scene:yl,isDatum:uo.is,translate:(e,t,i,o)=>{uo.is(t)&&yl.is(e)&&e.translate(t,i,o)},copy:(e,t,i,o)=>{if(uo.is(t)&&uo.is(i)&&yl.is(e))return e.copy(t,i,o)},update:(e,t,i)=>{uo.is(t)&&yl.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new T2({...e,create:t("fibonacci-retracement")}),dragState:e=>new _e(e)};import{_ModuleSupport as w2}from"ag-charts-community";import{Vec2 as Li,Vec4 as cf}from"ag-charts-core";import{_ModuleSupport as hf}from"ag-charts-community";import{Vec2 as zn}from"ag-charts-core";var P2=class extends hf.Group{},fl=class extends P2{constructor(){super(),this.type="arrow",this.path=new hf.Path,this.armLength=6,this.append([this.path])}update(e){const{path:t}=this,{x:i,y:o,angle:s,...a}=e,n=zn.from(i,o),r=3*Math.PI/4,l=this.armLength+(e.strokeWidth??0)*2,c=zn.rotate(zn.from(0,l),s+r,n),h=zn.rotate(zn.from(l,0),s-r,n);t.setProperties(a),t.fillOpacity=0,t.path.clear(),t.path.moveTo(c.x,c.y),t.path.lineTo(n.x,n.y),t.path.lineTo(h.x,h.y)}},{Transformable:O2}=w2,jo=class extends dd{constructor(){super(),this.type="line",this.line=new _t,this.append([this.line,this.start,this.end])}static is(e){return Qe.isCheck(e,"line")}update(e,t){let i=Mt(e,t);if(i==null){this.visible=!1;return}i=cf.round(i),this.visible=e.visible??!0,this.visible&&(this.updateLine(e,i,t),this.updateHandles(e,i),this.updateText(e,i),this.updateCaps(e,i),this.updateAnchor(e,i,t))}updateLine(e,t,i){const{line:o}=this,{lineDashOffset:s,stroke:a,strokeWidth:n,strokeOpacity:r}=e,l=this.extendLine(t,e,i);o.setProperties({...l,lineCap:e.getLineCap(),lineDash:e.getLineDash(),lineDashOffset:s,stroke:a,strokeWidth:n,strokeOpacity:r,fillOpacity:0})}updateText(e,t){this.text=this.updateNode(ws,this.text,!!e.text.label),Aa(this.line.id,this.line,t,e.text,this.text,e.text.label,e.strokeWidth)}updateCaps(e,t){if(!e.startCap&&this.startCap&&(this.startCap.remove(),this.startCap=void 0),!e.endCap&&this.endCap&&(this.endCap.remove(),this.endCap=void 0),!e.startCap&&!e.endCap)return;const{stroke:i,strokeWidth:o,strokeOpacity:s}=e,[a,n]=Li.from(t),r=Li.angle(Li.sub(n,a));e.startCap&&(this.startCap&&this.startCap.type!==e.startCap&&(this.startCap.remove(),this.startCap=void 0),this.startCap==null&&(this.startCap=new fl,this.append([this.startCap])),this.startCap.update({x:a.x,y:a.y,angle:r-Math.PI,stroke:i,strokeWidth:o,strokeOpacity:s})),e.endCap&&(this.endCap&&this.endCap.type!==e.endCap&&(this.endCap.remove(),this.endCap=void 0),this.endCap==null&&(this.endCap=new fl,this.append([this.endCap])),this.endCap.update({x:n.x,y:n.y,angle:r,stroke:i,strokeWidth:o,strokeOpacity:s}))}updateAnchor(e,t,i,o){const s=cf.topCenter(t);Li.apply(this.anchor,O2.toCanvasPoint(this.line,s.x,s.y))}containsPoint(e,t){const{line:i,text:o}=this;return super.containsPoint(e,t)||i.isPointInPath(e,t)||!!o?.containsPoint(e,t)}getNodeAtCoords(e,t){return this.text?.containsPoint(e,t)?"text":this.line.isPointInPath(e,t)?"line":super.getNodeAtCoords(e,t)}getHandleCoords(e,t,i,o){const{startCap:s,endCap:a}=this;let[n,r]=Li.from(t);const l=Li.angle(Li.sub(r,n));return s&&(n=Li.rotate(Li.from(0,-Ae.HANDLE_SIZE/2),l,n)),a&&(r=Li.rotate(Li.from(0,Ae.HANDLE_SIZE/2),l,r)),i==="start"?n:r}getHandleStyles(e){return{fill:e.handle.fill,stroke:e.handle.stroke??e.stroke,strokeOpacity:e.handle.strokeOpacity??e.strokeOpacity,strokeWidth:e.handle.strokeWidth??e.strokeWidth}}},df={type:"line",datum:ho,scene:jo,isDatum:ho.is,translate:(e,t,i,o)=>{ho.is(t)&&jo.is(e)&&e.translate(t,i,o)},copy:(e,t,i,o)=>{if(ho.is(t)&&ho.is(i)&&jo.is(e))return e.copy(t,i,o)},update:(e,t,i)=>{ho.is(t)&&jo.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new C2({...e,create:t("line")}),dragState:e=>new _e(e)},pf={type:"arrow",datum:co,scene:jo,isDatum:co.is,translate:(e,t,i,o)=>{co.is(t)&&jo.is(e)&&e.translate(t,i,o)},copy:(e,t,i,o)=>{if(co.is(t)&&co.is(i)&&jo.is(e))return e.copy(t,i,o)},update:(e,t,i)=>{co.is(t)&&jo.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new N2({...e,create:t("arrow")}),dragState:e=>new _e(e)};import{_ModuleSupport as uf}from"ag-charts-community";import{Vec2 as Gi,Vec4 as Os,isDate as gf,isNumber as xl}from"ag-charts-core";import{_ModuleSupport as Ni}from"ag-charts-community";import{Vec4 as Dd}from"ag-charts-core";import{_ModuleSupport as mf}from"ag-charts-community";function yf(e,t=0,i=0){let o=t;for(const s of e)if(Array.isArray(s)){for(const a of s)ff(a,o);o+=mf.Group.computeChildrenBBox(s).width+i}else ff(s,o),o+=s.getBBox().width+i}function R2(e,t=0,i=0){let o=t;for(const s of e)if(Array.isArray(s)){for(const a of s)xf(a,o);o+=mf.Group.computeChildrenBBox(s).height+i}else xf(s,o),o+=s.getBBox().height+i}function ff(e,t){"x1"in e?(e.x2=t+(e.x2-e.x1),e.x1=t):e.x=t}function xf(e,t){"y1"in e?(e.y2=t+(e.y2-e.y1),e.y1=t):e.y=t}function Sf(e,t){"x1"in e?(e.x1+=t,e.x2+=t):e.x+=t}function bf(e,t){"y1"in e?(e.y1+=t,e.y2+=t):e.y+=t}var vf=class extends Ni.Group{constructor(){super(),this.name="MeasurerStatisticsScene",this.background=new Ni.Rect,this.dateRangeBarsText=new Ni.Text,this.dateRangeDivider=new Ni.Line,this.dateRangeValueText=new Ni.Text,this.priceRangeValueText=new Ni.Text,this.priceRangeDivider=new Ni.Line,this.priceRangePercentageText=new Ni.Text,this.volumeText=new Ni.Text,this.volumeFormatter=new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2}),this.append([this.background,this.dateRangeBarsText,this.dateRangeDivider,this.dateRangeValueText,this.priceRangeValueText,this.priceRangeDivider,this.priceRangePercentageText,this.volumeText])}update(e,t,i,o,s,a,n){this.verticalDirection=a;const r=this.updateStatistics(e,t,i,n),l=Ni.Group.computeChildrenBBox(r.flat()),c=10;l.grow(c),this.updateBackground(e,l,c),this.reposition(r,c,s),this.checkVisibility(e,s,o)}checkVisibility(e,t,i){const o=Dd.from(t.seriesRect);this.visible=Dd.collides(i,o)&&(e.visible??!0)}updateStatistics(e,t,i,o){const{dateRangeBarsText:s,dateRangeDivider:a,dateRangeValueText:n,priceRangeValueText:r,priceRangeDivider:l,priceRangePercentageText:c,volumeText:h}=this,d=8,u=6,g=e.statistics.fontSize+3,m=-2,y=this.getTextStyles(e),S={...this.getDividerStyles(e),x1:0,y1:0,x2:0,y2:g},x=[s,a,n],b=[r,l,c],f=[];return t.priceRange&&(r.setProperties({...y,text:this.formatPriceRangeValue(t.priceRange.value,o)}),l.setProperties(S),c.setProperties({...y,text:this.formatPriceRangePercentage(t.priceRange.percentage,o)}),yf(b,i.x,d),f.push(b)),t.dateRange&&(s.setProperties({...y,text:this.formatDateRangeBars(t.dateRange.bars,o)}),a.setProperties(S),n.setProperties({...y,text:this.formatDateRangeValue(t.dateRange.value)}),yf(x,i.x,d),f.push(x)),t.volume==null?h.visible=!1:(h.setProperties({...y,x:i.x,text:this.formatVolume(t.volume,o),visible:!0}),f.push(h)),R2(f,i.y,u),l.y1+=m,l.y2+=m,a.y1+=m,a.y2+=m,f}updateBackground(e,t,i){const o=this.getBackgroundStyles(e);this.background.setProperties({...o,...t,x:t.x-t.width/2+i,y:t.y})}reposition(e,t,i){const{width:o,height:s}=i.seriesRect,a=Dd.from(this.background.getBBox());let n=0;a.x1<0&&(n=-a.x1),a.x2>o&&(n=o-a.x2);const r=Math.min(t,s-a.y2);for(const l of e)if(Array.isArray(l)){const c=Ni.Group.computeChildrenBBox(l).width;for(const h of l)Sf(h,n-c/2),bf(h,r)}else Sf(l,n-l.getBBox().width/2),bf(l,r);this.background.x+=n,this.background.y+=r}getTextStyles(e){return{fill:e.statistics.color,fontFamily:e.statistics.fontFamily,fontSize:e.statistics.fontSize,fontStyle:e.statistics.fontStyle,fontWeight:e.statistics.fontWeight,textBaseline:"top"}}getDividerStyles(e){return{stroke:e.statistics.divider.stroke,strokeOpacity:e.statistics.divider.strokeOpacity,strokeWidth:e.statistics.divider.strokeWidth}}getBackgroundStyles(e){return{fill:e.statistics.fill,stroke:e.statistics.stroke,strokeOpacity:e.statistics.strokeOpacity,strokeWidth:e.statistics.strokeWidth,cornerRadius:4}}formatDateRangeBars(e,t){return t?.t("measurerDateRangeBars",{value:e})??`${e}`}formatDateRangeValue(e){const t=[],i=e>=0?"":"-";e=Math.abs(e);const o=1e3*60,s=o*60,a=s*24,n=Math.floor(e/o),r=Math.floor(e/s),l=Math.floor(e/a),c=r%(a/s),h=n%(s/o);return l>=1&&t.push(`${l}d`),r>=1&&(e<a||c!==0)&&t.push(`${c}h`),(e<s||h!==0)&&t.push(`${h}m`),t[0]=`${i}${t[0]}`,t.join(" ")}formatPriceRangeValue(e,t){return t?.t("measurerPriceRangeValue",{value:Number(e.toFixed(2))})??`${e}`}formatPriceRangePercentage(e,t){return t?.t("measurerPriceRangePercent",{value:e})??`${e}`}formatVolume(e,t){const i=Number.isNaN(e)?"":this.volumeFormatter.format(e);return t?.t("measurerVolume",{value:i})??i}},E2=class extends vf{getDirectionStyles(e){return this.verticalDirection==="down"?e.down.statistics:e.up.statistics}getTextStyles(e){const t=this.getDirectionStyles(e);return{...super.getTextStyles(e),fill:t.color,fontFamily:t.fontFamily,fontSize:t.fontSize,fontStyle:t.fontStyle,fontWeight:t.fontWeight}}getDividerStyles(e){const t=this.getDirectionStyles(e);return{stroke:t.divider.stroke,strokeOpacity:t.divider.strokeOpacity,strokeWidth:t.divider.strokeWidth}}getBackgroundStyles(e){const t=this.getDirectionStyles(e);return{...super.getBackgroundStyles(e),fill:t.fill,stroke:t.stroke,strokeOpacity:t.strokeOpacity,strokeWidth:t.strokeWidth}}},$t=class extends dd{constructor(){super(),this.type="measurer",this.horizontalLine=new _t,this.verticalLine=new _t,this.horizontalStartLine=new _t,this.horizontalEndLine=new _t,this.verticalStartLine=new _t,this.verticalEndLine=new _t,this.horizontalEndCap=new fl,this.verticalEndCap=new fl,this.background=new uf.Path({zIndex:-1}),this.updateBackground=Zy.updateBackground.bind(this),this.statistics=this.createStatisticsScene(),this.statistics.zIndex=1,this.append([this.background,this.verticalStartLine,this.verticalEndLine,this.horizontalStartLine,this.horizontalEndLine,this.horizontalLine,this.verticalLine,this.horizontalEndCap,this.verticalEndCap,this.start,this.end,this.statistics])}static is(e){return Qe.isCheck(e,"measurer")}createStatisticsScene(){return new vf}update(e,t){const i=Mt(e,t);if(i==null){this.visible=!1;return}if(this.visible=e.visible??!0,!this.visible)return;const o=this.extendPerpendicular(i,e,t),s={...o,y2:o.y1},a={...o,y1:o.y2};this.verticalDirection=i.y1<i.y2?"down":"up",this.updateVisibilities(e),this.updateLines(e,i),this.updateHandles(e,i),this.updateText(e,i),this.updateCaps(e,i),this.updateBoundingLines(e,o),this.updateBackground(e,s,a,t),this.updateStatistics(e,i,t),this.updateAnchor(e,i,t)}extendPerpendicular(e,t,i){const o={x1:Math.min(e.x1,e.x2),x2:Math.max(e.x1,e.x2),y1:Math.min(e.y1,e.y2),y2:Math.max(e.y1,e.y2)},[s,a]=Gi.from(i.yAxis.bounds);return li.is(t)?(t.extendAbove&&(o.y1=s.y),t.extendBelow&&(o.y2=a.y)):ci.is(t)&&(t.extendLeft&&(o.x1=s.x),t.extendRight&&(o.x2=a.x)),o}updateVisibilities(e){const{horizontalStartLine:t,horizontalEndLine:i,horizontalEndCap:o,verticalStartLine:s,verticalEndLine:a,verticalEndCap:n}=this,{direction:r}=e;s.visible=r!=="vertical",a.visible=r!=="vertical",o.visible=r!=="vertical",t.visible=r!=="horizontal",i.visible=r!=="horizontal",n.visible=r!=="horizontal"}updateLines(e,t){const{horizontalLine:i,verticalLine:o}=this,{direction:s}=e,{x1:a,y1:n,x2:r,y2:l}=t,c=Gi.round(Os.center(t),0),h=this.getLineStyles(e);s!=="vertical"&&i.setProperties({...h,x1:a,x2:r,y1:c.y,y2:c.y}),s!=="horizontal"&&o.setProperties({...h,x1:c.x,x2:c.x,y1:n,y2:l})}updateText(e,t){const{direction:i}=e,o=Gi.round(Os.center(t),0);let s;const a={...t};i==="vertical"?(s=this.verticalLine,a.x1=o.x,a.x2=o.x):(s=this.horizontalLine,a.y1=o.y,a.y2=o.y),this.text=this.updateNode(ws,this.text,!!e.text.label);const{id:n}=s,r=Aa(n,s,a,e.text,this.text,e.text.label,e.strokeWidth);let l;if(i==="both"&&r&&this.text){const c=Os.from(this.text.getBBox()),{offset:h}=r.numbers;c.x1<=o.x+h.x&&c.x2>=o.x-h.x&&(l={x:o.x,y:r.clipMask.y,radius:this.text.getBBox().height/2+Gi.length(h)})}this.verticalLine.setClipMask(n,l)}updateCaps(e,t){const{horizontalEndCap:i,verticalEndCap:o}=this,{direction:s}=e,{x1:a,y1:n,x2:r,y2:l}=t,c=Gi.round(Os.center(t),0),{stroke:h,strokeWidth:d,strokeOpacity:u}=this.getLineStyles(e),g={stroke:h,strokeWidth:d,strokeOpacity:u};if(s!=="vertical"){const m=a<=r?0:Math.PI;let y=r;s==="horizontal"&&(y+=a<=r?-2:2),i.update({...g,x:y,y:c.y,angle:m})}if(s!=="horizontal"){const m=n<=l?Math.PI/2:Math.PI/-2;let y=l;s==="vertical"&&(y+=n<=l?-2:2),o.update({...g,x:c.x,y,angle:m})}}updateBoundingLines(e,t){const{verticalStartLine:i,verticalEndLine:o,horizontalStartLine:s,horizontalEndLine:a}=this,{direction:n}=e,{x1:r,y1:l,x2:c,y2:h}=t,d=this.getLineStyles(e);n==="horizontal"&&(i.setProperties({...d,x1:r,y1:l,x2:r,y2:h}),o.setProperties({...d,x1:c,y1:l,x2:c,y2:h})),n==="vertical"&&(s.setProperties({...d,x1:r,y1:l,x2:c,y2:l}),a.setProperties({...d,x1:r,y1:h,x2:c,y2:h}))}updateStatistics(e,t,i){const o=Gi.add(Os.bottomCenter(t),Gi.from(0,10)),s={volume:this.getVolume(e)};e.hasPriceRange&&(s.priceRange={percentage:this.getPriceRangePercentage(e),value:this.getPriceRangeValue(e)}),e.hasDateRange&&(s.dateRange={bars:this.getDateRangeBars(t,i),value:this.getDateRangeValue(e)}),this.statistics.update(e,s,o,t,i,this.verticalDirection,e.localeManager)}updateAnchor(e,t,i,o){const s=Os.topCenter(t);Gi.apply(this.anchor,uf.Transformable.toCanvasPoint(this.horizontalLine,s.x,s.y))}getBackgroundPoints(e,t,i,o){const[s,a]=Gi.from(t),[n,r]=Gi.from(i);return[s,a,r,n]}getLineStyles(e){const{lineDashOffset:t,stroke:i,strokeWidth:o,strokeOpacity:s}=e;return{lineCap:e.getLineCap(),lineDash:e.getLineDash(),lineDashOffset:t,stroke:i,strokeWidth:o,strokeOpacity:s,fillOpacity:0}}getBackgroundStyles(e){const{background:t}=e;return{fill:t.fill,fillOpacity:t.fillOpacity}}getHandleStyles(e){return{fill:e.handle.fill,stroke:e.handle.stroke??e.stroke,strokeOpacity:e.handle.strokeOpacity??e.strokeOpacity,strokeWidth:e.handle.strokeWidth??e.strokeWidth}}containsPoint(e,t){const{horizontalLine:i,text:o,verticalLine:s,horizontalStartLine:a,horizontalEndLine:n,verticalStartLine:r,verticalEndLine:l}=this;return super.containsPoint(e,t)||i.isPointInPath(e,t)||s.isPointInPath(e,t)||a.visible&&a.isPointInPath(e,t)||n.visible&&n.isPointInPath(e,t)||r.visible&&r.isPointInPath(e,t)||l.visible&&l.isPointInPath(e,t)||!!o?.containsPoint(e,t)}getNodeAtCoords(e,t){return this.text?.containsPoint(e,t)?"text":this.start.containsPoint(e,t)||this.end.containsPoint(e,t)?"handle":"line"}getDateRangeBars(e,t){const{step:i}=t.xAxis.scale,o=e.x1<=e.x2?1:-1;return i?Math.round(Os.width(e)/i)*o:0}getDateRangeValue(e){const t=We(e.start.x),i=We(e.end.x);if(!gf(t)||!gf(i))throw new Error("Can not create a date range measurement of non-date x-axis.");return i.getTime()-t.getTime()}getPriceRangePercentage(e){if(e.start.y==null||e.end.y==null)throw new Error("Can not create a price range measurement of a non-numeric y-axis");const t=We(e.end.y),i=We(e.start.y);if(!xl(t)||!xl(i))throw new Error("Can not create a price range measurement of a non-numeric y-axis");return(t-i)/i}getPriceRangeValue(e){if(e.start.y==null||e.end.y==null)throw new Error("Can not create a price range measurement of a non-numeric y-axis");const t=We(e.end.y),i=We(e.start.y);if(!xl(t)||!xl(i))throw new Error("Can not create a price range measurement of a non-numeric y-axis");return t-i}getVolume(e){return e.getVolume(e.start.x,e.end.x)}},Sl=class extends $t{constructor(){super(...arguments),this.type="quick-measurer"}static is(e){return Qe.isCheck(e,"quick-measurer")}createStatisticsScene(){return new E2}getDirectionStyles(e){return this.verticalDirection==="down"?e.down:e.up}getLineStyles(e){const t=this.getDirectionStyles(e);return{...super.getLineStyles(e),stroke:t.stroke,strokeWidth:t.strokeWidth,strokeOpacity:t.strokeOpacity}}getBackgroundStyles(e){const t=this.getDirectionStyles(e);return{fill:t.fill,fillOpacity:t.fillOpacity}}getHandleStyles(e){const t=this.getDirectionStyles(e);return{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth}}};import{Debug as _2,StateMachine as Na,StateMachineProperty as kf}from"ag-charts-core";var Ca=class extends Na{constructor(e){const t=({point:n})=>{const r=this.createDatum();r.set({start:n,end:n}),e.create(r)},i=({point:n})=>{const{datum:r,node:l}=this;r?.set({end:n}),l?.toggleActive(!0),l?.toggleHandles({end:!1}),e.update()},o=()=>{this.node?.toggleHandles({end:!0})},s=()=>e.delete(),a=()=>{e.showAnnotationOptions(),e.recordAction(`Create ${this.node?.type} annotation`)};super("start",{start:{reset:Na.parent,click:{target:"end",action:t},drag:{target:"end",action:t}},end:{hover:i,drag:i,click:{target:Na.parent,action:o},dragEnd:{target:Na.parent,action:o},reset:{target:Na.parent,action:s},cancel:{target:Na.parent,action:s},onExit:a}}),this.debug=_2.create(!0,"annotations")}};p([kf()],Ca.prototype,"datum",2),p([kf()],Ca.prototype,"node",2);var B2=class extends Ca{createDatum(){return new li}},V2=class extends Ca{createDatum(){return new ci}},z2=class extends Ca{createDatum(){return new lo}},F2=class extends Ca{createDatum(){return new Gt}},Df={type:"date-range",datum:li,scene:$t,isDatum:li.is,translate:(e,t,i,o)=>{li.is(t)&&$t.is(e)&&e.translate(t,i,o)},copy:(e,t,i,o)=>{if(li.is(t)&&li.is(i)&&$t.is(e))return e.copy(t,i,o)},update:(e,t,i)=>{li.is(t)&&$t.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new B2({...e,create:t("date-range")}),dragState:e=>new _e(e)},Af={type:"price-range",datum:ci,scene:$t,isDatum:ci.is,translate:(e,t,i,o)=>{ci.is(t)&&$t.is(e)&&e.translate(t,i,o)},copy:(e,t,i,o)=>{if(ci.is(t)&&ci.is(i)&&$t.is(e))return e.copy(t,i,o)},update:(e,t,i)=>{ci.is(t)&&$t.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new V2({...e,create:t("date-range")}),dragState:e=>new _e(e)},Mf={type:"date-price-range",datum:lo,scene:$t,isDatum:lo.is,translate:(e,t,i,o)=>{lo.is(t)&&$t.is(e)&&e.translate(t,i,o)},copy:(e,t,i,o)=>{if(lo.is(t)&&lo.is(i)&&$t.is(e))return e.copy(t,i,o)},update:(e,t,i)=>{lo.is(t)&&$t.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new z2({...e,create:t("date-range")}),dragState:e=>new _e(e)},If={type:"quick-date-price-range",datum:Gt,scene:Sl,isDatum:Gt.is,translate:(e,t,i,o)=>{Gt.is(t)&&Sl.is(e)&&e.translate(t,i,o)},copy:(e,t,i,o)=>{if(Gt.is(t)&&Gt.is(i)&&Sl.is(e))return e.copy(t,i,o)},update:(e,t,i)=>{Gt.is(t)&&Sl.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new F2({...e,create:t("quick-date-price-range")}),dragState:e=>new _e(e)};import{_ModuleSupport as bl}from"ag-charts-community";import{ZIndexMap as Lf,calcLineHeight as H2,clamp as W2,wrapText as K2}from"ag-charts-core";var vl=class extends md{constructor(){super(),this.type="note",this.shape=new bl.Rect,this.iconBackground=new bl.TranslatableSvgPath("M22 1.83333C22 0.820811 21.1792 0 20.1667 0H1.83333C0.820811 0 0 0.82081 0 1.83333V13.9868C0 14.9994 0.820811 15.8202 1.83333 15.8202L5.88971 15.8202C6.44575 15.8202 6.97175 16.0725 7.31971 16.5062L9.57006 19.3112C10.304 20.2259 11.6962 20.2259 12.4301 19.3112L14.6804 16.5062C15.0284 16.0725 15.5544 15.8202 16.1104 15.8202L20.1667 15.8202C21.1792 15.8202 22 14.9994 22 13.9868V1.83333Z"),this.iconLines=new bl.TranslatableSvgPath("M17.1114 5.75C17.1114 6.16421 16.7756 6.5 16.3614 6.5H5.63916C5.22495 6.5 4.88916 6.16421 4.88916 5.75V5.75C4.88916 5.33579 5.22495 5 5.63916 5H16.3614C16.7756 5 17.1114 5.33579 17.1114 5.75V5.75ZM17.1114 9.25C17.1114 9.66421 16.7756 10 16.3614 10H5.63916C5.22495 10 4.88916 9.66421 4.88916 9.25V9.25C4.88916 8.83579 5.22495 8.5 5.63916 8.5H16.3614C16.7756 8.5 17.1114 8.83579 17.1114 9.25V9.25Z"),this.active=!1,this.shape.visible=!1,this.label.visible=!1,this.iconBackground.fillShadow=new bl.DropShadow,this.append([this.shape,this.label,this.iconBackground,this.iconLines,this.handle])}static is(e){return Qe.isCheck(e,"note")}update(e,t){this.updateIcon(e,t),super.update(e,t)}getTextBBox(e,t,i){const o=super.getTextBBox(e,t,i);o.x-=e.width/2,o.x=W2(0,o.x,i.seriesRect.width-e.width);const s=e.getPadding().top,a=o.y-ay-s*2,n=o.y+Ae.HANDLE_SIZE+s*2;return a-o.height-ny<0?(o.y=n,e.position="top"):(o.y=a+s,e.position="bottom"),o}updateLabel(e,t){const i=e.visible===!1?!1:this.label.visible;super.updateLabel(e,t),this.label.visible=i,this.label.text=K2(e.text,{maxWidth:200,font:e,textWrap:"always",avoidOrphans:!1})}updateShape(e,t){const{shape:i}=this;i.fill=e.background.fill,i.fillOpacity=e.background.fillOpacity??1,i.stroke=e.background.stroke,i.strokeOpacity=e.background.strokeOpacity??1,i.strokeWidth=e.background.strokeWidth??1,i.cornerRadius=4;const o=e.getPadding().top,s=e.position==="top";i.x=t.x-o,i.width=e.width+o*2,i.height=t.height+o*2,i.y=t.y+(s?0:-t.height)-o}updateIcon(e,t){const{active:i,iconBackground:o,iconLines:s}=this,{x:a,y:n}=De(e,t);o.translationX=a-FI/2,o.translationY=n-sy,s.translationX=o.translationX,s.translationY=o.translationY,o.fill=e.fill,o.fillOpacity=e.fillOpacity??1,o.stroke=e.stroke,o.strokeOpacity=e.strokeOpacity??1,o.strokeWidth=e.strokeWidth??1,s.fill=e.stroke,i?o.fillShadow.color=e.fill??"rgba(0, 0, 0, 0.22)":o.fillShadow.color="rgba(0, 0, 0, 0.22)"}updateAnchor(e,t,i){const o=e.getPadding().top,s=e.position==="top",a=s?1:-1;return{x:t.x+i.seriesRect.x+e.width/2,y:t.y+i.seriesRect.y+a*(t.height+o),position:s?"below":"above"}}getLabelCoords(e,t){const i=e.position==="top",o=e.getPadding().top+H2(e.fontSize,Yr)/2;return{x:t.x,y:t.y+(i?o/2:0)}}getTextBaseline(e){return e.position==="top"?"middle":e.position}getHandleCoords(e,t,i){return{x:t.x,y:t.y+Ae.HANDLE_SIZE/2+4}}getHandleStyles(e){return{fill:e.handle.fill,stroke:e.handle.stroke??e.fill,strokeOpacity:e.handle.strokeOpacity,strokeWidth:e.handle.strokeWidth}}toggleHovered(e,t,i){super.toggleHovered(e,t,i);const o=e||t&&!i;this.label.visible=o,this.shape.visible=o,this.zIndex=o?Lf.CHART_ANNOTATION_FOCUSED:Lf.CHART_ANNOTATION}toggleActive(e){super.toggleActive(e),this.label.visible=e,this.shape.visible=e,this.active=e}containsPoint(e,t){return this.shape.visible&&this.shape.containsPoint(e,t)||this.iconBackground.containsPoint(e,t)?!0:super.containsPoint(e,t)}},G2=class extends Vn{createDatum(){return new Et}},Nf={type:"note",datum:Et,scene:vl,isDatum:Et.is,translate:(e,t,i,o)=>{Et.is(t)&&vl.is(e)&&e.translate(t,i,o)},copy:(e,t,i,o)=>{if(Et.is(t)&&Et.is(i)&&vl.is(e))return e.copy(t,i,o)},update:(e,t,i)=>{Et.is(t)&&vl.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new G2({...e,create:t("note")}),dragState:e=>new _e(e)};import{Vec2 as gi,Vec4 as $i}from"ag-charts-core";var kl=class extends qy{constructor(){super(),this.type="parallel-channel",this.handles={topLeft:new Ae,topMiddle:new Da,topRight:new Ae,bottomLeft:new Ae,bottomMiddle:new Da,bottomRight:new Ae},this.middleLine=new _t,this.append([this.background,this.topLine,this.middleLine,this.bottomLine,...Object.values(this.handles)])}static is(e){return Qe.isCheck(e,"parallel-channel")}dragHandle(e,t,i,o){const{activeHandle:s,handles:a}=this;if(s==null)return;const{offset:n}=a[s].drag(t);a[s].toggleDragging(!0),(s==="topMiddle"||s==="bottomMiddle")&&(n.x=0);let r=[],l=o;switch(s){case"topLeft":case"bottomLeft":r=["topLeft","bottomLeft"];break;case"topMiddle":r=["topLeft","topRight"],n.y-=Da.HANDLE_SIZE/2,l=!1;break;case"topRight":case"bottomRight":r=["topRight","bottomRight"];break;case"bottomMiddle":r=["bottomLeft","bottomRight"],n.y-=Da.HANDLE_SIZE/2,l=!1;break}const c=Mt(e,i),h=Mt(e.bottom,i);if(!c||!h)return;const d={topLeft:$i.start(c),topRight:$i.end(c),bottomLeft:$i.start(h),bottomRight:$i.end(h)},u={vectors:{topLeft:d.topRight,bottomLeft:d.bottomRight,topRight:d.topLeft,bottomRight:d.bottomLeft},angle:e.snapToAngle},g=yo(d,n,i,{overflowContinuous:this.overflowContinuous,translateVectors:r,snap:l?u:void 0});e.start.x=g.topLeft.x,e.start.y=g.topLeft.y,e.end.x=g.topRight.x,e.end.y=g.topRight.y,e.height=g.topLeft.y-g.bottomLeft.y}getTranslatePointsVectors(e,t){const{bottomLeft:i,topLeft:o}=this.handles,s=i.getBBox().y-o.getBBox().y,a=gi.add(e,gi.from(0,s)),n=gi.add(t,gi.from(0,s));return{start:e,end:t,bottomStart:a,bottomEnd:n}}containsPoint(e,t){return super.containsPoint(e,t)||this.middleLine.visible&&this.middleLine.strokeWidth>0&&this.middleLine.containsPoint(e,t)}getNodeAtCoords(e,t){return this.middleLine.visible&&this.middleLine.strokeWidth>0&&this.middleLine.containsPoint(e,t)?"line":super.getNodeAtCoords(e,t)}updateLines(e,t,i,o,s,a){const{topLine:n,middleLine:r,bottomLine:l}=this,{lineDashOffset:c,stroke:h,strokeOpacity:d,strokeWidth:u}=e,g=e.getLineDash(),m={lineCap:e.getLineCap(),lineDash:g,lineDashOffset:c,stroke:h,strokeOpacity:d,strokeWidth:u};n.setProperties({...t,...m}),l.setProperties({...i,...m});const y=this.extendLine({x1:s.x1,y1:a.y1+(s.y1-a.y1)/2,x2:s.x2,y2:a.y2+(s.y2-a.y2)/2},e,o);r.setProperties({...y,lineDash:e.middle.lineDash??g,lineDashOffset:e.middle.lineDashOffset??c,stroke:e.middle.stroke??h,strokeOpacity:e.middle.strokeOpacity??d,strokeWidth:e.middle.strokeWidth??u,visible:e.middle.visible??!0})}updateHandles(e,t,i){const{handles:{topLeft:o,topMiddle:s,topRight:a,bottomLeft:n,bottomMiddle:r,bottomRight:l}}=this,c={fill:e.handle.fill,stroke:e.handle.stroke??e.stroke,strokeOpacity:e.handle.strokeOpacity??e.strokeOpacity,strokeWidth:e.handle.strokeWidth??e.strokeWidth};o.update({...c,...$i.start(t)}),a.update({...c,...$i.end(t)}),n.update({...c,...$i.start(i)}),l.update({...c,...$i.end(i)}),s.update({...c,...gi.sub($i.center(t),gi.from(s.handle.width/2,s.handle.height/2))}),r.update({...c,...gi.sub($i.center(i),gi.from(r.handle.width/2,r.handle.height/2))})}updateText(e,t,i){this.text=this.updateNode(ws,this.text,!!e.text.label),Ky(!0,t,i,e.text,e.strokeWidth,this.text,e.text.label)}getBackgroundPoints(e,t,i,o){const s=t.x1>t.x2,a=t.y1>t.y2,n=t.x1!==i.x1&&t.y1!==i.y1,r=t.x2!==i.x2&&t.y2!==i.y2,l=gi.from(t);return e.extendEnd&&r&&l.push(gi.from(s?o.x1:o.x2,a?o.y1:o.y2)),l.push(...gi.from(i).reverse()),e.extendStart&&n&&l.push(gi.from(s?o.x2:o.x1,a?o.y2:o.y1)),l}};import{Debug as $2,StateMachine as Xo,StateMachineProperty as Ad,isNumber as Ta}from"ag-charts-core";var Dl=class extends Xo{constructor(e){const t=({point:l})=>{const c=new di;c.set({start:l,end:l,height:0}),e.create(c)},i=()=>{const{node:l}=this;l?.toggleActive(!0),l?.toggleHandles({topLeft:!0,topMiddle:!1,topRight:!1,bottomLeft:!1,bottomMiddle:!1,bottomRight:!1})},o=({offset:l,context:c})=>{const{datum:h,snapping:d}=this;h&&(h.set({end:Bn(l,c,d,h.start,h.snapToAngle)}),e.update())},s=()=>{this.node?.toggleHandles({topRight:!0}),e.update()},a=({point:l})=>{const{datum:c,node:h}=this,d=We(c?.end.y),u=We(c?.start.y),{y:g}=l;if(c==null||!Ta(u)||!Ta(d)||!Ta(g))return;const m=d-(g??0),y=u-m;h?.toggleHandles({bottomLeft:!0,bottomRight:!0}),!(!e.validatePoint({x:c.start.x,y},{overflowContinuous:!0})||!e.validatePoint({x:c.end.x,y:l.y},{overflowContinuous:!0}))&&(c.set({height:m}),e.update())},n=({point:l})=>{const{datum:c,node:h}=this,d=We(c?.end.y),u=We(c?.start.y),{y:g}=l;if(c==null||!Ta(u)||!Ta(d)||!Ta(g))return;const m=d-(g??0),y=u-m;h?.toggleHandles(!0),!(!e.validatePoint({x:c.start.x,y},{overflowContinuous:!0})||!e.validatePoint({x:c.end.x,y:l.y},{overflowContinuous:!0}))&&(c.set({height:m}),e.recordAction("Create parallel-channel annotation"),e.showAnnotationOptions(),e.update())},r=()=>e.delete();super("start",{start:{click:{target:"waiting-first-render",action:t},drag:{target:"waiting-first-render",action:t},reset:Xo.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:o,drag:o,click:{target:"height",action:s},dragEnd:{target:"height",action:s},reset:{target:Xo.parent,action:r},cancel:{target:Xo.parent,action:r}},height:{hover:a,click:{target:Xo.parent,action:n},drag:{target:Xo.parent,action:n},reset:{target:Xo.parent,action:r},cancel:{target:Xo.parent,action:r}}}),this.debug=$2.create(!0,"annotations"),this.snapping=!1}};p([Ad()],Dl.prototype,"datum",2),p([Ad()],Dl.prototype,"node",2),p([Ad()],Dl.prototype,"snapping",2);var Cf={type:"parallel-channel",datum:di,scene:kl,isDatum:di.is,translate:(e,t,i,o)=>{di.is(t)&&kl.is(e)&&e.translate(t,i,o)},copy:(e,t,i,o)=>{if(di.is(t)&&di.is(i)&&kl.is(e))return e.copy(t,i,o)},update:(e,t,i)=>{di.is(t)&&kl.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new Dl({...e,create:t("parallel-channel")}),dragState:e=>new _e(e)},Al=class extends md{constructor(){super(),this.type="text",this.append([this.label,this.handle])}static is(e){return Qe.isCheck(e,"text")}getHandleCoords(e,t){const i=Ae.HANDLE_SIZE/2;return{x:t.x+i,y:t.y+2+i}}},Y2=class extends Vn{createDatum(){return new go}},Tf={type:"text",datum:go,scene:Al,isDatum:go.is,translate:(e,t,i,o)=>{go.is(t)&&Al.is(e)&&e.translate(t,i,o)},copy:(e,t,i,o)=>{if(go.is(t)&&go.is(i)&&Al.is(e))return e.copy(t,i,o)},update:(e,t,i)=>{go.is(t)&&Al.is(e)&&e.update(t,i)},createState:(e,{createDatum:t})=>new Y2({...e,create:t("text")}),dragState:e=>new _e(e)},Yt={[df.type]:df,[Uy.type]:Uy,[jy.type]:jy,[Cf.type]:Cf,[Qy.type]:Qy,[lf.type]:lf,[nf.type]:nf,[By.type]:By,[Fy.type]:Fy,[Nf.type]:Nf,[Tf.type]:Tf,[pf.type]:pf,[wy.type]:wy,[Ty.type]:Ty,[Df.type]:Df,[Af.type]:Af,[Mf.type]:Mf,[If.type]:If};function Rs(e){for(const{isDatum:t}of Object.values(Yt))if(t(e))return e}import"ag-charts-community";import{ActionOnSet as U2,Debug as j2,ParallelStateMachine as X2,StateMachine as Md,StateMachineProperty as Yi}from"ag-charts-core";var Ml=class extends X2{constructor(e){super(new Z2(t=>{this.snapping=t}),new q2(()=>{this.node=this.active==null?void 0:e.node(this.active)}),new Zo(e,t=>{this.active=t,this.datum=this.active==null?void 0:e.datum(this.active),this.node=this.active==null?void 0:e.node(this.active)})),this.snapping=!1}getActive(){return this.active}isActive(e){return e===this.active}};p([Yi()],Ml.prototype,"snapping",2),p([Yi()],Ml.prototype,"datum",2),p([Yi()],Ml.prototype,"node",2);var Z2=class extends Md{constructor(e){super("idle",{idle:{hover:({shiftKey:t})=>e(t),keyDown:({shiftKey:t})=>e(t),keyUp:({shiftKey:t})=>e(t),click:({shiftKey:t})=>e(t),drag:({shiftKey:t})=>e(t)},dragging:{},translating:{},"text-input":{}})}},q2=class extends Md{constructor(e){super("idle",{idle:{onEnter:e,render:e},dragging:{onEnter:e,render:e},translating:{onEnter:e,render:e},"text-input":{render:e}})}},Zo=class extends Md{constructor(e,t){const i=f=>v=>{e.create(f,v),this.active=e.selectLast()},o=()=>{this.active!=null&&e.delete(this.active),this.active=void 0,e.select()},s={createDatum:i},a={...e,delete:o,showTextInput:()=>{this.active!=null&&e.showTextInput(this.active)},deselect:()=>{const f=this.active;this.active=void 0,this.hovered=void 0,e.select(this.active,f)},showAnnotationOptions:()=>{this.active!=null&&e.showAnnotationOptions(this.active)}},n=Object.fromEntries(Object.entries(Yt).map(([f,v])=>[f,v.createState(a,s)])),r=Object.fromEntries(Object.entries(Yt).map(([f,v])=>[f,v.dragState(e,s)])),l=({colorPickerType:f,colorOpacity:v,color:k,opacity:A,isMultiColor:M})=>{this.datum&&(f==="text-color"&&e.updateTextInputColor(k),Jr(this.datum,f,v,k,A,M),e.update())},c=f=>{const{datum:v,node:k}=this;!v||!k||(Wi(v)?(v.fontSize=f,e.updateTextInputFontSize(f)):ba(v)&&(v.text.fontSize=f),e.update())},h=f=>{const{datum:v,node:k}=this;!v||!k||!Vo(v)||(py(v,f),e.update())},d=f=>{const{node:v}=this;!v||!("setTextInputBBox"in v)||(v.setTextInputBBox(f),e.update())},u=({textInputValue:f,bbox:v})=>{const{datum:k}=this;if(v!=null&&f!=null&&f.length>0){if(!Wi(k))return;const A=Ur(k,f,v.width);k.set({text:A}),e.update(),e.recordAction(`Change ${k.type} annotation text`)}else e.delete(this.active),e.recordAction(`Delete ${k?.type} annotation`)},g=()=>{e.updateTextInputBBox(void 0)},m=()=>this.active!=null,y=()=>this.copied!=null,S=()=>{const{active:f,datum:v}=this;return f==null||!v?!1:ba(v)&&v.isWriteable()},x=()=>this.active!=null&&!Bo(this.datum),b=()=>this.hovered!=null;super("idle",{idle:{onEnter:()=>{e.select(this.active,this.active),this.hoverCoords&&(this.hovered=e.hoverAtCoords(this.hoverCoords,this.active,this.hovered))},hover:({offset:f})=>{this.hovered=e.hoverAtCoords(f,this.active,this.hovered),this.hoverCoords=f},translate:{guard:m,target:"translating",action:({translation:f})=>{e.startInteracting(),e.translate(this.active,f),e.update()}},copy:{guard:x,action:()=>{this.copied=e.copy(this.active)}},cut:{guard:x,action:()=>{this.copied=e.copy(this.active),o()}},paste:{guard:y,action:()=>{e.paste(this.copied)}},selectLast:()=>{const f=this.active;this.active=e.selectLast(),e.select(this.active,f)},click:[{guard:()=>{const{active:f,hovered:v,datum:k}=this;return f==null||v!==f||!k?!1:Wi(k)&&k.isWriteable()},target:"text-input"},{action:()=>{const f=this.active;this.active=this.hovered,e.select(this.active,f)}}],dblclick:{guard:S,action:({offset:f})=>{const v=e.getNodeAtCoords(f,this.active)==="text"?"text":"line";e.showAnnotationSettings(this.active,void 0,v)}},dragStart:[{guard:b,target:"dragging",action:()=>{const f=this.active;this.active=this.hovered,e.select(this.active,f),e.startInteracting()}},{action:()=>{const f=this.active;this.active=this.hovered,e.select(this.active,f)}}],color:{guard:m,action:l},fontSize:{guard:m,action:c},lineProps:{guard:m,action:f=>{const v=Rs(this.datum);v?.set(f),e.update(),e.recordAction(`Change ${v?.type} ${Object.entries(f).map(([k,A])=>`${k} to ${A}`).join(", ")}`)}},lineStyle:{guard:m,action:h},lineText:{guard:m,action:f=>{const v=Rs(this.datum);ba(v)&&(mo(v)&&f.position==="center"&&(f.position="inside"),v.text.set(f),e.update())}},updateTextInputBBox:{guard:m,action:d},toolbarPressSettings:{guard:S,action:f=>{e.showAnnotationSettings(this.active,f)}},reset:()=>{this.active!=null&&this.node?.toggleActive(!1),this.hovered=void 0,this.active=void 0,e.select(this.active,this.active),e.resetToIdle()},delete:()=>{this.active!=null&&(e.delete(this.active),!Bo(this.datum)&&e.recordAction(`Delete ${this.datum?.type} annotation`))},deleteAll:()=>{e.deleteAll()},...n},dragging:{onEnter:(f,v)=>{if(this.active==null)return;const k=e.getAnnotationType(this.active);k&&(this.transitionRoot(k),this.transitionRoot("dragStart",v))},...r},translating:{onEnter:()=>{},translate:{guard:m,target:"translating",action:({translation:f})=>{e.startInteracting(),e.translate(this.active,f),e.update()}},translateEnd:{guard:m,target:"idle"},onExit:()=>{e.stopInteracting(),e.update(),e.recordAction("Translate annotation")}},"text-input":{onEnter:()=>{if(this.active==null)return;const f=Rs(this.datum);!f||!("getTextInputCoords"in f)||(e.startInteracting(),e.showTextInput(this.active),f.visible=!1,e.update())},updateTextInputBBox:{guard:m,action:d},resize:{target:"idle",action:u},click:{target:"idle",action:u},drag:{target:"idle",action:u},textInput:[{guard:pd,target:"idle",action:g},{guard:ud,target:"idle",action:u}],color:{guard:m,action:l},fontSize:{guard:m,action:c},cancel:{target:"idle",action:g},onExit:()=>{e.stopInteracting(),e.hideTextInput();const f=this.active;if(this.active=this.hovered=void 0,e.select(this.active,f),f==null)return;const v=e.datum(f),k=e.node(f);!v||!k||(v.visible=!0)}}}),this.setActive=t,this.debug=j2.create(!0,"annotations"),this.snapping=!1}};p([U2({changeValue(e){this.setActive(e)}}),Yi()],Zo.prototype,"active",2),p([Yi()],Zo.prototype,"hovered",2),p([Yi()],Zo.prototype,"hoverCoords",2),p([Yi()],Zo.prototype,"copied",2),p([Yi()],Zo.prototype,"snapping",2),p([Yi()],Zo.prototype,"datum",2),p([Yi()],Zo.prototype,"node",2);import{_ModuleSupport as Q2}from"ag-charts-community";import{ActionOnSet as J2,BaseProperties as eN,ChartAxisDirection as tN,CleanupRegistry as iN,EventEmitter as oN,PropertiesArray as sN,Property as Il,ToolbarButtonProperties as aN}from"ag-charts-core";var{LayoutElement:nN,Menu:rN}=Q2,wf=class extends aN{};p([Il],wf.prototype,"value",2);var Ll=class extends eN{constructor(e){super(),this.ctx=e,this.enabled=!0,this.padding=20,this.buttons=new sN(wf),this.events=new oN,this.annotationMenu=new rN(this.ctx,"annotations"),this.cleanup=new iN,this.toolbar=e.sharedToolbar.getSharedToolbar("annotations");const t=this.onKeyDown.bind(this);this.toolbar.addListener("keydown",t),this.cleanup.register(this.toolbar.addToolbarListener("button-pressed",this.onToolbarButtonPress.bind(this)),e.layoutManager.registerElement(nN.ToolbarLeft,this.onLayoutStart.bind(this)),()=>{this.toolbar.removeListener("keydown",t),this.toolbar.destroy()})}destroy(){this.cleanup.flush()}toggleClearButtonEnabled(e){const t=this.buttons.findIndex(i=>i.value==="clear");this.toolbar.toggleButtonEnabledByIndex(t,e)}resetButtonIcons(){for(const[e,t]of this.buttons.entries())switch(t.value){case"line-menu":this.updateButtonByIndex(e,{icon:"trend-line-drawing",value:"line-menu"});break;case"fibonacci-menu":this.updateButtonByIndex(e,{icon:"fibonacci-retracement-drawing",value:"fibonacci-menu"});break;case"text-menu":this.updateButtonByIndex(e,{icon:"text-annotation",value:"text-menu"});break;case"shape-menu":this.updateButtonByIndex(e,{icon:"arrow-drawing",value:"shape-menu"});break;case"measurer-menu":this.updateButtonByIndex(e,{icon:"measurer-drawing",value:"measurer-menu"});break}}hideOverlays(){this.annotationMenu.hide()}clearActiveButton(){this.toolbar.clearActiveButton()}onLayoutStart(e){this.enabled&&(this.toolbar.updateButtons(this.buttons),this.toolbar.layout(e.layoutBox,this.padding))}refreshButtonsEnabled(e){for(const[t,i]of this.buttons.entries())i&&this.toolbar.toggleButtonEnabledByIndex(t,e)}onToolbarButtonPress({event:e,button:t,buttonBounds:i,buttonWidget:o}){const s=this.ctx.axisManager.getAxisContext(tN.Y)[0].scale;switch(t.value){case"clear":this.events.emit("pressed-clear",null);break;case"line-menu":this.onToolbarButtonPressShowMenu(e,i,o,t.value,"toolbarAnnotationsLineAnnotations",fL.filter(a=>a.visible?a.visible(s):!0));break;case"fibonacci-menu":this.onToolbarButtonPressShowMenu(e,i,o,t.value,"toolbarAnnotationsFibonacciAnnotations",xL);break;case"text-menu":this.onToolbarButtonPressShowMenu(e,i,o,t.value,"toolbarAnnotationsTextAnnotations",bL);break;case"shape-menu":this.onToolbarButtonPressShowMenu(e,i,o,t.value,"toolbarAnnotationsShapeAnnotations",vL);break;case"measurer-menu":this.onToolbarButtonPressShowMenu(e,i,o,t.value,"toolbarAnnotationsMeasurerAnnotations",kL);break}}onToolbarButtonPressShowMenu(e,t,i,o,s,a){this.events.emit("pressed-show-menu",null);const n=this.buttons.findIndex(r=>r.value===o);this.toolbar.toggleActiveButtonByIndex(n),this.annotationMenu.setAnchor({x:t.x+t.width+6,y:t.y}),this.annotationMenu.show(i,{items:a,ariaLabel:this.ctx.localeManager.t(s),class:"ag-charts-annotations__toolbar-menu",sourceEvent:e.sourceEvent,onPress:this.onButtonPressMenuCreateAnnotation.bind(this,o)})}onButtonPressMenuCreateAnnotation(e,t){const i=this.buttons.findIndex(o=>o.value===e);this.updateButtonByIndex(i,{icon:t.icon}),this.events.emit("pressed-create-annotation",{annotation:t.value}),this.annotationMenu.hide()}onKeyDown({sourceEvent:e}){e.key==="Escape"&&this.events.emit("cancel-create-annotation",null)}updateButtonByIndex(e,t){const i=this.buttons.at(e);i&&(i.set({...i.toJson(),...t,value:t.value??i.value}),this.toolbar.updateButtonByIndex(e,{...i.toJson()}))}};p([Il,J2({changeValue(e){this.toolbar?.setHidden(!e)}})],Ll.prototype,"enabled",2),p([Il],Ll.prototype,"padding",2),p([Il],Ll.prototype,"buttons",2);import{_ModuleSupport as lN,_Widget as cN}from"ag-charts-community";import{AbstractModuleInstance as hN,ChartAxisDirection as dN,Property as pN,getIconClassNames as uN}from"ag-charts-core";var{InteractionState:Fn}=lN,Hn="ag-charts-annotations__axis-button",Pf=class extends hN{constructor(e,t,i,o){super(),this.ctx=e,this.axisCtx=t,this.onButtonClick=i,this.seriesRect=o,this.enabled=!0,this.snap=!1,this.padding=0,this.button=this.setup(),this.toggleVisibility(!1),this.updateButtonElement(),this.snap=!!t.scale.bandwidth,e.domManager.addEventListener("focusin",({target:s})=>{const a=s instanceof HTMLElement?s:void 0;!(a&&e.domManager.contains(a,"series-area"))&&a!==this.button.getElement()&&this.hide()}),this.cleanup.register(e.widgets.seriesWidget.addListener("drag-move",s=>this.onMouseDrag(s)),e.widgets.seriesWidget.addListener("mousemove",s=>this.onMouseMove(s)),e.widgets.seriesWidget.addListener("mouseleave",()=>this.onMouseLeave()),e.widgets.seriesDragInterpreter?.events.on("click",s=>this.onClick(s)),e.eventsHub.on("series:focus-change",()=>this.onKeyPress()),e.eventsHub.on("zoom:pan-start",()=>this.hide()),e.eventsHub.on("zoom:change-complete",()=>this.hide()),()=>this.destroyElements(),()=>this.button.destroy())}update(e,t){this.seriesRect=e,this.padding=t}setup(){const e=new cN.ButtonWidget;return e.addClass(Hn),e.setTabIndex(-1),e.setAriaLabel(this.ctx.localeManager.t("ariaLabelAddHorizontalLine")),this.ctx.widgets.seriesWidget.getElement().appendChild(e.getElement()),e}destroyElements(){this.ctx.domManager.removeChild("canvas-overlay",Hn)}onMouseMove(e){this.ctx.interactionManager.isState(Fn.Clickable)&&this.show(e)}onMouseDrag(e){this.ctx.interactionManager.isState(Fn.AnnotationsMoveable)&&this.show(e)}onMouseLeave(){this.ctx.interactionManager.isState(Fn.Clickable)&&this.hide()}onClick(e){this.ctx.interactionManager.isState(Fn.Clickable)&&e.device==="touch"&&this.show(e)}show(e){const{sourceEvent:t,currentX:i,currentY:o}=e;if(!(this.enabled&&this.ctx.widgets.seriesWidget.getElement().contains(t.target))){this.hide();return}this.toggleVisibility(!0);const s=this.getButtonCoordinates({x:i,y:o});this.coords={x:s.x+this.button.clientWidth/2,y:s.y+this.button.clientHeight/2},this.updatePosition(s)}hide(){this.toggleVisibility(!1)}onKeyPress(){this.snap&&this.ctx.interactionManager.isState(Fn.Default)||this.hide()}getButtonCoordinates({x:e,y:t}){const{axisCtx:{direction:i,position:o},seriesRect:s,snap:a,axisCtx:n,padding:r}=this,{clientWidth:l,clientHeight:c}=this.button,[h,d]=[0,s.height],[u,g]=[0,s.width];if(a&&(e=ro(Wr(e-s.x,n),n)+s.x,t=ro(Wr(t-s.y,n),n)+s.y),i===dN.X){const y=c-Math.max(0,r-5);e=e-l/2,t=o==="top"?h-c+y:d-y}else{const y=l-Math.max(0,r-9);e=o==="left"?u-l+y:g-y,t=t-c/2}return{x:e,y:t}}toggleVisibility(e){const{button:t}=this;if(t==null)return;const i=this.enabled&&e;this.toggleClass("-hidden",!i)}toggleClass(e,t){this.button.toggleClass(`${Hn}-${e}`,t)}updatePosition({x:e,y:t}){this.button.getElement().style.transform=`translate(${Math.round(e)}px, ${Math.round(t)}px)`}updateButtonElement(){const{button:e}=this;e.addListener("click",()=>this.onButtonClick(this.coords)),e.addListener("touchend",()=>this.onButtonClick(this.coords)),e.addListener("drag-start",()=>{}),e.setInnerHTML(`<span class="${uN("zoom-in")} ${Hn}-icon"></span>`)}};p([pN],Pf.prototype,"enabled",2);import"ag-charts-community";import{EventEmitter as gN,focusCursorAtEnd as mN}from"ag-charts-core";import{_ModuleSupport as yN}from"ag-charts-community";import{Color as Of,Vec2 as Ke,createButton as Nl,createCheckbox as fN,createElement as xo,createElementId as Id,createSelect as xN,createTextArea as SN,entries as Rf,getIconClassNames as bN,getWindow as vN,initRovingTabIndex as Ef,mapValues as Ld,setAttribute as _f,setAttributes as Nd}from"ag-charts-core";var{DraggablePopover:kN,NativeWidget:Cd}=yN,Bf=class im extends kN{constructor(t,i){super(t,i),this.dragHandleDraggingClass="ag-charts-dialog__drag-handle--dragging",this.colorPicker=new fy(this.ctx,{detached:!0}),this.cleanup.register(t.eventsHub.on("layout:complete",this.onLayoutComplete.bind(this)))}showWithChildren(t,i){const o=super.showWithChildren(t,i);return o.classList.add("ag-charts-dialog"),o.setAttribute("role","dialog"),o.addEventListener("mousedown",s=>{s.target.classList?.contains("ag-charts-dialog__color-picker-button")||this.colorPicker.hide()}),o.addEventListener("keydown",this.onKeyDown.bind(this)),vN().requestAnimationFrame(()=>this.reposition()),this.colorPicker.attachTo(this),o}updatePosition(t){super.updatePosition(t);const{anchor:i,fallbackAnchor:o}=this.getColorPickerAnchors()??{};i&&this.colorPicker.setAnchor(i,o)}createTabs(t,i,o){const s=xo("div","ag-charts-dialog__tabs"),a=Ld(o,()=>Id()),n=Ld(o,()=>Id());for(const[g,m]of Rf(o))Nd(m.panel,{id:n[g],role:"tabpanel","aria-labelledby":a[g]});const r=g=>{for(const[m,y]of Rf(o))y.panel.classList.toggle("ag-charts-dialog__tab-panel--active",m===g),h[m].classList.toggle("ag-charts-dialog__tab-button--active",m===g),_f(h[m],"aria-selected",m===g),m===g&&y.onShow?.()},l=new Cd(xo("div","ag-charts-dialog__header"));l.addListener("drag-start",g=>{const{sourceEvent:m}=g;m.target instanceof Element&&m.target.classList.contains("ag-charts-dialog__header")&&this.onDragStart(g)}),l.addListener("drag-move",g=>this.onDragMove(g)),l.addListener("drag-end",()=>this.onDragEnd());const c=new AN;this.setDragHandle(c);const h=Ld(o,(g,m)=>Nl({label:this.ctx.localeManager.t(g.label),onPress:()=>r(m)},{id:a[m],class:"ag-charts-dialog__tab-button",role:"tab","aria-controls":n[m]})),d=xo("div","ag-charts-dialog__tab-list");Nd(d,{role:"tablist","aria-label":this.ctx.localeManager.t(t)}),d.append(...Object.values(h));const u=this.createHeaderCloseButton();return l.getElement().append(c.getElement(),d,u),s.append(l.getElement(),...Object.values(o).map(g=>g.panel)),r(i),Ef({orientation:"horizontal",buttons:Object.values(h)}),{tabs:s,initialFocus:h[i]}}createTabPanel(){return xo("div","ag-charts-dialog__tab-panel")}createInputGroupLine(){return xo("div","ag-charts-dialog__input-group-line")}createRadioGroup({label:t,options:i,value:o,onChange:s}){const a=this.createInputGroup(t);Nd(a,{role:"radiogroup",tabindex:-1,"aria-label":this.ctx.localeManager.t(t)});const n="ag-charts-dialog__button--active",r=[];for(const l of i){const{icon:c,altText:h}=l,d=this.ctx.localeManager.t(h),u=Nl({icon:c,altText:d,onPress:()=>{for(const g of Array.from(a.children))g.classList.remove(n),g.ariaChecked="false";u.classList.add(n),u.ariaChecked="true",s(l.value)}},{"aria-checked":l.value===o,class:"ag-charts-dialog__button",role:"radio",title:d});l.value===o&&u.classList.add(n),a.appendChild(u),r.push(u)}return Ef({orientation:"horizontal",buttons:r}),a}createSelect({altText:t,label:i,options:o,value:s,onChange:a}){const n=this.createInputGroup(i),r=this.ctx.localeManager.t(t),l=xN({value:s,options:o,onChange:a},{class:"ag-charts-dialog__select","aria-label":r,title:r});return n.append(l),n}createTextArea({placeholder:t,value:i,onChange:o}){const s=t?this.ctx.localeManager.t(t):void 0;return SN({value:i,onChange:o},{placeholder:s})}createCheckbox({label:t,checked:i,onChange:o}){const s=Id(),a=this.createInputGroup(t,{for:s}),n=fN({checked:i,onChange:o},{class:"ag-charts-dialog__checkbox",role:"switch",id:s});return a.append(n),a}createColorPicker({color:t,opacity:i,label:o,altText:s,onChange:a,onChangeHide:n,isMultiColor:r,hasMultiColorOption:l}){const c=this.createInputGroup(o),h=this.ctx.localeManager.t(s),d=Nl({label:h,onPress:u=>{const{anchor:g,fallbackAnchor:m}=this.getColorPickerAnchors(d)??{};this.colorPicker.show({anchor:g,fallbackAnchor:m,color:t,opacity:i,isMultiColor:r,hasMultiColorOption:l,sourceEvent:u,onChange:(y,S,x,b)=>{d.style.setProperty("--color",y),d.classList.toggle("ag-charts-dialog__color-picker-button--multi-color",b),a(y,S,x,b)},onChangeHide:n})}},{"aria-label":h,tabindex:0,class:"ag-charts-dialog__color-picker-button",title:h});if(r)d.classList.toggle("ag-charts-dialog__color-picker-button--multi-color");else if(t){const u=Of.fromString(t),g=new Of(u.r,u.g,u.b,i);d.style.setProperty("--color",g.toHexString())}return c.append(d),this.hideFns.push(()=>{this.colorPicker.hide()}),c}createHeaderCloseButton(){return Nl({icon:"close",altText:this.ctx.localeManager.t("iconAltTextClose"),onPress:()=>this.hide()},{class:"ag-charts-dialog__close-button"})}createInputGroup(t,i){const o=xo("div","ag-charts-dialog__input-group"),s=xo("label","ag-charts-dialog__input-group-label");return s.innerText=this.ctx.localeManager.t(t),_f(s,"for",i?.for),o.appendChild(s),o}onLayoutComplete(t){this.seriesRect=t.series.paddedRect,this.reposition()}onKeyDown(t){t.altKey||t.ctrlKey||t.metaKey||t.isComposing||t.key!=="Escape"||this.hide()}reposition(){const{seriesRect:t,ctx:i}=this,o=this.getPopoverElement();if(!t||!o)return;const s=i.domManager.getBoundingClientRect(),a=Ke.from(0,t.y),n=Ke.from(s.width,t.height),r=Ke.from(o),l=Ke.from(.5,1);let c;if(t.width>1e3){const h=Ke.sub(Ke.add(a,Ke.multiply(n,l)),Ke.multiply(r,l));c=Ke.sub(h,Ke.from(0,im.offset))}else{const h=Ke.sub(Ke.add(a,n),r);c=Ke.sub(h,im.offset)}this.updatePosition(c)}getColorPickerAnchors(t){if(t&&(this.colorPickerAnchorElement=t),!this.colorPickerAnchorElement)return;const i=this.colorPickerAnchorElement.getBoundingClientRect(),o=this.ctx.domManager.getBoundingClientRect(),s=Ke.sub(Ke.from(i.x,i.y),Ke.from(o.left,o.top)),a=Ke.add(s,Ke.from(0,i.height+5)),n=Ke.sub(s,Ke.from(0,5));return{anchor:a,fallbackAnchor:n}}};Bf.offset=60;var DN=Bf,AN=class extends Cd{constructor(){super(xo("div","ag-charts-dialog__drag-handle"));const e=new Cd(xo("span",bN("drag-handle")));e.setAriaHidden(!0),this.addChild(e)}},MN=class extends DN{constructor(e){super(e,"settings"),this.events=new gN,this.hideFns.push(()=>this.events.emit("hidden",null))}show(e,t){const i=this.createLinearLineTab(e,t),o=this.createLinearTextTab(e,t);let s="dialogHeaderLine";mo(e)?s="dialogHeaderChannel":dy(e)?s="dialogHeaderFibonacciRange":e.type==="date-range"?s="dialogHeaderDateRange":e.type==="price-range"?s="dialogHeaderPriceRange":e.type==="date-price-range"&&(s="dialogHeaderDatePriceRange");const{tabs:a,initialFocus:n}=this.createTabs("ariaLabelSettingsTabBar",t.initialSelectedTab,{line:{label:s,panel:i},text:{label:"dialogHeaderText",panel:o.panel,onShow:o.onShow}});t.initialFocus=n,this.showWithChildren([a],t).classList.add("ag-charts-dialog--annotation-settings")}createLinearLineTab(e,t){const i=this.createTabPanel(),o=this.createInputGroupLine(),s=this.createInputGroupLine(),a="isMultiColor"in e,n=this.createColorPickerInput("line-color",e.getDefaultColor("line-color"),e.getDefaultOpacity("line-color"),a?e.isMultiColor:!1,a,t.onChangeLineColor,t.onChangeHideLineColor),r=this.createStrokeWidthSelect(e.strokeWidth??2,t.onChangeLineStyleWidth),l=this.createLineStyleRadioGroup(e.lineStyle??"solid",t.onChangeLineStyleType);if(o.append(n),"background"in e){const c=this.createColorPickerInput("fill-color",e.getDefaultColor("fill-color"),e.getDefaultOpacity("fill-color"),!1,!1,t.onChangeFillColor,t.onChangeHideFillColor);o.append(c),s.append(r)}else"showFill"in e?(o.append(this.createCheckbox({label:"dialogInputShowFill",checked:e.showFill??!0,onChange:c=>t.onChangeLine({showFill:c})})),s.append(r)):o.append(r);return s.append(l),i.append(o,s),"bands"in e&&i.append(this.createFibonacciRatioSelect(e.bands??10,c=>t.onChangeLine({bands:c}))),"extendStart"in e&&"extendEnd"in e&&i.append(this.createCheckbox({label:mo(e)?"dialogInputExtendChannelStart":"dialogInputExtendLineStart",checked:e.extendStart??!1,onChange:c=>t.onChangeLine({extendStart:c})}),this.createCheckbox({label:mo(e)?"dialogInputExtendChannelEnd":"dialogInputExtendLineEnd",checked:e.extendEnd??!1,onChange:c=>t.onChangeLine({extendEnd:c})})),"extendAbove"in e&&"extendBelow"in e&&i.append(this.createCheckbox({label:"dialogInputExtendAbove",checked:e.extendAbove??!1,onChange:c=>t.onChangeLine({extendAbove:c})}),this.createCheckbox({label:"dialogInputExtendBelow",checked:e.extendBelow??!1,onChange:c=>t.onChangeLine({extendBelow:c})})),"extendLeft"in e&&"extendRight"in e&&i.append(this.createCheckbox({label:"dialogInputExtendLeft",checked:e.extendLeft??!1,onChange:c=>t.onChangeLine({extendLeft:c})}),this.createCheckbox({label:"dialogInputExtendRight",checked:e.extendRight??!1,onChange:c=>t.onChangeLine({extendRight:c})})),"reverse"in e&&"showFill"in e&&i.append(this.createCheckbox({label:"dialogInputReverse",checked:e.reverse??!1,onChange:c=>t.onChangeLine({reverse:c})})),i}createLinearTextTab(e,t){const i=this.createTabPanel(),o=this.createTextArea({placeholder:"inputTextareaPlaceholder",value:e.text.label,onChange:h=>t.onChangeText({label:h})}),s=this.createFontSizeSelect(e.text.fontSize,t.onChangeTextFontSize),a=this.createColorPickerInput("text-color",e.text.color,1,!1,!1,t.onChangeTextColor,t.onChangeHideTextColor),n=e.text.position==="inside"?"center":e.text.position,r=this.createPositionRadioGroup(n??"top",h=>t.onChangeText({position:h})),l=this.createAlignmentRadioGroup(e.text.alignment??"center",h=>t.onChangeText({alignment:h})),c=this.createInputGroupLine();return c.append(s,a,r,l),i.append(o,c),{panel:i,onShow:()=>mN(o)}}createColorPickerInput(e,t,i,o,s,a,n){const r=e==="fill-color"?"dialogInputFillColorPicker":"dialogInputColorPicker",l=e==="fill-color"?"dialogInputFillColorPickerAltText":"dialogInputColorPickerAltText";return this.createColorPicker({label:r,altText:l,color:t,opacity:i,isMultiColor:o,hasMultiColorOption:s,onChange:a,onChangeHide:n})}createStrokeWidthSelect(e,t){return this.createSelect({label:"dialogInputStrokeWidth",altText:"dialogInputStrokeWidthAltText",options:by.map(({label:i,value:o})=>({label:i,value:`${o}`})),value:String(e),onChange:i=>t(Number(i))})}createFibonacciRatioSelect(e,t){return this.createSelect({label:"dialogInputFibonacciBands",altText:"dialogInputFibonacciBandsAltText",options:SL.map(({label:i,value:o})=>({label:i,value:`${o}`})),value:String(e),onChange:i=>t(Number(i))})}createLineStyleRadioGroup(e,t){return this.createRadioGroup({label:"dialogInputLineStyle",options:[{icon:"line-style-solid",altText:"iconAltTextLineStyleSolid",value:"solid"},{icon:"line-style-dashed",altText:"iconAltTextLineStyleDashed",value:"dashed"},{icon:"line-style-dotted",altText:"iconAltTextLineStyleDotted",value:"dotted"}],value:e,onChange:t})}createFontSizeSelect(e,t){return this.createSelect({label:"dialogInputFontSize",altText:"dialogInputFontSizeAltText",options:vy.map(({label:i,value:o})=>({label:i,value:String(o)})),value:String(e),onChange:i=>t(Number(i))})}createPositionRadioGroup(e,t){return this.createRadioGroup({label:"dialogInputPosition",options:[{icon:"position-top",altText:"iconAltTextPositionTop",value:"top"},{icon:"position-center",altText:"iconAltTextPositionCenter",value:"center"},{icon:"position-bottom",altText:"iconAltTextPositionBottom",value:"bottom"}],value:e,onChange:t})}createAlignmentRadioGroup(e,t){return this.createRadioGroup({label:"dialogInputAlign",options:[{icon:"align-left",altText:"iconAltTextAlignLeft",value:"left"},{icon:"align-center",altText:"iconAltTextAlignCenter",value:"center"},{icon:"align-right",altText:"iconAltTextAlignRight",value:"right"}],value:e,onChange:t})}};function Td(e){return e.gridPadding+e.seriesAreaPadding+e.tickSize+e.label.spacing}function IN(e,t,i){for(const{update:o}of Object.values(Yt))o(e,t,i)}var{InteractionState:Bt,keyProperty:LN,valueProperty:NN,Selection:CN,BBox:TN}=Hr,wa=class ZA extends U0{constructor(t){super(),this.ctx=t,this.toolbar=new Ll(this.ctx),this.optionsToolbar=new sd(this.ctx,()=>{const i=this.state.getActive();if(i!=null)return Rs(this.annotationData.at(i))}),this.axesButtons=new Vh,this.enabled=!0,this.snap=!1,this.data=void 0,this.xKey=void 0,this.volumeKey=void 0,this.annotationData=new Z0(ZA.createAnnotationDatum),this.defaults=new rL,this.container=new Hr.Group({name:"static-annotations"}),this.annotations=new CN(this.container,this.createAnnotationScene.bind(this)),this.settingsDialog=new MN(this.ctx),this.textInput=new oI(this.ctx),this.postUpdateFns=[],this.state=this.setupStateMachine(),this.setupListeners(),this.setupDOM(),this.ctx.historyManager.addMementoOriginator(t.annotationManager),this.ctx.historyManager.addMementoOriginator(this.defaults),this.textInput.setKeyDownHandler(this.onTextInput.bind(this)),this.cleanup.register(()=>{this.clear(),this.xAxis?.button?.destroy(),this.yAxis?.button?.destroy(),this.textInput.destroy()})}setupStateMachine(){const{ctx:t}=this;return new Ml({resetToIdle:()=>{t.domManager.updateCursor("annotations"),this.popAnnotationState(Bt.Annotations),this.hideOverlays(),this.optionsToolbar.hide(),this.deleteEphemeralAnnotations(),this.update()},hoverAtCoords:(i,o,s)=>{let a;return this.annotations.each((n,r,l)=>{if(!r.isHoverable())return;const c=n.containsPoint(i.x,i.y);c&&(a??(a=l)),n.toggleHovered(c,o===l,r.readOnly)}),a!=null?t.tooltipManager.suppressTooltip("annotations"):this.isAnnotationState()||t.tooltipManager.unsuppressTooltip("annotations"),(a==null||!this.annotationData.at(a)?.readOnly)&&this.ctx.domManager.updateCursor("annotations",a==null?void 0:this.annotations.at(a)?.getCursor()),a!==s&&this.update(),a},getNodeAtCoords:(i,o)=>{const s=this.annotations.at(o);if(s)return s.getNodeAtCoords(i.x,i.y)},translate:(i,o)=>{const s=this.annotations.at(i),a=Rs(this.annotationData.at(i));if(!(!s||!a))return this.translateNode(s,a,o)},copy:i=>{const o=this.annotations.at(i),s=Rs(this.annotationData.at(i));if(!(!o||!s))return this.createAnnotationDatumCopy(o,s)},paste:i=>{this.createAnnotation(i.type,i,!1),this.postUpdateFns.push(()=>{this.state.transitionAsync("selectLast"),this.state.transitionAsync("copy")})},select:(i,o)=>{const{annotations:s,optionsToolbar:a,toolbar:n}=this;this.hideOverlays(),n.clearActiveButton(),n.resetButtonIcons();const r=i==null?null:s.at(i),l=o==null?null:s.at(o),c=i==null?null:this.annotationData.at(i);l===r&&r!=null||(l?.toggleActive(!1),a.hide(),r&&!c?.readOnly?(this.pushAnnotationState(Bt.AnnotationsSelected),r.toggleActive(!0),Bo(c)||(a.updateButtons(this.annotationData.at(i)),this.postUpdateFns.push(()=>{a.show(),a.setAnchorScene(r)}))):(this.popAnnotationState(Bt.AnnotationsSelected),this.popAnnotationState(Bt.Annotations)),Bo(c)||this.deleteEphemeralAnnotations(),this.update())},selectLast:()=>(this.pushAnnotationState(Bt.AnnotationsSelected),this.annotationData.length-1),startInteracting:()=>{this.pushAnnotationState(Bt.Annotations)},stopInteracting:()=>{this.popAnnotationState(Bt.Annotations)},create:(i,o)=>{this.createAnnotation(i,o)},delete:i=>{this.annotationData.splice(i,1)},deleteAll:()=>{const i=this.annotationData.filter(o=>{if(o.readOnly===!0)return o});this.annotationData.splice(0,this.annotationData.length);for(const o of i)this.annotationData.push(o)},validatePoint:(i,o)=>{const s=this.getAnnotationContext();return s?ul(s,i,o):!0},getAnnotationType:i=>nI(this.annotationData[i].type),datum:i=>this.annotationData.at(i),node:i=>this.annotations.at(i),recordAction:i=>{this.recordActionAfterNextUpdate(i)},update:()=>{this.postUpdateFns.push(()=>{const i=this.state.getActive(),o=i==null?null:this.annotations.at(i);o!=null&&this.optionsToolbar.setAnchorScene(o)}),this.update()},showTextInput:i=>{const o=Rs(this.annotationData.at(i));if(!this.annotations.at(i)||!o||!("getTextInputCoords"in o)||!("getTextPosition"in o))return;const a={color:o.color,fontFamily:o.fontFamily,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight,placeholderColor:o.getPlaceholderColor()},n=this.getAnnotationContext(),r=c=>Ds.add(o.getTextInputCoords(n,c),Ds.required(this.seriesRect)),l=()=>o.getTextPosition();this.textInput.show({styles:a,layout:{getTextInputCoords:r,getTextPosition:l,alignment:o.alignment,textAlign:o.textAlign,width:o.width},text:o.text,placeholderText:o.placeholderText,onChange:(c,h)=>{this.state.transition("updateTextInputBBox",h)}}),this.ctx.domManager.updateCursor("annotations")},hideTextInput:()=>{this.textInput.hide()},updateTextInputColor:i=>{this.textInput.updateColor(i)},updateTextInputFontSize:i=>{const o=this.textInput.updateFontSize(i);this.state.transition("updateTextInputBBox",o)},updateTextInputBBox:i=>{this.state.transition("updateTextInputBBox",i)},showAnnotationOptions:i=>{const o=this.annotations.at(i);!o||Bo(this.annotationData.at(i))||(this.optionsToolbar.updateButtons(this.annotationData.at(i)),this.optionsToolbar.show(),this.optionsToolbar.setAnchorScene(o))},showAnnotationSettings:(i,o,s="line")=>{const a=this.annotationData.at(i);if(!Qr(a)&&!mo(a)&&!En(a)||Bo(a))return;const n=c=>(h,d,u,g)=>{this.setColorAndDefault(a.type,c,h,d,u,g),this.optionsToolbar.updateColorPickerColor(c,d,u,g)},r=c=>()=>{this.recordActionAfterNextUpdate(`Change ${a.type} ${c} to ${a.getDefaultColor(c)}`,["annotations","defaults"]),this.update()},l={initialSelectedTab:s,ariaLabel:this.ctx.localeManager.t("ariaLabelAnnotationSettingsDialog"),sourceEvent:o,onChangeLine:c=>{this.state.transition("lineProps",c),c.bands!=null&&this.defaults.setDefaultFibonacciOptions(a.type,"bands",c.bands),c.reverse!=null&&this.defaults.setDefaultFibonacciOptions(a.type,"reverse",c.reverse),c.showFill!=null&&this.defaults.setDefaultFibonacciOptions(a.type,"showFill",c.showFill)},onChangeText:c=>{this.state.transition("lineText",c),c.alignment&&this.defaults.setDefaultLineTextAlignment(a.type,c.alignment),c.position&&this.defaults.setDefaultLineTextPosition(a.type,c.position),this.recordActionAfterNextUpdate(`Change ${a.type} text ${Object.keys(c).map(h=>`${h} to ${c[h]}`).join(", ")}`)},onChangeFillColor:n("fill-color"),onChangeHideFillColor:r("fill-color"),onChangeLineColor:n("line-color"),onChangeHideLineColor:r("line-color"),onChangeLineStyleType:c=>{this.setLineStyleTypeAndDefault(a.type,c),this.optionsToolbar.updateLineStyleType(_n.find(h=>h.value===c)??_n[0])},onChangeLineStyleWidth:c=>{this.setLineStyleWidthAndDefault(a.type,c),this.optionsToolbar.updateStrokeWidth({strokeWidth:c,value:c,label:String(c)})},onChangeTextColor:n("text-color"),onChangeHideTextColor:r("text-color"),onChangeTextFontSize:c=>{this.setFontSizeAndDefault(a.type,c)}};this.settingsDialog.show(a,l)}})}setupListeners(){const{ctx:t,optionsToolbar:i,settingsDialog:o,toolbar:s}=this,{seriesWidget:a,seriesDragInterpreter:n,chartWidget:r}=t.widgets;n&&this.cleanup.register(n.events.on("click",this.hoverTouchPreHandler.bind(this)),n.events.on("drag-start",this.hoverTouchPreHandler.bind(this)),n.events.on("drag-move",this.dragMoveTouchPreHandler.bind(this)),n.events.on("mousemove",this.onHover.bind(this)),n.events.on("click",this.onClick.bind(this)),n.events.on("dblclick",this.onDoubleClick.bind(this)),n.events.on("drag-start",this.onDragStart.bind(this)),n.events.on("drag-move",this.onDrag.bind(this)),n.events.on("drag-end",this.onDragEnd.bind(this))),this.cleanup.register(a.addListener("keydown",this.onKeyDown.bind(this)),a.addListener("keyup",this.onKeyUp.bind(this)),r.addListener("click",this.onCancel.bind(this)),t.eventsHub.on("annotations:restore",this.onRestoreAnnotations.bind(this)),t.eventsHub.on("layout:complete",this.onLayoutComplete.bind(this)),t.updateService.addListener("pre-scene-render",this.onPreRender.bind(this)),t.eventsHub.on("zoom:change-complete",()=>this.onResize()),t.eventsHub.on("dom:resize",()=>this.onResize()),s.events.on("cancel-create-annotation",()=>{this.cancel(),this.reset(),this.update()}),s.events.on("pressed-create-annotation",({annotation:l})=>{this.cancel(),this.pushAnnotationState(Bt.Annotations),this.state.transition(l),this.update()}),s.events.on("pressed-clear",()=>{this.clear(),this.recordActionAfterNextUpdate("Clear all")}),s.events.on("pressed-show-menu",()=>{this.cancel(),this.reset()}),s.events.on("pressed-unrelated",()=>{this.reset()}),i.events.on("pressed-delete",()=>{this.cancel(),this.delete(),this.reset()}),i.events.on("pressed-settings",({sourceEvent:l})=>{this.state.transition("toolbarPressSettings",l)}),i.events.on("pressed-lock",({locked:l})=>{this.recordActionAfterNextUpdate(l?"Locked":"Unlocked"),this.update()}),i.events.on("hid-overlays",()=>{this.settingsDialog.hide()}),i.events.on("saved-color",({type:l,colorPickerType:c,color:h})=>{this.recordActionAfterNextUpdate(`Change ${l} ${c} to ${h}`,["annotations","defaults"])}),i.events.on("updated-color",({type:l,colorPickerType:c,colorOpacity:h,color:d,opacity:u,isMultiColor:g})=>{this.setColorAndDefault(l,c,h,d,u,g)}),i.events.on("updated-font-size",({type:l,fontSize:c})=>{this.setFontSizeAndDefault(l,c)}),i.events.on("updated-line-style",({type:l,lineStyleType:c})=>{this.setLineStyleTypeAndDefault(l,c)}),i.events.on("updated-line-width",({type:l,strokeWidth:c})=>{this.setLineStyleWidthAndDefault(l,c)}),o.events.on("hidden",()=>{this.optionsToolbar.clearActiveButton()}))}setupDOM(){const{ctx:t,toolbar:i,optionsToolbar:o}=this;this.cleanup.register(t.annotationManager.attachNode(this.container),()=>{t.domManager.removeStyles(Hn),i.destroy(),o.destroy()})}async processData(t){if(!this.enabled||this.data==null||this.xKey==null||this.volumeKey==null)return;const i=[LN(this.xKey,void 0,{id:"date"}),NN(this.volumeKey,"number",{id:"volume"})],o=Hr.DataSet.wrap(this.data)??Hr.DataSet.empty(),{dataModel:s,processedData:a}=await t.request("annotations",o,{props:i});this.dataModel=s,this.processedData=a}createAnnotationScene(t){if(t.type in Yt)return new Yt[t.type].scene;throw new Error(`AG Charts - Cannot create annotation scene of type [${t.type}], expected one of [${Object.keys(Yt)}], ignoring.`)}static createAnnotationDatum(t){if(t.type in Yt)return new Yt[t.type].datum().set(t);throw new Error(`AG Charts - Cannot create annotation datum of unknown type [${t.type}], expected one of [${Object.keys(Yt)}], ignoring.`)}createAnnotation(t,i,o=!0){if(this.annotationData.push(i),o){const s=this.ctx.annotationManager.getAnnotationTypeStyles(t);s&&i.set(s),this.defaults.applyDefaults(i)}this.injectDatumDependencies(i),this.update()}injectDatumDependencies(t){"setLocaleManager"in t&&t.setLocaleManager(this.ctx.localeManager),"getVolume"in t&&(t.getVolume=this.getDatumRangeVolume.bind(this))}getDatumRangeVolume(t,i){const{dataModel:o,processedData:s}=this;let a=We(t),n=We(i);if(!Bh(a)||!Bh(n)||!o||!s||this.volumeKey==null)return;a>n&&([a,n]=[n,a]);const r=o.resolveKeysById({id:"annotations"},"date",s),l=o.resolveColumnById({id:"annotations"},"volume",s);let c=0;for(let h=0;h<s.input.count;h++){const d=r[h];Bh(d)&&d>=a&&d<=n&&(c+=l[h])}return c}translateNode(t,i,o){const s=this.getAnnotationConfig(i),a=this.getAnnotationContext();a&&s.translate(t,i,o,a)}createAnnotationDatumCopy(t,i){const o=this.getAnnotationConfig(i),s=new o.datum;s.set(i.toJson());const a=this.getAnnotationContext();if(a)return o.copy(t,i,s,a)}getAnnotationConfig(t){if(t.type in Yt)return Yt[t.type];throw new Error(`AG Charts - Cannot get annotation config of unknown type [${t.type}], expected one of [${Object.keys(Yt)}], ignoring.`)}onRestoreAnnotations(t){this.enabled&&(this.clear(),this.annotationData.set(t.annotations),this.postUpdateFns.push(()=>{this.ctx.annotationManager.fireChangedEvent()}),this.update())}onLayoutComplete(t){if(!this.enabled)return;const i=t.series.paddedRect;this.seriesRect=i,this.container.setClipRect(i),this.xAxis=this.getAxis(t.axes[_h.X],i,this.xAxis?.button),this.yAxis=this.getAxis(t.axes[_h.Y],i,this.yAxis?.button),this.showAnnotations()?this.animateAnnotations({from:0,to:1,phase:"trailing"}):this.animateAnnotations({from:1,to:0,phase:"remove"})}showAnnotations(){if(!this.yAxis||!this.xAxis)return!1;const t=this.ctx.chartService.series.some(s=>s.hasData),o=this.yAxis.context.seriesIds().some(s=>this.ctx.chartService.series.find(n=>n.id===s)?.visible);return t&&o}animateAnnotations({from:t,to:i,phase:o}){const{annotations:s}=this;this.ctx.animationManager?.animate({from:t,to:i,id:"chart-annotations",phase:o,groupId:"opacity",onUpdate(a){s.each(n=>{n.opacity=a,"setAxisLabelOpacity"in n&&n.setAxisLabelOpacity(a)})},onStop(){s.each(a=>{a.opacity=i,"setAxisLabelOpacity"in a&&a.setAxisLabelOpacity(i)})}})}onPreRender(){this.enabled&&(this.updateAnnotations(),this.state.transition("render"))}getAxis(t,i,o){const s=this.ctx.axisManager.getAxisContext(t.direction)[0],{position:a="bottom",direction:n}=s,r=t.gridPadding+t.seriesAreaPadding,l=new TN(0,0,i.width,i.height).grow(r,a),c=n===_h.X?"vertical":"horizontal",{axesButtons:h,snap:d}=this;if(this.enabled&&h.enabled&&(h.axes==="xy"||h.axes===n)){o??(o=new Pf(this.ctx,{...s,snapToGroup:d},m=>this.onAxisButtonClick(m,c),i));const g=Td(t);o.update(i,g)}else o?.destroy(),o=void 0;return{layout:t,context:s,bounds:l,button:o}}recordActionAfterNextUpdate(t,i=["annotations"]){const{defaults:o,ctx:{annotationManager:s,historyManager:a}}=this,n=i.map(r=>r==="defaults"?o:s);this.postUpdateFns.push(()=>{a.record(t,...n),s.fireChangedEvent()})}setColorAndDefault(t,i,o,s,a,n){this.state.transition("color",{colorPickerType:i,colorOpacity:o,color:s,opacity:a,isMultiColor:n}),this.defaults.setDefaultColor(t,i,o,s,a,n)}setFontSizeAndDefault(t,i){this.state.transition("fontSize",i),this.defaults.setDefaultFontSize(t,i),this.recordActionAfterNextUpdate(`Change ${t} font size to ${i}`,["annotations","defaults"])}setLineStyleTypeAndDefault(t,i){this.state.transition("lineStyle",{type:i}),this.defaults.setDefaultLineStyleType(t,i),this.recordActionAfterNextUpdate(`Change ${t} line style to ${i}`,["annotations","defaults"])}setLineStyleWidthAndDefault(t,i){this.state.transition("lineStyle",{strokeWidth:i}),this.defaults.setDefaultLineStyleWidth(t,i),this.recordActionAfterNextUpdate(`Change ${t} stroke width to ${i}`,["annotations","defaults"])}updateAnnotations(){const{annotationData:t,annotations:i,seriesRect:o,ctx:{annotationManager:s}}=this,a=this.getAnnotationContext();if(!o||!a)return;s.updateData(t.toJson());const n=this.showAnnotations();this.toolbar.refreshButtonsEnabled(n),this.toolbar.toggleClearButtonEnabled(t.length>0&&n),i.update(t??[],void 0,r=>r.id).each((r,l)=>{if(!n){r.visible=!1,"setAxisLabelVisible"in r&&r.setAxisLabelVisible(!1);return}"setAxisLabelVisible"in r&&r.setAxisLabelVisible(!0),this.injectDatumDependencies(l),IN(r,l,a)});for(const r of this.postUpdateFns)r();this.postUpdateFns=[]}getAnnotationContext(){const{seriesRect:t,xAxis:i,yAxis:o,snap:s}=this;if(t&&i&&o)return{seriesRect:t,xAxis:{...i.context,bounds:i.bounds,labelPadding:Td(i.layout),snapToGroup:s},yAxis:{...o.context,bounds:o.bounds,labelPadding:Td(i.layout),snapToGroup:s}}}onHover(t){const{state:i}=this,o=this.getAnnotationContext();if(!o)return;const s=t.sourceEvent.shiftKey,a=Ds.from(t),n=It(a,o);i.transition("hover",{offset:a,point:n,shiftKey:s,context:o})}onClick(t){const{state:i}=this,o=this.getAnnotationContext();if(!o)return;const s=t.sourceEvent.shiftKey,a=It(Ds.from(t),o),n=this.textInput.getValue(),r=this.textInput.getBBox();i.transition("click",{point:a,shiftKey:s,textInputValue:n,bbox:r})}onDoubleClick(t){const{state:i}=this;if(!this.getAnnotationContext())return;const s=Ds.from(t);i.transition("dblclick",{offset:s})}onAxisButtonClick(t,i){this.cancel(),this.reset();const o=this.getAnnotationContext();if(!this.annotationData||!o)return;const{state:s}=this;this.pushAnnotationState(Bt.Annotations);const a=i==="horizontal";if(s.transition(a?"horizontal-line":"vertical-line"),this.optionsToolbar.hide(),!t)return;const n=It(t,o);ul(o,n)&&(s.transition("click",{point:n,shiftKey:!1}),this.update())}onResize(){const t=this.textInput.getValue(),i=this.textInput.getBBox();this.state.transition("resize",{textInputValue:t,bbox:i})}hoverTouchPreHandler(t){t.device==="touch"&&this.onHover(t)}dragMoveTouchPreHandler(t){t.device==="touch"&&this.ctx.interactionManager.isState(Bt.AnnotationsSelected)&&t.sourceEvent.preventDefault()}onDragStart(t){if(!this.ctx.interactionManager.isState(Bt.AnnotationsDraggable))return;const i=this.getAnnotationContext();if(!i)return;const o=Ds.from(t),s=It(o,i),a=this.textInput.getValue(),n=this.textInput.getBBox();this.state.transition("dragStart",{context:i,offset:o,point:s,textInputValue:a,bbox:n})}onDrag(t){if(!this.ctx.interactionManager.isState(Bt.AnnotationsDraggable))return;const i=this.getAnnotationContext();if(!i)return;const o=Ds.from(t),s=It(o,i),a=t.sourceEvent.shiftKey,n=this.textInput.getValue(),r=this.textInput.getBBox();this.state.transition("drag",{context:i,offset:o,point:s,shiftKey:a,textInputValue:n,bbox:r})}onDragEnd(){this.state.transition("dragEnd")}onCancel(t){const{sourceEvent:i}=t??{};i?.currentTarget===i?.target&&(this.cancel(),this.reset())}onDelete(){this.textInput.isVisible()||(this.cancel(),this.delete(),this.reset(),this.update())}onTextInput(t){const{state:i}=this,o=this.getAnnotationContext();if(!o)return;const{key:s,shiftKey:a}=t,n=this.textInput.getValue(),r=this.textInput.getBBox();i.transition("textInput",{key:s,shiftKey:a,textInputValue:n,bbox:r,context:o})}onKeyDown(t){const{state:i}=this,o=this.getAnnotationContext();if(!o)return;const{sourceEvent:s}=t,{shiftKey:a,ctrlKey:n,metaKey:r}=s,l=n||r,c=n||a;i.transition("keyDown",{shiftKey:a,context:o});const h={x:0,y:0},d=Math.max(o?.xAxis.scale.bandwidth??0,c?10:1),u=Math.max(o?.yAxis.scale.bandwidth??0,c?10:1);switch(s.key){case"ArrowDown":h.y=u;break;case"ArrowUp":h.y=-u;break;case"ArrowLeft":h.x=-d;break;case"ArrowRight":h.x=d;break;case"Escape":this.onCancel();return;case"Backspace":case"Delete":this.onDelete();return}if((h.x||h.y)&&(i.transition("translate",{translation:h}),s.stopPropagation(),s.preventDefault()),!!l)switch(s.key){case"c":i.transition("copy");return;case"x":i.transition("cut"),this.recordActionAfterNextUpdate("Cut annotation");return;case"v":i.transition("paste"),this.recordActionAfterNextUpdate("Paste annotation");return}}onKeyUp(t){const{shiftKey:i}=t.sourceEvent,o=this.getAnnotationContext();o&&(this.state.transition("keyUp",{shiftKey:i,context:o}),this.state.transition("translateEnd"))}clear(){this.cancel(),this.deleteAll(),this.reset()}reset(){this.state.transition("reset")}cancel(){this.state.transition("cancel")}delete(){this.state.transition("delete")}deleteAll(){this.state.transition("deleteAll")}deleteEphemeralAnnotations(){let t=!1;for(const[i,o]of this.annotationData.entries())Bo(o)&&(this.annotationData.splice(i,1),t=!0);t&&this.recordActionAfterNextUpdate("Delete ephemeral annotations")}hideOverlays(){this.settingsDialog.hide(),this.toolbar.hideOverlays(),this.optionsToolbar.hideOverlays()}pushAnnotationState(t){this.ctx.interactionManager.pushState(t),this.ctx.tooltipManager.suppressTooltip("annotations")}popAnnotationState(t){this.ctx.interactionManager.popState(t),this.ctx.tooltipManager.unsuppressTooltip("annotations")}isAnnotationState(){return this.ctx.interactionManager.isState(Bt.Annotations)||this.ctx.interactionManager.isState(Bt.AnnotationsSelected)}update(t=j0.PRE_SCENE_RENDER){this.ctx.updateService.update(t)}};p([wn],wa.prototype,"toolbar",2),p([wn],wa.prototype,"optionsToolbar",2),p([wn],wa.prototype,"axesButtons",2),p([wn,X0((e,t)=>{const i=t??!0;e.toolbar.enabled=i,e.optionsToolbar.enabled=i,e.axesButtons.enabled=i})],wa.prototype,"enabled",2),p([wn],wa.prototype,"snap",2);var wN=wa;import"ag-charts-community";import*as nt from"ag-charts-core";import{FONT_SIZE_RATIO as wd}from"ag-charts-core";var mi={stroke:{$ref:"foregroundColor"},strokeOpacity:1,strokeWidth:2},rt={fill:nt.DEFAULT_ANNOTATION_HANDLE_FILL,strokeOpacity:1,strokeWidth:2},Es={color:{$ref:"chartBackgroundColor"},fontSize:{$rem:wd.LARGE},fontFamily:{$ref:"fontFamily"}},Vf={...Es,enabled:!0,fill:{$ref:"foregroundColor"},fontSize:{$ref:"fontSize"}},Cl={...Es,textAlign:"left"},_s={...Es,position:"top",alignment:"center",color:{$ref:"textColor"}},zf={...Es,position:"top",alignment:"center",color:{$ref:"textColor"}},Pd={...Es,fontSize:{$ref:"fontSize"},color:nt.DEFAULT_ANNOTATION_STATISTICS_COLOR,fill:nt.DEFAULT_ANNOTATION_STATISTICS_FILL,stroke:nt.DEFAULT_ANNOTATION_STATISTICS_STROKE,strokeWidth:1,divider:{stroke:nt.DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE,strokeWidth:1,strokeOpacity:.5}},Od={...mi,background:{fill:{$ref:"foregroundColor"},fillOpacity:.075},handle:{...rt},text:{..._s},statistics:{...Pd}},PN={buttons:{$shallowSimple:[{icon:"text-annotation",tooltip:"toolbarAnnotationsTextAnnotations",value:"text-menu"},{icon:"trend-line-drawing",tooltip:"toolbarAnnotationsLineAnnotations",value:"line-menu"},{icon:"arrow-drawing",tooltip:"toolbarAnnotationsShapeAnnotations",value:"shape-menu"},{icon:"delete",tooltip:"toolbarAnnotationsClearAll",value:"clear"}]},padding:{$ref:"chartPadding"}},ON={buttons:{$shallowSimple:[{icon:"text-annotation",tooltip:"toolbarAnnotationsTextColor",value:"text-color"},{icon:"line-color",tooltip:"toolbarAnnotationsLineColor",value:"line-color"},{icon:"fill-color",tooltip:"toolbarAnnotationsFillColor",value:"fill-color"},{tooltip:"toolbarAnnotationsTextSize",value:"text-size"},{tooltip:"toolbarAnnotationsLineStrokeWidth",value:"line-stroke-width"},{icon:"line-style-solid",tooltip:"toolbarAnnotationsLineStyle",value:"line-style-type"},{icon:"settings",tooltip:"toolbarAnnotationsSettings",value:"settings"},{icon:"unlocked",tooltip:"toolbarAnnotationsLock",ariaLabel:"toolbarAnnotationsLock",checkedOverrides:{icon:"locked",tooltip:"toolbarAnnotationsUnlock"},value:"lock"},{icon:"delete",tooltip:"toolbarAnnotationsDelete",value:"delete"}]}},RN={enabled:!1,line:{...mi,handle:{...rt},text:{..._s}},"horizontal-line":{...mi,handle:{...rt},axisLabel:{...Vf},text:{..._s}},"vertical-line":{...mi,handle:{...rt},axisLabel:{...Vf},text:{..._s}},"disjoint-channel":{...mi,background:{fill:{$ref:"foregroundColor"},fillOpacity:.075},handle:{...rt},text:{...zf}},"parallel-channel":{...mi,middle:{lineDash:[6,5],strokeWidth:1},background:{fill:{$ref:"foregroundColor"},fillOpacity:.075},handle:{...rt},text:{...zf}},"fibonacci-retracement":{...mi,strokes:nt.DEFAULT_FIBONACCI_STROKES,rangeStroke:{$ref:"foregroundColor"},handle:{...rt},text:{..._s,position:"center"},label:{...Es,color:void 0,fontSize:{$rem:wd.SMALLER}}},"fibonacci-retracement-trend-based":{...mi,strokes:nt.DEFAULT_FIBONACCI_STROKES,rangeStroke:{$ref:"foregroundColor"},handle:{...rt},text:{..._s,position:"center"},label:{...Es,color:void 0,fontSize:{$rem:wd.SMALLER}}},callout:{...mi,...Cl,color:{$ref:"textColor"},handle:{...rt},fill:{$ref:"foregroundColor"},fillOpacity:.075},comment:{...Cl,fontWeight:700,handle:{...rt},fill:{$ref:"foregroundColor"}},note:{...Cl,color:nt.DEFAULT_TEXTBOX_COLOR,fill:nt.DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,stroke:{$ref:"chartBackgroundColor"},strokeWidth:1,strokeOpacity:1,handle:{...rt},background:{fill:nt.DEFAULT_TEXTBOX_FILL,stroke:nt.DEFAULT_TEXTBOX_STROKE,strokeWidth:1}},text:{...Cl,color:{$ref:"textColor"},handle:{...rt}},arrow:{...mi,handle:{...rt},text:{..._s}},"arrow-up":{fill:{$palette:"up.fill"},handle:{...rt,stroke:{$ref:"foregroundColor"}}},"arrow-down":{fill:{$palette:"down.fill"},handle:{...rt,stroke:{$ref:"foregroundColor"}}},"date-range":{...Od},"price-range":{...Od},"date-price-range":{...Od},"quick-date-price-range":{up:{...mi,fill:nt.DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2,handle:{...rt},statistics:{...Pd,color:"#fff",fill:nt.DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}}},down:{...mi,stroke:nt.DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE,fill:nt.DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL,fillOpacity:.2,handle:{...rt,stroke:nt.DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE},statistics:{...Pd,color:"#fff",fill:nt.DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}}}},axesButtons:{},toolbar:PN,optionsToolbar:ON},Rd={type:"plugin",name:"annotations",chartType:"cartesian",enterprise:!0,version:K0,options:G0.annotationOptionsDef,themeTemplate:RN,create:e=>new wN(e),patchContext:e=>{e.sharedToolbar||(e.sharedToolbar=new Wm(e),e.cleanup.register(()=>e.sharedToolbar.destroy()))}};import{VERSION as EN}from"ag-charts-community";import{_ModuleSupport as _N}from"ag-charts-community";import{AbstractModuleInstance as BN,ChartAxisDirection as VN,ChartUpdateType as Ff,Property as Ci,ZIndexMap as zN,createId as FN}from"ag-charts-core";var{Range:HN,TranslatableGroup:WN,BBox:KN,FillGradientDefaults:GN,FillImageDefaults:$N,FillPatternDefaults:YN,getShapeFill:UN,InteractionState:Tl}=_N,Ut=class extends BN{constructor(e){super(),this.ctx=e,this.id=FN(this),this.enabled=!1,this.stroke="rgb(195, 195, 195)",this.lineDash=[6,3],this.lineDashOffset=0,this.strokeWidth=1,this.strokeOpacity=1,this.fill="#c16068",this.fillOpacity=1,this.fillGradientDefaults=new GN,this.fillPatternDefaults=new YN,this.fillImageDefaults=new $N,this.bounds=new KN(0,0,0,0),this.bandHighlightGroup=new WN({name:"bandHighlight",zIndex:zN.AXIS_BAND_HIGHLIGHT}),this.rangeNode=this.bandHighlightGroup.appendChild(new HN),this.activeAxisHighlight=void 0,this.axisCtx=e.parent,this.hideBand(),e.domManager.addEventListener("focusin",({target:a})=>{const n=a instanceof HTMLElement&&e.domManager.contains(a,"series-area");this.bandHighlightGroup.visible&&!n&&(this.hideBand(),this.ctx.updateService.update(Ff.SCENE_RENDER))});const{widgets:{seriesWidget:t,seriesDragInterpreter:i},animationManager:o,eventsHub:s}=e;this.cleanup.register(e.scene.attachNode(this.bandHighlightGroup),t.addListener("mousemove",a=>this.onHoverLikeEvent(a)),t.addListener("mouseleave",()=>this.clearAllHighlight()),o.addListener("animation-start",()=>this.clearAllHighlight()),s.on("layout:complete",a=>this.layout(a)),s.on("series:focus-change",()=>this.onKeyPress()),s.on("zoom:pan-start",()=>this.clearAllHighlight()),s.on("zoom:change-complete",()=>this.clearAllHighlight()),s.on("dom:resize",()=>this.clearAllHighlight()),s.on("axis:change",()=>this.axisChange())),i&&this.cleanup.register(i.events.on("drag-move",a=>this.onHoverLikeEvent(a)),i.events.on("click",a=>this.onClick(a)))}axisChange(){this.onHighlightChange()}isHover(e){return e.type==="mousemove"||e.type==="click"||e.device==="touch"&&this.ctx.chartService.touch.dragAction==="hover"}onClick(e){e.device==="touch"&&this.onHoverLikeEvent(e)}clearAllHighlight(){this.ctx.interactionManager.isState(Tl.Clickable)&&this.onHighlightChange()}onKeyPress(){this.ctx.interactionManager.isState(Tl.Default)&&this.onHighlightChange()}onHoverLikeEvent(e){const t=this.isHover(e)?Tl.Clickable:Tl.AnnotationsMoveable;this.ctx.interactionManager.isState(t)&&this.handleHoverHighlight(e)}handleHoverHighlight(e){if(!e)return;const{currentX:t,currentY:i}=e;this.onHighlightChange(this.axisCtx.pickBand({x:t,y:i}))}layout({series:{rect:e,visible:t},axes:i}){if(!t||!i||!this.enabled)return;const{position:o="left",axisId:s}=this.axisCtx,a=i[s];if(!a)return;this.axisLayout=a,this.bounds=e.clone().grow(a.gridPadding,o);const{bandHighlightGroup:n,bounds:r}=this;n.translationX=Math.round(r.x),n.translationY=Math.round(r.y),this.updateBand()}updateBand(){const{rangeNode:e,stroke:t,strokeWidth:i,strokeOpacity:o,lineDash:s,fill:a,fillOpacity:n,fillGradientDefaults:r,fillPatternDefaults:l,fillImageDefaults:c,lineDashOffset:h,axisLayout:d}=this;d&&(e.stroke=t,e.strokeWidth=i,e.strokeOpacity=o,e.lineDash=s,e.lineDashOffset=h,e.fill=UN(a,r,l,c),e.fillOpacity=n,e.startLine=!0,e.endLine=!0)}isVertical(){return this.axisCtx.direction===VN.X}onHighlightChange(e){this.enabled&&(this.activeAxisHighlight=e,this.activeAxisHighlight?this.showBand():this.hideBand(),this.ctx.updateService.update(Ff.SCENE_RENDER))}updateBandPosition(){const{rangeNode:e,bounds:t}=this,{band:i}=this.activeAxisHighlight??{};if(i==null){this.hideBand();return}let o=Math.min(...i),s=Math.max(...i);if(s-o<1){const a=(o+s)/2;o=a-.5,s=a+.5}this.isVertical()?(e.y1=0,e.y2=t.height,e.x1=o,e.x2=s,e.horizontal=!0):(e.y1=o,e.y2=s,e.x1=0,e.x2=t.width,e.horizontal=!1)}showBand(){this.updateBandPosition(),this.bandHighlightGroup.visible=!0}hideBand(){this.bandHighlightGroup.visible=!1}};Ut.className="BandHighlight",p([Ci],Ut.prototype,"enabled",2),p([Ci],Ut.prototype,"stroke",2),p([Ci],Ut.prototype,"lineDash",2),p([Ci],Ut.prototype,"lineDashOffset",2),p([Ci],Ut.prototype,"strokeWidth",2),p([Ci],Ut.prototype,"strokeOpacity",2),p([Ci],Ut.prototype,"fill",2),p([Ci],Ut.prototype,"fillOpacity",2),p([Ci],Ut.prototype,"fillGradientDefaults",2),p([Ci],Ut.prototype,"fillPatternDefaults",2),p([Ci],Ut.prototype,"fillImageDefaults",2);var Ed={type:"axis:plugin",name:"bandHighlight",chartType:"cartesian",axisTypes:["category","ordinal-time","unit-time","grouped-category"],enterprise:!0,version:EN,themeTemplate:{enabled:!1,strokeWidth:0,lineDash:[],fill:{$foregroundBackgroundMix:.05}},create:e=>new Ut(e)};import{VERSION as jN}from"ag-charts-community";import{boolean as XN}from"ag-charts-core";import{_ModuleSupport as ZN}from"ag-charts-community";import{AbstractModuleInstance as qN,ActionOnSet as QN,Logger as JN,Property as eC}from"ag-charts-core";var{LayoutElement:tC,Menu:iC}=ZN,_d=[{label:"toolbarSeriesTypeOHLC",icon:"ohlc-series",value:"ohlc"},{label:"toolbarSeriesTypeCandles",icon:"candlestick-series",value:"candlestick"},{label:"toolbarSeriesTypeHollowCandles",icon:"hollow-candlestick-series",value:"hollow-candlestick"},{label:"toolbarSeriesTypeLine",icon:"line-series",value:"line"},{label:"toolbarSeriesTypeStepLine",icon:"step-line-series",value:"step-line"},{label:"toolbarSeriesTypeHLC",icon:"hlc-series",value:"hlc"},{label:"toolbarSeriesTypeHighLow",icon:"high-low-series",value:"high-low"}],Hf=class extends qN{constructor(e){super(),this.ctx=e,this.enabled=!1,this.menu=new iC(this.ctx,"chart-toolbar"),this.toolbar=e.sharedToolbar.getSharedToolbar("chartToolbar"),this.cleanup.register(this.toolbar.addToolbarListener("button-pressed",this.onButtonPressed.bind(this)),e.layoutManager.registerElement(tC.ToolbarLeft,this.onLayoutStart.bind(this)),()=>this.toolbar.destroy())}onLayoutStart(e){this.enabled&&(this.updateButton(),this.toolbar.layout(e.layoutBox))}onButtonPressed({event:e,buttonBounds:t,buttonWidget:i}){this.menu.setAnchor({x:t.x+t.width+6,y:t.y}),this.menu.show(i,{items:_d,menuItemRole:"menuitemradio",ariaLabel:this.ctx.localeManager.t("toolbarSeriesTypeDropdown"),class:"ag-charts-chart-toolbar__menu",value:this.getChartType(),sourceEvent:e.sourceEvent,onPress:o=>{this.setChartType(o.value),this.hidePopover()},onHide:()=>{this.toolbar.clearActiveButton()}}),this.toolbar.toggleActiveButtonByIndex(0)}updateButton(){const e=this.getChartType(),t=_d.find(i=>i.value===e)?.icon;t!=null&&this.toolbar.updateButtons([{icon:t,tooltip:"toolbarSeriesTypeDropdown",value:"menu"}])}hidePopover(){this.toolbar.clearActiveButton(),this.menu.hide()}setChartType(e){const t={chartType:e};this.ctx.chartService.publicApi?.updateDelta(t).catch(i=>JN.error(i))}getChartType(){const e=this.ctx.chartService.publicApi?.getOptions()?.chartType;return e==null||!_d.some(t=>t.value===e)?"candlestick":e}};p([eC,QN({changeValue(e){this.toolbar?.setHidden(!e)}})],Hf.prototype,"enabled",2);var wl={type:"plugin",name:"chartToolbar",chartType:"cartesian",enterprise:!0,version:jN,options:{enabled:XN},create:e=>new Hf(e),patchContext:e=>{e.sharedToolbar||(e.sharedToolbar=new Wm(e),e.cleanup.register(()=>e.sharedToolbar.destroy()))}};import{VERSION as oC}from"ag-charts-community";import{IS_DARK_THEME as sC,boolean as Wf,callbackOf as aC,contextMenuItemsArray as Kf,undocumented as nC}from"ag-charts-core";import{_ModuleSupport as Bd,_Widget as Gf}from"ag-charts-community";import{AbstractModuleInstance as rC,Logger as Pl,Property as Ol,callWithContext as Rl,clamp as $f,createElement as Wn,getIconClassNames as lC,toPlainText as Yf}from"ag-charts-core";import{isKeyOf as Uf}from"ag-charts-core";function Vd(e,t){return e==="always"?!0:e==="series-area"?t==="series-area"||t==="series-node":e===t}function jf(e,t,i){let o=!0;if(t.type==="separator"){const s=i.at(-1);o=s!==void 0&&s.type!=="separator"}if(o&&(o=Vd(t.showOn??"always",e)),o){const s=new dC(t);return i.push(s),s}}function Xf(e,t,i,o){t.isVisible(i)&&jf(e,t.builtins.items[i],o)}function cC(e,t,i,o){const{builtins:s}=t;if(Uf(i,s.lists))for(const a of s.lists[i])Xf(e,t,a,o);else Xf(e,t,i,o)}function hC(e,t,i){const o=[],{builtins:s}=i;for(const a of t)if(typeof a=="string"&&Uf(a,s.lists))for(const n of s.lists[a])o.push(n);else o.push(a);return o.filter(a=>{if(typeof a=="string"){const n=i.builtins.items[a].showOn??"always";return i.isVisible(a)&&Vd(n,e)}else return Vd(a.showOn??"always",e)})}function Zf(e,t,i,o){for(const s of i)if(typeof s=="string")cC(e,t,s,o);else{const a=jf(e,s,o);s.items&&a&&s.items.length>0&&Zf(e,t,s.items,a.items)}o.at(-1)?.type==="separator"&&o.pop()}var dC=class{constructor(e){this.type="action",this.showOn="always",this.label="",this.iconUrl=void 0,this.enabled=!0,this.items=[],this.action=void 0,e&&this.setOptions(e),this.items=[]}setField(e,t,i){t[e]=i}setOptions(e){let t;for(t in e)e[t]!==void 0&&this.setField(t,this,e[t])}},So="ag-charts-context-menu",{ContextMenuRegistry:Kn}=Bd,zd="context-menu",pC=["angleKey","calloutLabelKey","colorKey","labelKey","radiusKey","sectorLabelKey","sizeKey","xKey","yKey"],Gn=class extends rC{constructor(e){if(super(),this.ctx=e,this.enabled=!0,this.darkTheme=!1,this.items=["defaults"],this.pickedNode=void 0,this.showEvent=void 0,this.x=0,this.y=0,this.collapsingSubMenus=0,this.menuWidget=new Gf.MenuWidget,this.interactionManager=e.interactionManager,this.element=e.domManager.addChild("canvas-overlay",zd),this.element.classList.add(So),this.element.style.display="none",this.element.addEventListener("contextmenu",t=>t.preventDefault()),this.element.addEventListener("focusout",({relatedTarget:t})=>{this.collapsingSubMenus>0||(t==null||t instanceof Node&&!this.element.contains(t))&&this.hide()}),this.cleanup.register(()=>this.element.remove(),()=>this.menuWidget.destroy(),e.eventsHub.on("dom:hidden",()=>this.hide()),this.menuWidget.addListener("collapse-widget",()=>this.onCollapse())),this.menuWidget.addClass(`${So}__menu`),typeof MutationObserver<"u"){const t=new MutationObserver(()=>{this.element.contains(this.menuWidget.getElement())&&this.reposition()});t.observe(this.element,{childList:!0}),this.mutationObserver=t,this.cleanup.register(()=>t.disconnect())}this.ctx.contextMenuRegistry.builtins.items.download.action=()=>{const t=e.chartService.title;let i="image";t?.enabled&&(i=t.node.getPlainText().replace(/\.+/,"")),this.ctx.chartService.publicApi?.download({fileName:i}).catch(o=>{Pl.error("Unable to download chart",o)})},this.cleanup.register(this.ctx.eventsHub.on("context-menu:complete",t=>this.onContext(t)))}makeGetItemsParams(e){const{showOn:t}=e,{context:i}=this.ctx.chartService,o=hC(t,this.items,this.ctx.contextMenuRegistry);switch(t){case"always":case"series-area":return{showOn:t,context:i,defaultItems:o};case"series-node":{if(this.pickedNode==null)throw new Error("this.pickedNode is null");const c={showOn:t,context:i,seriesId:this.pickedNode.series.id,datum:this.pickedNode.datum,defaultItems:o};for(const h of pC)this.pickedNode[h]!==void 0&&(c[h]=this.pickedNode[h]);return c}case"legend-item":if(this.pickedLegendItem==null)throw new Error("this.pickedLegendItem is null");const{itemId:s,seriesId:a,label:n,enabled:r}=this.pickedLegendItem,l=Yf(n.text);if(typeof s!="string")throw new Error(`unexpected itemId type: [${typeof s}] (expected [string])`);return{showOn:t,context:i,itemId:s,seriesId:a,text:l,visible:r,defaultItems:o};default:return t}}expandItemsOptions(e){const t=[];let i;if(this.getItems){const o=this.makeGetItemsParams(e);i=this.getItems(o)}return i??(i=this.items),Zf(e.showOn,this.ctx.contextMenuRegistry,i,t),t}onContext(e){if(!this.enabled)return;e.widgetEvent.sourceEvent.preventDefault(),this.showEvent=e.widgetEvent.sourceEvent,this.x=e.x,this.y=e.y,this.pickedNode=void 0,this.pickedLegendItem=void 0,Kn.check("series-node",e)?this.pickedNode=e.context.pickedNode:Kn.check("legend-item",e)&&(this.pickedLegendItem=e.context.legendItem);const t=this.expandItemsOptions(e);t.length!==0&&this.show(e.widgetEvent,t)}show(e,t){const{sourceEvent:i}=e;this.interactionManager.pushState(Bd.InteractionState.ContextMenu),this.element.style.display="block";const o=i.pointerType==="touch"?!1:void 0;o!==void 0&&this.ctx.chartService.overrideFocusVisible(o),this.createMenu(t),this.element.appendChild(this.menuWidget.getElement()),this.menuWidget.expand({sourceEvent:i,overrideFocusVisible:o})}hide(){this.menuWidget.collapse()}onCollapse(){this.interactionManager.popState(Bd.InteractionState.ContextMenu),this.menuWidget.getElement().remove(),this.element.style.display="none"}onSubMenuExpand(e,t){const i=e.getBounds();e.setFocusOverride(!0),e.getElement().insertAdjacentElement("afterend",t.getElement()),t.getElement().style.position="absolute";const o=this.ctx.domManager.getBoundingClientRect(),s=e.getBoundingClientRect(),a=o.right-s.right,n=s.left-o.left,{offsetWidth:r,offsetHeight:l}=t.getElement();let c=i.y;if(o.height>l){const h=o.bottom-s.top;h<l&&(c-=l-h)}if(a>=r)t.setBounds({x:i.x+i.width,y:c});else{const h=i.x-r,d=n+h;d>=0?t.setBounds({x:h,y:c}):t.setBounds({x:h-d,y:c})}}onSubMenuCollapse(e,t){e.setFocusOverride(void 0),this.collapsingSubMenus++,t.remove(),this.collapsingSubMenus--}createMenu(e){const{menuWidget:t}=this;t.clear(),t.setTabIndex(-1),this.createMenuItems(t,e)}createMenuItems(e,t){for(const i of t)switch(i.type){case"separator":{e.addSeparator().classList.add(`${So}__divider`);break}case"action":{if(i.items.length===0){const o=new Gf.MenuItemWidget;this.initButtonElement(o,i),e.addChild(o)}else{const{subMenuButton:o,subMenu:s}=e.addSubMenu();s.addClass(`${So}__menu`),s.addListener("expand-widget",()=>this.onSubMenuExpand(o,s)),s.addListener("collapse-widget",()=>this.onSubMenuCollapse(o,s)),this.initButtonElement(o,i),this.createMenuItems(s,i.items)}break}default:throw new Error("unhandled case")}}createButtonOnClick(e,t){return Kn.checkCallback("legend-item",e,t)?i=>{const o=i.sourceEvent;if(this.pickedLegendItem){const{seriesId:s,itemId:a,label:n}=this.pickedLegendItem,{chartService:r}=this.ctx;if(typeof a!="string"){Pl.error(`unexpected itemId type: [${typeof a}] (expected [string])`);return}const c=[r.series.find(d=>d.id===s)?.properties,r],h={type:"contextmenu",seriesId:s,itemId:a,text:Yf(n.text),event:o};Rl(c,t,h),this.hide()}else Pl.error("legend item not found")}:Kn.checkCallback("series-area",e,t)?()=>{const i=this.ctx.chartService,o={type:"seriesContextMenuAction",event:this.showEvent};Rl(i,t,o),this.hide()}:Kn.checkCallback("series-node",e,t)?()=>{const{showEvent:i}=this,{chartService:o}=this.ctx,s=this.pickedNode,a=[s?.series.properties,o],n=s?.series.createNodeContextMenuActionEvent(i,s);n?Rl(a,t,n):Pl.error("series node not found"),this.hide()}:()=>{const i=this.ctx.chartService,o={type:"contextMenuEvent",event:this.showEvent};Rl(i,t,o),this.hide()}}initTableCells(e){const t=Wn("div"),i=Wn("div"),o=Wn("div");return t.classList.toggle(`${So}__icon`,!0),i.classList.toggle(`${So}__cell`,!0),o.classList.toggle(`${So}__cell`,!0),t.ariaHidden="true",i.role="presentation",o.ariaHidden="true",e.append(t,i,o),{cellIcon:t,cellLabel:i,cellArrow:o}}initButtonElement(e,t){e.addClass(`${So}__item`),e.setEnabled(t.enabled);const i=this.ctx.localeManager.t(t.label),o=`${So}__cellpadding`,{cellIcon:s,cellLabel:a,cellArrow:n}=this.initTableCells(e.getElement());if(a.textContent=i,a.classList.add(o),t.iconUrl!=null){const c=Wn("img");c.src=t.iconUrl,s.append(c),s.classList.add(o)}if(t.items.length>0){const c=Wn("span",lC("chevron-right"));n.append(c),n.classList.add(o)}const{showOn:r,action:l}=t;l!=null&&e.addListener("click",this.createButtonOnClick(r,l)),t.items.length===0&&(e.addListener("mouseleave",()=>e.setFocusOverride(!1)),e.addListener("mouseenter",()=>e.setFocusOverride(void 0)))}reposition(){let{x:e,y:t}=this;this.element.style.top="unset",this.element.style.bottom="unset";const i=this.ctx.domManager.getBoundingClientRect(),{offsetWidth:o,offsetHeight:s}=this.element;e=$f(0,e,i.width-o),t=$f(0,t,i.height-s),this.element.style.left=`${e}px`,this.element.style.top=`calc(${t}px - 0.5em)`}destroy(){super.destroy(),this.mutationObserver?.disconnect(),this.ctx.domManager.removeStyles(zd),this.ctx.domManager.removeChild("canvas-overlay",zd)}};p([Ol],Gn.prototype,"enabled",2),p([Ol],Gn.prototype,"darkTheme",2),p([Ol],Gn.prototype,"items",2),p([Ol],Gn.prototype,"getItems",2);var $n={type:"plugin",name:"contextMenu",enterprise:!0,version:oC,options:{enabled:Wf,items:Kf,getItems:aC(Kf,"a menu items array")},themeTemplate:{enabled:!0,darkTheme:sC},create:e=>new Gn(e)};$n.options.darkTheme=nC(Wf);import{VERSION as uC}from"ag-charts-community";import{_ModuleSupport as qf}from"ag-charts-community";import{AbstractModuleInstance as gC,ChartAxisDirection as Qf,ChartUpdateType as Fd,Property as qo,ZIndexMap as Jf,createId as mC,toPlainText as yC}from"ag-charts-core";function Yn(e){return typeof e?.datum=="object"?e.datum:null}import{_ModuleSupport as ex}from"ag-charts-community";import{BaseProperties as fC,Property as Pa,createId as xC,setAttribute as SC}from"ag-charts-core";var{FormatManager:bC}=ex,vC="ag-charts-crosshair-label",Qo=class extends fC{constructor(){super(...arguments),this.enabled=!0,this.xOffset=0,this.yOffset=0,this.format=void 0,this.renderer=void 0,this._cachedFormatter=void 0}formatValue(e,t,i,o){const{formatter:s,format:a}=this,{domain:n,boundSeries:r}=o;let l;if(s!=null){const c=o.type==="number"?o.fractionDigits:void 0,h=o.type==="date"?o.unit:void 0,d=o.type==="date"?o.step:void 0;l=e(s,{value:i,domain:n,fractionDigits:c,unit:h,step:d,boundSeries:r})}if(a!=null){let c=this._cachedFormatter;(c==null||c.type!==t||c.format!==a)&&(c={type:t,format:a,formatter:bC.getFormatter(t,a)},this._cachedFormatter=c),l??(l=c.formatter?.(i))}return l==null?void 0:String(l)}};p([Pa],Qo.prototype,"enabled",2),p([Pa],Qo.prototype,"xOffset",2),p([Pa],Qo.prototype,"yOffset",2),p([Pa],Qo.prototype,"formatter",2),p([Pa],Qo.prototype,"format",2),p([Pa],Qo.prototype,"renderer",2);var tx=class extends Qo{constructor(e,t,i){super(),this.domManager=e,this.id=xC(this),this.element=e.addChild("canvas-overlay",`crosshair-label-${this.id}`),this.element.classList.add(vC),SC(this.element,"aria-hidden",!0),this.element.dataset.key=t,this.element.dataset.axisId=i}show(e){const{element:t}=this,i=e.x+this.xOffset,o=e.y+this.yOffset;t.style.top=`${Math.round(o)}px`,t.style.left=`${Math.round(i)}px`,this.toggle(!0)}setLabelHtml({html:e,styles:t}){if(e!==void 0&&(this.element.innerHTML=e),t!==void 0){const i=this.element.children[0]??this.element;Object.assign(i.style,t)}}getBBox(){const{element:e}=this;return new ex.BBox(e.clientLeft,e.clientTop,e.clientWidth,e.clientHeight)}toggle(e){this.element.classList.toggle("ag-charts-crosshair-label--hidden",!e)}destroy(){this.domManager.removeChild("canvas-overlay",`crosshair-label-${this.id}`)}toLabelHtml(e,t){if(typeof e=="string")return{html:e,styles:{}};t=t??{};const{text:i=t.text??"",color:o=t.color,backgroundColor:s=t.backgroundColor,opacity:a=t.opacity??1}=e,n={opacity:a,"background-color":s?.toLowerCase(),color:o};return{html:`<div class="ag-charts-crosshair-label-content">
                    <span>${i}</span>
                </div>`,styles:n}}};tx.className="CrosshairLabel";var{Group:kC,TranslatableGroup:DC,Line:AC,BBox:ix,InteractionState:El}=qf,Ui=class extends gC{constructor(e){super(),this.ctx=e,this.id=mC(this),this.enabled=!1,this.stroke="rgb(195, 195, 195)",this.lineDash=[6,3],this.lineDashOffset=0,this.strokeWidth=1,this.strokeOpacity=1,this.snap=!0,this.label=new Qo,this.seriesRect=new ix(0,0,0,0),this.bounds=new ix(0,0,0,0),this.crosshairGroup=new DC({name:"crosshairs",zIndex:Jf.SERIES_CROSSHAIR}),this.lineGroup=this.crosshairGroup.appendChild(new kC({name:`${this.id}-crosshair-lines`,zIndex:Jf.SERIES_CROSSHAIR})),this.lineGroupSelection=qf.Selection.select(this.lineGroup,AC,!1),this.activeHighlight=void 0,this.axisCtx=e.parent,this.labels={},this.hideCrosshairs(),e.domManager.addEventListener("focusin",({target:i})=>{const o=i instanceof HTMLElement&&e.domManager.contains(i,"series-area");this.crosshairGroup.visible&&!o&&(this.hideCrosshairs(),this.ctx.updateService.update(Fd.SCENE_RENDER))});const{seriesDragInterpreter:t}=e.widgets;this.cleanup.register(e.scene.attachNode(this.crosshairGroup),e.widgets.seriesWidget.addListener("mousemove",i=>this.onMouseHoverLike(i)),e.widgets.seriesWidget.addListener("mouseleave",()=>this.onMouseOut()),e.eventsHub.on("series:focus-change",()=>this.onKeyPress()),e.eventsHub.on("zoom:pan-start",()=>this.onMouseOut()),e.eventsHub.on("zoom:change-complete",()=>this.onMouseOut()),e.eventsHub.on("highlight:change",i=>this.onHighlightChange(i)),e.eventsHub.on("layout:complete",i=>this.layout(i)),()=>{for(const i of Object.values(this.labels))i.destroy()}),t&&this.cleanup.register(t.events.on("drag-move",i=>this.onMouseHoverLike(i)),t.events.on("click",i=>this.onClick(i)))}layout({series:{rect:e,visible:t},axes:i}){if(!t||!i||!this.enabled)return;this.seriesRect=e;const{position:o="left",axisId:s}=this.axisCtx,a=i[s];if(!a)return;this.axisLayout=a,this.bounds=e.clone().grow(a.gridPadding+a.seriesAreaPadding,o);const{crosshairGroup:n,bounds:r}=this;n.translationX=Math.round(r.x),n.translationY=Math.round(r.y);const l=["pointer",...this.axisCtx.seriesKeyProperties()];this.updateSelections(l),this.updateLines(),this.updateLabels(l)}updateSelections(e){this.lineGroupSelection.update(e,void 0,t=>t)}updateLabels(e){const{labels:t,ctx:i}=this;for(const o of e)this.label.enabled&&(t[o]??(t[o]=new tx(i.domManager,o,this.axisCtx.axisId))),t[o]&&this.updateLabel(t[o])}updateLabel(e){const{enabled:t,xOffset:i,yOffset:o,format:s,renderer:a}=this.label;e.enabled=t,e.xOffset=i,e.yOffset=o,e.format=s,e.renderer=a}updateLines(){const{lineGroupSelection:e,bounds:t,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,axisLayout:r}=this;if(!r)return;const l=this.isVertical();e.each(c=>{c.stroke=i,c.strokeWidth=o,c.strokeOpacity=s,c.lineDash=a,c.lineDashOffset=n,c.y1=0,c.y2=l?t.height:0,c.x1=0,c.x2=l?0:t.width})}isVertical(){return this.axisCtx.direction===Qf.X}isHover(e){return e.type==="mousemove"||e.type==="click"||e.device==="touch"&&this.ctx.chartService.touch.dragAction==="hover"}formatValue(e){return yC(this.axisCtx.formatScaleValue(e,"crosshair",this.label))}onClick(e){e.device==="touch"&&this.onMouseHoverLike(e)}onMouseHoverLike(e){if(!this.enabled||this.snap)return;const t=this.isHover(e)?El.Clickable:El.AnnotationsMoveable;this.ctx.interactionManager.isState(t)&&(this.updatePositions(this.getData(e)),this.crosshairGroup.visible=!0,this.ctx.updateService.update(Fd.SCENE_RENDER))}onMouseOut(){this.ctx.interactionManager.isState(El.Clickable)&&(this.hideCrosshairs(),this.ctx.updateService.update(Fd.SCENE_RENDER))}onKeyPress(){this.enabled&&!this.snap&&this.ctx.interactionManager.isState(El.Default)&&this.hideCrosshairs()}onHighlightChange(e){if(!this.enabled)return;const{crosshairGroup:t,axisCtx:i}=this,{datum:o,series:s}=e.currentHighlight??{},a=o&&(s?.axes.x?.id===i.axisId||s?.axes.y?.id===i.axisId);if(this.activeHighlight=a?e.currentHighlight:void 0,!this.activeHighlight)this.hideCrosshairs();else if(this.snap){const n=this.getActiveHighlightData(this.activeHighlight);this.updatePositions(n),t.visible=!0}}isInRange(e){return this.axisCtx.inRange(e)}updatePositions(e){const{seriesRect:t,lineGroupSelection:i}=this;i.each((o,s)=>{const a=e[s];if(!a){o.visible=!1,this.hideLabel(s);return}o.visible=!0;const{value:n,position:r}=a;let l=0,c=0;this.isVertical()?(l=r,o.x=Math.round(l)):(c=r,o.y=Math.round(c)),this.label.enabled?this.showLabel(l+t.x,c+t.y,n,s):this.hideLabel(s)})}getData(e){const{axisCtx:t}=this,i="pointer",{xKey:o="",yKey:s=""}=this.activeHighlight??{},{currentX:a,currentY:n}=e,r=Yn(this.activeHighlight),l=this.isVertical(),c=l?a:n;let h=r?.[l?o:s]??"";return t.continuous&&(h=t.scaleInvert(c)),{[i]:{position:c,value:h}}}getActiveHighlightData(e){const{axisCtx:t}=this,{series:i,xKey:o="",aggregatedValue:s,cumulativeValue:a,midPoint:n}=e,r=Yn(e),l=i.getKeyProperties(t.direction),c=(t.scale.bandwidth??0)/2,h=i.axes[t.direction]?.id===t.axisId,d=l.includes("yKey")&&h,u=l.includes("xKey")&&h,g=s??a;if(d&&g!==void 0){const y=t.scale.convert(g)+c;return this.isInRange(y)?{yKey:{value:g,position:y}}:{}}if(u){const y=(this.isVertical()?n?.x:n?.y)??0,S=t.continuous?t.scaleInvert(y):r?.[o];return this.isInRange(y)?{xKey:{value:S,position:y}}:{}}const m={};for(const y of l){const S=i.properties[y],x=r?.[S],b=t.scale.convert(x)+c;this.isInRange(b)&&(m[y]={value:x,position:b})}return m}getLabelHtml(e,t){const i=this.axisLayout?.label?.fractionDigits??0,o={text:this.formatValue(e)};return this.label.renderer?t.toLabelHtml(this.label.renderer({value:e,fractionDigits:i}),o):t.toLabelHtml(o)}showLabel(e,t,i,o){if(!this.axisLayout)return;const{bounds:s}=this,a=this.labels[o],n=this.getLabelHtml(i,a);a.setLabelHtml(n);const{width:r,height:l}=a.getBBox(),c=this.axisCtx.position;let h=this.axisLayout.label.spacing+this.axisLayout.tickSize;this.axisCtx.direction===Qf.X?(h-=4,a.show({x:e-r/2,y:c==="bottom"?s.y+s.height+h:s.y-l-h})):(h-=8,a.show({x:c==="right"?s.x+s.width+h:s.x-r-h,y:t-l/2}))}hideCrosshairs(){this.crosshairGroup.visible=!1;for(const e of Object.keys(this.labels))this.hideLabel(e)}hideLabel(e){this.labels[e]?.toggle(!1)}};Ui.className="Crosshair",p([qo],Ui.prototype,"enabled",2),p([qo],Ui.prototype,"stroke",2),p([qo],Ui.prototype,"lineDash",2),p([qo],Ui.prototype,"lineDashOffset",2),p([qo],Ui.prototype,"strokeWidth",2),p([qo],Ui.prototype,"strokeOpacity",2),p([qo],Ui.prototype,"snap",2),p([qo],Ui.prototype,"label",2);var Hd={type:"axis:plugin",name:"crosshair",chartType:"cartesian",enterprise:!0,version:uC,themeTemplate:{enabled:{$if:[{$or:[{$eq:[{$path:"../type"},"number"]},{$eq:[{$path:"../type"},"log"]},{$eq:[{$path:"../type"},"time"]},{$eq:[{$path:"../type"},"unit-time"]},{$eq:[{$path:"../type"},"ordinal-time"]}]},!0,!1]},snap:!0,stroke:{$ref:"subtleTextColor"},strokeWidth:1,strokeOpacity:1,lineDash:[5,6],lineDashOffset:0,label:{enabled:!0}},create:e=>new Ui(e)};import{VERSION as MC}from"ag-charts-community";import{boolean as IC,callback as LC,positiveNumber as ox,undocumented as Wd}from"ag-charts-core";import"ag-charts-community";import{AbstractModuleInstance as NC,ActionOnSet as Un,Property as sx}from"ag-charts-core";var Oa=class extends NC{constructor(e){super(),this.enabled=!0,this.getData=()=>Promise.resolve(),this.dataService=e.dataService;let t=!1;this.cleanup.register(e.eventsHub.on("data:load",()=>{t=!0}),e.eventsHub.on("layout:complete",()=>{t&&e.zoomManager.updateZoom({source:"data-update",sourceDetail:"dataSource"})}))}updateCallback(e,t){this.dataService&&(e&&t!=null?this.dataService.updateCallback(t):this.dataService.clearCallback())}};p([Un({newValue(e){this.updateCallback(e,this.getData)}}),sx],Oa.prototype,"enabled",2),p([Un({newValue(e){this.updateCallback(this.enabled,e)}}),sx],Oa.prototype,"getData",2),p([Un({newValue(e){this.dataService.requestThrottle=e}})],Oa.prototype,"requestThrottle",2),p([Un({newValue(e){this.dataService.dispatchThrottle=e}})],Oa.prototype,"updateThrottle",2),p([Un({newValue(e){this.dataService.dispatchOnlyLatest=!e}})],Oa.prototype,"updateDuringInteraction",2);var _l={type:"plugin",name:"dataSource",enterprise:!0,version:MC,options:{getData:LC,requestThrottle:Wd(ox),updateThrottle:Wd(ox),updateDuringInteraction:Wd(IC)},create:e=>new Oa(e)};import{VERSION as CC}from"ag-charts-community";import{errorBarOptionsDefs as TC}from"ag-charts-core";import{_ModuleSupport as ax}from"ag-charts-community";import{AbstractModuleInstance as wC,ChartAxisDirection as jn,Logger as PC,isDefined as Vt,mergeDefaults as OC}from"ag-charts-core";import{_ModuleSupport as Xn}from"ag-charts-community";import{mergeDefaults as nx,nearestSquared as RC,nearestSquaredInContainer as EC,partialAssign as _C}from"ag-charts-core";var{BBox:Jo}=Xn,BC=class{constructor(e){this.components=e,this.union=Jo.merge(e)}containsPoint(e,t){if(!this.union.containsPoint(e,t))return!1;for(const i of this.components)if(i.containsPoint(e,t))return!0;return!1}},VC=class extends Xn.Group{constructor(){super(),this.capLength=Number.NaN,this._datum=void 0,this.whiskerPath=new Xn.Path,this.capsPath=new Xn.Path,this.bboxes=new BC([]),this.append([this.whiskerPath,this.capsPath])}get datum(){return this._datum}set datum(e){this._datum=e}calculateCapLength(e,t){const{lengthRatio:i=1,length:o}=e,{lengthRatioMultiplier:s,lengthMax:a}=t,n=o??i*s;return Math.min(n,a)}getItemStylerParams(e,t,i,o){const{datum:s}=this;if(s==null||e.itemStyler==null)return;const{xLowerKey:a,xUpperKey:n,yLowerKey:r,yUpperKey:l}=e;return{...t,datum:s.datum,seriesId:s.series.id,xKey:s.xKey,yKey:s.yKey,xLowerKey:a,xUpperKey:n,yLowerKey:r,yUpperKey:l,highlighted:i,highlightState:o}}formatStyles(e,t,i,o,s){let{cap:a,...n}=e;const r=this.getItemStylerParams(t,e,o,s);if(r!=null&&t.itemStyler!=null){const l=i.callWithContext(t.itemStyler,r);n=nx(l,n),a=nx(l?.cap,l,a)}return{whiskerStyle:n,capsStyle:a}}applyStyling(e,t){_C(["visible","stroke","strokeWidth","strokeOpacity","lineDash","lineDashOffset"],e,t)}update(e,t,i,o,s){if(this.datum===void 0)return;const{whiskerStyle:a,capsStyle:n}=this.formatStyles(e,t,i,o,s),{xBar:r,yBar:l,capDefaults:c}=this.datum,h=this.whiskerPath;this.applyStyling(h,a),h.path.clear(!0),l!==void 0&&(h.path.moveTo(l.lowerPoint.x,l.lowerPoint.y),h.path.lineTo(l.upperPoint.x,l.upperPoint.y)),r!==void 0&&(h.path.moveTo(r.lowerPoint.x,r.lowerPoint.y),h.path.lineTo(r.upperPoint.x,r.upperPoint.y)),h.path.closePath(),this.capLength=this.calculateCapLength(n??{},c);const d=this.capLength/2,u=this.capsPath;this.applyStyling(u,n),u.path.clear(!0),l!==void 0&&(u.path.moveTo(l.lowerPoint.x-d,l.lowerPoint.y),u.path.lineTo(l.lowerPoint.x+d,l.lowerPoint.y),u.path.moveTo(l.upperPoint.x-d,l.upperPoint.y),u.path.lineTo(l.upperPoint.x+d,l.upperPoint.y)),r!==void 0&&(u.path.moveTo(r.lowerPoint.x,r.lowerPoint.y-d),u.path.lineTo(r.lowerPoint.x,r.lowerPoint.y+d),u.path.moveTo(r.upperPoint.x,r.upperPoint.y-d),u.path.lineTo(r.upperPoint.x,r.upperPoint.y+d)),u.path.closePath()}updateBBoxes(){const{capLength:e,whiskerPath:t,capsPath:i}=this,{yBar:o,xBar:s}=this.datum??{},a=e/2,n=[];if(o!==void 0){const r=o.lowerPoint.y-o.upperPoint.y;n.push(new Jo(o.lowerPoint.x,o.upperPoint.y,t.strokeWidth,r),new Jo(o.lowerPoint.x-a,o.lowerPoint.y,e,i.strokeWidth),new Jo(o.upperPoint.x-a,o.upperPoint.y,e,i.strokeWidth))}if(s!==void 0){const r=s.upperPoint.x-s.lowerPoint.x;n.push(new Jo(s.lowerPoint.x,s.upperPoint.y,r,t.strokeWidth),new Jo(s.lowerPoint.x,s.lowerPoint.y-a,i.strokeWidth,e),new Jo(s.upperPoint.x,s.upperPoint.y-a,i.strokeWidth,e))}this.bboxes.components=n,this.bboxes.union=Jo.merge(n)}containsPoint(e,t){return this.bboxes.containsPoint(e,t)}pickNode(e,t){return this.containsPoint(e,t)?this:void 0}nearestSquared(e,t,i){const{bboxes:o}=this;if(o.union.distanceSquared(e,t)>i)return{nearest:void 0,distanceSquared:1/0};const{distanceSquared:s}=RC(e,t,o.components);return{nearest:this,distanceSquared:s}}},zC=class extends Xn.Group{nearestSquared(e,t){const{nearest:i,distanceSquared:o}=EC(e,t,{children:this.children()});if(i!==void 0&&!Number.isNaN(o))return{datum:i.datum,distanceSquared:o}}};import"ag-charts-community";import{BaseProperties as rx,Property as fe}from"ag-charts-core";var bo=class extends rx{};p([fe],bo.prototype,"visible",2),p([fe],bo.prototype,"stroke",2),p([fe],bo.prototype,"strokeWidth",2),p([fe],bo.prototype,"strokeOpacity",2),p([fe],bo.prototype,"lineDash",2),p([fe],bo.prototype,"lineDashOffset",2),p([fe],bo.prototype,"length",2),p([fe],bo.prototype,"lengthRatio",2);var lt=class extends rx{constructor(){super(...arguments),this.visible=!0,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.cap=new bo}};p([fe],lt.prototype,"yLowerKey",2),p([fe],lt.prototype,"yLowerName",2),p([fe],lt.prototype,"yUpperKey",2),p([fe],lt.prototype,"yUpperName",2),p([fe],lt.prototype,"xLowerKey",2),p([fe],lt.prototype,"xLowerName",2),p([fe],lt.prototype,"xUpperKey",2),p([fe],lt.prototype,"xUpperName",2),p([fe],lt.prototype,"visible",2),p([fe],lt.prototype,"stroke",2),p([fe],lt.prototype,"strokeWidth",2),p([fe],lt.prototype,"strokeOpacity",2),p([fe],lt.prototype,"lineDash",2),p([fe],lt.prototype,"lineDashOffset",2),p([fe],lt.prototype,"itemStyler",2),p([fe],lt.prototype,"cap",2);var{fixNumericExtent:FC,groupAccumulativeValueProperty:HC,valueProperty:Bl}=ax,WC=class Or extends wC{constructor(t){super(),this.properties=new lt;const i=t.series,{annotationGroup:o,annotationSelections:s}=i;this.cartesianSeries=i,this.groupNode=new zC({name:`${o.id}-errorBars`}),o.appendChild(this.groupNode),this.selection=ax.Selection.select(this.groupNode,()=>this.errorBarFactory()),s.add(this.selection),i.addEventListener("seriesVisibilityChange",a=>this.onToggleSeriesItem(a)),this.cleanup.register(i.events.on("data-processed",a=>this.onDataProcessed(a)),i.events.on("data-update",a=>this.onDataUpdate(a)),t.eventsHub.on("highlight:change",a=>this.onHighlightChange(a)),()=>this.groupNode.remove(),()=>s.delete(this.selection))}hasErrorBars(){const{xLowerKey:t,xUpperKey:i,yLowerKey:o,yUpperKey:s}=this.properties;return Vt(t)&&Vt(i)||Vt(o)&&Vt(s)}isStacked(){const t=this.cartesianSeries.seriesGrouping?.stackCount;return t==null?!1:t>0}getUnstackPropertyDefinition(t){const i=[],{xLowerKey:o,xUpperKey:s,yLowerKey:a,yUpperKey:n,xErrorsID:r,yErrorsID:l}=this.getMaybeFlippedKeys(),{xScaleType:c,yScaleType:h}=t;return a!=null&&n!=null&&i.push(Bl(a,h,{id:`${l}-lower`}),Bl(n,h,{id:`${l}-upper`})),o!=null&&s!=null&&i.push(Bl(o,c,{id:`${r}-lower`}),Bl(s,c,{id:`${r}-upper`})),i}getStackPropertyDefinition(t){const i=[],{cartesianSeries:o}=this,{xLowerKey:s,xUpperKey:a,yLowerKey:n,yUpperKey:r,xErrorsID:l,yErrorsID:c}=this.getMaybeFlippedKeys(),{xScaleType:h,yScaleType:d}=t,u=o.seriesGrouping?.groupIndex??o.id,g={invalidValue:null,missingValue:0,separateNegative:!0,...o.visible?{}:{forceValue:0}},m=(S,x,b,f)=>HC(S,"normal",{id:`${x}-${b}`,groupId:`errorGroup-${u}-${b}`,...g},f),y=(S,x,b,f)=>{i.push(...m(S,b,"lower",f),...m(x,b,"upper",f))};return n!=null&&r!=null&&y(n,r,c,d),s!=null&&a!=null&&y(s,a,l,h),i}getPropertyDefinitions(t){return this.isStacked()?this.getStackPropertyDefinition(t):this.getUnstackPropertyDefinition(t)}onDataProcessed(t){this.dataModel=t.dataModel,this.processedData=t.processedData}getDomain(t){const{xLowerKey:i,xUpperKey:o,xErrorsID:s,yLowerKey:a,yUpperKey:n,yErrorsID:r}=this.getMaybeFlippedKeys();if(t===jn.X?Vt(i)&&Vt(o):Vt(a)&&Vt(n)){const{dataModel:c,processedData:h,cartesianSeries:d}=this;if(c!=null&&h!=null){const u={x:s,y:r}[t],g=c.getDomain(d,`${u}-lower`,"value",h).domain,m=c.getDomain(d,`${u}-upper`,"value",h).domain,y=[Math.min(...g,...m),Math.max(...g,...m)];return FC(y)}}return[]}onDataUpdate(t){this.dataModel=t.dataModel,this.processedData=t.processedData,Vt(t.dataModel)&&Vt(t.processedData)&&(this.createNodeData(),this.update())}getNodeData(){return this.hasErrorBars()?this.cartesianSeries.contextNodeData?.nodeData:void 0}createNodeData(){const t=this.getNodeData(),i=this.cartesianSeries.axes[jn.X]?.scale,o=this.cartesianSeries.axes[jn.Y]?.scale;if(!(!i||!o||!t))for(let s=0;s<t.length;s++){const{midPoint:a,xLower:n,xUpper:r,yLower:l,yUpper:c}=this.getDatum(t,s);if(a!=null){let h,d;Vt(n)&&Vt(r)&&(h={lowerPoint:{x:this.convert(i,n),y:a.y},upperPoint:{x:this.convert(i,r),y:a.y}}),Vt(l)&&Vt(c)&&(d={lowerPoint:{x:a.x,y:this.convert(o,l)},upperPoint:{x:a.x,y:this.convert(o,c)}}),t[s].xBar=h,t[s].yBar=d}}}getMaybeFlippedKeys(){let{xLowerKey:t,xUpperKey:i,yLowerKey:o,yUpperKey:s}=this.properties,[a,n]=["xValue-errors","yValue-errors"];return this.cartesianSeries.shouldFlipXY()&&([t,o]=[o,t],[i,s]=[s,i],[a,n]=[n,a]),{xLowerKey:t,xUpperKey:i,xErrorsID:a,yLowerKey:o,yUpperKey:s,yErrorsID:n}}static getDatumKey(t,i,o){if(i==null)return;const a=Yn(t)?.[i];if(a!=null){if(typeof a!="number"){PC.warnOnce(`Found [${i}] error value of type ${typeof a}. Expected number type`);return}return a+o}}getDatum(t,i){const{xLowerKey:o,xUpperKey:s,yLowerKey:a,yUpperKey:n}=this.getMaybeFlippedKeys(),r=t[i],l=r.cumulativeValue==null||!this.isStacked()?0:r.cumulativeValue-r.yValue,[c,h]=this.cartesianSeries.shouldFlipXY()?[l,0]:[0,l];return{midPoint:r.midPoint,xLower:Or.getDatumKey(r,o,c),xUpper:Or.getDatumKey(r,s,c),yLower:Or.getDatumKey(r,a,h),yUpper:Or.getDatumKey(r,n,h)}}convert(t,i){const o=(t.bandwidth??0)/2;return t.convert(i)+o}update(){const t=this.getNodeData();t!=null&&(this.selection.update(t),this.selection.each((i,o,s)=>this.updateNode(i,o,s)))}updateNode(t,i,o){t.datum=i,t.update(this.getDefaultStyle(),this.properties,this.cartesianSeries,!1,"none"),t.updateBBoxes()}pickNodeExact(t){const{x:i,y:o}=t,s=this.groupNode.pickNode(i,o);if(s!=null)return{datum:s.datum,distanceSquared:0}}pickNodeNearest(t){return this.groupNode.nearestSquared(t.x,t.y)}pickNodeMainAxisFirst(t,i){let o,s=[1/0,1/0];const a=[t.x,t.y];i===jn.Y&&a.reverse();for(const n of this.groupNode.children()){const r=n.getBBox(),l=[r.x+r.width/2,r.y+r.height/2];i===jn.Y&&l.reverse();const c=[];for(let h=0;h<a.length;h++)c.push(Math.abs(a[h]-l[h]));(c[0]<s[0]||c[0]==s[0]&&c[1]<s[1])&&(o=n.datum,s=c)}if(o)return{datum:o,distanceSquared:Math.pow(s[0],2)+Math.pow(s[1],2)}}getTooltipParams(){const{xLowerKey:t,xUpperKey:i,yLowerKey:o,yUpperKey:s,xLowerName:a=t,xUpperName:n=i,yLowerName:r=o,yUpperName:l=s}=this.properties;return{xLowerKey:t,xLowerName:a,xUpperKey:i,xUpperName:n,yLowerKey:o,yLowerName:r,yUpperKey:s,yUpperName:l}}onToggleSeriesItem(t){this.groupNode.visible=t.visible}makeStyle(t){return{visible:t.visible,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeOpacity:t.strokeOpacity,cap:OC(this.properties.cap,t)}}getDefaultStyle(){return this.makeStyle(this.getWhiskerProperties())}getHighlightStyle(){return this.makeStyle(this.getWhiskerProperties())}restyleHighlightChange(t,i,o){const s=this.getNodeData();if(s!=null){for(let a=0;a<s.length;a++)if(t===s[a]){this.selection.at(a)?.update(i,this.properties,this.cartesianSeries,o,o?"highlighted-item":"unhighlighted-item");break}}}onHighlightChange(t){const{previousHighlight:i,currentHighlight:o}=t;o?.series===this.cartesianSeries&&this.restyleHighlightChange(o,this.getHighlightStyle(),!0),i?.series===this.cartesianSeries&&this.restyleHighlightChange(i,this.getDefaultStyle(),!1),this.groupNode.opacity=this.cartesianSeries.getOpacity()}errorBarFactory(){return new VC}getWhiskerProperties(){const{stroke:t,strokeWidth:i,visible:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}=this.properties;return{stroke:t,strokeWidth:i,visible:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}}},Kd={type:"series:plugin",name:"errorBar",chartType:"cartesian",seriesTypes:["bar","line","scatter"],enterprise:!0,version:CC,options:TC,themeTemplate:{visible:!0,stroke:{$ref:"foregroundColor"},strokeWidth:1,strokeOpacity:1,cap:{lengthRatio:{$if:[{$eq:[{$path:"../../type"},"bar"]},.3,1]}}},create:e=>new WC(e)};import{VERSION as KC}from"ag-charts-community";import{boolean as GC,color as $C,positiveNumber as lx,ratio as YC,strictUnion as UC}from"ag-charts-core";import{_ModuleSupport as jC}from"ag-charts-community";import{BaseProperties as XC,ChartAxisDirection as Gd,CleanupRegistry as ZC,Property as Ra,createElement as qC,setAttribute as QC,setElementBBox as JC,setElementStyle as eT}from"ag-charts-core";function tT(e){for(const t of[Gd.X,Gd.Y])for(const i of e.axisManager.getAxisContext(t))if(jC.BandScale.is(i.scale))return i}var es=class extends XC{constructor(e){super(),this.ctx=e,this.enabled=!1,this.item="chart",this.color="#cfeeff",this.opacity=1,this.flashDuration=100,this.fadeDuration=900,this.cleanup=new ZC,this.element=this.ctx.domManager.addChild("canvas-background","flashOnUpdate"),this.element.role="presentation";let t=!0;const i=o=>{t?t=!1:this.onDataUpdate(o)};this.cleanup.register(this.ctx.eventsHub.on("data:update",i),this.ctx.eventsHub.on("datamodel:diff",o=>this.onDataModelDiff(o)))}destroy(){this.ctx.domManager.removeChild("canvas-background","flashOnUpdate"),this.cleanup.flush()}clearFlash(){this.element.innerHTML="",clearTimeout(this.animationTimeout),this.animationTimeout=void 0}flashElem(e){const{flashDuration:t,fadeDuration:i}=this,o=t+i;e.animate([{background:this.color,offset:0},{background:this.color,offset:t/o},{background:"transparent",offset:1}],{duration:o,easing:"ease-out"})}flashCategoryBands(e){const t=tT(this.ctx);if(!t)return;this.clearFlash();const i=this.computeCategoryFlashBounds(t,e);for(const s of i){const a=qC("div");QC(a,"role","presentation"),eT(a,"position","absolute"),JC(a,s),this.element.appendChild(a),this.flashElem(a)}const o=this.flashDuration+this.fadeDuration;this.animationTimeout=setTimeout(()=>this.clearFlash(),o)}computeCategories(e){const t=new Set;for(const i of Object.keys(e))for(const o of["updated","added","moved"])for(const s of e[i][o])t.add(s);return t}computeCategoryFlashBounds(e,t){const i=this.ctx.widgets.seriesWidget.getBounds(),o=e.direction===Gd.X?([n,r])=>({x:i.x+n,y:i.y,width:r-n,height:i.height}):([n,r])=>({x:i.x,y:i.y+n,width:i.width,height:r-n}),s=[],a=this.computeCategories(t);for(const n of a){const r=e.measureBand(n);r?.band&&s.push(o(r.band))}return s}onDataUpdate(e){!this.enabled||this.item!=="chart"||!e||this.flashElem(this.ctx.widgets.containerWidget.getElement())}onDataModelDiff(e){!this.enabled||this.item!=="category"||this.flashCategoryBands(e.diff)}};es.className="FlashOnUpdate",p([Ra],es.prototype,"enabled",2),p([Ra],es.prototype,"item",2),p([Ra],es.prototype,"color",2),p([Ra],es.prototype,"opacity",2),p([Ra],es.prototype,"flashDuration",2),p([Ra],es.prototype,"fadeDuration",2);var cx={type:"plugin",name:"flashOnUpdate",enterprise:!0,version:KC,options:{enabled:GC,item:UC()("chart","category"),color:$C,opacity:YC,flashDuration:lx,fadeDuration:lx},themeTemplate:{enabled:!1,item:"chart",color:"#cfeeff",opacity:1,flashDuration:100,fadeDuration:900},create:e=>new es(e)};import{VERSION as iT}from"ag-charts-community";import{_ModuleSupport as hx}from"ag-charts-community";import{AbstractModuleInstance as oT,Logger as sT,ObserveChanges as $d,Property as Vl,clamp as Yd}from"ag-charts-core";import{_ModuleSupport as zl}from"ag-charts-community";import{AbstractModuleInstance as aT,ActionOnSet as dx,Logger as nT,Padding as rT,Property as Ud,ProxyProperty as px,ZIndexMap as Bs,calcLineHeight as lT}from"ag-charts-core";import{_ModuleSupport as cT}from"ag-charts-community";import{SceneChangeDetection as ux}from"ag-charts-core";var{TranslatableGroup:hT}=cT,jd=class extends hT{constructor(){super(...arguments),this.inset=0,this.cornerRadius=0}applyClip(e,t){const{cornerRadius:i,inset:o}=this,{x:s,y:a,width:n,height:r}=t,l=new Path2D;l.roundRect(s+o,a+o,n-2*o,r-2*o,i),e.clip(l)}};p([ux()],jd.prototype,"inset",2),p([ux()],jd.prototype,"cornerRadius",2);var{CategoryAxis:dT,Group:Vs,BBox:gx,stackCartesianSeries:pT}=zl,Xd=class{constructor(){this.top=0,this.bottom=0}};p([Ud],Xd.prototype,"top",2),p([Ud],Xd.prototype,"bottom",2);var Ea=class extends aT{constructor(e){super(),this.ctx=e,this.enabled=!1,this.padding=new Xd,this.root=new Vs({name:"root"}),this.seriesRoot=this.root.appendChild(new jd({name:"Series-root",zIndex:Bs.SERIES_LAYER,renderToOffscreenCanvas:!0})),this.axisGridGroup=this.root.appendChild(new Vs({name:"Axes-Grids",zIndex:Bs.AXIS_GRID})),this.axisGroup=this.root.appendChild(new Vs({name:"Axes-Grids",zIndex:Bs.AXIS_GRID})),this.axisLabelGroup=this.root.appendChild(new Vs({name:"Axes-Labels",zIndex:Bs.SERIES_LABEL})),this.axisCrosslineRangeGroup=this.root.appendChild(new Vs({name:"Axes-Crosslines-Range",zIndex:Bs.SERIES_CROSSLINE_RANGE})),this.axisCrosslineLineGroup=this.root.appendChild(new Vs({name:"Axes-Crosslines-Line",zIndex:Bs.SERIES_CROSSLINE_LINE})),this.axisCrosslineLabelGroup=this.root.appendChild(new Vs({name:"Axes-Crosslines-Label",zIndex:Bs.SERIES_LABEL})),this.data=[],this._destroyed=!1,this.miniChartAnimationPhase="initial",this.seriesRect=void 0,this.axes=new zl.ChartAxes,this.series=[],this.cleanup.register(this.ctx.eventsHub.on("data:update",t=>this.updateData(t)))}destroy(){this._destroyed||(super.destroy(),this.destroySeries(this.series),this.axes.destroy(),this._destroyed=!0)}onSeriesChange(e,t){const i=t?.filter(o=>!e.includes(o))??[];this.destroySeries(i);for(const o of e)t?.includes(o)||(o.attachSeries(this.seriesRoot,this.seriesRoot,void 0),o.chart={},Object.defineProperty(o.chart,"mode",{get:()=>"standalone"}),Object.defineProperty(o.chart,"isMiniChart",{get:()=>!0}),Object.defineProperty(o.chart,"flashOnUpdateEnabled",{get:()=>!1}),Object.defineProperty(o.chart,"seriesRect",{get:()=>this.seriesRect}),o.resetAnimation(this.miniChartAnimationPhase==="initial"?"initial":"disabled"));this.seriesRect=void 0}destroySeries(e){if(e)for(const t of e)t.destroy(),t.detachSeries(this.seriesRoot,this.seriesRoot,void 0),t.chart=void 0}assignSeriesToAxes(){for(const e of this.axes)e.boundSeries=this.series.filter(t=>t.axes[e.direction]===e)}assignAxesToSeries(){const e={};for(const t of this.axes){const i=t.direction;(e[i]??(e[i]=[])).push(t)}for(const t of this.series)for(const i of t.directions){const o=t.getKeyAxis(i)??i,s=this.axes.findById(o);if(!s){nT.warnOnce(`no matching axis for direction [${i}] and id [${o}]; check series and axes configuration.`);return}t.axes[i]=s}}updateData(e){for(const t of this.series)t.setChartData(e);this.miniChartAnimationPhase==="initial"&&this.ctx.animationManager.onBatchStop(()=>{this.miniChartAnimationPhase="ready";for(const t of this.series)t.resetAnimation("disabled")})}async processData(e){this.series.some(t=>t.canHaveAxes)&&(this.assignAxesToSeries(),this.assignSeriesToAxes()),await Promise.all(this.series.map(async t=>(t.resetDatumCallbackCache(),t.processData(e))));for(const t of this.axes)t.processData()}computeAxisPadding(){const e=new rT;if(!this.enabled)return e;for(const{position:t,thickness:i,line:o,label:s}of this.axes){if(t==null)continue;let a;i?a=i:a=(o.enabled?o.width:0)+(s.enabled?lT(s.fontSize??0)+s.spacing:0),e[t]=Math.ceil(a)}return e}async layout(e,t){var i;const{padding:o}=this,s=this.seriesRect!=null,a=new gx(0,0,e,t-(o.top+o.bottom)),n=this.seriesRect==null||this.seriesRect.width!==e||this.seriesRect.height!==t;this.seriesRect=a,this.seriesRoot.translationY=o.top,this.seriesRoot.setClipRectCanvasSpace(new gx(0,-o.top,e,t));for(const r of this.axes){const{position:l="left"}=r;switch(l){case"top":case"bottom":r.range=[0,a.width],r.gridLength=a.height;break;case"right":case"left":{const c=r instanceof dT;r.range=c?[0,a.height]:[a.height,0],r.gridLength=a.width;break}}if(r.gridPadding=0,r.translation.x=0,r.translation.y=0,l==="right"?r.translation.x=e:l==="bottom"&&(r.translation.y=t),s||r.resetAnimation("initial"),r.crossLines)for(const c of r.crossLines)c instanceof zl.CartesianCrossLine&&(c.position=r.position??"top",(i=c.label).parallel??(i.parallel=r.label?.parallel));r.calculateLayout(),r.update()}n&&pT(this.series),await Promise.all(this.series.map(async r=>r.update({seriesRect:a})))}};p([Ud],Ea.prototype,"enabled",2),p([px(["seriesRoot","inset"])],Ea.prototype,"inset",2),p([px(["seriesRoot","cornerRadius"])],Ea.prototype,"cornerRadius",2),p([dx({changeValue(e,t=new zl.ChartAxes){const i={axisNode:this.axisGroup,gridNode:this.axisGridGroup,labelNode:this.axisLabelGroup,crossLineLineNode:this.axisCrosslineLineGroup,crossLineRangeNode:this.axisCrosslineRangeGroup,crossLineLabelNode:this.axisCrosslineLabelGroup};for(const o of t)e.includes(o)||(o.detachAxis(),o.destroy());for(const o of e)t?.includes(o)||o.attachAxis(i)}})],Ea.prototype,"axes",2),p([dx({changeValue(e,t){this.onSeriesChange(e,t)}})],Ea.prototype,"series",2);import{_ModuleSupport as uT}from"ag-charts-community";import{clamp as gT}from"ag-charts-core";var{SliderWidget:mx}=uT,mT=class{constructor(e,t){this.ctx=e,this.sliderHandlers=t,this._min=0,this._max=1,this.minRange=.001,this.dragStartX=0,this.ctx=e,this.toolbar=e.proxyInteractionService.createProxyContainer({type:"toolbar",domManagerId:"navigator-toolbar",classList:["ag-charts-proxy-navigator-toolbar"],orientation:"vertical",ariaLabel:{id:"ariaLabelNavigator"}}),this.sliders=[e.proxyInteractionService.createProxyElement({type:"slider",domIndex:1,ariaLabel:{id:"ariaLabelNavigatorMinimum"},parent:this.toolbar,cursor:"ew-resize"}),e.proxyInteractionService.createProxyElement({type:"slider",domIndex:-1/0,ariaLabel:{id:"ariaLabelNavigatorRange"},parent:this.toolbar,cursor:"grab"}),e.proxyInteractionService.createProxyElement({type:"slider",domIndex:2,ariaLabel:{id:"ariaLabelNavigatorMaximum"},parent:this.toolbar,cursor:"ew-resize"})];for(const[i,o]of["min","pan","max"].entries()){const s=this.sliders[i];s.step=mx.STEP_HUNDRETH,s.keyboardStep=mx.STEP_ONE,s.orientation="horizontal",s.setPreventsDefault(!1),s.addListener("drag-start",a=>this.onDragStart(i,a,o)),s.addListener("drag-move",a=>this.onDrag(s,a,o)),s.addListener("drag-end",()=>this.updateSliderRatios()),s.addListener("contextmenu",a=>this.onContextMenu(s,a))}this.sliders[0].addListener("change",()=>this.onMinSliderChange()),this.sliders[1].addListener("change",()=>this.onPanSliderChange()),this.sliders[2].addListener("change",()=>this.onMaxSliderChange()),this.updateSliderRatios(),this.updateVisibility(!1)}destroy(){this.toolbar.destroy()}updateVisibility(e){this.toolbar.setHidden(!e)}updateZoom(){const{_min:e,_max:t}=this;e==null||t==null||this.ctx.zoomManager.updateZoom({source:"user-interaction",sourceDetail:"navigatorDOM"},{x:{min:e,max:t}})}updateBounds(e){this.toolbar.setBounds(e)}updateSliderBounds(e,t){this.sliders[e].setBounds(t)}updateMinMax(e,t){this._min=e,this._max=t,this.updateSliderRatios()}updateSliderRatios(){let{_min:e,_max:t}=this;e=Math.round(e*100)/100,t=Math.round(t*100)/100;const i=this.ctx.localeManager.t("ariaValuePanRange",{min:e,max:t});this.sliders[0].setValueRatio(e),this.sliders[1].setValueRatio(e,{ariaValueText:i}),this.sliders[2].setValueRatio(t)}toCanvasOffsets(e){return{offsetX:this.dragStartX+e.originDeltaX}}moveToFront(e){if(e===1)return;const t=this.sliders[e],i=this.sliders[2-e];this.toolbar.moveChild(i,t.domIndex-1)}onDragStart(e,t,i){const o=this.sliders[e],s=this.toolbar.cssLeft(),a=o.cssLeft();this.dragStartX=s+a+t.offsetX,this.moveToFront(e),t.sourceEvent.preventDefault(),this.sliderHandlers.onDragStart(i,this.toCanvasOffsets(t))}onDrag(e,t,i){t.sourceEvent.preventDefault(),this.sliderHandlers.onDrag(i,this.toCanvasOffsets(t))}onContextMenu(e,t){const{offsetX:i,offsetY:o}=t,{x:s,y:a}=this.toolbar.getBounds(),{x:n,y:r}=e.getBounds(),l=i+s+n,c=o+a+r;this.ctx.contextMenuRegistry.dispatchContext("always",{widgetEvent:t,canvasX:l,canvasY:c},void 0)}onPanSliderChange(){const e=this.sliders[1].getValueRatio(),t=this._max-this._min;this._min=gT(0,e,1-t),this._max=this._min+t,this.updateZoom()}onMinSliderChange(){this._min=this.sliders[0].clampValueRatio(0,this._max-this.minRange),this.updateZoom()}onMaxSliderChange(){this._max=this.sliders[2].clampValueRatio(this._min+this.minRange,1),this.updateZoom()}};import{_ModuleSupport as yx}from"ag-charts-community";import{Property as Fl,SceneChangeDetection as Hl}from"ag-charts-core";var{BBox:yT,ExtendedPath2D:fT}=yx,ts=class extends yx.Path{constructor(){super(...arguments),this.zIndex=3,this.centerX=0,this.centerY=0,this.width=8,this.height=16,this.cornerRadius=4,this.grip=!0,this.gripPath=new fT}setCenter(e,t){this.dirtyPath=!0,(this.centerX!==e||this.centerY!==t)&&(this.centerX=e,this.centerY=t,this.markDirty("center"))}static align(e,t,i,o,s,a,n,r,l){const c=e.align(i+s*n)+l,h=c+e.align(i+s*n,s*(r-n))-2*l,d=e.align(o+a/2);e.setCenter(c,d),t.setCenter(h,d)}computeBBox(){const{centerX:e,centerY:t,width:i,height:o}=this,s=e-i/2,a=t-o/2;return new yT(s,a,i,o)}isPointInPath(e,t){return this.getBBox().containsPoint(e,t)}updatePath(){const{centerX:e,centerY:t,path:i,gripPath:o,strokeWidth:s,cornerRadius:a,grip:n}=this,r=s/2,l=this.layerManager?.canvas?.pixelRatio??1;i.clear(),o.clear();const c=Math.floor(this.width/2*l)/l,h=Math.floor(this.height/2*l)/l;i.roundRect(e-c+r,t-h+r,2*(c-r),2*(h-r),a);const d=3;if(n)for(let u=-.5;u<=.5;u+=1)for(let g=-1;g<=1;g+=1)o.arc(e+u*d,t+g*d,1,0,2*Math.PI),o.closePath()}renderFill(e,t){const{stroke:i}=this;super.renderFill(e,t),e.fillStyle=typeof i=="string"?i:"black",e.fill(this.gripPath.getPath2D())}};ts.className="RangeHandle",p([Fl,Hl()],ts.prototype,"width",2),p([Fl,Hl()],ts.prototype,"height",2),p([Fl,Hl()],ts.prototype,"cornerRadius",2),p([Fl,Hl()],ts.prototype,"grip",2);import{_ModuleSupport as xT}from"ag-charts-community";import{Property as ST,SceneChangeDetection as bT}from"ag-charts-core";var{Path:vT,BBox:Zd,ExtendedPath2D:kT,clippedRoundRect:DT}=xT,qd=class extends vT{constructor(){super(...arguments),this.cornerRadius=4,this.zIndex=2,this.x=0,this.y=0,this.width=200,this.height=30,this.min=0,this.max=1,this.visiblePath=new kT}layout(e,t,i,o,s,a){s=Number.isNaN(s)?this.min:s,a=Number.isNaN(a)?this.max:a,(e!==this.x||t!==this.y||i!==this.width||this.height!==o||s!==this.min||a!==this.max)&&(this.x=e,this.y=t,this.width=i,this.height=o,this.min=s,this.max=a,this.dirtyPath=!0,this.markDirty("RangeMask.layout"))}computeBBox(){const{x:e,y:t,width:i,height:o}=this;return new Zd(e,t,i,o)}computeVisibleRangeBBox(){const{x:e,y:t,width:i,height:o,min:s,max:a}=this,n=e+i*s,r=e+i*a;return new Zd(n,t,r-n,o)}updatePath(){const{path:e,visiblePath:t,x:i,y:o,width:s,height:a,min:n,max:r,strokeWidth:l,cornerRadius:c}=this,h=l/2;e.clear(),t.clear();const d=this.align(i)+h,u=this.align(o)+h,g=this.align(i,s)-2*h,m=this.align(o,a)-2*h,y=this.align(i+s*n)+h,S=y+this.align(i+s*n,s*(r-n))-2*h,x={topLeft:c,topRight:c,bottomRight:c,bottomLeft:c},b=(f,v,k)=>{if(k-v<1)return;const A=new Zd(v,u,k-v,m);DT(f,d,u,g,m,x,A)};b(e,d,y),b(e,S,g+d),b(t,y,S)}renderStroke(e,t){super.renderStroke(e,t),super.renderStroke(e,this.visiblePath.getPath2D())}};qd.className="RangeMask",p([ST,bT()],qd.prototype,"cornerRadius",2);import{_ModuleSupport as Qd}from"ag-charts-community";import{ZIndexMap as AT}from"ag-charts-core";var MT=class extends Qd.Group{constructor(e){super({name:"rangeSelectorGroup",zIndex:AT.NAVIGATOR}),this.x=0,this.y=0,this.width=200,this.height=30,this.lOffset=0,this.rOffset=0,this.background=this.appendChild(new Qd.TranslatableGroup({name:"navigator-background",zIndex:1})),this.append(e)}layout(e,t,i,o,s,a){this.x=e,this.y=t,this.width=i,this.height=o,this.lOffset=s,this.rOffset=a,this.background.translationX=e,this.background.translationY=t,this.markDirty("RangeSelector")}updateBackground(e,t){e?.remove(),t!=null&&this.background.appendChild(t),this.markDirty("RangeSelector")}computeBBox(){const{x:e,y:t,width:i,height:o,lOffset:s,rOffset:a}=this;return new Qd.BBox(e-s,t,i+(s+a),o)}},_a=class extends oT{constructor(e){super(),this.ctx=e,this.enabled=!1,this.mask=new qd,this.minHandle=new ts,this.maxHandle=new ts,this.maskVisibleRange={id:"navigator-mask-visible-range",getBBox:()=>this.mask.computeVisibleRangeBBox(),toCanvasBBox:()=>this.mask.computeVisibleRangeBBox(),fromCanvasPoint:(t,i)=>({x:t,y:i})},this.height=30,this.cornerRadius=0,this.spacing=10,this.x=0,this.y=0,this.width=0,this.rangeSelector=new MT([this.mask,this.minHandle,this.maxHandle]),this.cleanup.register(e.scene.attachNode(this.rangeSelector),e.eventsHub.on("locale:change",()=>this.updateZoom()),e.layoutManager.registerElement(hx.LayoutElement.Navigator,t=>this.onLayoutStart(t)),e.eventsHub.on("layout:complete",t=>this.onLayoutComplete(t)),e.eventsHub.on("zoom:change-complete",t=>this.onZoomChange(t))),this.domProxy=new mT(e,this),this.updateGroupVisibility(),this.miniChart=new Ea(e)}updateBackground(e,t){this.rangeSelector?.updateBackground(e,t)}updateGroupVisibility(){const{enabled:e}=this;this.rangeSelector==null||e===this.rangeSelector.visible||(this.rangeSelector.visible=e,this.domProxy.updateVisibility(e),e?this.updateZoom():this.ctx.zoomManager.updateZoom({source:"chart-update",sourceDetail:"navigator"},{x:{min:0,max:1}}))}onLayoutStart({layoutBox:e}){if(this.enabled){const t=this.height+this.spacing;e.shrink(t,"bottom"),this.y=e.y+e.height+this.spacing}else this.y=0;if(this.enabled&&this.miniChart){const{top:t,bottom:i}=this.miniChart.computeAxisPadding();e.shrink(t+i,"bottom"),this.y-=i,this.miniChart.inset=this.mask.strokeWidth/2,this.miniChart.cornerRadius=this.mask.cornerRadius}}onLayoutComplete(e){const{x:t,width:i}=e.series.rect,{y:o,height:s}=this;if(this.domProxy.updateVisibility(this.enabled),this.enabled){const{_min:a,_max:n}=this.domProxy;this.layoutNodes(t,o,i,s,a,n),this.domProxy.updateBounds({x:t,y:o,width:i,height:s})}this.x=t,this.width=i,this.miniChart?.layout(i,s).catch(a=>sT.error(a))}canDrag(){return this.enabled&&this.ctx.interactionManager.isState(hx.InteractionState.ZoomDraggable)}onDragStart(e,{offsetX:t}){this.canDrag()&&(e==="pan"&&(this.panStart=(t-this.x)/this.width-this.domProxy._min),this.ctx.zoomManager.fireZoomPanStartEvent("navigator"))}onDrag(e,{offsetX:t}){if(!this.canDrag())return;const{panStart:i,x:o,width:s}=this,{minRange:a}=this.domProxy;let{_min:n,_max:r}=this.domProxy;const l=(t-o)/s;if(e==="min")n=Yd(0,l,r-a);else if(e==="max")r=Yd(n+a,l,1);else if(e==="pan"&&i!=null){const c=r-n;n=Yd(0,l-i,1-c),r=n+c}this.domProxy._min=n,this.domProxy._max=r,this.updateZoom()}onZoomChange(e){const{x:t}=e;if(!t)return;const{x:i,y:o,width:s,height:a}=this,{min:n,max:r}=t;this.domProxy.updateMinMax(n,r),this.layoutNodes(i,o,s,a,n,r)}layoutNodes(e,t,i,o,s,a){const{rangeSelector:n,mask:r,minHandle:l,maxHandle:c}=this;r.layout(e,t,i,o,s,a),n.layout(e,t,i,o,l.width/2,c.width/2),ts.align(l,c,e,t,i,o,s,a,r.strokeWidth/2),s+(a-s)/2<.5?(l.zIndex=3,c.zIndex=4):(l.zIndex=4,c.zIndex=3);for(const[h,d]of[l,this.maskVisibleRange,c].entries()){const u=d.getBBox(),g={x:u.x-e,y:u.y-t,height:u.height,width:u.width};this.domProxy.updateSliderBounds(h,g)}}updateZoom(){this.enabled&&this.domProxy.updateZoom()}async processData(e){return this.miniChart?.processData(e)}};p([$d((e,t,i)=>{e.updateBackground(i?.root,t?.root)})],_a.prototype,"miniChart",2),p([Vl,$d((e,t)=>{e.ctx.zoomManager.setNavigatorEnabled(!!t),e.updateGroupVisibility()})],_a.prototype,"enabled",2),p([Vl],_a.prototype,"height",2),p([Vl,$d((e,t)=>{e.mask.cornerRadius=t})],_a.prototype,"cornerRadius",2),p([Vl],_a.prototype,"spacing",2);import{AreaSeriesModule as IT,BarSeriesModule as LT,BubbleSeriesModule as NT,HistogramSeriesModule as CT,LineSeriesModule as TT,ScatterSeriesModule as wT}from"ag-charts-community";import{array as PT,arrayOfDefs as OT,boolean as Zn,callbackOf as RT,color as Wl,fontOptionsDef as ET,number as fx,numberFormatValidator as _T,positiveNumber as yi,ratio as BT,textOrSegments as VT,typeUnion as zT,without as jt}from"ag-charts-core";import{CartesianChartModule as FT,VERSION as HT,_ModuleSupport as WT}from"ag-charts-community";import{ChartAxisDirection as Kl}from"ag-charts-core";import{_ModuleSupport as is}from"ag-charts-community";import{ChartAxisDirection as KT,deepClone as GT,mergeDefaults as Jd}from"ag-charts-core";function $T(e){return{from:e?{scalingX:1,scalingY:0}:{scalingX:0,scalingY:1},to:{scalingX:1,scalingY:1}}}function YT(e){return(t,i)=>e?{scalingCenterY:i.scaledValues.medianValue}:{scalingCenterX:i.scaledValues.medianValue}}import{_ModuleSupport as UT}from"ag-charts-community";import{SceneArrayChangeDetection as jT,SceneChangeDetection as ct}from"ag-charts-core";var{Path:XT,Scalable:ZT,ExtendedPath2D:qT,BBox:zs,clippedRoundRect:xx}=UT,je=class extends ZT(XT){constructor(){super(...arguments),this.wickPath=new qT,this.horizontal=!1,this.center=0,this.thickness=0,this.min=0,this.q1=0,this.median=0,this.q3=0,this.max=0,this.cornerRadius=0,this.crisp=!1,this.strokeAlignment=0,this.wickStroke=void 0,this.wickStrokeWidth=void 0,this.wickStrokeOpacity=void 0,this.capLengthRatio=1,this.wickStrokeAlignment=0}computeBBox(){const{horizontal:e,center:t,thickness:i,min:o,max:s}=this;return e?new zs(Math.min(o,s),t-i/2,Math.abs(s-o),i):new zs(t-i/2,Math.min(o,s),i,Math.abs(s-o))}computeDefaultGradientFillBBox(){const{horizontal:e,center:t,thickness:i,q1:o,q3:s}=this;return e?new zs(Math.min(o,s),t-i/2,Math.abs(s-o),i):new zs(t-i/2,Math.min(o,s),i,Math.abs(s-o))}isPointInPath(e,t){return this.getBBox().containsPoint(e,t)}distanceSquared(e,t){return this.getBBox().distanceSquared(e,t)}get midPoint(){return this.horizontal?{x:(this.min+this.max)/2,y:this.center}:{x:this.center,y:(this.min+this.max)/2}}alignedCoordinates(){const{thickness:e,crisp:t}=this;let{center:i,min:o,q1:s,median:a,q3:n,max:r}=this,l=i-e/2,c=i+e/2;if(t&&e>1){o=this.align(o),s=this.align(s),a=this.align(a),n=this.align(n),r=o+this.align(o,r-o);const h=this.align(e/2);i=this.align(i),l=i-h,c=i+h}return{center:i,x0:l,x1:c,min:o,max:r,q1:s,median:a,q3:n}}updatePath(){const{path:e,stroke:t,strokeWidth:i,strokeOpacity:o,lineDash:s,lineDashOffset:a,wickStroke:n,wickStrokeWidth:r,wickStrokeOpacity:l,wickLineDash:c,wickLineDashOffset:h,strokeAlignment:d,cornerRadius:u,capLengthRatio:g,horizontal:m}=this,{center:y,x0:S,x1:x,min:b,max:f,q1:v,median:k,q3:A}=this.alignedCoordinates(),M=this.layerManager?.canvas.pixelRatio??1,I=this.wickStrokeAlignment>0?M/this.wickStrokeAlignment/2%1:0;this.path.clear(),this.wickPath.clear();const L=n!=null&&n!==t||r!=null&&r!==i||l!=null&&l!==o||c!=null&&c!==s||h!=null&&h!==a?this.wickPath:e;if(Math.abs(x-S)<=3){Ba(L,m,y,b),Va(L,m,y,f);return}const N=Math.min(b,f),T=Math.max(b,f),O=Math.min(v,A),R=Math.max(v,A),w=y-Math.abs((x-S)*g)/2,E=y+Math.abs((x-S)*g)/2;Ba(L,m,w,N-I),Va(L,m,E,N-I),Ba(L,m,y-I,N-I),Va(L,m,y-I,O+i/2),Ba(L,m,y-I,T+I),Va(L,m,y-I,R-i/2),Ba(L,m,w,T+I),Va(L,m,E,T+I);const B=i/2+d,P=i/2-d,C=R-O-2*P;if(C>0){const _=S+B,V=O+P,z=x-S-2*B,F={topLeft:u,topRight:u,bottomRight:u,bottomLeft:u};Sx(e,m,_,V,z,C,F,new zs(_,V,z,k-V)),Sx(e,m,_,V,z,C,F,new zs(_,k,z,V+C-k))}else{const _=(O+R)/2;Ba(e,m,S,_),Va(e,m,x,_)}}drawPath(e){super.drawPath(e);const{wickPath:t}=this;if(t.isEmpty())return;const{stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,wickStroke:r=i,wickStrokeWidth:l=o,wickStrokeOpacity:c=s,wickLineDash:h=a,wickLineDashOffset:d=n}=this;l!==0&&(e.globalAlpha*=c,typeof r=="string"&&(e.strokeStyle=r),e.lineWidth=l,h!=null&&e.setLineDash([...h]),e.lineDashOffset=d,e.stroke(t.getPath2D()))}};p([ct()],je.prototype,"horizontal",2),p([ct()],je.prototype,"center",2),p([ct()],je.prototype,"thickness",2),p([ct()],je.prototype,"min",2),p([ct()],je.prototype,"q1",2),p([ct()],je.prototype,"median",2),p([ct()],je.prototype,"q3",2),p([ct()],je.prototype,"max",2),p([ct()],je.prototype,"cornerRadius",2),p([ct()],je.prototype,"crisp",2),p([ct()],je.prototype,"strokeAlignment",2),p([ct()],je.prototype,"wickStroke",2),p([ct()],je.prototype,"wickStrokeWidth",2),p([ct()],je.prototype,"wickStrokeOpacity",2),p([jT()],je.prototype,"wickLineDash",2),p([ct()],je.prototype,"wickLineDashOffset",2),p([ct()],je.prototype,"capLengthRatio",2),p([ct()],je.prototype,"wickStrokeAlignment",2);function Ba(e,t,i,o){t?e.moveTo(o,i):e.moveTo(i,o)}function Va(e,t,i,o){t?e.lineTo(o,i):e.lineTo(i,o)}function Sx(e,t,i,o,s,a,n,r){t?xx(e,o,i,a,s,n,r==null?void 0:new zs(r.y,r.x,r.height,r.width)):xx(e,i,o,s,a,n,r)}import{_ModuleSupport as QT}from"ag-charts-community";import{BaseProperties as bx,Property as oe,mergeDefaults as JT}from"ag-charts-core";var{AbstractBarSeriesProperties:ew,makeSeriesTooltip:tw}=QT,vx=class extends bx{constructor(){super(...arguments),this.lengthRatio=.5}};p([oe],vx.prototype,"lengthRatio",2);var za=class extends bx{};p([oe],za.prototype,"stroke",2),p([oe],za.prototype,"strokeWidth",2),p([oe],za.prototype,"strokeOpacity",2),p([oe],za.prototype,"lineDash",2),p([oe],za.prototype,"lineDashOffset",2);var de=class extends ew{constructor(){super(...arguments),this.fill="#c16068",this.fillOpacity=1,this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.cap=new vx,this.whisker=new za,this.tooltip=tw()}toJson(){const{stroke:e,strokeWidth:t,strokeOpacity:i,lineDash:o,lineDashOffset:s}=this,a=super.toJson();return a.whisker=JT(a.whisker,{stroke:e,strokeWidth:t,strokeOpacity:i,lineDash:o,lineDashOffset:s}),a}};p([oe],de.prototype,"xKey",2),p([oe],de.prototype,"minKey",2),p([oe],de.prototype,"q1Key",2),p([oe],de.prototype,"medianKey",2),p([oe],de.prototype,"q3Key",2),p([oe],de.prototype,"maxKey",2),p([oe],de.prototype,"xName",2),p([oe],de.prototype,"yName",2),p([oe],de.prototype,"minName",2),p([oe],de.prototype,"q1Name",2),p([oe],de.prototype,"medianName",2),p([oe],de.prototype,"q3Name",2),p([oe],de.prototype,"maxName",2),p([oe],de.prototype,"fill",2),p([oe],de.prototype,"fillOpacity",2),p([oe],de.prototype,"stroke",2),p([oe],de.prototype,"strokeWidth",2),p([oe],de.prototype,"strokeOpacity",2),p([oe],de.prototype,"lineDash",2),p([oe],de.prototype,"lineDashOffset",2),p([oe],de.prototype,"cornerRadius",2),p([oe],de.prototype,"styler",2),p([oe],de.prototype,"itemStyler",2),p([oe],de.prototype,"cap",2),p([oe],de.prototype,"whisker",2),p([oe],de.prototype,"tooltip",2);var{fixNumericExtent:iw,keyProperty:ow,SeriesNodePickMode:kx,SMALLEST_KEY_INTERVAL:sw,valueProperty:qn,diff:aw,animationValidation:nw,computeBarFocusBounds:rw,createDatumId:lw,HighlightState:ep,ContinuousScale:cw,motion:Dx,getItemStyles:hw,calculateSegments:dw,toHighlightString:pw}=is,uw=class extends is.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.xKey=o.properties.xKey,this.minKey=o.properties.minKey,this.q1Key=o.properties.q1Key,this.medianKey=o.properties.medianKey,this.q3Key=o.properties.q3Key,this.maxKey=o.properties.maxKey}},tp=class extends is.AbstractBarSeries{constructor(e){super({moduleCtx:e,pickModes:[kx.NEAREST_NODE,kx.EXACT_SHAPE_MATCH],propertyKeys:{x:["xKey"],y:["medianKey","q1Key","q3Key","minKey","maxKey"]},propertyNames:{x:["xName"],y:["medianName","q1Name","q3Name","minName","maxName"]},categoryKey:"xValue",pathsPerSeries:[]}),this.properties=new de,this.NodeEvent=uw}async processData(e){if(!this.visible)return;const{xKey:t,minKey:i,q1Key:o,medianKey:s,q3Key:a,maxKey:n}=this.properties,r=!this.ctx.animationManager.isSkipped(),l=this.getCategoryAxis()?.scale,c=this.getValueAxis()?.scale,{isContinuousX:h,xScaleType:d,yScaleType:u}=this.getScaleInformation({xScale:l,yScale:c}),g=[];this.needsDataModelDiff()&&this.processedData&&g.push(aw(this.id,this.processedData)),r&&g.push(nw());const{processedData:m}=await this.requestDataModel(e,this.data,{props:[ow(t,d,{id:"xValue"}),qn(i,u,{id:"minValue"}),qn(o,u,{id:"q1Value"}),qn(s,u,{id:"medianValue"}),qn(a,u,{id:"q3Value"}),qn(n,u,{id:"maxValue"}),...h?[sw]:[],...g]});this.smallestDataInterval=m.reduced?.smallestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!(t&&i))return{domain:[]};if(e!==this.getBarDirection()){const{index:s,def:a}=i.resolveProcessedDataDefById(this,"xValue"),n=t.domain.keys[s];if(a.type==="key"&&a.valueType==="category"){const r=i.getKeySortMetadata(this,"xValue",t);return{domain:n,sortMetadata:r}}return{domain:this.padBandExtent(n)}}const o=this.domainForClippedRange(e,["minValue","maxValue"],"xValue");return{domain:iw(o)}}getSeriesRange(e,t){return this.domainForVisibleRange(KT.Y,["maxValue","minValue"],"xValue",t)}createNodeData(){const{visible:e,dataModel:t,processedData:i}=this,o=this.getCategoryAxis(),s=this.getValueAxis();if(!(t&&i&&o&&s))return;const{xKey:a}=this.properties,n=[],r=t.resolveKeysById(this,"xValue",i),l=t.resolveColumnById(this,"minValue",i),c=t.resolveColumnById(this,"q1Value",i),h=t.resolveColumnById(this,"medianValue",i),d=t.resolveColumnById(this,"q3Value",i),u=t.resolveColumnById(this,"maxValue",i),{barWidth:g,groupIndex:m}=this.updateGroupScale(o),y=cw.is(o.scale)?g*-.5:0,{groupScale:S}=this,x=this.isVertical(),b=dw(this.properties.segmentation,o,s,this.chart.seriesRect,this.ctx.scene),f={itemId:a,nodeData:n,labelData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible,styles:hw(this.getItemStyle.bind(this)),segments:b};if(!e)return f;const v=i.dataSources.get(this.id)?.data??[];for(const[k,A]of v.entries()){const M=r[k];if(M==null)continue;const I=l[k],D=c[k],L=h[k],N=d[k],T=u[k];if([I,D,L,N,T].some(_=>typeof _!="number")||I>D||D>L||L>N||N>T)continue;const O={xValue:o.scale.convert(M),minValue:s.scale.convert(I),q1Value:s.scale.convert(D),medianValue:s.scale.convert(L),q3Value:s.scale.convert(N),maxValue:s.scale.convert(T)},R=g;O.xValue+=S.convert(String(m))+y+R/2;const w=Math.abs(O.q3Value-O.q1Value),E=O.xValue,B=Math.min(O.q3Value,O.q1Value)+w/2,P={x:x?E:B,y:x?B:E};let C;x?C={x:P.x-R/2,y:O.minValue,width:R,height:O.maxValue-O.minValue}:C={x:O.minValue,y:P.y-R/2,width:O.maxValue-O.minValue,height:R},n.push({series:this,itemId:M,datum:A,datumIndex:k,xKey:a,bandwidth:R,scaledValues:O,midPoint:P,focusRect:C})}return f}legendItemSymbol(){const{fill:e,stroke:t,strokeWidth:i,fillOpacity:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}=this.getStyle(!1,ep.None);return{marker:{fill:GT(e),fillOpacity:o,stroke:t,strokeOpacity:s,strokeWidth:i,lineDash:a,lineDashOffset:n}}}getLegendData(e){const{id:t,ctx:{legendManager:i},visible:o}=this,{xKey:s,yName:a,showInLegend:n,legendItemName:r}=this.properties;return!s||e!=="category"?[]:[{legendType:"category",id:t,itemId:t,seriesId:t,enabled:o&&i.getItemEnabled({seriesId:t,itemId:t}),label:{text:r??a??t},symbol:this.legendItemSymbol(),legendItemName:r,hideInLegend:!n}]}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,properties:s}=this,{xKey:a,xName:n,yName:r,medianKey:l,medianName:c,q1Key:h,q1Name:d,q3Key:u,q3Name:g,minKey:m,minName:y,maxKey:S,maxName:x,legendItemName:b,tooltip:f}=s,v=this.getCategoryAxis(),k=this.getValueAxis();if(!i||!o||!v||!k)return;const A=o.dataSources.get(this.id)?.data[e],M=i.resolveKeysById(this,"xValue",o)[e],I=i.resolveColumnById(this,"minValue",o)[e],D=i.resolveColumnById(this,"q1Value",o)[e],L=i.resolveColumnById(this,"medianValue",o)[e],N=i.resolveColumnById(this,"q3Value",o)[e],T=i.resolveColumnById(this,"maxValue",o)[e];if(M==null)return;const O=this.getItemStyle(e,!1),R=[{label:y,fallbackLabel:m,value:this.getAxisValueText(k,"tooltip",I,A,m,b),missing:is.isTooltipValueMissing(I)},{label:d,fallbackLabel:h,value:this.getAxisValueText(k,"tooltip",D,A,h,b),missing:is.isTooltipValueMissing(D)},{label:c,fallbackLabel:l,value:this.getAxisValueText(k,"tooltip",L,A,l,b),missing:is.isTooltipValueMissing(L)},{label:g,fallbackLabel:u,value:this.getAxisValueText(k,"tooltip",N,A,u,b),missing:is.isTooltipValueMissing(N)},{label:x,fallbackLabel:S,value:this.getAxisValueText(k,"tooltip",T,A,S,b),missing:is.isTooltipValueMissing(T)}];return this.formatTooltipWithContext(f,{heading:this.getAxisValueText(v,"tooltip",M,A,a,b),title:b??r,symbol:this.legendItemSymbol(),data:R},{seriesId:t,datum:A,title:r,xKey:a,xName:n,yName:r,medianKey:l,medianName:c,q1Key:h,q1Name:d,q3Key:u,q3Name:g,minKey:m,minName:y,maxKey:S,maxName:x,...O})}animateEmptyUpdateReady({datumSelection:e}){const t=this.isVertical(),{from:i,to:o}=$T(t);Dx.resetMotion([e],YT(t)),Dx.staticFromToMotion(this.id,"datums",this.ctx.animationManager,[e],i,o,{phase:"initial"})}isLabelEnabled(){return!1}updateDatumSelection(e){const t=e.nodeData??[];return e.datumSelection.update(t)}makeStylerParams(e){const{id:t}=this,{cornerRadius:i,cap:{lengthRatio:o},fill:s,fillOpacity:a,lineDash:n,lineDashOffset:r,stroke:l,strokeOpacity:c,strokeWidth:h,maxKey:d,maxName:u,medianKey:g,medianName:m,minKey:y,minName:S,q1Key:x,q1Name:b,q3Key:f,q3Name:v,whisker:{lineDash:k,lineDashOffset:A,stroke:M,strokeOpacity:I,strokeWidth:D},xKey:L,xName:N,yName:T}=this.properties,O=pw(e??ep.None);return{cap:{lengthRatio:o},cornerRadius:i,fill:s,fillOpacity:a,highlightState:O,lineDash:n,lineDashOffset:r,maxKey:d,maxName:u??d,medianKey:g,medianName:m??g,minKey:y,minName:S??y,q1Key:x,q1Name:b??x,q3Key:f,q3Name:v??f,seriesId:t,stroke:l,strokeOpacity:c,strokeWidth:h,whisker:{lineDash:k??n,lineDashOffset:A??r,stroke:M??l,strokeOpacity:I??c,strokeWidth:D??h},xKey:L,xName:N??L,yName:T}}getStyle(e,t){const{cap:i,cornerRadius:o,fill:s,fillOpacity:a,lineDash:n,lineDashOffset:r,stroke:l,strokeOpacity:c,strokeWidth:h,styler:d,whisker:u}=this.properties;let g={};if(!e&&d){const m=this.makeStylerParams(t);g=this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],this.cachedCallWithContext(d,m)??{},{pick:!1})??{}}return{cornerRadius:g.cornerRadius??o,fill:g.fill??s,fillOpacity:g.fillOpacity??a,lineDash:g.lineDash??n,lineDashOffset:g.lineDashOffset??r,opacity:1,stroke:g.stroke??l,strokeOpacity:g.strokeOpacity??c,strokeWidth:g.strokeWidth??h,cap:{lengthRatio:g.cap?.lengthRatio??i.lengthRatio},whisker:{lineDash:g.whisker?.lineDash??u.lineDash,lineDashOffset:g.whisker?.lineDashOffset??u.lineDashOffset,stroke:g.whisker?.stroke??u.stroke,strokeOpacity:g.whisker?.strokeOpacity??u.strokeOpacity,strokeWidth:g.whisker?.strokeWidth??u.strokeWidth}}}getItemStyle(e,t,i){const{properties:o}=this,{itemStyler:s}=o,a=this.getHighlightStyle(t,e,i);let n=Jd(a,this.getStyle(e===void 0,i));if(s!=null&&e!=null){const u=this.cachedDatumCallback(lw(e,t?"highlight":"node"),()=>{const g=this.makeItemStylerParams(e,t,n);return this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],this.callWithContext(s,g))});u&&(n=Jd(u,n))}const{stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}=n;return n.whisker=Jd(n.whisker,{stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}),n}makeItemStylerParams(e,t,i){const{id:o}=this,{xKey:s,minKey:a,q1Key:n,medianKey:r,q3Key:l,maxKey:c}=this.properties,h=this.processedData?.dataSources.get(o)?.data[e],d=this.ctx.highlightManager?.getActiveHighlight(),u=this.getHighlightStateString(d,t,e),g=this.filterItemStylerFillParams(i.fill)??i.fill;return{seriesId:o,datum:h,xKey:s,minKey:a,q1Key:n,medianKey:r,q3Key:l,maxKey:c,highlightState:u,...i,fill:g}}updateDatumStyles({datumSelection:e,isHighlight:t}){const i=this.ctx.highlightManager.getActiveHighlight();e.each((o,s)=>{const a=this.getHighlightState(i,t,s.datumIndex);s.style=this.getItemStyle(s.datumIndex,t,a)})}updateDatumNodes({datumSelection:e,isHighlight:t}){const{contextNodeData:i,properties:o}=this;if(!i)return;const s=this.isVertical(),a=this.ctx.highlightManager.getActiveHighlight(),n=this.getShapeFillBBox(),r=this.getStyle(!1,ep.None).strokeWidth/2,l=o.whisker.strokeWidth??o.strokeWidth;e.each((c,h)=>{const d=h.style??i.styles[this.getHighlightState(a,t,h.datumIndex)];c.setFillProperties(d.fill,n);const u=d.opacity??1,g=d.whisker?.strokeOpacity??d.strokeOpacity;c.fill=d.fill,c.fillOpacity=d.fillOpacity*u,c.stroke=d.stroke,c.strokeWidth=d.strokeWidth,c.strokeOpacity=d.strokeOpacity*u,c.lineDash=d.lineDash,c.lineDashOffset=d.lineDashOffset,c.wickStroke=d.whisker.stroke,c.wickStrokeWidth=d.whisker.strokeWidth,c.wickStrokeOpacity=g*u,c.wickLineDash=d.whisker.lineDash,c.wickLineDashOffset=d.whisker.lineDashOffset,c.cornerRadius=d.cornerRadius,c.crisp=!0,c.horizontal=!s,c.center=h.scaledValues.xValue,c.thickness=h.bandwidth,c.min=h.scaledValues.minValue,c.q1=h.scaledValues.q1Value,c.median=h.scaledValues.medianValue,c.q3=h.scaledValues.q3Value,c.max=h.scaledValues.maxValue,c.capLengthRatio=d.cap.lengthRatio,c.strokeAlignment=r,c.wickStrokeAlignment=l})}updateLabelNodes(){}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e;return i.update(t)}nodeFactory(){return new je}computeFocusBounds({datumIndex:e}){return rw(this,this.contextNodeData?.nodeData[e].focusRect)}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.styler!=null}};tp.className="BoxPlotSeries",tp.type="box-plot";import{_ModuleSupport as gw}from"ag-charts-community";import{boolean as mw,commonSeriesOptionsDefs as yw,constant as fw,required as Fs,shapeSegmentation as xw,string as bt}from"ag-charts-core";var{boxPlotSeriesThemeableOptionsDef:Sw}=gw,bw={...yw,...Sw,type:Fs(fw("box-plot")),xKey:Fs(bt),minKey:Fs(bt),q1Key:Fs(bt),medianKey:Fs(bt),q3Key:Fs(bt),maxKey:Fs(bt),xKeyAxis:bt,yKeyAxis:bt,xName:bt,yName:bt,minName:bt,q1Name:bt,medianName:bt,q3Name:bt,maxName:bt,grouped:mw,legendItemName:bt,segmentation:xw};import{_ModuleSupport as vw}from"ag-charts-community";import{CARTESIAN_AXIS_TYPE as Ax}from"ag-charts-core";var{FILL_GRADIENT_LINEAR_DEFAULTS:kw,FILL_IMAGE_DEFAULTS:Dw,FILL_PATTERN_DEFAULTS:Aw,SAFE_FILL_OPERATION:Mw,SEGMENTATION_DEFAULTS:Iw}=vw,Lw={series:{direction:"vertical",fill:{$applySwitch:[{$path:"type"},{$if:[{$or:[{$isGradient:{$palette:"fill"}},{$isPattern:{$palette:"fill"}},{$isImage:{$palette:"fill"}}]},{$palette:"fill"},{$mix:[Mw,{$ref:"chartBackgroundColor"},.7]}]},["gradient",kw],["image",Dw],["pattern",Aw]]},stroke:{$palette:"stroke"},strokeWidth:2,fillOpacity:1,strokeOpacity:1,lineDash:void 0,lineDashOffset:0,highlight:{unhighlightedItem:{opacity:.5},unhighlightedSeries:{opacity:.1}},segmentation:Iw},axes:{[Ax.NUMBER]:{crosshair:{snap:!1}},[Ax.CATEGORY]:{groupPaddingInner:.2,crosshair:{enabled:!1,snap:!1}}}},{DIRECTION_SWAP_AXES:Nw,predictCartesianNonPrimitiveAxis:Cw}=WT,ip={type:"series",name:"box-plot",chartType:"cartesian",enterprise:!0,groupable:!0,version:HT,dependencies:[FT],options:bw,predictAxis:Cw,defaultAxes:Nw,axisKeys:{[Kl.X]:"xKeyAxis",[Kl.Y]:"yKeyAxis"},axisKeysFlipped:{[Kl.X]:"yKeyAxis",[Kl.Y]:"xKeyAxis"},themeTemplate:Lw,create:e=>new tp(e)};import{CartesianChartModule as Tw,VERSION as ww,_ModuleSupport as Pw}from"ag-charts-community";import{CARTESIAN_AXIS_TYPE as Mx,CARTESIAN_POSITION as Ix,ChartAxisDirection as Lx}from"ag-charts-core";import"ag-charts-community";import{isGradientFill as Nx,isImageFill as op,isPatternFill as sp}from"ag-charts-core";import{_ModuleSupport as Hs}from"ag-charts-community";import{AGGREGATION_INDEX_X_MAX as Ow,AGGREGATION_INDEX_X_MIN as Rw,AGGREGATION_INDEX_Y_MAX as Ew,AGGREGATION_INDEX_Y_MIN as _w,AGGREGATION_SPAN as Bw,ChartAxisDirection as ap,DebugMetrics as Vw,Logger as Cx,mergeDefaults as Tx}from"ag-charts-core";import"ag-charts-community";import{aggregationDomain as np,computeExtremesAggregation as wx,computeExtremesAggregationPartial as zw,simpleMemorize2 as Fw}from"ag-charts-core";function Hw(e,t,i,o,s,a,n,r){const[l,c]=np(e,s);return wx([l,c],t,i,o,{smallestKeyInterval:a,xNeedsValueOf:n,yNeedsValueOf:r})}var Ww=Fw(Hw);function Kw(e,t,i,o,s){const a=t.resolveKeysById(o,"xValue",i),n=t.resolveColumnById(o,"highValue",i),r=t.resolveColumnById(o,"lowValue",i),l=t.getDomain(o,"xValue","key",i),c=t.resolveColumnNeedsValueOf(o,"xValue",i),h=t.resolveColumnNeedsValueOf(o,"highValue",i)??t.resolveColumnNeedsValueOf(o,"lowValue",i);if(s){const[d,u]=np(e,l);return wx([d,u],a,n,r,{smallestKeyInterval:i.reduced?.smallestKeyInterval,xNeedsValueOf:c,yNeedsValueOf:h,existingFilters:s})}return Ww(e,a,n,r,l,i.reduced?.smallestKeyInterval,c,h)}function Gw(e,t,i,o,s,a){const n=t.resolveKeysById(o,"xValue",i),r=t.resolveColumnById(o,"highValue",i),l=t.resolveColumnById(o,"lowValue",i),c=t.getDomain(o,"xValue","key",i),h=t.resolveColumnNeedsValueOf(o,"xValue",i),d=t.resolveColumnNeedsValueOf(o,"highValue",i)??t.resolveColumnNeedsValueOf(o,"lowValue",i),[u,g]=np(e,c);return zw([u,g],n,r,l,{smallestKeyInterval:i.reduced?.smallestKeyInterval,targetRange:s,xNeedsValueOf:h,yNeedsValueOf:d,existingFilters:a})}import{_ModuleSupport as $w}from"ag-charts-community";import{DeclaredSceneChangeDetection as os}from"ag-charts-core";var{Path:Yw,BBox:Uw}=$w,vo=class extends Yw{constructor(){super(...arguments),this.centerX=0,this.y=0,this.width=0,this.height=0,this.yOpen=0,this.yClose=0,this.crisp=!1}setStaticProperties(e,t,i,o,s,a,n){this.__centerX=e,this.__width=t,this.__y=i,this.__height=o,this.__yOpen=s,this.__yClose=a,this.__crisp=n,this.dirtyPath=!0,this.markDirty()}computeBBox(){const{__centerX:e,__y:t,__width:i,__height:o}=this;return new Uw(e-i/2,t,i,o)}isPointInPath(e,t){return this.getBBox().containsPoint(e,t)}distanceSquared(e,t){return this.getBBox().distanceSquared(e,t)}get midPoint(){return{x:this.__centerX,y:this.__y+this.__height/2}}alignedCoordinates(){const{__y:e,__width:t,__height:i,__crisp:o}=this;let{__centerX:s,__yOpen:a,__yClose:n}=this,r=s-t/2,l=s+t/2,c=e,h=e+i;if(o&&t>1){if(s=this.align(s),a<=n){const u=this.align(a,n-a);a=this.align(a),n=a+u}else{const u=this.align(n,a-n);n=this.align(n),a=n+u}const d=this.align(t/2);r=s-d,l=s+d,c=this.align(e),h=c+this.align(c,i)}return{centerX:s,x0:r,x1:l,y0:c,y1:h,yOpen:a,yClose:n}}executeStroke(e,t){const{__width:i,strokeWidth:o}=this;i<o&&(e.lineWidth=i),super.executeStroke(e,t)}};p([os()],vo.prototype,"centerX",2),p([os()],vo.prototype,"y",2),p([os()],vo.prototype,"width",2),p([os()],vo.prototype,"height",2),p([os()],vo.prototype,"yOpen",2),p([os()],vo.prototype,"yClose",2),p([os()],vo.prototype,"crisp",2);var Px=class extends vo{constructor(){super(...arguments),this.strokeAlignment=0}updatePath(){const{path:e}=this,{centerX:t,x0:i,x1:o,y0:s,y1:a,yOpen:n,yClose:r}=this.alignedCoordinates(),l=this.layerManager?.canvas.pixelRatio??1,c=this.__strokeAlignment>0?l/this.__strokeAlignment/2%1:0;e.clear(),e.moveTo(t-c,s),e.lineTo(t-c,a),Math.abs(o-i)>1&&(e.moveTo(i,n-c),e.lineTo(t-c,n-c),e.moveTo(t-c,r-c),e.lineTo(o,r-c))}};p([os()],Px.prototype,"strokeAlignment",2);var jw=Rw,Xw=Ew,Zw=_w,Ox=Ow,Rx=Bw,{AggregationManager:qw,fixNumericExtent:Qw,keyProperty:Jw,createDatumId:rp,SeriesNodePickMode:Ex,SMALLEST_KEY_INTERVAL:eP,valueProperty:Gl,diff:tP,animationValidation:iP,computeBarFocusBounds:oP,visibleRangeIndices:_x,BandScale:sP,processedDataIsAnimatable:lp,getItemStylesPerItemId:aP}=Hs,nP=class extends Hs.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.xKey=o.properties.xKey,this.openKey=o.properties.openKey,this.closeKey=o.properties.closeKey,this.highKey=o.properties.highKey,this.lowKey=o.properties.lowKey}};function rP(e){for(const t of e){const i=t.nodes();t.batchedUpdate(function(){for(const s of i){const a=s.datum;a!=null&&s.setStaticProperties(a.centerX,a.width,a.y,a.height,a.yOpen,a.yClose,a.crisp)}t.cleanup()})}}var Bx=class extends Hs.AbstractBarSeries{constructor(e){super({moduleCtx:e,pickModes:[Ex.AXIS_ALIGNED,Ex.EXACT_SHAPE_MATCH],propertyKeys:{x:["xKey"],y:["lowKey","highKey","openKey","closeKey"]},propertyNames:{x:["xName"],y:["lowName","highName","openName","closeName"]},categoryKey:"xValue",pathsPerSeries:[]}),this.NodeEvent=nP,this.aggregationManager=new qw}async processData(e){if(!this.visible)return;const{xKey:t,openKey:i,closeKey:o,highKey:s,lowKey:a}=this.properties,n=!this.ctx.animationManager.isSkipped(),r=this.getCategoryAxis()?.scale,l=this.getValueAxis()?.scale,{isContinuousX:c,xScaleType:h,yScaleType:d}=this.getScaleInformation({xScale:r,yScale:l}),u=[];this.needsDataModelDiff()&&this.processedData&&u.push(tP(this.id,this.processedData)),n&&u.push(iP()),i&&u.push(Gl(i,d,{id:"openValue",invalidValue:void 0,missingValue:void 0}));const{dataModel:g,processedData:m}=await this.requestDataModel(e,this.data,{props:[Jw(t,h,{id:"xValue"}),Gl(o,d,{id:"closeValue"}),Gl(s,d,{id:"highValue"}),Gl(a,d,{id:"lowValue"}),...c?[eP]:[],...u]});this.smallestDataInterval=m.reduced?.smallestKeyInterval,this.aggregateData(g,m),this.animationState.transition("updateData")}aggregateData(e,t){if(this.aggregationManager.markStale(),t.type!=="ungrouped"||lp(t))return;const i=this.axes[ap.X];if(i==null)return;const o=this.estimateTargetRange();this.aggregationManager.aggregate({computePartial:a=>Gw(i.scale.type,e,t,this,o,a),computeFull:a=>Kw(i.scale.type,e,t,this,a),targetRange:o});const s=this.aggregationManager.filters;s&&s.length>0&&Vw.record(`${this.type}:aggregation`,s.map(a=>a.maxRange))}estimateTargetRange(){const e=this.axes[ap.X];if(!e)return-1;const[t,i]=e.scale.range;return Math.abs(i-t)}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!(t&&i))return{domain:[]};if(e!==this.getBarDirection()){const{def:s}=i.resolveProcessedDataDefById(this,"xValue"),a=i.getDomain(this,"xValue","key",t);return s.type==="key"&&s.valueType==="category"?a:{domain:this.padBandExtent(a.domain)}}const o=this.domainForClippedRange(e,["highValue","lowValue"],"xValue");return{domain:Qw(o)}}getSeriesRange(e,t){return this.domainForVisibleRange(ap.Y,["highValue","lowValue"],"xValue",t)}getZoomRangeFittingItems(e,t,i){return this.zoomFittingVisibleItems("xValue",["highValue","lowValue"],e,t,i)}getVisibleItems(e,t,i){return this.countVisibleItems("xValue",["highValue","lowValue"],e,t,i)}createNodeDatumContext(e,t){const{dataModel:i,processedData:o,groupScale:s}=this;if(!i||!o)return;const a=o.dataSources.get(this.id)?.data??[];if(a.length===0)return;const n=e.scale,r=t.scale,{barWidth:l,groupIndex:c}=this.updateGroupScale(e),h=s.convert(String(c)),d=l>=1?l:s.rawBandwidth,u=sP.is(n),[g,m]=n.range,y=Math.abs(m-g);this.aggregationManager.ensureLevelForRange(y);const S=this.aggregationManager.getFilterForRange(y),x=S==null,b=this.contextNodeData?.nodeData!=null&&(o.changeDescription!=null||!lp(o)||S!=null);return{rawData:a,xValues:i.resolveKeysById(this,"xValue",o),openValues:i.resolveColumnById(this,"openValue",o),closeValues:i.resolveColumnById(this,"closeValue",o),highValues:i.resolveColumnById(this,"highValue",o),lowValues:i.resolveColumnById(this,"lowValue",o),xScale:n,yScale:r,xAxis:e,yAxis:t,barWidth:l,groupOffset:h,effectiveBarWidth:d,applyWidthOffset:u,crisp:x,xKey:this.properties.xKey,openKey:this.properties.openKey,closeKey:this.properties.closeKey,highKey:this.properties.highKey,lowKey:this.properties.lowKey,dataAggregationFilter:S,range:y,nodeDatumStateScratch:{datum:void 0,xValue:void 0,openValue:0,closeValue:0,highValue:0,lowValue:0,isRising:!0,itemType:"up"},canIncrementallyUpdate:b,nodeIndex:0,nodeData:b?this.contextNodeData.nodeData:[]}}prepareOhlcNodeDatumState(e,t){const i=e.xValues[t];if(i==null)return;const o=e.openValues[t],s=e.closeValues[t],a=e.highValues[t],n=e.lowValues[t],r=n!=null&&n<=o&&n<=s,l=a!=null&&a>=o&&a>=s;if(!r){Cx.warnOnce(`invalid low value for key [${e.lowKey}] in data element, low value cannot be higher than datum open or close values`);return}if(!l){Cx.warnOnce(`invalid high value for key [${e.highKey}] in data element, high value cannot be lower than datum open or close values.`);return}const c=e.rawData[t],h=s>o,d=h?"up":"down",u=e.nodeDatumStateScratch;return u.datum=c,u.xValue=i,u.openValue=o,u.closeValue=s,u.highValue=a,u.lowValue=n,u.isRising=h,u.itemType=d,u}createSkeletonNodeDatum(e,t,i,o,s,a){const n=e.applyWidthOffset?s/2:0,r=o+n,l=e.yScale.convert(t.openValue),c=e.yScale.convert(t.closeValue),h=e.yScale.convert(t.highValue),d=e.yScale.convert(t.lowValue),u=Math.min(h,d),g=Math.max(h,d)-u;return{series:this,itemType:t.itemType,datum:t.datum,datumIndex:i,xKey:e.xKey,xValue:t.xValue,openValue:t.openValue,closeValue:t.closeValue,highValue:t.highValue,lowValue:t.lowValue,midPoint:{x:r,y:u+g/2},aggregatedValue:t.closeValue,isRising:t.isRising,centerX:r,width:s,y:u,height:g,yOpen:l,yClose:c,crisp:a}}updateNodeDatum(e,t,i,o,s,a,n){const r=t,l=e.applyWidthOffset?a/2:0,c=s+l,h=e.yScale.convert(i.openValue),d=e.yScale.convert(i.closeValue),u=e.yScale.convert(i.highValue),g=e.yScale.convert(i.lowValue),m=Math.min(u,g),y=Math.max(u,g)-m;r.datum=i.datum,r.datumIndex=o,r.itemType=i.itemType,r.xValue=i.xValue,r.openValue=i.openValue,r.closeValue=i.closeValue,r.highValue=i.highValue,r.lowValue=i.lowValue,r.aggregatedValue=i.closeValue,r.isRising=i.isRising,r.centerX=c,r.width=a,r.y=m,r.height=y,r.yOpen=h,r.yClose=d,r.crisp=n;const S=r.midPoint;S.x=c,S.y=m+y/2}upsertNodeDatum(e,t,i,o,s){const a=this.prepareOhlcNodeDatumState(e,t);if(!a)return;if(e.canIncrementallyUpdate&&e.nodeIndex<e.nodeData.length)this.updateNodeDatum(e,e.nodeData[e.nodeIndex],a,t,i,o,s);else{const r=this.createSkeletonNodeDatum(e,a,t,i,o,s);e.nodeData.push(r)}e.nodeIndex++}createNodeData(){const{visible:e}=this,t=this.getCategoryAxis(),i=this.getValueAxis();if(!t||!i)return;const o=this.createNodeDatumContext(t,i),s={itemId:this.properties.xKey,nodeData:o?.nodeData??[],labelData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible,styles:aP(this.getItemStyle.bind(this),"up","down")};if(!e||!o)return s;const a=n=>o.xScale.convert(o.xValues[n])+o.groupOffset;if(o.dataAggregationFilter==null){const n=this.processedData.invalidData?.get(this.id);let[r,l]=_x(1,o.rawData.length,o.xAxis.range,c=>{const h=o.applyWidthOffset?0:-o.effectiveBarWidth/2,d=a(c)+h;return[d,d+o.effectiveBarWidth]});this.processedData.input.count<1e3&&(r=0,l=this.processedData.input.count);for(let c=r;c<l;c+=1){if(n?.[c]===!0)continue;const h=a(c);this.upsertNodeDatum(o,c,h,o.effectiveBarWidth,o.crisp)}o.canIncrementallyUpdate&&o.nodeIndex<o.nodeData.length&&(o.nodeData.length=o.nodeIndex)}else{const{maxRange:n,indexData:r,midpointIndices:l}=o.dataAggregationFilter,[c,h]=_x(1,n,o.xAxis.range,d=>{const u=d*Rx,g=r[u+Ox],m=l[d];if(m===-1)return;const y=o.applyWidthOffset?0:-o.effectiveBarWidth/2;return[a(m)+y,a(g)+y+o.effectiveBarWidth]});for(let d=c;d<h;d+=1){const u=d*Rx,g=r[u+jw],m=r[u+Ox],y=r[u+Xw],S=r[u+Zw],x=l[d];if(x===-1)continue;const b=this.prepareOhlcNodeDatumState(o,x);if(!b)continue;b.openValue=o.openValues[g],b.closeValue=o.closeValues[m],b.highValue=o.highValues[y],b.lowValue=o.lowValues[S],b.isRising=b.closeValue>b.openValue,b.itemType=b.isRising?"up":"down";const f=a(x),v=Math.abs(a(m)-a(g))+o.effectiveBarWidth;if(o.canIncrementallyUpdate&&o.nodeIndex<o.nodeData.length)this.updateNodeDatum(o,o.nodeData[o.nodeIndex],b,x,f,v,!1);else{const A=this.createSkeletonNodeDatum(o,b,x,f,v,!1);o.nodeData.push(A)}o.nodeIndex++}o.canIncrementallyUpdate&&o.nodeIndex<o.nodeData.length&&(o.nodeData.length=o.nodeIndex)}return s}isVertical(){return!0}isLabelEnabled(){return!1}resetDatumAnimation(e){rP([e.datumSelection])}updateDatumSelection(e){const t=e.nodeData??[];return lp(this.processedData)?e.datumSelection.update(t,void 0,i=>rp(i.xValue)):e.datumSelection.update(t)}updateLabelNodes(e){}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e;return i.update(t)}getItemStyle(e,t,i,o="up"){const{properties:s,dataModel:a,processedData:n}=this,{itemStyler:r}=s,l=this.getHighlightStyle(t,e,i);let h=Tx(l,s.getStyle(o));if(r&&a!=null&&n!=null&&e!=null){const d=a.resolveKeysById(this,"xValue",n)[e],u=this.cachedDatumCallback(rp(rp(d),t?"highlight":"node"),()=>{const g=this.makeItemStylerParams(o,e,t,h);return this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`,"item",o],this.callWithContext(r,g))});u&&(h=Tx(u,h))}return h}makeItemStylerParams(e,t,i,o){const{id:s,properties:a,processedData:n}=this,{xKey:r,openKey:l,closeKey:c,highKey:h,lowKey:d}=a,u=n.dataSources.get(s)?.data[t],g=this.ctx.highlightManager?.getActiveHighlight(),m=this.getHighlightStateString(g,i,t),y={seriesId:s,datum:u,itemType:e,xKey:r,openKey:l,closeKey:c,highKey:h,lowKey:d,highlightState:m,...o};return"fill"in y&&"fill"in o&&(y.fill=this.filterItemStylerFillParams(o.fill)??o.fill),y}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,properties:s}=this,{xKey:a,xName:n,yName:r,openKey:l,openName:c,highKey:h,highName:d,lowKey:u,lowName:g,closeKey:m,closeName:y,legendItemName:S,tooltip:x}=s,b=this.getCategoryAxis(),f=this.getValueAxis();if(!i||!o||!b||!f)return;const v=o.dataSources.get(this.id)?.data[e],k=i.resolveKeysById(this,"xValue",o)[e],A=i.resolveColumnById(this,"openValue",o)[e],M=i.resolveColumnById(this,"highValue",o)[e],I=i.resolveColumnById(this,"lowValue",o)[e],D=i.resolveColumnById(this,"closeValue",o)[e];if(k==null)return;const L=D>=A?"up":"down",N=this.properties.item[L],T=this.getItemStyle(e,!1),O={fill:N.fill??N.stroke,fillOpacity:N.fillOpacity??N.strokeOpacity??1,stroke:N.stroke,strokeWidth:N.strokeWidth??1,strokeOpacity:N.strokeOpacity??1,lineDash:N.lineDash??[0],lineDashOffset:N.lineDashOffset??0};return this.formatTooltipWithContext(x,{heading:this.getAxisValueText(b,"tooltip",k,v,a,S),title:S,symbol:{marker:O},data:[{label:c,fallbackLabel:l,value:this.getAxisValueText(f,"tooltip",A,v,l,S),missing:Hs.isTooltipValueMissing(A)},{label:d,fallbackLabel:h,value:this.getAxisValueText(f,"tooltip",M,v,h,S),missing:Hs.isTooltipValueMissing(M)},{label:g,fallbackLabel:u,value:this.getAxisValueText(f,"tooltip",I,v,u,S),missing:Hs.isTooltipValueMissing(I)},{label:y,fallbackLabel:m,value:this.getAxisValueText(f,"tooltip",D,v,m,S),missing:Hs.isTooltipValueMissing(D)}]},{seriesId:t,datum:v,title:r,itemType:L,xKey:a,xName:n,yName:r,openKey:l,openName:c,highKey:h,highName:d,lowKey:u,lowName:g,closeKey:m,closeName:y,...T})}computeFocusBounds(e){const t=this.getNodeData()?.at(e.datumIndex);if(t==null)return;const{centerX:i,y:o,width:s,height:a}=t,n={x:i-s/2,y:o,width:s,height:a};return oP(this,n)}};import{_ModuleSupport as lP}from"ag-charts-community";import{DeclaredSceneChangeDetection as Qn,SceneArrayChangeDetection as cP}from"ag-charts-core";var{ExtendedPath2D:hP,BBox:dP}=lP,Ws=class extends vo{constructor(){super(...arguments),this.wickPath=new hP,this.wickStroke=void 0,this.wickStrokeWidth=void 0,this.wickStrokeOpacity=void 0,this.wickStrokeAlignment=0}setWickProperties(e,t,i,o,s){this.__wickStroke=e,this.__wickStrokeWidth=t,this.__wickStrokeOpacity=i,this.wickLineDash=o,this.__wickLineDashOffset=s,this.dirtyPath=!0,this.markDirty()}computeDefaultGradientFillBBox(){const{__width:e,__centerX:t,__yOpen:i,__yClose:o}=this,s=Math.min(i,o),n=Math.max(i,o)-s,r=t-e/2,l=t+e/2;return new dP(r,s,l-r,n)}updatePath(){const{path:e,stroke:t,strokeWidth:i,strokeOpacity:o,lineDash:s,lineDashOffset:a,__wickStroke:n,__wickStrokeWidth:r,__wickStrokeOpacity:l,wickLineDash:c,__wickLineDashOffset:h}=this,{centerX:d,x0:u,x1:g,y0:m,y1:y,yOpen:S,yClose:x}=this.alignedCoordinates(),b=this.layerManager?.canvas.pixelRatio??1,f=this.__wickStrokeAlignment>0?b/this.__wickStrokeAlignment/2%1:0;this.path.clear(),this.wickPath.clear();const k=n!=null&&n!==t||r!=null&&r!==i||l!=null&&l!==o||c!=null&&c!==s||h!=null&&h!==a?this.wickPath:e;if(Math.abs(g-u)<=3){k.moveTo(d-f,m),k.lineTo(d-f,y);return}const A=Math.min(S,x),M=Math.max(S,x),I=i/2;k.moveTo(d-f,m),k.lineTo(d-f,A+I),k.moveTo(d-f,y),k.lineTo(d-f,M-I);const D=M-A-2*I;if(D>0)e.rect(u+I,A+I,g-u-2*I,D);else{const L=(A+M)/2;e.moveTo(u,L),e.lineTo(g,L)}}drawPath(e){super.drawPath(e);const{wickPath:t}=this;if(t.isEmpty())return;const{stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,__wickStroke:r=i,__wickStrokeWidth:l=o,__wickStrokeOpacity:c=s,wickLineDash:h=a,__wickLineDashOffset:d=n}=this;l!==0&&(e.globalAlpha*=c,typeof r=="string"&&(e.strokeStyle=r),e.lineWidth=l,h!=null&&e.setLineDash([...h]),e.lineDashOffset=d,e.stroke(t.getPath2D()))}};p([Qn()],Ws.prototype,"wickStroke",2),p([Qn()],Ws.prototype,"wickStrokeWidth",2),p([Qn()],Ws.prototype,"wickStrokeOpacity",2),p([cP()],Ws.prototype,"wickLineDash",2),p([Qn()],Ws.prototype,"wickLineDashOffset",2),p([Qn()],Ws.prototype,"wickStrokeAlignment",2);import{_ModuleSupport as pP}from"ag-charts-community";import{BaseProperties as cp,Property as Xe}from"ag-charts-core";import{_ModuleSupport as uP}from"ag-charts-community";import{BaseProperties as Vx,Property as Be}from"ag-charts-core";var{AbstractBarSeriesProperties:gP,makeSeriesTooltip:mP}=uP,Ks=class extends Vx{constructor(){super(...arguments),this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};p([Be],Ks.prototype,"stroke",2),p([Be],Ks.prototype,"strokeWidth",2),p([Be],Ks.prototype,"strokeOpacity",2),p([Be],Ks.prototype,"lineDash",2),p([Be],Ks.prototype,"lineDashOffset",2);var hp=class extends Vx{constructor(){super(...arguments),this.up=new Ks,this.down=new Ks}};p([Be],hp.prototype,"up",2),p([Be],hp.prototype,"down",2);var Xt=class extends gP{};p([Be],Xt.prototype,"xKey",2),p([Be],Xt.prototype,"openKey",2),p([Be],Xt.prototype,"closeKey",2),p([Be],Xt.prototype,"highKey",2),p([Be],Xt.prototype,"lowKey",2),p([Be],Xt.prototype,"xName",2),p([Be],Xt.prototype,"yName",2),p([Be],Xt.prototype,"openName",2),p([Be],Xt.prototype,"closeName",2),p([Be],Xt.prototype,"highName",2),p([Be],Xt.prototype,"lowName",2);var $l=class extends Xt{constructor(){super(...arguments),this.tooltip=mP(),this.item=new hp}getStyle(e){const{strokeWidth:t,strokeOpacity:i,stroke:o,lineDash:s,lineDashOffset:a}=this.item[e];return{stroke:o,strokeWidth:t,strokeOpacity:i,lineDash:s,lineDashOffset:a,opacity:1}}};p([Be],$l.prototype,"tooltip",2),p([Be],$l.prototype,"item",2),p([Be],$l.prototype,"itemStyler",2);var{makeSeriesTooltip:yP}=pP,Fa=class extends cp{};p([Xe],Fa.prototype,"stroke",2),p([Xe],Fa.prototype,"strokeWidth",2),p([Xe],Fa.prototype,"strokeOpacity",2),p([Xe],Fa.prototype,"lineDash",2),p([Xe],Fa.prototype,"lineDashOffset",2);var Ti=class extends cp{constructor(){super(...arguments),this.fill="#c16068",this.fillOpacity=1,this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.wick=new Fa}};p([Xe],Ti.prototype,"fill",2),p([Xe],Ti.prototype,"fillOpacity",2),p([Xe],Ti.prototype,"stroke",2),p([Xe],Ti.prototype,"strokeWidth",2),p([Xe],Ti.prototype,"strokeOpacity",2),p([Xe],Ti.prototype,"lineDash",2),p([Xe],Ti.prototype,"lineDashOffset",2),p([Xe],Ti.prototype,"cornerRadius",2),p([Xe],Ti.prototype,"wick",2);var dp=class extends cp{constructor(){super(...arguments),this.up=new Ti,this.down=new Ti}};p([Xe],dp.prototype,"up",2),p([Xe],dp.prototype,"down",2);var Yl=class extends Xt{constructor(){super(...arguments),this.item=new dp,this.tooltip=yP()}getStyle(e){const{fill:t,fillOpacity:i,strokeWidth:o,strokeOpacity:s,stroke:a,lineDash:n,lineDashOffset:r,cornerRadius:l,wick:c}=this.item[e];return{fill:t,fillOpacity:i,stroke:a,strokeWidth:o,strokeOpacity:s,lineDash:n,lineDashOffset:r,cornerRadius:l,opacity:1,wick:c}}};p([Xe],Yl.prototype,"item",2),p([Xe],Yl.prototype,"tooltip",2),p([Xe],Yl.prototype,"itemStyler",2);var pp=class extends Bx{constructor(){super(...arguments),this.properties=new Yl}nodeFactory(){const e=new Ws;return e.lineCap="butt",e}updateDatumStyles({datumSelection:e,isHighlight:t}){e.each((i,o)=>{o.style=this.getItemStyle(o.datumIndex,t,void 0,o.itemType)})}updateDatumNodes({datumSelection:e,isHighlight:t}){const{contextNodeData:i,properties:o}=this;if(!i)return;const s=this.ctx.highlightManager.getActiveHighlight(),{up:a,down:n}=o.item,r=this.getShapeFillBBox(),l=this;e.each(function(h,d){const{centerX:u,width:g,y:m,height:y,yOpen:S,yClose:x,crisp:b}=d,f=d.isRising?a:n,v=l.getHighlightState(s,t,d.datumIndex),k=d.style??i.styles[d.itemType][v];h.setStaticProperties(u,g,m,y,S,x,b),h.setStyleProperties(k,r);const A=k?.wick;h.setWickProperties(A?.stroke,A?.strokeWidth,A?.strokeOpacity,A?.lineDash,A?.lineDashOffset),h.wickStrokeAlignment=f.wick.strokeWidth??f.strokeWidth})}legendItemSymbol(){const{up:e,down:t}=this.properties.item,i=Nx(e.fill)?e.fill.colorStops.map(n=>typeof n=="string"?n:{color:n.color,stop:n.stop==null?void 0:n.stop*.5}):[{color:sp(e.fill)||op(e.fill)?e.stroke:e.fill,stop:0},{color:sp(e.fill)||op(e.fill)?e.stroke:e.fill,stop:.5}],o=Nx(t.fill)?t.fill.colorStops.map(n=>typeof n=="string"?n:{color:n.color,stop:n.stop==null?void 0:n.stop*.5}):[{color:sp(t.fill)||op(t.fill)?t.stroke:t.fill,stop:.5}],s={type:"gradient",gradient:"linear",rotation:90,colorStops:[...i,...o],reverse:!1},a={type:"gradient",gradient:"linear",rotation:90,colorStops:[{color:e.stroke,stop:0},{color:e.stroke,stop:.5},{color:t.stroke,stop:.5}],reverse:!1};return{marker:{fill:s,fillOpacity:e.fillOpacity,stroke:a,strokeWidth:e.strokeWidth??1,strokeOpacity:e.strokeOpacity??1,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset}}}getLegendData(e){const{id:t,data:i,visible:o,ctx:{legendManager:s}}=this,{xKey:a,yName:n,showInLegend:r,legendItemName:l}=this.properties;return!i?.data.length||!a||e!=="category"?[]:[{legendType:"category",id:t,itemId:t,seriesId:t,enabled:o&&s.getItemEnabled({seriesId:t,itemId:t}),label:{text:l??n??t},symbol:this.legendItemSymbol(),legendItemName:l,hideInLegend:!r}]}hasItemStylers(){return this.properties.itemStyler!=null}};pp.className="CandleStickSeries",pp.type="candlestick";import{_ModuleSupport as fP}from"ag-charts-community";import{boolean as xP,commonSeriesOptionsDefs as SP,constant as bP,number as vP,required as Ha,string as Zt,undocumented as zx}from"ag-charts-core";var{candlestickSeriesThemeableOptionsDef:kP}=fP,up={...SP,...kP,type:Ha(bP("candlestick")),xKey:Ha(Zt),openKey:Ha(Zt),highKey:Ha(Zt),lowKey:Ha(Zt),closeKey:Ha(Zt),xName:Zt,yName:Zt,openName:Zt,highName:Zt,lowName:Zt,closeName:Zt,xKeyAxis:Zt,yKeyAxis:Zt};up.pickOutsideVisibleMinorAxis=zx(xP),up.focusPriority=zx(vP);import{_ModuleSupport as DP}from"ag-charts-community";import{CARTESIAN_AXIS_TYPE as Fx}from"ag-charts-core";var{multiSeriesHighlightStyle:AP,FILL_GRADIENT_LINEAR_KEYED_DEFAULTS:MP,FILL_IMAGE_DEFAULTS:IP,FILL_PATTERN_KEYED_DEFAULTS:LP}=DP;function Hx(e){return{fill:{$applySwitch:[{$path:"type"},{$if:[{$eq:[{$palette:"type"},"user-indexed"]},e==="up"?"transparent":{$palette:"fill"},{$palette:`${e}.fill`}]},["gradient",MP(e)],["image",IP],["pattern",LP(e)]]},stroke:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$palette:"stroke"},{$palette:`${e}.stroke`}]}}}var NP={series:{item:{up:Hx("up"),down:Hx("down")},tooltip:{range:{$path:["/tooltip/range","nearest"]}},highlight:AP()},animation:{enabled:!1},axes:{[Fx.NUMBER]:{crosshair:{snap:!1}},[Fx.ORDINAL_TIME]:{groupPaddingInner:0,crosshair:{enabled:!0}}}},{predictCartesianFinancialAxis:CP}=Pw,Ul={type:"series",name:"candlestick",chartType:"cartesian",enterprise:!0,groupable:!1,version:ww,dependencies:[Tw],options:up,predictAxis:CP,defaultAxes:{y:{type:Mx.NUMBER,position:Ix.LEFT},x:{type:Mx.ORDINAL_TIME,position:Ix.BOTTOM}},axisKeys:{[Lx.X]:"xKeyAxis",[Lx.Y]:"yKeyAxis"},themeTemplate:NP,create:e=>new pp(e)};import{CartesianChartModule as TP,VERSION as wP}from"ag-charts-community";import{CARTESIAN_AXIS_TYPE as Wx,CARTESIAN_POSITION as Kx,ChartAxisDirection as Gx}from"ag-charts-core";import{_ModuleSupport as gp}from"ag-charts-community";import{ChartAxisDirection as fi,Logger as PP,extent as OP,formatValue as RP,mergeDefaults as $x,toPlainText as EP}from"ag-charts-core";import{Logger as _P,cachedTextMeasurer as jl,findMaxValue as Yx,wrapLines as Ux}from"ag-charts-core";function BP(e,t){const{fontSize:i,minimumFontSize:o=i}=e,{fontSize:s,minimumFontSize:a=s}=t,n=i-o,r=s-a;let l=e.fontSize,c=t.fontSize;const h=[{labelFontSize:i,secondaryLabelFontSize:s}];for(;l>o||c>a;){const d=n>0?(l-o)/n:-1,u=r>0?(c-a)/r:-1;d>u?l--:c--,h.push({labelFontSize:l,secondaryLabelFontSize:c})}return h.reverse(),h}function jx(e,t,i,o,{padding:s},a){const{spacing:n=0}=t,r=2*s,l=2*s+n,c=(t.minimumFontSize??t.fontSize)+(o.minimumFontSize??o.fontSize);if(c>a(c+l,!1).height-l)return;const h=BP(t,o),d={fontFamily:t.fontFamily,fontStyle:t.fontStyle,fontWeight:t.fontWeight},u={fontFamily:o.fontFamily,fontStyle:o.fontStyle,fontWeight:o.fontWeight};let g,m;return Yx(0,h.length-1,y=>{const{labelFontSize:S,secondaryLabelFontSize:x}=h[y],b=y===0,f={...d,fontSize:S},v={...u,fontSize:x},k=jl(f).lineHeight(),A=jl(v).lineHeight(),M=a(k+A+l,b),I=M.width-r,D=M.height-l;if(k+A>D||((g==null||g.fontSize!==S)&&(g=Zx(t,e,I,D,f,t.wrapping,b?t.overflowStrategy:"hide")),g==null||g.width>I||g.height>D)||((m==null||m.fontSize!==x)&&(m=Zx(o,i,I,D,v,o.wrapping,b?o.overflowStrategy:"hide")),m==null))return;const L=g.height+m.height;if(!(m.width>I||L>D))return{width:Math.max(g.width,m.width),height:L+n,meta:M.meta,label:g,secondaryLabel:m}})}function Jn(e,t,{padding:i},o){const s=2*i,a=Math.min(t.minimumFontSize??t.fontSize,t.fontSize),n={fontFamily:t.fontFamily,fontStyle:t.fontStyle,fontWeight:t.fontWeight};return Yx(a,t.fontSize,r=>{const l={...n,fontSize:r},c=jl(l),h=r===a,d=t.lineHeight??c.lineHeight(),u=o(d+s,h),g=u.width-s,m=u.height-s;if(d>m||g<0)return;const y=Ux(e,{maxWidth:g,maxHeight:m,font:l,textWrap:t.wrapping,overflow:(h?t.overflowStrategy:null)??"hide"});if(!y.length)return;const{width:S,height:x}=c.measureLines(y),b=y.join(`
`);return[{width:S,height:x,text:b,fontSize:r,lineHeight:d},u.meta]})}function Xx(e){return e?.minimumFontSize!=null&&e?.fontSize!=null&&e?.minimumFontSize>e?.fontSize}function mp(e,t,i,o,s,a){const n=t.enabled?e:void 0,r=o.enabled?i:void 0;(Xx(t)||Xx(o))&&_P.warnOnce("minimumFontSize should be set to a value less than or equal to the font size");let l;n!=null&&r!=null&&(l=jx(n,t,r,o,s,a));let c;if(l==null&&n!=null&&(c=Jn(n,t,s,a)),c!=null){const[d,u]=c;l={width:d.width,height:d.height,meta:u,label:d,secondaryLabel:void 0}}let h;if(l==null&&n==null&&r!=null&&(h=Jn(r,o,s,a)),h!=null){const[d,u]=h;l={width:d.width,height:d.height,meta:u,label:void 0,secondaryLabel:d}}return l}function Zx(e,t,i,o,s,a,n){const r=Ux(t,{maxWidth:i,maxHeight:o,font:s,textWrap:a,overflow:n});if(!r.length)return;const l=jl(s),c=e.lineHeight??l.lineHeight(),{width:h}=l.measureLines(r);return{width:h,lineHeight:c,text:r.join(`
`),height:r.length*c,fontSize:s.fontSize}}import{_ModuleSupport as VP}from"ag-charts-community";import{Property as ht}from"ag-charts-core";import{_ModuleSupport as zP}from"ag-charts-community";import{Property as er}from"ag-charts-core";var Wa=class extends zP.Label{constructor(){super(...arguments),this.wrapping="on-space",this.overflowStrategy="ellipsis"}};p([er],Wa.prototype,"wrapping",2),p([er],Wa.prototype,"overflowStrategy",2),p([er],Wa.prototype,"lineHeight",2),p([er],Wa.prototype,"minimumFontSize",2);var Ka=class extends Wa{constructor(){super(...arguments),this.spacing=0}};p([er],Ka.prototype,"spacing",2);var Xl=class extends Wa{},{CartesianSeriesProperties:FP,makeSeriesTooltip:HP}=VP,Je=class extends FP{constructor(){super(...arguments),this.colorRange=["black","black"],this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.textAlign="center",this.verticalAlign="middle",this.itemPadding=0,this.label=new Ka,this.tooltip=HP()}};p([ht],Je.prototype,"title",2),p([ht],Je.prototype,"xKey",2),p([ht],Je.prototype,"yKey",2),p([ht],Je.prototype,"colorKey",2),p([ht],Je.prototype,"xName",2),p([ht],Je.prototype,"yName",2),p([ht],Je.prototype,"colorName",2),p([ht],Je.prototype,"colorRange",2),p([ht],Je.prototype,"stroke",2),p([ht],Je.prototype,"strokeOpacity",2),p([ht],Je.prototype,"strokeWidth",2),p([ht],Je.prototype,"textAlign",2),p([ht],Je.prototype,"verticalAlign",2),p([ht],Je.prototype,"itemPadding",2),p([ht],Je.prototype,"itemStyler",2),p([ht],Je.prototype,"label",2),p([ht],Je.prototype,"tooltip",2);var{SeriesNodePickMode:qx,computeBarFocusBounds:WP,getMissCount:KP,valueProperty:yp,DEFAULT_CARTESIAN_DIRECTION_KEYS:GP,DEFAULT_CARTESIAN_DIRECTION_NAMES:$P,createDatumId:YP,ColorScale:UP,Rect:jP,PointerEvents:XP,addHitTestersToQuadtree:ZP,findQuadtreeMatch:Qx,updateLabelNode:qP}=gp,QP=class extends gp.CartesianSeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.colorKey=o.properties.colorKey}},JP={left:-.5,center:0,right:-.5},eO={top:-.5,middle:0,bottom:-.5},fp=class extends gp.CartesianSeries{constructor(e){super({moduleCtx:e,propertyKeys:{...GP,color:["colorKey"]},propertyNames:{...$P,color:["colorName"]},categoryKey:void 0,pickModes:[qx.NEAREST_NODE,qx.EXACT_SHAPE_MATCH],pathsPerSeries:[]}),this.properties=new Je,this.NodeEvent=QP,this.colorScale=new UP}async processData(e){const t=this.axes[fi.X],i=this.axes[fi.Y];if(!t||!i)return;const{xKey:o,yKey:s,colorRange:a,colorKey:n}=this.properties,r=this.axes[fi.X]?.scale,l=this.axes[fi.Y]?.scale,{xScaleType:c,yScaleType:h}=this.getScaleInformation({xScale:r,yScale:l}),d=this.colorScale.type,{dataModel:u,processedData:g}=await this.requestDataModel(e,this.data,{props:[yp(o,c,{id:"xValue"}),yp(s,h,{id:"yValue"}),...n?[yp(n,d,{id:"colorValue",invalidValue:void 0})]:[]]});if(this.isColorScaleValid()){const m=u.resolveProcessedDataIndexById(this,"colorValue"),y=g.domain.values[m].filter(x=>x!=null),S=OP(y);if(this.colorScale.domain=S??[],S?.length&&S[0]===S[1]){const x=Math.floor(a.length/2);this.colorScale.range=[a[x],a[x]]}else this.colorScale.range=a;this.colorScale.update()}}isColorScaleValid(){const{colorKey:e}=this.properties;if(!e)return!1;const{dataModel:t,processedData:i}=this;if(!t||!i)return!1;const o=t.resolveProcessedDataIndexById(this,"colorValue"),s=i.input.count,a=KP(this,i.defs.values[o].missing),n=t.resolveProcessedDataIndexById(this,"colorValue"),r=i.domain.values[n].filter(c=>c!=null).length;return!(s===0||s===a||r===0)}xCoordinateRange(e,t){const i=this.axes[fi.X].scale,o=t*(i.bandwidth??0)/2,s=i.convert(e)+o,a=t*(i.bandwidth??10);return[s,s+a]}yCoordinateRange(e,t){const i=this.axes[fi.Y].scale,o=t*(i.bandwidth??0)/2,s=i.convert(e[0])+o,a=t*(i.bandwidth??10);return[s,s+a]}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;return!t||!i?{domain:[]}:e===fi.X?{domain:t.getDomain(this,"xValue","value",i).domain}:{domain:t.getDomain(this,"yValue","value",i).domain}}getSeriesRange(){return[Number.NaN,Number.NaN]}createNodeData(){const{data:e,visible:t,axes:i,dataModel:o,processedData:s}=this,a=i[fi.X],n=i[fi.Y];if(!(e&&t&&a&&n))return;if(!o||!s)return{itemId:this.properties.yKey??this.id,nodeData:[],labelData:[],scales:this.calculateScaling(),visible:this.visible};if(a.type!=="category"||n.type!=="category"){PP.warnOnce(`Heatmap series expected axes to have "category" type, but received "${a.type}" and "${n.type}" instead.`);return}const{xKey:r,xName:l,yKey:c,yName:h,colorKey:d,colorName:u,textAlign:g,verticalAlign:m,itemPadding:y,label:S}=this.properties,x=o.resolveColumnById(this,"xValue",s),b=o.resolveColumnById(this,"yValue",s),f=d?o.resolveColumnById(this,"colorValue",s):void 0,v=d?o.getDomain(this,"colorValue","value",s).domain:[],k=a.scale,A=n.scale,M=(k.bandwidth??0)/2,I=(A.bandwidth??0)/2,D=[],L=[],N=k.bandwidth??10,T=A.bandwidth??10,O=(N-2*y)*JP[g],R=(T-2*y)*eO[m],w=()=>({width:N,height:T,meta:null}),E=s.dataSources.get(this.id)?.data??[];for(const[B,P]of E.entries()){const C=x[B],_=b[B],V=k.convert(C)+M,z=A.convert(_)+I,F=f?.[B],G=S.enabled&&F!=null?this.getLabelText(F,P,d,"color",v,S,{value:F,datum:P,colorKey:d,colorName:u,xKey:r,yKey:c,xName:l,yName:h}):void 0,Y=mp(EP(G),this.properties.label,void 0,this.properties.label,{padding:y},w),K={x:V,y:z,size:0},U=this.getItemStyle({datumIndex:B,datum:P,colorValue:F},!1);if(D.push({series:this,itemId:c,datumIndex:B,yKey:c,xKey:r,xValue:C,yValue:_,colorValue:F,datum:P,point:K,width:N,height:T,midPoint:{x:V,y:z},missing:f!=null&&F==null,style:U}),Y?.label!=null){const{text:ee,fontSize:re,lineHeight:ye,height:le}=Y.label,{fontStyle:ie,fontFamily:ce,fontWeight:pe,color:he}=this.properties.label,Q=K.x+O*(N-2*y),Ne=K.y+R*(T-2*y)-(Y.height-le)*.5;L.push({series:this,itemId:c,datum:P,datumIndex:B,text:ee,fontSize:re,lineHeight:ye,fontStyle:ie,fontFamily:ce,fontWeight:pe,color:he,textAlign:g,textBaseline:m,x:Q,y:Ne,style:U})}}return{itemId:this.properties.yKey??this.id,nodeData:D,labelData:L,scales:this.calculateScaling(),visible:this.visible}}nodeFactory(){return new jP}update(e){return this.ctx.animationManager.skipCurrentBatch(),super.update(e)}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e,o=t??[];return i.update(o)}getItemStyle({datumIndex:e,datum:t,colorValue:i},o,s){const{properties:a}=this,{itemStyler:n,stroke:r,strokeWidth:l,strokeOpacity:c}=a,h=this.getHighlightStyle(o,e,s),d=$x(h,{fill:this.isColorScaleValid()&&i!=null?this.colorScale.convert(i):"transparent",fillOpacity:1,stroke:r,strokeWidth:l,strokeOpacity:c,opacity:1});let u;return n!=null&&e!=null&&(u=this.cachedDatumCallback(YP(e,o?"highlight":"node"),()=>{const g=this.makeItemStylerParams(t,e,o,d);return this.callWithContext(n,g)})),u?$x(u,d):d}makeItemStylerParams(e,t,i,o){const{id:s,properties:a}=this,{xKey:n,yKey:r}=a,l=this.ctx.highlightManager?.getActiveHighlight(),c=this.getHighlightStateString(l,i,t),h=this.filterItemStylerFillParams(o.fill)??o.fill;return{seriesId:s,datum:e,xKey:n,yKey:r,highlightState:c,...o,fill:h}}updateDatumStyles({datumSelection:e,isHighlight:t}){const i=this.ctx.highlightManager?.getActiveHighlight();e.each((o,s)=>{const a=this.getHighlightState(i,t,s.datumIndex);s.style=this.getItemStyle(s,t,a)})}updateDatumNodes({datumSelection:e}){const t=this.axes[fi.X],[i,o]=t?.visibleRange??[],a=!(i!==0||o!==1);e.each((n,r)=>{const{point:l,width:c,height:h,style:d}=r;n.setStyleProperties(d),n.crisp=a,n.x=Math.floor(l.x-c/2),n.y=Math.floor(l.y-h/2),n.width=Math.ceil(c),n.height=Math.ceil(h)})}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e,{enabled:o}=this.properties.label,s=o?t:[];return i.update(s)}updateLabelNodes(e){const{isHighlight:t=!1}=e,i=this.ctx.highlightManager?.getActiveHighlight();e.labelSelection.each((o,s)=>{o.pointerEvents=XP.None,o.text=s.text,o.fillOpacity=this.getHighlightStyle(t,s.datumIndex)?.opacity??1,qP(this,o,this.properties,this.properties.label,s,t,i)})}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,axes:s,properties:a,colorScale:n,ctx:r}=this,{formatManager:l}=r,{xKey:c,xName:h,yKey:d,yName:u,colorKey:g,colorName:m,colorRange:y,title:S,legendItemName:x,tooltip:b}=a,f=s[fi.X],v=s[fi.Y];if(!i||!o||!f||!v)return;const k=o.dataSources.get(this.id)?.data[e],A=i.resolveColumnById(this,"xValue",o)[e],M=i.resolveColumnById(this,"yValue",o)[e],I=g!=null&&this.isColorScaleValid()?i.resolveColumnById(this,"colorValue",o)[e]:void 0;if(A==null)return;const D=[];let L;if(I==null)L=y[0];else{L=n.convert(I);const O=i.getDomain(this,"colorValue","value",o).domain,R=l.format(this.callWithContext.bind(this),{type:"number",value:I,datum:k,seriesId:t,legendItemName:x,key:g,source:"tooltip",property:"color",domain:O,boundSeries:this.getFormatterContext("color"),fractionDigits:void 0});D.push({label:m,fallbackLabel:g,value:R??RP(I)})}D.push({label:h,fallbackLabel:c,value:this.getAxisValueText(f,"tooltip",A,k,c,x)},{label:u,fallbackLabel:d,value:this.getAxisValueText(v,"tooltip",M,k,d,x)});const N=this.getItemStyle({datumIndex:e,datum:k,colorValue:I},!1);N.fill!=null&&(L=N.fill);const T=L==null?void 0:{marker:{shape:"square",fill:L,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0}};return this.formatTooltipWithContext(b,{title:S??x,symbol:T,data:D},{seriesId:t,datum:k,title:S,xKey:c,xName:h,yKey:d,yName:u,colorKey:g,colorName:m,...N})}getLegendData(e){return e!=="gradient"||!this.isColorScaleValid()||!this.dataModel?[]:[{legendType:"gradient",enabled:this.visible,seriesId:this.id,series:this.getFormatterContext("color"),colorDomain:this.colorScale.domain,colorRange:this.colorScale.range}]}isLabelEnabled(){return this.properties.label.enabled&&!!this.properties.colorKey}getBandScalePadding(){return{inner:0,outer:0}}computeFocusBounds({datumIndex:e}){const t=this.contextNodeData?.nodeData[e];if(t===void 0)return;const{width:i,height:o,midPoint:s}=t,a={x:s.x-i/2,y:s.y-o/2,width:i,height:o};return WP(this,a)}initQuadTree(e){ZP(e,this.datumNodesIter())}pickNodesExactShape(e){const t=Qx(this,e);return t!=null&&t.distance<=0?[t.datum]:[]}pickNodeClosestDatum(e){return Qx(this,e)}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.label.itemStyler!=null||this.isColorScaleValid()}};fp.className="HeatmapSeries",fp.type="heatmap";import{_ModuleSupport as tO}from"ag-charts-community";import{arrayOf as iO,color as oO,commonSeriesOptionsDefs as sO,constant as aO,required as xp,string as ss,without as Jx}from"ag-charts-core";var{heatmapSeriesThemeableOptionsDef:nO}=tO,rO={...Jx(nO,["showInLegend"]),...Jx(sO,["showInLegend"]),type:xp(aO("heatmap")),xKey:xp(ss),yKey:xp(ss),xKeyAxis:ss,yKeyAxis:ss,colorKey:ss,xName:ss,yName:ss,colorName:ss,colorRange:iO(oO)};import{_ModuleSupport as eS}from"ag-charts-community";var tS={series:{stroke:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$ref:"chartBackgroundColor"},{$path:["/0",{$palette:"stroke"},{$palette:"strokes"}]}]},strokeWidth:{$isUserOption:["./stroke",2,void 0]},label:{...eS.LABEL_BOXING_DEFAULTS,enabled:!1,color:{$ref:"textColor"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},wrapping:"on-space",overflowStrategy:"ellipsis"},itemPadding:3,highlight:{unhighlightedItem:{opacity:.6}}},gradientLegend:{enabled:!0}};tS.series.colorRange={$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"divergingColors"},eS.SAFE_RANGE2_OPERATION]};var Sp={type:"series",name:"heatmap",chartType:"cartesian",enterprise:!0,version:wP,dependencies:[TP],options:rO,defaultAxes:{y:{type:Wx.CATEGORY,position:Kx.LEFT},x:{type:Wx.CATEGORY,position:Kx.BOTTOM}},axisKeys:{[Gx.X]:"xKeyAxis",[Gx.Y]:"yKeyAxis"},themeTemplate:tS,create:e=>new fp(e)};import{CartesianChartModule as lO,VERSION as cO,_ModuleSupport as hO}from"ag-charts-community";import{CARTESIAN_AXIS_TYPE as Zl,CARTESIAN_POSITION as iS,ChartAxisDirection as oS}from"ag-charts-core";import"ag-charts-community";var bp=class extends Bx{constructor(){super(...arguments),this.properties=new $l}nodeFactory(){const e=new Px;return e.lineCap="square",e}updateDatumStyles({datumSelection:e,isHighlight:t}){e.each((i,o)=>{o.style=this.getItemStyle(o.datumIndex,t,void 0,o.itemType)})}updateDatumNodes({datumSelection:e,isHighlight:t}){const{contextNodeData:i,properties:o}=this;if(!i)return;const s=this.ctx.highlightManager.getActiveHighlight(),{up:a,down:n}=o.item,r=this;e.each(function(c,h){const{centerX:d,width:u,y:g,height:m,yOpen:y,yClose:S,crisp:x}=h,b=h.isRising?a:n;c.setStaticProperties(d,u,g,m,y,S,x);const f=h.style??i.styles[h.itemType][r.getHighlightState(s,t,h.datumIndex)];c.setStyleProperties(f),c.strokeAlignment=b.strokeWidth})}getLegendData(e){const{id:t,data:i,ctx:{legendManager:o},visible:s}=this,{xKey:a,yName:n,item:{up:r,down:l},showInLegend:c,legendItemName:h}=this.properties;if(!i?.data.length||!a||e!=="category")return[];const d={type:"gradient",gradient:"linear",colorSpace:"rgb",colorStops:[{color:r.stroke,stop:0},{color:r.stroke,stop:.5},{color:l.stroke,stop:.5}],rotation:90};return[{legendType:"category",id:t,itemId:t,seriesId:t,enabled:s&&o.getItemEnabled({seriesId:t,itemId:t}),label:{text:h??n??t},symbol:{marker:{fill:d,fillOpacity:r.strokeOpacity,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0}},legendItemName:h,hideInLegend:!c}]}hasItemStylers(){return this.properties.itemStyler!=null}};bp.className="ohlc",bp.type="ohlc";import{_ModuleSupport as dO}from"ag-charts-community";import{boolean as pO,commonSeriesOptionsDefs as uO,constant as gO,number as mO,required as Ga,string as qt,undocumented as sS}from"ag-charts-core";var{ohlcSeriesThemeableOptionsDef:yO}=dO,vp={...uO,...yO,type:Ga(gO("ohlc")),xKey:Ga(qt),openKey:Ga(qt),highKey:Ga(qt),lowKey:Ga(qt),closeKey:Ga(qt),xKeyAxis:qt,yKeyAxis:qt,xName:qt,yName:qt,openName:qt,highName:qt,lowName:qt,closeName:qt};vp.pickOutsideVisibleMinorAxis=sS(pO),vp.focusPriority=sS(mO);var{multiSeriesHighlightStyle:fO,predictCartesianFinancialAxis:xO}=hO,SO={animation:{enabled:!1},series:{item:{up:{stroke:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$palette:"stroke"},{$palette:"up.stroke"}]}},down:{stroke:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$palette:"stroke"},{$palette:"down.stroke"}]}}},tooltip:{range:{$path:["/tooltip/range","nearest"]}},highlight:fO()},axes:{[Zl.NUMBER]:{crosshair:{snap:!1}},[Zl.ORDINAL_TIME]:{groupPaddingInner:0,crosshair:{enabled:!0}}}},ql={type:"series",name:"ohlc",chartType:"cartesian",enterprise:!0,version:cO,dependencies:[lO],options:vp,predictAxis:xO,defaultAxes:{y:{type:Zl.NUMBER,position:iS.LEFT},x:{type:Zl.ORDINAL_TIME,position:iS.BOTTOM}},axisKeys:{[oS.X]:"xKeyAxis",[oS.Y]:"yKeyAxis"},themeTemplate:SO,create:e=>new bp(e)};import{CartesianChartModule as bO,VERSION as vO,_ModuleSupport as kO}from"ag-charts-community";import{CARTESIAN_AXIS_TYPE as aS,CARTESIAN_POSITION as nS,ChartAxisDirection as rS}from"ag-charts-core";import{_ModuleSupport as $a}from"ag-charts-community";import{AGGREGATION_INDEX_UNSET as lS,AGGREGATION_INDEX_Y_MAX as DO,AGGREGATION_INDEX_Y_MIN as AO,AGGREGATION_SPAN as MO,ChartAxisDirection as Ge,DebugMetrics as IO,extent as LO,findMinMax as NO,mergeDefaults as CO}from"ag-charts-core";import"ag-charts-community";import{aggregationDomain as kp,computeExtremesAggregation as cS,computeExtremesAggregationPartial as TO,simpleMemorize2 as wO}from"ag-charts-core";function PO(e,t,i,o,s,a,n,r){const[l,c]=kp(e,s);return cS([l,c],t,i,o,{smallestKeyInterval:a,xNeedsValueOf:n,yNeedsValueOf:r})}var OO=wO(PO);function RO(e,t,i,o,s){const a=t.resolveKeysById(o,"xValue",i),n=t.resolveColumnById(o,"yHighValue",i),r=t.resolveColumnById(o,"yLowValue",i),l=t.getDomain(o,"xValue","key",i),c=t.resolveColumnNeedsValueOf(o,"xValue",i),h=t.resolveColumnNeedsValueOf(o,"yHighValue",i)??t.resolveColumnNeedsValueOf(o,"yLowValue",i);if(s){const[d,u]=kp(e,l);return cS([d,u],a,n,r,{smallestKeyInterval:i.reduced?.smallestKeyInterval,xNeedsValueOf:c,yNeedsValueOf:h,existingFilters:s})}return OO(e,a,n,r,l,i.reduced?.smallestKeyInterval,c,h)}function EO(e,t,i,o,s,a){const n=t.resolveKeysById(o,"xValue",i),r=t.resolveColumnById(o,"yHighValue",i),l=t.resolveColumnById(o,"yLowValue",i),c=t.getDomain(o,"xValue","key",i),h=t.resolveColumnNeedsValueOf(o,"xValue",i),d=t.resolveColumnNeedsValueOf(o,"yHighValue",i)??t.resolveColumnNeedsValueOf(o,"yLowValue",i),[u,g]=kp(e,c);return TO([u,g],n,r,l,{smallestKeyInterval:i.reduced?.smallestKeyInterval,targetRange:s,xNeedsValueOf:h,yNeedsValueOf:d,existingFilters:a})}import"ag-charts-community";import{spanRange as _O}from"ag-charts-core";function hS({span:e},t){switch(e.type){case"linear":case"step":case"multi-line":{const i=(t-e.x0)/(e.x1-e.x0);return e.y0+i*(e.y1-e.y0)}case"cubic":{const{cp0x:i,cp0y:o,cp1x:s,cp1y:a,cp2x:n,cp2y:r,cp3x:l,cp3y:c}=e;let h=.5;const d=1e-6;for(let g=0;g<10;g++){const m=1-h,S=m*m*m*i+3*m*m*h*s+3*m*h*h*n+h*h*h*l-t;if(Math.abs(S)<d)break;const x=3*m*m*(s-i)+6*m*h*(n-s)+3*h*h*(l-n);if(Math.abs(x)<1e-12)break;h=h-S/x,h=Math.max(0,Math.min(1,h))}const u=1-h;return u*u*u*o+3*u*u*h*a+3*u*h*h*r+h*h*h*c}}}function dS(e,t,i=0){for(let o=i;o<e.length;o++){const s=e[o],[a,n]=_O(s.span);if(t>=a.x&&t<=n.x)return{span:s,index:o};if(t<a.x)break}return{span:null,index:i}}function BO(e,t,i,o,s){const a=dS(e,i,s),n=dS(t,i,s);if(!a.span||!n.span)return{intersection:null,spanIndex:a.index,isInverted:o};const r=hS(a.span,i),l=hS(n.span,i),c=r>l;return{intersection:o===c?null:{x:i,y:r},spanIndex:a.index,isInverted:c}}function VO(e,t,i,o,s=!1){if(e.length===0||t.length===0)return[];const a=[];let n=s,r=0;for(let l=i;l<=o;l+=.5){const c=BO(e,t,l,n,r);c.intersection&&a.push(c.intersection.x),r=c.spanIndex,n=c.isInverted}return a}function zO(e,t,i,o,s={}){const a=Math.max(t.x,i.width-(t.x+t.width)),n=Math.max(t.y,i.height-(t.y+t.height)),r=[],l=(h,d)=>({x0:h,y0:-n,x1:d,y1:t.height+n});o&&r.push({clipRect:l(-a,e[0]??t.width+a),...s});const c=o?1:0;for(let h=c;h<e.length;h+=2)r.push({clipRect:l(e[h],e[h+1]??t.width+a),...s});return r}import{_ModuleSupport as FO}from"ag-charts-community";import{BaseProperties as Dp,InterpolationProperties as HO,Property as j}from"ag-charts-core";var{CartesianSeriesProperties:WO,SeriesMarker:KO,makeSeriesTooltip:GO,DropShadow:$O,Label:YO}=FO,Ap=class extends YO{constructor(){super(...arguments),this.placement="outside",this.spacing=0}};p([j],Ap.prototype,"placement",2),p([j],Ap.prototype,"spacing",2);var Ql=class{constructor(){this.enabled=!1,this.fillOpacity=1}};p([j],Ql.prototype,"enabled",2),p([j],Ql.prototype,"fill",2),p([j],Ql.prototype,"fillOpacity",2);var as=class extends Dp{constructor(){super(...arguments),this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.marker=new KO}};p([j],as.prototype,"stroke",2),p([j],as.prototype,"strokeWidth",2),p([j],as.prototype,"strokeOpacity",2),p([j],as.prototype,"lineDash",2),p([j],as.prototype,"lineDashOffset",2),p([j],as.prototype,"marker",2);var Mp=class extends Dp{constructor(){super(...arguments),this.low=new as,this.high=new as}};p([j],Mp.prototype,"low",2),p([j],Mp.prototype,"high",2);var xi=class extends Dp{};p([j],xi.prototype,"enabled",2),p([j],xi.prototype,"shape",2),p([j],xi.prototype,"size",2),p([j],xi.prototype,"fill",2),p([j],xi.prototype,"fillOpacity",2),p([j],xi.prototype,"stroke",2),p([j],xi.prototype,"strokeWidth",2),p([j],xi.prototype,"strokeOpacity",2),p([j],xi.prototype,"lineDash",2),p([j],xi.prototype,"lineDashOffset",2),p([j],xi.prototype,"itemStyler",2);var xe=class extends WO{constructor(){super(...arguments),this.fill="#99CCFF",this.fillOpacity=1,this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.interpolation=new HO,this.item=new Mp,this.invertedStyle=new Ql,this.shadow=new $O().set({enabled:!1}),this.marker=new xi,this.label=new Ap,this.tooltip=GO(),this.connectMissingData=!1}};p([j],xe.prototype,"xKey",2),p([j],xe.prototype,"yLowKey",2),p([j],xe.prototype,"yHighKey",2),p([j],xe.prototype,"xName",2),p([j],xe.prototype,"yName",2),p([j],xe.prototype,"yLowName",2),p([j],xe.prototype,"yHighName",2),p([j],xe.prototype,"fill",2),p([j],xe.prototype,"fillOpacity",2),p([j],xe.prototype,"stroke",2),p([j],xe.prototype,"strokeWidth",2),p([j],xe.prototype,"strokeOpacity",2),p([j],xe.prototype,"lineDash",2),p([j],xe.prototype,"lineDashOffset",2),p([j],xe.prototype,"interpolation",2),p([j],xe.prototype,"styler",2),p([j],xe.prototype,"item",2),p([j],xe.prototype,"invertedStyle",2),p([j],xe.prototype,"shadow",2),p([j],xe.prototype,"marker",2),p([j],xe.prototype,"label",2),p([j],xe.prototype,"tooltip",2),p([j],xe.prototype,"connectMissingData",2);import{_ModuleSupport as UO}from"ag-charts-community";import{areScalingEqual as pS,isScaleValid as uS}from"ag-charts-core";var{CollapseMode:Jl,pairUpSpans:ec,prepareAreaFillAnimationFns:jO,plotInterpolatedLinePathStroke:Ya,prepareLinePathPropertyAnimation:XO}=UO;function ZO(e,t,i,o){const s=(l,c)=>{Ya(l,c,t.removed),Ya(l,c,i.removed)},a=(l,c)=>{Ya(l,c,t.moved),Ya(l,c,i.moved)},n=(l,c)=>{Ya(l,c,t.added),Ya(l,c,i.added)},r=XO(e,o);return{status:e,path:{addPhaseFn:n,updatePhaseFn:a,removePhaseFn:s},pathProperties:r}}function qO(e,t,i){const o=e.scales.x?.type==="category",s=t.scales.x?.type==="category";if(o!==s||!uS(e.scales.x)||!uS(t.scales.x))return;let a="updated";t.visible&&!e.visible?a="removed":!t.visible&&e.visible&&(a="added");const n=ec({scales:e.scales,data:e.fillData.spans},{scales:t.scales,data:t.fillData.spans},Jl.Split);if(n==null)return;const r=ec({scales:e.scales,data:e.fillData.phantomSpans},{scales:t.scales,data:t.fillData.phantomSpans},Jl.Split);if(r==null)return;const l=ec({scales:e.scales,data:e.highStrokeData.spans},{scales:t.scales,data:t.highStrokeData.spans},Jl.Split);if(l==null)return;const c=ec({scales:e.scales,data:e.lowStrokeData.spans},{scales:t.scales,data:t.lowStrokeData.spans},Jl.Split);if(c==null)return;const h="fade",d=jO(a,n,r,h),u=ZO(a,l,c,h),g=(i?.changed??!0)||!pS(e.scales.x,t.scales.x)||!pS(e.scales.y,t.scales.y)||a!=="updated";return{status:a,fill:d,stroke:u,hasMotion:g}}var QO=DO,JO=AO,eR=MO,{valueProperty:gS,keyProperty:tR,updateLabelNode:iR,fixNumericExtent:mS,buildResetPathFn:oR,resetLabelFn:sR,resetMarkerFn:aR,resetMarkerPositionFn:yS,pathSwipeInAnimation:nR,resetMotion:rR,markerSwipeScaleInAnimation:lR,seriesLabelFadeInAnimation:Ip,animationValidation:cR,diff:hR,updateClipPath:Lp,computeMarkerFocusBounds:fS,plotAreaPathFill:dR,plotLinePathStroke:xS,interpolatePoints:SS,pathFadeInAnimation:Np,markerFadeInAnimation:bS,fromToMotion:Cp,pathMotion:Tp,PointerEvents:tc,Marker:pR,BBox:uR,processedDataIsAnimatable:wp,markerEnabled:gR,getMarkerStyles:mR,calculateSegments:yR,toHighlightString:fR,HighlightState:xR,AggregationManager:SR,resetMarkerSelectionsDirect:bR,createDatumId:vR,visibleRangeIndices:vS}=$a,kR=class extends $a.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.xKey=o.properties.xKey,this.yLowKey=o.properties.yLowKey,this.yHighKey=o.properties.yHighKey}},DR=$a.CartesianSeries,Pp=class extends DR{constructor(e){super({moduleCtx:e,pathsPerSeries:["fill","lowStroke","highStroke"],pickModes:[$a.SeriesNodePickMode.AXIS_ALIGNED],propertyKeys:{[Ge.X]:["xKey"],[Ge.Y]:["yLowKey","yHighKey"]},propertyNames:{[Ge.X]:["xName"],[Ge.Y]:["yLowName","yHighName","yName"]},categoryKey:"xValue",animationResetFns:{path:oR({getVisible:()=>this.visible,getOpacity:()=>this.getOpacity()}),label:sR,datum:(t,i)=>({...aR(t),...yS(t,i)})},clipFocusBox:!1}),this.properties=new xe,this.NodeEvent=kR,this.aggregationManager=new SR}async processData(e){const{xKey:t,yLowKey:i,yHighKey:o}=this.properties,s=this.axes[Ge.X]?.scale,a=this.axes[Ge.Y]?.scale,{xScaleType:n,yScaleType:r}=this.getScaleInformation({xScale:s,yScale:a}),l=[],c=!this.ctx.animationManager.isSkipped();this.needsDataModelDiff()&&this.processedData&&l.push(hR(this.id,this.processedData)),c&&l.push(cR());const{dataModel:h,processedData:d}=await this.requestDataModel(e,this.data,{props:[tR(t,n,{id:"xValue"}),gS(i,r,{id:"yLowValue"}),gS(o,r,{id:"yHighValue"}),...l]});this.aggregateData(h,d),this.animationState.transition("updateData")}aggregateData(e,t){if(this.aggregationManager.markStale(),t.type!=="ungrouped"||wp(t))return;const i=this.axes[Ge.X];if(i==null)return;const o=this.estimateTargetRange();this.aggregationManager.aggregate({computePartial:a=>EO(i.scale.type,e,t,this,o,a),computeFull:a=>RO(i.scale.type,e,t,this,a),targetRange:o});const s=this.aggregationManager.filters;s&&s.length>0&&IO.record(`${this.type}:aggregation`,s.map(a=>a.maxRange))}estimateTargetRange(){const e=this.axes[Ge.X];if(e?.scale?.range){const[t,i]=e.scale.range;return Math.abs(i-t)}return this.ctx.scene?.canvas?.width??800}createNodeDatumContext(e,t,i){const{dataModel:o,processedData:s}=this;if(!o||!s)return;const a=s.dataSources.get(this.id)?.data??[],[n,r]=e.range,l=Math.abs(r-n);this.aggregationManager.ensureLevelForRange(l);const c=this.aggregationManager.getFilterForRange(l),h=this.contextNodeData?.nodeData,d=h!=null&&(s.changeDescription!=null||!wp(s)||c!=null);return{rawData:a,xValues:o.resolveKeysById(this,"xValue",s),yHighValues:o.resolveColumnById(this,"yHighValue",s),yLowValues:o.resolveColumnById(this,"yLowValue",s),xScale:e,yScale:t,xAxisRange:i,xOffset:(e.bandwidth??0)/2,dataAggregationFilter:c,range:l,labelsEnabled:this.properties.label.enabled,canIncrementallyUpdate:d,xKey:this.properties.xKey,yLowKey:this.properties.yLowKey,yHighKey:this.properties.yHighKey,item:this.properties.item,yDomain:this.getSeriesDomain(Ge.Y).domain,connectMissingData:this.properties.connectMissingData,interpolation:this.properties.interpolation,markerData:d?h:[],labelData:[],spanPoints:[],nodeIndex:0}}xCoordinateRange(e){const t=this.axes[Ge.X].scale.convert(e);return[t,t]}yCoordinateRange(e){const t=this.axes[Ge.Y].scale.convert(e[0]);return[t,t]}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!(t&&i))return{domain:[]};const{domain:{keys:[o]}}=t;if(e===Ge.X){const s=i.resolveProcessedDataDefById(this,"xValue");if(s?.def.type==="key"&&s.def.valueType==="category"){const a=i.getKeySortMetadata(this,"xValue",t);return{domain:o,sortMetadata:a}}return{domain:mS(LO(o))}}else{const s=this.domainForClippedRange(Ge.Y,["yHighValue","yLowValue"],"xValue"),a=NO(s);return{domain:mS(a)}}}getSeriesRange(e,t){return this.domainForVisibleRange(Ge.Y,["yHighValue","yLowValue"],"xValue",t)}handleDatumPoint(e,t,i,o,s){if(t.xValue=e.xValues[i],t.xValue==null)return;t.datum=e.rawData[i],t.yHighValue=o??e.yHighValues[i],t.yLowValue=s??e.yLowValues[i];const a=e.spanPoints.at(-1);if(Number.isFinite(t.yHighValue)&&Number.isFinite(t.yLowValue)){t.inverted=t.yLowValue>t.yHighValue,t.x=e.xScale.convert(t.xValue)+e.xOffset,t.yHighCoordinate=e.yScale.convert(t.yHighValue),t.yLowCoordinate=e.yScale.convert(t.yLowValue),this.upsertMarkerDatum(e,t,i,"high",t.yHighValue,t.yHighCoordinate),this.upsertMarkerDatum(e,t,i,"low",t.yLowValue,t.yLowCoordinate);const n={high:{point:{x:t.x,y:t.yHighCoordinate},xDatum:t.xValue,yDatum:t.yHighValue},low:{point:{x:t.x,y:t.yLowCoordinate},xDatum:t.xValue,yDatum:t.yLowValue}};Array.isArray(a)?a.push(n):a==null?e.spanPoints.push([n]):(a.skip+=1,e.spanPoints.push([n]))}else e.connectMissingData||(Array.isArray(a)||a==null?e.spanPoints.push({skip:0}):a.skip+=1)}upsertMarkerDatum(e,t,i,o,s,a){const{size:n}=e.item[o].marker;if(e.canIncrementallyUpdate&&e.nodeIndex<e.markerData.length){const l=e.markerData[e.nodeIndex];l.index=i,l.itemType=o,l.datum=t.datum,l.datumIndex=i,l.midPoint={x:t.x,y:a},l.yHighValue=t.yHighValue,l.yLowValue=t.yLowValue,l.xValue=t.xValue,l.point={x:t.x,y:a,size:n}}else e.markerData.push({index:i,series:this,itemType:o,datum:t.datum,datumIndex:i,midPoint:{x:t.x,y:a},yHighValue:t.yHighValue,yLowValue:t.yLowValue,xValue:t.xValue,xKey:e.xKey,yLowKey:e.yLowKey,yHighKey:e.yHighKey,point:{x:t.x,y:a,size:n},enabled:!0});if(e.nodeIndex++,e.labelsEnabled){const l=this.createLabelData({datumIndex:i,point:{x:t.x,y:a},value:s,yLowValue:t.yLowValue,yHighValue:t.yHighValue,itemType:o,inverted:t.inverted,datum:t.datum,series:this});e.labelData.push(l)}}createNodeData(){const{data:e,processedData:t,axes:i}=this,o=i[Ge.X],s=i[Ge.Y];if(!(e&&o&&s&&t&&this.chart?.seriesRect))return;const a=this.createNodeDatumContext(o.scale,s.scale,o.range);if(!a)return;const n={datum:void 0,xValue:void 0,yHighValue:0,yLowValue:0,x:0,yHighCoordinate:0,yLowCoordinate:0,inverted:!1},r=x=>a.xScale.convert(a.xValues[x])+a.xOffset;if(t.input.count<1e3||a.dataAggregationFilter==null){let[x,b]=vS(1,a.xValues.length,a.xAxisRange,f=>{const v=r(f);return[v,v]});t.input.count<1e3&&(x=0,b=t.input.count),x=Math.max(x-1,0),b=Math.min(b+1,a.xValues.length);for(let f=x;f<b;f+=1)this.handleDatumPoint(a,n,f)}else{const{maxRange:x,indexData:b,midpointIndices:f}=a.dataAggregationFilter,[v,k]=vS(1,x,a.xAxisRange,A=>{const M=f[A];if(M!==lS)return[r(M),r(M)]});for(let A=v;A<k;A+=1){if(f[A]===lS)continue;const I=A*eR,D=b[I+QO],L=b[I+JO];this.handleDatumPoint(a,n,D,a.yHighValues[D],a.yLowValues[L])}}a.canIncrementallyUpdate&&a.nodeIndex<a.markerData.length&&(a.markerData.length=a.nodeIndex);const l=a.spanPoints.flatMap(x=>{if(!Array.isArray(x))return[];const b=x.map(f=>f.high);return SS(b,a.interpolation)}),c=a.spanPoints.flatMap(x=>{if(!Array.isArray(x))return[];const b=x.map(f=>f.low);return SS(b,a.interpolation)}),h=yR(this.properties.segmentation,o,s,this.chart.seriesRect,this.ctx.scene,!1);let d;if(this.properties.invertedStyle.enabled){const x=a.yHighValues[0]<a.yLowValues[0],b=VO(l,c,a.xScale.range[0],a.xScale.range[1],x);d=zO(b,this.chart.seriesRect,this.ctx.scene,x,this.properties.invertedStyle)}const{fill:u,fillOpacity:g,item:m}=this.properties,y=x=>{const b=m[x],{stroke:f,strokeWidth:v,strokeOpacity:k}=b,A={fill:u,fillOpacity:g,stroke:f,strokeWidth:v,strokeOpacity:k};return mR(this,b,b.marker,A)};return{itemId:`${a.yLowKey}-${a.yHighKey}`,labelData:a.labelData,nodeData:a.markerData,fillData:{itemType:"high",spans:l,phantomSpans:c},highStrokeData:{itemType:"high",spans:l},lowStrokeData:{itemType:"low",spans:c},scales:this.calculateScaling(),visible:this.visible,styles:{low:y("low"),high:y("high")},segments:h,intersectionSegments:d}}createLabelData({datumIndex:e,point:t,value:i,itemType:o,inverted:s,datum:a,series:n}){const{xKey:r,yLowKey:l,yHighKey:c,xName:h,yName:d,yLowName:u,yHighName:g,legendItemName:m,label:y}=this.properties,{placement:S}=y,x=y.spacing+(typeof y.padding=="number"?y.padding:0);let b=o;s&&(b=o==="low"?"high":"low");const f=S==="outside"&&b==="high"||S==="inside"&&b==="low"?-1:1,v=this.getSeriesDomain(Ge.Y).domain;return{x:t.x,y:t.y+x*f,series:n,itemType:o,datum:a,datumIndex:e,text:this.getLabelText(i,a,o==="high"?c:l,"y",v,y,{value:i,datum:a,itemType:o,xKey:r,yLowKey:l,yHighKey:c,xName:h,yLowName:u,yHighName:g,yName:d,legendItemName:m}),textAlign:"center",textBaseline:f===-1?"bottom":"top"}}isPathOrSelectionDirty(){const{low:e,high:t}=this.properties.item;return e.marker.isDirty()||t.marker.isDirty()}strokewidthChange(){const e=t=>{const i=this.properties.item[t].strokeWidth??0,o=this.properties.highlight.highlightedSeries.item?.[t]?.strokeWidth??i,s=this.properties.highlight.highlightedItem.item?.[t]?.strokeWidth??i;return i>s||o>s};return e("low")||e("high")}updatePathNodes(e){const{visible:t}=e,[i,o,s]=e.paths,a=this.contextNodeData?.segments,n=this.ctx.highlightManager?.getActiveHighlight(),r=this.getHighlightState(n,!1),l=this.getHighlightStyle(),{item:c,fill:h,fillOpacity:d,opacity:u}=CO(l,this.getStyle(r));o.setProperties({datum:a,segments:a,fill:void 0,lineCap:"round",lineJoin:"round",pointerEvents:tc.None,stroke:c.low.stroke,strokeWidth:c.low.strokeWidth,strokeOpacity:c.low.strokeOpacity,lineDash:c.low.lineDash,lineDashOffset:c.low.lineDashOffset,opacity:u,visible:t}),s.setProperties({segments:a,fill:void 0,lineCap:"round",lineJoin:"round",pointerEvents:tc.None,stroke:c.high.stroke,strokeWidth:c.high.strokeWidth,strokeOpacity:c.high.strokeOpacity,lineDash:c.high.lineDash,lineDashOffset:c.high.lineDashOffset,opacity:u,visible:t});const g=this.getShapeFillBBox();i.setFillProperties(h,g),i.setStyleProperties({stroke:void 0,fill:h,fillOpacity:d,opacity:u},g);const m=this.contextNodeData?.intersectionSegments??a;i.setProperties({segments:m,pointerEvents:tc.None,lineJoin:"round",fillShadow:this.properties.shadow,opacity:u,visible:t}),i.datum=m,Lp(this,i),Lp(this,o),Lp(this,s)}updatePaths(e){this.updateAreaPaths(e.paths,e.contextData)}updateAreaPaths(e,t){for(const i of e)i.visible=t.visible;if(t.visible)this.updateFillPath(e,t),this.updateStrokePath(e,t);else for(const i of e)i.path.clear(),i.markDirty("RangeArea")}updateFillPath(e,t){const[i]=e;i.path.clear(),dR(i,t.fillData),i.markDirty("RangeArea")}updateStrokePath(e,t){const[,i,o]=e;i.path.clear(),o.path.clear(),xS(i,t.lowStrokeData.spans),xS(o,t.highStrokeData.spans),i.markDirty("RangeArea"),o.markDirty("RangeArea")}resetDatumAnimation(e){bR([e.datumSelection])}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e,{processedData:o,axes:s,properties:a}=this,n=a.styler?this.getStylerMarkerOptions().item:a.item,{low:r,high:l}=n,c=gR(o.input.count,s[Ge.X].scale,{enabled:r.marker.enabled||l.marker.enabled});(a.item.low.marker.isDirty()||a.item.high.marker.isDirty())&&(i.clear(),i.cleanup());let h;if(c)if(r.marker.enabled&&l.marker.enabled)h=t;else{h=[];for(const d of t)n[d.itemType].marker.enabled&&h.push(d)}else h=[];return wp(this.processedData)?i.update(h,void 0,d=>vR(d.xValue,d.itemType)):i.update(h)}updateDatumStyles({datumSelection:e,isHighlight:t}){const i=this.ctx.highlightManager.getActiveHighlight();e.each((o,s)=>{const a=this.getHighlightState(i,t,s.datumIndex),n=this.getStyle(a),{fill:r,fillOpacity:l,item:c}=n,{stroke:h,strokeWidth:d,strokeOpacity:u}=c[s.itemType],{marker:g}=this.properties.item[s.itemType],m=this.makeItemStylerParams(s.itemType);s.style=this.getMarkerStyle(g,s,m,{isHighlight:t,highlightState:a,resolveMarkerSubPath:["item",s.itemType,"marker"]},n.item[s.itemType].marker,{fill:r,fillOpacity:l,stroke:h,strokeWidth:d,strokeOpacity:u})})}updateDatumNodes(e){const{contextNodeData:t}=this;if(!t)return;const{datumSelection:i,isHighlight:o}=e,s=this.getShapeFillBBox(),a=this.ctx.highlightManager.getActiveHighlight();i.each((n,r)=>{const{itemType:l}=r,c=r.style??t.styles[l][this.getHighlightState(a,o,r.datumIndex)];this.applyMarkerStyle(c,n,r.point,s)}),o||(this.properties.item.low.marker.markClean(),this.properties.item.high.marker.markClean())}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e;return i.update(t,o=>{o.pointerEvents=tc.None})}updateLabelNodes(e){const t={xKey:this.properties.xKey,xName:this.properties.xName??this.properties.xKey,yName:this.properties.yName,yLowKey:this.properties.yLowKey,yLowName:this.properties.yLowName??this.properties.yLowKey,yHighKey:this.properties.yHighKey,yHighName:this.properties.yHighName??this.properties.yHighKey,legendItemName:this.properties.legendItemName},i=this.ctx.highlightManager?.getActiveHighlight(),{isHighlight:o=!1,labelSelection:s}=e;s.each((a,n)=>{a.fillOpacity=this.getHighlightStyle(o,n.datumIndex).opacity??1,iR(this,a,t,this.properties.label,n,o,i)})}getHighlightLabelData(e,t){return e?.length?e.filter(i=>i.datum===t.datum):[]}getHighlightData(e,t){const i=e.filter(o=>o.datum===t.datum).map(o=>({...o}));return i.length>0?i:void 0}getStyle(e){return this.getStylerCouple(e)[0]}getStylerMarkerOptions(){return this.getStylerCouple()[1]}getStylerCouple(e){const{fill:t,fillOpacity:i,item:o,styler:s}=this.properties;let a={};if(s){const c=this.makeStylerParams(e);a=this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],this.cachedCallWithContext(s,c)??{},{pick:!1})??{}}const n={item:{low:{marker:{enabled:!1}},high:{marker:{enabled:!1}}}},r=c=>{const h=a.item?.[c],{lineDash:d,lineDashOffset:u,marker:g,stroke:m,strokeOpacity:y,strokeWidth:S}=o[c];return n.item[c].marker.enabled=h?.marker?.enabled??g.enabled,{marker:{fill:h?.marker?.fill??g.fill??t,fillOpacity:h?.marker?.fillOpacity??g.fillOpacity,shape:h?.marker?.shape??g.shape,size:h?.marker?.size??g.size,lineDash:h?.marker?.lineDash??g.lineDash,lineDashOffset:h?.marker?.lineDashOffset??g.lineDashOffset,stroke:h?.marker?.stroke??g.stroke??m,strokeOpacity:h?.marker?.strokeOpacity??g.strokeOpacity,strokeWidth:h?.marker?.strokeWidth??g.strokeWidth},lineDash:h?.lineDash??d,lineDashOffset:h?.lineDashOffset??u,stroke:h?.stroke??m,strokeOpacity:h?.strokeOpacity??y,strokeWidth:h?.strokeWidth??S}};return[{fill:a.fill??t,fillOpacity:a.fillOpacity??i,opacity:1,topLevel:{lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,marker:this.properties.marker,stroke:this.properties.stroke,strokeOpacity:this.properties.strokeOpacity,strokeWidth:this.properties.strokeWidth},item:{low:r("low"),high:r("high")}},n]}makeStylerParams(e){const{id:t}=this,{fill:i,fillOpacity:o,item:s,xKey:a,yHighKey:n,yLowKey:r}=this.properties,l=fR(e??xR.None),c=h=>{const{lineDash:d,lineDashOffset:u,marker:g,stroke:m,strokeOpacity:y,strokeWidth:S}=s[h];return{marker:{fill:g.fill??i,fillOpacity:g.fillOpacity,size:g.size,shape:g.shape,stroke:g.stroke??m,strokeOpacity:g.strokeOpacity,strokeWidth:g.strokeWidth,lineDash:g.lineDash,lineDashOffset:g.lineDashOffset},lineDash:d,lineDashOffset:u,stroke:m,strokeOpacity:y,strokeWidth:S}};return{item:{low:c("low"),high:c("high")},fill:i,fillOpacity:o,highlightState:l,seriesId:t,xKey:a,yLowKey:r,yHighKey:n}}makeItemStylerParams(e){const{xKey:t,yLowKey:i,yHighKey:o}=this.properties;return{xKey:t,yLowKey:i,yHighKey:o,itemType:e}}getTooltipContent(e,t){const i=t?.itemType??"high",{id:o,dataModel:s,processedData:a,axes:n,properties:r}=this,{xName:l,yName:c,yLowKey:h,yLowName:d,xKey:u,yHighKey:g,yHighName:m,tooltip:y,legendItemName:S}=r,x=n[Ge.X],b=n[Ge.Y];if(!s||!a||!x||!b)return;const f=a.dataSources.get(this.id)?.data[e],v=s.resolveKeysById(this,"xValue",a)[e],k=s.resolveColumnById(this,"yHighValue",a)[e],A=s.resolveColumnById(this,"yLowValue",a)[e];if(v==null)return;const M=this.getStyle(),I=this.makeItemStylerParams(i),D=this.getMarkerStyle(this.properties.item[i].marker,{datumIndex:e,datum:f},I,{isHighlight:!1,resolveMarkerSubPath:["item",i,"marker"]},M.item[i].marker),L=`${this.getAxisValueText(b,"tooltip",A,f,h,S)} - ${this.getAxisValueText(b,"tooltip",k,f,g,S)}`;return this.formatTooltipWithContext(y,{heading:this.getAxisValueText(x,"tooltip",v,f,u,S),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:`${d??h} - ${m??g}`,value:L,missing:$a.isTooltipValueMissing(k)&&$a.isTooltipValueMissing(A)}]},{seriesId:o,datum:f,title:c,itemType:i,xName:l,yName:c,yLowKey:h,yLowName:d,xKey:u,yHighKey:g,yHighName:m,legendItemName:S,...D})}legendItemSymbol(){const{fill:e,topLevel:t}=this.getStyle(),{stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,marker:n}=t;return{marker:{shape:n.shape,fill:n.fill??e,stroke:n.stroke??i,fillOpacity:n.fillOpacity,strokeOpacity:n.strokeOpacity,strokeWidth:n.strokeWidth,lineDash:n.lineDash,lineDashOffset:n.lineDashOffset},line:{enabled:!0,stroke:i,strokeOpacity:s,strokeWidth:o,lineDash:a}}}getLegendData(e){if(e!=="category")return[];const{id:t,visible:i}=this,{yLowKey:o,yHighKey:s,yName:a,yLowName:n,yHighName:r,legendItemName:l,showInLegend:c}=this.properties,h=l??a??`${n??o} - ${r??s}`,d=`${o}-${s}`;return[{legendType:"category",id:t,itemId:d,seriesId:t,enabled:i,label:{text:`${h}`},symbol:this.legendItemSymbol(),legendItemName:l,hideInLegend:!c}]}isLabelEnabled(){return this.properties.label.enabled}nodeFactory(){return new pR}animateEmptyUpdateReady(e){const{datumSelection:t,labelSelection:i,contextData:o,paths:s}=e,{animationManager:a}=this.ctx;this.updateAreaPaths(s,o),nR(this,a,...s),rR([t],yS),lR(this,a,t),Ip(this,"labels",a,i,this.highlightLabelSelection)}animateReadyResize(e){const{contextData:t,paths:i}=e;this.updateAreaPaths(i,t),super.animateReadyResize(e)}animateWaitingUpdateReady(e){const{animationManager:t}=this.ctx,{datumSelection:i,labelSelection:o,contextData:s,paths:a,previousContextData:n}=e,[r,l,c]=a;if(r==null&&l==null&&c==null)return;this.resetDatumAnimation(e),this.resetLabelAnimation(e);const h=()=>{this.resetPathAnimation(e),this.updateAreaPaths(a,s)},d=()=>{t.skipCurrentBatch(),h()};if(s==null||n==null){h(),bS(this,t,"added",i),Np(this,"fill_path_properties",t,"add",r),Np(this,"low_stroke_path_properties",t,"add",l),Np(this,"high_stroke_path_properties",t,"add",c),Ip(this,"labels",t,o,this.highlightLabelSelection);return}const u=qO(s,n,this.processedData?.reduced?.diff?.[this.id]);if(u===void 0){d();return}else if(u.status==="no-op")return;Cp(this.id,"fill_path_properties",t,[r],u.fill.pathProperties),Cp(this.id,"low_stroke_path_properties",t,[l],u.stroke.pathProperties),Cp(this.id,"high_stroke_path_properties",t,[c],u.stroke.pathProperties),u.status==="added"?this.updateAreaPaths(a,s):u.status==="removed"?this.updateAreaPaths(a,n):(Tp(this.id,"fill_path_update",t,[r],u.fill.path),Tp(this.id,"low_stroke_path_update",t,[l],u.stroke.path),Tp(this.id,"high_stroke_path_update",t,[c],u.stroke.path)),u.hasMotion&&(bS(this,t,void 0,i),Ip(this,"labels",t,o,this.highlightLabelSelection)),this.ctx.animationManager.animate({id:this.id,groupId:"reset_after_animation",phase:"trailing",from:{},to:{},onComplete:()=>this.updateAreaPaths(a,s)})}getFormattedMarkerStyle(e){const t=this.getStyle(),i=this.makeItemStylerParams(e.itemType);return this.getMarkerStyle(this.properties.item[e.itemType].marker,e,i,{isHighlight:!0,resolveMarkerSubPath:["item",e.itemType,"marker"]},void 0,t)}getMarkerStyle(e,t,i,o,s,a){return e.itemStyler=this.properties.marker.itemStyler,super.getMarkerStyle(e,t,i,o,s,a)}computeFocusBounds(e){const t=fS(this,e),i=fS(this,{...e,datumIndex:e.datumIndex+1});if(t&&i)return uR.merge([t,i])}isDatumEnabled(e,t){return t%2===0&&super.isDatumEnabled(e,t)}hasItemStylers(){return this.properties.styler!=null||this.properties.marker.itemStyler!=null||this.properties.label.itemStyler!=null}};Pp.className="RangeAreaSeries",Pp.type="range-area";import{_ModuleSupport as AR}from"ag-charts-community";import{boolean as kS,commonSeriesOptionsDefs as MR,constant as IR,fillOptionsDef as LR,number as NR,required as ic,shapeSegmentation as CR,string as ji,undocumented as DS}from"ag-charts-core";var{rangeAreaSeriesThemeableOptionsDef:TR}=AR,Op={...MR,...TR,type:ic(IR("range-area")),xKey:ic(ji),yLowKey:ic(ji),yHighKey:ic(ji),xKeyAxis:ji,yKeyAxis:ji,xName:ji,yName:ji,yLowName:ji,yHighName:ji,legendItemName:ji,segmentation:CR,invertedStyle:{enabled:kS,...LR}};Op.pickOutsideVisibleMinorAxis=DS(kS),Op.focusPriority=DS(NR);import{_ModuleSupport as dt}from"ag-charts-community";import{CARTESIAN_AXIS_TYPE as wR}from"ag-charts-core";var AS={lineDash:{$path:"/series/$index/lineDash"},lineDashOffset:{$path:"/series/$index/lineDashOffset"},stroke:{$path:["/series/$index/stroke",{$palette:"stroke"}]},strokeOpacity:{$path:"/series/$index/strokeOpacity"},strokeWidth:{$path:["/series/$index/strokeWidth",1]},marker:{enabled:{$path:"/series/$index/marker/enabled"},fill:{$isUserOption:["/series/$index/marker/fill",{$if:[{$or:[{$isGradient:{$path:"/series/$index/marker/fill"}},{$isImage:{$path:"/series/$index/marker/fill"}},{$isPattern:{$path:"/series/$index/marker/fill"}}]},{$merge:[{$path:"/series/$index/marker/fill"},{$applySwitch:[{$path:"type"},void 0,["gradient",dt.FILL_GRADIENT_RADIAL_REVERSED_DEFAULTS],["image",dt.FILL_IMAGE_DEFAULTS],["pattern",dt.FILL_PATTERN_DEFAULTS]]}]},{$isUserOption:["/series/$index/marker/fill",{$path:"/series/$index/marker/fill"},{$palette:"fill"}]}]},{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",dt.FILL_GRADIENT_RADIAL_REVERSED_DEFAULTS],["image",dt.FILL_IMAGE_DEFAULTS],["pattern",dt.FILL_PATTERN_DEFAULTS]]}]},fillOpacity:{$path:"/series/$index/marker/fillOpacity"},lineDash:{$path:"/series/$index/marker/lineDash"},lineDashOffset:{$path:"/series/$index/marker/lineDashOffset"},shape:{$path:"/series/$index/marker/shape"},size:{$path:["/series/$index/marker/size",6]},stroke:{$path:["/series/$index/marker/stroke",{$palette:"stroke"}]},strokeOpacity:{$path:"/series/$index/marker/strokeOpacity"},strokeWidth:{$path:["/series/$index/marker/strokeWidth",2]}}},PR={series:{fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",dt.FILL_GRADIENT_LINEAR_DEFAULTS],["pattern",dt.FILL_PATTERN_DEFAULTS]]},fillOpacity:.7,stroke:{$palette:"stroke"},strokeWidth:1,marker:{enabled:!1,fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",dt.FILL_GRADIENT_RADIAL_REVERSED_DEFAULTS],["image",dt.FILL_IMAGE_DEFAULTS],["pattern",dt.FILL_PATTERN_DEFAULTS]]},shape:"circle",stroke:{$palette:"stroke"},size:6,strokeWidth:2},nodeClickRange:"nearest",item:{low:AS,high:AS},label:{...dt.LABEL_BOXING_DEFAULTS,enabled:!1,placement:"outside",padding:{$isUserOption:["./spacing",0,10]},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},interpolation:{type:"linear"},tooltip:{range:{$path:["/tooltip/range","nearest"]}},highlight:dt.markerSeriesHighlightStyle(),segmentation:dt.SEGMENTATION_DEFAULTS,invertedStyle:{enabled:!1,fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",dt.FILL_GRADIENT_LINEAR_DEFAULTS],["image",dt.FILL_IMAGE_DEFAULTS],["pattern",dt.FILL_PATTERN_DEFAULTS]]},fillOpacity:{$path:"../fillOpacity"}}},axes:{[wR.NUMBER]:{crosshair:{enabled:!0}}}},{predictCartesianNonPrimitiveAxis:OR}=kO,oc={type:"series",name:"range-area",chartType:"cartesian",enterprise:!0,version:vO,dependencies:[bO],options:Op,predictAxis:OR,defaultAxes:{y:{type:aS.NUMBER,position:nS.LEFT},x:{type:aS.CATEGORY,position:nS.BOTTOM}},axisKeys:{[rS.X]:"xKeyAxis",[rS.Y]:"yKeyAxis"},themeTemplate:PR,create:e=>new Pp(e)};import{CartesianChartModule as RR,VERSION as ER,_ModuleSupport as _R}from"ag-charts-community";import{ChartAxisDirection as sc}from"ag-charts-core";import{_ModuleSupport as Ua}from"ag-charts-community";import{AGGREGATION_INDEX_X_MAX as MS,AGGREGATION_INDEX_X_MIN as BR,AGGREGATION_INDEX_Y_MAX as VR,AGGREGATION_INDEX_Y_MIN as zR,AGGREGATION_SPAN as IS,ChartAxisDirection as ja,DebugMetrics as FR,areScalingEqual as HR,findMinMax as WR,mergeDefaults as LS}from"ag-charts-core";import"ag-charts-community";import{aggregationDomain as Rp,computeExtremesAggregation as NS,computeExtremesAggregationPartial as KR,simpleMemorize2 as GR}from"ag-charts-core";function $R(e,t,i,o,s,a,n,r){const[l,c]=Rp(e,s);return NS([l,c],t,i,o,{smallestKeyInterval:a,xNeedsValueOf:n,yNeedsValueOf:r})}var YR=GR($R);function UR(e,t,i,o,s){const a=t.resolveKeysById(o,"xValue",i),n=t.resolveColumnById(o,"yHighValue",i),r=t.resolveColumnById(o,"yLowValue",i),l=t.getDomain(o,"xValue","key",i),c=t.resolveColumnNeedsValueOf(o,"xValue",i),h=t.resolveColumnNeedsValueOf(o,"yHighValue",i)??t.resolveColumnNeedsValueOf(o,"yLowValue",i);if(s){const[d,u]=Rp(e,l);return NS([d,u],a,n,r,{smallestKeyInterval:i.reduced?.smallestKeyInterval,xNeedsValueOf:c,yNeedsValueOf:h,existingFilters:s})}return YR(e,a,n,r,l,i.reduced?.smallestKeyInterval,c,h)}function jR(e,t,i,o,s,a){const n=t.resolveKeysById(o,"xValue",i),r=t.resolveColumnById(o,"yHighValue",i),l=t.resolveColumnById(o,"yLowValue",i),c=t.getDomain(o,"xValue","key",i),h=t.resolveColumnNeedsValueOf(o,"xValue",i),d=t.resolveColumnNeedsValueOf(o,"yHighValue",i)??t.resolveColumnNeedsValueOf(o,"yLowValue",i),[u,g]=Rp(e,c);return KR([u,g],n,r,l,{smallestKeyInterval:i.reduced?.smallestKeyInterval,targetRange:s,xNeedsValueOf:h,yNeedsValueOf:d,existingFilters:a})}import{_ModuleSupport as XR}from"ag-charts-community";import{Property as Te}from"ag-charts-core";var{AbstractBarSeriesProperties:ZR,makeSeriesTooltip:qR,DropShadow:QR,Label:JR}=XR,Ep=class extends JR{constructor(){super(...arguments),this.placement="inside",this.spacing=0}};p([Te],Ep.prototype,"placement",2),p([Te],Ep.prototype,"spacing",2);var Ve=class extends ZR{constructor(){super(...arguments),this.fill="#99CCFF",this.fillOpacity=1,this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.shadow=new QR().set({enabled:!1}),this.label=new Ep,this.tooltip=qR()}};p([Te],Ve.prototype,"xKey",2),p([Te],Ve.prototype,"yLowKey",2),p([Te],Ve.prototype,"yHighKey",2),p([Te],Ve.prototype,"xName",2),p([Te],Ve.prototype,"yName",2),p([Te],Ve.prototype,"yLowName",2),p([Te],Ve.prototype,"yHighName",2),p([Te],Ve.prototype,"fill",2),p([Te],Ve.prototype,"fillOpacity",2),p([Te],Ve.prototype,"stroke",2),p([Te],Ve.prototype,"strokeWidth",2),p([Te],Ve.prototype,"strokeOpacity",2),p([Te],Ve.prototype,"lineDash",2),p([Te],Ve.prototype,"lineDashOffset",2),p([Te],Ve.prototype,"cornerRadius",2),p([Te],Ve.prototype,"styler",2),p([Te],Ve.prototype,"itemStyler",2),p([Te],Ve.prototype,"shadow",2),p([Te],Ve.prototype,"label",2),p([Te],Ve.prototype,"tooltip",2);var{SeriesNodePickMode:CS,valueProperty:TS,keyProperty:eE,checkCrisp:tE,updateLabelNode:iE,SMALLEST_KEY_INTERVAL:oE,LARGEST_KEY_INTERVAL:sE,diff:aE,prepareBarAnimationFunctions:wS,midpointStartingBarPosition:PS,resetBarSelectionsFn:nE,resetBarSelectionsDirect:rE,fixNumericExtent:lE,seriesLabelFadeInAnimation:OS,resetLabelFn:cE,animationValidation:hE,computeBarFocusBounds:dE,visibleRangeIndices:pE,createDatumId:uE,ContinuousScale:gE,Rect:mE,PointerEvents:yE,motion:RS,processedDataIsAnimatable:_p,getItemStyles:fE,calculateSegments:xE,toHighlightString:SE,HighlightState:ES,AggregationManager:bE}=Ua,vE=class extends Ua.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.xKey=o.properties.xKey,this.yLowKey=o.properties.yLowKey,this.yHighKey=o.properties.yHighKey}},Bp=class extends Ua.AbstractBarSeries{constructor(e){super({moduleCtx:e,pickModes:[CS.AXIS_ALIGNED,CS.EXACT_SHAPE_MATCH],propertyKeys:{x:["xKey"],y:["yLowKey","yHighKey"]},propertyNames:{x:["xName"],y:["yLowName","yHighName","yName"]},categoryKey:"xValue",datumSelectionGarbageCollection:!1,animationResetFns:{datum:nE,label:cE}}),this.properties=new Ve,this.aggregationManager=new bE,this.NodeEvent=vE}async processData(e){const{xKey:t,yLowKey:i,yHighKey:o}=this.properties,s=this.getCategoryAxis()?.scale,a=this.getValueAxis()?.scale,{isContinuousX:n,xScaleType:r,yScaleType:l}=this.getScaleInformation({xScale:s,yScale:a}),c=[];this.needsDataModelDiff()&&this.processedData&&c.push(aE(this.id,this.processedData)),this.ctx.animationManager.isSkipped()||c.push(hE());const h=this.visible?{}:{forceValue:0},{dataModel:d,processedData:u}=await this.requestDataModel(e,this.data,{props:[eE(t,r,{id:"xValue"}),TS(i,l,{id:"yLowValue",invalidValue:null,...h}),TS(o,l,{id:"yHighValue",invalidValue:null,...h}),...n?[oE,sE]:[],...c],groupByKeys:!1});this.smallestDataInterval=u.reduced?.smallestKeyInterval,this.largestDataInterval=u.reduced?.largestKeyInterval,this.aggregateData(d,u),this.animationState.transition("updateData")}aggregateData(e,t){if(this.aggregationManager.markStale(),t.type!=="ungrouped"||_p(t))return;const i=this.axes[ja.X];if(i==null)return;const o=this.estimateTargetRange();this.aggregationManager.aggregate({computePartial:a=>jR(i.scale.type,e,t,this,o,a),computeFull:a=>UR(i.scale.type,e,t,this,a),targetRange:o});const s=this.aggregationManager.filters;s&&s.length>0&&FR.record(`${this.type}:aggregation`,s.map(a=>a.maxRange))}estimateTargetRange(){const e=this.axes[ja.X];if(e?.scale==null)return 0;const[t,i]=e.scale.range;return Math.abs(i-t)}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!t||!i)return{domain:[]};const{keys:[o]}=t.domain;if(e===this.getCategoryDirection()){const s=i.resolveProcessedDataDefById(this,"xValue");if(s?.def.type==="key"&&s?.def.valueType==="category"){const a=i.getKeySortMetadata(this,"xValue",t);return{domain:o,sortMetadata:a}}return{domain:this.padBandExtent(o)}}else{const s=this.domainForClippedRange(e,["yHighValue","yLowValue"],"xValue"),a=WR(s);return{domain:lE(a)}}}getSeriesRange(e,t){return this.domainForVisibleRange(ja.Y,["yHighValue","yLowValue"],"xValue",t)}createNodeDatumContext(e,t){const{dataModel:i,processedData:o,groupScale:s}=this;if(!i||!o)return;const a=o.dataSources?.get(this.id)?.data;if(a==null)return;const n=e.scale,r=t.scale,{barWidth:l,groupIndex:c}=this.updateGroupScale(e),h=gE.is(n)?l*-.5:0,d=s.convert(String(c)),u=this.getBarDirection()===ja.X,g=tE(e?.scale,e?.visibleRange,this.smallestDataInterval,this.largestDataInterval),[m,y]=n.range,S=Math.abs(y-m);this.aggregationManager.ensureLevelForRange(S);const x=this.aggregationManager.getFilterForRange(S),b=this.contextNodeData?.nodeData!=null&&(o.changeDescription!=null||!_p(o)||x!=null);return{rawData:a,xValues:i.resolveKeysById(this,"xValue",o),yLowValues:i.resolveColumnById(this,"yLowValue",o),yHighValues:i.resolveColumnById(this,"yHighValue",o),xScale:n,yScale:r,xAxis:e,yAxis:t,barWidth:l,groupOffset:d,barOffset:h,barAlongX:u,crisp:g,dataAggregationFilter:x,xKey:this.properties.xKey,yLowKey:this.properties.yLowKey,yHighKey:this.properties.yHighKey,labelEnabled:this.properties.label.enabled,labelPlacement:this.properties.label.placement,labelPadding:(this.properties.label.spacing+(typeof this.properties.label.padding=="number"?this.properties.label.padding:0))*(this.properties.label.placement==="outside"?1:-1),canIncrementallyUpdate:b,nodes:b?this.contextNodeData.nodeData:[],nodeIndex:0}}prepareNodeDatumState(e,t,i){const o=e.rawData[i],s=e.xValues[i];if(s==null)return;const a=e.yLowValues[i],n=e.yHighValues[i];if(!Number.isFinite(a?.valueOf())||!Number.isFinite(n?.valueOf()))return;const[r,l]=a<n?[a,n]:[n,a];return t.datum=o,t.xValue=s,t.yLowValue=r,t.yHighValue=l,t.rawLowValue=a,t.rawHighValue=n,t}createSkeletonNodeDatum(e,t,i){const o=t.nodeDatumScratch;return{index:t.groupedDataIndex,series:this,itemId:i,datum:o.datum,datumIndex:t.datumIndex,xValue:o.xValue,yLowValue:0,yHighValue:0,yLowKey:e.yLowKey,yHighKey:e.yHighKey,xKey:e.xKey,x:0,y:0,width:0,height:0,midPoint:{x:0,y:0},crisp:t.crisp,labels:[]}}createNodeDatum(e,t,i,o){const s=this.prepareNodeDatumState(e,t.nodeDatumScratch,t.datumIndex);if(!s)return;const a=this.createSkeletonNodeDatum(e,t,i);return this.updateNodeDatum(e,a,t,o,s),a}updateNodeDatum(e,t,i,o,s){if(s??(s=this.prepareNodeDatumState(e,i.nodeDatumScratch,i.datumIndex)),!s)return;const a=t;a.index=i.groupedDataIndex,a.datum=s.datum,a.datumIndex=i.datumIndex,a.xValue=s.xValue,a.yLowValue=s.rawLowValue,a.yHighValue=s.rawHighValue,a.crisp=i.crisp;const n=Math.round(e.yScale.convert(i.yHigh)),r=Math.round(e.yScale.convert(i.yLow)),l=Math.max(o,Math.abs(r-n)),c={x:e.barAlongX?Math.min(n,r):i.x,y:e.barAlongX?i.x:Math.min(n,r),width:e.barAlongX?l:i.width,height:e.barAlongX?i.width:l};a.x=c.x,a.y=c.y,a.width=c.width,a.height=c.height;const h=a.midPoint;h.x=c.x+c.width/2,h.y=c.y+c.height/2;const d=a.clipBBox;d&&(d.x=c.x,d.y=c.y,d.width=c.width,d.height=c.height);const u=i.labelParamsScratch;u.labels=a.labels,u.datumIndex=i.datumIndex,u.rectX=c.x,u.rectY=c.y,u.rectWidth=c.width,u.rectHeight=c.height,u.yLowValue=s.yLowValue,u.yHighValue=s.yHighValue,u.datum=s.datum,this.updateLabelData(e,u)}upsertNodeDatum(e,t,i,o){if(e.canIncrementallyUpdate&&e.nodeIndex<e.nodes.length){const a=e.nodes[e.nodeIndex];this.updateNodeDatum(e,a,t,o)}else{const a=this.createNodeDatum(e,t,i,o);a&&e.nodes.push(a)}e.nodeIndex++}createNodeDataWithAggregation(e,t,i,o,s,a){const{maxRange:n,indexData:r,midpointIndices:l}=a,[c,h]=pE(1,n,e.xAxis.range,d=>{const u=d*IS,g=r[u+MS],m=l[d];if(m!==-1)return[t(m),t(g)+e.barWidth]});for(let d=c;d<h;d+=1){const u=d*IS,g=r[u+BR],m=r[u+MS],y=r[u+zR],S=r[u+VR],x=l[d];x===-1||e.xValues[x]==null||(i.datumIndex=x,i.groupedDataIndex=0,i.x=t(x),i.width=Math.abs(t(g)-t(m))+e.barWidth,i.yLow=e.yLowValues[y],i.yHigh=e.yHighValues[S],i.crisp=!1,this.upsertNodeDatum(e,i,o,s))}}createNodeDataSimple(e,t,i,o,s,a){const n=a.invalidData?.get(this.id);let[r,l]=this.visibleRangeIndices("xValue",e.xAxis.range);a.input.count<1e3&&(r=0,l=a.input.count);for(let c=r;c<l;c+=1)n?.[c]!==!0&&(i.datumIndex=c,i.groupedDataIndex=0,i.x=t(c),i.width=e.barWidth,i.yLow=e.yLowValues[c],i.yHigh=e.yHighValues[c],i.crisp=e.crisp,this.upsertNodeDatum(e,i,o,s))}createNodeDataGrouped(e,t,i,o,s){const a=this.processedData;for(const{datumIndex:n,groupIndex:r}of this.dataModel.forEachGroupDatum(this,a))i.datumIndex=n,i.groupedDataIndex=r,i.x=t(n),i.width=e.barWidth,i.yLow=e.yLowValues[n],i.yHigh=e.yHighValues[n],i.crisp=e.crisp,this.upsertNodeDatum(e,i,o,s)}createNodeData(){const{data:e,processedData:t,visible:i}=this,o=this.getCategoryAxis(),s=this.getValueAxis();if(!(e&&o&&s&&this.dataModel&&t?.dataSources&&this.chart?.seriesRect))return;const a=this.createNodeDatumContext(o,s);if(!a)return;const{yLowKey:n,yHighKey:r,strokeWidth:l}=this.properties,c=`${n}-${r}`,h=xE(this.properties.segmentation,o,s,this.chart.seriesRect,this.ctx.scene),d={itemId:c,nodeData:a.nodes,labelData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible,styles:fE(this.getItemStyle.bind(this)),segments:h};if(!i)return d;const u=m=>Math.round(a.xScale.convert(a.xValues[m]))+a.groupOffset+a.barOffset,g={nodeDatumScratch:{datum:void 0,xValue:void 0,yLowValue:0,yHighValue:0,rawLowValue:void 0,rawHighValue:void 0},labelParamsScratch:{labels:[],datumIndex:0,rectX:0,rectY:0,rectWidth:0,rectHeight:0,yLowValue:0,yHighValue:0,datum:void 0},datumIndex:0,groupedDataIndex:0,x:0,width:0,yLow:0,yHigh:0,crisp:!1};a.dataAggregationFilter!=null?this.createNodeDataWithAggregation(a,u,g,c,l,a.dataAggregationFilter):t.type==="ungrouped"?this.createNodeDataSimple(a,u,g,c,l,t):this.createNodeDataGrouped(a,u,g,c,l),a.canIncrementallyUpdate&&a.nodeIndex<a.nodes.length&&(a.nodes.length=a.nodeIndex);for(const m of a.nodes)d.labelData.push(...m.labels);return d}updateLabelData(e,t){const i=t.labels;if(!e.labelEnabled){i.length>0&&(i.length=0);return}const{xKey:o,yLowKey:s,yHighKey:a,xName:n,yLowName:r,yHighName:l,yName:c,legendItemName:h,label:d}=this.properties,u=e.barAlongX,g=e.labelPlacement,m=e.labelPadding,y=t.rectX,S=t.rectY,x=t.rectWidth,b=t.rectHeight,f=y+(u?-m:x/2),v=S+(u?b/2:b+m);let k;g==="outside"?k=u?"right":"center":k=u?"left":"center";let A;g==="outside"?A=u?"middle":"top":A=u?"middle":"bottom";const M=y+(u?x+m:x/2),I=S+(u?b/2:-m);let D;g==="outside"?D=u?"left":"center":D=u?"right":"center";let L;g==="outside"?L=u?"middle":"bottom":L=u?"middle":"top";const N=t.datum,T=t.yLowValue,O=t.yHighValue,R=t.datumIndex,w={datum:N,xKey:o,yLowKey:s,yHighKey:a,xName:n,yLowName:r,yHighName:l,yName:c,legendItemName:h},E=this.getSeriesDomain(ja.Y).domain,B=this.getLabelText(T,N,s,"y",E,d,{itemType:"low",value:T,...w}),P=this.getLabelText(O,N,a,"y",E,d,{itemType:"high",value:O,...w});if(i.length>0&&i[0].itemType==="low"){const C=i[0];C.datumIndex=R,C.x=f,C.y=v,C.textAlign=k,C.textBaseline=A,C.text=B,C.datum=N}else i[0]={datumIndex:R,x:f,y:v,textAlign:k,textBaseline:A,text:B,itemType:"low",datum:N,series:this};if(i.length>1&&i[1].itemType==="high"){const C=i[1];C.datumIndex=R,C.x=M,C.y=I,C.textAlign=D,C.textBaseline=L,C.text=P,C.datum=N}else i[1]={datumIndex:R,x:M,y:I,textAlign:D,textBaseline:L,text:P,itemType:"high",datum:N,series:this};i.length=2}nodeFactory(){return new mE}getStyle(e,t){const{cornerRadius:i,fill:o,fillOpacity:s,lineDash:a,lineDashOffset:n,stroke:r,strokeOpacity:l,strokeWidth:c,styler:h}=this.properties;let d={};if(!e&&h){const u=this.makeStylerParams(t);d=this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],this.cachedCallWithContext(h,u)??{},{pick:!1})??{}}return{cornerRadius:d.cornerRadius??i,fill:d.fill??o,fillOpacity:d.fillOpacity??s,lineDash:d.lineDash??a,lineDashOffset:d.lineDashOffset??n,opacity:1,stroke:d.stroke??r,strokeOpacity:d.strokeOpacity??l,strokeWidth:d.strokeWidth??c}}makeStylerParams(e){const{id:t}=this,{cornerRadius:i,fill:o,fillOpacity:s,lineDash:a,lineDashOffset:n,stroke:r,strokeOpacity:l,strokeWidth:c,xKey:h,yLowKey:d,yHighKey:u}=this.properties,g=SE(e??ES.None);return{cornerRadius:i,fill:o,fillOpacity:s,highlightState:g,lineDash:a,lineDashOffset:n,seriesId:t,stroke:r,strokeOpacity:l,strokeWidth:c,xKey:h,yLowKey:d,yHighKey:u}}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e,o=t??[];return _p(this.processedData)?i.update(o,void 0,s=>this.getDatumId(s)):i.update(o)}getItemStyle(e,t,i){const{properties:o,dataModel:s,processedData:a}=this,{itemStyler:n}=o,r=this.getHighlightStyle(t,e,i);let l=LS(r,this.getStyle(e===void 0,i));if(n&&s!=null&&a!=null&&e!=null){const c=s.resolveKeysById(this,"xValue",a)[e],h=this.cachedDatumCallback(uE(this.getDatumId({xValue:c}),t?"highlight":"node"),()=>{const d=this.makeItemStylerParams(e,t,l);return this.callWithContext(n,d)});h&&(l=LS(h,l))}return l}makeItemStylerParams(e,t,i){const{id:o,properties:s,processedData:a}=this,{xKey:n,yHighKey:r,yLowKey:l}=s,c=a.dataSources.get(o)?.data[e],h=this.ctx.highlightManager?.getActiveHighlight(),d=this.getHighlightStateString(h,t,e),u=this.filterItemStylerFillParams(i.fill)??i.fill;return{seriesId:o,datum:c,xKey:n,yHighKey:r,yLowKey:l,highlightState:d,...i,fill:u}}updateDatumStyles(e){const t=this.ctx.highlightManager.getActiveHighlight();e.datumSelection.each((i,o)=>{if(!e.datumSelection.isGarbage(i)){const s=this.getHighlightState(t,e.isHighlight,o.datumIndex);o.style=this.getItemStyle(o.datumIndex,e.isHighlight,s)}})}updateDatumNodes({datumSelection:e,isHighlight:t}){const{contextNodeData:i}=this;if(!i)return;const o=this.ctx.highlightManager.getActiveHighlight(),s=this.getCategoryDirection()===ja.X,a=this.getShapeFillBBox(),n=this;e.each(function(l,c){const h=c.style??i.styles[n.getHighlightState(o,t,c.datumIndex)];l.setStyleProperties(h,a),l.setStaticProperties("overlay",h.cornerRadius??0,h.cornerRadius??0,h.cornerRadius??0,h.cornerRadius??0,s?c.width>0:c.height>0,c.crisp,void 0)})}updateLabelSelection(e){const t=this.properties.label.enabled?e.labelData:[];return e.labelSelection.update(t,i=>{i.pointerEvents=yE.None})}updateLabelNodes(e){const{isHighlight:t=!1}=e,i={xKey:this.properties.xKey,xName:this.properties.xName??this.properties.xKey,yName:this.properties.yName,yLowKey:this.properties.yLowKey,yLowName:this.properties.yLowName??this.properties.yLowKey,yHighKey:this.properties.yHighKey,yHighName:this.properties.yHighName??this.properties.yHighKey,legendItemName:this.properties.legendItemName},o=this.ctx.highlightManager?.getActiveHighlight();e.labelSelection.each((s,a)=>{s.fillOpacity=this.getHighlightStyle(t,a?.datumIndex).opacity??1,iE(this,s,i,this.properties.label,a,t,o)})}getHighlightLabelData(e,t){return t.labels?.length?t.labels:super.getHighlightLabelData(e,t)}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,properties:s}=this,{xKey:a,xName:n,yName:r,yLowKey:l,yHighKey:c,yLowName:h,yHighName:d,tooltip:u,legendItemName:g}=s,m=this.getCategoryAxis(),y=this.getValueAxis();if(!i||!o||!m||!y)return;const S=o.dataSources.get(this.id)?.data[e],x=i.resolveKeysById(this,"xValue",o)[e],b=i.resolveColumnById(this,"yHighValue",o)[e],f=i.resolveColumnById(this,"yLowValue",o)[e];if(x==null)return;const v=this.getItemStyle(e,!1),k=`${this.getAxisValueText(y,"tooltip",f,S,l,g)} - ${this.getAxisValueText(y,"tooltip",b,S,c,g)}`;return this.formatTooltipWithContext(u,{heading:this.getAxisValueText(m,"tooltip",x,S,a,g),symbol:this.legendItemSymbol(),data:[{label:r,fallbackLabel:`${h??l} - ${d??c}`,value:k,missing:Ua.isTooltipValueMissing(b)&&Ua.isTooltipValueMissing(f)}]},{seriesId:t,datum:S,title:r,xKey:a,xName:n,yName:r,yLowKey:l,yHighKey:c,yLowName:h,yHighName:d,legendItemName:g,...v})}legendItemSymbol(){const{fill:e,stroke:t,strokeWidth:i,fillOpacity:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}=this.getStyle(!1,ES.None);return{marker:{fill:e,stroke:t,fillOpacity:o,strokeOpacity:s,strokeWidth:i,lineDash:a,lineDashOffset:n}}}getLegendData(e){if(e!=="category")return[];const{id:t,visible:i}=this,{yName:o,yLowName:s,yHighName:a,yLowKey:n,yHighKey:r,legendItemName:l,showInLegend:c}=this.properties,h=l??o??`${s??n} - ${a??r}`,d=`${n}-${r}`;return[{legendType:"category",id:t,itemId:d,seriesId:t,enabled:i,label:{text:`${h}`},symbol:this.legendItemSymbol(),legendItemName:l,hideInLegend:!c}]}resetDatumAnimation(e){rE([e.datumSelection])}animateEmptyUpdateReady({datumSelection:e,labelSelection:t}){const i=wS(PS(this.isVertical(),"normal"),"unknown");RS.fromToMotion(this.id,"datums",this.ctx.animationManager,[e],i),OS(this,"labels",this.ctx.animationManager,t,this.highlightLabelSelection)}animateWaitingUpdateReady(e){const{datumSelection:t,labelSelection:i,contextData:o,previousContextData:s}=e,a=Ua.calculateDataDiff(this.id,t,this.getDatumId.bind(this),o,s,this.processedData,this.processedDataUpdated);this.ctx.animationManager.stopByAnimationGroupId(this.id);const n=s==null?"fade":"normal",r=wS(PS(this.isVertical(),n),"added");RS.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],r,(l,c)=>this.getDatumId(c),a),(a?.changed||!HR(o.groupScale,s?.groupScale))&&OS(this,"labels",this.ctx.animationManager,i,this.highlightLabelSelection)}getDatumId(e){return`${e.xValue}`}isLabelEnabled(){return this.properties.label.enabled}computeFocusBounds({datumIndex:e}){return dE(this,this.contextNodeData?.nodeData[e])}hasItemStylers(){return this.properties.styler!=null||this.properties.itemStyler!=null||this.properties.label.itemStyler!=null}};Bp.className="RangeBarSeries",Bp.type="range-bar";import{_ModuleSupport as kE}from"ag-charts-community";import{boolean as DE,commonSeriesOptionsDefs as AE,constant as ME,number as IE,required as ac,shapeSegmentation as LE,string as Xi,undocumented as _S}from"ag-charts-core";var{rangeBarSeriesThemeableOptionsDef:NE}=kE,Vp={...AE,...NE,type:ac(ME("range-bar")),xKey:ac(Xi),yLowKey:ac(Xi),yHighKey:ac(Xi),xKeyAxis:Xi,yKeyAxis:Xi,xName:Xi,yName:Xi,yLowName:Xi,yHighName:Xi,legendItemName:Xi,segmentation:LE};Vp.pickOutsideVisibleMinorAxis=_S(DE),Vp.focusPriority=_S(IE);import{_ModuleSupport as Xa}from"ag-charts-community";import{CARTESIAN_AXIS_TYPE as CE}from"ag-charts-core";var TE={series:{direction:"vertical",fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",Xa.FILL_GRADIENT_LINEAR_DEFAULTS],["image",Xa.FILL_IMAGE_DEFAULTS],["pattern",Xa.FILL_PATTERN_DEFAULTS]]},stroke:{$palette:"stroke"},strokeWidth:{$isUserOption:["./stroke",2,0]},label:{...Xa.LABEL_BOXING_DEFAULTS,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"chartBackgroundColor"},placement:"inside",padding:{$isUserOption:["./spacing",0,6]}},highlight:Xa.multiSeriesHighlightStyle(),segmentation:Xa.SEGMENTATION_DEFAULTS},axes:{[CE.NUMBER]:{crosshair:{enabled:!0}}}},{DIRECTION_SWAP_AXES:wE,predictCartesianNonPrimitiveAxis:PE}=_R,nc={type:"series",name:"range-bar",chartType:"cartesian",enterprise:!0,groupable:!0,version:ER,dependencies:[RR],options:Vp,predictAxis:PE,defaultAxes:wE,axisKeys:{[sc.X]:"xKeyAxis",[sc.Y]:"yKeyAxis"},axisKeysFlipped:{[sc.X]:"yKeyAxis",[sc.Y]:"xKeyAxis"},themeTemplate:TE,create:e=>new Bp(e)};import{CartesianChartModule as OE,VERSION as RE,_ModuleSupport as EE}from"ag-charts-community";import{ChartAxisDirection as rc}from"ag-charts-core";import{_ModuleSupport as Za}from"ag-charts-community";import{ChartAxisDirection as lc,easeOut as BS,isContinuous as VS,mergeDefaults as zS}from"ag-charts-core";import{_ModuleSupport as _E}from"ag-charts-community";import{BaseProperties as tr,PropertiesArray as BE,Property as J}from"ag-charts-core";var{AbstractBarSeriesProperties:VE,makeSeriesTooltip:zE,DropShadow:FE,Label:HE}=_E,cc=class extends tr{};p([J],cc.prototype,"totalType",2),p([J],cc.prototype,"index",2),p([J],cc.prototype,"axisLabel",2);var FS=class extends tr{};p([J],FS.prototype,"renderer",2);var zp=class extends HE{constructor(){super(...arguments),this.placement="outside-end",this.spacing=0}};p([J],zp.prototype,"placement",2),p([J],zp.prototype,"spacing",2);var vt=class extends tr{constructor(){super(...arguments),this.fill="#c16068",this.stroke="#c16068",this.fillOpacity=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.strokeWidth=1,this.cornerRadius=0,this.shadow=new FE().set({enabled:!1}),this.label=new zp,this.tooltip=new FS}};p([J],vt.prototype,"name",2),p([J],vt.prototype,"fill",2),p([J],vt.prototype,"stroke",2),p([J],vt.prototype,"fillOpacity",2),p([J],vt.prototype,"strokeOpacity",2),p([J],vt.prototype,"lineDash",2),p([J],vt.prototype,"lineDashOffset",2),p([J],vt.prototype,"strokeWidth",2),p([J],vt.prototype,"cornerRadius",2),p([J],vt.prototype,"itemStyler",2),p([J],vt.prototype,"shadow",2),p([J],vt.prototype,"label",2),p([J],vt.prototype,"tooltip",2);var Gs=class extends tr{constructor(){super(...arguments),this.enabled=!0,this.stroke="black",this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.strokeWidth=2}};p([J],Gs.prototype,"enabled",2),p([J],Gs.prototype,"stroke",2),p([J],Gs.prototype,"strokeOpacity",2),p([J],Gs.prototype,"lineDash",2),p([J],Gs.prototype,"lineDashOffset",2),p([J],Gs.prototype,"strokeWidth",2);var hc=class extends tr{constructor(){super(...arguments),this.positive=new vt,this.negative=new vt,this.total=new vt}};p([J],hc.prototype,"positive",2),p([J],hc.prototype,"negative",2),p([J],hc.prototype,"total",2);var ko=class extends VE{constructor(){super(...arguments),this.item=new hc,this.totals=new BE(cc),this.line=new Gs,this.tooltip=zE()}getStyle(e){const{fillOpacity:t,strokeWidth:i,strokeOpacity:o,fill:s,stroke:a,lineDash:n,lineDashOffset:r,cornerRadius:l}=this.item[e==="subtotal"?"total":e];return{fill:s,fillOpacity:t,stroke:a,strokeWidth:i,strokeOpacity:o,lineDash:n,lineDashOffset:r,cornerRadius:l,opacity:1}}};p([J],ko.prototype,"xKey",2),p([J],ko.prototype,"yKey",2),p([J],ko.prototype,"xName",2),p([J],ko.prototype,"yName",2),p([J],ko.prototype,"item",2),p([J],ko.prototype,"totals",2),p([J],ko.prototype,"line",2),p([J],ko.prototype,"tooltip",2);var{adjustLabelPlacement:WE,SeriesNodePickMode:HS,fixNumericExtent:KE,valueProperty:WS,keyProperty:GE,accumulativeValueProperty:dc,trailingAccumulatedValueProperty:$E,createDatumId:KS,checkCrisp:YE,updateLabelNode:UE,prepareBarAnimationFunctions:jE,collapsedStartingBarPosition:XE,resetBarSelectionsFn:ZE,seriesLabelFadeInAnimation:qE,resetLabelFn:QE,animationValidation:JE,DEFAULT_CARTESIAN_DIRECTION_KEYS:e1,DEFAULT_CARTESIAN_DIRECTION_NAMES:t1,computeBarFocusBounds:i1,Rect:o1,motion:s1,getItemStylesPerItemId:a1,DataSet:n1}=Za,Fp=class extends Za.AbstractBarSeries{constructor(e){super({moduleCtx:e,propertyKeys:e1,propertyNames:t1,categoryKey:void 0,pickModes:[HS.NEAREST_NODE,HS.EXACT_SHAPE_MATCH],pathsPerSeries:["connector"],pathsZIndexSubOrderOffset:[-1,-1],animationResetFns:{datum:ZE,label:QE}}),this.properties=new ko,this.seriesItemTypes=new Set(["positive","negative","total"])}async processData(e){const{xKey:t,yKey:i,totals:o}=this.properties,{data:s}=this;if(!this.visible)return;const a=b=>VS(b)&&Number(b)>=0,n=b=>VS(b)&&Number(b)>=0,r=b=>b==="total"||b==="subtotal",l={missingValue:void 0,invalidValue:void 0},c=[],h=o.reduce((b,f)=>{const v=b.get(f.index);return v?v.push(f):b.set(f.index,[f]),b},new Map);for(const[b,f]of s?.data.entries()??[]){c.push(f);const v=h.get(b);if(v)for(const k of v)c.push({...k.toJson(),[t]:k.axisLabel})}const d=[];this.ctx.animationManager.isSkipped()||d.push(JE());const u=this.getCategoryAxis()?.scale,g=this.getValueAxis()?.scale,{isContinuousX:m,xScaleType:y,yScaleType:S}=this.getScaleInformation({xScale:u,yScale:g}),{processedData:x}=await this.requestDataModel(e,n1.wrap(c),{props:[GE(t,y,{id:"xValue"}),dc(i,S,{...l,id:"yCurrent"}),dc(i,S,{...l,missingValue:0,id:"yCurrentTotal"}),dc(i,S,{...l,id:"yCurrentPositive",validation:a}),dc(i,S,{...l,id:"yCurrentNegative",validation:n}),$E(i,S,{...l,id:"yPrevious"}),WS(i,S,{id:"yRaw"}),WS("totalType","category",{id:"totalTypeValue",missingValue:void 0,validation:r}),...m?[Za.SMALLEST_KEY_INTERVAL,Za.LARGEST_KEY_INTERVAL]:[],...d]});this.smallestDataInterval=x.reduced?.smallestKeyInterval,this.largestDataInterval=x.reduced?.largestKeyInterval,this.updateSeriesItemTypes(),this.animationState.transition("updateData")}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!t||!i)return{domain:[]};const{keys:[o],values:s}=t.domain;if(e===this.getCategoryDirection()){const a=i.resolveProcessedDataDefById(this,"xValue");if(a?.def.type==="key"&&a?.def.valueType==="category"){const l=i.getKeySortMetadata(this,"xValue",t);return{domain:o,sortMetadata:l}}const n=e===lc.Y,r=this.getCategoryAxis().isReversed();return{domain:this.padBandExtent(o,r!==n)}}else{const a=i.resolveProcessedDataIndexById(this,"yCurrent"),n=s[a],r=[Math.min(0,n[0]),Math.max(0,n[1])];return{domain:KE(r)}}}getSeriesRange(){return[Number.NaN,Number.NaN]}createNodeData(){const{data:e,dataModel:t,processedData:i}=this,o=this.getCategoryAxis(),s=this.getValueAxis();if(!e||!o||!s||!t||!i)return;const{line:a}=this.properties,n=o.scale,r=s.scale,l=this.getBarDirection()===lc.X,c=this.getBandwidth(o)??10,h=o.isReversed(),d=s.isReversed();if(i.type!=="ungrouped")return;const u={itemId:this.properties.yKey,nodeData:[],labelData:[],pointData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible,styles:a1(this.getItemStyle.bind(this),"total","subtotal","positive","negative")};if(!this.visible)return u;const g=[],m=t.resolveKeysById(this,"xValue",i),y=t.resolveColumnById(this,"yRaw",i),S=t.resolveColumnById(this,"totalTypeValue",i),x=t.resolveColumnById(this,"yCurrent",i),b=t.resolveColumnById(this,"yPrevious",i),f=t.resolveColumnById(this,"yCurrentTotal",i),v=this.getSeriesDomain(lc.Y).domain,k=YE(o?.scale,o?.visibleRange,this.smallestDataInterval,this.largestDataInterval);function A(w,E,B){return w||E?{cumulativeValue:f[B],trailingValue:E?I:0}:{cumulativeValue:x[B],trailingValue:b[B]}}function M(w,E,B,P,C){return w?P:E?(P??0)-(C??0):B}let I=0;const{xKey:D,yKey:L,xName:N,yName:T}=this.properties,O=i.dataSources.get(this.id)?.data??[];for(const[w,E]of O.entries()){const B=S[w],P=this.isSubtotal(B),C=this.isTotal(B),_=C||P,V=m[w];if(V==null)continue;const z=Math.round(n.convert(V)),F=y[w],{cumulativeValue:G,trailingValue:Y}=A(C,P,w);_&&(I=G??0);const K=Math.round(r.convert(G)),U=Math.round(r.convert(Y)),ee=M(C,P,F,G,Y),re=(ee??0)>=0,ye=this.getSeriesItemType(re,B),{strokeWidth:le,label:ie}=this.getItemConfig(ye),ce=re?K:U,pe=re?U:K,he=Math.max(le,Math.abs(pe-ce)),Q={x:l?Math.min(ce,pe):z,y:l?z:Math.min(ce,pe),width:l?he:c,height:l?c:he},Ne={x:Q.x+Q.width/2,y:Q.y+Q.height/2},ve=_?K:U,te=Math.floor(a.strokeWidth)%2/2,ne=h?K:ve,ue=h?ve:K;let ke,ni;l?(ke={x:ne+te,y:Q.y},ni={x:ue+te,y:Q.y+Q.height}):(ke={x:Q.x,y:ne+te},ni={x:Q.x+Q.width,y:ue+te});const Po={x:h?ni.x:ke.x,y:h?ni.y:ke.y,x2:h?ke.x:ni.x,y2:h?ke.y:ni.y,size:0};g.push(Po);const ga=ye==="subtotal"?"total":ye,Di=this.getLabelText(ee,E,L,"y",v,ie,{itemType:ga,value:ee,datum:E,xKey:D,yKey:L,xName:N,yName:T}),_i=ie.spacing+(typeof ie.padding=="number"?ie.padding:0),ma={index:w,series:this,itemType:ye,datum:E,datumIndex:w,cumulativeValue:G??0,xValue:V,yValue:ee,yKey:L,xKey:D,x:Q.x,y:Q.y,width:Q.width,height:Q.height,midPoint:Ne,crisp:k,label:{text:Di,...WE({isUpward:(ee??-1)>=0!==d,isVertical:!l,placement:ie.placement,spacing:_i,rect:Q})}};u.nodeData.push(ma),u.labelData.push(ma)}const R=this.properties.line.enabled;return x!=null&&R&&(u.pointData=g),u}updateSeriesItemTypes(){const{dataModel:e,seriesItemTypes:t,processedData:i}=this;if(!e||!i)return;t.clear();const o=e.resolveProcessedDataIndexById(this,"yCurrentPositive"),s=e.resolveProcessedDataIndexById(this,"yCurrentNegative"),a=e.resolveProcessedDataIndexById(this,"totalTypeValue"),n=i.domain.values[o]??[],r=i.domain.values[s]??[];n.length>0&&t.add("positive"),r.length>0&&t.add("negative");const l=i?.domain.values[a];if(l)for(const c of l)(c==="total"||c==="subtotal")&&t.add("total")}isSubtotal(e){return e==="subtotal"}isTotal(e){return e==="total"}nodeFactory(){return new o1}getSeriesItemType(e,t){return t??(e?"positive":"negative")}getItemConfig(e){switch(e){case"positive":return this.properties.item.positive;case"negative":return this.properties.item.negative;case"subtotal":case"total":return this.properties.item.total}}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e,o=t??[];return i.update(o)}getItemStyle(e,t,i,o="total"){const{properties:s}=this,{datumIndex:a=0,datum:n}=e??{},r=o==="subtotal"?"total":o,l=s.item[r],c=this.getHighlightStyle(t,a,i),h=zS(c,s.getStyle(o)),{itemStyler:d}=l;let u=h;if(d!=null&&e!=null){const g=this.cachedDatumCallback(KS(a,t?"highlight":"node"),()=>{const m=this.makeItemStylerParams(o,a,n,t,u);return this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`,"item",r],this.callWithContext(d,m))});g&&(u=zS(g,u))}return u}makeItemStylerParams(e,t,i,o,s){const{id:a,properties:n}=this,{xKey:r,yKey:l}=n,c=this.ctx.highlightManager?.getActiveHighlight(),h=this.getHighlightStateString(c,o,t),d=this.filterItemStylerFillParams(s.fill)??s.fill;return{seriesId:a,itemType:e,datum:i,xKey:r,yKey:l,highlightState:h,...s,fill:d}}updateDatumStyles({datumSelection:e,isHighlight:t}){e.each((i,o)=>{o.style=this.getItemStyle(o,t,void 0,o.itemType)})}updateDatumNodes({datumSelection:e,isHighlight:t}){const{contextNodeData:i}=this;if(!i)return;const o=this.ctx.highlightManager.getActiveHighlight(),s=this.getCategoryDirection()===lc.X,a=this.getShapeFillBBox();e.each((n,r)=>{const l=r.style??i.styles[r.itemType][this.getHighlightState(o,t,r.datumIndex)];n.setStyleProperties(l,a),n.cornerRadius=l.cornerRadius??0,n.visible=s?r.width>0:r.height>0,n.crisp=r.crisp})}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e;if(t.length===0)return i.update([]);const o=t.filter(s=>{const{label:a}=this.getItemConfig(s.itemType);return a.enabled});return i.update(o)}updateLabelNodes({labelSelection:e,isHighlight:t}){const i={itemType:"positive",xKey:this.properties.xKey,xName:this.properties.xName??this.properties.xName,yKey:this.properties.yKey,yName:this.properties.yName??this.properties.yName},o=this.ctx.highlightManager?.getActiveHighlight();e.each((s,a)=>{i.itemType=a.itemType;const n=this.getHighlightStyle(t,a.datumIndex)?.opacity??1;s.visible=!0,s.fillOpacity=n;const r=this.getItemConfig(a.itemType).label;UE(this,s,i,r,a.label,t,o)})}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,properties:s}=this,{xKey:a,xName:n,yKey:r,yName:l,tooltip:c,legendItemName:h}=s,d=this.getCategoryAxis(),u=this.getValueAxis();if(!i||!o||!d||!u)return;const g=o.dataSources.get(this.id)?.data[e],m=i.resolveKeysById(this,"xValue",o)[e],y=i.resolveColumnById(this,"yRaw",o)[e],S=i.resolveColumnById(this,"yCurrentTotal",o),x=i.resolveColumnById(this,"totalTypeValue",o);if(m==null)return;const b=x[e],f=(y??0)>=0,v=this.getSeriesItemType(f,b);let k;if(this.isTotal(b))k=S[e];else if(this.isSubtotal(b)){k=S[e];for(let I=e-1;I>=0;I-=1)if(this.isSubtotal(x[I])){k=k-S[I];break}}else k=y;const A=this.contextNodeData?.nodeData?.[e],M=this.getItemStyle(A,!1,void 0,A?.itemType);return this.formatTooltipWithContext(c,{heading:this.getAxisValueText(d,"tooltip",m,g,a,h),symbol:this.legendItemSymbol(v),data:[{label:l,fallbackLabel:r,value:this.getAxisValueText(u,"tooltip",k,g,r,h),missing:Za.isTooltipValueMissing(y)}]},{seriesId:t,datum:g,title:l,itemType:v,xKey:a,xName:n,yKey:r,yName:l,...M})}legendItemSymbol(e){const{fill:t,stroke:i,fillOpacity:o,strokeOpacity:s,strokeWidth:a,lineDash:n,lineDashOffset:r}=this.getItemConfig(e);return{marker:{fill:t,stroke:i,fillOpacity:o,strokeOpacity:s,strokeWidth:a,lineDash:n,lineDashOffset:r}}}getLegendData(e){if(e!=="category")return[];const{id:t,seriesItemTypes:i}=this,o=[],s=n=>n.charAt(0).toUpperCase()+n.substring(1),{showInLegend:a}=this.properties;for(const n of i){const{name:r}=this.getItemConfig(n);o.push({legendType:"category",id:t,itemId:KS(n),seriesId:t,enabled:!0,label:{text:r??s(n)},symbol:this.legendItemSymbol(n),hideInLegend:!a,isFixed:!0})}return o}toggleSeriesItem(){}animateEmptyUpdateReady(e){const{datumSelection:t,labelSelection:i,contextData:o}=e,s=jE(XE(this.isVertical(),this.axes,"normal"),"unknown");s1.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],s),qE(this,"labels",this.ctx.animationManager,i);const{pointData:a}=o;a&&(this.isVertical()?this.animateConnectorLinesVertical(e):this.animateConnectorLinesHorizontal(e))}animateConnectorLinesHorizontal(e){const{pointData:t=[]}=e.contextData,[i]=e.paths,{path:o}=i;this.updateLineNode(i);const s=this.getValueAxis(),a=s?.isReversed(),n=a?(h,d)=>h<d:(h,d)=>h>d,r=s?.scale.convert(0),l=t.reduce((h,d)=>(n(d.x,h)&&(h=d.x),h),a?1/0:0),c=(h,d,u,g,m)=>(h-d)/(u-d)*(m-g)+g;this.ctx.animationManager.animate({id:`${this.id}_connectors`,groupId:this.id,phase:"initial",from:r,to:l,ease:BS,collapsable:!1,onUpdate(h){o.clear(!0);for(const[d,u]of t.entries()){const g=c(h,r,l,r,u.x),m=c(h,r,l,r,u.x2);d!==0&&o.lineTo(g,u.y),o.moveTo(m,u.y2)}i.checkPathDirty()},onStop:()=>this.resetConnectorLinesPath(e)})}animateConnectorLinesVertical(e){const{pointData:t=[]}=e.contextData,[i]=e.paths,{path:o}=i;this.updateLineNode(i);const s=this.getValueAxis(),a=s?.isReversed(),n=a?(h,d)=>h>d:(h,d)=>h<d,r=s?.scale.convert(0),l=t.reduce((h,d)=>(n(d.y,h)&&(h=d.y),h),a?0:1/0),c=(h,d,u,g,m)=>(h-d)/(u-d)*(m-g)+g;this.ctx.animationManager.animate({id:`${this.id}_connectors`,groupId:this.id,phase:"initial",from:r,to:l,ease:BS,collapsable:!1,onUpdate(h){o.clear(!0);for(const[d,u]of t.entries()){const g=c(h,r,l,r,u.y),m=c(h,r,l,r,u.y2);d!==0&&o.lineTo(u.x,g),o.moveTo(u.x2,m)}i.checkPathDirty()},onStop:()=>this.resetConnectorLinesPath(e)})}animateReadyResize(e){super.animateReadyResize(e),this.resetConnectorLinesPath(e)}updatePaths(e){this.resetConnectorLinesPath({contextData:e.contextData,paths:e.paths})}resetConnectorLinesPath({contextData:e,paths:t}){if(t.length===0)return;const[i]=t;this.updateLineNode(i);const{path:o}=i;o.clear(!0);const{pointData:s}=e;if(s){for(const[a,n]of s.entries())a!==0&&o.lineTo(n.x,n.y),o.moveTo(n.x2,n.y2);i.checkPathDirty()}}updateLineNode(e){const{stroke:t,strokeWidth:i,strokeOpacity:o,lineDash:s,lineDashOffset:a}=this.properties.line;e.setProperties({fill:void 0,stroke:t,strokeWidth:i,strokeOpacity:o,lineDash:s,lineDashOffset:a,lineJoin:"round",pointerEvents:Za.PointerEvents.None})}isLabelEnabled(){const{positive:e,negative:t,total:i}=this.properties.item;return e.label.enabled||t.label.enabled||i.label.enabled}computeFocusBounds({datumIndex:e}){return i1(this,this.contextNodeData?.nodeData[e])}hasItemStylers(){const{positive:e,negative:t,total:i}=this.properties.item;return e.itemStyler!=null||e.label.itemStyler!=null||t.itemStyler!=null||t.label.itemStyler!=null||i.itemStyler!=null||i.label.itemStyler!=null}};Fp.className="WaterfallSeries",Fp.type="waterfall";import{_ModuleSupport as r1}from"ag-charts-community";import{arrayOfDefs as l1,commonSeriesOptionsDefs as c1,constant as h1,positiveNumber as d1,required as qa,string as $s,union as p1}from"ag-charts-core";var{waterfallSeriesThemeableOptionsDef:u1}=r1,g1={...u1,...c1,type:qa(h1("waterfall")),xKey:qa($s),yKey:qa($s),xKeyAxis:$s,yKeyAxis:$s,xName:$s,yName:$s,totals:l1({totalType:qa(p1("total","subtotal")),index:qa(d1),axisLabel:qa($s)},"a total definition options array")};import{_ModuleSupport as Hp}from"ag-charts-community";var{FILL_GRADIENT_LINEAR_KEYED_DEFAULTS:m1,FILL_IMAGE_DEFAULTS:y1,FILL_PATTERN_KEYED_DEFAULTS:f1}=Hp;function Wp(e,t){return{fill:{$applySwitch:[{$path:"type"},{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$path:[`/${t}`,{$palette:"fill"},{$palette:"fills"}]},{$palette:`${e}.fill`}]},["gradient",m1(e)],["image",y1],["pattern",f1(e)]]},stroke:{$palette:`${e}.stroke`},strokeWidth:{$isUserOption:["./stroke",2,0]},label:{...Hp.LABEL_BOXING_DEFAULTS,enabled:!1,fontStyle:void 0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},formatter:void 0,placement:"outside-end",padding:{$isUserOption:["./spacing",0,6]}}}}var x1={series:{item:{positive:Wp("altUp",0),negative:Wp("altDown",1),total:Wp("neutral",2)},line:{stroke:{$palette:"neutral.stroke"},strokeOpacity:1,lineDash:[0],lineDashOffset:0,strokeWidth:2},highlight:Hp.singleSeriesHighlightStyle()},legend:{enabled:!0,toggleSeries:!1}},{DIRECTION_SWAP_AXES:S1}=EE,Kp={type:"series",name:"waterfall",chartType:"cartesian",enterprise:!0,solo:!0,version:RE,dependencies:[OE],options:g1,defaultAxes:S1,axisKeys:{[rc.X]:"xKeyAxis",[rc.Y]:"yKeyAxis"},axisKeysFlipped:{[rc.X]:"yKeyAxis",[rc.Y]:"xKeyAxis"},themeTemplate:x1,create:e=>new Fp(e)},GS={width:yi,height:yi,grip:Zn,fill:Wl,stroke:Wl,strokeWidth:yi,cornerRadius:yi},zt=["cursor","highlightStyle","listeners","nodeClickRange","showInLegend","showInMiniChart","tooltip","visible","xName","yName"],$S=[...zt,"errorBar","label","legendItemName"],YS=[...zt,"direction","legendItemName","minName","q1Name","medianName","q3Name","maxName"],US=[...zt,"title","label","labelKey","labelName","sizeName"],jS=[...zt,"title","label","colorName","textAlign","verticalAlign","itemPadding","colorRange"],XS=[...zt,"label"],ZS=[...zt,"errorBar","title","label"],qS=[...zt,"label","yLowName","yHighName"],QS=[...zt,"direction","label","yLowName","yHighName"],JS=[...zt,"errorBar","title","label","labelKey","labelName"],eb=[...zt,"direction"],b1={enabled:Zn,height:yi,spacing:yi,cornerRadius:fx,mask:{fill:Wl,fillOpacity:BT,stroke:Wl,strokeWidth:yi},minHandle:GS,maxHandle:GS,miniChart:{enabled:Zn,padding:{top:yi,bottom:yi},label:{enabled:Zn,avoidCollisions:Zn,spacing:yi,format:_T,formatter:RT(VT),interval:{minSpacing:yi,maxSpacing:yi,values:PT,step:fx},...ET},series:OT(zT({area:jt(IT.options,[...zt,"type"]),bar:jt(LT.options,[...$S,"type"]),"box-plot":jt(ip.options,[...YS,"type"]),bubble:jt(NT.options,[...US,"type"]),candlestick:jt(Ul.options,[...zt,"type"]),heatmap:jt(Sp.options,[...jS,"type"]),histogram:jt(CT.options,[...XS,"type"]),line:jt(TT.options,[...ZS,"type"]),ohlc:jt(ql.options,[...zt,"type"]),"range-area":jt(oc.options,[...qS,"type"]),"range-bar":jt(nc.options,[...QS,"type"]),scatter:jt(wT.options,[...JS,"type"]),waterfall:jt(Kp.options,[...eb,"type"])},"miniChart series options"))}};import"ag-charts-community";import{FONT_SIZE_RATIO as v1}from"ag-charts-core";var k1=["area","bar","bubble","candlestick","heatmap","histogram","line","ohlc","range-area","range-bar","scatter","waterfall"],D1=["itemStyler","simpleItemStyler","direction","fill","fillGradientDefaults","fillPatternDefaults","fillImageDefaults","fillOpacity","shadow","focusPriority","highlight","lineDash","lineDashOffset","strokeWidth"];function tb(e,t){return{$merge:[{$switch:[t,{},[["area","line","range-area"],{marker:{enabled:{$isUserOption:["/series/$index/marker/enabled",{$path:["/series/$index/marker/enabled",!1]},!1]}}}]]},{$omit:[{$switch:[t,zt,["bar",$S],["box-plot",YS],["bubble",US],["heatmap",jS],["histogram",XS],["line",[...ZS,...D1]],["range-area",qS],["range-bar",QS],["scatter",JS],["waterfall",eb]]},e]}]}}var A1={enabled:!1,height:{$if:[{$path:"./miniChart/enabled"},40,18]},cornerRadius:4,mask:{fill:{$ref:"foregroundColor"},fillOpacity:.1,stroke:{$ref:"borderColor"},strokeWidth:1},minHandle:{fill:{$ref:"chartBackgroundColor"},stroke:{$ref:"borderColor"},strokeWidth:1,width:12,height:24,cornerRadius:4},maxHandle:{fill:{$ref:"chartBackgroundColor"},stroke:{$ref:"borderColor"},strokeWidth:1,width:12,height:24,cornerRadius:4},miniChart:{enabled:!1,label:{color:{$ref:"textColor"},fontSize:{$rem:v1.SMALLER},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},spacing:5},padding:{top:0,bottom:0},series:{$apply:[tb({$path:"/series/$index"},{$path:["/navigator/miniChart/series/$index/type",{$path:["type",{$path:"/series/$index/type"}]}]}),{$if:[{$or:k1.map(e=>({$eq:[{$path:"/series/0/type"},e]}))},{$map:[tb({$value:"$1"},{$path:"/series/$index/type"}),{$path:"/series"}]},void 0]}]}}},Gp={type:"plugin",name:"navigator",chartType:"cartesian",enterprise:!0,version:iT,options:b1,themeTemplate:A1,create:e=>new _a(e)};import{VERSION as M1}from"ag-charts-community";import{and as I1,arrayLength as L1,arrayOf as N1,arrayOfDefs as C1,boolean as T1,callback as w1,date as P1,number as ib,or as ob,toolbarButtonOptionsDefs as O1}from"ag-charts-core";import{_ModuleSupport as R1}from"ag-charts-community";import{AbstractModuleInstance as E1,ChartAxisDirection as $p,PropertiesArray as _1,Property as sb}from"ag-charts-core";import{Property as B1,ToolbarButtonProperties as V1}from"ag-charts-core";var ab=class extends V1{};p([B1],ab.prototype,"value",2);var{userInteraction:z1,LayoutElement:F1,Toolbar:H1}=R1,Yp=class extends E1{constructor(e){super(),this.ctx=e,this.enabled=!1,this.buttons=new _1(ab),this.verticalSpacing=10,this.container=e.domManager.addChild("canvas-overlay","range-buttons"),this.container.role="presentation",this.toolbar=new H1(this.ctx,"ariaLabelRangesToolbar","horizontal"),this.toolbar.addClass("ag-charts-range-buttons"),this.container.append(this.toolbar.getElement()),this.cleanup.register(this.toolbar.addToolbarListener("button-pressed",this.onButtonPress.bind(this)),e.layoutManager.registerElement(F1.ToolbarBottom,this.onLayoutStart.bind(this)),e.eventsHub.on("zoom:change-complete",this.onZoomChanged.bind(this)),this.teardown.bind(this))}teardown(){this.toolbar.getElement().remove(),this.toolbar.destroy()}onLayoutStart({layoutBox:e}){const{buttons:t,ctx:i,enabled:o,toolbar:s,verticalSpacing:a}=this;if(!o||!i.zoomManager.isZoomEnabled()){s.setHidden(!0);return}s.setHidden(!1),s.updateButtons(t);const n=s.getBounds().height;s.setBounds({x:e.x,y:e.y+e.height-n,width:e.width,height:n}),e.shrink({bottom:n+a})}onZoomChanged(){this.toolbar.clearActiveButton()}onButtonPress({button:{index:e}}){const{zoomManager:t}=this.ctx,i=this.buttons.at(e);if(!i)return;const{value:o}=i,s=z1(`zoom-range-button-${e}`);o==null?t.resetZoom(s):typeof o=="number"?t.extendToEnd(s,$p.X,o):Array.isArray(o)?t.updateWith(s,$p.X,()=>o):typeof o=="function"&&t.updateWith(s,$p.X,o),this.toolbar.toggleActiveButtonByIndex(e)}};p([sb],Yp.prototype,"enabled",2),p([sb],Yp.prototype,"buttons",2);var nb=1e3*60*60*24,Up=nb*30,W1=nb*365,jp={type:"plugin",name:"ranges",chartType:"cartesian",enterprise:!0,version:M1,options:{enabled:T1,buttons:C1({...O1,value:ob(ib,I1(N1(ob(ib,P1)),L1(2,2)),w1)},"range button options array")},themeTemplate:{enabled:!1,buttons:{$shallowSimple:[{label:"toolbarRange1Month",ariaLabel:"toolbarRange1MonthAria",value:Up},{label:"toolbarRange3Months",ariaLabel:"toolbarRange3MonthsAria",value:3*Up},{label:"toolbarRange6Months",ariaLabel:"toolbarRange6MonthsAria",value:6*Up},{label:"toolbarRangeYearToDate",ariaLabel:"toolbarRangeYearToDateAria",value:(e,t)=>[new Date(`${new Date(t).getFullYear()}-01-01`).getTime(),void 0]},{label:"toolbarRange1Year",ariaLabel:"toolbarRange1YearAria",value:W1},{label:"toolbarRangeAll",ariaLabel:"toolbarRangeAllAria",value:void 0}]}},create:e=>new Yp(e)};import{VERSION as K1}from"ag-charts-community";import{DEFAULT_CAPTION_LAYOUT_STYLE as G1}from"ag-charts-core";import{_ModuleSupport as rb}from"ag-charts-community";import{AbstractModuleInstance as $1,BaseProperties as Y1,ChartAxisDirection as U1,Property as Lt,ZIndexMap as j1,cachedTextMeasurer as Xp,calcLineHeight as X1}from"ag-charts-core";var{LayoutElement:Z1,Group:q1,Label:ir,Rect:Q1,Text:et}=rb,lb={ohlc:62,candlestick:62,"hollow-candlestick":62,line:96,"step-line":96,hlc:184,"high-low":800},J1={up:"positive",down:"negative"},e_={hlc:"altNeutral"},Zp=class extends Y1{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1}};p([Lt],Zp.prototype,"fill",2),p([Lt],Zp.prototype,"fillOpacity",2);var Ft=class extends $1{constructor(e){super(),this.ctx=e,this.enabled=!1,this.openKey=void 0,this.highKey=void 0,this.lowKey=void 0,this.closeKey=void 0,this.volumeKey=void 0,this.title=new ir,this.positive=new ir,this.negative=new ir,this.neutral=new ir,this.altNeutral=new ir,this.background=new Zp,this.layoutStyle="block",this.id="status-bar",this.layer=new q1({name:"StatusBar",zIndex:j1.STATUS_BAR}),this.labelGroup=this.layer.appendChild(new rb.TranslatableGroup),this.backgroundNode=this.labelGroup.appendChild(new Q1),this.labels=[{label:"O",configuration:2,title:this.labelGroup.appendChild(new et),value:this.labelGroup.appendChild(new et),id:"openValue",key:"openKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"H",configuration:16,title:this.labelGroup.appendChild(new et),value:this.labelGroup.appendChild(new et),id:"highValue",key:"highKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"H",configuration:256,title:this.labelGroup.appendChild(new et),value:this.labelGroup.appendChild(new et),style:"neutral",id:"highValue",key:"highKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"L",configuration:8,title:this.labelGroup.appendChild(new et),value:this.labelGroup.appendChild(new et),id:"lowValue",key:"lowKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"L",configuration:512,title:this.labelGroup.appendChild(new et),value:this.labelGroup.appendChild(new et),style:"neutral",id:"lowValue",key:"lowKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"C",configuration:4,title:this.labelGroup.appendChild(new et),value:this.labelGroup.appendChild(new et),id:"closeValue",key:"closeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"C",configuration:128,title:this.labelGroup.appendChild(new et),value:this.labelGroup.appendChild(new et),id:"closeValue",key:"closeKey",style:"neutral",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"",configuration:64,title:this.labelGroup.appendChild(new et),value:this.labelGroup.appendChild(new et),style:"neutral",id:"closeValue",key:"closeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2})},{label:"Vol",configuration:32,title:this.labelGroup.appendChild(new et),value:this.labelGroup.appendChild(new et),id:"volumeValue",key:"volumeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2})}],this.highlightManager=e.highlightManager,this.labelGroup.visible=!1,this.cleanup.register(e.scene.attachNode(this.layer),e.layoutManager.registerElement(Z1.Overlay,t=>this.startPerformLayout(t)),e.eventsHub.on("layout:complete",t=>this.onLayoutComplete(t)),e.eventsHub.on("highlight:change",()=>this.updateHighlight()),e.eventsHub.on("data:update",t=>{this.chartData=t}))}updateDomainsFromSeries(){if(!this.enabled)return;const e=this.ctx.chartService.series;if(e.length===0)return;let t,i;for(const o of e){const a=o.getDomain(U1.Y)?.domain;!Array.isArray(a)||a.length<2||(o.type==="bar"?i=[a[0],a.at(-1)]:t=[a[0],a.at(-1)])}for(const o of this.labels){if(this[o.key]==null){o.domain=void 0;continue}o.domain=o.key==="volumeKey"?i:t}}startPerformLayout({layoutBox:e}){if(this.labelGroup.translationX=0,this.labelGroup.translationY=0,!this.enabled){this.labelGroup.visible=!1;return}this.updateDomainsFromSeries();const t=4,i=12,o=0,s=8;this.labelGroup.translationY=e.y+o;const a=Math.max(this.title.fontSize,this.positive.fontSize,this.negative.fontSize),n=X1(a),r=lb[this.getChartType()]??0;let l=0,c,h="alphabetic";if(this.layoutStyle==="block")e.shrink(o+n+s,"top"),c=a+(n-a)/2;else{const{title:d}=this.ctx.chartService;if(h="top",c=o+d.padding,d.enabled){const u=d.node.getBBox();l=u.x+u.width+i}else l=d.padding}for(const{label:d,configuration:u,title:g,value:m,domain:y,formatter:S}of this.labels){if(y==null||!(r&u)){g.visible=!1,m.visible=!1;continue}const x=Xp(this.positive),b=Xp(this.negative),f=Math.max(x.textWidth(S.format(y[0])),x.textWidth(S.format(y[1])),b.textWidth(S.format(y[0])),b.textWidth(S.format(y[1])));g.visible=!0,m.visible=!0;const v=Xp(this.title).measureLines(d);g.setFont(this.title),g.fill=this.title.color,g.text=d,g.textBaseline=h,g.y=c,g.x=l,l+=v.width+t,m.textBaseline=h,m.y=c,m.x=l,l+=f+i}this.backgroundNode.x=0,this.backgroundNode.y=0,this.backgroundNode.width=l-i,this.backgroundNode.height=n+o+s,this.backgroundNode.fill=this.background.fill,this.backgroundNode.fillOpacity=this.background.fillOpacity}onLayoutComplete(e){this.labelGroup.translationX=e.series.rect.x,this.updateHighlight()}updateHighlight(){if(!this.enabled)return;const e=this.highlightManager.getActiveHighlight(),t=e?.datum??this.chartData?.data?.at(-1);if(t==null){this.labelGroup.visible=!1;return}this.labelGroup.visible=!0;const i=e?.itemId;let o=i==null?void 0:J1[i];o==null&&this.openKey!=null&&this.closeKey!=null&&(t[this.openKey]<t[this.closeKey]?o="positive":o="negative");for(const{domain:s,value:a,key:n,formatter:r,style:l}of this.labels){if(s==null)continue;let c=l??o??"neutral";c==="neutral"&&(c=e_[this.getChartType()]??c);const h=this[n],d=h==null?void 0:t?.[h];a.setFont(this[c]),a.fill=this[c].color,a.text=typeof d=="number"?r.format(d):""}}getChartType(){let e=this.ctx.chartService.publicApi?.getOptions()?.chartType;return(e==null||lb[e]==null)&&(e="candlestick"),e}};p([Lt],Ft.prototype,"enabled",2),p([Lt],Ft.prototype,"openKey",2),p([Lt],Ft.prototype,"highKey",2),p([Lt],Ft.prototype,"lowKey",2),p([Lt],Ft.prototype,"closeKey",2),p([Lt],Ft.prototype,"volumeKey",2),p([Lt],Ft.prototype,"title",2),p([Lt],Ft.prototype,"positive",2),p([Lt],Ft.prototype,"negative",2),p([Lt],Ft.prototype,"neutral",2),p([Lt],Ft.prototype,"altNeutral",2),p([Lt],Ft.prototype,"background",2),p([Lt],Ft.prototype,"layoutStyle",2);var qp={type:"plugin",name:"statusBar",chartType:"cartesian",enterprise:!0,version:K1,themeTemplate:{enabled:!1,layoutStyle:G1,title:{color:{$ref:"textColor"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}},positive:{color:{$palette:"up.stroke"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}},negative:{color:{$palette:"down.stroke"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}},neutral:{color:{$palette:"neutral.stroke"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}},background:{fill:{$ref:"chartBackgroundColor"},fillOpacity:.5},altNeutral:{color:"gray",fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}}},create:e=>new Ft(e)};import{VERSION as t_}from"ag-charts-community";import{boolean as Qp,string as i_,union as o_}from"ag-charts-core";import{_ModuleSupport as s_}from"ag-charts-community";import{AsyncAwaitQueue as a_,BaseProperties as n_,ChartAxisDirection as Ys,ChartUpdateType as pc,Debug as r_,Logger as cb,ObserveChanges as Qa,Property as Ja,arraysEqual as hb,findMinMax as db,isDate as l_,isDefined as c_,isFiniteNumber as uc,isObjectWithStringProperty as h_,unique as d_}from"ag-charts-core";import"ag-charts-community";import{clamp as p_,isNumberEqual as pb,jsonDiff as u_}from"ag-charts-core";var Si=0,tt=1,Us=tt-Si,ub="end",gb="middle",mb=300,gc=(e,t=Si,i=tt)=>p_(t,e,i);function Jp(){return{x:{min:Si,max:tt},y:{min:Si,max:tt}}}function it(e){return e.x.max-e.x.min}function Qt(e){return e.y.max-e.y.min}function yb(e,t){return pb(e.min,t.min)&&pb(e.max,t.max)}function mc(e,t){return yb(e.x,t.x)&&yb(e.y,t.y)}function yc(e){return mc(e,Jp())}function ot(e){return{x:{min:e?.x?.min??Si,max:e?.x?.max??tt},y:{min:e?.y?.min??Si,max:e?.y?.max??tt}}}function Do(e,t,i){if(!e)return{x:0,y:0};const o=gc(t-e.x,0,e.x+e.width),s=gc(i-e.y,0,e.y+e.height),a=1/e.width*o,n=1-1/e.height*s;return{x:gc(a),y:gc(n)}}function js(e,t,i){return{x:{min:e.x.min+t,max:e.x.max+t},y:{min:e.y.min+i,max:e.y.max+i}}}function fc(e,t,i){return{x:{min:e.x.min,max:e.x.min+it(e)*t},y:{min:e.y.min,max:e.y.min+Qt(e)*i}}}function fb(e,t,i){const o=it(e),s=Qt(e),a=e.x.min+o/2,n=e.y.min+s/2;return{x:{min:a-o*t/2,max:a+o*t/2},y:{min:n-s*i/2,max:n+s*i/2}}}function Jt(e,t,i,o){const{min:s,max:a}=t,n=s+(a-s)/2,r=e.max-e.min;switch(i){case"start":return{min:s,max:t.min+r};case"end":return{min:t.max-r,max:a};case"middle":return{min:n-r/2,max:n+r/2};case"pointer":return g_(e,t,o??n);default:return{min:s,max:a}}}function g_(e,t,i){const o=e.max-e.min,s=t.max-t.min,a=i*(1-(s-o)),n=i-a,r=e.min+n,l=e.max+n;return{min:r,max:l}}function m_(e,t,i){return{x:{min:e.x.min*t,max:e.x.max*t},y:{min:e.y.min*i,max:e.y.max*i}}}function bi(e){return{x:xc(e.x),y:xc(e.y)}}function xc(e){const t=e.max-e.min;let i=e.max>tt?tt-t:e.min,o=e.min<Si?t:e.max;return i=Math.max(Si,i),o=Math.min(tt,o),{min:i,max:o}}function xb(e){const t=e.getCoreZoom(),i=e.getRestoredZoom();return u_(t,i)!=null}var{CartesianAxis:eu,ContinuousScale:Sb,TimeScale:y_,UnitTimeScale:f_,TooltipManager:x_}=s_,Zi=r_.create("sync");function bb(e,t,i){const o=e.getKeys(t),s=e.getKeys(i);return e.shouldFlipXY?.()?[s,o]:[o,s]}function tu(e="x"){switch(e){case"x":return[Ys.X];case"y":return[Ys.Y];case"xy":return[Ys.X,Ys.Y]}}function S_(e,t,i){return y_.is(e)||f_.is(e)?!hb(t.map(o=>o?.valueOf()),i.map(o=>o?.valueOf())):!hb(t,i)}var ns=class extends n_{constructor(e){super(),this.moduleContext=e,this.enabled=!1,this.axes="x",this.nodeInteraction=!0,this.zoom=!0,this.domainMode="id",this.domainSync=new a_}updateSiblings(e){const{syncManager:t}=this.moduleContext;for(const i of t.getGroupSiblings(e??this.groupId))Zi("ChartSync.updateSiblings()",i.id,i),this.updateChart(i)}updateChart(e,t=pc.PROCESS_DOMAIN){Zi("ChartSync.updateChart()",e.id,pc[t],e),t===pc.PROCESS_DOMAIN?e.ctx.updateService.update(t,{forceNodeDataRefresh:!0}):e.ctx.updateService.update(t)}enabledZoomSync(){const{eventsHub:e}=this.moduleContext;this.disableZoomSync?.(),this.disableZoomSync=e.on("zoom:change-complete",t=>this.onZoom(t))}onZoom(e){const{syncManager:t}=this.moduleContext;for(const i of t.getGroupSiblings(this.groupId)){if(!i.modulesManager.getModule("sync")?.zoom)continue;const s=i.modulesManager.getModule("zoom");if(!s)continue;const a=this.prepareZoomUpdate();e.source!=="sync"&&(Zi("ChartsSyncManager.enabledZoomSync()",i.id,a),s.updateSyncZoom(a))}}enabledNodeInteractionSync(){this.disableNodeInteractionSync?.(),this.disableNodeInteractionSync=this.moduleContext.eventsHub.on("highlight:change",this.onHighlightChange.bind(this))}onHighlightChange(e){const{syncManager:t}=this.moduleContext;if(e.callerId.endsWith("-sync"))return;Zi("ChartSync.onHighlightChange()",e);const i=e.currentHighlight?.series,[o]=tu(this.axes),s=o===Ys.X?Ys.Y:Ys.X,[a,n]=i?bb(i,o,s):[],r=Yn(e.currentHighlight);let l=a?.[0]?r?.[a[0]]:void 0,c=!1;if(l_(l)&&(c=!0,l=l.getTime()),!e.currentHighlight?.datum){for(const d of t.getGroupSiblings(this.groupId))d.modulesManager.getModule("sync")?.nodeInteraction&&(d.ctx.highlightManager.updateHighlight(`${d.id}-sync`,void 0,!0),d.ctx.tooltipManager.removeTooltip(`${d.id}-sync`,void 0,!0));return}const h=t.getGroupSyncMode(this.groupId)==="multi-series";this.findMatchingHighlightNodes(o,s,h?n:[],c,l,e)}findMatchingHighlightNodes(e,t,i,o,s,a){const{syncManager:n}=this.moduleContext;Zi("ChartSync.findMatchingHighlightNodes()",{mainDirection:e,secondaryKeys:i});for(const r of n.getGroupSiblings(this.groupId)){if(!r.modulesManager.getModule("sync")?.nodeInteraction)continue;let c=!1;for(const h of r.axes){if(!eu.is(h)||h.direction!==e)continue;const d=r.series.filter(u=>{if(!u.visible)return!1;if(i.length>0){const[,g]=bb(u,e,t);return i.every(m=>g.includes(m))}return!0}).map(this.findMatchingNodes(h,e,o,s)).filter(c_);if(d.length===1&&d[0]?.nodeDatum!==r.ctx.highlightManager.getActiveHighlight()){this.dispatchHighlightUpdate(r,d[0].nodeDatum),c=!0;break}}c||(Zi("ChartSync.findMatchingHighlightNodes() - no matching nodes",r.id,a),this.dispatchHighlightUpdate(r))}}findMatchingNodes(e,t,i,o){return s=>{if(s.getKeyAxis(e.direction)!==e.id)return;const n=s.contextNodeData?.nodeData??[];if(!n?.length)return;const r=n[0],l=`${t}Key`;if(!h_(r,l))return;const c=r[l],h=n.find(d=>{const u=d.datum[c];return i?u.getTime()===o:u===o});return h?{series:s,nodeDatum:h}:null}}dispatchHighlightUpdate(e,t){Zi("ChartSync.dispatchHighlightUpdate()",e.id,t);const i=t==null;e.ctx.highlightManager.updateHighlight(`${e.id}-sync`,t,i);const o=t?.series.tooltipEnabled??e.tooltip.enabled;if(t&&o){const s=e.seriesAreaBoundingBox,a=s.x+(t.midPoint?.x??t.point?.x??0),n=s.y+(t.midPoint?.y??t.point?.y??0),r=x_.makeTooltipMeta({type:"pointermove",canvasX:a,canvasY:n},t.series,t,void 0);e.ctx.tooltipManager.updateTooltip(`${e.id}-sync`,r,e.getTooltipContent(t.series,t.datumIndex,t,"tooltip"))}else e.ctx.tooltipManager.removeTooltip(`${e.id}-sync`,void 0,!0);this.updateChart(e,pc.SERIES_UPDATE)}async getSyncedDomain(e){if(!eu.is(e)||this.axes!=="xy"&&this.axes!==e.direction)return;const{groupState:t,directionDomains:i,idDomains:o,positionDomains:s}=this.updateDomainState(e);return this.validateAxis(e,t),await this.waitForDomainsToBeReady(),this.domainMode==="position"?this.calculateDerivedDomain(e,s):this.domainMode==="direction"?this.calculateDerivedDomain(e,i):this.calculateDerivedDomain(e,o)}updateDomainState(e){var t,i,o,s,a;const{syncManager:n}=this.moduleContext,r=n.getChart().id,l=e.id,c=n.getGroupState(this.groupId);if(!c)throw new Error("AG Charts - no GroupState for groupId: "+this.groupId);const h=c.domains??(c.domains={}),d=h[t=e.direction]??(h[t]={derived:[],sources:{},dirty:!0}),u=(i=d.sources)[r]??(i[r]={});u[l]=e.dataDomain.domain,d.dirty=!0;const g=c.domainsById??(c.domainsById={}),m=g[l]??(g[l]={derived:[],sources:{},dirty:!0}),y=(o=m.sources)[r]??(o[r]={});y[l]=e.dataDomain.domain,m.dirty=!0;const S=c.domainsByPosition??(c.domainsByPosition={}),x=S[s=e.position]??(S[s]={derived:[],sources:{},dirty:!0}),b=(a=x.sources)[r]??(a[r]={});return b[l]=e.dataDomain.domain,x.dirty=!0,{groupState:c,directionDomains:d,idDomains:m,positionDomains:x}}validateAxis(e,t){const i=this.moduleContext.syncManager.getGroupSyncMode(this.groupId)==="multi-series";tu(this.axes).includes(e.direction)&&(i?this.validateMultiSeries(e,t):this.validateSingleSeries(e,t))}validateMultiSeries(e,t){const{min:i,max:o,nice:s,reverse:a}=e,n=new Set(e.boundSeries.flatMap(r=>r.getKeys(e.direction)));for(const r of t.members){const{axes:l,modulesManager:c}=r,h=c.getModule("sync"),d=tu(h?.axes),u=l.filter(m=>d.includes(m.direction)).filter(m=>m.boundSeries.some(y=>y.getKeys(m.direction).some(S=>n.has(S))));if(u.length===0)continue;const[g]=u;if(g.min!==i||g.max!==o||g.nice!==s||g.reverse!==a){cb.warnOnce("To allow synchronization, ensure that all synchronized axes with matching keys have matching min, max, nice, and reverse properties."),this.enabled=!1;return}}}validateSingleSeries(e,t){const i=t.members,[{axes:o}]=i,{direction:s,min:a,max:n,nice:r,reverse:l}=e;for(const c of o)if(s===c.direction&&(r!==c.nice||l!==c.reverse||a!==c.min&&(uc(a)||uc(c.min))||n!==c.max&&(uc(n)||uc(c.max)))){cb.warnOnce("To allow synchronization, ensure that all charts have matching min, max, nice, and reverse properties on the synchronized axes."),this.enabled=!1;return}}calculateDerivedDomain(e,t){if(!t.dirty)return t.derived;let i=t.derived;const o=Object.values(t.sources).map(a=>Object.values(a));let s;return Sb.is(e.scale)?s=o.flat(2):s=o.flat().toSorted((a,n)=>a.length>n.length?-1:1).flat(),t.derived=d_(s),Sb.is(e.scale)&&(i=db(i),t.derived=db(t.derived)),t.dirty=!1,S_(e.scale,i,t.derived)&&(Zi(e.id,"updated",{before:i,after:t.derived}),this.updateSiblings()),t.derived}removeAxis(e){if(!eu.is(e)||this.axes!=="xy"&&this.axes!==e.direction)return;const{syncManager:t}=this.moduleContext,i=t.getGroupState(this.groupId),o=t.getChart().id,s=e.id;delete i?.domains?.[e.direction]?.sources?.[o]?.[s],delete i?.domainsByPosition?.[e.position]?.sources?.[o]?.[s],delete i?.domainsById?.[s]?.sources?.[o]?.[s]}async waitForDomainsToBeReady(){const{syncManager:e}=this.moduleContext;let t=0;for(;e.getGroupMembers(this.groupId).some(i=>i.syncStatus==="init");)Zi("ChartSync.waitForDomainsToBeReady() - waiting for all domains to be calculated",this.groupId),await this.domainSync.waitForCompletion(),t++;t>0&&Zi("ChartSync.waitForDomainsToBeReady() - waited for",t,"iterations"),this.domainSync.notify()}prepareZoomUpdate(){const{zoomManager:e}=this.moduleContext,t=e.getZoom();return this.axes==="x"?delete t?.y:this.axes==="y"&&delete t?.x,ot(t)}onEnabledChange(){const{syncManager:e,highlightManager:t}=this.moduleContext;this.enabled?(e.subscribe(this.groupId),t.unhighlightDelay=0):(e.unsubscribe(this.groupId),t.unhighlightDelay=100),this.updateSiblings(),this.onNodeInteractionChange(),this.onZoomChange()}onGroupIdChange(e,t){if(!this.enabled||e===t)return;const{syncManager:i}=this.moduleContext;i.unsubscribe(t),i.subscribe(e),this.updateSiblings(t),this.updateSiblings(e)}onAxesChange(){if(!this.enabled)return;const{syncManager:e}=this.moduleContext;this.updateChart(e.getChart())}onNodeInteractionChange(){this.enabled&&this.nodeInteraction?this.enabledNodeInteractionSync():this.disableNodeInteractionSync?.()}onZoomChange(){this.enabled&&this.zoom?this.enabledZoomSync():this.disableZoomSync?.()}destroy(){const{syncManager:e}=this.moduleContext;e.unsubscribe(this.groupId),this.updateSiblings(),this.disableZoomSync?.()}};ns.className="Sync",p([Ja,Qa(e=>e.onEnabledChange())],ns.prototype,"enabled",2),p([Ja,Qa((e,t,i)=>e.onGroupIdChange(t,i))],ns.prototype,"groupId",2),p([Ja,Qa(e=>e.onAxesChange())],ns.prototype,"axes",2),p([Ja,Qa(e=>e.onNodeInteractionChange())],ns.prototype,"nodeInteraction",2),p([Ja,Qa(e=>e.onZoomChange())],ns.prototype,"zoom",2),p([Ja,Qa(e=>e.onAxesChange())],ns.prototype,"domainMode",2);var iu={type:"plugin",name:"sync",chartType:"cartesian",enterprise:!0,version:t_,options:{enabled:Qp,groupId:i_,axes:o_("x","y","xy"),nodeInteraction:Qp,zoom:Qp},themeTemplate:{enabled:!1},create:e=>new ns(e)};import{VERSION as b_}from"ag-charts-community";import{arrayOfDefs as v_,boolean as ei,or as k_,positiveNumber as D_,ratio as ou,strictUnion as A_,string as M_,toolbarButtonOptionsDefs as I_,undocumented as su,union as Xs}from"ag-charts-core";import{_ModuleSupport as en}from"ag-charts-community";import{AbstractModuleInstance as L_,ActionOnSet as or,ChartAxisDirection as kt,ChartUpdateType as au,Property as ze,ProxyProperty as N_,debounce as vb,entries as C_,roundTo as T_}from"ag-charts-core";import{_ModuleSupport as w_}from"ag-charts-community";import{ZIndexMap as P_}from"ag-charts-core";var kb="#2196f3",O_="#8a8a8a",Db=class extends w_.Rect{constructor(){super(),this.fill=kb,this.fillOpacity=.2,this.zIndex=P_.ZOOM_SELECTION}updateValid(){this.fill=kb}updateInvalid(){this.fill=O_}};Db.className="ZoomRect";import"ag-charts-community";import{ActionOnSet as Ab,BaseProperties as R_,ChartAxisDirection as Ht,Property as Mb,isFiniteNumber as Ib,objectsEqual as E_,strictObjectKeys as __}from"ag-charts-core";var nu=class extends R_{constructor(e){super(),this.onChange=e,this.enabled=!1,this.padding=0}};p([Mb,Ab({changeValue(e){this.onChange({enabled:e,padding:this.padding})}})],nu.prototype,"enabled",2),p([Mb,Ab({changeValue(e){this.onChange({enabled:this.enabled,padding:e})}})],nu.prototype,"padding",2);var B_=class{constructor(e,t,i,o,s){this.properties=e,this.zoomManager=t,this.deps=i,this.manuallyAdjusted=!1,s.register(o.on("zoom:save-memento",a=>this.onSaveMemento(a)),o.on("zoom:load-memento",a=>this.onLoadMemento(a)),o.on("zoom:change-request",a=>this.onChangeRequest(a)))}get enabled(){return this.deps.enabled&&this.properties.enabled&&!this.manuallyAdjusted}onManualAdjustment(e){e===Ht.Y&&(this.manuallyAdjusted=!0)}onChange(e){e.enabled&&this.zoomManager.updateChanges({source:"chart-update",sourceDetail:"internal-autoScaling",changes:this.autoScaleYZoom()??{},isReset:!1})}onChangeRequest(e){if(e.isReset)for(const t of e.changedAxes)e.state[t]?.direction===Ht.Y&&(this.manuallyAdjusted=!1);if(this.enabled){const t=this.autoScaleYZoom(e.state);t&&e.constrainChanges(t)}}onSaveMemento(e){e.memento.autoScaledAxes=this.enabled?[]:["y"]}onLoadMemento(e){const{zoom:t,memento:i,navigatorModule:o,zoomModule:s}=e;if(!o||s){let a=i?.autoScaledAxes?.includes("y");if(i?.rangeY)a??(a=!1),t.y=this.zoomManager.rangeToRatioDirection(Ht.Y,i.rangeY)??{min:0,max:1};else if(i?.ratioY)a??(a=!1),t.y={min:i.ratioY.start??0,max:i.ratioY.end??1};else{a??(a=!0);const n=a?this.getAutoScaleYZoom(t.x):void 0;t.y=n??{min:0,max:1}}a!=null&&(this.manuallyAdjusted=!a)}}getAutoScaleYZoom(e){if(!this.enabled)return;const{padding:t}=this.properties;let i;return this.deps.enableIndependentAxes?i=this.primaryAxisZoom(Ht.Y,e,{padding:t}):i=this.combinedAxisZoom(Ht.Y,e,{padding:t}),e.min===0&&e.max===1?i==null?void 0:{min:0,max:1}:i}autoScaleYZoom(e){const t=this.zoomManager.getZoom();if(t&&e){const o=this.zoomManager.getAxisZooms();for(const s of[Ht.X,Ht.Y])for(const a of __(e))if(o[a]?.direction===s){t[s]=e[a];break}}if(t?.x==null)return;const i=this.getAutoScaleYZoom(t.x);if(!(i==null||E_(t.y,i)))return this.zoomManager.toCoreZoomState({x:t.x,y:i})}zoomBounds(e,t,i,o){const s=e.scale,a=s.range;s.range=[0,1];const n=t.scale,r=n.range;n.range=[0,1];let l=1,c=!1,h=0,d=!1;for(const m of t.boundSeries){if(!m.visible)continue;const{connectsToYAxis:y}=m,S=m.getRange(Ht.Y,[i.min,i.max]);for(const x of S){const b=n.convert(x);Number.isFinite(b)&&(b<l&&(l=b,c=!y||x<0),b>h&&(h=b,d=!y||x>0))}}if(Ib(t.min)&&(l=0),Ib(t.max)&&(h=1),s.range=a,n.range=r,l>=h)return;const u=(c?o:0)+(d?o:0),g=Math.min((h-l)*(1+u),1);if(!(g<=0)){if(c&&d){const m=(h+l)/2;l=m-g/2,h=m+g/2}else!c&&d?h=l+g:c&&!d&&(l=h-g);return l<0?(h+=-l,l=0):h>1&&(l-=h-1,h=1),{min:l,max:h}}}primaryAxisZoom(e,t,{padding:i=0}={}){const o=e===Ht.X?Ht.Y:Ht.X,s=this.zoomManager.getPrimaryAxis(o),a=this.zoomManager.getPrimaryAxis(e);if(!(s==null||a==null))return this.zoomBounds(s,a,t,i)}combinedAxisZoom(e,t,{padding:i=0}={}){const o=this.zoomManager.getAxes(),s=e===Ht.X?Ht.Y:Ht.X,a=new Map;for(const c of o)if(c.direction===s)for(const h of c.boundSeries)a.set(h,c);let n=1,r=0;for(const c of o)if(c.direction===e)for(const h of c.boundSeries){const d=a.get(h);if(d==null)continue;const u=this.zoomBounds(d,c,t,i);if(u==null)return;n=Math.min(n,u.min),r=Math.max(r,u.max)}const l=1e-6;if(n<l&&(n=0),r>1-l&&(r=1),!(n>r))return{min:n,max:r}}};import"ag-charts-community";import{ChartAxisDirection as ru}from"ag-charts-core";var V_=class{update(e,t,i,o,s,a){return this.oldZoom??(this.oldZoom=ot(t===ru.X?{...s,x:a}:{...s,y:a})),this.updateCoords(e.offsetX,e.offsetY),this.updateZoom(t,i,o)}stop(){this.coords=void 0,this.oldZoom=void 0}updateCoords(e,t){this.coords?(this.coords.x2=e,this.coords.y2=t):this.coords={x1:e,y1:t,x2:e,y2:t}}updateZoom(e,t,i){const{coords:o,oldZoom:s}=this;let a=ot(s);if(!o||!s)return e===ru.X?a.x:a.y;const n=Do(i,o.x1,o.y1),r=Do(i,o.x2,o.y2);if(e===ru.X){const c=(r.x-n.x)*it(s);return a.x.max+=c,a.x=Jt(a.x,s.x,t,n.x),a=bi(a),a.x}const l=(r.y-n.y)*Qt(s);return a.y.max-=l,a.y=Jt(a.y,s.y,t,n.y),a=bi(a),a.y}};import{_ModuleSupport as z_}from"ag-charts-community";var{userInteraction:lu}=z_,F_=class{constructor(e,t,i,o,s,a,n){this.eventsHub=e,this.contextMenuRegistry=t,this.zoomManager=i,this.getModuleProperties=o,this.getRect=s,this.updateZoom=a,this.isZoomValid=n}registerActions(e){const{contextMenuRegistry:t}=this,i=e?"show":"hide";if(t.toggle("zoom-to-cursor",i),t.toggle("pan-to-cursor",i),t.toggle("reset-zoom",i),!e)return;t.builtins.items["zoom-to-cursor"].action=this.onZoomToHere.bind(this),t.builtins.items["pan-to-cursor"].action=this.onPanToHere.bind(this),t.builtins.items["reset-zoom"].action=this.onResetZoom.bind(this);const o=n=>{const r=this.getRect();if(!r)return!0;const l=Do(r,n.x,n.y);return this.iterateFindNextZoomAtPoint(l)!=null},s=()=>!mc(ot(this.zoomManager.getZoom()),Jp()),a=this.eventsHub.on("context-menu:setup",n=>{t.builtins.items["zoom-to-cursor"].enabled=o(n),t.builtins.items["pan-to-cursor"].enabled=s(),t.builtins.items["reset-zoom"].enabled=xb(this.zoomManager)});return()=>{a(),t.toggle("zoom-to-cursor","hide"),t.toggle("pan-to-cursor","hide"),t.toggle("reset-zoom","hide")}}computeOrigin(e){const t=this.getRect(),{enabled:i}=this.getModuleProperties();if(!i||!t||!e?.target||!(e instanceof MouseEvent))return;const o={x:0,y:0,width:t.width,height:t.height};return Do(o,e.offsetX,e.offsetY)}onZoomToHere({event:e}){const t=this.computeOrigin(e);if(!t)return;const i=this.iterateFindNextZoomAtPoint(t);i!=null&&this.updateZoom(lu("contextmenu-zoom-to-cursor"),i)}onPanToHere({event:e}){const t=this.computeOrigin(e);if(!t)return;const i=ot(this.zoomManager.getZoom()),o=it(i),s=Qt(i),a=t.x*o,n=t.y*s,r=Us/2;let l={x:{min:t.x-r,max:t.x+r},y:{min:t.y-r,max:t.y+r}};l=fb(l,o,s),l=js(l,i.x.min-t.x+a,i.y.min-t.y+n),this.updateZoom(lu("contextmenu-pan-to-cursor"),bi(l))}onResetZoom(e){this.zoomManager.resetZoom(lu("contextmenu-reset"))}iterateFindNextZoomAtPoint(e){const{scrollingStep:t}=this.getModuleProperties();for(let i=t;i<=1-t;i+=t){const o=this.getNextZoomAtPoint(e,i);if(this.isZoomValid(o))return o}}getNextZoomAtPoint(e,t){const{isScalingX:i,isScalingY:o}=this.getModuleProperties(),s=ot(this.zoomManager.getZoom()),a=e.x*it(s),n=e.y*Qt(s),r=Us/2;let l={x:{min:e.x-r,max:e.x+r},y:{min:e.y-r,max:e.y+r}};return l=fb(l,i?it(s)*t:Us,o?Qt(s)*t:Us),l=js(l,s.x.min-e.x+a,s.y.min-e.y+n),bi(l)}};import{_ModuleSupport as H_}from"ag-charts-community";import{ChartAxisDirection as Lb,boxEmpty as W_}from"ag-charts-core";var K_=class{constructor(e){this.axesHandlers=e,this.axes=[],this.overlappingAxisIds=new Set}destroy(){for(const e of this.axes)e.div.destroy()}update(e,t,i,o,s){this.seriesRect=s;const a=!e||!t&&!i;for(const d of this.axes)d.div.setHidden(a);if(a)return;const{X:n,Y:r}=Lb,l=[...o.axisManager.getAxisContext(n),...o.axisManager.getAxisContext(r)],{removed:c,added:h}=this.diffAxisIds(l);c.length>0&&(this.axes=this.axes.filter(d=>c.includes(d.axisId)?(d.div.destroy(),this.overlappingAxisIds.delete(d.axisId),this.hoveredAxisId===d.axisId&&(this.hoveredAxisId=void 0),this.activeAxisId===d.axisId&&(this.activeAxisId=void 0),!1):!0));for(const d of h){const{axisId:u,direction:g}=d;this.axes.push(this.initAxis(o,u,this.axesHandlers,g))}for(const d of this.axes){const g=l.find(m=>m.axisId===d.axisId).getCanvasBounds();d.div.setHidden(W_(g)),g==null?d.bounds=void 0:(d.div.setBounds(g),d.bounds=new H_.BBox(g.x,g.y,g.width,g.height))}this.updateOverlappingAxisPointerEvents(t,i)}setAxisCursor(e){this.cursor=e;for(const t of this.axes)t.div.setCursor(this.getCursor(t.direction))}toggleAxisDraggingCursor(e,t){for(const i of this.axes)i.direction===e&&i.div.setCursor(t?this.getCursor(e):void 0)}updateOverlappingAxisPointerEvents(e,t){this.overlappingAxisIds.clear();const i=(e||t)&&this.seriesRect;for(const o of this.axes){if(!i){o.div.setPointerEvents(void 0);continue}!!o.bounds?.collidesBBox(this.seriesRect)?(this.overlappingAxisIds.add(o.axisId),o.div.setPointerEvents("none")):o.div.setPointerEvents(void 0)}this.cleanupAxisState()}cleanupAxisState(){this.hoveredAxisId&&!this.overlappingAxisIds.has(this.hoveredAxisId)&&(this.hoveredAxisId=void 0),this.activeAxisId&&!this.overlappingAxisIds.has(this.activeAxisId)&&(this.activeAxisId=void 0)}pickAxisAtPoint(e,t){for(const i of this.axes)if(this.overlappingAxisIds.has(i.axisId)&&i.bounds?.containsPoint(e,t))return{axisId:i.axisId,direction:i.direction}}setHoveredAxis(e){this.overlappingAxisIds.has(e)&&(this.hoveredAxisId=e)}clearHoveredAxis(){this.activeAxisId||(this.hoveredAxisId=void 0)}beginDelegatedAxisDrag(e){return this.overlappingAxisIds.has(e)?(this.activeAxisId=e,this.hoveredAxisId=void 0,!0):!1}endDelegatedAxisDrag(e){this.activeAxisId===e&&(this.activeAxisId=void 0),this.hoveredAxisId=void 0}hasOverlappingAxes(){return this.overlappingAxisIds.size>0}getHoveredAxis(){if(!this.hoveredAxisId)return;const e=this.axes.find(t=>t.axisId===this.hoveredAxisId);return e?{axisId:e.axisId,direction:e.direction}:void 0}getCursor(e){return this.cursor?this.cursor:e===Lb.X?"ew-resize":"ns-resize"}initAxis(e,t,i,o){const s="afterend",a=e.proxyInteractionService.createProxyElement({type:"region",domManagerId:t,where:s});return a.setCursor(this.getCursor(o)),a.addListener("drag-start",n=>{n.device==="touch"&&n.sourceEvent.preventDefault(),this.activeAxisId=t,i.onAxisDragStart(o)}),a.addListener("drag-move",n=>i.onAxisDragMove(t,o,n)),a.addListener("drag-end",()=>{this.activeAxisId=void 0,this.hoveredAxisId=void 0,i.onAxisDragEnd()}),a.addListener("dblclick",()=>i.onAxisDoubleClick(t,o)),a.addListener("wheel",n=>i.onAxisWheel(o,n)),{axisId:t,div:a,direction:o}}diffAxisIds(e){const t=this.axes.map(a=>a.axisId),i=e.map(a=>a.axisId),o=t.filter(a=>!i.includes(a)),s=e.filter(a=>!t.includes(a.axisId));return{removed:o,added:s}}};import{_ModuleSupport as G_}from"ag-charts-community";import{BaseProperties as $_,ChartAxisDirection as Nb,Logger as Y_,Property as Cb,clamp as Tb}from"ag-charts-core";var{userInteraction:U_}=G_;function j_(e){return e.x.min===0&&e.x.max===1&&e.y.min===0&&e.y.max===1}function X_(e,t){return e.stickToEnd&&t.x.max===1}function wb(e,t,i){const{domainMin:o,domainMax:s}=t,a=s-o;return{axisId:e,visibleMin:o+a*i.min,visibleMax:o+a*i.max}}function Pb(e,t){const{domainMin:i,domainMax:o}=e,{visibleMin:s,visibleMax:a}=t,n=o-i;return{direction:"x",min:Tb(0,(s-i)/n,1),max:Tb(0,(a-i)/n,1)}}var cu=class extends $_{constructor(){super(...arguments),this.strategy="preserveDomain",this.stickToEnd=!1}};p([Cb],cu.prototype,"strategy",2),p([Cb],cu.prototype,"stickToEnd",2);var Z_=class{constructor(e,t,i,o){this.onConstrainChangesCallback=e,this.properties=t,this.ctx=i;const s=()=>{i.eventsHub.off("layout:complete",s),o.register(i.eventsHub.on("data:load",a=>this.onDataLoad(a)),i.eventsHub.on("data:update",a=>this.onDataUpdate(a)))};o.register(i.eventsHub.on("layout:complete",s),i.eventsHub.on("zoom:change-request",a=>this.onZoomChangeRequest(a)))}destroy(){}onDataLoad(e){this.performUpdateStrategy()}onDataUpdate(e){this.performUpdateStrategy()}onZoomChangeRequest(e){const t=this.popDesiredChanges();t&&(e.constrainChanges(t),this.onConstrainChangesCallback(e))}computeDomainMinMax(e){const t=this.ctx.axisManager.getAxisIdContext(e);if(!t?.continuous||t.scale.domain.length===0)return;const[i,o]=t.scale.getDomainMinMax();if(typeof i=="number"&&typeof o=="number")return{domainMin:i,domainMax:o};if(i instanceof Date&&o instanceof Date)return{domainMin:i.getTime(),domainMax:o.getTime()};Y_.error(`Unexpected range types: start (${typeof i}), end (${typeof o})`)}popDesiredChanges(){const{desiredChanges:e}=this;if(e)switch(this.desiredChanges=void 0,e.type){case"domain":{const i={};for(const o of e.domains){const s=this.computeDomainMinMax(o.axisId);s&&(i[o.axisId]=Pb(s,o))}return i}case"stickToEnd":{const{axisId:i,difference:o}=e,s=this.computeDomainMinMax(i);if(s){const a={axisId:i,visibleMin:s.domainMax-o,visibleMax:s.domainMax};return{[i]:Pb(s,a)}}break}default:return(i=>i)(e)}}performUpdateStrategy(){const e=ot(this.ctx.zoomManager.getZoom());if(!j_(e)){if(X_(this.properties,e))return this.performStickToEnd();switch(this.properties.strategy){case"reset":return this.ctx.zoomManager.resetZoom(U_("onDataChange-reset"));case"preserveRatios":return;case"preserveDomain":return this.performPreserveDomain();default:return(i=>i)(this.properties.strategy)}}}performPreserveDomain(){this.desiredChanges={type:"domain",domains:[]};const e=this.ctx.zoomManager.getAxes().filter(t=>t.direction===Nb.X);for(const{id:t}of e){const i=this.computeDomainMinMax(t);if(i){const o=this.ctx.zoomManager.getAxisZoom(t),s=wb(t,i,o);this.desiredChanges.domains.push(s)}}}performStickToEnd(){const e=this.ctx.zoomManager.getPrimaryAxisId(Nb.X);if(!e)return;const t=this.computeDomainMinMax(e);if(!t)return;const i=this.ctx.zoomManager.getAxisZoom(e);if(!i)return;const{visibleMin:o,visibleMax:s}=wb(e,t,i),a=s-o;this.desiredChanges={type:"stickToEnd",axisId:e,difference:a}}};import"ag-charts-community";import{ChartAxisDirection as Ob,entries as q_,getWindow as Q_}from"ag-charts-core";var Rb=16,J_={off:1,short:.01,long:.002},eB=class{constructor(){this.deceleration=1,this.zoomCoordsHistoryIndex=0,this.coordsHistory=[]}get decelerationValue(){const{deceleration:e}=this;return Math.max(typeof e=="number"?e:J_[e]??1,1e-4)}addListener(e,t){return this.onUpdate=t,()=>{this.onUpdate=void 0}}stopInteractions(){this.inertiaHandle!=null&&(cancelAnimationFrame(this.inertiaHandle),this.inertiaHandle=void 0)}update(e){this.updateCoords(e.currentX,e.currentY);const{x1:t=0,y1:i=0,x2:o=0,y2:s=0}=this.coords??{};this.onUpdate?.({type:"update",deltaX:this.isPanningX()?t-o:0,deltaY:this.isPanningY()?i-s:0})}start(e){this.direction=e,this.coordsMonitorTimeout=setInterval(this.recordCurrentZoomCoords.bind(this),16)}stop(){const{coordsHistory:e}=this;let t=0,i=0,o=0;if(e.length>0){const s=this.zoomCoordsHistoryIndex%Rb;let a=s-1;a<0&&(a=e.length-1);let n=s;n>=e.length&&(n=0);const r=e[a],l=e[n];t=this.isPanningX()?r.x-l.x:0,i=this.isPanningY()?r.y-l.y:0,o=r.t-l.t}if(this.coords=void 0,this.direction=void 0,clearInterval(this.coordsMonitorTimeout),this.coordsMonitorTimeout=void 0,this.zoomCoordsHistoryIndex=0,this.coordsHistory.length=0,o>0&&this.decelerationValue<1){const s=t/o,a=i/o,n=Math.hypot(s,a),r=Math.atan2(a,s),l=performance.now();this.inertiaHandle=Q_().requestAnimationFrame(c=>{this.animateInertia(c,c,l,n,r)})}}recordCurrentZoomCoords(){const{coords:e,coordsHistory:t,zoomCoordsHistoryIndex:i}=this;if(!e)return;const{x2:o,y2:s}=e,a=Date.now();t[i%Rb]={x:o,y:s,t:a},this.zoomCoordsHistoryIndex+=1}animateInertia(e,t,i,o,s){const a=1-this.decelerationValue,n=-o/Math.log(a),r=o*(a**(t-i)-1)/Math.log(a),l=o*(a**(e-i)-1)/Math.log(a);this.onUpdate?.({type:"update",deltaX:this.isPanningX()?-Math.cos(s)*(l-r):0,deltaY:this.isPanningY()?-Math.sin(s)*(l-r):0}),!(l>=n-1)&&(this.inertiaHandle=requestAnimationFrame(c=>{this.animateInertia(c,e,i,o,s)}))}updateCoords(e,t){this.coords?this.coords={x1:this.coords.x2,y1:this.coords.y2,x2:e,y2:t}:this.coords={x1:e,y1:t,x2:e,y2:t}}isPanningX(){return this.direction==null||this.direction===Ob.X}isPanningY(){return this.direction==null||this.direction===Ob.Y}translateZooms(e,t,i,o){const s=Do(e,e.x+Math.abs(i),e.y+e.height-Math.abs(o)),a=Math.sign(i)*s.x,n=-Math.sign(o)*s.y,r={};for(const[l,c]of q_(t)){if(c==null||c.min===Si&&c.max===tt)continue;const{direction:h}=c;let d=ot({[h]:c});d=bi(js(d,a*it(d),n*Qt(d)));const{min:u,max:g}=d[h];r[l]={direction:h,min:u,max:g}}return r}};import"ag-charts-community";import{ChartAxisDirection as tB,entries as iB}from"ag-charts-core";var oB=200,sB=class{update(e,t,i,o){const s=e.deltaX*t*oB;return this.translateZooms(i,o,s)}translateZooms(e,t,i){const o={},s=Do(e,e.x+Math.abs(i),0),a=i<0?-s.x:s.x;for(const[n,r]of iB(t)){if(r?.direction!==tB.X)continue;const{direction:l,min:c,max:h}=r;let d=ot({x:{min:c,max:h}});d=bi(js(d,a*it(d),0)),o[n]={direction:l,min:d.x.min,max:d.x.max}}return o}};import"ag-charts-community";import{ChartAxisDirection as Eb,entries as aB}from"ag-charts-core";var nB=class{updateAxes(e,t,i,o){const s=e.sourceEvent,a={},{anchorPointX:n,anchorPointY:r,isScalingX:l,isScalingY:c,scrollingStep:h}=t,d=Do(i,s.offsetX??s.clientX,s.offsetY??s.clientY);for(const[u,g]of aB(o)){if(g==null)continue;const{direction:m,min:y,max:S}=g;let x={min:y,max:S};const b=h*e.deltaY*(S-y);if(m===Eb.X&&l)x.max+=b,x=Jt(x,g,n,d.x);else if(m===Eb.Y&&c)x.max+=b,x=Jt(x,g,r,d.y);else continue;if(x.max<x.min)continue;const f=xc(x);a[u]={direction:m,min:f.min,max:f.max}}return a}update(e,t,i,o){const{anchorPointX:s,anchorPointY:a,isScalingX:n,isScalingY:r,scrollingStep:l}=t,c=e.offsetX+i.x,h=e.offsetY+i.y,d=Do(i,c,h),u=e.deltaY;let g=ot(o);if(g.x.max+=n?l*u*it(o):0,g.y.max+=r?l*u*Qt(o):0,!(g.x.max<g.x.min||g.y.max<g.y.min))return n&&(g.x=Jt(g.x,o.x,s,d.x)),r&&(g.y=Jt(g.y,o.y,a,d.y)),g=bi(g),g}updateDelta(e,t,i){const{anchorPointX:o,anchorPointY:s,isScalingX:a,isScalingY:n,scrollingStep:r}=t;let l=ot(i);return l.x.max+=a?r*-e*it(i):0,l.y.max+=n?r*-e*Qt(i):0,a&&(l.x=Jt(l.x,i.x,o)),n&&(l.y=Jt(l.y,i.y,s)),l=bi(l),l}},rB=class{constructor(e,t,i){this.rect=e,this.getZoom=t,this.isZoomValid=i,this.rect.visible=!1}update(e,t,i){const o=e.currentX+(i?.x??0),s=e.currentY+(i?.y??0);this.rect.visible=!0,this.updateCoords(o,s,t,i),this.updateRect(i)}stop(e,t,i){let o=ot();if(!e||!t)return o;this.coords&&(o=this.createZoomFromCoords(t,i));const s=t.width/e.width,a=t.height/e.height;if(o=bi(m_(o,s,a)),this.reset(),this.isZoomValid(o))return o}reset(){this.coords=void 0,this.rect.visible=!1}didUpdate(){return this.rect.visible&&this.rect.width>0&&this.rect.height>0}updateCoords(e,t,i,o){if(!this.coords){this.coords={x1:e,y1:t,x2:e,y2:t};return}const{coords:s}=this;if(s.x2=e,s.y2=t,!o)return;const{isScalingX:a,isScalingY:n,keepAspectRatio:r}=i,l=this.getNormalisedDimensions();if(r&&a&&n){const c=o.width/o.height;s.y2<s.y1?s.y2=Math.min(s.y1-l.width/c,s.y1):s.y2=Math.max(s.y1+l.width/c,s.y1)}a||(s.x1=o.x,s.x2=o.x+o.width),n||(s.y1=o.y,s.y2=o.y+o.height)}updateRect(e){if(!e)return;const{rect:t}=this,i=this.getNormalisedDimensions(),{width:o,height:s}=i;let{x:a,y:n}=i;a=Math.max(a,e.x),a-=Math.max(0,a+o-(e.x+e.width)),n=Math.max(n,e.y),n-=Math.max(0,n+s-(e.y+e.height)),t.x=a,t.y=n,t.width=o,t.height=s;const r=this.createZoomFromCoords(e,this.getZoom());this.isZoomValid(r)?t.updateValid():t.updateInvalid()}createZoomFromCoords(e,t){const i=ot(t),o=this.getNormalisedDimensions(),s=Do(e,o.x,o.y+o.height),a=o.width/e.width,n=o.height/e.height;let r=fc(i,a,n);const l=s.x*it(i),c=s.y*Qt(i);return r=js(r,l,c),r=bi(r),r}getNormalisedDimensions(){const{x1:e=0,y1:t=0,x2:i=0,y2:o=0}=this.coords??{},s=Math.min(e,i),a=Math.min(t,o),n=e<=i?i-e:e-i,r=t<=o?o-t:t-o;return{x:s,y:a,width:n,height:r}}};import{_ModuleSupport as lB}from"ag-charts-community";import{ActionOnSet as _b,BaseProperties as cB,ChartAxisDirection as hB,CleanupRegistry as dB,PropertiesArray as pB,Property as Zs,ToolbarButtonProperties as uB,createElement as gB,debounce as mB,entries as yB}from"ag-charts-core";var{userInteraction:Bb,NativeWidget:fB,Toolbar:xB}=lB,hu=class extends uB{};p([Zs],hu.prototype,"value",2),p([Zs],hu.prototype,"section",2);var tn=class extends cB{constructor(e,t,i,o,s,a){super(),this.ctx=e,this.getModuleProperties=t,this.updateZoom=i,this.updateAxisZoom=o,this.resetZoom=s,this.isZoomValid=a,this.enabled=!1,this.buttons=new pB(hu),this.visible="hover",this.verticalSpacing=10,this.detectionRange=38,this.cleanup=new dB,this.toggleButtonsDebounced=mB(this.toggleButtons.bind(this),mb,{leading:!0,trailing:!0}),this.container=new fB(gB("div")),this.container.addClass("ag-charts-zoom-buttons"),e.domManager.addChild("canvas-overlay","zoom-buttons",this.container.getElement()),this.toolbar=new xB(e,"ariaLabelZoomToolbar","horizontal"),this.container.addChild(this.toolbar),this.toolbar.getElement().style.transform="translateY(54px)",this.toolbar.setHidden(!this.enabled),this.toggleVisibility(this.visible==="always"),this.cleanup.register(this.toolbar.addToolbarListener("button-pressed",this.onButtonPress.bind(this)),this.toolbar.addToolbarListener("button-focused",this.onButtonFocus.bind(this)),e.widgets.containerWidget.addListener("mousemove",this.onHover.bind(this)),e.widgets.containerWidget.addListener("mouseleave",this.onLeave.bind(this)),e.eventsHub.on("layout:complete",this.onLayoutComplete.bind(this)),this.teardown.bind(this))}destroy(){this.cleanup.flush()}toggleVisibleZoomed(e){this.visible==="zoomed"&&this.toggleVisibility(!e)}teardown(){this.ctx.domManager.removeChild("canvas-overlay","zoom-buttons"),this.container.destroy()}onLayoutComplete(e){if(!this.enabled)return;const{buttons:t,container:i}=this,{rect:o}=e.series;for(const a of t)if(a.tooltip==null&&a.label==null){const n={"pan-end":"toolbarZoomPanEnd","pan-left":"toolbarZoomPanLeft","pan-right":"toolbarZoomPanRight","pan-start":"toolbarZoomPanStart","zoom-in":"toolbarZoomZoomIn","zoom-out":"toolbarZoomZoomOut",reset:"toolbarZoomReset"};a.tooltip=n[a.value]}this.toolbar.updateButtons(t),this.toggleButtonsDebounced();const s=i.getBounds().height;i.setBounds({y:o.y+o.height-s})}onHover(e){if(!this.enabled||this.visible!=="hover"||this.toolbar.isHidden())return;const{container:t,detectionRange:i,ctx:{scene:o}}=this,{currentY:s,sourceEvent:{target:a}}=e,n=t.getElement(),r=n.offsetTop-i,l=s>r&&s<o.canvas.element.offsetHeight||a===n;this.toggleVisibility(l)}onLeave(){this.visible==="hover"&&this.toggleVisibility(!1)}toggleVisibility(e,t=!1){const{container:i,toolbar:o,verticalSpacing:s}=this;o.toggleClass("ag-charts-zoom-buttons__toolbar--hidden",!e);const a=o.getElement();a.style.transitionDuration=t?"0s":"",a.style.transform=e?"translateY(0)":`translateY(${i.getBounds().height+s}px)`}toggleButtons(){const e=ot(this.ctx.zoomManager.getZoom());if(!(this.previousZoom&&mc(this.previousZoom,e))){this.previousZoom=e;for(const[t,i]of this.buttons.entries()){let o=!0;switch(i?.value){case"pan-start":o=e.x.min>Si;break;case"pan-end":o=e.x.max<tt;break;case"pan-left":o=e.x.min>Si;break;case"pan-right":o=e.x.max<tt;break;case"zoom-out":o=!mc(e,Jp());break;case"zoom-in":o=this.isZoomValid(this.getNextZoomStateUnified("zoom-in",e,this.getModuleProperties()));break;case"reset":o=xb(this.ctx.zoomManager);break}this.toolbar.toggleButtonEnabledByIndex(t,o)}}}onButtonPress({button:e}){if(!this.enabled||this.toolbar.isHidden())return;const t=this.getModuleProperties();if(t.independentAxes&&e.value!=="reset"){const i=this.ctx.zoomManager.getAxisZooms();for(const[o,s]of yB(i)){if(s==null)continue;const{direction:a,min:n,max:r}=s;this.onButtonPressAxis(e,t,o,a,{min:n,max:r})}}else this.onButtonPressUnified(e,t)}onButtonFocus(e){this.toggleVisibility(!0,!0)}onButtonPressAxis(e,t,i,o,s){const{isScalingX:a,isScalingY:n,scrollingStep:r}=t;let l={...s};const c=s.max-s.min;switch(e.value){case"pan-start":l.max=c,l.min=0;break;case"pan-end":l.min=l.max-c,l.max=tt;break;case"pan-left":l.min-=c*r,l.max-=c*r;break;case"pan-right":l.min+=c*r,l.max+=c*r;break;case"zoom-in":case"zoom-out":{const h=o===hB.X,d=h&&a||!h&&n;let u=e.value==="zoom-in"?1-r:1+r;d||(u=1);const g=h?this.getAnchorPointX(t):this.getAnchorPointY(t);l.max=l.min+(l.max-l.min)*u,l=Jt(l,s,g);break}}this.updateAxisZoom(Bb(`zoom-button-${e.value}`),i,o,xc(l))}onButtonPressUnified(e,t){const{scrollingStep:i}=t,o=ot(this.ctx.zoomManager.getZoom());let s=ot(o);switch(e.value){case"reset":this.resetZoom("zoom-button-reset");return;case"pan-start":s.x.max=it(s),s.x.min=0;break;case"pan-end":s.x.min=tt-it(s),s.x.max=tt;break;case"pan-left":s=js(s,-it(s)*i,0);break;case"pan-right":s=js(s,it(s)*i,0);break;case"zoom-in":case"zoom-out":{s=this.getNextZoomStateUnified(e.value,o,t);break}}this.updateZoom(Bb(`zoom-button-${e.value}`),bi(s))}getNextZoomStateUnified(e,t,i){const{isScalingX:o,isScalingY:s,scrollingStep:a}=i,n=e==="zoom-in"?1-a:1+a,r=fc(t,o?n:1,s?n:1);return r.x=Jt(r.x,t.x,this.getAnchorPointX(i)),r.y=Jt(r.y,t.y,this.getAnchorPointY(i)),r}getAnchorPointX(e){const t=this.anchorPointX??e.anchorPointX;return t==="pointer"?ub:t}getAnchorPointY(e){const t=this.anchorPointY??e.anchorPointY;return t==="pointer"?gb:t}};p([Zs,_b({changeValue(e){this.toolbar?.setHidden(!e)}})],tn.prototype,"enabled",2),p([Zs],tn.prototype,"buttons",2),p([Zs,_b({changeValue(e,t){if(t==null)return;const i=e==="always",o=e==="zoomed"&&this.previousZoom!=null&&!yc(this.previousZoom);this.toggleVisibility(i||o)}})],tn.prototype,"visible",2),p([Zs],tn.prototype,"anchorPointX",2),p([Zs],tn.prototype,"anchorPointY",2);var qs=1e6;function Sc({min:e,max:t},i,o,s){return s===0?0:qs*((i-o)/s*(t-e)+e)}function SB(e,t,i,o,s,a){[e,t]=[Math.min(e,t),Math.max(e,t)],[i,o]=[Math.min(i,o),Math.max(i,o)];const n=qs*(i-s)/a,r=qs*(o-s)/a,l=(i-s)/(o-s),c=(e-l*t)/(qs-n+l*(r-qs)),h=(t+(r-qs)*c)/r;return{min:c,max:h}}function Vb(e,t,i,o){t===0&&(t=30),o===0&&(o=30);const s=e-t,a=e+t,n=i-o,r=i+o;return!(a<n||r<s)}var bB=class{constructor(){this.touchStart={origins:[{identifier:0,normalX:Number.NaN,normalY:Number.NaN},{identifier:0,normalX:Number.NaN,normalY:Number.NaN}]},this.initialZoom={x:{min:0,max:1},y:{min:0,max:1}},this.previous={a1:Number.NaN,a2:Number.NaN,b1:Number.NaN,b2:Number.NaN}}start(e,t,i){if(e.sourceEvent.targetTouches.length!==2)return!1;e.sourceEvent.preventDefault();const o=Array.from(e.sourceEvent.targetTouches),{x:s,y:a,width:n,height:r}=t.getBoundingClientRect();this.initialZoom.x.min=i.x?.min??0,this.initialZoom.x.max=i.x?.max??1,this.initialZoom.y.min=i.y?.min??0,this.initialZoom.y.max=i.y?.max??1;for(const m of this.touchStart.origins)m.identifier=0;this.previous.a1=Number.NaN,this.previous.a2=Number.NaN,this.previous.b1=Number.NaN,this.previous.b2=Number.NaN;for(const m of[0,1]){const y=o[m].clientX,S=a+r-o[m].clientY;this.touchStart.origins[m].identifier=o[m].identifier,this.touchStart.origins[m].normalX=Sc(this.initialZoom.x,y,s,n),this.touchStart.origins[m].normalY=Sc(this.initialZoom.y,S,a,r)}const[l,c]=o,[h,d]=this.touchStart.origins,u=Vb(l.clientX,l.radiusX,c.clientX,c.radiusX);return Vb(l.clientY,l.radiusY,c.clientY,c.radiusY)&&(h.normalY=d.normalY=(h.normalY+d.normalY)/2),u&&(h.normalX=d.normalX=(h.normalX+d.normalX)/2),!0}update(e,t){e.sourceEvent.preventDefault();const i=Array.from(e.sourceEvent.targetTouches),{x:o,y:s,width:a,height:n}=t.getBoundingClientRect(),{origins:r}=this.touchStart,l=[0,1].map(x=>i.find(b=>b.identifier===r[x].identifier)),c=r[0].normalX,h=r[1].normalX,d=l[0].clientX,u=l[1].clientX,g=r[0].normalY,m=r[1].normalY,y=s+n-l[0].clientY,S=s+n-l[1].clientY;return this.twitchTolerantZoomPan4(c,h,d,u,g,m,y,S,o,s,a,n)}end(e){const t=Array.from(e.sourceEvent.targetTouches).map(i=>i.identifier);return!t.includes(this.touchStart.origins[0].identifier)||!t.includes(this.touchStart.origins[1].identifier)}twitchTolerantZoomPan4(e,t,i,o,s,a,n,r,l,c,h,d){const{initialZoom:u,previous:g}=this,m=zb(e,t,i,o,g,"a1","a2",l,h,u.x),y=zb(s,a,n,r,g,"b1","b2",c,d,u.y);return{x:m,y}}};function zb(e,t,i,o,s,a,n,r,l,c){if(e==t){const h=Sc(c,i,r,l),d=Sc(c,o,r,l),u=(h+d)/2,g=(e-u)/qs;return{min:c.min+g,max:c.max+g}}else{const h=s[a],d=s[n];return Math.abs(i-h)+Math.abs(o-d)<=1?(i=h,o=d):(s[a]=i,s[n]=o),SB(e,t,i,o,r,l)}}var{userInteraction:Qs,InteractionState:sr}=en,bc=e=>T_(e,10),on="zoom-cursor",ar="zoom-tooltip",we=class extends L_{constructor(e){super(),this.ctx=e,this.enabled=!1,this.enableAxisDragging=!0,this.enableAxisScrolling=!0,this.enableDoubleClickToReset=!0,this.enablePanning=!0,this.enableScrolling=!0,this.enableSelecting=!1,this.enableTwoFingerZoom=!0,this.panKey="alt",this.axes="x",this.scrollingStep=Us/10,this.keepAspectRatio=!1,this.minVisibleItems=2,this.anchorPointX=ub,this.anchorPointY=gb,this.autoScaling=new nu(o=>{this.autoScaler?.onChange(o)}),this.axisDraggingMode="zoom",this.buttons=new tn(this.ctx,this.getModuleProperties.bind(this),this.updateZoom.bind(this),this.updateAxisZoom.bind(this),this.resetZoom.bind(this),this.isZoomValid.bind(this)),this.onDataChange=new cu,this.axisDragger=new V_,this.panner=new eB,this.scroller=new nB,this.scrollPanner=new sB,this.twoFingers=new bB,this.deceleration="short",this.dragState=0,this.isState=o=>this.ctx.interactionManager.isState(o),this.destroyContextMenuActions=void 0,this.isFirstWheelEvent=!0,this.debouncedWheelReset=vb(()=>{this.isFirstWheelEvent=!0,this.wasFirstWheelEventZoomCapped=void 0},100),this.previousZoomValid=!0,this.previousAxisZoomValid={[kt.X]:!0,[kt.Y]:!0},this.toggleAxisDraggingCursorsDebounced=vb(this.toggleAxisDraggingCursors.bind(this),mb,{leading:!0,trailing:!0}),this.autoScaler=new B_(this.autoScaling,e.zoomManager,this,e.eventsHub,this.cleanup);const t=new Db;this.selector=new rB(t,this.getZoom.bind(this),this.isZoomValid.bind(this)),this.contextMenu=new F_(e.eventsHub,e.contextMenuRegistry,e.zoomManager,this.getModuleProperties.bind(this),()=>this.paddedRect,this.updateZoom.bind(this),this.isZoomValid.bind(this));const i=o=>{if(this.minVisibleItems>0){const s=o.stateAsDefinedZoom();o.constrainZoom(this.constrainZoom(s))}};this.dataChangeHandler=new Z_(i,this.onDataChange,this.ctx,this.cleanup),this.domProxy=new K_({onAxisDragStart:o=>this.onAxisDragStart(o),onAxisDragMove:(o,s,a)=>this.onAxisDragMove(o,s,a),onAxisDragEnd:()=>this.onAxisDragEnd(),onAxisDoubleClick:o=>this.onAxisDoubleClick(o),onAxisWheel:(o,s)=>this.onAxisWheel(o,s)}),e.widgets.seriesDragInterpreter&&this.cleanup.register(e.widgets.seriesDragInterpreter.events.on("dblclick",o=>this.onSeriesAreaDoubleClick(o)),e.widgets.seriesDragInterpreter.events.on("drag-move",o=>this.onSeriesAreaDragMove(o)),e.widgets.seriesDragInterpreter.events.on("drag-start",o=>this.onSeriesAreaDragStart(o)),e.widgets.seriesDragInterpreter.events.on("drag-end",()=>this.onSeriesAreaDragEnd())),this.cleanup.register(e.scene.attachNode(t),e.eventsHub.on("series-area:hover",o=>this.onSeriesAreaHoverEvent(o)),e.eventsHub.on("series-area:click",o=>this.onSeriesAreaClickEvent(o)),e.eventsHub.on("series:keynav-zoom",o=>this.onNavZoom(o)),e.widgets.seriesWidget.addListener("wheel",o=>this.onWheel(o)),e.widgets.seriesWidget.addListener("touchstart",(o,s)=>this.onTouchStart(o,s)),e.widgets.seriesWidget.addListener("touchmove",(o,s)=>this.onTouchMove(o,s)),e.widgets.seriesWidget.addListener("touchend",o=>this.onTouchEnd(o)),e.widgets.seriesWidget.addListener("touchcancel",o=>this.onTouchEnd(o)),e.updateService.addListener("process-data",o=>this.onProcessData(o)),e.eventsHub.on("layout:complete",o=>this.onLayoutComplete(o)),e.eventsHub.on("zoom:change-request",o=>this.onZoomChangeRequested(o)),e.eventsHub.on("zoom:pan-start",o=>this.onZoomPanStart(o)),this.panner.addListener("update",o=>this.onPanUpdate(o)),()=>this.teardown())}teardown(){this.ctx.zoomManager.setZoomModuleEnabled(!1),this.buttons.destroy(),this.destroyContextMenuActions?.(),this.domProxy.destroy(),this.dataChangeHandler.destroy()}onEnabledChange(e){this.ctx.zoomManager.setZoomModuleEnabled(e),this.contextMenu&&(this.destroyContextMenuActions?.(),this.destroyContextMenuActions=this.contextMenu.registerActions(e))}isIgnoredTouch(e){return e?.device!=="touch"?!1:this.ctx.chartService.touch.dragAction!=="drag"?!0:this.enableSelecting?!1:this.enablePanning?yc(this.getZoom()):!0}onSeriesAreaDoubleClick(e){const{enabled:t,enableDoubleClickToReset:i}=this;!t||!i||e?.preventZoomDblClick||!this.isState(sr.ZoomClickable)||this.resetZoom("zoom-seriesarea-dblclick")}onSeriesAreaHoverEvent(e){if(!this.shouldHandleAxisHover(e)){this.clearHoveredAxis();return}const t=this.domProxy.pickAxisAtPoint(e.x,e.y);t?(this.domProxy.setHoveredAxis(t.axisId),this.ctx.domManager.updateCursor(on,this.domProxy.getCursor(t.direction))):this.clearHoveredAxis()}onSeriesAreaClickEvent(e){if(!this.shouldHandleAxisClick(e))return;const t=this.domProxy.pickAxisAtPoint(e.x,e.y);t&&e.sourceEvent?.type==="dblclick"&&this.onAxisDoubleClick(t.axisId)}shouldHandleAxisHover(e){const{enabled:t,enableAxisDragging:i,enableAxisScrolling:o,dragState:s}=this;return t&&(i||o)&&!e.consumed&&!this.activeAxis&&s===0&&this.domProxy.hasOverlappingAxes()}shouldHandleAxisClick(e){const{enabled:t,enableAxisDragging:i,enableAxisScrolling:o,enableDoubleClickToReset:s}=this;return t&&!this.activeAxis&&!e.consumed&&(i||o||s)}clearHoveredAxis(){this.activeAxis||(this.domProxy.clearHoveredAxis(),this.dragState===0&&this.ctx.domManager.updateCursor(on))}tryBeginAxisDelegation(e){const t=this.domProxy.getHoveredAxis();if(!this.enabled||!this.enableAxisDragging||!t||!this.domProxy.beginDelegatedAxisDrag(t.axisId))return!1;this.activeAxis=t,this.onAxisDragStart(t.direction);const i=this.dragState===2?"grabbing":this.domProxy.getCursor(t.direction);return this.ctx.domManager.updateCursor(on,i),e.device==="touch"&&e.sourceEvent.preventDefault(),!0}onSeriesAreaDragStart(e){const{enabled:t,enablePanning:i,enableSelecting:o,ctx:{domManager:s,zoomManager:a}}=this;if(!t||!this.isState(sr.ZoomDraggable)||this.dragState!==0||this.isIgnoredTouch(e)||(this.panner.stopInteractions(),this.tryBeginAxisDelegation(e)))return;let n=0;const r=this.isPanningKeyPressed(e.sourceEvent);i&&(!o||r)?(s.updateCursor(on,"grabbing"),n=2,this.panner.start()):o&&!r&&(n=3),(this.dragState=n)!==0&&a.fireZoomPanStartEvent("zoom")}onSeriesAreaDragMove(e){const{dragState:t,enabled:i,paddedRect:o,panner:s,selector:a,ctx:{interactionManager:n,tooltipManager:r,updateService:l}}=this;if(this.activeAxis){this.onAxisDragMove(this.activeAxis.axisId,this.activeAxis.direction,e);return}if(!(!i||!o||!this.isState(sr.ZoomDraggable)||this.isIgnoredTouch(e))){switch(n.pushState(en.InteractionState.ZoomDrag),e.device==="touch"&&e.sourceEvent.preventDefault(),t){case 2:s.update(e);break;case 3:a.update(e,this.getModuleProperties(),o);break;case 0:return}r.updateTooltip(ar),l.update(au.PERFORM_LAYOUT,{skipAnimations:!0})}}onSeriesAreaDragEnd(){const{ctx:{interactionManager:e}}=this;if(this.activeAxis){this.handleAxisDragEnd();return}e.popState(en.InteractionState.ZoomDrag),!(!this.enabled||this.dragState===0)&&(this.handleRegularDragEnd(),this.resetDragState())}handleAxisDragEnd(){this.onAxisDragEnd(),this.domProxy.endDelegatedAxisDrag(this.activeAxis.axisId),this.activeAxis=void 0,this.clearHoveredAxis()}handleRegularDragEnd(){const{panner:e,selector:t}=this;switch(this.dragState){case 2:e.stop();break;case 3:if(t.didUpdate()){const i=t.stop(this.seriesRect,this.paddedRect,this.getZoom());i?this.updateZoom(Qs("zoom-seriesarea-selector"),i):this.ctx.updateService.update()}break}}resetDragState(){this.dragState=0,this.ctx.domManager.updateCursor(on),this.ctx.tooltipManager.removeTooltip(ar)}onAxisDoubleClick(e){const{enabled:t,enableDoubleClickToReset:i,ctx:{zoomManager:o}}=this;!t||!i||!this.isState(sr.ZoomClickable)||(this.previousAxisZoomValid={[kt.X]:!0,[kt.Y]:!0},o.resetAxisZoom({source:"user-interaction",sourceDetail:"zoom-axis-dblclick"},e))}onAxisDragStart(e){const{axisDraggingMode:t,domProxy:i,enabled:o,enableAxisDragging:s,panner:a,ctx:{zoomManager:n}}=this;!o||!s||(a.stopInteractions(),t==="pan"?(i.setAxisCursor("grabbing"),this.dragState=2,this.panner.start(e),n.fireZoomPanStartEvent("zoom")):this.dragState=1)}onAxisDragMove(e,t,i){const{anchorPointX:o,anchorPointY:s,axisDragger:a,dragState:n,enabled:r,enableAxisDragging:l,seriesRect:c,shouldFlipXY:h,ctx:{interactionManager:d,tooltipManager:u,updateService:g,zoomManager:m}}=this;if(!r||!l||!c)return;d.pushState(en.InteractionState.ZoomDrag),i.device==="touch"&&i.sourceEvent.preventDefault();const y=this.getZoom();if(n===2)this.panner.update({currentX:i.offsetX,currentY:i.offsetY});else{let S=t===kt.X?o:s;h&&(S=t===kt.X?s:o);const x=m.getAxisZoom(e),b=a.update(i,t,S,c,y,x);this.autoScaler.onManualAdjustment(t),this.updateAxisZoom(Qs("zoom-axis-drag"),e,t,b,{directional:!0})}u.updateTooltip(ar),g.update(au.PERFORM_LAYOUT,{skipAnimations:!0})}onAxisDragEnd(){const{axisDraggingMode:e,axisDragger:t,dragState:i,domProxy:o,enabled:s,enableAxisDragging:a,ctx:{domManager:n,interactionManager:r,tooltipManager:l}}=this;r.popState(en.InteractionState.ZoomDrag),!(!s||!a||i===0)&&(this.dragState=0,e==="pan"&&(o.setAxisCursor("grab"),this.panner.stop()),t.stop(),n.updateCursor(on),l.removeTooltip(ar))}onNavZoom(e){const{enabled:t,enableScrolling:i,scroller:o}=this;!this.ctx.interactionManager.isState(en.InteractionState.Default)||!t||!i||(e.widgetEvent.sourceEvent.preventDefault(),this.updateZoom(Qs(`keyboard(${e.delta})`),o.updateDelta(e.delta,this.getModuleProperties(),this.getZoom())))}onWheel(e){const{enabled:t,enablePanning:i,enableScrolling:o,paddedRect:s}=this;if(!t||!o||!s||!this.isState(sr.ZoomWheelable))return;const{deltaX:a,deltaY:n}=e.sourceEvent,r=a!=null&&n!=null&&Math.abs(a)>Math.abs(n);i&&r?this.onWheelPanning(e):this.onWheelScrolling(e)}onWheelPanning(e){const{scrollingStep:t,scrollPanner:i,seriesRect:o,ctx:{zoomManager:s}}=this;if(!o)return;e.sourceEvent.preventDefault();const a=i.update(e,t,o,s.getAxisZooms());this.updateChanges(Qs("zoom-seriesarea-wheel"),a)}onWheelScrolling(e){const t=this.getZoom(),i=e.deltaY>0&&yc(t);this.handleWheelScrolling(e,i)}onAxisWheel(e,t){if(!this.enableAxisScrolling||e!==kt.X&&e!==kt.Y)return;const i=e===kt.X,o=!i,s=this.getModuleProperties({isScalingX:i,isScalingY:o}),a=this.getZoom(),n=t.deltaY>0&&a[e].min===Si&&a[e].max===tt;this.autoScaler.onManualAdjustment(e),this.handleWheelScrolling(t,n,s)}handleWheelScrolling(e,t,i=this.getModuleProperties()){const{enableIndependentAxes:o,scroller:s,seriesRect:a,ctx:{zoomManager:n}}=this;if(!a)return;let r=!0;const l=Qs("zoom-axis-wheel");if(o===!0){const c=s.updateAxes(e,i,a,n.getAxisZooms());for(const[h,{direction:d,min:u,max:g}]of C_(c)){const m=d===kt.X?this.constrainZoom({x:{min:u,max:g},y:{min:tt,max:tt}}).x:{min:u,max:g};r&&(r=this.updateAxisZoom(l,h,d,m))}}else{const c=s.update(e,i,a,this.getZoom());if(c==null)return;r=this.updateUnifiedZoom(l,c,{directional:!0})}t||(t=e.deltaY<0&&!r),this.firstWheelEventDirection!=null&&this.firstWheelEventDirection!==e.deltaY<0&&(this.isFirstWheelEvent=!0),this.isFirstWheelEvent?(this.wasFirstWheelEventZoomCapped=t,this.firstWheelEventDirection=e.deltaY<0,t||e.sourceEvent.preventDefault()):this.wasFirstWheelEventZoomCapped===!1&&e.sourceEvent.preventDefault(),this.isFirstWheelEvent=!1,this.debouncedWheelReset()}onTouchStart(e,t){!this.enableTwoFingerZoom||this.dragState!==0||this.twoFingers.start(e,t,this.getZoom())&&(this.dragState=4)}onTouchMove(e,t){if(!this.enableTwoFingerZoom||this.dragState!==4)return;const i=this.twoFingers.update(e,t);this.updateZoom(Qs("zoom-seriesarea-twofingers"),bi(i))}onTouchEnd(e){!this.enableTwoFingerZoom||this.dragState!==4||(e.sourceEvent.preventDefault(),this.twoFingers.end(e)&&(this.dragState=0))}onProcessData(e){this.shouldFlipXY=e.series.shouldFlipXY}onLayoutComplete(e){this.domProxy.update(this.enabled,this.enableAxisDragging,this.enableAxisScrolling,this.ctx,e.series.rect),this.enabled&&(this.seriesRect=e.series.rect,this.paddedRect=e.series.paddedRect,this.enableAxisDragging&&this.toggleAxisDraggingCursorsDebounced())}onZoomChangeRequested(e){e.sourceDetail!=="zoom-seriesarea-panner"&&this.panner.stopInteractions();const t=this.getZoom();this.buttons.toggleVisibleZoomed(yc(t))}onZoomPanStart(e){e.callerId==="zoom"&&this.panner.stopInteractions()}onPanUpdate(e){const{panner:t,seriesRect:i,ctx:{tooltipManager:o,zoomManager:s}}=this;if(!i)return;const a=t.translateZooms(i,s.getAxisZooms(),e.deltaX,e.deltaY);this.updateChanges(Qs("zoom-seriesarea-panner"),a),o.updateTooltip(ar)}isPanningKeyPressed(e){switch(this.panKey){case"alt":return e.altKey;case"ctrl":return e.ctrlKey;case"shift":return e.shiftKey;case"meta":return e.metaKey}}isScalingX(){return this.axes==="xy"?!0:this.shouldFlipXY?this.axes==="y":this.axes==="x"}isScalingY(){return this.axes==="xy"?!0:this.shouldFlipXY?this.axes==="x":this.axes==="y"}getAnchorPointX(){return this.shouldFlipXY?this.anchorPointY:this.anchorPointX}getAnchorPointY(){return this.shouldFlipXY?this.anchorPointX:this.anchorPointY}constrainZoom(e){return this.ctx.zoomManager.constrainZoomToItemCount(e,this.minVisibleItems,this.autoScaler.enabled)}isZoomValid(e,t){const{minVisibleItems:i,ctx:{zoomManager:o}}=this;if(i===0)return this.previousZoomValid=!0,!0;const s=this.getZoom(),a=bc(it(e))<bc(it(s)),n=bc(Qt(e))<bc(Qt(s));if(!a&&!n)return this.previousZoomValid=!0,!0;if(!this.previousZoomValid&&t?.directional)return!1;const r=t?.includeYVisibleRange??!1,l=this.autoScaler.enabled,c=o.isVisibleItemsCountAtLeast(e,i,{includeYVisibleRange:r,autoScaleYAxis:l});return this.previousZoomValid=t?.directional?c:!0,c}isAxisZoomValid(e,t,i){const{minVisibleItems:o,ctx:{zoomManager:s}}=this,a=this.getZoom(),n=t.max-t.min,r=a[e].max-a[e].min,l={...a,[e]:t};if(n>=r)return this.previousAxisZoomValid[e]=!0,!0;if(!this.previousAxisZoomValid[e]&&i?.directional)return!1;const c={includeYVisibleRange:!1,autoScaleYAxis:this.autoScaler.enabled},h=s.isVisibleItemsCountAtLeast(l,o,c);return this.previousAxisZoomValid[e]=i?.directional?h:!0,h}resetZoom(e){this.previousZoomValid=!0,this.previousAxisZoomValid={[kt.X]:!0,[kt.Y]:!0},this.ctx.zoomManager.resetZoom({source:"user-interaction",sourceDetail:e})}updateSyncZoom(e){this.updateZoom({source:"sync",sourceDetail:"internal-updateSyncZoom"},e)}updateChanges(e,t){const i=this.ctx.zoomManager.toAxisZoomState(t)??{},o=ot(this.ctx.zoomManager.getZoom());this.updateZoom(e,{x:i.x??o.x,y:i.y??o.y})}updateZoom(e,t){this.enableIndependentAxes?this.updatePrimaryAxisZooms(e,t):this.updateUnifiedZoom(e,t)}updateUnifiedZoom(e,t,i){return t=this.constrainZoom(t),this.isZoomValid(t,i)?(this.ctx.zoomManager.updateZoom(e,t),!0):(this.ctx.updateService.update(au.SCENE_RENDER,{skipAnimations:!0}),!1)}updatePrimaryAxisZooms(e,t){this.updatePrimaryAxisZoom(e,t,kt.X),this.updatePrimaryAxisZoom(e,t,kt.Y)}updatePrimaryAxisZoom(e,t,i){const o=this.ctx.zoomManager.getPrimaryAxisId(i);o!=null&&this.updateAxisZoom(e,o,i,t[i])}updateAxisZoom(e,t,i,o,s){const{enableIndependentAxes:a,ctx:{zoomManager:n}}=this;if(!o)return!1;const r=this.getZoom();if(a!==!0)return r[i]=o,this.updateUnifiedZoom(e,r,s);if(!this.isAxisZoomValid(i,o,s))return!1;const{source:l,sourceDetail:c}=e;return n.updateChanges({source:l,sourceDetail:c,changes:{[t]:o},isReset:!1}),!0}updateAxisCursor(e){if(!this.domProxy)return;const{enableAxisDragging:t=this.enableAxisDragging,enableAxisScrolling:i=this.enableAxisScrolling,axisDraggingMode:o=this.axisDraggingMode}=e;t?this.domProxy.setAxisCursor(o==="pan"?"grab":void 0):i?this.domProxy.setAxisCursor("default"):this.domProxy.setAxisCursor(void 0)}toggleAxisDraggingCursors(){const{anchorPointX:e,anchorPointY:t,domProxy:i}=this,o=this.getZoom();let s=it(o)!==Us,a=Qt(o)!==Us;if(!s){const n=fc(o,.999,1);n.x=Jt(n.x,o.x,e),s=this.isZoomValid(n,{includeYVisibleRange:!0})}if(!a){const n=fc(o,1,.999);n.y=Jt(n.y,o.y,t),a=this.isZoomValid(n,{includeYVisibleRange:!0})}i.toggleAxisDraggingCursor(kt.X,s),i.toggleAxisDraggingCursor(kt.Y,a)}getZoom(){return ot(this.ctx.zoomManager.getZoom())}getModuleProperties(e){return{anchorPointX:e?.anchorPointX??this.getAnchorPointX(),anchorPointY:e?.anchorPointY??this.getAnchorPointY(),enabled:e?.enabled??this.enabled,independentAxes:e?.independentAxes??this.enableIndependentAxes===!0,isScalingX:e?.isScalingX??this.isScalingX(),isScalingY:e?.isScalingY??this.isScalingY(),keepAspectRatio:e?.keepAspectRatio??this.keepAspectRatio,scrollingStep:e?.scrollingStep??this.scrollingStep}}};p([or({newValue(e){this.onEnabledChange(e)}}),ze],we.prototype,"enabled",2),p([or({changeValue(e){this.updateAxisCursor({enableAxisDragging:e})}}),ze],we.prototype,"enableAxisDragging",2),p([or({changeValue(e){this.updateAxisCursor({enableAxisScrolling:e})}}),ze],we.prototype,"enableAxisScrolling",2),p([ze],we.prototype,"enableDoubleClickToReset",2),p([or({changeValue(e){this.ctx.zoomManager.setIndependentAxes(!!e)}}),ze],we.prototype,"enableIndependentAxes",2),p([ze],we.prototype,"enablePanning",2),p([ze],we.prototype,"enableScrolling",2),p([ze],we.prototype,"enableSelecting",2),p([ze],we.prototype,"enableTwoFingerZoom",2),p([ze],we.prototype,"panKey",2),p([ze],we.prototype,"axes",2),p([ze],we.prototype,"scrollingStep",2),p([ze],we.prototype,"keepAspectRatio",2),p([ze],we.prototype,"minVisibleItems",2),p([ze],we.prototype,"anchorPointX",2),p([ze],we.prototype,"anchorPointY",2),p([ze],we.prototype,"autoScaling",2),p([or({changeValue(e){this.updateAxisCursor({axisDraggingMode:e})}}),ze],we.prototype,"axisDraggingMode",2),p([ze],we.prototype,"buttons",2),p([ze],we.prototype,"onDataChange",2),p([N_("panner.deceleration"),ze],we.prototype,"deceleration",2);var vc=Xs("pointer","start","middle","end"),sn={type:"plugin",name:"zoom",enterprise:!0,version:b_,options:{enabled:ei,enableAxisDragging:ei,enableAxisScrolling:ei,enableDoubleClickToReset:ei,enablePanning:ei,enableScrolling:ei,enableSelecting:ei,enableTwoFingerZoom:ei,keepAspectRatio:ei,anchorPointX:vc,anchorPointY:vc,axisDraggingMode:Xs("pan","zoom"),axes:Xs("x","y","xy"),deceleration:k_(Xs("off","short","long"),ou),minVisibleItems:D_,panKey:Xs("alt","ctrl","meta","shift"),scrollingStep:ou,autoScaling:{enabled:ei,padding:ou},onDataChange:{strategy:A_()("reset","preserveDomain","preserveRatios"),stickToEnd:ei},buttons:{enabled:ei,buttons:v_({...I_,value:Xs("reset","zoom-in","zoom-out","pan-left","pan-right","pan-start","pan-end"),section:M_},"zoom button options array"),visible:Xs("always","zoomed","hover")}},themeTemplate:{enabled:!1,enableAxisDragging:!0,enableAxisScrolling:!0,enableDoubleClickToReset:!0,enablePanning:!0,enableScrolling:!0,enableSelecting:!1,enableTwoFingerZoom:!0,deceleration:"short",minVisibleItems:2,panKey:"alt",scrollingStep:.1,autoScaling:{enabled:{$and:[{$eq:[{$path:"../axes"},"x"]},{$not:{$eq:[{$path:"/series/0/direction"},"horizontal"]}}]},padding:.05},onDataChange:{strategy:"preserveDomain",stickToEnd:!1},anchorPointX:"end",anchorPointY:"middle",axes:"x",buttons:{enabled:{$path:"../enabled"},visible:"hover",buttons:[{icon:"zoom-out",value:"zoom-out",section:"scale"},{icon:"zoom-in",value:"zoom-in",section:"scale"},{icon:"pan-left",value:"pan-left",section:"pan"},{icon:"pan-right",value:"pan-right",section:"pan"},{icon:"reset",value:"reset",section:"reset"}]}},create:e=>new we(e)};sn.options.enableIndependentAxes=su(ei),sn.options.buttons.anchorPointX=su(vc),sn.options.buttons.anchorPointY=su(vc);import{VERSION as vB,_ModuleSupport as kc}from"ag-charts-community";import{and as Fb,array as kB,boolean as Hb,borderOptionsDef as DB,callback as AB,colorUnion as MB,fontOptionsDef as IB,greaterThan as LB,legendPositionValidator as NB,lessThan as CB,number as Wb,numberFormatValidator as TB,padding as wB,positiveNumber as Js,ratio as PB}from"ag-charts-core";import{_ModuleSupport as OB}from"ag-charts-community";import{BaseProperties as du,Border as RB,CleanupRegistry as EB,Property as ti,ProxyProperty as pu,ZIndexMap as _B,createId as BB,expandLegendPosition as uu}from"ag-charts-core";import{_ModuleSupport as VB}from"ag-charts-community";import{ZIndexMap as zB,cachedTextMeasurer as FB,countFractionDigits as HB,createId as WB,createIdsGenerator as KB,estimateTickCount as GB,findMinMax as $B,findRangeExtent as YB,isArray as UB,measureTextSegments as jB,toPlainText as XB,toTextString as ZB}from"ag-charts-core";import{callWithContext as qB}from"ag-charts-core";function nr(e,t,i){return qB(e.chartService,t,i)}var{AxisInterval:QB,AxisLabel:JB,LinearScale:eV,BBox:tV,TranslatableGroup:iV,Selection:oV,Text:sV}=VB,Dc=class om{constructor(t,i){this.ctx=t,this.dataProvider=i,this.id=WB(this),this.axisGroup=new iV({name:`${this.id}-AxisTicks`,zIndex:zB.AXIS}),this.labelSelection=oV.select(this.axisGroup,sV),this.interval=new QB,this.label=new JB,this.scale=new eV,this.placement="bottom",this.translationX=0,this.translationY=0,this.padding=0}get horizontal(){return this.placement.startsWith("top")||this.placement.startsWith("bottom")}attachAxis(t){t.appendChild(this.axisGroup)}calculateLayout(){const{placement:t,translationX:i,translationY:o,horizontal:s,label:a}=this;function n(u){}let r,l;switch(t){case"top":case"top-right":case"top-left":r="bottom",l="center",a.mirrored=!1,a.parallel=!0;break;case"bottom":case"bottom-right":case"bottom-left":r="top",l="center",a.mirrored=!1,a.parallel=!0;break;case"right":case"right-top":case"right-bottom":case"left":case"left-top":case"left-bottom":r="middle",l="left",a.mirrored=!0,a.parallel=!1;break;default:}const c=[],h=this.generateTicks(),{ticks:d}=h;return this.labelSelection.update(d,void 0,u=>u.tickId),this.axisGroup.setProperties({translationX:i,translationY:o}),this.labelSelection.each((u,g)=>{u.fontFamily=a.fontFamily,u.fontSize=a.fontSize,u.fontStyle=a.fontStyle,u.fontWeight=a.fontWeight,u.fill=a.color,u.textBaseline=r,u.textAlign=l,u.text=g.tickLabel,u.x=s?g.translation:0,u.y=s?0:g.translation,c.push(u.getBBox())}),c.length>0?tV.merge(c).translate(i,o):void 0}tickFormatter(t,i,o,s){const{ctx:a}=this,{formatManager:n}=a,r=this.dataProvider.data.flatMap(l=>l.series);return(l,c)=>{const h={type:"number",value:l,datum:void 0,seriesId:void 0,legendItemName:void 0,key:void 0,source:"gradient-legend",property:"color",domain:t,boundSeries:r,fractionDigits:s};return this.label.formatValue((d,u)=>nr(a,d,u),h,c)??n.format((d,u)=>nr(a,d,u),h)??n.defaultFormat(h)}}inRange(t,i=.001){const[o,s]=$B(this.scale.range);return t>=o-i&&t<=s+i}generateTicks(){const{minSpacing:t,maxSpacing:i}=this.interval,{maxTickCount:o,minTickCount:s,tickCount:a}=GB(YB(this.scale.range),1,t,i,om.DefaultTickCount,om.DefaultMinSpacing),n=this.getTicksData({nice:[!0,!0],interval:this.interval.step,tickCount:a,minTickCount:s,maxTickCount:o});if(this.placement==="bottom"||this.placement==="top"){const r=FB(this.label),{domain:l}=this.scale,h=l[0]>l[1]?-1:1;let d=-1/0*h;n.ticks=n.ticks.filter(u=>{if(Math.sign(u.translation-d)!==h)return!1;const{width:g}=UB(u.tickLabel)?jB(u.tickLabel,this.label):r.measureLines(ZB(u.tickLabel));return d=u.translation+g*h,!0})}return n}getTicksData(t){const i=[],o=t.nice?this.scale.niceDomain(t):this.scale.domain,s=this.scale.ticks(t,o)?.ticks??[],a=s.reduce((l,c)=>Math.max(l,HB(c)),0),n=KB(),r=this.tickFormatter(o,s,!1,a);for(let l=0;l<s.length;l++){const c=s[l],h=this.scale.convert(c);if(!this.inRange(h))continue;const d=r(c,l);if(d==null||d==="")continue;const u=n(XB(d));i.push({tick:c,tickId:u,tickLabel:d,translation:h})}return{rawTicks:s,fractionDigits:a,ticks:i}}};Dc.className="AxisTicks",Dc.DefaultTickCount=5,Dc.DefaultMinSpacing=10;var aV=Dc,{LayoutElement:nV,Group:rV,Rect:Kb,Marker:lV,TranslatableGroup:cV,BBox:gu}=OB,mu=class extends du{constructor(){super(...arguments),this.thickness=16,this.preferredLength=100}};p([ti],mu.prototype,"thickness",2),p([ti],mu.prototype,"preferredLength",2);var Ac=class extends du{constructor(e){super(),this.axisTicks=e}};p([pu("axisTicks.label")],Ac.prototype,"label",2),p([pu("axisTicks.interval")],Ac.prototype,"interval",2),p([pu("axisTicks.padding")],Ac.prototype,"padding",2);var ii=class extends du{constructor(e){super(),this.ctx=e,this.id=BB(this),this.legendGroup=new cV({name:"legend",zIndex:_B.LEGEND}),this.containerNode=this.legendGroup.appendChild(new Kb({name:"legend-container"})),this.gradientRect=new Kb,this.arrow=new lV({shape:"triangle"}),this.ticksGroup=new rV({name:"legend-axis-group"}),this.cleanup=new EB,this.enabled=!1,this.position="bottom",this.reverseOrder=!1,this.gradient=new mu,this.spacing=20,this.border=new RB(this.containerNode),this.cornerRadius=0,this.fillOpacity=1,this.padding=4,this.data=[],this.highlightManager=e.highlightManager,this.axisTicks=new aV(e,this),this.axisTicks.attachAxis(this.ticksGroup),this.scale=new Ac(this.axisTicks),this.legendGroup.append([this.gradientRect,this.arrow,this.ticksGroup]),this.cleanup.register(e.eventsHub.on("highlight:change",()=>this.onChartHoverChange()),e.layoutManager.registerElement(nV.Legend,t=>this.onStartLayout(t)),()=>this.legendGroup.remove())}isVertical(){const{placement:e}=uu(this.position);return e.startsWith("right")||e.startsWith("left")}destroy(){this.cleanup.flush()}attachLegend(e){e.appendChild(this.legendGroup)}onStartLayout({layoutBox:e}){const[t]=this.data;if(!this.enabled||!t?.enabled||t.legendType!=="gradient"){this.legendGroup.visible=!1;return}const{colorRange:i}=this.normalizeColorArrays(t),{strokeWidth:o,padding:s}=this.getContainerStyles(),a=this.updateGradientRect(e,i),n=this.updateAxis(t,a)??new gu(0,0,0,0),r=gu.merge([a,n]);r.grow(s).grow(o);const{left:l,top:c}=this.getMeasurements(e,r);this.updateContainer(r),this.updateArrow(),this.legendGroup.visible=!0,this.legendGroup.translationX=l,this.legendGroup.translationY=c}normalizeColorArrays(e){let t=e.colorDomain.slice();const i=e.colorRange.slice();if(t.length===i.length)return{colorDomain:t,colorRange:i};t.length>i.length&&i.splice(t.length);const[o,s]=t,a=i.length;return t=i.map((n,r)=>r===0?o:r===a-1?s:o+(s-o)*r/(a-1)),{colorDomain:t,colorRange:i}}updateGradientRect(e,t){const{gradientRect:i,gradient:o}=this,{preferredLength:s,thickness:a}=o,n=new gu(0,0,0,0),r=Math.max(t.length-1,1);let l;return this.isVertical()?(l=0,n.width=a,n.height=Math.min(e.height,s)):(l=90,n.width=Math.min(e.width,s),n.height=a),i.x=n.x,i.y=n.y,i.width=n.width,i.height=n.height,i.fill={type:"gradient",gradient:"linear",colorSpace:"oklch",colorStops:t.map((c,h)=>({stop:h/r,color:c})),rotation:l},n}updateAxis(e,t){const{axisTicks:i,gradient:o,scale:s}=this,{placement:a}=uu(this.position),n=this.isVertical(),r=this.reverseOrder!==n;i.placement=a;const l=o.thickness+(s.padding??0);return i.translationX=n?l:t.x,i.translationY=n?t.y:l,i.scale.domain=r?e.colorDomain.slice().reverse():e.colorDomain,i.scale.range=n?[t.x,t.height]:[t.y,t.width],i.calculateLayout()}updateContainer(e){const t=this.getContainerStyles();this.containerNode.setStyleProperties(t),this.containerNode.cornerRadius=t.cornerRadius,this.containerNode.x=e.x,this.containerNode.y=e.y,this.containerNode.width=e.width,this.containerNode.height=e.height}updateArrow(){const e=this.highlightManager.getActiveHighlight(),{arrow:t}=this;if(e?.colorValue==null){t.visible=!1;return}const{scale:i,label:o}=this.axisTicks,s=o.fontSize??0,a=i.convert(e.colorValue);let{x:n,y:r}=this.gradientRect,l=Math.PI;this.isVertical()?(n-=s/2,r+=a,l/=2):(n+=a,r-=s/2),t.visible=!0,t.fill=o.color,t.rotation=l,t.size=s,t.translationX=n,t.translationY=r}getMeasurements(e,t){function i(u){}let{x:o,y:s}=e;const{width:a,height:n}=t,{placement:r,floating:l,xOffset:c,yOffset:h}=uu(this.position),d=this.getContainerStyles();switch(o+=d.strokeWidth+d.padding.left,s+=d.strokeWidth+d.padding.top,r){case"left":s+=e.height/2-n/2;break;case"right":o+=e.width-a,s+=e.height/2-n/2;break;case"top":o+=e.width/2-a/2;break;case"bottom":o+=e.width/2-a/2,s+=e.height-n;break;case"right-top":case"top-right":o+=e.width-a;break;case"right-bottom":case"bottom-right":o+=e.width-a,s+=e.height-n;break;case"left-bottom":case"bottom-left":s+=e.height-n;break;case"left-top":case"top-left":break;default:}if(!l)switch(r){case"left":case"left-top":case"left-bottom":e.shrink(a+this.spacing,"left");break;case"right":case"right-top":case"right-bottom":e.shrink(a+this.spacing,"right");break;case"top":case"top-left":case"top-right":e.shrink(n+this.spacing,"top");break;case"bottom":case"bottom-left":case"bottom-right":e.shrink(n+this.spacing,"bottom");break;default:}return o+=c,s+=h,{top:s,left:o}}getContainerStyles(){const{stroke:e,strokeOpacity:t,strokeWidth:i}=this.border,{cornerRadius:o,fill:s,fillOpacity:a,padding:n}=this,r=typeof n=="number";return{cornerRadius:o,fill:s,fillOpacity:a,padding:{top:r?n:n.top??0,right:r?n:n.right??0,bottom:r?n:n.bottom??0,left:r?n:n.left??0},stroke:e,strokeOpacity:t,strokeWidth:this.border.enabled?i:0}}onChartHoverChange(){this.enabled&&this.updateArrow()}};ii.className="GradientLegend",p([ti],ii.prototype,"enabled",2),p([ti],ii.prototype,"position",2),p([ti],ii.prototype,"reverseOrder",2),p([ti],ii.prototype,"gradient",2),p([ti],ii.prototype,"spacing",2),p([ti],ii.prototype,"border",2),p([ti],ii.prototype,"cornerRadius",2),p([ti],ii.prototype,"fill",2),p([ti],ii.prototype,"fillOpacity",2),p([ti],ii.prototype,"padding",2),p([ti],ii.prototype,"scale",2);var Mc={type:"plugin",name:"gradientLegend",enterprise:!0,version:vB,options:{enabled:Hb,position:NB,spacing:Js,reverseOrder:Hb,border:DB,cornerRadius:Wb,padding:wB,fill:MB,fillOpacity:PB,gradient:{preferredLength:Js,thickness:Js},scale:{label:{...IB,minSpacing:Js,format:TB,formatter:AB},padding:Js,interval:{step:Wb,values:kB,minSpacing:Fb(Js,CB("maxSpacing")),maxSpacing:Fb(Js,LB("minSpacing"))}}},themeTemplate:{...kc.LEGEND_CONTAINER_THEME,enabled:!1,position:"bottom",spacing:20,scale:{padding:13,label:{color:{$ref:"textColor"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},minSpacing:5},interval:{minSpacing:15}},gradient:{preferredLength:100,thickness:16},reverseOrder:!1,fill:{$applySwitch:[{$path:"type"},{$ref:"chartBackgroundColour"},["gradient",kc.FILL_GRADIENT_BLANK_DEFAULTS],["pattern",kc.FILL_PATTERN_BLANK_DEFAULTS],["image",kc.FILL_IMAGE_BLANK_DEFAULTS]]}},create:e=>{const t=new ii(e);return t.attachLegend(e.scene),t}};import{VERSION as hV,_ModuleSupport as rr}from"ag-charts-community";import{VERSION as dV,_ModuleSupport as pV}from"ag-charts-community";import{_ModuleSupport as uV}from"ag-charts-community";var{Chart:gV}=uV,yu=class extends gV{getChartType(){return"standalone"}performLayout(e){const{seriesRoot:t,annotationRoot:i}=this,o=e.layoutBox.clone().shrink(this.seriesArea.getPadding());this.seriesRect=o,this.animationRect=o;for(const s of[t,i])s.translationX=Math.floor(o.x),s.translationY=Math.floor(o.y);t.visible=this.series[0].visible,this.ctx.layoutManager.emitLayoutComplete(e,{series:{visible:!0,rect:o,paddedRect:e.layoutBox}})}getAriaLabel(){const e=this.series[0]?.type;if(e==null)return"";const t=this.getCaptionText();switch(e){case"radial-gauge":case"linear-gauge":{const i=[];t.length!==0&&i.push(t);for(const o of this.series)i.push(o.getCaptionText());return this.ctx.localeManager.t("ariaAnnounceGaugeChart",{caption:i.join(". ")})}case"treemap":case"sunburst":return this.ctx.localeManager.t("ariaAnnounceHierarchyChart",{caption:t});default:return this.ctx.localeManager.t("ariaAnnounceStandaloneChart",{caption:t})}}};yu.className="StandaloneChart",yu.type="standalone";var{standaloneChartOptionsDefs:mV}=pV,an={type:"chart",name:"standalone",enterprise:!0,version:dV,options:mV,create(e,t){return new yu(e,t)}};import{_ModuleSupport as yV}from"ag-charts-community";import{Logger as fV,angleBetween as Ic,cachedTextMeasurer as xV,calcLineHeight as SV,evaluateBezier as Lc,isBetweenAngles as Gb,mergeDefaults as Nc,normalizeAngle360 as bV,toPlainText as vV,wrapText as kV}from"ag-charts-core";import{_ModuleSupport as Cc}from"ag-charts-community";import{Logger as DV}from"ag-charts-core";function $b(e,t,i){i||(t=AV(t));const o=new Map;for(const a of e)o.set(a.id,{datum:a,linksBefore:[],linksAfter:[],maxPathLengthBefore:-1,maxPathLengthAfter:-1});let s=0;for(const[a,n]of o.entries())s=Math.max(s,fu(o,t,n,a,-1,[])+fu(o,t,n,a,1,[])+1);return{links:t,nodeGraph:o,maxPathLength:s}}function Yb(e,t,i,o){const s=o.indexOf(t);if(s!==-1){for(let n=s;n<o.length;n+=1)i.add(o[n]);return}o.push(t);const{toNode:a}=t;for(const n of e)n.fromNode===a&&Yb(e,n,i,o);o.pop()}function AV(e){const t=new Set;for(const i of e)Yb(e,i,t,[]);return t.size!==0&&DV.warnOnce("Some links formed circular references. These will be removed from the output."),t.size===0?e:e.filter(i=>!t.has(i))}function fu(e,t,i,o,s,a){if(a.includes(o))return 1/0;let n=s===-1?i.maxPathLengthBefore:i.maxPathLengthAfter;if(n===-1){n=0;const r=s===-1?i.linksBefore:i.linksAfter;for(const l of t){const{fromNode:c,toNode:h}=l,d=s===-1?h.id:c.id,u=s===-1?c.id:h.id,g=o===d?e.get(u):void 0;g!=null&&(r.push({node:g,link:l}),a?.push(o),n=Math.max(n,fu(e,t,g,u,s,a)+1),a?.pop())}s===-1?i.maxPathLengthBefore=n:i.maxPathLengthAfter=n}return n}var{Series:MV,DataController:IV,keyProperty:LV,valueProperty:Tc,Selection:ea,Group:lr,TransformableText:NV,HighlightState:Ub}=Cc,CV=class extends Cc.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o);const{datumIndex:s}=i,a=o.contextNodeData?.nodeData.find(n=>n.datumIndex.type===s.type&&n.datumIndex.index===s.index);this.size=a?.size,this.label=a?.type===1?a?.label:void 0}},jb=class extends MV{constructor(){super(...arguments),this.NodeEvent=CV,this.nodeCount=0,this.linkCount=0,this.linksDataModel=void 0,this.linksProcessedData=void 0,this.nodesDataModel=void 0,this.nodesProcessedData=void 0,this.processedNodes=new Map,this.linkGroup=this.contentGroup.appendChild(new lr({name:"linkGroup"})),this.nodeGroup=this.contentGroup.appendChild(new lr({name:"nodeGroup"})),this.focusLinkGroup=this.highlightGroup.appendChild(new lr({name:"linkGroup"})),this.focusNodeGroup=this.highlightGroup.appendChild(new lr({name:"nodeGroup"})),this.highlightLinkGroup=this.highlightGroup.appendChild(new lr({name:"linkGroup"})),this.labelSelection=ea.select(this.labelGroup,NV),this.linkSelection=ea.select(this.linkGroup,()=>this.linkFactory()),this.nodeSelection=ea.select(this.nodeGroup,()=>this.nodeFactory()),this.focusLinkSelection=ea.select(this.focusLinkGroup,()=>this.linkFactory()),this.focusNodeSelection=ea.select(this.focusNodeGroup,()=>this.nodeFactory()),this.highlightLinkSelection=ea.select(this.highlightLinkGroup,()=>this.linkFactory()),this.highlightNodeSelection=ea.select(this.highlightNodeGroup,()=>this.nodeFactory())}get nodes(){return this.properties.nodes}async processData(e){const{data:t,nodes:i}=this;if(t==null)return;const{fromKey:o,toKey:s,sizeKey:a,idKey:n,labelKey:r}=this.properties,l=new IV("standalone",e.suppressFieldDotNotation,this.ctx.eventsHub),c=i==null?null:l.request(this.id,Cc.DataSet.wrap(i)??Cc.DataSet.empty(),{props:[LV(n,void 0,{id:"idValue",includeProperty:!1}),...r==null?[]:[Tc(r,void 0,{id:"labelValue",includeProperty:!1})]],groupByKeys:!0}),h=e.request(this.id,t,{props:[Tc(o,void 0,{id:"fromValue",includeProperty:!1}),Tc(s,void 0,{id:"toValue",includeProperty:!1}),...a==null?[]:[Tc(a,void 0,{id:"sizeValue",includeProperty:!1,missingValue:0})]],groupByKeys:!1});i!=null&&l.execute();const[d,u]=await Promise.all([c??Promise.resolve(null),h]);this.nodesDataModel=d?.dataModel,this.nodesProcessedData=d?.processedData,this.linksDataModel=u?.dataModel,this.linksProcessedData=u?.processedData;const g=new Map;if(d==null){const m=u.dataModel.resolveColumnById(this,"fromValue",u.processedData),y=u.dataModel.resolveColumnById(this,"toValue",u.processedData),S=b=>{const f=g.size,v=b;return{series:this,itemId:void 0,datum:{},datumIndex:{type:1,index:f},type:1,index:f,linksBefore:[],linksAfter:[],id:b,size:0,label:v,style:this.getNodeStyle({datumIndex:{type:1,index:f},datum:{},size:0,label:v},f,!1)}},x=u.processedData.dataSources.get(this.id)?.data;if(x)for(const[b]of x.entries()){const f=m[b],v=y[b];f==null||v==null||(g.has(f)||g.set(f,S(f)),g.has(v)||g.set(v,S(v)))}}else{const m=d.dataModel.resolveColumnById(this,"idValue",d.processedData),y=r==null?void 0:d.dataModel.resolveColumnById(this,"labelValue",d.processedData),S=d.processedData.dataSources.get(this.id)?.data;if(S)for(const[x,b]of S.entries()){const f=m[x],v=y?.[x],k={type:1,index:x};g.set(f,{series:this,itemId:void 0,datum:b,datumIndex:k,type:1,index:x,linksBefore:[],linksAfter:[],id:f,size:0,label:v,style:this.getNodeStyle({datumIndex:k,datum:b,size:0,label:v},x,!1)})}}this.processedNodes=g}getNodeGraph(e,t,{includeCircularReferences:i}){const{linksDataModel:o,linksProcessedData:s}=this;if(o==null||s==null){const{links:y,nodeGraph:S,maxPathLength:x}=$b(new Map().values(),[],i);return this.nodeCount=0,this.linkCount=0,{nodeGraph:S,links:y,maxPathLength:x}}const{sizeKey:a}=this.properties,n=o.resolveColumnById(this,"fromValue",s),r=o.resolveColumnById(this,"toValue",s),l=a==null?void 0:o.resolveColumnById(this,"sizeValue",s),c=new Map;for(const y of this.processedNodes.values()){const S=e(y);c.set(y.id,S)}const h=[],d=s.dataSources.get(this.id)?.data;if(d)for(const[y,S]of d.entries()){const x=n[y],b=r[y],f=l==null?1:l[y],v=c.get(x),k=c.get(b);if(f<=0||v==null||k==null)continue;const A={type:0,index:y},M=t({series:this,itemId:void 0,datum:S,datumIndex:A,type:0,index:y,fromNode:v,toNode:k,size:f,style:this.getLinkStyle({datum:S,datumIndex:A},v.datumIndex,!1)});h.push(M)}const{links:u,nodeGraph:g,maxPathLength:m}=$b(c.values(),h,i);for(const y of g.values())y.datum.linksBefore=y.linksBefore.map(S=>S.link),y.datum.linksAfter=y.linksAfter.map(S=>S.link);return this.nodeCount=g.size,this.linkCount=u.length,{nodeGraph:g,links:u,maxPathLength:m}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(e){const{seriesRect:t}=e,i={seriesRectWidth:t?.width??0,seriesRectHeight:t?.height??0};(this._nodeDataDependencies==null||this._nodeDataDependencies.seriesRectWidth!==i.seriesRectWidth||this._nodeDataDependencies.seriesRectHeight!==i.seriesRectHeight)&&(this._nodeDataDependencies=i),this.updateSelections();const o=this.contextNodeData?.nodeData??[],s=this.contextNodeData?.labelData??[],a=this.getHighlightedDatum();this.contentGroup.visible=this.visible;const n=a==null?Ub.None:Ub.OtherItem;this.contentGroup.opacity=this.properties.highlight.getStyle(n).opacity??1,this.labelSelection=this.updateLabelSelection({labelData:s,labelSelection:this.labelSelection}),this.updateLabelNodes({labelSelection:this.labelSelection}),this.linkSelection=this.updateLinkSelection({nodeData:o.filter(d=>d.type===0),datumSelection:this.linkSelection}),this.updateLinkNodes({datumSelection:this.linkSelection,isHighlight:!1}),this.nodeSelection=this.updateNodeSelection({nodeData:o.filter(d=>d.type===1),datumSelection:this.nodeSelection}),this.updateNodeNodes({datumSelection:this.nodeSelection,isHighlight:!1});let r,l,c,h;a?.type===1?(r=o.filter(d=>d.type===0&&(d.toNode===a||d.fromNode===a)),l=r.map(d=>d.fromNode===a?d.toNode:d.fromNode),l.push(a),c=[],h=[a]):a?.type===0?(r=[a],l=[a.fromNode,a.toNode],c=[a],h=[]):(r=[],l=[],c=[],h=[]),this.focusLinkSelection=this.updateLinkSelection({nodeData:r,datumSelection:this.focusLinkSelection}),this.updateLinkNodes({datumSelection:this.focusLinkSelection,isHighlight:!1}),this.focusNodeSelection=this.updateNodeSelection({nodeData:l,datumSelection:this.focusNodeSelection}),this.updateNodeNodes({datumSelection:this.focusNodeSelection,isHighlight:!1}),this.highlightLinkSelection=this.updateLinkSelection({nodeData:c,datumSelection:this.highlightLinkSelection}),this.updateLinkNodes({datumSelection:this.highlightLinkSelection,isHighlight:!0}),this.highlightNodeSelection=this.updateNodeSelection({nodeData:h,datumSelection:this.highlightNodeSelection}),this.updateNodeNodes({datumSelection:this.highlightNodeSelection,isHighlight:!0})}getHighlightedDatum(){let e=this.ctx.highlightManager?.getActiveHighlight();if(e?.series===this&&e.type==null){const{itemId:t}=e,i=this.contextNodeData?.nodeData??[];e=t==null?void 0:i.find(o=>o.type===1&&o.id===t)}else e?.series!==this&&(e=void 0);return e}isLabelHighlighted(e,t){return t==null?!1:t.type===1?t===e:t.type===0?t.fromNode===e||t.toNode===e:!1}resetAnimation(e){}dataCount(){return Number.NaN}getSeriesDomain(e){return{domain:[]}}getSeriesRange(e,t){return[Number.NaN,Number.NaN]}legendItemSymbol(e,t,i={}){const{fills:o,strokes:s}=this.properties,{fill:a=o[t%o.length],fillOpacity:n=1,stroke:r=s[t%s.length],strokeWidth:l=0,strokeOpacity:c=1,lineDash:h=[0],lineDashOffset:d=0}=i;return{marker:{fill:a,fillOpacity:n,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}}}getLegendData(e){if(e!=="category")return[];const{showInLegend:t}=this.properties;return Array.from(this.processedNodes.values(),({id:i,label:o},s)=>({legendType:"category",id:this.id,itemId:i,seriesId:this.id,enabled:!0,label:{text:o??i},symbol:this.legendItemSymbol(1,s),hideInLegend:!t,isFixed:!0}))}pickNodeClosestDatum({x:e,y:t}){let i=1/0,o;return this.linkSelection.each((s,a)=>{const n=s.distanceSquared(e,t);n<i&&(i=n,o=a)}),this.nodeSelection.each((s,a)=>{const n=s.distanceSquared(e,t);n<i&&(i=n,o=a)}),o==null?void 0:{datum:o,distance:Math.sqrt(i)}}getDatumAriaText(e,t){if(e.type===0)return this.ctx.localeManager.t("ariaAnnounceFlowProportionLink",{index:e.index+1,count:this.linkCount,from:e.fromNode.id,to:e.toNode.id,size:e.size,sizeName:this.properties.sizeName??this.properties.sizeKey});if(e.type===1)return this.ctx.localeManager.t("ariaAnnounceFlowProportionNode",{index:e.index+1,count:this.nodeCount,description:t})}pickFocus(e){const{datumIndexDelta:t,otherIndexDelta:i}=e,o=this.contextNodeData?.nodeData[e.datumIndex-e.datumIndexDelta];let s=o;if(i!==0||t===0)return;if(o?.type===0){const r=Array.from(this.linkSelection,h=>h.datum),c=r.indexOf(o)+t;c>=0&&c<r.length?s=r[c]:c>0?s=r.at(-1):s=Array.from(this.nodeSelection,d=>d.datum).at(-1)}else if(o?.type===1){const r=Array.from(this.nodeSelection,h=>h.datum),c=r.indexOf(o)+t;c>=0&&c<r.length?s=r[c]:c<0?s=r[0]:s=Array.from(this.linkSelection,d=>d.datum)[0]}if(s==null)return;const a=s.type===1?Array.from(this.nodeSelection).find(r=>r.datum===s):Array.from(this.linkSelection).find(r=>r.datum===s);if(a==null)return;const n=this.computeFocusBounds(a.node);if(n!=null)return{datum:a.datum,datumIndex:this.contextNodeData?.nodeData.indexOf(a.datum)??0,otherIndex:0,bounds:n,clipFocusBox:!0}}getCategoryValue(e){}datumIndexForCategoryValue(e){}};import{_ModuleSupport as TV}from"ag-charts-community";import{SceneChangeDetection as rs}from"ag-charts-core";var{Path:wV}=TV;function Xb({radius:e,startAngle:t,endAngle:i,tension:o}){const s=e*Math.cos(t),a=e*Math.sin(t),n=e*Math.cos(i),r=e*Math.sin(i),l=s*o,c=a*o,h=n*o,d=r*o;return{x:[s,l,h,n],y:[a,c,d,r]}}var Ao=class extends wV{constructor(){super(...arguments),this.centerX=0,this.centerY=0,this.radius=0,this.startAngle1=0,this.endAngle1=0,this.startAngle2=0,this.endAngle2=0,this.tension=1}tensionedCurveTo(e,t,i,o,s,a,n,r){const{path:l,tension:c}=this,h=1-c;l.cubicCurveTo((i-e)*h+e,(o-t)*h+t,(s-n)*h+n,(a-r)*h+r,n,r)}updatePath(){const{path:e,centerX:t,centerY:i,radius:o}=this;let{startAngle1:s,endAngle1:a,startAngle2:n,endAngle2:r}=this;s>n&&([s,n]=[n,s],[a,r]=[r,a]),e.clear();const l=t+o*Math.cos(s),c=i+o*Math.sin(s);e.moveTo(l,c),this.tensionedCurveTo(l,c,t,i,t,i,t+o*Math.cos(r),i+o*Math.sin(r)),e.arc(t,i,o,r,n,!0),this.tensionedCurveTo(t+o*Math.cos(n),i+o*Math.sin(n),t,i,t,i,t+o*Math.cos(a),i+o*Math.sin(a)),e.arc(t,i,o,a,s,!0),e.closePath()}};p([rs()],Ao.prototype,"centerX",2),p([rs()],Ao.prototype,"centerY",2),p([rs()],Ao.prototype,"radius",2),p([rs()],Ao.prototype,"startAngle1",2),p([rs()],Ao.prototype,"endAngle1",2),p([rs()],Ao.prototype,"startAngle2",2),p([rs()],Ao.prototype,"endAngle2",2),p([rs()],Ao.prototype,"tension",2);import{_ModuleSupport as PV}from"ag-charts-community";import{BaseProperties as Zb,Property as q}from"ag-charts-core";var{FillGradientDefaults:OV,FillPatternDefaults:RV,FillImageDefaults:EV,makeSeriesTooltip:_V,SeriesProperties:BV,Label:VV}=PV,xu=class extends VV{constructor(){super(...arguments),this.spacing=1,this.maxWidth=1}};p([q],xu.prototype,"spacing",2),p([q],xu.prototype,"maxWidth",2);var qi=class extends Zb{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0,this.tension=0}getStyle(e,t,i){const{fillOpacity:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,tension:l}=this,c=this.fill??e[i%e.length],h=this.stroke??t[i%e.length];return{fill:c,fillOpacity:o,stroke:h,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,tension:l}}};p([q],qi.prototype,"fill",2),p([q],qi.prototype,"fillOpacity",2),p([q],qi.prototype,"stroke",2),p([q],qi.prototype,"strokeOpacity",2),p([q],qi.prototype,"strokeWidth",2),p([q],qi.prototype,"lineDash",2),p([q],qi.prototype,"lineDashOffset",2),p([q],qi.prototype,"tension",2),p([q],qi.prototype,"itemStyler",2);var wi=class extends Zb{constructor(){super(...arguments),this.spacing=1,this.width=1,this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}getStyle(e,t,i){const{fillOpacity:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=this,l=this.fill??e[i%e.length],c=this.stroke??t[i%e.length];return{fill:l,fillOpacity:o,stroke:c,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}}};p([q],wi.prototype,"spacing",2),p([q],wi.prototype,"width",2),p([q],wi.prototype,"fill",2),p([q],wi.prototype,"fillOpacity",2),p([q],wi.prototype,"stroke",2),p([q],wi.prototype,"strokeOpacity",2),p([q],wi.prototype,"strokeWidth",2),p([q],wi.prototype,"lineDash",2),p([q],wi.prototype,"lineDashOffset",2),p([q],wi.prototype,"itemStyler",2);var Ze=class extends BV{constructor(){super(...arguments),this.idKey="",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.sizeKey=void 0,this.sizeName=void 0,this.nodes=void 0,this.fillGradientDefaults=new OV,this.fillPatternDefaults=new RV,this.fillImageDefaults=new EV,this.fills=[],this.strokes=[],this.label=new xu,this.link=new qi,this.node=new wi,this.tooltip=_V()}};p([q],Ze.prototype,"fromKey",2),p([q],Ze.prototype,"toKey",2),p([q],Ze.prototype,"idKey",2),p([q],Ze.prototype,"idName",2),p([q],Ze.prototype,"labelKey",2),p([q],Ze.prototype,"labelName",2),p([q],Ze.prototype,"sizeKey",2),p([q],Ze.prototype,"sizeName",2),p([q],Ze.prototype,"nodes",2),p([q],Ze.prototype,"fillGradientDefaults",2),p([q],Ze.prototype,"fillPatternDefaults",2),p([q],Ze.prototype,"fillImageDefaults",2),p([q],Ze.prototype,"fills",2),p([q],Ze.prototype,"strokes",2),p([q],Ze.prototype,"label",2),p([q],Ze.prototype,"link",2),p([q],Ze.prototype,"node",2),p([q],Ze.prototype,"tooltip",2);var{SeriesNodePickMode:qb,createDatumId:wc,Sector:zV,getShapeStyle:Pc,getLabelStyles:FV,BBox:HV}=yV,Oc=e=>e.startAngle+Ic(e.startAngle,e.endAngle)/2,Su=class extends jb{constructor(e){super({moduleCtx:e,pickModes:[qb.NEAREST_NODE,qb.EXACT_SHAPE_MATCH]}),this.properties=new Ze}isLabelEnabled(){return(this.properties.labelKey!=null||this.nodes==null)&&this.properties.label.enabled}linkFactory(){return new Ao}nodeFactory(){return new zV}createNodeData(){const{id:e,_nodeDataDependencies:{seriesRectWidth:t,seriesRectHeight:i}={seriesRectWidth:0,seriesRectHeight:0},properties:o}=this,{fromKey:s,toKey:a,sizeKey:n,labelKey:r,label:{spacing:l,maxWidth:c,fontSize:h},node:{width:d,spacing:u}}=o,g=t/2,m=i/2;let y=[];const{nodeGraph:S,links:x}=this.getNodeGraph(w=>({...w,centerX:g,centerY:m,innerRadius:Number.NaN,outerRadius:Number.NaN,startAngle:Number.NaN,endAngle:Number.NaN}),w=>({...w,centerX:g,centerY:m,radius:Number.NaN,startAngle1:Number.NaN,endAngle1:Number.NaN,startAngle2:Number.NaN,endAngle2:Number.NaN}),{includeCircularReferences:!0});let b=0;for(const[w,{datum:E,linksBefore:B,linksAfter:P}]of S.entries()){const C=B.reduce((_,{link:V})=>_+V.size,0)+P.reduce((_,{link:V})=>_+V.size,0);if(C===0)S.delete(w);else{const{label:_}=o;E.size=C,b+=E.size;const V=_.enabled?this.getLabelText(E.label,E.datum,r,"label",[],_,{datum:E.datum,value:E.label,fromKey:s,toKey:a,sizeKey:n,size:E.size}):void 0;E.label=vV(V)}}let f=0;if(this.isLabelEnabled()){const w=xV(this.properties.label);let E=0;for(const{datum:B}of S.values()){const{id:P,label:C}=B;if(C==null)continue;const _=kV(C,{maxWidth:c,font:this.properties.label,textWrap:"never"}),{width:V}=w.measureLines(_);E=Math.max(V,E),y.push({id:P,text:_,centerX:g,centerY:m,angle:Number.NaN,radius:Number.NaN,size:B.size,datumIndex:B.datumIndex,nodeDatum:B})}f=E+l}const v=S.size;let k=Math.min(t,i)/2-d-f,A=u/k;if(f!==0&&(v*A>=1.5*Math.PI||k<=0)&&(y=[],k=Math.min(t,i)/2-d,A=u/k),v*A>=2*Math.PI||k<=0){fV.warnOnce("There was insufficient space to display the Chord Series.");return}const M=k,I=k+d,D=Math.max((2*Math.PI-v*A)/b,0);let L=0;for(const{datum:w}of S.values()){w.innerRadius=M,w.outerRadius=I,w.startAngle=L,w.endAngle=L+w.size*D,L=w.endAngle+A;const E=(w.innerRadius+w.outerRadius)/2,B=Oc(w);w.midPoint={x:w.centerX+E*Math.cos(B),y:w.centerY+E*Math.sin(B)}}const N=[];for(const{datum:w,linksBefore:E,linksAfter:B}of S.values()){const P=Oc(w),C=[...E.map(V=>({link:V.link,distance:Ic(Oc(V.node.datum),P),after:!1})),...B.map(V=>({link:V.link,distance:Ic(Oc(V.node.datum),P),after:!0}))];let _=w.startAngle;for(const{link:V,after:z}of C.toSorted((F,G)=>F.distance-G.distance)){const F=V.size*D;z?(V.startAngle1=_,V.endAngle1=_+F):(V.startAngle2=_,V.endAngle2=_+F),_+=V.size*D}N.push(w)}const{tension:T}=this.properties.link;for(const w of x){w.radius=k;const E=Xb({radius:k,startAngle:w.startAngle1,endAngle:w.endAngle2,tension:T}),B=Xb({radius:k,startAngle:w.startAngle2,endAngle:w.endAngle1,tension:T}),P=Lc(...E.x,.5),C=Lc(...E.y,.5),_=Lc(...B.x,.5),V=Lc(...B.y,.5);w.midPoint={x:w.centerX+(P+_)/2,y:w.centerY+(C+V)/2},N.push(w)}for(const w of y){const E=S.get(w.id)?.datum;E!=null&&(w.radius=I+l,w.angle=bV(E.startAngle+Ic(E.startAngle,E.endAngle)/2),w.datumIndex=E.datumIndex,w.nodeDatum=E)}y.sort((w,E)=>w.angle-E.angle);let O=1/0,R=-1/0;return y=y.filter(w=>{const E=SV(h),B=Math.atan2(E/2,w.radius),P=w.angle-B,C=w.angle+B;return Gb(O,P,C)||Gb(R,P,C)?!1:(O=Math.min(P,O),R=Math.max(C,R),!0)}),{itemId:e,nodeData:N,labelData:y}}updateLabelSelection(e){const t=this.isLabelEnabled()?e.labelData:[];return e.labelSelection.update(t)}updateLabelNodes(e){const t={toKey:this.properties.toKey,fromKey:this.properties.fromKey,sizeKey:this.properties.sizeKey,size:Number.NaN},i=this.getHighlightedDatum();e.labelSelection.each((o,s)=>{const{size:a,text:n,centerX:r,centerY:l,radius:c,angle:h,datumIndex:d,nodeDatum:u}=s;t.size=a;const g=this.isLabelHighlighted(u,i),m=this.getHighlightStyle(g,d),y=FV(this,void 0,t,this.properties.label,g,i),{fontStyle:S,fontWeight:x,fontSize:b,fontFamily:f,color:v}=y;o.visible=!0,o.translationX=r+c*Math.cos(h),o.translationY=l+c*Math.sin(h),o.text=n,o.fill=v,o.fontStyle=S,o.fontWeight=x,o.fontSize=b,o.fontFamily=f,o.textBaseline="middle",Math.cos(h)>=0?(o.textAlign="left",o.rotation=h):(o.textAlign="right",o.rotation=h-Math.PI);const k=m.opacity??1;o.opacity=k,o.fillOpacity=k,o.setBoxing(y)})}updateNodeSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>wc(t.type,t.id))}getNodeStyle(e,t,i){const{properties:o}=this,{fills:s,strokes:a,fillGradientDefaults:n,fillPatternDefaults:r,fillImageDefaults:l}=o,{itemStyler:c}=o.node,h=this.getHighlightStyle(i,e.datumIndex),d=Nc(h,o.node.getStyle(s,a,t));let u=Pc(d,n,r,l);if(c!=null&&e.datumIndex!=null){const g=this.cachedDatumCallback(wc(e.datumIndex.index,"node",i?"highlight":"node"),()=>{const m=this.makeItemStylerParams(e,i,u);return this.callWithContext(c,m)});g&&(u=Pc(Nc(g,u),n,r,l))}return u.opacity=1,u}makeItemStylerParams({datum:e,datumIndex:t,size:i=0,label:o},s,a){const{id:n}=this,r=this.ctx.highlightManager?.getActiveHighlight(),l=this.getHighlightStateString(r,s,t),c=this.filterItemStylerFillParams(a.fill)??a.fill;return{seriesId:n,datum:e,highlightState:l,...a,size:i,label:o,fill:c}}updateNodeNodes(e){const{datumSelection:t,isHighlight:i}=e,o=this.getShapeFillBBox();t.each((s,a)=>{const{datumIndex:n}=a,r=this.getNodeStyle(a,n.index,i);s.setStyleProperties(r,o),s.centerX=a.centerX,s.centerY=a.centerY,s.innerRadius=a.innerRadius,s.outerRadius=a.outerRadius,s.startAngle=a.startAngle,s.endAngle=a.endAngle,s.inset=s.strokeWidth/2})}updateLinkSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>wc(t.type,t.index,t.fromNode.id,t.toNode.id))}getLinkStyle({datumIndex:e,datum:t},i,o){const{id:s,properties:a}=this,{fills:n,strokes:r,fillGradientDefaults:l,fillPatternDefaults:c,fillImageDefaults:h}=a,{itemStyler:d}=a.link,u=this.getHighlightStyle(o,e),g=Nc(u,a.link.getStyle(n,r,i.index));let m=Pc(g,l,c,h);if(d!=null&&e!=null){const y=this.ctx.highlightManager?.getActiveHighlight(),S=this.cachedDatumCallback(wc(e.index,"link",o?"highlight":"node"),()=>{const x=this.getHighlightStateString(y,o,i);return this.callWithContext(d,{seriesId:s,datum:t,highlightState:x,...m})});S&&(m=Pc(Nc(S,m),l,c,h))}return m.opacity=1,m}updateLinkNodes(e){const{datumSelection:t,isHighlight:i}=e,o=this.getShapeFillBBox();t.each((s,a)=>{const n=a.fromNode.datumIndex,r=this.getLinkStyle(a,n,i);s.centerX=a.centerX,s.centerY=a.centerY,s.radius=a.radius,s.startAngle1=a.startAngle1,s.endAngle1=a.endAngle1,s.startAngle2=a.startAngle2,s.endAngle2=a.endAngle2,s.tension=r.tension,s.setStyleProperties(r,o)})}getShapeFillBBox(){const e=this._nodeDataDependencies?.seriesRectWidth??0,t=this._nodeDataDependencies?.seriesRectHeight??0,i=Math.min(e,t),o=(e-i)/2,s=(t-i)/2,a=new HV(o,s,e,t);return{series:a,axis:a}}getTooltipContent(e){const{id:t,linksProcessedData:i,nodesProcessedData:o,properties:s,ctx:{formatManager:a}}=this,{fromKey:n,toKey:r,sizeKey:l,sizeName:c,tooltip:h}=s,d=this.contextNodeData?.nodeData.find(b=>b.datumIndex.type===e.type&&b.datumIndex.index===e.index);if(d==null)return;const u=d.type===0?d.fromNode.index:d.index,g=d.type===0?`${d.fromNode.label} - ${d.toNode.label}`:d.label,m=e.type===0?i?.dataSources.get(this.id)?.data[e.index]:o?.dataSources.get(this.id)?.data[e.index],y=d.size;let S;if(d.type===0){const b=d.fromNode.datumIndex;S=this.getLinkStyle({datumIndex:e,datum:m},b,!1)}else{const b=d.label;S=this.getNodeStyle({datumIndex:e,datum:m,size:y,label:b},e.index,!1)}const x=[];if(l!=null){const b=a.format(this.callWithContext.bind(this),{type:"number",value:y,datum:m,seriesId:t,legendItemName:void 0,key:l,source:"tooltip",property:"size",domain:[],boundSeries:this.getFormatterContext("size"),fractionDigits:void 0});x.push({label:c,fallbackLabel:l,value:b??String(y)})}return this.formatTooltipWithContext(h,{title:g,symbol:this.legendItemSymbol(d.type,u,S),data:x},{seriesId:t,datum:m,title:g,fromKey:n,toKey:r,sizeKey:l,sizeName:c,size:y,...S})}computeFocusBounds(e){return e}hasItemStylers(){return this.properties.node.itemStyler!=null||this.properties.link.itemStyler!=null||this.properties.label.itemStyler!=null}};Su.className="ChordSeries",Su.type="chord";import{_ModuleSupport as WV}from"ag-charts-community";import{commonSeriesOptionsDefs as KV,constant as GV,fillGradientDefaults as $V,fillImageDefaults as YV,fillPatternDefaults as UV,required as bu,string as Rc,undocumented as vu}from"ag-charts-core";var{chordSeriesThemeableOptionsDef:jV}=WV,Ec={...jV,...KV,type:bu(GV("chord")),fromKey:bu(Rc),toKey:bu(Rc),sizeKey:Rc,sizeName:Rc};Ec.fillGradientDefaults=vu($V),Ec.fillPatternDefaults=vu(UV),Ec.fillImageDefaults=vu(YV);var Qb={type:"series",name:"chord",chartType:"standalone",enterprise:!0,solo:!0,version:hV,dependencies:[an],options:Ec,themeTemplate:{series:{fills:{$palette:"fills"},strokes:{$palette:"strokes"},fillGradientDefaults:rr.FILL_GRADIENT_LINEAR_DEFAULTS,fillPatternDefaults:rr.FILL_PATTERN_DEFAULTS,fillImageDefaults:rr.FILL_IMAGE_DEFAULTS,highlight:rr.singleSeriesHighlightStyle(),label:{...rr.LABEL_BOXING_DEFAULTS,enabled:!0,fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:5,maxWidth:100},node:{spacing:8,width:10,strokeWidth:{$isUserOption:["./stroke",2,0]}},link:{fillOpacity:.5,strokeWidth:{$isUserOption:["./stroke",2,0]},tension:.4}},legend:{enabled:!1,toggleSeries:!1}},create:e=>new Su(e)};import{CartesianChartModule as XV,VERSION as ZV}from"ag-charts-community";import{_ModuleSupport as _c}from"ag-charts-community";import{CARTESIAN_AXIS_TYPE as nn,CARTESIAN_POSITION as rn,DEFAULT_SHADOW_COLOUR as qV}from"ag-charts-core";var ln={$eq:[{$path:["/series/0/direction",void 0]},"horizontal"]},Jb={autoRotate:{$path:"/series/0/stageLabel/autoRotate"},autoRotateAngle:{$path:"/series/0/stageLabel/autoRotateAngle"},avoidCollisions:{$path:["/series/0/stageLabel/avoidCollisions",!0]},border:{$path:["/series/0/stageLabel/border"]},color:{$path:["/series/0/stageLabel/color",{$ref:"textColor"}]},cornerRadius:{$path:["/series/0/stageLabel/cornerRadius"]},enabled:{$if:[{$eq:[{$path:"/series/0/stageLabel/enabled"},void 0]},!0,{$path:"/series/0/stageLabel/enabled"}]},fill:{$path:["/series/0/stageLabel/fill"]},fillOpacity:{$path:["/series/0/stageLabel/fillOpacity"]},fontSize:{$path:["/series/0/stageLabel/fontSize",{$ref:"fontSize"}]},fontStyle:{$path:["/series/0/stageLabel/fontStyle",{$ref:"fontStyle"}]},fontWeight:{$path:["/series/0/stageLabel/fontWeight",{$ref:"fontWeight"}]},format:{$path:"/series/0/stageLabel/format"},formatter:{$path:"/series/0/stageLabel/formatter"},itemStyler:{$path:"/series/0/stageLabel/itemStyler"},minSpacing:{$path:"/series/0/stageLabel/minSpacing"},padding:{$path:["/series/0/stageLabel/padding"]},rotation:{$path:["/series/0/stageLabel/rotation",0]}},ev={y:{type:{$if:[ln,nn.NUMBER,nn.CATEGORY]},position:{$if:[ln,rn.LEFT,{$if:[{$eq:[{$path:["/series/0/stageLabel/placement",void 0]},"after"]},rn.RIGHT,rn.LEFT]}]},label:{$if:[ln,void 0,Jb]}},x:{type:{$if:[ln,nn.CATEGORY,nn.NUMBER]},position:{$if:[ln,{$if:[{$eq:[{$path:["/series/0/stageLabel/placement",void 0]},"before"]},rn.TOP,rn.BOTTOM]},rn.BOTTOM]},label:{$if:[ln,Jb,void 0]}}},QV={series:{direction:"vertical",strokeWidth:{$isUserOption:["./strokes/0",2,0]},spacingRatio:.25,fills:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},[{$path:["/0",void 0,{$palette:"fills"}]}],{$applySwitch:[{$path:["/type",void 0,{$value:"$1"}]},{$value:"$1"},["gradient",_c.FILL_GRADIENT_LINEAR_SINGLE_DEFAULTS],["pattern",_c.FILL_PATTERN_SINGLE_DEFAULTS],["image",_c.FILL_IMAGE_DEFAULTS]]}]},strokes:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},[{$path:["/0",void 0,{$palette:"strokes"}]}]]},label:{..._c.LABEL_BOXING_DEFAULTS,enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"chartBackgroundColor"}},dropOff:{enabled:!0,fillOpacity:.2,strokeWidth:{$isUserOption:["./stroke",2,0]}},shadow:{enabled:!1,color:qV,xOffset:3,yOffset:3,blur:5},highlight:{unhighlightedItem:{opacity:.6}}},axes:{[nn.NUMBER]:{nice:!1,gridLine:{enabled:!1},crosshair:{enabled:!1},label:{enabled:!1}},[nn.CATEGORY]:{line:{enabled:!1}}}};import{_ModuleSupport as JV}from"ag-charts-community";import{ChartAxisDirection as ez}from"ag-charts-core";import{_ModuleSupport as ku}from"ag-charts-community";import{ChartAxisDirection as Du,SeriesZIndexMap as tv}from"ag-charts-core";import{_ModuleSupport as tz}from"ag-charts-community";import{SceneChangeDetection as ls,lineDistanceSquared as Bc}from"ag-charts-core";var{BBox:iz,Path:oz}=tz,iv=1e-6;function ov([e,t],[i,o]){return Math.abs(e-i)<=iv&&Math.abs(t-o)<=iv}var Qi=class extends oz{constructor(){super(...arguments),this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0}get midPoint(){const{x0:e,y0:t,x1:i,y1:o,x2:s,y2:a,x3:n,y3:r}=this;return{x:(e+i+s+n)/4,y:(t+o+a+r)/4}}distanceSquared(e,t){if(this.containsPoint(e,t))return 0;const{x0:i,y0:o,x1:s,y1:a,x2:n,y2:r,x3:l,y3:c}=this;return Math.min(Bc(e,t,i,o,s,a,1/0),Bc(e,t,s,a,n,r,1/0),Bc(e,t,n,r,l,c,1/0),Bc(e,t,l,c,i,o,1/0))}computeBBox(){const{x0:e,y0:t,x1:i,y1:o,x2:s,y2:a,x3:n,y3:r}=this,l=Math.min(e,i,s,n),c=Math.max(e,i,s,n)-l,h=Math.min(t,o,a,r),d=Math.max(t,o,a,r)-h;return new iz(l,h,c,d)}updatePath(){const{path:e,x0:t,y0:i,x1:o,y1:s,x2:a,y2:n,x3:r,y3:l}=this,c=[[t,i],[o,s],[a,n],[r,l]];e.clear();let h,d;for(const u of c){if(h!=null&&ov(h,u)||d!=null&&ov(d,u))continue;const[g,m]=u;h==null?e.moveTo(g,m):e.lineTo(g,m),h??(h=u),d=u}e.closePath()}};p([ls()],Qi.prototype,"x0",2),p([ls()],Qi.prototype,"y0",2),p([ls()],Qi.prototype,"x1",2),p([ls()],Qi.prototype,"y1",2),p([ls()],Qi.prototype,"x2",2),p([ls()],Qi.prototype,"y2",2),p([ls()],Qi.prototype,"x3",2),p([ls()],Qi.prototype,"y3",2);import{_ModuleSupport as sz}from"ag-charts-community";var{NODE_UPDATE_STATE_TO_PHASE_MAPPING:az}=sz;function sv(e,t,i,o){const{x0:s,y0:a,x1:n,y1:r,x2:l,y2:c,x3:h,y3:d,opacity:u}=e;return i?{x0:(s+h)/2,y0:(a+d)/2,x1:(n+l)/2,y1:(r+c)/2,x2:(n+l)/2,y2:(r+c)/2,x3:(s+h)/2,y3:(a+d)/2,opacity:u}:{x0:(s+n)/2,y0:(a+r)/2,x1:(s+n)/2,y1:(a+r)/2,x2:(l+h)/2,y2:(c+d)/2,x3:(l+h)/2,y3:(c+d)/2,opacity:u}}function nz(e,t){const i=a=>a==null;return{fromFn:(a,n,r)=>{r==="updated"&&i(n)?r="removed":r==="updated"&&i(a.previousDatum)&&(r="added");let l;r==="added"&&a.previousDatum==null&&t==="fade"?l={...cr(a,n),opacity:0}:r==="unknown"||r==="added"?l=sv(n,a.previousDatum,e,t):l={x0:a.x0,y0:a.y0,x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2,x3:a.x3,y3:a.y3,opacity:a.opacity};const c=az[r];return{...l,phase:c}},toFn:(a,n,r)=>{let l;return r==="removed"&&a.datum==null&&t==="fade"?l={...cr(a,n),opacity:0}:r==="removed"||i(n)?l=sv(n,a.previousDatum,e,t):l=cr(a,n),l}}}function cr(e,t){const{x0:i,y0:o,x1:s,y1:a,x2:n,y2:r,x3:l,y3:c,opacity:h}=t;return{x0:i,y0:o,x1:s,y1:a,x2:n,y2:r,x3:l,y3:c,opacity:h}}var{SeriesNodePickMode:av,valueProperty:rz,keyProperty:lz,updateLabelNode:cz,SMALLEST_KEY_INTERVAL:hz,LARGEST_KEY_INTERVAL:dz,diff:pz,fixNumericExtent:uz,seriesLabelFadeInAnimation:nv,resetMotion:gz,resetLabelFn:mz,animationValidation:yz,computeBarFocusBounds:fz,ContinuousScale:xz,Group:Sz,Selection:bz,PointerEvents:rv,motion:vz,checkCrisp:kz,createDatumId:Dz}=ku,Az=class extends ku.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.xKey=o.properties.stageKey,this.yKey=o.properties.valueKey}},lv=class extends ku.AbstractBarSeries{constructor({moduleCtx:e,animationResetFns:t}){super({moduleCtx:e,pickModes:[av.AXIS_ALIGNED,av.EXACT_SHAPE_MATCH],propertyKeys:{x:["stageKey"],y:["valueKey"]},propertyNames:{x:[],y:[]},categoryKey:"xValue",datumSelectionGarbageCollection:!1,animationResetFns:{datum:t.datum,label:mz}}),this.NodeEvent=Az,this.connectorNodeGroup=this.contentGroup.appendChild(new Sz({name:`${this.id}-series-connectorNodes`,zIndex:tv.BACKGROUND})),this.connectorSelection=bz.select(this.connectorNodeGroup,()=>this.connectionFactory()),this.connectorNodeGroup.pointerEvents=rv.None}get pickModeAxis(){return"main-category"}setZIndex(e){return super.setZIndex(e),this.connectorNodeGroup.zIndex=[tv.BACKGROUND,e],!0}isVertical(){return!super.isVertical()}connectionFactory(){return new Qi}getKeyAxis(e){if(e===Du.X)return this.properties.xKeyAxis;if(e===Du.Y)return this.properties.yKeyAxis}async processData(e){const{stageKey:t,valueKey:i}=this.properties,{visible:o,id:s}=this,a=(m,y,S)=>o&&this.ctx.legendManager.getItemEnabled({seriesId:s,itemId:S}),n=this.getCategoryAxis()?.scale,r=this.getValueAxis()?.scale,{isContinuousX:l,xScaleType:c,yScaleType:h}=this.getScaleInformation({xScale:n,yScale:r}),d=[];this.needsDataModelDiff()&&this.processedData&&d.push(pz(this.id,this.processedData)),this.ctx.animationManager.isSkipped()||d.push(yz());const u=this.visible?{}:{forceValue:0},{processedData:g}=await this.requestDataModel(e,this.data,{props:[lz(t,c,{id:"xValue"}),rz(i,h,{id:"yValue",...u,validation:a,invalidValue:0}),...l?[hz,dz]:[],...d],groupByKeys:!1});this.smallestDataInterval=g.reduced?.smallestKeyInterval,this.largestDataInterval=g.reduced?.largestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(e){const{processedData:t,dataModel:i,id:o,ctx:{legendManager:s}}=this;if(!t||!i)return{domain:[]};const{keys:[a]}=t.domain;if(e===this.getCategoryDirection()){const n=i.resolveProcessedDataDefById(this,"xValue");if(n?.def.type==="key"&&n?.def.valueType==="category"){if(!this.hasData)return{domain:[]};const r=a.filter((c,h)=>s.getItemEnabled({seriesId:o,itemId:h})),l=i.getKeySortMetadata(this,"xValue",t);return{domain:r,sortMetadata:l}}return{domain:this.padBandExtent(a)}}else{const n=this.domainForClippedRange(e,["yValue"],"xValue"),r=Math.max(...n),l=[-r,r];return{domain:uz(l)}}}getSeriesRange(e,t){return[Number.NaN,Number.NaN]}createNodeData(){const{hasData:e,data:t,dataModel:i,groupScale:o,processedData:s,id:a,ctx:{legendManager:n}}=this,r=this.getCategoryAxis(),l=this.getValueAxis();if(!(e&&t&&r&&l&&i&&s?.type==="ungrouped"))return;const c=r.scale,h=l.scale,d=this.getBarDirection()===Du.X,{stageKey:u,valueKey:g}=this.properties,m=`${g}`,y={itemId:m,nodeData:[],labelData:[],connectorData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible},S=this.visible;if(!S)return y;const x=i.resolveKeysById(this,"xValue",s),b=i.resolveColumnById(this,"yValue",s),{barWidth:f,groupIndex:v}=this.updateGroupScale(r),k=xz.is(c)?f*-.5:0,A=kz(r?.scale,r?.visibleRange,this.smallestDataInterval,this.largestDataInterval);let M;const I=s.dataSources.get(this.id)?.data??[];for(const[D,L]of I.entries()){const N=S&&n.getItemEnabled({seriesId:a,itemId:D}),T=x[D];if(T==null)continue;const O=Math.round(c.convert(T))+o.convert(String(v))+k,R=b[D],w=Math.round(h.convert(-R)),E=Math.round(h.convert(R)),B=this.getItemStyle({datum:L,datumIndex:D},!1),P=Math.max(B.strokeWidth??0,Math.abs(E-w)),C={x:d?Math.min(E,w):O,y:d?O:Math.min(E,w),width:d?P:f,height:d?f:P},_={x:C.x+C.width/2,y:C.y+C.height/2},V=this.createLabelData({datumIndex:D,rect:C,barAlongX:d,yDatum:R,datum:L,visible:N}),z={index:D,series:this,itemId:m,datum:L,datumIndex:D,xValue:T,yValue:R,xKey:u,yKey:g,x:C.x,y:C.y,width:C.width,height:C.height,midPoint:_,crisp:A,label:V,visible:N};if(y.nodeData.push(z),V!=null&&y.labelData.push(V),M!=null){const F=M.rect,G=M.nodeDatum,Y=M.datumIndex;d?y.connectorData.push({datum:G,datumIndex:Y,x0:F.x,y0:F.y+F.height,x1:F.x+F.width,y1:F.y+F.height,x2:C.x+C.width,y2:C.y,x3:C.x,y3:C.y,opacity:1}):y.connectorData.push({datum:G,datumIndex:Y,x0:F.x+F.width,y0:F.y,x1:C.x,y1:C.y,x2:C.x,y2:C.y+C.height,x3:F.x+F.width,y3:F.y+F.height,opacity:1})}N&&(M={itemId:m,rect:C,nodeDatum:z,datumIndex:D})}return y}updateNodes(e,t){super.updateNodes(e,t);const{connectorSelection:i}=this,o=this.contextNodeData?.connectorData??[];this.connectorSelection=this.updateConnectorSelection({connectorSelection:i,connectorData:o}),this.updateConnectorNodes({connectorSelection:i})}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e,o=t??[];return i.update(o,void 0,s=>this.getDatumId(s))}updateConnectorSelection(e){const{connectorData:t,connectorSelection:i}=e;return i.update(this.connectorEnabled()?t:[],void 0,o=>this.getDatumId(o.datum))}updateConnectorNodes(e){const t=this.getShapeFillBBox();e.connectorSelection.each((i,o)=>{const{fill:s,fillOpacity:a,stroke:n,strokeOpacity:r,strokeWidth:l,lineDash:c,lineDashOffset:h}=this.connectorStyle(o.datumIndex);i.setProperties(cr(i,o)),i.setStyleProperties({fill:s,stroke:n,fillOpacity:a,strokeOpacity:r,strokeWidth:l,lineDash:c,lineDashOffset:h},t)})}updateLabelSelection(e){const t=this.properties.label.enabled?e.labelData:[];return e.labelSelection.update(t,i=>{i.pointerEvents=rv.None})}updateLabelNodes(e){const t={stageKey:this.properties.stageKey,valueKey:this.properties.valueKey},i=this.ctx.highlightManager?.getActiveHighlight(),{isHighlight:o=!1,labelSelection:s}=e;s.each((a,n)=>{const r=this.getHighlightStyle(o,n.datumIndex);a.visible=n.visible||o,a.fillOpacity=r.opacity??1,a.opacity=r.opacity??1,cz(this,a,t,this.properties.label,n,o,i)})}getHighlightLabelData(e,t){if(t.label)return[{...t.label}]}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,properties:s}=this,{stageKey:a,valueKey:n,tooltip:r,legendItemName:l}=s,c=this.getCategoryAxis(),h=this.getValueAxis();if(!i||!o||!c||!h)return;const d=o.dataSources.get(this.id)?.data[e],u=i.resolveKeysById(this,"xValue",o)[e],g=i.resolveColumnById(this,"yValue",o)[e];if(u!=null)return this.formatTooltipWithContext(r,{symbol:this.legendItemSymbol(e),data:[{label:this.getAxisValueText(c,"tooltip",u,d,a,l),value:this.getAxisValueText(h,"tooltip",g,d,n,l)}]},{seriesId:t,datum:d,title:a,stageKey:a,valueKey:n,...this.tooltipStyle(d,e)})}resetAllAnimation(e){super.resetAllAnimation(e),gz([this.connectorSelection],cr)}animateEmptyUpdateReady({labelSelection:e}){const{connectorSelection:t}=this,i=this.isVertical(),s=nz(i,"normal");vz.fromToMotion(this.id,"connectors",this.ctx.animationManager,[t],s),nv(this,"labels",this.ctx.animationManager,e)}animateWaitingUpdateReady(e){const{labelSelection:t}=e;this.ctx.animationManager.stopByAnimationGroupId(this.id),nv(this,"labels",this.ctx.animationManager,t)}getDatumId(e){return Dz(e.xValue)}isLabelEnabled(){return this.properties.label.enabled}computeFocusBounds({datumIndex:e}){return fz(this,this.contextNodeData?.nodeData[e])}legendItemSymbol(e){const{strokeWidth:t,fillOpacity:i,strokeOpacity:o,lineDash:s,lineDashOffset:a,fill:n,stroke:r}=this.properties.getStyle(e);return{marker:{fill:n,fillOpacity:i,stroke:r,strokeWidth:t,strokeOpacity:o,lineDash:s,lineDashOffset:a}}}getLegendData(e){const{id:t,processedData:i,dataModel:o,ctx:{legendManager:s},visible:a}=this;if(!o||!i||e!=="category")return[];const{showInLegend:n}=this.properties,r=o.resolveKeysById(this,"xValue",i);return(i.dataSources.get(this.id)?.data??[]).map((l,c)=>{const h=r[c];if(h!=null)return{legendType:"category",id:t,datum:l,itemId:c,seriesId:t,enabled:a&&s.getItemEnabled({seriesId:t,itemId:c}),label:{text:String(h)},symbol:this.legendItemSymbol(c),skipAnimations:!0,hideInLegend:!n}}).filter(l=>l!=null)}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.label.itemStyler!=null}};import{_ModuleSupport as Mz}from"ag-charts-community";import{Property as Nt}from"ag-charts-core";var{Label:Iz,AbstractBarSeriesProperties:Lz,makeSeriesTooltip:Nz,AxisLabel:Cz}=Mz,Au=class extends Iz{constructor(){super(...arguments),this.spacing=0}};p([Nt],Au.prototype,"placement",2),p([Nt],Au.prototype,"spacing",2);var cv=class extends Cz{};p([Nt],cv.prototype,"placement",2);var oi=class extends Lz{constructor(){super(...arguments),this.fills=[],this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.label=new Au,this.stageLabel=new cv,this.tooltip=Nz()}getStyle(e){const{fills:t,strokes:i,fillOpacity:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=this;return{fill:t[e],fillOpacity:o,stroke:i[e],strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,opacity:1}}};p([Nt],oi.prototype,"stageKey",2),p([Nt],oi.prototype,"valueKey",2),p([Nt],oi.prototype,"fills",2),p([Nt],oi.prototype,"fillOpacity",2),p([Nt],oi.prototype,"strokes",2),p([Nt],oi.prototype,"strokeWidth",2),p([Nt],oi.prototype,"strokeOpacity",2),p([Nt],oi.prototype,"lineDash",2),p([Nt],oi.prototype,"lineDashOffset",2),p([Nt],oi.prototype,"label",2),p([Nt],oi.prototype,"stageLabel",2),p([Nt],oi.prototype,"tooltip",2);function hv(e,{x:t,y:i,width:o,height:s,opacity:a}){return{x1:t,y1:i,x2:t+o,y2:i+s,opacity:a??1}}var{Line:Tz}=JV,Mu=class extends lv{constructor(e){super({moduleCtx:e,animationResetFns:{datum:hv}}),this.properties=new oi}get hasData(){const{id:e,ctx:{legendManager:t}}=this,i=this.data?.data.reduce((o,s,a)=>o+(t.getItemEnabled({seriesId:e,itemId:a})?1:0),0);return i!=null&&i>1}getBandScalePadding(){return{inner:1,outer:0}}connectorEnabled(){return!0}getItemStyle({datumIndex:e},t){return this.properties.getStyle(e)}connectorStyle(e){return this.properties.getStyle(e)}nodeFactory(){return new Tz}createLabelData({datumIndex:e,rect:t,barAlongX:i,yDatum:o,datum:s,visible:a}){const{stageKey:n,valueKey:r,label:l}=this.properties,{spacing:c,placement:h}=l;if(!l.enabled)return;let d,u,g,m;if(i)switch(d=t.x+t.width/2,g="center",h){case"before":u=t.y-c,m="bottom";break;case"after":u=t.y+t.height+c,m="top";break;default:u=t.y+t.height/2,m="middle"}else switch(u=t.y+t.height/2,m="middle",h){case"before":d=t.x-c,g="right";break;case"after":d=t.x+t.width+c,g="left";break;default:d=t.x+t.width/2,g="center"}const y=this.getSeriesDomain(ez.Y).domain,S=this.getLabelText(o,s,r,"y",y,l,{itemId:r,value:o,datum:s,stageKey:n,valueKey:r});return{x:d,y:u,textAlign:g,textBaseline:m,text:S,itemId:r,datum:s,datumIndex:e,series:this,visible:a}}updateDatumNodes(e){const t=this.getHighlightStyle(e.isHighlight);e.datumSelection.each((i,o)=>{i.setProperties(hv(i,o)),i.stroke=t?.stroke,i.strokeWidth=t?.strokeWidth??0,i.strokeOpacity=t?.strokeOpacity??1,i.lineDash=t?.lineDash,i.lineDashOffset=t?.lineDashOffset??0,i.opacity=t?.opacity??1})}tooltipStyle(e,t){const{fill:i,stroke:o,fillOpacity:s,strokeOpacity:a,strokeWidth:n,lineDash:r,lineDashOffset:l}=this.properties.getStyle(t);return{fill:i,fillOpacity:s,stroke:o,strokeOpacity:a,strokeWidth:n,lineDash:r,lineDashOffset:l}}hasItemStylers(){return this.properties.label.itemStyler!=null}};Mu.className="ConeFunnelSeries",Mu.type="cone-funnel";import{_ModuleSupport as wz}from"ag-charts-community";import{commonSeriesOptionsDefs as Pz,constant as Oz,required as Iu,string as dv,without as Rz}from"ag-charts-core";var{coneFunnelSeriesThemeableOptionsDef:Ez}=wz,_z={...Rz(Pz,["showInLegend"]),...Ez,type:Iu(Oz("cone-funnel")),stageKey:Iu(dv),valueKey:Iu(dv)};import{_ModuleSupport as cn}from"ag-charts-community";import{CARTESIAN_AXIS_TYPE as pv}from"ag-charts-core";var Bz={series:{direction:"vertical",fills:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"secondSequentialColors"},cn.SAFE_RANGE2_OPERATION]},{$applySwitch:[{$path:["/type",void 0,{$value:"$1"}]},{$value:"$1"},["gradient",cn.FILL_GRADIENT_LINEAR_SINGLE_DEFAULTS],["pattern",cn.FILL_PATTERN_SINGLE_DEFAULTS],["image",cn.FILL_IMAGE_DEFAULTS]]}]},strokes:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"secondSequentialColors"},cn.SAFE_RANGE2_OPERATION]}]},strokeWidth:{$isUserOption:["./strokes/0",2,0]},label:{...cn.LABEL_BOXING_DEFAULTS,enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},placement:"before",spacing:4},tooltip:{range:{$path:["/tooltip/range","nearest"]}},highlight:{highlightedItem:{stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2}}},seriesArea:{padding:{top:20,bottom:20}},axes:{[pv.NUMBER]:{nice:!1,gridLine:{enabled:!1},crosshair:{enabled:!1},label:{enabled:!1}},[pv.CATEGORY]:{line:{enabled:!1}}}},uv={type:"series",name:"cone-funnel",chartType:"cartesian",enterprise:!0,solo:!0,version:ZV,dependencies:[XV],options:_z,defaultAxes:ev,themeTemplate:Bz,create:e=>new Mu(e)};import{CartesianChartModule as Vz,VERSION as zz}from"ag-charts-community";import{_ModuleSupport as Fz}from"ag-charts-community";import{ChartAxisDirection as gv,mergeDefaults as Lu}from"ag-charts-core";import{_ModuleSupport as Hz}from"ag-charts-community";import{BaseProperties as Wz,Property as ge}from"ag-charts-core";var{Label:Kz,DropShadow:Gz,AbstractBarSeriesProperties:$z,makeSeriesTooltip:Yz,AxisLabel:Uz}=Hz,jz=class extends Kz{},mv=class extends Uz{};p([ge],mv.prototype,"placement",2);var Mo=class extends Wz{constructor(){super(...arguments),this.enabled=!0,this.fill=void 0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}getStyle(){const{fill:e,stroke:t,fillOpacity:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}=this;return{fill:e,fillOpacity:i,stroke:t,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,opacity:1}}};p([ge],Mo.prototype,"enabled",2),p([ge],Mo.prototype,"fill",2),p([ge],Mo.prototype,"fillOpacity",2),p([ge],Mo.prototype,"stroke",2),p([ge],Mo.prototype,"strokeWidth",2),p([ge],Mo.prototype,"strokeOpacity",2),p([ge],Mo.prototype,"lineDash",2),p([ge],Mo.prototype,"lineDashOffset",2);var pt=class extends $z{constructor(){super(...arguments),this.fills=[],this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.spacingRatio=0,this.dropOff=new Mo,this.shadow=new Gz().set({enabled:!1}),this.label=new jz,this.stageLabel=new mv,this.tooltip=Yz()}getStyle(e){const{fills:t,strokes:i,fillOpacity:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=this;return{fill:t[e],fillOpacity:o,stroke:i[e],strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,opacity:1}}};p([ge],pt.prototype,"stageKey",2),p([ge],pt.prototype,"valueKey",2),p([ge],pt.prototype,"fills",2),p([ge],pt.prototype,"fillOpacity",2),p([ge],pt.prototype,"strokes",2),p([ge],pt.prototype,"strokeWidth",2),p([ge],pt.prototype,"strokeOpacity",2),p([ge],pt.prototype,"lineDash",2),p([ge],pt.prototype,"lineDashOffset",2),p([ge],pt.prototype,"spacingRatio",2),p([ge],pt.prototype,"itemStyler",2),p([ge],pt.prototype,"dropOff",2),p([ge],pt.prototype,"shadow",2),p([ge],pt.prototype,"label",2),p([ge],pt.prototype,"stageLabel",2),p([ge],pt.prototype,"tooltip",2);var{resetBarSelectionsFn:Xz,prepareBarAnimationFunctions:yv,midpointStartingBarPosition:fv,createDatumId:Zz,Rect:qz,motion:xv}=Fz,Nu=class extends lv{constructor(e){super({moduleCtx:e,animationResetFns:{datum:Xz}}),this.properties=new pt}getBandScalePadding(){return{inner:this.properties.spacingRatio,outer:0}}connectorEnabled(){return this.properties.dropOff.enabled}connectorStyle(e){return Lu(this.properties.dropOff.getStyle(),this.properties.getStyle(e))}nodeFactory(){return new qz}createLabelData({datumIndex:e,rect:t,yDatum:i,datum:o,visible:s}){const{valueKey:a,stageKey:n,label:r}=this.properties;if(!r.enabled)return;const l=this.getSeriesDomain(gv.Y).domain,c=this.getLabelText(i,o,a,"y",l,r,{itemId:a,value:i,datum:o,stageKey:n,valueKey:a});return{x:t.x+t.width/2,y:t.y+t.height/2,textAlign:"center",textBaseline:"middle",text:c,itemId:n,datum:o,datumIndex:e,series:this,visible:s}}getItemStyle({datum:e,datumIndex:t},i){const{id:o,properties:s}=this,{stageKey:a,valueKey:n,itemStyler:r}=s,l=this.getHighlightStyle(i,t);let h=Lu(l,s.getStyle(t));if(r!=null){const d=this.ctx.highlightManager?.getActiveHighlight(),u=this.cachedDatumCallback(Zz(t,i?"highlight":"node"),()=>{const g=this.getHighlightStateString(d,i,t);return this.callWithContext(r,{seriesId:o,datum:e,highlightState:g,stageKey:a,valueKey:n,...h})});u&&(h=Lu(u,h))}return h}updateDatumNodes({datumSelection:e,isHighlight:t}){const{contextNodeData:i}=this;if(!i)return;const{shadow:o}=this.properties,s=this.getCategoryDirection()===gv.X,a=this.getShapeFillBBox();e.each((n,r)=>{const l=this.getItemStyle(r,t);n.setStyleProperties(l,a),n.visible=s?r.width>0:r.height>0,n.crisp=r.crisp,n.fillShadow=o})}tooltipStyle(e,t){return this.getItemStyle({datum:e,datumIndex:t},!1)}animateEmptyUpdateReady(e){super.animateEmptyUpdateReady(e);const{datumSelection:t}=e,i=this.isVertical(),s=yv(fv(i,"normal"),"unknown");xv.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],s)}animateWaitingUpdateReady(e){super.animateWaitingUpdateReady(e);const{datumSelection:t}=e,{processedData:i}=this,o=i?.reduced?.diff?.[this.id],s=yv(fv(this.isVertical(),"fade"),"added");xv.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],s,(a,n)=>n.xValue,o)}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.label.itemStyler!=null}};Nu.className="FunnelSeries",Nu.type="funnel";import{_ModuleSupport as Qz}from"ag-charts-community";import{commonSeriesOptionsDefs as Jz,constant as eF,required as Cu,string as Sv,without as tF}from"ag-charts-core";var{funnelSeriesThemeableOptionsDef:iF}=Qz,oF={...iF,...tF(Jz,["showInLegend"]),type:Cu(eF("funnel")),stageKey:Cu(Sv),valueKey:Cu(Sv)},bv={type:"series",name:"funnel",chartType:"cartesian",enterprise:!0,solo:!0,version:zz,dependencies:[Vz],options:oF,defaultAxes:ev,themeTemplate:QV,create:e=>new Nu(e)};import{VERSION as sF,_ModuleSupport as Tu}from"ag-charts-community";import{FONT_SIZE as aF,linearGaugeSeriesOptionsDef as nF}from"ag-charts-core";import{VERSION as rF}from"ag-charts-community";import{commonChartOptionsDefs as lF,defined as Ct,linearGaugeSeriesOptionsDef as cF,positiveNumber as hF,radialGaugeSeriesOptionsDef as dF,tooltipOptionsDefs as pF,typeUnion as uF,undocumented as gF,without as vv}from"ag-charts-core";import{mergeArrayDefaults as kv,mergeDefaults as mF}from"ag-charts-core";function Dv(e){const{enabled:t,mode:i,showArrow:o,range:s,position:a,pagination:n,delay:r,wrapping:l,interaction:c,renderer:h,...d}=e,u={enabled:t,showArrow:o,range:s,position:a,interaction:c,renderer:h,...d};return{chartTooltipOptions:{mode:i,pagination:n,delay:r,wrapping:l,...d},seriesTooltipOptions:u}}function yF(e){const{animation:t,background:i,container:o,contextMenu:s,context:a,footnote:n,height:r,listeners:l,locale:c,minHeight:h,minWidth:d,overrideDevicePixelRatio:u,padding:g,subtitle:m,theme:y,title:S,width:x,type:b,cursor:f,nodeClickRange:v,tooltip:k,value:A,scale:M={},startAngle:I,endAngle:D,highlight:L,segmentation:N,bar:T,needle:O,targets:R,outerRadius:w,innerRadius:E,outerRadiusRatio:B,innerRadiusRatio:P,cornerRadius:C,cornerMode:_,label:V,secondaryLabel:z,spacing:F,...G}=e,Y=k!=null,K=k??{},{chartTooltipOptions:U,seriesTooltipOptions:ee}=Dv(K),re={...G,type:b,cursor:f,context:a,nodeClickRange:v,value:A,scale:M,startAngle:I,endAngle:D,highlight:L,segmentation:N,bar:T,targets:R,outerRadius:w,innerRadius:E,outerRadiusRatio:B,innerRadiusRatio:P,cornerRadius:C,cornerMode:_,label:V,secondaryLabel:z,spacing:F};return Y&&(re.tooltip=ee),O!=null&&(re.needle={enabled:!0,...O}),{animation:t,background:i,container:o,contextMenu:s,context:a,footnote:n,height:r,listeners:l,locale:c,minHeight:h,minWidth:d,overrideDevicePixelRatio:u,padding:g,subtitle:m,theme:y,title:S,width:x,...Y?{tooltip:U}:{},series:[re]}}function fF(e){const{animation:t,background:i,container:o,contextMenu:s,context:a,footnote:n,height:r,listeners:l,locale:c,minHeight:h,minWidth:d,overrideDevicePixelRatio:u,padding:g,subtitle:m,theme:y,title:S,width:x,type:b,cursor:f,nodeClickRange:v,tooltip:k,value:A,scale:M={},direction:I="vertical",thickness:D,highlight:L,segmentation:N,bar:T,targets:O,cornerRadius:R,cornerMode:w,label:E,...B}=e,P=k!=null,C=k??{},{chartTooltipOptions:_,seriesTooltipOptions:V}=Dv(C),z={...B,type:b,cursor:f,nodeClickRange:v,value:A,scale:M,direction:I,thickness:D,highlight:L,segmentation:N,bar:T,targets:O,cornerRadius:R,cornerMode:w,label:E};return P&&(z.tooltip=V),{animation:t,background:i,container:o,contextMenu:s,context:a,footnote:n,height:r,listeners:l,locale:c,minHeight:h,minWidth:d,overrideDevicePixelRatio:u,padding:g,subtitle:m,theme:y,title:S,width:x,...P?{tooltip:_}:{},series:[z]}}function Av(e,t){if(t==null)return e;const{targets:i,...o}=t;return e=mF(e,o),e.targets!=null&&i!=null&&(e.type==="radial-gauge"?e.targets=kv(e.targets,i):e.targets=kv(e.targets,i)),e}function xF(e,t){switch(e.type){case"radial-gauge":return yF(Av(e,t));case"linear-gauge":return fF(Av(e,t));default:return{series:[]}}}var wu={theme:Ct,container:Ct,animation:Ct,background:Ct,contextMenu:Ct,context:()=>!0,listeners:Ct,locale:Ct,width:Ct,height:Ct,minWidth:Ct,minHeight:Ct,title:Ct,subtitle:Ct,footnote:Ct,padding:Ct,tooltip:{...pF,...lF.tooltip}};wu.overrideDevicePixelRatio=gF(hF);var Mv={type:"preset",name:"gauge-preset",enterprise:!0,version:rF,dependencies:[an],options:uF({"linear-gauge":{...vv(cF,["type"]),...wu},"radial-gauge":{...vv(dF,["type"]),...wu}},"gauge options"),create:xF};import{_ModuleSupport as hn}from"ag-charts-community";import{StateMachine as SF,cachedTextMeasurer as Iv,easeOut as bF,findRangeExtent as vF,isArray as kF,measureTextSegments as DF,mergeDefaults as AF,tickFormat as MF,toRadians as Lv,toTextString as IF}from"ag-charts-core";var Nv=class{*[Symbol.iterator](){const{node:e,datum:t}=this;e&&t&&(yield{node:e,datum:t})}nodes(){return this.node?[this.node]:[]}update(e,t,i,o){const s=e.nodes();if(s.length===0)this.node?.remove(),this.node=void 0;else{this.node===void 0&&(this.node=new i,this.node.fillOpacity=0,this.node.strokeOpacity=0,t.appendChild(this.node));const a=s[0],n=s.toReversed().find(r=>r.datum.datum.value>r.datum.datum.segmentStart)??s.at(-1);this.node.datum=this.datum=a.datum,o(this.node,a,n)}}};import{isArray as LF}from"ag-charts-core";var Cv={fromFn:()=>({opacity:0,phase:"initial"}),toFn:()=>({opacity:1})};function Tv(e,t){if(e==null)return"";const{min:i,max:o}=t,s=i===0?0:Math.ceil(Math.log10(Math.abs(i))),a=o===0?0:Math.ceil(Math.log10(Math.abs(o))),n=Math.max(2-Math.max(s,a),0);return e.toFixed(n)}function hr(e,t,i,o){if(i.text!=null)return i.text;const s=o??i.value;let a;return i?.formatter!=null&&(a=nr(t,i.formatter,{seriesId:e,datum:void 0,value:s})),a==null||LF(a)?a:String(a)}function wv({path:e,x:t,y:i,size:o}){e.moveTo(t,i-o/2),e.lineTo(t,i+o/2)}import{clamp as Pv,iterate as NF}from"ag-charts-core";function Ov(e,t){const i=NF(e.datumUnion.nodes(),e.targetSelection.nodes());return e.pickNodeNearestDistantObject(t,i)}function Rv(e,t){const i=[{data:e.contextNodeData?.nodeData,selection:e.datumUnion},{data:e.contextNodeData?.targetData,selection:e.targetSelection}].filter(l=>l.data&&l.data.length>0),o=Pv(0,t.otherIndex+t.otherIndexDelta,i.length-1);if(i.length===0)return;const{data:s,selection:a}=i[o];if(s==null||s.length===0)return;const n=Pv(0,t.datumIndex,s.length-1),r=s[n];for(const l of a)if(l.datum===r)return{bounds:l.node,clipFocusBox:!0,datum:r,datumIndex:n,otherIndex:o}}import{_ModuleSupport as Pu}from"ag-charts-community";import{BaseProperties as Vc,PropertiesArray as Ou,Property as W}from"ag-charts-core";import{BaseProperties as Ev,Logger as CF,Property as dn}from"ag-charts-core";var zc=class extends Ev{getSegments(e,t){const{values:i,step:o,count:s}=this,a=Math.min(...e.domain),n=Math.max(...e.domain);let r;if(i!=null){const l=i.filter(c=>c>a&&c<n).sort((c,h)=>c-h);r=[a,...l,n]}else if(o!=null){const l=[];for(let c=a;c<n;c+=o)l.push(c);l.push(n),r=l}else if(s==null){const l=e.ticks({nice:[!0,!0],interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0})?.ticks?.filter(c=>c>a&&c<n);r=l==null?void 0:[a,...l,n]}else{const l=s+1;r=Array.from({length:l+1},(c,h)=>h/l*(n-a)+a)}return r!=null&&r.length>t&&(CF.warnOnce("the configured segmentation results in more than 1 item per pixel, ignoring. Supply a segmentation configuration that results in larger segments or omit this configuration"),r=void 0),r??(r=[a,n]),r}};p([dn],zc.prototype,"values",2),p([dn],zc.prototype,"step",2),p([dn],zc.prototype,"count",2);var dr=class extends Ev{constructor(){super(...arguments),this.enabled=!1,this.interval=new zc,this.spacing=0}};p([dn],dr.prototype,"enabled",2),p([dn],dr.prototype,"interval",2),p([dn],dr.prototype,"spacing",2);var{makeSeriesTooltip:TF,SeriesProperties:wF,Label:PF,AxisLabel:OF,getColorStops:RF}=Pu,_v=class extends PF{};p([W],_v.prototype,"spacing",2);var ut=class extends Vc{constructor(){super(...arguments),this.value=0,this.label=new _v}getStyle(e){const{fill:t=e.fill??"black",fillOpacity:i=e.fillOpacity??1,stroke:o=e.stroke??"black",strokeWidth:s=e.strokeWidth??0,strokeOpacity:a=e.strokeOpacity??1,lineDash:n=e.lineDash??[0],lineDashOffset:r=e.lineDashOffset??0}=this;return{fill:t,fillOpacity:i,stroke:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}}};p([W],ut.prototype,"text",2),p([W],ut.prototype,"value",2),p([W],ut.prototype,"shape",2),p([W],ut.prototype,"placement",2),p([W],ut.prototype,"spacing",2),p([W],ut.prototype,"size",2),p([W],ut.prototype,"rotation",2),p([W],ut.prototype,"fill",2),p([W],ut.prototype,"fillOpacity",2),p([W],ut.prototype,"stroke",2),p([W],ut.prototype,"strokeWidth",2),p([W],ut.prototype,"strokeOpacity",2),p([W],ut.prototype,"lineDash",2),p([W],ut.prototype,"lineDashOffset",2),p([W],ut.prototype,"label",2);var si=class extends Vc{constructor(){super(...arguments),this.enabled=!0,this.thicknessRatio=1,this.fills=new Ou(Pu.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}getStyle(e,t,i){const{fill:o,fills:s,fillMode:a,fillOpacity:n,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}=this;return{fill:o??Vv(s,a,e,i,t),fillOpacity:n,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}}};p([W],si.prototype,"enabled",2),p([W],si.prototype,"thickness",2),p([W],si.prototype,"thicknessRatio",2),p([W],si.prototype,"fills",2),p([W],si.prototype,"fillMode",2),p([W],si.prototype,"fill",2),p([W],si.prototype,"fillOpacity",2),p([W],si.prototype,"stroke",2),p([W],si.prototype,"strokeWidth",2),p([W],si.prototype,"strokeOpacity",2),p([W],si.prototype,"lineDash",2),p([W],si.prototype,"lineDashOffset",2);var pr=class extends Vc{constructor(){super(...arguments),this.values=void 0,this.step=void 0,this.minSpacing=0,this.maxSpacing=1e3}};p([W],pr.prototype,"values",2),p([W],pr.prototype,"step",2),p([W],pr.prototype,"minSpacing",2),p([W],pr.prototype,"maxSpacing",2);var Bv=class extends OF{constructor(){super(...arguments),this.placement=void 0}};p([W],Bv.prototype,"placement",2);var Dt=class extends Vc{constructor(){super(...arguments),this.min=0,this.max=1,this.fills=new Ou(Pu.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.defaultFill="black",this.interval=new pr,this.label=new Bv}getStyle(e,t,i,o){const{fill:s,fills:a,defaultFill:n,fillMode:r,fillOpacity:l,stroke:c,strokeWidth:h,strokeOpacity:d,lineDash:u,lineDashOffset:g}=this;return{fill:s??(e&&a.length===0?n:void 0)??Vv(a,r,t,o,i),fillOpacity:l,stroke:c,strokeWidth:h,strokeOpacity:d,lineDash:u,lineDashOffset:g}}};p([W],Dt.prototype,"min",2),p([W],Dt.prototype,"max",2),p([W],Dt.prototype,"fills",2),p([W],Dt.prototype,"fillMode",2),p([W],Dt.prototype,"fill",2),p([W],Dt.prototype,"fillOpacity",2),p([W],Dt.prototype,"stroke",2),p([W],Dt.prototype,"strokeWidth",2),p([W],Dt.prototype,"strokeOpacity",2),p([W],Dt.prototype,"lineDash",2),p([W],Dt.prototype,"lineDashOffset",2),p([W],Dt.prototype,"defaultFill",2),p([W],Dt.prototype,"interval",2),p([W],Dt.prototype,"label",2);var Fc=class extends Ka{constructor(){super(...arguments),this.placement="inside-center",this.avoidCollisions=!0}};p([W],Fc.prototype,"text",2),p([W],Fc.prototype,"placement",2),p([W],Fc.prototype,"avoidCollisions",2);var At=class extends wF{constructor(){super(...arguments),this.value=0,this.segmentation=new dr,this.defaultColorRange=[],this.targets=new Ou(ut),this.defaultTarget=new ut,this.defaultScale=new Dt,this.direction="vertical",this.thickness=1,this.cornerRadius=0,this.cornerMode="container",this.margin=0,this.scale=new Dt,this.bar=new si,this.label=new Fc,this.tooltip=TF()}};p([W],At.prototype,"value",2),p([W],At.prototype,"segmentation",2),p([W],At.prototype,"defaultColorRange",2),p([W],At.prototype,"targets",2),p([W],At.prototype,"defaultTarget",2),p([W],At.prototype,"defaultScale",2),p([W],At.prototype,"direction",2),p([W],At.prototype,"thickness",2),p([W],At.prototype,"cornerRadius",2),p([W],At.prototype,"cornerMode",2),p([W],At.prototype,"margin",2),p([W],At.prototype,"scale",2),p([W],At.prototype,"bar",2),p([W],At.prototype,"label",2),p([W],At.prototype,"tooltip",2);function Vv(e,t,i,o,s){return{type:"gradient",gradient:"linear",colorSpace:"oklch",colorStops:RF(e,i,o.domain,t),rotation:s?90:0,bounds:"series"}}import{_ModuleSupport as EF}from"ag-charts-community";import{cachedTextMeasurer as _F,isArray as BF,measureTextSegments as VF,toPlainText as zF,toTextString as FF}from"ag-charts-core";var{BBox:HF}=EF;function Ru(e){const{x0:t,y0:i,x1:o,y1:s,horizontalInset:a,verticalInset:n}=e,r=Math.min(t,o)+a,l=Math.min(i,s)+n,c=Math.max(Math.abs(o-t)-2*a,0),h=Math.max(Math.abs(s-i)-2*n,0);return{x:r,y:l,width:c,height:h}}function WF(e,t){if(t==null)return!0;const i=Ru(e),o=1e-6,s=i.x+o,a=i.y+o,n=i.x+i.width-o,r=i.y+i.height-o,l=t.x,c=t.x+t.width,h=t.y,d=t.y+t.height;return Math.max(s,l)<=Math.min(n,c)&&Math.max(a,h)<=Math.min(r,d)}function Eu(e){const{clipX0:t,clipX1:i,clipY0:o,clipY1:s}=e;return t!=null&&i!=null||o!=null&&s!=null}function KF(e){if(!Eu(e))return;const{x0:t,y0:i,x1:o,y1:s}=e,{x:a,y:n,width:r,height:l}=Ru(e);let{clipX0:c,clipX1:h,clipY0:d,clipY1:u}=e;(c==null||h==null)&&(c=t,h=o),(d==null||u==null)&&(d=i,u=s);const g=Math.min(c,h),m=Math.min(d,u),y=Math.abs(h-c),S=Math.abs(u-d);return c=Math.max(a,g),d=Math.max(n,m),h=Math.min(a+r,g+y),u=Math.min(n+l,m+S),new HF(Math.min(c,h),Math.min(d,u),Math.abs(h-c),Math.abs(u-d))}function zv(e,t){const i=e?"initial":"update";return{node:{fromFn(s,a){const n=s.previousDatum;let{x0:r,y0:l,x1:c,y1:h,clipX0:d,clipY0:u,clipX1:g,clipY1:m}=n??a;const{horizontalInset:y,verticalInset:S}=a,x=n!=null&&Eu(n),b=Eu(a);return x&&b||(!x&&b?({x0:r,y0:l,x1:c,y1:h,clipX0:d,clipY0:u,clipX1:g,clipY1:m}=a,e&&(t?g=a.clipX0:m=a.clipY0)):x&&!b?({x0:r,y0:l,x1:c,y1:h}=a,d=void 0,u=void 0,g=void 0,m=void 0):e&&(t?c=r:h=l)),{x0:r,y0:l,x1:c,y1:h,clipX0:d,clipY0:u,clipX1:g,clipY1:m,horizontalInset:y,verticalInset:S,phase:i}},toFn(s,a){const{x0:n,y0:r,x1:l,y1:c,clipX0:h,clipY0:d,clipX1:u,clipY1:g,horizontalInset:m,verticalInset:y}=a;return{x0:n,y0:r,x1:l,y1:c,clipX0:h,clipY0:d,clipX1:u,clipY1:g,horizontalInset:m,verticalInset:y}},applyFn(s,a){s.setProperties(ur(s,a))}}}}function ur(e,t){const{x:i,y:o,width:s,height:a}=Ru(t),n=KF(t),r=WF(t,n);return{x:i,y:o,width:s,height:a,clipBBox:n,visible:r}}var GF={Before:"right",Center:"center",After:"left"},$F={Before:"top",Center:"middle",After:"bottom"},YF={Before:-1,Center:-.5,After:0},UF={Before:0,Center:-.5,After:-1};function jF(e,t,i,o,s,a){const{seriesRect:n,gaugeRect:r,barRect:l}=s,{padding:c,horizontal:h}=o;i.each((d,u)=>{const g=hr(e.id,t,u,a?.label);let m,y;u.placement==="outside-start"?h?(m=r.x,y=n.height):(m=n.width,y=n.height-(r.y+r.height)):u.placement==="outside-end"?h?(m=n.width-(r.x+r.width),y=n.height):(m=n.width,y=r.y):u.avoidCollisions&&(m=r.width,y=r.height);let S;if(g==null)return;if(m!=null&&y!=null){const w=()=>({width:m,height:y,meta:null});S=Jn(zF(g),u,{padding:c},w)?.[0]}else{const w=_F(u),{width:E,height:B}=BF(g)?VF(g,u):w.measureLines(FF(g));S={text:g,fontSize:u.fontSize,lineHeight:u.lineHeight??w.lineHeight(),width:E,height:B}}if(S==null){d.visible=!1;return}const x=h?r.x:r.y+r.height,b=h?r.x+r.width:r.y,f=h?l.x:l.y+l.height,v=h?l.x+l.width:l.y,k=u.spacing*(h?1:-1);let A,M,I,D;switch(u.placement){case"outside-start":A=-1/0,M=1/0,I=x-k,D="Before";break;case"outside-end":A=-1/0,M=1/0,I=b+k,D="After";break;case"inside-start":A=x,M=v,I=x+k,D="After";break;case"inside-end":A=v,M=b,I=b-k,D="Before";break;case"inside-center":A=x,M=b,I=(x+b)/2,D="Center";break;case"bar-inside":A=f,M=v,I=(f+v)/2,D="Center";break;case"bar-inside-end":A=f,M=v,I=v-k,D="Before";break;case"bar-outside-end":A=v,M=b,I=v+k,D="After";break;case"bar-end":A=-1/0,M=1/0,I=v,D="Center";break}const L=h?I:r.x+r.width/2,N=h?r.y+r.height/2:I;let T,O;h?(T=L+YF[D]*S.width,O=T+S.width):(T=N+UF[D]*S.height,O=T+S.height);const R=Math.min(T,O)>=Math.min(A,M)&&Math.max(T,O)<=Math.max(A,M);if(u.avoidCollisions&&!R){d.visible=!1;return}d.visible=!0,d.text=S.text,d.fontSize=S.fontSize,d.lineHeight=S.lineHeight,d.textAlign=h?GF[D]:"center",d.textBaseline=h?"middle":$F[D],d.x=L,d.y=N})}var{fromToMotion:_u,resetMotion:XF,SeriesNodePickMode:Fv,createDatumId:Hv,BBox:Ji,Group:ta,PointerEvents:Wv,Selection:ia,Rect:ZF,Text:Kv,TransformableText:qF,Marker:QF,LinearScale:JF,generateTicks:eH,NiceMode:Gv}=hn,tH={before:180,middle:0,after:0},iH={before:90,middle:0,after:-90},Bu=class extends hn.Series{constructor(e){super({moduleCtx:e,pickModes:[Fv.EXACT_SHAPE_MATCH,Fv.NEAREST_NODE]}),this.properties=new At,this.seriesRect=Ji.NaN,this.gaugeRect=Ji.NaN,this.scale=new JF,this.originX=0,this.originY=0,this.scaleGroup=this.contentGroup.appendChild(new ta({name:"scaleGroup"})),this.itemGroup=this.contentGroup.appendChild(new ta({name:"itemGroup"})),this.itemTargetGroup=this.contentGroup.appendChild(new ta({name:"itemTargetGroup"})),this.itemTargetLabelGroup=this.contentGroup.appendChild(new ta({name:"itemTargetLabelGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new ta({name:"itemLabelGroup"})),this.highlightTargetGroup=this.highlightGroup.appendChild(new ta({name:"itemTargetLabelGroup"})),this.tickGroup=this.contentGroup.appendChild(new ta({name:"tickGroup"})),this.scaleSelection=ia.select(this.scaleGroup,()=>this.nodeFactory()),this.datumSelection=ia.select(this.itemGroup,()=>this.nodeFactory()),this.targetSelection=ia.select(this.itemTargetGroup,()=>this.markerFactory()),this.targetLabelSelection=ia.select(this.itemTargetLabelGroup,Kv),this.labelSelection=ia.select(this.itemLabelGroup,Kv),this.highlightTargetSelection=ia.select(this.highlightTargetGroup,()=>this.markerFactory()),this.tickSelection=ia.select(this.tickGroup,qF),this.datumUnion=new Nv,this.animationState=new SF("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.animateReadyResize(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateWaitingUpdateReady()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty"},reset:"empty",skip:"ready"}}),this.scaleGroup.pointerEvents=Wv.None,this.tickGroup.pointerEvents=Wv.None}get range(){return this.horizontal?[0,this.gaugeRect.width]:[0,this.gaugeRect.height]}get horizontal(){return this.properties.direction==="horizontal"}get hasData(){return!0}nodeFactory(){const e=new ZF;return e.crisp=!0,e}markerFactory(){return new QF}processData(){this.nodeDataRefresh=!0,this.animationState.transition("updateData")}formatLabel(e){return Tv(e,this.properties.scale)}getShapeFillBBox(){const{properties:e,originX:t,originY:i,horizontal:o,scale:s}=this,{thickness:a}=e,n=vF(s.range),r=new Ji(t,i,o?n:a,o?a:n);return{axis:r,series:r}}getTargets(){const{properties:e}=this,t=e.defaultTarget;return Array.from(e.targets).map(i=>{const{text:o=t.text,value:s=t.value??0,shape:a=t.shape??"triangle",rotation:n=t.rotation??0,placement:r=t.placement??"middle",spacing:l=t.spacing??0,size:c=t.size??0}=i,{enabled:h=t.label.enabled,color:d=t.label.color??"black",fontStyle:u=t.label.fontStyle??"normal",fontWeight:g=t.label.fontWeight??"normal",fontSize:m=t.label.fontSize,fontFamily:y=t.label.fontFamily,spacing:S=t.label.spacing??0}=i.label;return{text:o,value:s,shape:a,placement:r,spacing:l,size:c,rotation:n,label:{enabled:h,color:d,fontStyle:u,fontWeight:g,fontSize:m,fontFamily:y,spacing:S},style:i.getStyle(t)}})}getTargetPoint(e){const{properties:t,originX:i,originY:o,horizontal:s,scale:a,gaugeRect:n}=this,{thickness:r}=t,{value:l,placement:c,spacing:h,size:d}=e,u=a.convert(l);let g;switch(c){case"before":g=-(h+d/2);break;case"after":g=r+h+d/2;break;default:g=r/2;break}return{x:i+n.x+(s?u:g),y:o+n.y+(s?g:u)}}getTargetLabel(e){const{size:t,placement:i,label:o}=e,{spacing:s,color:a,fontStyle:n,fontWeight:r,fontSize:l,fontFamily:c}=o,h=void 0,d=t/2+s;let u,g,m=0,y=0;return this.horizontal?(u="center",i==="after"?(g="top",y=d):(g="bottom",y=-d)):(g="middle",i==="before"?(u="right",m=-d):(u="left",m=d)),{offsetX:m,offsetY:y,fill:a,textAlign:u,textBaseline:g,fontStyle:n,fontWeight:r,fontSize:l,fontFamily:c,lineHeight:h}}labelDatum(e,t){const{placement:i,avoidCollisions:o,spacing:s,text:a,color:n,fontSize:r,minimumFontSize:l,fontStyle:c,fontWeight:h,fontFamily:d,lineHeight:u,wrapping:g,overflowStrategy:m,formatter:y=S=>this.formatLabel(S.value)}=e;return{placement:i,avoidCollisions:o,spacing:s,text:a,value:t,fill:n,fontSize:r,minimumFontSize:l,fontStyle:c,fontWeight:h,fontFamily:d,lineHeight:u,wrapping:g,overflowStrategy:m,formatter:y}}verticalLabelInset(){const{label:e}=this.properties,t=Iv(e),i=e.text?.split(`
`),o=(e.lineHeight??t.lineHeight())*(i?.length??1);return e.spacing+o}horizontalLabelInset(){const{scale:e,properties:t}=this,{scale:i,label:o}=t,s=o.text?.split(`
`),a=Iv(o),n=i.interval.values??e.ticks({nice:[!1,!1],interval:i.interval.step,minTickCount:0,maxTickCount:6,tickCount:5})?.ticks??[],l=(s??n?.map(c=>hr(this.id,this.ctx,this.labelDatum(o,c))??"")).reduce((c,h)=>{const{width:d}=kF(h)?DF(h,o):a.measureLines(IF(h));return Math.max(c,d)},0);return o.spacing+l}tickFormatter(e,t){const{format:i,formatter:o}=this.properties.scale.label;let s;return i!=null&&(s=MF(t,typeof i=="string"?i:void 0)),(a,n)=>{let r;return o&&(r??(r=nr(this.ctx,o,{value:a,index:n,domain:e,boundSeries:void 0}))),r??(r=s?.(a)),r??this.formatLabel(a)}}createNodeData(){const{id:e,properties:t,horizontal:i,scale:o,seriesRect:s}=this,{value:a,segmentation:n,thickness:r,cornerRadius:l,cornerMode:c,bar:h,scale:d,label:u,defaultColorRange:g}=t;o.domain=[d.min,d.max],o.range=i?[0,s.width]:[s.height,0];let m,y;i?(y=1,m=Math.PI/2):d.label.placement==="before"?(y=1,m=0):(y=-1,m=0);let S,x,b,f;i?(S=0,x=s.width,b=(s.height-r)/2,f=b+r,u.placement==="outside-start"?S+=this.horizontalLabelInset():u.placement==="outside-end"&&(x-=this.horizontalLabelInset())):(S=(s.width-r)/2,x=S+r,f=0,b=s.height,u.placement==="outside-start"?b-=this.verticalLabelInset():u.placement==="outside-end"&&(f+=this.verticalLabelInset())),this.gaugeRect=new Ji(Math.min(S,x),Math.min(b,f),Math.abs(x-S),Math.abs(f-b));const v=0,k=0;o.domain=[d.min,d.max],o.range=i?[S,x]:[b,f];const{tickData:{ticks:A}}=eH({scale:o,label:this.properties.scale.label,interval:this.properties.scale.interval,tickFormatter:(le,ie)=>this.tickFormatter(le,ie),domain:o.domain,range:this.range,reverse:!1,primaryTickCount:void 0,defaultTickMinSpacing:0,visibleRange:[0,1],niceMode:[Gv.Off,Gv.Off],labelOffset:0,axisRotation:m,sideFlag:y}),M=!1,I=this.getTargets(),D=[],L=[],N=[],T=[],[O,R]=o.range,w=Math.abs(R-O),E=i?o.convert(a):x,B=i?f:o.convert(a),P=n.enabled?n.spacing/2:0,C=i?P:0,_=i?0:P,V=Math.min(h.thickness??Math.round(h.thicknessRatio*r),r),z=-(r-V)/2,F=i?0:z,G=i?z:0,Y=c==="item",K=Math.ceil(w);let U=n.enabled?n.interval.getSegments(o,K):void 0;const ee=h.getStyle(g,i,o),re=d.getStyle(h.enabled,g,i,o);if(U==null&&Y){const le=Math.min(...o.domain),ie=Math.max(...o.domain),ce={value:a,segmentStart:le,segmentEnd:ie};if(h.enabled){const te=Math.min(l,V/2,w/2)*(M?-1:1),ne=i?te:0,ue=i?0:te;D.push({series:this,itemId:"value",datum:ce,datumIndex:{type:0},type:0,x0:v+S-ne-F,y0:k+b-ue-G,x1:v+E+ne+F,y1:k+B+ue+G,clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:l,topRightCornerRadius:l,bottomRightCornerRadius:l,bottomLeftCornerRadius:l,horizontalInset:C,verticalInset:_,style:ee})}const he=Math.min(l,r/2,w/2)*(M?-1:1),Q=i?he:0,Ne=i?0:he;T.push({series:this,itemId:"scale",datum:ce,datumIndex:{type:0},type:0,x0:v+S-Q,y0:k+b-Ne,x1:v+x+Q,y1:k+f+Ne,clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:l,topRightCornerRadius:l,bottomRightCornerRadius:l,bottomLeftCornerRadius:l,horizontalInset:C,verticalInset:_,style:re})}else{U??(U=o.domain);const le=v+S-F,ie=k+b-G,ce=v+E+F,pe=k+B+G;for(let he=0;he<U.length-1;he+=1){const Q=U[he+0],Ne=U[he+1],ve={value:a,segmentStart:Q,segmentEnd:Ne},te=he===0,ne=he===U.length-2,ue=o.convert(Q),ke=o.convert(Ne),ni=Y||te?l:0,Po=Y||ne?l:0,ga=i?ni:Po,Di=Po,_i=i?Po:ni,ma=ni;h.enabled&&D.push({series:this,itemId:`value-${he}`,datum:ve,datumIndex:{type:0},type:0,x0:v+(i?ue:S),y0:k+(i?b:ue),x1:v+(i?ke:x),y1:k+(i?f:ke),clipX0:le,clipY0:ie,clipX1:ce,clipY1:pe,topLeftCornerRadius:ga,topRightCornerRadius:Di,bottomRightCornerRadius:_i,bottomLeftCornerRadius:ma,horizontalInset:C,verticalInset:_,style:ee}),T.push({series:this,itemId:`scale-${he}`,datum:ve,datumIndex:{type:0},type:0,x0:v+(i?ue:S),y0:k+(i?b:ue),x1:v+(i?ke:x),y1:k+(i?f:ke),clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:ga,topRightCornerRadius:Di,bottomRightCornerRadius:_i,bottomLeftCornerRadius:ma,horizontalInset:C,verticalInset:_,style:re})}}u.enabled&&N.push(this.labelDatum(u,a));const ye=i?tH:iH;for(let le=0;le<I.length;le+=1){const ie=I[le],{value:ce,text:pe,shape:he,size:Q,style:Ne}=ie,ve=this.getTargetPoint(ie),te=Lv(ie.rotation+ye[ie.placement]);L.push({series:this,itemId:`target-${le}`,midPoint:ve,datum:{value:ce},datumIndex:{type:1,index:le},type:1,value:ce,text:pe,x:ve.x,y:ve.y,shape:he,size:Q,rotation:te,label:this.getTargetLabel(ie),style:Ne})}return{itemId:e,nodeData:D,tickData:A,targetData:L,labelData:N,scaleData:T}}updateSelections(e){(this.nodeDataRefresh||e)&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}highlightDatum(e){if(e!=null&&e.series===this&&e.type===1)return e}update({seriesRect:e}){const{datumSelection:t,labelSelection:i,targetSelection:o,targetLabelSelection:s,scaleSelection:a,highlightTargetSelection:n,tickSelection:r}=this;this.seriesRect=e??Ji.NaN;const l=this.checkResize(e);this.updateSelections(l),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();const c=this.contextNodeData?.nodeData??[],h=this.contextNodeData?.labelData??[],d=this.contextNodeData?.targetData??[],u=this.contextNodeData?.scaleData??[],g=this.contextNodeData?.tickData??[],m=this.highlightDatum(this.ctx.highlightManager.getActiveHighlight());this.scaleSelection=this.updateScaleSelection({scaleData:u,scaleSelection:a}),this.updateScaleNodes({scaleSelection:a}),this.targetSelection=this.updateTargetSelection({targetData:d,targetSelection:o}),this.updateTargetNodes({targetSelection:o,isHighlight:!1}),this.targetLabelSelection=this.updateTargetLabelSelection({targetData:d,targetLabelSelection:s}),this.updateTargetLabelNodes({targetLabelSelection:s}),this.datumSelection=this.updateDatumSelection({nodeData:c,datumSelection:t}),this.updateDatumNodes({datumSelection:t}),this.labelSelection=this.updateLabelSelection({labelData:h,labelSelection:i}),this.updateLabelNodes({labelSelection:i}),this.highlightTargetSelection=this.updateTargetSelection({targetData:m==null?[]:[m],targetSelection:n}),this.updateTargetNodes({targetSelection:n,isHighlight:!0}),this.tickSelection=this.updateTickSelection({tickData:g,tickSelection:r}),this.updateTickNodes({tickSelection:r}),l&&this.animationState.transition("resize"),this.animationState.transition("update")}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>Hv(e.nodeData.length,t.itemId))}updateDatumNodes(e){const{datumSelection:t}=e,{ctx:i}=this,o=i.animationManager.isSkipped(),s=this.getShapeFillBBox();t.each((n,r)=>{const{topLeftCornerRadius:l,topRightCornerRadius:c,bottomRightCornerRadius:h,bottomLeftCornerRadius:d}=r;n.setStyleProperties(r.style,s),n.topLeftCornerRadius=l,n.topRightCornerRadius=c,n.bottomRightCornerRadius=h,n.bottomLeftCornerRadius=d,n.pointerEvents=this.properties.bar.enabled?hn.PointerEvents.All:hn.PointerEvents.None,(o||n.previousDatum==null)&&n.setProperties(ur(n,r))});const{horizontal:a}=this;this.datumUnion.update(t,this.itemGroup,hn.Rect,(n,r,l)=>{const c=Math.min(r.x,l.x),h=Math.max(r.x+r.width,l.x+l.width),d=Math.min(r.y,l.y),u=Math.max(r.y+r.height,l.y+l.height),g=h-c,m=u-d;n.pointerEvents=hn.PointerEvents.None,n.x=c,n.y=d,n.width=g,n.height=m,n.topLeftCornerRadius=a?r.topLeftCornerRadius:l.topLeftCornerRadius,n.topRightCornerRadius=l.topRightCornerRadius,n.bottomRightCornerRadius=a?l.bottomRightCornerRadius:r.bottomRightCornerRadius,n.bottomLeftCornerRadius=r.bottomLeftCornerRadius;const y=r.clipBBox,S=l.clipBBox??y;y&&S?n.clipBBox=Ji.merge([y,S]).intersection(a?new Ji(c,-1/0,g,1/0):new Ji(-1/0,d,1/0,m)):n.clipBBox=void 0})}updateScaleSelection(e){return e.scaleSelection.update(e.scaleData,void 0,t=>Hv(e.scaleData.length,t.itemId))}updateScaleNodes(e){const{scaleSelection:t}=e,i=this.getShapeFillBBox();t.each((o,s)=>{const{topLeftCornerRadius:a,topRightCornerRadius:n,bottomRightCornerRadius:r,bottomLeftCornerRadius:l}=s;o.setStyleProperties(s.style,i),o.setProperties(ur(o,s)),o.topLeftCornerRadius=a,o.topRightCornerRadius=n,o.bottomRightCornerRadius=r,o.bottomLeftCornerRadius=l,o.setProperties(ur(o,s))})}updateTargetSelection(e){return e.targetSelection.update(e.targetData,void 0,t=>t.itemId)}updateTargetNodes(e){const{targetSelection:t,isHighlight:i}=e;t.each((o,s)=>{const{x:a,y:n,shape:r,size:l,rotation:c}=s,h=this.getTargetStyle(i,s);o.setStyleProperties(h),o.size=l,o.shape=r==="line"?wv:r,o.translationX=a,o.translationY=n,o.rotation=c})}getTargetStyle(e,{datumIndex:t,style:i}){const o=this.getHighlightStyle(e,t);return AF(o,{...i,opacity:1})}updateTargetLabelSelection(e){return e.targetLabelSelection.update(e.targetData)}updateTargetLabelNodes(e){const{targetLabelSelection:t}=e;t.each((i,o)=>{const{x:s,y:a,text:n}=o,{offsetX:r,offsetY:l,fill:c,fontStyle:h,fontWeight:d,fontSize:u,fontFamily:g,textAlign:m,textBaseline:y}=o.label;i.visible=!0,i.x=s+r,i.y=a+l,i.text=n,i.fill=c,i.fontStyle=h,i.fontWeight=d,i.fontSize=u,i.fontFamily=g,i.textAlign=m,i.textBaseline=y})}updateTickSelection(e){return e.tickSelection.update(e.tickData,void 0,t=>t.tickId)}updateTickNodes(e){const{gaugeRect:t,properties:i}=this,o=i.defaultScale,{enabled:s,color:a,fontFamily:n=o.label.fontFamily,fontSize:r=o.label.fontSize,fontStyle:l,fontWeight:c=o.label.fontWeight,spacing:h}=i.scale.label;let{placement:d}=i.scale.label;const u=Lv(i.scale.label.rotation??0);let g,m,y,S;this.horizontal?(d??(d="after"),g="center",m=d==="before"?"bottom":"top",S=this.originY+t.y+(d==="before"?-h:t.height+h)):(d??(d="before"),g=d==="before"?"end":"start",m="middle",y=this.originX+t.x+(d==="before"?-h:t.width+h)),e.tickSelection.each((x,b)=>{if(!s){x.visible=!1;return}const f=y??b.translation,v=S??b.translation;x.visible=!0,x.text=b.tickLabel,x.fill=a,x.fontFamily=n,x.fontSize=r,x.fontStyle=l,x.fontWeight=c,x.textBaseline=m,x.textAlign=g,x.x=f,x.y=v,x.rotationCenterX=f,x.rotationCenterY=v,x.rotation=u})}updateLabelSelection(e){return e.labelSelection.update(e.labelData,void 0,t=>"primary")}updateLabelNodes(e){const{labelSelection:t}=e,i=this.ctx.animationManager.isSkipped();t.each((o,s)=>{o.fill=s.fill,o.fontStyle=s.fontStyle,o.fontWeight=s.fontWeight,o.fontFamily=s.fontFamily}),(i||this.labelsHaveExplicitText())&&this.formatLabelText()}labelsHaveExplicitText(){for(const{datum:e}of this.labelSelection)if(e.text==null)return!1;return!0}formatLabelText(e){const{labelSelection:t,horizontal:i,scale:o,seriesRect:s,gaugeRect:a}=this,{x:n,y:r,width:l,height:c}=a,h=e?.label??this.properties.value;let d;if(i){const m=o.convert(h);d=new Ji(n,r,m-n,c)}else{const m=o.convert(h);d=new Ji(n,m,l,c-m)}const u={seriesRect:s,gaugeRect:a,barRect:d},{margin:g}=this.properties;jF(this,this.ctx,t,{padding:g,horizontal:i},u,e)}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),XF([this.datumSelection],ur),this.formatLabelText()}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"&&this.animationState.transition("skip")}animateLabelText(e={}){const{animationManager:t}=this.ctx;let i=0,o=0;if(this.labelSelection.each((s,a)=>{s.opacity=1,i=s.previousDatum?.value??e.from??a.value,o=a.value}),!this.labelsHaveExplicitText())if(i===o)this.formatLabelText({label:o});else{const s=`${this.id}_labels`;t.animate({id:s,groupId:"label",from:{label:i},to:{label:o},phase:e.phase??"update",ease:bF,onUpdate:a=>this.formatLabelText(a),onStop:()=>this.formatLabelText({label:o})})}}animateEmptyUpdateReady(){const{animationManager:e}=this.ctx,{node:t}=zv(!0,this.horizontal);_u(this.id,"node",e,[this.datumSelection],t,(i,o)=>o.itemId),_u(this.id,"label",e,[this.labelSelection],Cv,()=>"primary"),this.animateLabelText({from:0,phase:"initial"})}animateWaitingUpdateReady(){const{animationManager:e}=this.ctx,{node:t}=zv(!1,this.horizontal);_u(this.id,"node",e,[this.datumSelection],t,(i,o)=>o.itemId),this.animateLabelText()}animateReadyResize(){this.resetAllAnimation()}getSeriesDomain(){return{domain:[0,1]}}dataCount(){return Number.NaN}getSeriesRange(){return[Number.NaN,Number.NaN]}getLegendData(){return[]}getTooltipContent(e){const{id:t,properties:i}=this,{tooltip:o}=i;if(e==null)return;let s,a,n;if(e.type===0?(s=i.value,a=i.label.text,n=this.ctx.localeManager.t("ariaLabelGaugeValue")):({value:s,text:a}=i.targets[e.index],n=this.ctx.localeManager.t("ariaLabelGaugeTarget")),s!=null)return this.formatTooltipWithContext(o,{data:[{label:a,fallbackLabel:n,value:this.formatLabel(s)}]},{seriesId:t,title:void 0,datum:void 0,value:s})}pickNodeClosestDatum(e){return Ov(this,e)}pickFocus(e){return Rv(this,e)}getCaptionText(){return this.formatLabel(this.properties.value)}getCategoryValue(e){}datumIndexForCategoryValue(e){}hasItemStylers(){return this.properties.label.itemStyler!=null}};Bu.className="LinearGaugeSeries",Bu.type="linear-gauge";var oH={minWidth:200,minHeight:200,tooltip:{enabled:!1},series:{thickness:50,defaultColorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$interpolate:[{$palette:"secondDivergingColors"},5]},Tu.SAFE_RANGE2_OPERATION]},scale:{defaultFill:{$path:["/1",{$palette:"fill"},{$palette:"hierarchyColors"}]},stroke:{$path:["/2",Tu.SAFE_STROKE_FILL_OPERATION,{$palette:"hierarchyColors"}]},strokeWidth:{$isUserOption:["./stroke",2,0]},label:{spacing:11}},bar:{strokeWidth:{$isUserOption:["./stroke",2,0]}},segmentation:{enabled:!1,interval:{},spacing:1},defaultTarget:{fill:{$ref:"foregroundColor"},stroke:{$ref:"foregroundColor"},size:10,shape:"triangle",placement:"after",spacing:5,label:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},spacing:5}},defaultScale:{label:{fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"}}},label:{...Tu.LABEL_BOXING_DEFAULTS,enabled:!1,placement:"inside-start",fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},fontSize:{$rem:2},minimumFontSize:aF.SMALL,spacing:18,color:{$ref:"chartBackgroundColor"}},margin:4,tooltip:{range:{$path:["/tooltip/range",10]}}}},$v={type:"series",name:"linear-gauge",chartType:"standalone",enterprise:!0,dependencies:[Mv],version:sF,options:nF,themeTemplate:oH,create:e=>new Bu(e)};import{VERSION as sH,_ModuleSupport as Hc}from"ag-charts-community";import{VERSION as aH,_ModuleSupport as nH}from"ag-charts-community";import{_ModuleSupport as Vu}from"ag-charts-community";import{ChartAxisDirection as Yv,Property as rH,createId as Uv}from"ag-charts-core";var{Chart:lH,MercatorScale:jv}=Vu;function cH(e){return e.type==="map-shape"||e.type==="map-line"||e.type==="map-marker"||e.type==="map-shape-background"||e.type==="map-line-background"}var Wc=class extends lH{constructor(e,t){super(e,t),this.xAxis={id:Uv(Vu.Axis),direction:Yv.X},this.yAxis={id:Uv(Vu.Axis),direction:Yv.Y},this.ctx.zoomManager.setAxes([this.xAxis,this.yAxis])}getChartType(){return"topology"}updateData(){super.updateData();const e=this.getOptions();this.topology!==e.topology&&(this.topology=e.topology);const{topology:t}=this;for(const i of this.series)cH(i)&&i.setChartTopology(t)}performLayout(e){const{seriesRoot:t,annotationRoot:i}=this,o=e.layoutBox.clone().shrink(this.seriesArea.getPadding());this.seriesRect=o,this.animationRect=o;const s=this.series,a=s.reduce((l,c)=>{if(!c.visible)return l;const h=c.topologyBounds;return h==null?l:l==null?h:l.merge(h)},void 0);let n;if(a!=null){const{lon0:l,lat0:c,lon1:h,lat1:d}=a,u=[[l,c],[h,d]],g=jv.bounds(u),{width:m,height:y}=o,S=Math.min(m/g.width,y/g.height),x=g.width*S,b=g.height*S,f=(m-x)/2,v=(y-b)/2,k=f,A=v,M=f+x,I=v+b,D=this.ctx.zoomManager.getAxisZoom(this.xAxis.id),L=this.ctx.zoomManager.getAxisZoom(this.yAxis.id),N=(M-k)/(D.max-D.min),T=k-N*D.min,O=(I-A)/(1-L.min-(1-L.max)),R=A-O*(1-L.max);n=new jv(u,[[T,R],[T+N,R+O]])}for(const l of s)l.scale=n;const r=this.series.some(l=>l.visible);t.visible=r;for(const l of[t,i])l.translationX=Math.floor(o.x),l.translationY=Math.floor(o.y),l.setClipRect(o.clone());this.ctx.layoutManager.emitLayoutComplete(e,{series:{visible:r,rect:o,paddedRect:e.layoutBox}})}};Wc.className="TopologyChart",Wc.type="topology",p([rH],Wc.prototype,"topology",2);var{topologyChartOptionsDefs:hH}=nH,gr={type:"chart",name:"topology",enterprise:!0,version:aH,options:hH,create(e,t){return new Wc(e,t)}};import{deepClone as dH,jsonWalk as pH}from"ag-charts-core";var mr={zoom:{axes:"xy",anchorPointX:"pointer",anchorPointY:"pointer",buttons:{anchorPointX:"middle",anchorPointY:"middle"}},legend:{enabled:!1}};function eo(e){const t=dH(e);return pH(t,i=>{typeof i=="object"&&"$palette"in i&&(i.$mapPalette=i.$palette,delete i.$palette)}),t}import{_ModuleSupport as Xv}from"ag-charts-community";import{Logger as Zv,cachedTextMeasurer as uH,mergeDefaults as qv}from"ag-charts-core";import{_ModuleSupport as gH}from"ag-charts-community";import{SceneChangeDetection as mH,SceneObjectChangeDetection as yH,objectsEqual as fH}from"ag-charts-core";var xH=1e-9;function Qv(e,t,i,o){const[s,a]=e,[n,r]=t,l=n-s,c=r-a,h=l*l+c*c;let d,u;if(Math.abs(h)<xH)d=s,u=a;else{let y=((i-s)*l+(o-a)*c)/h;y=Math.max(0,Math.min(1,y)),d=s+y*(n-s),u=a+y*(r-a)}const g=i-d,m=o-u;return g*g+m*m}function Jv(e,t,i){let o=1/0,s=e.at(-1);for(const a of e)o=Math.min(o,Qv(s,a,t,i)),s=a;return Math.sqrt(o)}function zu(e){let[t,i]=e[0],o=0;for(let s=1;s<e.length;s+=1){const[a,n]=e[s],r=Math.hypot(a-t,n-i);o+=r,t=a,i=n}return o}function Kc(e){if(e.length===0)return;const t=zu(e)/2;let[i,o]=e[0],s=0;for(let a=1;a<e.length;a+=1){const[n,r]=e[a],l=Math.hypot(n-i,r-o),c=s+l;if(c>t){const h=(t-s)/l,d=[i+(n-i)*h,o+(r-o)*h],u=Math.atan2(r-o,n-i);return{point:d,angle:u}}s=c,i=n,o=r}}import{LonLatBBox as SH}from"ag-charts-core";function pn(e,t){for(const i of e){const[o,s]=i;t=SH.extend(t,o,s,o,s)}return t}function bH(e){if(e.length===0)return;let t=0,i=0,o=0,[s,a]=e.at(-1);for(const[n,r]of e){const l=s*r-n*a;o+=l,t+=(s+n)*l,i+=(a+r)*l,s=n,a=r}return o*=3,[t/o,i/o]}function Gc(e,t,i){let o=!1,s=1/0;for(const a of e){let n=a.at(-1),[r,l]=n;for(const c of a){const[h,d]=c;d>i!=l>i&&t<(r-h)*(i-d)/(l-d)+h&&(o=!o),s=Math.min(s,Qv(n,c,t,i)),n=c,r=h,l=d}}return(o?-1:1)*Math.sqrt(s)}var{Path:vH,ExtendedPath2D:kH,BBox:DH}=gH,un=class extends vH{constructor(){super(...arguments),this.projectedGeometry=void 0,this.renderMode=3,this.strokePath=new kH}computeBBox(){return(this.dirtyPath||this.isDirtyPath())&&(this.updatePath(),this.dirtyPath=!1),this.bbox?.clone()}updatePath(){const{projectedGeometry:e}=this;this.strokePath.clear(),this.path.clear(),this.bbox=e==null?void 0:this.drawGeometry(e,void 0)}drawPath(e){super.drawPath(e),this.renderStroke(e,this.strokePath.getPath2D())}containsPoint(e,t){const{projectedGeometry:i}=this;return i==null||!this.getBBox().containsPoint(e,t)?!1:this.geometryDistance(i,e,t)<=0}distanceSquared(e,t){const{projectedGeometry:i}=this;if(i==null)return 1/0;const o=this.geometryDistance(i,e,t);return o>0?o*o:0}geometryDistance(e,t,i){const{renderMode:o,strokeWidth:s}=this,a=(o&1)!==0,n=(o&2)!==0,r=Math.max(s/2,1)+1;switch(e.type){case"GeometryCollection":return e.geometries.reduce((l,c)=>Math.min(l,this.geometryDistance(c,t,i)),1/0);case"MultiPolygon":return a?e.coordinates.reduce((l,c)=>Math.min(l,Math.max(Gc(c,t,i),0)),1/0):1/0;case"Polygon":return a?Math.max(Gc(e.coordinates,t,i),0):1/0;case"MultiLineString":return n?e.coordinates.reduce((l,c)=>Math.min(l,Math.max(Jv(c,t,i)-r,0)),1/0):1/0;case"LineString":return n?Math.max(Jv(e.coordinates,t,i)-r,0):1/0;case"MultiPoint":case"Point":default:return 1/0}}shouldDrawPolygons(){return(this.renderMode&1)!==0}shouldDrawLines(){return(this.renderMode&2)!==0}drawGeometryCollection(e,t){for(const i of e)t=this.drawGeometry(i,t);return t}drawMultiPolygon(e,t){if(!this.shouldDrawPolygons())return t;for(const i of e)t=this.drawPolygon(this.path,i,t);return t}drawSinglePolygon(e,t){return this.shouldDrawPolygons()?this.drawPolygon(this.path,e,t):t}drawMultiLineString(e,t){if(!this.shouldDrawLines())return t;for(const i of e)t=this.drawLineString(this.strokePath,i,t,!1);return t}drawSingleLineString(e,t){return this.shouldDrawLines()?this.drawLineString(this.strokePath,e,t,!1):t}drawGeometry(e,t){switch(e.type){case"GeometryCollection":return this.drawGeometryCollection(e.geometries,t);case"MultiPolygon":return this.drawMultiPolygon(e.coordinates,t);case"Polygon":return this.drawSinglePolygon(e.coordinates,t);case"MultiLineString":return this.drawMultiLineString(e.coordinates,t);case"LineString":return this.drawSingleLineString(e.coordinates,t);case"Point":case"MultiPoint":return t}}drawPolygon(e,t,i){if(t.length<1)return i;i=this.drawLineString(e,t[0],i,!0);for(let o=1;o<t.length;o+=1){const s=t[o];this.drawLineString(e,s,void 0,!0)}return i}drawLineString(e,t,i,o){if(t.length<2)return i;const s=o?t.length-1:t.length;for(let a=0;a<s;a+=1){const[n,r]=t[a];if(a===0?e.moveTo(n,r):e.lineTo(n,r),i==null)i=new DH(n,r,0,0);else{const{x:l,y:c}=i,h=l+i.width,d=c+i.height;i.x=Math.min(l,n),i.y=Math.min(c,r),i.width=Math.max(h,n)-i.x,i.height=Math.max(d,r)-i.y}}return o&&e.closePath(),i}};p([yH({equals:fH})],un.prototype,"projectedGeometry",2),p([mH()],un.prototype,"renderMode",2);import"ag-charts-community";import{LonLatBBox as Fu}from"ag-charts-core";function ek(e){const t=pn(e[0],void 0);return t==null?0:Math.abs(t.lat1-t.lat0)*Math.abs(t.lon1-t.lon0)}function $c(e,t){let i,o;for(const s of e){const a=t(s);a!=null&&(i==null||a>i)&&(i=a,o=s)}return o}function gn(e,t){if(e.bbox!=null){const[i,o,s,a]=e.bbox;return t=Fu.extend(t,i,o,s,a),t}switch(e.type){case"GeometryCollection":for(const i of e.geometries)t=gn(i,t);break;case"MultiPolygon":for(const i of e.coordinates)i.length>0&&(t=pn(i[0],t));break;case"Polygon":e.coordinates.length>0&&(t=pn(e.coordinates[0],t));break;case"MultiLineString":for(const i of e.coordinates)t=pn(i,t);break;case"LineString":t=pn(e.coordinates,t);break;case"MultiPoint":for(const i of e.coordinates){const[o,s]=i;t=Fu.extend(t,o,s,o,s)}break;case"Point":{const[i,o]=e.coordinates;t=Fu.extend(t,i,o,i,o);break}}return t}function Yc(e){switch(e.type){case"Polygon":return e.coordinates;case"MultiPolygon":return $c(e.coordinates,ek);case"GeometryCollection":{const t=e.geometries.map(Yc).filter(i=>i!=null);return $c(t,ek)}case"MultiLineString":case"LineString":case"MultiPoint":case"Point":return}}function Uc(e){switch(e.type){case"LineString":return e.coordinates;case"MultiLineString":return $c(e.coordinates,zu);case"GeometryCollection":{const t=e.geometries.map(Uc).filter(i=>i!=null);return $c(t,zu)}case"MultiPolygon":case"Polygon":case"MultiPoint":case"Point":return}}function Hu(e,t){if(e==null)return!1;switch(e.type){case"GeometryCollection":return e.geometries.some(i=>Hu(i,t));case"MultiPolygon":case"Polygon":return(t&1)!==0;case"MultiLineString":case"LineString":return(t&2)!==0;case"MultiPoint":case"Point":return(t&4)!==0}}function oa(e,t){switch(e.type){case"GeometryCollection":return{type:"GeometryCollection",geometries:e.geometries.map(i=>oa(i,t))};case"Polygon":return{type:"Polygon",coordinates:Wu(e.coordinates,t)};case"MultiPolygon":return{type:"MultiPolygon",coordinates:AH(e.coordinates,t)};case"MultiLineString":return{type:"MultiLineString",coordinates:Wu(e.coordinates,t)};case"LineString":return{type:"LineString",coordinates:Ku(e.coordinates,t)};case"MultiPoint":return{type:"MultiPoint",coordinates:Ku(e.coordinates,t)};case"Point":return{type:"Point",coordinates:t.convert(e.coordinates)}}}function AH(e,t){return e.map(i=>Wu(i,t))}function Wu(e,t){return e.map(i=>Ku(i,t))}function Ku(e,t){return e.map(i=>t.convert(i))}function MH(){return{fromFn:(i,o,s)=>s==="removed"?{scalingX:1,scalingY:1}:i.previousDatum==null?{scalingX:0,scalingY:0}:{scalingX:i.scalingX,scalingY:i.scalingY},toFn:(i,o,s)=>s==="removed"?{scalingX:0,scalingY:0}:{scalingX:1,scalingY:1}}}function tk(e,t){const i=e.contextNodeData?.nodeData[t.datumIndex];if(i!==void 0){for(const o of e.datumSelection.nodes())if(o.datum===i)return o}}import{_ModuleSupport as ik}from"ag-charts-community";var t9=class extends ik.SeriesProperties{},yr=class extends ik.DataModelSeries{constructor(e){super(e),this.cleanup.register(this.ctx.eventsHub.on("data:update",()=>{}),this.ctx.eventsHub.on("legend:item-click",t=>{this.onLegendItemClick(t)}),this.ctx.eventsHub.on("legend:item-double-click",t=>{this.onLegendItemDoubleClick(t)}))}getSeriesDomain(){return{domain:[Number.NaN,Number.NaN]}}getSeriesRange(){return[Number.NaN,Number.NaN]}getHighlightedDatum(){let e=this.ctx.highlightManager?.getActiveHighlight();const{legendItemName:t}=this.properties,i=t!=null&&e?.datum==null&&t===e?.legendItemName;return e!=null&&(e.series!==this&&!i||e.datum==null)&&(e=void 0),e}};import{_ModuleSupport as IH}from"ag-charts-community";import{Property as Me}from"ag-charts-core";var{SeriesProperties:LH,makeSeriesTooltip:NH,Label:CH}=IH,Se=class extends LH{constructor(){super(...arguments),this.topology=void 0,this.idKey="",this.topologyIdKey="name",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.maxStrokeWidth=void 0,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.label=new CH,this.tooltip=NH()}getStyle(){const{stroke:e,strokeOpacity:t,strokeWidth:i,lineDash:o,lineDashOffset:s}=this;return{stroke:e,strokeOpacity:t,strokeWidth:i,lineDash:o,lineDashOffset:s,opacity:1}}};p([Me],Se.prototype,"topology",2),p([Me],Se.prototype,"title",2),p([Me],Se.prototype,"legendItemName",2),p([Me],Se.prototype,"idKey",2),p([Me],Se.prototype,"topologyIdKey",2),p([Me],Se.prototype,"idName",2),p([Me],Se.prototype,"labelKey",2),p([Me],Se.prototype,"labelName",2),p([Me],Se.prototype,"sizeKey",2),p([Me],Se.prototype,"sizeName",2),p([Me],Se.prototype,"colorKey",2),p([Me],Se.prototype,"colorName",2),p([Me],Se.prototype,"sizeDomain",2),p([Me],Se.prototype,"colorRange",2),p([Me],Se.prototype,"maxStrokeWidth",2),p([Me],Se.prototype,"stroke",2),p([Me],Se.prototype,"strokeOpacity",2),p([Me],Se.prototype,"strokeWidth",2),p([Me],Se.prototype,"lineDash",2),p([Me],Se.prototype,"lineDashOffset",2),p([Me],Se.prototype,"itemStyler",2),p([Me],Se.prototype,"label",2),p([Me],Se.prototype,"tooltip",2);var{getMissCount:TH,getLabelStyles:wH,createDatumId:ok,SeriesNodePickMode:sk,valueProperty:fr,ColorScale:PH,LinearScale:OH,Selection:jc,Text:ak,Transformable:RH}=Xv,Gu=class extends yr{constructor(e){super({moduleCtx:e,categoryKey:void 0,propertyKeys:{size:["colorKey"],color:["colorKey"],label:["labelKey"]},propertyNames:{size:["sizeName"],color:["colorName"],label:["labelName"]},pickModes:[sk.EXACT_SHAPE_MATCH,sk.NEAREST_NODE],usesPlacedLabels:!0}),this.properties=new Se,this._chartTopology=void 0,this.colorScale=new PH,this.sizeScale=new OH,this.datumSelection=jc.select(this.contentGroup,()=>this.nodeFactory()),this.labelSelection=jc.select(this.labelGroup,ak),this.highlightDatumSelection=jc.select(this.highlightNodeGroup,()=>this.nodeFactory()),this.highlightLabelSelection=jc.select(this.highlightLabelGroup,ak),this.placedLabelData=[],this._previousDatumMidPoint=void 0}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){return super.hasData&&this.topology!=null}renderToOffscreenCanvas(){return!0}setZIndex(e){return super.setZIndex(e),this.contentGroup.zIndex=[1,e],this.highlightGroup.zIndex=[4,e],!0}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}nodeFactory(){const e=new un;return e.renderMode=2,e.lineJoin="round",e.lineCap="round",e}async processData(e){if(this.data==null)return;const{data:t,topology:i,sizeScale:o,colorScale:s}=this,{topologyIdKey:a,idKey:n,sizeKey:r,colorKey:l,labelKey:c,sizeDomain:h,colorRange:d}=this.properties,u=new Map;for(const f of i?.features.values()??[]){const v=f.properties?.[a];v==null||!Hu(f.geometry,2)||u.set(v,f)}const g=this.sizeScale.type,m=this.colorScale.type,y=this.scale?.type,{dataModel:S,processedData:x}=await this.requestDataModel(e,t,{props:[fr(n,y,{id:"idValue",includeProperty:!1}),fr(n,y,{id:"featureValue",includeProperty:!1,processor:()=>f=>u.get(f)}),...c==null?[]:[fr(c,"category",{id:"labelValue"})],...r==null?[]:[fr(r,g,{id:"sizeValue"})],...l==null?[]:[fr(l,m,{id:"colorValue"})]]}),b=S.resolveColumnById(this,"featureValue",x);if(this.topologyBounds=b.reduce((f,v)=>{const k=v?.geometry;return k==null?f:gn(k,f)},void 0),r!=null){const f=S.resolveProcessedDataIndexById(this,"sizeValue"),v=x.domain.values[f]??[];o.domain=h??v}if(d!=null&&this.isColorScaleValid()){const f=S.resolveProcessedDataIndexById(this,"colorValue");s.domain=x.domain.values[f],s.range=d,s.update()}i==null&&Zv.warnOnce("no topology was provided for [MapLineSeries]; nothing will be rendered.")}isColorScaleValid(){const{colorKey:e}=this.properties;if(!e)return!1;const{dataModel:t,processedData:i}=this;if(!t||!i)return!1;const o=t.resolveProcessedDataIndexById(this,"colorValue"),s=i.input.count,a=TH(this,i.defs.values[o].missing);return!(s===0||s===a)}getLabelDatum(e,t,i,o,s,a){if(o==null||s==null||i==null)return;const n=Uc(s);if(n==null)return;const{idKey:r,idName:l,sizeKey:c,sizeName:h,colorKey:d,colorName:u,labelKey:g,labelName:m,label:y}=this.properties;if(g==null||!y.enabled)return;const S=this.getLabelText(o,e,g,"label",[],y,{value:o,datum:e,idKey:r,idName:l,sizeKey:c,sizeName:h,colorKey:d,colorName:u,labelKey:g,labelName:m});if(S==null)return;const x=a.measureLines(String(S)),b=Kc(n);if(b==null)return;const[f,v]=b.point,{width:k,height:A}=x;return{point:{x:f,y:v,size:0},label:{width:k,height:A,text:S},anchor:void 0,placement:void 0,datumIndex:t,idValue:i}}resolveColumn(e,t,i){if(!(e==null||this.dataModel==null))return this.dataModel.resolveColumnById(this,t,i)}resolveLineDataColumns(e){const{sizeKey:t,colorKey:i,labelKey:o}=this.properties;return{idValues:this.dataModel.resolveColumnById(this,"idValue",e),featureValues:this.dataModel.resolveColumnById(this,"featureValue",e),labelValues:this.resolveColumn(o,"labelValue",e),sizeValues:this.resolveColumn(t,"sizeValue",e),colorValues:this.resolveColumn(i,"colorValue",e)}}prepareProjectedLineGeometries(e,t,i){const o=new Map;for(const[s]of i.dataSources.get(this.id)?.data.entries()??[]){const a=e[s],n=t[s]?.geometry,r=n!=null&&this.scale!=null?oa(n,this.scale):void 0;a!=null&&r!=null&&o.set(a,r)}return o}warnMissingGeometries(e){if(e.length===0)return;const t=10;if(e.length>t){const i=e.length-t;e.length=t,e.push(`(+${i} more)`)}Zv.warnOnce("some data items do not have matches in the provided topology",e)}createNodeData(){const{id:e,dataModel:t,processedData:i,sizeScale:o,properties:s}=this,{idKey:a,label:n,legendItemName:r,colorKey:l}=s;if(t==null||i==null)return;const c=this.resolveLineDataColumns(i),h=s.maxStrokeWidth??s.strokeWidth;o.range=[Math.min(s.strokeWidth,h),h];const d=uH(n),u=this.prepareProjectedLineGeometries(c.idValues,c.featureValues,i),g=[],m=[],y=[],S=i.dataSources.get(this.id)?.data??[];for(const[x,b]of S.entries()){const f={idValue:c.idValues[x],colorValue:c.colorValues?.[x],sizeValue:c.sizeValues?.[x],labelValue:c.labelValues?.[x]},v=u.get(f.idValue);if(v==null&&y.push(f.idValue),l!=null&&f.colorValue==null)continue;const k=this.getLabelDatum(b,x,f.idValue,f.labelValue,v,d);k!=null&&m.push(k),g.push({series:this,itemId:a,datum:b,datumIndex:x,...f,projectedGeometry:v,legendItemName:r,style:this.getItemStyle({datumIndex:x,datum:b,colorValue:f.colorValue,sizeValue:f.sizeValue},!1)})}return this.warnMissingGeometries(y),{itemId:e,nodeData:g,labelData:m}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){const{datumSelection:e,highlightDatumSelection:t}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.labelGroup.visible=this.visible;const i=this.ctx.chartService.highlight?.drawingMode??"overlay",o=this.getHighlightedDatum(),s=this.contextNodeData?.nodeData??[];this.datumSelection=this.updateDatumSelection({nodeData:s,datumSelection:e}),this.updateDatumStyles({datumSelection:e,isHighlight:!1}),this.updateDatumNodes({datumSelection:e,isHighlight:!1,drawingMode:"overlay"}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:o==null?[]:[o],datumSelection:t}),this.updateDatumStyles({datumSelection:t,isHighlight:!0}),this.updateDatumNodes({datumSelection:t,isHighlight:!0,drawingMode:i}),this.updateLabelNodes({labelSelection:this.labelSelection,isHighlight:!1}),this.updateHighlightLabelSelection(o)}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>ok(t.idValue))}getItemStyle({datumIndex:e=0,datum:t,colorValue:i,sizeValue:o},s){const{properties:a,colorScale:n,sizeScale:r}=this,{colorRange:l,itemStyler:c}=a,h=a.getStyle();i!=null&&(h.stroke=this.isColorScaleValid()?n.convert(i):l?.[0]??a.stroke);const d=this.getHighlightStyle(s,e),u=qv(d,h);o!=null&&(u.strokeWidth=r.convert(o,{clamp:!0}));let g;return c!=null&&(g=this.cachedDatumCallback(ok(e,s?"highlight":"node"),()=>{const m=this.makeItemStylerParams(t,e,s,u);return this.callWithContext(c,m)})),g?qv(u,g):u}makeItemStylerParams(e,t,i,o){const{id:s}=this,a=this.ctx.highlightManager?.getActiveHighlight(),n=this.getHighlightStateString(a,i,t);return{seriesId:s,datum:e,highlightState:n,...o}}updateDatumStyles({datumSelection:e,isHighlight:t}){e.each((i,o)=>{o.style=this.getItemStyle(o,t)})}updateDatumNodes({datumSelection:e,drawingMode:t}){e.each((i,o)=>{const{projectedGeometry:s,style:a}=o;if(s==null){i.visible=!1,i.projectedGeometry=void 0;return}i.visible=!0,i.projectedGeometry=s,i.setProperties(a),i.drawingMode=t})}updatePlacedLabelData(e){this.placedLabelData=e,this.labelSelection=this.labelSelection.update(e,t=>{t.pointerEvents=Xv.PointerEvents.None}),this.updateLabelNodes({labelSelection:this.labelSelection,isHighlight:!1}),this.updateHighlightLabelSelection()}updateLabelNodes({isHighlight:e,labelSelection:t}){const{properties:i}=this,o=this.getHighlightedDatum();t.each((s,a)=>{const{x:n,y:r,width:l,height:c,text:h,datum:d}=a,u=wH(this,void 0,i,i.label,e,o),{color:g,fontStyle:m,fontWeight:y,fontSize:S,fontFamily:x}=u;s.visible=!0,s.x=n+l/2,s.y=r+c/2,s.text=h,s.fill=g,s.fontStyle=m,s.fontWeight=y,s.fontSize=S,s.fontFamily=x,s.textAlign="center",s.textBaseline="middle";const b=d?.datumIndex;s.fillOpacity=this.getHighlightStyle(e,b).opacity??1,s.setBoxing(u)})}updateHighlightLabelSelection(e=this.getHighlightedDatum()){const t=e?.idValue,i=t==null||!this.isLabelEnabled()?[]:this.placedLabelData.filter(o=>o.datum.idValue===t);this.highlightLabelSelection=this.highlightLabelSelection.update(i),i.length===0&&this.highlightLabelSelection.cleanup(),this.updateLabelNodes({labelSelection:this.highlightLabelSelection,isHighlight:!0})}resetAnimation(){}getLabelData(){return this.isLabelEnabled()?this.contextNodeData?.labelData??[]:[]}pickNodeClosestDatum({x:e,y:t}){let i=1/0,o;return this.datumSelection.each((s,a)=>{const n=s.distanceSquared(e,t);n<i&&(i=n,o=a)}),o==null?void 0:{datum:o,distance:Math.sqrt(i)}}datumMidPoint(e){const{_previousDatumMidPoint:t}=this;if(t?.datum===e)return t.point;const i=e.projectedGeometry,o=i==null?void 0:Uc(i),s=o==null?void 0:Kc(o)?.point,a=s==null?void 0:{x:s[0],y:s[1]};return this._previousDatumMidPoint={datum:e,point:a},a}legendItemSymbol(e){const{dataModel:t,processedData:i,properties:o}=this,{strokeWidth:s,strokeOpacity:a,lineDash:n}=o;let{stroke:r}=o;if(e!=null&&this.isColorScaleValid()){const c=t.resolveColumnById(this,"colorValue",i)[e];c!=null&&(r=this.colorScale.convert(c))}return{marker:{fill:void 0,fillOpacity:0,stroke:void 0,strokeWidth:0,strokeOpacity:0,lineDash:[0],lineDashOffset:0,enabled:!1},line:{enabled:!0,stroke:r,strokeWidth:s,strokeOpacity:a,lineDash:n}}}getLegendData(e){const{processedData:t,dataModel:i}=this;if(t==null||i==null)return[];const{id:o,visible:s}=this,{title:a,legendItemName:n,idKey:r,idName:l,colorKey:c,colorRange:h,showInLegend:d}=this.properties;if(e==="gradient"&&c!=null&&h!=null){const u=t.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:s,seriesId:o,series:this.getFormatterContext("color"),colorRange:h,colorDomain:u}]}else return e==="category"?[{legendType:"category",id:o,itemId:o,seriesId:o,enabled:s,label:{text:n??a??l??r},symbol:this.legendItemSymbol(),legendItemName:n,hideInLegend:!d}]:[]}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,properties:s,ctx:{formatManager:a}}=this,{idKey:n,idName:r,colorKey:l,colorName:c,sizeKey:h,sizeName:d,labelKey:u,labelName:g,title:m,legendItemName:y,tooltip:S}=s;if(!i||!o)return;const x=o.dataSources.get(this.id)?.data[e],b=i.resolveColumnById(this,"idValue",o),f=h==null?void 0:i.resolveColumnById(this,"sizeValue",o)[e],v=l==null?void 0:i.resolveColumnById(this,"colorValue",o)[e];if(l!=null&&v==null)return;const k=[];if(this.isLabelEnabled()&&u!=null&&u!==n){const M=i.resolveColumnById(this,"labelValue",o)[e],I=a.format(this.callWithContext.bind(this),{type:"category",value:M,datum:x,seriesId:t,legendItemName:y,key:u,source:"tooltip",property:"label",domain:[],boundSeries:this.getFormatterContext("label")});k.push({label:g,fallbackLabel:u,value:I??M})}if(f!=null&&h!=null){const M=i.getDomain(this,"sizeValue","value",o).domain,I=a.format(this.callWithContext.bind(this),{type:"number",value:f,datum:x,seriesId:t,legendItemName:y,key:h,source:"tooltip",property:"size",domain:M,boundSeries:this.getFormatterContext("size"),fractionDigits:void 0});k.push({label:d,fallbackLabel:h,value:I??String(f)})}if(v!=null&&l!=null){const M=i.getDomain(this,"colorValue","value",o).domain,I=a.format(this.callWithContext.bind(this),{type:"number",value:v,datum:x,seriesId:t,legendItemName:y,key:l,source:"tooltip",property:"color",domain:M,boundSeries:this.getFormatterContext("color"),fractionDigits:void 0});k.push({label:c,fallbackLabel:l,value:I??String(v)})}const A=this.getItemStyle({datumIndex:e,datum:x,colorValue:v,sizeValue:f},!1);return this.formatTooltipWithContext(S,{heading:b[e],title:m??y,symbol:this.legendItemSymbol(e),data:k},{seriesId:t,datum:x,title:m,idKey:n,idName:r,colorKey:l,colorName:c,sizeKey:h,sizeName:d,labelKey:u,labelName:g,...A})}computeFocusBounds(e){const t=tk(this,e);return t?RH.toCanvas(this.contentGroup,t.getBBox()):void 0}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.label.itemStyler!=null}};Gu.className="MapLineSeries",Gu.type="map-line";import{_ModuleSupport as EH}from"ag-charts-community";import{and as _H,arrayLength as BH,arrayOf as VH,color as zH,commonSeriesOptionsDefs as FH,constant as HH,geoJson as WH,required as nk,string as Pi,undocumented as KH,without as GH}from"ag-charts-core";var{mapLineSeriesThemeableOptionsDef:$H}=EH,rk={...GH(FH,["highlightStyle","highlight"]),...$H,type:nk(HH("map-line")),idKey:nk(Pi),sizeKey:Pi,colorKey:Pi,labelKey:Pi,idName:Pi,sizeName:Pi,colorName:Pi,labelName:Pi,topology:WH,topologyIdKey:Pi,legendItemName:Pi,title:Pi};rk.colorRange=KH(_H(VH(zH),BH(1)));var lk={type:"series",name:"map-line",chartType:"topology",enterprise:!0,version:sH,dependencies:[gr],options:rk,themeTemplate:{...mr,series:{stroke:eo(Hc.SAFE_STROKE_FILL_OPERATION),colorRange:{$if:[{$eq:[{$mapPalette:"type"},"inbuilt"]},{$mapPalette:"divergingColors"},eo(Hc.SAFE_RANGE2_OPERATION)]},strokeWidth:1,maxStrokeWidth:3,lineDash:[0],lineDashOffset:0,label:{...Hc.LABEL_BOXING_DEFAULTS,enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},highlight:eo(Hc.multiSeriesHighlightStyle())},tooltip:{range:"exact"}},create:e=>new Gu(e)};import{VERSION as YH}from"ag-charts-community";import{_ModuleSupport as UH}from"ag-charts-community";import{Logger as jH}from"ag-charts-core";import{_ModuleSupport as XH}from"ag-charts-community";import{Property as sa}from"ag-charts-core";var{SeriesProperties:ZH,makeSeriesTooltip:qH}=XH,cs=class extends ZH{constructor(){super(...arguments),this.topology=void 0,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.tooltip=qH()}};p([sa],cs.prototype,"topology",2),p([sa],cs.prototype,"stroke",2),p([sa],cs.prototype,"strokeOpacity",2),p([sa],cs.prototype,"strokeWidth",2),p([sa],cs.prototype,"lineDash",2),p([sa],cs.prototype,"lineDashOffset",2),p([sa],cs.prototype,"tooltip",2);var{createDatumId:QH,Group:JH,Selection:eW,PointerEvents:ck}=UH,$u=class extends yr{constructor(e){super({moduleCtx:e,categoryKey:void 0,pickModes:[]}),this.properties=new cs,this._chartTopology=void 0,this.itemGroup=this.contentGroup.appendChild(new JH({name:"itemGroup"})),this.datumSelection=eW.select(this.itemGroup,()=>this.nodeFactory()),this.itemGroup.pointerEvents=ck.None}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get focusable(){return!1}setOptionsData(){}setChartData(){}get hasData(){return!1}renderToOffscreenCanvas(){return!0}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}setZIndex(e){return super.setZIndex(e),this.contentGroup.zIndex=[0,e,0],this.highlightGroup.zIndex=[0,e,1],!0}nodeFactory(){const e=new un;return e.renderMode=2,e.lineJoin="round",e.lineCap="round",e.pointerEvents=ck.None,e}processData(){const{topology:e}=this;this.topologyBounds=e?.features.reduce((t,i)=>{const o=i.geometry;return o==null?t:gn(o,t)},void 0),e==null&&jH.warnOnce("no topology was provided for [MapShapeBackgroundSeries]; nothing will be rendered.")}createNodeData(){const{id:e,topology:t,scale:i,properties:o}=this;if(t==null)return;const{stroke:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,strokeWidth:l}=o,c=[],h=[];for(const[d,u]of t.features.entries()){const{geometry:g}=u,m=g!=null&&i!=null?oa(g,i):void 0;m!=null&&c.push({series:this,itemId:d,datum:u,datumIndex:0,index:d,projectedGeometry:m,style:{stroke:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,strokeWidth:l}})}return{itemId:e,nodeData:c,labelData:h}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){const{datumSelection:e}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.labelGroup.visible=this.visible;const{nodeData:t=[]}=this.contextNodeData??{};this.datumSelection=this.updateDatumSelection({nodeData:t,datumSelection:e}),this.updateDatumNodes({datumSelection:e})}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>QH(t.index))}updateDatumNodes(e){const{datumSelection:t}=e;t.each((i,o)=>{const{projectedGeometry:s}=o;if(s==null){i.visible=!1,i.projectedGeometry=void 0;return}i.visible=!0,i.projectedGeometry=s,i.setProperties(o.style)})}resetAnimation(){}getLegendData(){return[]}getTooltipContent(e){}computeFocusBounds(e){}hasItemStylers(){return!1}};$u.className="MapLineBackgroundSeries",$u.type="map-line-background";import{_ModuleSupport as tW}from"ag-charts-community";import{constant as iW,geoJson as oW,required as sW}from"ag-charts-core";var{mapLineBackgroundSeriesThemeableOptionsDef:aW}=tW,nW={...aW,type:sW(iW("map-line-background")),topology:oW},hk={type:"series",name:"map-line-background",chartType:"topology",enterprise:!0,version:YH,dependencies:[gr],options:nW,themeTemplate:{...mr,series:{stroke:{$path:["/1",{$mapPalette:"stroke"},{$mapPalette:"secondHierarchyColors"}]},strokeWidth:1,lineDash:[0],lineDashOffset:0}},create:e=>new $u(e)};import{VERSION as rW,_ModuleSupport as mn}from"ag-charts-community";import{ValidationError as lW,validate as cW}from"ag-charts-core";import{_ModuleSupport as dk}from"ag-charts-community";import{Logger as hW,LonLatBBox as dW,StateMachine as pW,cachedTextMeasurer as uW,mergeDefaults as pk}from"ag-charts-core";import{insertListItemsSorted as gW}from"ag-charts-core";function uk(e,t,i){const o=pn(e[0],void 0);if(o==null)return;const s=(o.lon0+o.lon1)/2,a=(o.lat0+o.lat1)/2,n=Math.abs(o.lon1-o.lon0),r=Math.abs(o.lat1-o.lat0),l=bH(e[0]),[c,h]=l,d=-Gc(e,c,h);let u;const g=(k,A)=>{const I=Math.max(A-d,0);return k-.5*I},m=(k,A,M)=>{const{distance:I,maxDistance:D}=i(e,k,A,M),L=Math.hypot(c-k,h-A),N=Math.min(Math.max(c,k-M/2),k+M/2),T=Math.min(Math.max(h,A-M/2),A+M/2),O=Math.hypot(c-N,h-T),R=g(I,L),w=g(D,O);return{distance:I,maxDistance:D,value:R,maxValue:w,x:k,y:A,stride:M}},y=(k,A,M,I)=>{const D=m(A,M,I);D.maxDistance>=0&&k.push(D)},S=Math.min(n,r)/2;let x={value:m(s,a,S),next:null};for(;x!=null;){const k=x.value,{distance:A,value:M,maxValue:I,x:D,y:L,stride:N}=k;if(x=x.next,A>0&&(u==null||M>u.value)&&(u=k),u!=null&&I-u.value<=t)continue;const T=N/2,O=[];y(O,D-T,L-T,T),y(O,D+T,L-T,T),y(O,D-T,L+T,T),y(O,D+T,L+T,T),O.sort(gk),x=gW(x,O,gk)}if(u==null)return;const{distance:b,x:f,y:v}=u;return{x:f,y:v,distance:b}}var gk=(e,t)=>t.maxValue-e.maxValue;function Yu(e,t){const i=uk(e,t,(a,n,r,l)=>{const c=-Gc(a,n,r),h=c+l*Math.SQRT2;return{distance:c,maxDistance:h}});if(i==null)return;const{x:o,y:s}=i;return[o,s]}function mk(e,t){let i;switch(e.type){case"GeometryCollection":return e.geometries.flatMap(o=>mk(o,t));case"MultiPoint":return e.coordinates;case"Point":return[e.coordinates];case"MultiPolygon":{const o=Yc(e);i=o==null?void 0:Yu(o,t);break}case"Polygon":{const o=e.coordinates;i=o==null?void 0:Yu(o,t);break}case"MultiLineString":{const o=Uc(e);i=o==null?void 0:Kc(o)?.point;break}case"LineString":{const o=e.coordinates;i=Kc(o)?.point;break}}return i==null?[]:[i]}import{_ModuleSupport as mW}from"ag-charts-community";var{BBox:yW}=mW;function yk(e){if(!e)return;const{range:t}=e,i=t[0][0],o=t[0][1],s=t[1][0]-i,a=t[1][1]-o,n=new yW(i,o,s,a);return{series:n,axis:n}}import{_ModuleSupport as fW}from"ag-charts-community";import{Property as se}from"ag-charts-core";var{SeriesProperties:xW,makeSeriesTooltip:SW,Label:bW}=fW,fk=class extends bW{constructor(){super(...arguments),this.placement="bottom"}};p([se],fk.prototype,"placement",2);var ae=class extends xW{constructor(){super(...arguments),this.topology=void 0,this.idKey=void 0,this.topologyIdKey="name",this.idName=void 0,this.latitudeKey=void 0,this.latitudeName=void 0,this.longitudeKey=void 0,this.longitudeName=void 0,this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.shape="circle",this.size=6,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.label=new fk,this.tooltip=SW()}getStyle(){const{size:e,shape:t,fill:i,fillOpacity:o,stroke:s,strokeWidth:a,strokeOpacity:n,lineDash:r,lineDashOffset:l}=this;return{size:e,shape:t,fill:i,fillOpacity:o,opacity:1,stroke:s,strokeWidth:a,strokeOpacity:n,lineDash:r,lineDashOffset:l}}};p([se],ae.prototype,"topology",2),p([se],ae.prototype,"title",2),p([se],ae.prototype,"legendItemName",2),p([se],ae.prototype,"idKey",2),p([se],ae.prototype,"topologyIdKey",2),p([se],ae.prototype,"idName",2),p([se],ae.prototype,"latitudeKey",2),p([se],ae.prototype,"latitudeName",2),p([se],ae.prototype,"longitudeKey",2),p([se],ae.prototype,"longitudeName",2),p([se],ae.prototype,"labelKey",2),p([se],ae.prototype,"labelName",2),p([se],ae.prototype,"sizeKey",2),p([se],ae.prototype,"sizeName",2),p([se],ae.prototype,"colorKey",2),p([se],ae.prototype,"colorName",2),p([se],ae.prototype,"colorRange",2),p([se],ae.prototype,"shape",2),p([se],ae.prototype,"size",2),p([se],ae.prototype,"maxSize",2),p([se],ae.prototype,"sizeDomain",2),p([se],ae.prototype,"fill",2),p([se],ae.prototype,"fillOpacity",2),p([se],ae.prototype,"stroke",2),p([se],ae.prototype,"strokeWidth",2),p([se],ae.prototype,"strokeOpacity",2),p([se],ae.prototype,"lineDash",2),p([se],ae.prototype,"lineDashOffset",2),p([se],ae.prototype,"itemStyler",2),p([se],ae.prototype,"label",2),p([se],ae.prototype,"tooltip",2);var{fromToMotion:vW,getMissCount:kW,createDatumId:Xc,SeriesNodePickMode:xk,valueProperty:aa,computeMarkerFocusBounds:DW,ColorScale:AW,LinearScale:MW,Group:IW,Selection:Zc,Text:Sk,Marker:Uu,getLabelStyles:LW}=dk,ju=class extends yr{constructor(e){super({moduleCtx:e,categoryKey:void 0,propertyKeys:{size:["colorKey"],color:["colorKey"],label:["labelKey"]},propertyNames:{size:["sizeName"],color:["colorName"],label:["labelName"]},pickModes:[xk.EXACT_SHAPE_MATCH,xk.NEAREST_NODE],usesPlacedLabels:!0}),this.properties=new ae,this._chartTopology=void 0,this.colorScale=new AW,this.sizeScale=new MW,this.markerGroup=this.contentGroup.appendChild(new IW({name:"markerGroup"})),this.labelSelection=Zc.select(this.labelGroup,Sk,!1),this.highlightLabelSelection=Zc.select(this.highlightLabelGroup,Sk,!1),this.markerSelection=Zc.select(this.markerGroup,Uu,!1),this.highlightMarkerSelection=Zc.select(this.highlightNodeGroup,Uu),this.placedLabelData=[],this.animationState=new pW("empty",{empty:{update:{target:"ready",action:()=>this.animateMarkers()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.resetAllAnimation(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateMarkers()},resize:{target:"ready",action:()=>this.resetAllAnimation()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:()=>this.resetAllAnimation()},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){const e=this.properties.latitudeKey!=null&&this.properties.longitudeKey!=null;return super.hasData&&(this.topology!=null||e)}renderToOffscreenCanvas(){return!0}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}setZIndex(e){return super.setZIndex(e),this.contentGroup.zIndex=[2,e],this.highlightGroup.zIndex=[3,e],!0}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}async processData(e){if(this.data==null)return;const{data:t,sizeScale:i,colorScale:o}=this,{topologyIdKey:s,idKey:a,latitudeKey:n,longitudeKey:r,sizeKey:l,colorKey:c,labelKey:h,sizeDomain:d,colorRange:u}=this.properties,g=this.buildFeatureMap(s),m=this.sizeScale.type,y=this.colorScale.type,S=this.scale?.type,x=n!=null&&r!=null,{dataModel:b,processedData:f}=await this.requestDataModel(e,t,{props:[...a==null?[]:[aa(a,S,{id:"idValue",includeProperty:!1}),aa(a,S,{id:"featureValue",includeProperty:!1,processor:()=>M=>g.get(M)})],...x?[aa(n,S,{id:"latValue"}),aa(r,S,{id:"lonValue"})]:[],...h?[aa(h,"category",{id:"labelValue"})]:[],...l?[aa(l,m,{id:"sizeValue"})]:[],...c?[aa(c,y,{id:"colorValue"})]:[]]}),v=a==null?void 0:b.resolveColumnById(this,"featureValue",f),k=x?b.resolveColumnById(this,"latValue",f):void 0,A=x?b.resolveColumnById(this,"lonValue",f):void 0;if(this.topologyBounds=f.dataSources.get(this.id)?.data.reduce((M,I,D)=>{const N=v?.[D]?.geometry;if(N!=null&&(M=gn(N,M)),k!=null&&A!=null){const T=A[D],O=k[D];M=dW.extend(M,T,O,T,O)}return M},void 0),l!=null){const M=b.resolveProcessedDataIndexById(this,"sizeValue"),I=f.domain.values[M]??[];i.domain=d??I}if(u!=null&&this.isColorScaleValid()){const M=b.resolveProcessedDataIndexById(this,"colorValue");o.domain=f.domain.values[M],o.range=u,o.update()}this.animationState.transition("updateData")}isColorScaleValid(){const{colorKey:e}=this.properties;if(!e)return!1;const{dataModel:t,processedData:i}=this;if(!t||!i)return!1;const o=t.resolveProcessedDataIndexById(this,"colorValue"),s=i.input.count,a=kW(this,i.defs.values[o].missing);return!(s===0||s===a)}getLabelDatum(e,t,i){if(t==null)return;const{idKey:o,idName:s,latitudeKey:a,latitudeName:n,longitudeKey:r,longitudeName:l,sizeKey:c,sizeName:h,colorKey:d,colorName:u,labelKey:g,labelName:m,label:y,shape:S}=this.properties;if(g==null||!y.enabled)return;const{datum:x,datumIndex:b,index:f,idValue:v,lonValue:k,latValue:A,point:M}=e,{placement:I}=y,D=this.getLabelText(t,x,g,"label",[],y,{value:t,datum:x,idKey:o,idName:s,latitudeKey:a,latitudeName:n,longitudeKey:r,longitudeName:l,sizeKey:c,sizeName:h,colorKey:d,colorName:u,labelKey:g,labelName:m});if(D==null)return;const{width:L,height:N}=i.measureLines(String(D)),T=Uu.anchor(S);return{point:{x:M.x,y:M.y,size:M.size},label:{width:L,height:N,text:D},anchor:T,placement:I,datumIndex:b,datumId:Xc(f,v,k,A)}}resolveColumn(e,t,i){if(!(e==null||this.dataModel==null))return this.dataModel.resolveColumnById(this,t,i)}resolveDataColumns(e){const{idKey:t,latitudeKey:i,longitudeKey:o,sizeKey:s,colorKey:a,labelKey:n}=this.properties,r=i!=null&&o!=null;return{idValues:this.resolveColumn(t,"idValue",e),featureValues:this.resolveColumn(t,"featureValue",e),latValues:r?this.resolveColumn(i,"latValue",e):void 0,lonValues:r?this.resolveColumn(o,"lonValue",e):void 0,labelValues:this.resolveColumn(n,"labelValue",e),sizeValues:this.resolveColumn(s,"sizeValue",e),colorValues:this.resolveColumn(a,"colorValue",e)}}prepareProjectedGeometries(e,t,i){if(e==null||t==null||this.scale==null)return;const o=new Map;for(const[s]of i.dataSources.get(this.id)?.data.entries()??[]){const a=e[s],n=t[s]?.geometry,r=n==null?void 0:oa(n,this.scale);a!=null&&r!=null&&o.set(a,r)}return o}calculateMarkerSize(e){return e==null?this.properties.size:this.sizeScale.convert(e,{clamp:!0})}buildNodeDatum(e,t,i,o,s){return{series:this,itemId:this.properties.latitudeKey,datum:e,datumIndex:t,index:i,...s,point:o,midPoint:{x:o.x,y:o.y},legendItemName:this.properties.legendItemName,style:this.getMarkerItemStyle({datumIndex:t,datum:e,colorValue:s.colorValue,sizeValue:s.sizeValue},!1)}}createNodeFromLatLon(e,t,i,o,s,a,n){if(this.scale==null)throw new Error("Scale is required for createNodeFromLatLon");const[r,l]=this.scale.convert([i,o]),c={x:r,y:l,size:a},h=this.buildNodeDatum(e,t,-1,c,s),d=this.getLabelDatum(h,s.labelValue,n)??void 0;return{node:h,label:d}}createNodesFromGeometry(e,t,i,o,s,a){const n=[],r=[];for(const[l,[c,h]]of mk(i,1).entries()){const d={x:c,y:h,size:s},u=this.buildNodeDatum(e,t,l,d,o);n.push(u);const g=this.getLabelDatum(u,o.labelValue,a);g&&r.push(g)}return{nodes:n,labels:r}}warnMissingGeometries(e){if(e.length===0)return;const t=10;if(e.length>t){const i=e.length-t;e.length=t,e.push(`(+${i} more)`)}hW.warnOnce("some data items do not have matches in the provided topology",e)}buildFeatureMap(e){const t=new Map;for(const i of this.topology?.features.values()??[]){const o=i.properties?.[e];o!=null&&t.set(o,i)}return t}createNodeData(){const{id:e,dataModel:t,processedData:i,sizeScale:o,properties:s,scale:a}=this,{label:n}=s;if(t==null||i==null||a==null)return;const r=this.resolveDataColumns(i),l=s.maxSize??s.size;o.range=[Math.min(s.size,l),l];const c=uW(n),h=this.prepareProjectedGeometries(r.idValues,r.featureValues,i),d=[],u=[],g=[],m=i.dataSources.get(this.id)?.data??[];for(const[y,S]of m.entries()){const x={idValue:r.idValues?.[y],lonValue:r.lonValues?.[y],latValue:r.latValues?.[y],colorValue:r.colorValues?.[y],sizeValue:r.sizeValues?.[y],labelValue:r.labelValues?.[y]},b=this.calculateMarkerSize(x.sizeValue),f=x.idValue==null?void 0:h?.get(x.idValue);if(x.idValue!=null&&h!=null&&f==null&&g.push(x.idValue),x.lonValue!=null&&x.latValue!=null){const v=this.createNodeFromLatLon(S,y,x.lonValue,x.latValue,x,b,c);d.push(v.node),v.label&&u.push(v.label)}else if(f!=null){const v=this.createNodesFromGeometry(S,y,f,x,b,c);d.push(...v.nodes),u.push(...v.labels)}}return this.warnMissingGeometries(g),{itemId:e,nodeData:d,labelData:u}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}checkScaleChange(){return this.previousScale===this.scale?!1:(this.previousScale=this.scale,!0)}update({seriesRect:e}){const t=this.checkResize(e),i=this.checkScaleChange(),{markerSelection:o,highlightMarkerSelection:s}=this,a=this.ctx.chartService.highlight?.drawingMode??"overlay";this.updateSelections(),this.contentGroup.visible=this.visible,this.labelGroup.visible=this.visible;const n=this.getHighlightedDatum(),r=this.contextNodeData?.nodeData??[];this.markerSelection=this.updateMarkerSelection({markerData:r,markerSelection:o}),this.updateMarkerNodes({markerSelection:o,isHighlight:!1,highlightedDatum:n,drawingMode:"overlay"}),this.highlightMarkerSelection=this.updateMarkerSelection({markerData:n==null?[]:[n],markerSelection:s}),this.updateMarkerNodes({markerSelection:s,isHighlight:!0,highlightedDatum:n,drawingMode:a}),this.updateLabelNodes({labelSelection:this.labelSelection,isHighlight:!1}),this.updateHighlightLabelSelection(n),(i||t)&&this.animationState.transition("resize"),this.animationState.transition("update")}updatePlacedLabelData(e){this.placedLabelData=e,this.labelSelection=this.labelSelection.update(e,t=>{t.pointerEvents=dk.PointerEvents.None}),this.updateLabelNodes({labelSelection:this.labelSelection,isHighlight:!1}),this.updateHighlightLabelSelection()}updateLabelNodes({isHighlight:e,labelSelection:t}){const{properties:i}=this,o=this.ctx.highlightManager?.getActiveHighlight();t.each((s,a)=>{const{x:n,y:r,width:l,height:c,text:h,datum:d}=a,u=LW(this,void 0,i,i.label,e,o),{color:g,fontStyle:m,fontWeight:y,fontSize:S,fontFamily:x}=u;s.visible=!0,s.x=n+l/2,s.y=r+c/2,s.text=h,s.fill=g,s.fontStyle=m,s.fontWeight=y,s.fontSize=S,s.fontFamily=x,s.textAlign="center",s.textBaseline="middle";const b=d?.datumIndex;s.fillOpacity=this.getHighlightStyle(e,b).opacity??1,s.setBoxing(u)})}getHighlightedLabelId(e=this.getHighlightedDatum()){if(e!=null)return Xc(e.index,e.idValue,e.lonValue,e.latValue)}updateHighlightLabelSelection(e=this.getHighlightedDatum()){const t=this.getHighlightedLabelId(e),i=t==null||!this.isLabelEnabled()?[]:this.placedLabelData.filter(o=>o.datum.datumId===t);if(this.highlightLabelSelection=this.highlightLabelSelection.update(i),i.length===0){this.highlightLabelSelection.cleanup(),this.highlightLabelGroup.visible=!1;return}this.highlightLabelGroup.visible=!0,this.updateLabelNodes({labelSelection:this.highlightLabelSelection,isHighlight:!0})}updateMarkerSelection(e){const{markerData:t,markerSelection:i}=e;return i.update(t,void 0,o=>Xc(o.index,o.idValue,o.lonValue,o.latValue))}getMarkerItemStyle({datumIndex:e,datum:t,colorValue:i,sizeValue:o},s){const{properties:a,colorScale:n,sizeScale:r}=this,{colorRange:l,itemStyler:c}=a,h=this.getHighlightStyle(s,e),d=pk(h,a.getStyle());!s&&i!=null&&(d.fill=this.isColorScaleValid()?n.convert(i):l?.[0]??d.fill),o!=null&&(d.size=r.convert(o,{clamp:!0}));let u=d;if(c!=null&&e!=null){const g=this.cachedDatumCallback(Xc(e,s?"highlight":"node"),()=>{const m=this.makeItemStylerParams(t,e,s,u);return this.callWithContext(c,m)});g&&(u=pk(g,d))}return u}makeItemStylerParams(e,t,i,o){const{id:s}=this,a=this.ctx.highlightManager?.getActiveHighlight(),n=this.getHighlightStateString(a,i,t),r=this.filterItemStylerFillParams(o.fill)??o.fill;return{seriesId:s,datum:e,highlightState:n,...o,fill:r}}updateMarkerNodes(e){const{markerSelection:t,isHighlight:i,highlightedDatum:o,drawingMode:s}=e,a=yk(this.scale);t.each((n,r)=>{const{datum:l,point:c}=r,h=this.getMarkerItemStyle(r,i);n.shape=h.shape,n.size=h.size,n.setStyleProperties(h,a),n.x=c.x,n.y=c.y,n.scalingCenterX=c.x,n.scalingCenterY=c.y,n.zIndex=!i&&o!=null&&l===o.datum?1:0,n.drawingMode=s})}isProcessedDataAnimatable(){return!0}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"&&this.animationState.transition("skip")}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),this.ctx.animationManager.skipCurrentBatch(),this.labelSelection.cleanup(),this.markerSelection.cleanup(),this.highlightMarkerSelection.cleanup(),this.highlightLabelSelection.cleanup(),this.highlightLabelGroup.visible=!1,this.placedLabelData=[]}animateMarkers(){const{animationManager:e}=this.ctx,t=MH();vW(this.id,"markers",e,[this.markerSelection,this.highlightMarkerSelection],t)}getLabelData(){return this.isLabelEnabled()?this.contextNodeData?.labelData??[]:[]}pickNodeClosestDatum(e){const{x:t,y:i}=e;let o=1/0,s;for(const a of this.contextNodeData?.nodeData??[]){const{x:n,y:r,size:l}=a.point,c=Math.max(Math.abs(n-t)-l,0),h=Math.max(Math.abs(r-i)-l,0),d=c*c+h*h;d<o&&(o=d,s=a)}return s==null?void 0:{datum:s,distance:Math.sqrt(o)}}legendItemSymbol(e){const{dataModel:t,processedData:i,properties:o}=this,{shape:s,fillOpacity:a,stroke:n,strokeWidth:r,strokeOpacity:l,lineDash:c,lineDashOffset:h}=o;let{fill:d}=o;if(e!=null&&this.isColorScaleValid()){const g=t.resolveColumnById(this,"colorValue",i)[e];d=this.colorScale.convert(g)}return{marker:{shape:s,fill:d,fillOpacity:a,stroke:n,strokeWidth:r,strokeOpacity:l,lineDash:c,lineDashOffset:h}}}getLegendData(e){const{processedData:t,dataModel:i}=this;if(t==null||i==null)return[];const{id:o,visible:s}=this,{title:a,legendItemName:n,idName:r,idKey:l,colorKey:c,colorRange:h,showInLegend:d}=this.properties;if(e==="gradient"&&c!=null&&h!=null){const u=t.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:s,seriesId:o,series:this.getFormatterContext("color"),colorRange:h,colorDomain:u}]}else return e==="category"?[{legendType:"category",id:o,itemId:o,seriesId:o,enabled:s,label:{text:n??a??r??l??o},symbol:this.legendItemSymbol(),legendItemName:n,hideInLegend:!d}]:[]}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,properties:s,ctx:{formatManager:a}}=this,{idKey:n,idName:r,latitudeKey:l,latitudeName:c,longitudeKey:h,longitudeName:d,colorKey:u,colorName:g,sizeKey:m,sizeName:y,labelKey:S,labelName:x,title:b,legendItemName:f,tooltip:v}=s;if(!i||!o)return;const k=o.dataSources.get(this.id)?.data[e],A=m==null?void 0:i.resolveColumnById(this,"sizeValue",o)[e],M=u==null?void 0:i.resolveColumnById(this,"colorValue",o)[e],I=[];if(this.isLabelEnabled()&&S!=null&&S!==n){const N=i.resolveColumnById(this,"labelValue",o)[e],T=a.format(this.callWithContext.bind(this),{type:"category",value:N,datum:k,seriesId:t,legendItemName:f,key:S,source:"tooltip",property:"label",domain:[],boundSeries:this.getFormatterContext("label")});I.push({label:x,fallbackLabel:S,value:T??N})}if(m!=null&&A!=null){const N=i.getDomain(this,"sizeValue","value",o).domain,T=a.format(this.callWithContext.bind(this),{type:"number",value:A,datum:k,seriesId:t,legendItemName:f,key:m,source:"tooltip",property:"size",domain:N,boundSeries:this.getFormatterContext("size"),fractionDigits:void 0});I.push({label:y,fallbackLabel:m,value:T??String(A)})}if(u!=null&&M!=null){const N=i.getDomain(this,"colorValue","value",o).domain,T=a.format(this.callWithContext.bind(this),{type:"number",value:M,datum:k,seriesId:t,legendItemName:f,key:u,source:"tooltip",property:"color",domain:N,boundSeries:this.getFormatterContext("color"),fractionDigits:void 0});I.push({label:g,fallbackLabel:u,value:T??String(M)})}let D;if(n!=null)D=i.resolveColumnById(this,"idValue",o)[e];else if(l!=null&&h!=null){const N=i.resolveColumnById(this,"latValue",o)[e],T=i.resolveColumnById(this,"lonValue",o)[e];D=`${Math.abs(N).toFixed(4)}\xB0 ${N>=0?"N":"S"}, ${Math.abs(T).toFixed(4)}\xB0 ${T>=0?"W":"E"}`}const L=this.getMarkerItemStyle({datumIndex:e,datum:k,colorValue:M,sizeValue:A},!1);return this.formatTooltipWithContext(v,{heading:D,title:b??f,symbol:this.legendItemSymbol(e),data:I},{seriesId:t,datum:k,title:b,idKey:n,idName:r,latitudeKey:l,latitudeName:c,longitudeKey:h,longitudeName:d,colorKey:u,colorName:g,sizeKey:m,sizeName:y,labelKey:S,labelName:x,...L})}getFormattedMarkerStyle(e){const t=this.getMarkerItemStyle(e,!1);return{size:t.size,shape:t.shape}}computeFocusBounds(e){return DW(this,e)}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.label.itemStyler!=null}};ju.className="MapMarkerSeries",ju.type="map-marker";import{_ModuleSupport as NW}from"ag-charts-community";import{commonSeriesOptionsDefs as CW,constant as TW,geoJson as wW,required as PW,string as Tt,without as OW}from"ag-charts-core";var{mapMarkerSeriesThemeableOptionsDef:RW}=NW,EW={...OW(CW,["highlightStyle","highlight"]),...RW,type:PW(TW("map-marker")),idKey:Tt,latitudeKey:Tt,longitudeKey:Tt,sizeKey:Tt,colorKey:Tt,labelKey:Tt,idName:Tt,latitudeName:Tt,longitudeName:Tt,sizeName:Tt,colorName:Tt,labelName:Tt,topology:wW,topologyIdKey:Tt,legendItemName:Tt,title:Tt},bk={type:"series",name:"map-marker",chartType:"topology",enterprise:!0,version:rW,dependencies:[gr],options:EW,themeTemplate:{...mr,series:{shape:"circle",maxSize:30,fill:eo({$applySwitch:[{$path:"type"},{$mapPalette:"fill"},["gradient",mn.FILL_GRADIENT_RADIAL_REVERSED_DEFAULTS],["image",mn.FILL_IMAGE_DEFAULTS],["pattern",mn.FILL_PATTERN_DEFAULTS]]}),stroke:{$mapPalette:"stroke"},colorRange:{$if:[{$eq:[{$mapPalette:"type"},"inbuilt"]},{$mapPalette:"divergingColors"},eo(mn.SAFE_RANGE2_OPERATION)]},fillOpacity:.5,label:{...mn.LABEL_BOXING_DEFAULTS,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},highlight:eo(mn.multiSeriesHighlightStyle())},tooltip:{range:"exact"}},create:e=>new ju(e),validate(e,t,i){const o=cW(e,t,i),{cleared:s,invalid:a}=o;if(s?.idKey==null&&(s?.latitudeKey==null||s?.longitudeKey==null)){const n=l=>i?`${i}.${l}`:l,r=`Either \`${n("idKey")}\` or both \`${n("latitudeKey")}\` and \`${n("longitudeKey")}\` are required.`;a.push(new lW("required",r,null,i))}return o}};import{VERSION as _W,_ModuleSupport as yn}from"ag-charts-community";import{_ModuleSupport as vk}from"ag-charts-community";import{Logger as kk,cachedTextMeasurer as BW,isArray as VW,measureTextSegments as zW,mergeDefaults as Dk,toPlainText as FW}from"ag-charts-core";function HW(e,{aspectRatio:t,precision:i}){const o=uk(e,i,(l,c,h,d)=>{const u=KW(l,c,h,t),g=u+2*d*t,m=u*Math.SQRT2,y=g*Math.SQRT2;return{distance:m,maxDistance:y}});if(o==null)return;const{x:s,y:a,distance:n}=o,r=n/Math.SQRT2;return{x:s,y:a,maxWidth:r}}function WW(e,t,i,o,s){const[a,n]=e,[r,l]=t,c=1/s,h=r-a,d=l-n,[u,g]=n<=l?e:t,[m,y]=a<=r?e:t,[S,x]=n<=l?t:e,[b,f]=a<=r?t:e;let v=1/0;if(h===0)for(let L=0;L<=1;L+=1){const T=(L===0?c:-c)*(a-i)+o;if(T>=g&&T<=x){const R=Math.abs(o-T)*2*s;v=Math.min(v,R)}}else{const L=d/h;for(let N=0;N<=1;N+=1){const T=N===0?c:-c,O=(L*a-n-T*i+o)/(L-T);if(O>=m&&O<=b){const R=Math.abs(i-O)*2;v=Math.min(v,R)}}}const k=s,A=Math.abs((u-i)/(g-o)),M=Math.abs((S-i)/(x-o));if(x<o&&M<k){const N=Math.abs(o-x)*2*s;v=Math.min(v,N)}else if(g>o&&A<k){const N=Math.abs(o-g)*2*s;v=Math.min(v,N)}const I=Math.abs((y-o)/(m-i)),D=Math.abs((f-o)/(b-i));if(b<i&&D<c){const L=Math.abs(i-b)*2;v=Math.min(v,L)}else if(m>i&&I<c){const L=Math.abs(i-m)*2;v=Math.min(v,L)}return v}function KW(e,t,i,o){let s=!1,a=1/0;for(const n of e){let r=n.at(-1),[l,c]=r;for(const h of n){const[d,u]=h;u>i!=c>i&&t<(l-d)*(i-u)/(c-u)+d&&(s=!s);const g=WW(r,h,t,i,o);a=Math.min(a,g),r=h,l=d,c=u}}return(s?1:-1)*a}function qc(e,t,i){i>=t&&(e.maxX=Math.min(e.maxX,i-t)),i<=t&&(e.minX=Math.max(e.minX,i-t))}function GW(e,t,i,o,s,a){const n=s-a/2,r=s+a/2,[l,c]=t,[h,d]=i,u=h-l,g=d-c,[m,y]=l<=h?t:i,[S,x]=l<=h?i:t;if(u!==0){const b=g/u;for(let f=0;f<=1;f+=1){const k=((f===0?n:r)-c)/b+l;k>=m&&k<=S&&qc(e,o,k)}}else Math.max(n,Math.min(c,d))<=Math.min(r,Math.max(c,d))&&qc(e,o,l);return S<o&&x>=n&&x<=r?qc(e,o,S):m>o&&y>=n&&y<=r&&qc(e,o,m),e}function $W(e,t,i,o){const s={minX:-1/0,maxX:1/0};for(const r of e){let l=r.at(-1);for(const c of r)GW(s,l,c,t,i,o),l=c}const{minX:a,maxX:n}=s;return Number.isFinite(a)&&Number.isFinite(n)?{x:t+(a+n)/2,width:n-a}:{x:t,width:0}}import{_ModuleSupport as YW}from"ag-charts-community";import{Property as Pe}from"ag-charts-core";var{SeriesProperties:UW,makeSeriesTooltip:jW}=YW,Ie=class extends UW{constructor(){super(...arguments),this.topology=void 0,this.idKey="",this.idName=void 0,this.topologyIdKey="name",this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.padding=0,this.label=new Xl,this.tooltip=jW()}getStyle(){const{fill:e,fillOpacity:t,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}=this;return{fill:e,fillOpacity:t,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,opacity:1}}};p([Pe],Ie.prototype,"topology",2),p([Pe],Ie.prototype,"title",2),p([Pe],Ie.prototype,"legendItemName",2),p([Pe],Ie.prototype,"idKey",2),p([Pe],Ie.prototype,"idName",2),p([Pe],Ie.prototype,"topologyIdKey",2),p([Pe],Ie.prototype,"labelKey",2),p([Pe],Ie.prototype,"labelName",2),p([Pe],Ie.prototype,"colorKey",2),p([Pe],Ie.prototype,"colorName",2),p([Pe],Ie.prototype,"colorRange",2),p([Pe],Ie.prototype,"fill",2),p([Pe],Ie.prototype,"fillOpacity",2),p([Pe],Ie.prototype,"stroke",2),p([Pe],Ie.prototype,"strokeOpacity",2),p([Pe],Ie.prototype,"strokeWidth",2),p([Pe],Ie.prototype,"lineDash",2),p([Pe],Ie.prototype,"lineDashOffset",2),p([Pe],Ie.prototype,"padding",2),p([Pe],Ie.prototype,"itemStyler",2),p([Pe],Ie.prototype,"label",2),p([Pe],Ie.prototype,"tooltip",2);var{getMissCount:XW,createDatumId:Qc,SeriesNodePickMode:Ak,valueProperty:Jc,ColorScale:ZW,Group:Mk,Selection:eh,Text:Ik,PointerEvents:qW,getLabelStyles:QW}=vk,Lk=vk.MercatorScale.fixedScale(),Xu=class extends yr{constructor(e){super({moduleCtx:e,categoryKey:void 0,propertyKeys:{color:["colorKey"],label:["labelKey"]},propertyNames:{color:["colorName"],label:["labelName"]},pickModes:[Ak.EXACT_SHAPE_MATCH,Ak.NEAREST_NODE]}),this.properties=new Ie,this._chartTopology=void 0,this.colorScale=new ZW,this.itemGroup=this.contentGroup.appendChild(new Mk({name:"itemGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new Mk({name:"itemLabelGroup"})),this.datumSelection=eh.select(this.itemGroup,()=>this.nodeFactory()),this.labelSelection=eh.select(this.itemLabelGroup,Ik),this.highlightDatumSelection=eh.select(this.highlightNodeGroup,()=>this.nodeFactory()),this.highlightLabelSelection=eh.select(this.highlightLabelGroup,Ik),this.previousLabelLayouts=void 0,this._previousDatumMidPoint=void 0,this.itemLabelGroup.pointerEvents=qW.None}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){return super.hasData&&this.topology!=null}renderToOffscreenCanvas(){return!0}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}setZIndex(e){return super.setZIndex(e),this.contentGroup.zIndex=[1,e],this.highlightGroup.zIndex=[4,e],!0}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}nodeFactory(){const e=new un;return e.renderMode=1,e.lineJoin="round",e}async processData(e){if(this.data==null)return;const{data:t,topology:i,colorScale:o}=this,{topologyIdKey:s,idKey:a,colorKey:n,labelKey:r,colorRange:l}=this.properties,c=new Map;for(const y of i?.features.values()??[]){const S=y.properties?.[s];S==null||!Hu(y.geometry,1)||c.set(S,y)}const h=this.colorScale.type,d=this.scale?.type,{dataModel:u,processedData:g}=await this.requestDataModel(e,t,{props:[Jc(a,d,{id:"idValue",includeProperty:!1}),Jc(a,d,{id:"featureValue",includeProperty:!1,processor:()=>y=>c.get(y)}),...r?[Jc(r,"category",{id:"labelValue"})]:[],...n?[Jc(n,h,{id:"colorValue"})]:[]]}),m=u.resolveColumnById(this,"featureValue",g);if(this.topologyBounds=m.reduce((y,S)=>{const x=S?.geometry;return x==null?y:gn(x,y)},void 0),l!=null&&this.isColorScaleValid()){const y=u.resolveProcessedDataIndexById(this,"colorValue");o.domain=g.domain.values[y],o.range=l,o.update()}i==null&&kk.warnOnce("no topology was provided for [MapShapeSeries]; nothing will be rendered.")}isColorScaleValid(){const{colorKey:e}=this.properties;if(!e)return!1;const{dataModel:t,processedData:i}=this;if(!t||!i)return!1;const o=t.resolveProcessedDataIndexById(this,"colorValue"),s=i.input.count,a=XW(this,i.defs.values[o].missing);return!(s===0||s===a)}getLabelLayout(e,t,i,o,s){if(t==null||o==null)return;const{idKey:a,idName:n,colorKey:r,colorName:l,labelKey:c,labelName:h,padding:d,label:u}=this.properties;if(c==null||!u.enabled)return;const g=this.getLabelText(t,e,c,"label",[],u,{value:t,datum:e,idKey:a,idName:n,colorKey:r,colorName:l,labelKey:c,labelName:h});if(g==null)return;const m=VW(g)?zW(g,u):i.measureLines(String(g)),y=(m.width+2*d)/(m.height+2*d);if(s?.geometry===o&&s?.labelText===g&&s?.aspectRatio===y)return s;const S=oa(o,Lk),x=Yc(S);if(x==null)return;const b=HW(x,{aspectRatio:y,precision:.001});if(b==null)return;const{x:f,y:v,maxWidth:k}=b;return{geometry:o,labelText:g,aspectRatio:y,x:f,y:v,maxWidth:k,fixedPolygon:x}}getLabelDatum(e,t,i,o){const{scale:s}=this;if(s==null)return;const{padding:a,label:n}=this.properties,{labelText:r,aspectRatio:l,x:c,y:h,maxWidth:d,fixedPolygon:u}=e,g={width:Math.ceil(d*t),height:Math.ceil(d*t/l),meta:c},m=Jn(FW(r),n,{padding:a},(A,M)=>{if(!M)return g;const I=$W(u,c,h,A/t);return{width:I.width*t,height:A,meta:I.x}});if(m==null)return;const[{text:y,fontSize:S,lineHeight:x,width:b},f]=m,v=b<g.width?c:f,k=this.scale.convert(Lk.invert([v,h]));return{x:k[0],y:k[1],text:y,fontSize:S,lineHeight:x,datumIndex:i,idValue:o,datumId:Qc(o)}}resolveColumn(e,t,i){if(!(e==null||this.dataModel==null))return this.dataModel.resolveColumnById(this,t,i)}resolveShapeDataColumns(e){const{colorKey:t,labelKey:i}=this.properties;return{idValues:this.dataModel.resolveColumnById(this,"idValue",e),featureValues:this.dataModel.resolveColumnById(this,"featureValue",e),labelValues:this.resolveColumn(i,"labelValue",e),colorValues:this.resolveColumn(t,"colorValue",e)}}warnMissingGeometries(e){if(e.length===0)return;const t=10;if(e.length>t){const i=e.length-t;e.length=t,e.push(`(+${i} more)`)}kk.warnOnce("some data items do not have matches in the provided topology",e)}createNodeData(){const{id:e,dataModel:t,processedData:i,properties:o,scale:s,previousLabelLayouts:a}=this,{idKey:n,label:r,legendItemName:l,colorKey:c}=o;if(t==null||i==null)return;const h=s==null?Number.NaN:(s.range[1][0]-s.range[0][0])/s.bounds.width,d=this.resolveShapeDataColumns(i),u=BW(r),g=new Map;this.previousLabelLayouts=g;const m=[],y=[],S=[],x=i.dataSources.get(this.id)?.data??[];for(const[b,f]of x.entries()){const v={idValue:d.idValues[b],colorValue:d.colorValues?.[b],labelValue:d.labelValues?.[b]},k=d.featureValues[b]?.geometry??void 0;if(k==null&&S.push(v.idValue),c!=null&&v.colorValue==null)continue;const A=this.getLabelLayout(f,v.labelValue,u,k,a?.get(v.idValue));A!=null&&g.set(v.idValue,A);const M=A!=null&&s!=null?this.getLabelDatum(A,h,b,v.idValue):void 0;M!=null&&y.push(M);const I=k!=null&&s!=null?oa(k,s):void 0;m.push({series:this,itemId:n,datum:f,datumIndex:b,...v,projectedGeometry:I,legendItemName:l,style:this.getItemStyle({datum:f,datumIndex:b,colorValue:v.colorValue},!1)})}return this.warnMissingGeometries(S),{itemId:e,nodeData:m,labelData:y}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){const{datumSelection:e,labelSelection:t,highlightDatumSelection:i}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.labelGroup.visible=this.visible;const o=this.ctx.chartService.highlight?.drawingMode??"overlay",s=this.getHighlightedDatum(),a=this.contextNodeData?.nodeData??[],n=this.contextNodeData?.labelData??[];this.datumSelection=this.updateDatumSelection({nodeData:a,datumSelection:e}),this.updateDatumStyles({datumSelection:e,isHighlight:!1}),this.updateDatumNodes({datumSelection:e,drawingMode:"overlay"}),this.labelSelection=this.updateLabelSelection({labelData:n,labelSelection:t});const r=this.getHighlightLabelData(n,s);this.highlightLabelSelection=this.updateLabelSelection({labelData:r,labelSelection:this.highlightLabelSelection}),this.updateLabelNodes({labelSelection:this.labelSelection,isHighlight:!1}),this.updateLabelNodes({labelSelection:this.highlightLabelSelection,isHighlight:!0}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:s==null?[]:[s],datumSelection:i}),this.updateDatumStyles({datumSelection:i,isHighlight:!0}),this.updateDatumNodes({datumSelection:i,drawingMode:o})}getHighlightLabelData(e,t){if(e.length===0)return[];const i=Qc(t?.idValue);return e.filter(o=>o.datumId===i&&o.datumIndex===t?.datumIndex)}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>Qc(t.idValue))}getItemStyle({datumIndex:e,datum:t,colorValue:i},o){const{properties:s,colorScale:a}=this,{colorRange:n,itemStyler:r}=s,l=s.getStyle();if(i!=null){const d=this.isColorScaleValid()?a.convert(i):n?.[0];d!=null&&(l.fill=d)}const c=this.getHighlightStyle(o,e);let h=Dk(c,l);if(r!=null&&e!=null){const d=this.cachedDatumCallback(Qc(e,o?"highlight":"node"),()=>{const u=this.makeItemStylerParams(t,e,o,h);return this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],this.callWithContext(r,u))});d&&(h=Dk(d,h))}return h}makeItemStylerParams(e,t,i,o){const{id:s}=this,a=this.ctx.highlightManager?.getActiveHighlight(),n=this.getHighlightStateString(a,i,t),r=this.filterItemStylerFillParams(o.fill)??o.fill;return{seriesId:s,datum:e,highlightState:n,...o,fill:r}}updateDatumStyles({datumSelection:e,isHighlight:t}){e.each((i,o)=>{o.style=this.getItemStyle(o,t)})}updateDatumNodes({datumSelection:e,drawingMode:t}){const i=yk(this.scale);e.each((o,s)=>{const{projectedGeometry:a}=s;if(a==null){o.visible=!1,o.projectedGeometry=void 0;return}o.visible=!0,o.projectedGeometry=a,o.setStyleProperties(s.style,i),o.drawingMode=t})}updateLabelSelection(e){const t=this.isLabelEnabled()?e.labelData:[];return e.labelSelection.update(t)}updateLabelNodes({isHighlight:e,labelSelection:t}){const{properties:i}=this,o=this.ctx.highlightManager?.getActiveHighlight();t.each((s,a)=>{const{x:n,y:r,text:l,fontSize:c,lineHeight:h,datumIndex:d}=a,u=QW(this,void 0,i,i.label,e,o),{color:g,fontStyle:m,fontWeight:y,fontFamily:S}=u;s.visible=!0,s.x=n,s.y=r,s.text=l,s.fill=g,s.fontStyle=m,s.fontWeight=y,s.fontSize=c,s.lineHeight=h,s.fontFamily=S,s.textAlign="center",s.textBaseline="middle",s.fillOpacity=this.getHighlightStyle(e,d).opacity??1,s.setBoxing(u)})}resetAnimation(){}pickNodeClosestDatum({x:e,y:t}){let i=1/0,o;return this.datumSelection.each((s,a)=>{const n=s.distanceSquared(e,t);n<i&&(i=n,o=a)}),o==null?void 0:{datum:o,distance:Math.sqrt(i)}}datumMidPoint(e){const{_previousDatumMidPoint:t}=this;if(t?.datum===e)return t.point;const i=e.projectedGeometry,o=i==null?void 0:Yc(i),s=o==null?void 0:Yu(o,2),a=s==null?void 0:{x:s[0],y:s[1]};return this._previousDatumMidPoint={datum:e,point:a},a}legendItemSymbol(e){const{dataModel:t,processedData:i,properties:o}=this,{fillOpacity:s,stroke:a,strokeWidth:n,strokeOpacity:r,lineDash:l,lineDashOffset:c}=o;let{fill:h}=o;if(e!=null&&this.isColorScaleValid()){const u=t.resolveColumnById(this,"colorValue",i)[e];u!=null&&(h=this.colorScale.convert(u))}return{marker:{fill:h,fillOpacity:s,stroke:a,strokeWidth:n,strokeOpacity:r,lineDash:l,lineDashOffset:c}}}getLegendData(e){const{processedData:t,dataModel:i}=this;if(t==null||i==null)return[];const{id:o,visible:s}=this,{title:a,legendItemName:n,idKey:r,idName:l,colorKey:c,colorRange:h,showInLegend:d}=this.properties;if(e==="gradient"&&c!=null&&h!=null){const u=t.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:s,seriesId:o,series:this.getFormatterContext("color"),colorRange:h,colorDomain:u}]}else return e==="category"?[{legendType:"category",id:o,itemId:o,seriesId:o,enabled:s,label:{text:n??a??l??r},symbol:this.legendItemSymbol(),legendItemName:n,hideInLegend:!d}]:[]}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,properties:s,ctx:{formatManager:a}}=this,{idKey:n,idName:r,colorKey:l,colorName:c,labelKey:h,labelName:d,legendItemName:u,title:g,tooltip:m}=s;if(!i||!o)return;const y=o.dataSources.get(this.id)?.data[e],S=i.resolveColumnById(this,"idValue",o)[e],x=l==null?void 0:i.resolveColumnById(this,"colorValue",o)[e];if(l!=null&&x==null)return;const b=[];if(this.isLabelEnabled()&&h!=null&&h!==n){const v=i.resolveColumnById(this,"labelValue",o)[e],k=a.format(this.callWithContext.bind(this),{type:"category",value:v,datum:y,seriesId:t,legendItemName:u,key:h,source:"tooltip",property:"label",domain:[],boundSeries:this.getFormatterContext("label")});b.push({label:d,fallbackLabel:h,value:k??v})}if(x!=null){const v=i.getDomain(this,"colorValue","value",o).domain,k=a.format(this.callWithContext.bind(this),{type:"number",value:x,datum:y,seriesId:t,legendItemName:u,key:l,source:"tooltip",property:"color",domain:v,boundSeries:this.getFormatterContext("color"),fractionDigits:void 0});b.push({label:c,fallbackLabel:l,value:k??String(x)})}const f=this.getItemStyle({datum:y,datumIndex:e,colorValue:x},!1);return this.formatTooltipWithContext(m,{heading:S,title:g??u,symbol:this.legendItemSymbol(e),data:b},{seriesId:t,datum:y,title:g,idKey:n,idName:r,colorKey:l,colorName:c,labelKey:h,labelName:d,...f})}computeFocusBounds(e){return tk(this,e)}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.label.itemStyler!=null}};Xu.className="MapShapeSeries",Xu.type="map-shape";import{_ModuleSupport as JW}from"ag-charts-community";import{commonSeriesOptionsDefs as eK,constant as tK,geoJson as iK,required as Nk,string as Io,without as oK}from"ag-charts-core";var{mapShapeSeriesThemeableOptionsDef:sK}=JW,aK={...oK(eK,["highlightStyle","highlight"]),...sK,type:Nk(tK("map-shape")),idKey:Nk(Io),colorKey:Io,labelKey:Io,idName:Io,colorName:Io,labelName:Io,topology:iK,topologyIdKey:Io,legendItemName:Io,title:Io},Ck={type:"series",name:"map-shape",chartType:"topology",enterprise:!0,version:_W,dependencies:[gr],options:aK,themeTemplate:{...mr,series:{fill:eo({$applySwitch:[{$path:"type"},{$mapPalette:"fill"},["gradient",yn.FILL_GRADIENT_LINEAR_DEFAULTS],["image",yn.FILL_IMAGE_DEFAULTS],["pattern",yn.FILL_PATTERN_DEFAULTS]]}),stroke:{$ref:"chartBackgroundColor"},colorRange:{$if:[{$eq:[{$mapPalette:"type"},"inbuilt"]},{$mapPalette:"divergingColors"},eo(yn.SAFE_RANGE2_OPERATION)]},fillOpacity:1,strokeWidth:1,lineDash:[0],lineDashOffset:0,padding:2,label:{...yn.LABEL_BOXING_DEFAULTS,enabled:!0,color:{$ref:"chartBackgroundColor"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:"bold",overflowStrategy:"hide"},highlight:eo(yn.multiSeriesHighlightStyle())},tooltip:{range:"exact"}},create:e=>new Xu(e)};import{VERSION as nK,_ModuleSupport as Zu}from"ag-charts-community";import{_ModuleSupport as rK}from"ag-charts-community";import{Logger as lK}from"ag-charts-core";import{_ModuleSupport as cK}from"ag-charts-community";import{Property as Lo}from"ag-charts-core";var{SeriesProperties:hK,makeSeriesTooltip:dK}=cK,to=class extends hK{constructor(){super(...arguments),this.topology=void 0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.tooltip=dK()}};p([Lo],to.prototype,"topology",2),p([Lo],to.prototype,"fill",2),p([Lo],to.prototype,"fillOpacity",2),p([Lo],to.prototype,"stroke",2),p([Lo],to.prototype,"strokeOpacity",2),p([Lo],to.prototype,"strokeWidth",2),p([Lo],to.prototype,"lineDash",2),p([Lo],to.prototype,"lineDashOffset",2),p([Lo],to.prototype,"tooltip",2);var{createDatumId:pK,Selection:uK,Group:gK,PointerEvents:Tk}=rK,qu=class extends yr{constructor(e){super({moduleCtx:e,categoryKey:void 0,pickModes:[]}),this.properties=new to,this._chartTopology=void 0,this.itemGroup=this.contentGroup.appendChild(new gK({name:"itemGroup"})),this.datumSelection=uK.select(this.itemGroup,()=>this.nodeFactory()),this.itemGroup.pointerEvents=Tk.None}get topology(){return this.properties.topology??this._chartTopology}get focusable(){return!1}setOptionsData(){}setChartData(){}getNodeData(){}get hasData(){return!1}renderToOffscreenCanvas(){return!0}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}setZIndex(e){return super.setZIndex(e),this.contentGroup.zIndex=[0,e,0],this.highlightGroup.zIndex=[0,e,1],!0}nodeFactory(){const e=new un;return e.renderMode=1,e.lineJoin="round",e.pointerEvents=Tk.None,e}processData(){const{topology:e}=this;this.topologyBounds=e?.features.reduce((t,i)=>{const o=i.geometry;return o==null?t:gn(o,t)},void 0),e==null&&lK.warnOnce("no topology was provided for [MapShapeBackgroundSeries]; nothing will be rendered.")}createNodeData(){const{id:e,topology:t,scale:i,properties:o}=this;if(t==null)return;const{fill:s,fillOpacity:a,stroke:n,strokeWidth:r,strokeOpacity:l,lineDash:c,lineDashOffset:h}=o,d=[],u=[];for(const[g,m]of t.features.entries()){const{geometry:y}=m,S=y!=null&&i!=null?oa(y,i):void 0;S!=null&&d.push({series:this,itemId:g,datum:m,datumIndex:0,index:g,projectedGeometry:S,style:{fill:s,fillOpacity:a,stroke:n,strokeWidth:r,strokeOpacity:l,lineDash:c,lineDashOffset:h}})}return{itemId:e,nodeData:d,labelData:u}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){const{datumSelection:e}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.labelGroup.visible=this.visible;const{nodeData:t=[]}=this.contextNodeData??{};this.datumSelection=this.updateDatumSelection({nodeData:t,datumSelection:e}),this.updateDatumNodes({datumSelection:e})}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>pK(t.index))}updateDatumNodes(e){const{datumSelection:t}=e;t.each((i,o)=>{const{projectedGeometry:s}=o;if(s==null){i.visible=!1,i.projectedGeometry=void 0;return}i.visible=!0,i.projectedGeometry=s,i.setProperties(o.style)})}resetAnimation(){}getLegendData(){return[]}getTooltipContent(e){}pickFocus(){}computeFocusBounds(e){}hasItemStylers(){return!1}};qu.className="MapShapeBackgroundSeries",qu.type="map-shape-background";import{_ModuleSupport as mK}from"ag-charts-community";import{commonSeriesOptionsDefs as yK,constant as fK,geoJson as xK,required as SK}from"ag-charts-core";var{mapShapeBackgroundSeriesThemeableOptionsDef:bK}=mK,vK={...bK,...yK,type:SK(fK("map-shape-background")),topology:xK},wk={type:"series",name:"map-shape-background",chartType:"topology",enterprise:!0,version:nK,dependencies:[gr],options:vK,themeTemplate:{...mr,series:{fill:eo({$applySwitch:[{$path:"type"},{$path:["/1",{$mapPalette:"fill"},{$mapPalette:"hierarchyColors"}]},["gradient",Zu.FILL_GRADIENT_LINEAR_HIERARCHY_DEFAULTS],["image",Zu.FILL_IMAGE_DEFAULTS],["pattern",Zu.FILL_PATTERN_HIERARCHY_DEFAULTS]]}),stroke:{$ref:"chartBackgroundColor"},strokeWidth:1}},create:e=>new qu(e)};import{PolarChartModule as kK,VERSION as DK}from"ag-charts-community";import{ChartAxisDirection as Pk,POLAR_AXIS_TYPE as Ok}from"ag-charts-core";import{_ModuleSupport as AK}from"ag-charts-community";import{PolarZIndexMap as Qu}from"ag-charts-core";import{_ModuleSupport as xr}from"ag-charts-community";import{ChartAxisDirection as io,isDefined as MK,isGradientFill as Rk,normalizeAngle360 as Ek}from"ag-charts-core";import{_ModuleSupport as _k}from"ag-charts-community";import{mergeDefaults as Bk}from"ag-charts-core";var{createDatumId:IK,toHighlightString:LK}=_k;function NK(e,t){const{id:i}=e,{angleKey:o,cornerRadius:s,fill:a,fillOpacity:n,lineDash:r,lineDashOffset:l,radiusKey:c,stackGroup:h,stroke:d,strokeOpacity:u,strokeWidth:g}=e.properties,m=LK(t??_k.HighlightState.None);return{angleKey:o,cornerRadius:s,fill:a,fillOpacity:n,highlightState:m,lineDash:r,lineDashOffset:l,radiusKey:c,seriesId:i,stackGroup:h,stroke:d,strokeOpacity:u,strokeWidth:g}}function Ju(e,t,i){const{styler:o}=e.properties;let s={};if(!t&&o){const a=NK(e,i);s=e.ctx.optionsGraphService.resolvePartial(["series",`${e.declarationOrder}`],e.cachedCallWithContext(o,a)??{},{pick:!1})??{}}return{cornerRadius:s.cornerRadius??e.properties.cornerRadius,fill:s.fill??e.properties.fill,fillOpacity:s.fillOpacity??e.properties.fillOpacity,lineDash:s.lineDash??e.properties.lineDash,lineDashOffset:s.lineDashOffset??e.properties.lineDashOffset,stroke:s.stroke??e.properties.stroke,strokeOpacity:s.strokeOpacity??e.properties.strokeOpacity,strokeWidth:s.strokeWidth??e.properties.strokeWidth,opacity:1}}function CK(e,t,i,o){const{id:s,properties:a}=e,{angleKey:n,radiusKey:r}=a,l=e.ctx.highlightManager?.getActiveHighlight(),c=e.getHighlightStateString(l,i,t.datumIndex),h=e.filterItemStylerFillParams(o.fill)??o.fill;return{seriesId:s,datum:t.datum,highlightState:c,angleKey:n,radiusKey:r,...o,fill:h}}function fn(e,t,i,o){const{properties:s}=e,{itemStyler:a}=s,n=e.getHighlightStyle(i,t?.datumIndex,o);let l=Bk(n,Ju(e,t===void 0,o));if(a!=null&&t!=null){const c=e.cachedDatumCallback(IK(e.getDatumId(t),i?"highlight":"node"),()=>{const h=CK(e,t,i,l);return e.callWithContext(a,h)});c&&(l=Bk(c,l))}return l}var{DEFAULT_POLAR_DIRECTION_KEYS:TK,DEFAULT_POLAR_DIRECTION_NAMES:wK,PolarAxis:PK,diff:OK,fixNumericExtent:RK,groupAccumulativeValueProperty:Vk,keyProperty:EK,normaliseGroupTo:_K,resetLabelFn:BK,seriesLabelFadeInAnimation:VK,seriesLabelFadeOutAnimation:zK,valueProperty:FK,animationValidation:HK,createDatumId:WK,SeriesNodePickMode:zk,CategoryScale:KK,motion:Fk,updateLabelNode:Hk,getItemStyles:GK}=xr,$K=class extends xr.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},Wk=class extends xr.PolarSeries{constructor(e,{animationResetFns:t}){super({moduleCtx:e,categoryKey:"angleValue",propertyKeys:TK,propertyNames:wK,canHaveAxes:!0,pickModes:[zk.NEAREST_NODE,zk.EXACT_SHAPE_MATCH],animationResetFns:{...t,label:BK}}),this.NodeEvent=$K,this.groupScale=new KK,this.circleCache={r:0,cx:0,cy:0}}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;if(!i||!t)return{domain:[]};if(e===io.Angle)return t.getDomain(this,"angleValue","key",i);{const o=t.getDomain(this,"radiusValue-end","value",i).domain,s=Number.isFinite(o[1]-o[0])?[Math.min(o[0],0),Math.max(o[1],0)]:[];return{domain:RK(s)}}}async processData(e){const{angleKey:t,radiusKey:i,normalizedTo:o}=this.properties,s=!this.ctx.animationManager.isSkipped(),a=this.getStackId(),n=`${a}-trailing`,r=[];MK(o)&&r.push(_K([a,n],Math.abs(o))),this.needsDataModelDiff()&&this.processedData&&r.push(OK(this.id,this.processedData)),s&&r.push(HK());const l=this.visible?{}:{forceValue:0},c=this.axes[io.Radius]?.scale.type,h=this.axes[io.Angle]?.scale.type;await this.requestDataModel(e,this.data,{props:[EK(t,h,{id:"angleValue"}),FK(i,c,{id:"radiusValue-raw",invalidValue:null,...l}),...Vk(i,"normal",{id:"radiusValue-end",rangeId:"radiusValue-range",invalidValue:null,groupId:a,separateNegative:!0,...l},c),...Vk(i,"trailing",{id:"radiusValue-start",invalidValue:null,groupId:n,separateNegative:!0,...l},c),...r],groupByKeys:!0,groupByData:!1}),this.animationState.transition("updateData")}didCircleChange(){const e=this.radius,t=this.centerX,i=this.centerY,o=this.circleCache;return e!==o.r||t!==o.cx||i!==o.cy?(this.circleCache={r:e,cx:t,cy:i},!0):!1}isRadiusAxisReversed(){return this.axes[io.Radius]?.isReversed()}maybeRefreshNodeData(){!this.didCircleChange()&&!this.nodeDataRefresh||(this.contextNodeData=this.createNodeData(),this.nodeData=this.contextNodeData?.nodeData??[],this.nodeDataRefresh=!1)}getAxisInnerRadius(){const e=this.axes[io.Radius];return e instanceof PK?this.radius*e.innerRadiusRatio:0}createNodeData(){const{processedData:e,dataModel:t,groupScale:i}=this;if(!t||!e||e.type!=="grouped")return;const o=this.axes[io.Angle],s=this.axes[io.Radius],a=o?.scale,n=s?.scale;if(!a||!n)return;const r=t.resolveKeysById(this,"angleValue",e),l=t.resolveColumnById(this,"radiusValue-start",e),c=t.resolveColumnById(this,"radiusValue-end",e),h=t.resolveColumnById(this,"radiusValue-raw",e);let d=0,u=0;o instanceof bs&&(d=o.groupPaddingInner,u=o.paddingInner);const m=(a.bandwidth??0)*(1-u),{index:y,visibleGroupCount:S}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);i.domain=Array.from({length:S}).map((P,C)=>String(C)),i.range=[-m/2,m/2],i.paddingInner=S>1?d:0;const x=this.isRadiusAxisReversed(),b=this.getAxisInnerRadius(),f=this.radius,v=f+b,{angleKey:k,radiusKey:A,angleName:M,radiusName:I,legendItemName:D,label:L}=this.properties,N=this.getSeriesDomain(io.Radius).domain,T=(P,C,_,V)=>{const z=this.getLabelText(C,P,A,"radius",N,L,{value:C,datum:P,angleKey:k,radiusKey:A,angleName:M,radiusName:I,legendItemName:D});if(z)return{x:_,y:V,text:z,textAlign:"center",textBaseline:"middle"}},O=[],R=GK((P,C,_)=>fn(this,P,C,_)),w={itemId:A,nodeData:O,labelData:O,styles:R};if(!this.visible)return w;const{dataSources:E}=e,B=E.get(this.id)?.data??[];for(const{datumIndex:P}of t.forEachGroupDatum(this,e)){const C=B[P],_=r[P];if(_==null)return;const V=h[P],z=V>=0&&!Object.is(V,-0),F=l[P],G=c[P],Y=z===x;if(F===void 0||G===void 0)return;let K,U,ee;if(B.length===1)K=-.5*Math.PI,U=1.5*Math.PI,ee=K;else{const Q=a.convert(_);K=Ek(Q+i.convert(String(y))),U=Ek(K+i.bandwidth),ee=K+i.bandwidth/2}const re=v-n.convert(F),ye=v-n.convert(G),le=(re+ye)/2,ie=Math.cos(ee)*le,ce=Math.sin(ee)*le,pe=this.properties.label.enabled?T(C,V,ie,ce):void 0,he=this.getColumnWidth(K,U);O.push({series:this,datum:C,datumIndex:P,point:{x:ie,y:ce,size:0},midPoint:{x:ie,y:ce},label:pe,angleValue:_,radiusValue:V,negative:Y,innerRadius:re,outerRadius:ye,stackInnerRadius:re,stackOuterRadius:ye,startAngle:K,endAngle:U,midAngle:ee,axisInnerRadius:b,axisOuterRadius:f,columnWidth:he,index:P})}return{itemId:A,nodeData:O,labelData:O,styles:R}}getColumnWidth(e,t){return Number.NaN}update({seriesRect:e}){const t=this.checkResize(e);this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updateSectorSelection(this.itemSelection,!1),this.updateSectorSelection(this.highlightSelection,!0),this.updateLabels(),t&&this.animationState.transition("resize"),this.animationState.transition("update")}updateSectorSelection(e,t){const{contextNodeData:i}=this;if(!i)return;const o=this.ctx.highlightManager.getActiveHighlight();let s=[];const a=this.ctx.highlightManager?.getActiveHighlight();t?a?.datum&&a.series===this&&s.push(a):s=this.nodeData;const n=this.isRadiusAxisReversed(),r=n?this.radius:this.getAxisInnerRadius(),l=n?this.getAxisInnerRadius():this.radius,c=this.getShapeFillBBox(),h=this.hasItemStylers();e.update(s,void 0,d=>this.getDatumId(d)).each((d,u)=>{const{midPoint:g}=u;if(h){const b=this.getHighlightState(a,t,u.datumIndex);u.style=fn(this,u,t,b)}const m=u.style??i.styles[this.getHighlightState(o,t,u.datumIndex)],y=m.fill,x=Rk(y)&&y.bounds==="item"?{centerX:g?.x??0,centerY:g?.y??0}:{centerX:0,centerY:0,innerRadius:r,outerRadius:l};this.updateItemPath(d,u,t),d.setStyleProperties(m,c,x),d.cornerRadius=m.cornerRadius??0,d.lineJoin="round"})}updateLabels(){const e=this.ctx.highlightManager?.getActiveHighlight(),t=e?.series===this&&e?.datum?e:void 0,i=t?[t]:[];this.labelSelection.update(this.nodeData).each((o,s)=>{Hk(this,o,this.properties,this.properties.label,s.label,!1,e),o.fillOpacity=this.getHighlightStyle(!1,s.datumIndex).opacity??1}),this.highlightLabelSelection.update(i,void 0,o=>this.getDatumId(o)).each((o,s)=>{Hk(this,o,this.properties,this.properties.label,s.label,!0,e),o.fillOpacity=this.getHighlightStyle(!0,s.datumIndex).opacity??1})}animateEmptyUpdateReady(){const{labelSelection:e}=this,t=this.getColumnTransitionFunctions();Fk.fromToMotion(this.id,"datums",this.ctx.animationManager,[this.itemSelection],t),VK(this,"labels",this.ctx.animationManager,e,this.highlightLabelSelection)}animateClearingUpdateEmpty(){const{itemSelection:e}=this,{animationManager:t}=this.ctx,i=this.getColumnTransitionFunctions();Fk.fromToMotion(this.id,"datums",t,[e],i),zK(this,"labels",t,this.labelSelection,this.highlightLabelSelection)}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,axes:s,properties:a}=this,{angleKey:n,angleName:r,radiusKey:l,radiusName:c,legendItemName:h,tooltip:d}=a,u=s[io.Angle],g=s[io.Radius],m=this.nodeData?.[e];if(!i||!o||!u||!g||!m)return;const y=o.dataSources.get(this.id)?.data[e],S=i.resolveKeysById(this,"angleValue",o)[e],x=i.resolveColumnById(this,"radiusValue-raw",o)[e];if(S==null)return;const b=fn(this,m,!1);return this.formatTooltipWithContext(d,{heading:this.getAxisValueText(u,"tooltip",S,y,n,void 0),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:l,value:this.getAxisValueText(g,"tooltip",x,y,l,void 0),missing:xr.isTooltipValueMissing(x)}]},{seriesId:t,datum:y,title:r,angleKey:n,angleName:r,radiusKey:l,radiusName:c,legendItemName:h,...b})}pickNodeClosestDatum(e){return this.pickNodeNearestDistantObject(e,this.itemSelection.nodes())}legendItemSymbol(){const{fill:e,stroke:t,fillOpacity:i,strokeOpacity:o,strokeWidth:s,lineDash:a,lineDashOffset:n}=Ju(this,!1,xr.HighlightState.None),r={fill:e??"rgba(0, 0, 0, 0)",stroke:t??"rgba(0, 0, 0, 0)",fillOpacity:i,strokeOpacity:o,strokeWidth:s,lineDash:a,lineDashOffset:n};return Rk(r.fill)&&(r.fill={...r.fill,gradient:"linear",rotation:0,reverse:!1}),{marker:r}}getLegendData(e){if(e!=="category")return[];const{id:t,visible:i}=this,{radiusKey:o,radiusName:s,legendItemName:a,showInLegend:n}=this.properties;return[{legendType:"category",id:t,itemId:o,seriesId:t,enabled:i,label:{text:a??s??o},symbol:this.legendItemSymbol(),legendItemName:a,hideInLegend:!n}]}getDatumId(e){return WK(e.angleValue)}computeLabelsBBox(){return null}};import{_ModuleSupport as YK}from"ag-charts-community";import{Property as Oe}from"ag-charts-core";var{SeriesProperties:UK,makeSeriesTooltip:jK,Label:XK}=YK,be=class extends UK{constructor(){super(...arguments),this.angleKeyAxis="angle",this.radiusKeyAxis="radius",this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.label=new XK,this.tooltip=jK()}getStyle(){const{fill:e,fillOpacity:t,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,cornerRadius:r}=this;return{fill:e,fillOpacity:t,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,cornerRadius:r,opacity:1}}};p([Oe],be.prototype,"angleKey",2),p([Oe],be.prototype,"angleName",2),p([Oe],be.prototype,"radiusKey",2),p([Oe],be.prototype,"radiusName",2),p([Oe],be.prototype,"angleKeyAxis",2),p([Oe],be.prototype,"radiusKeyAxis",2),p([Oe],be.prototype,"legendItemName",2),p([Oe],be.prototype,"fill",2),p([Oe],be.prototype,"fillOpacity",2),p([Oe],be.prototype,"stroke",2),p([Oe],be.prototype,"strokeWidth",2),p([Oe],be.prototype,"strokeOpacity",2),p([Oe],be.prototype,"lineDash",2),p([Oe],be.prototype,"lineDashOffset",2),p([Oe],be.prototype,"cornerRadius",2),p([Oe],be.prototype,"styler",2),p([Oe],be.prototype,"itemStyler",2),p([Oe],be.prototype,"rotation",2),p([Oe],be.prototype,"stackGroup",2),p([Oe],be.prototype,"normalizedTo",2),p([Oe],be.prototype,"label",2),p([Oe],be.prototype,"tooltip",2);import{_ModuleSupport as ZK}from"ag-charts-community";import{_ModuleSupport as qK}from"ag-charts-community";var{motion:QK}=qK;function Kk(){const e={startAngle:new Map,endAngle:new Map},t=["startAngle","endAngle"],i=(n,r,l)=>{for(const c of t){const h=e[c];let d=(l==="removed"||l==="updated"?n:r)[c],u=(l==="removed"?n:r)[c];Number.isNaN(u)&&(u=n.previousDatum?.[c]??Number.NaN);const g=d-u;Math.abs(g)>Math.PI&&(d-=Math.sign(g)*2*Math.PI),h.set(r,{from:d,to:u})}},o=(n,r)=>({startAngle:e.startAngle.get(n)[r],endAngle:e.endAngle.get(n)[r]});return{calculate:i,from:n=>o(n,"from"),to:n=>o(n,"to")}}function Gk(e,t,i){if(i==="updated"){if(e.previousDatum==null||Number.isNaN(e.previousDatum.startAngle)||Number.isNaN(e.previousDatum.endAngle))return"added";if(Number.isNaN(t.startAngle)||Number.isNaN(t.endAngle))return"removed"}return i==="added"&&e.previousDatum!=null?"updated":i}function JK(e){const t=Kk();return{toFn:(s,a,n)=>{const{startAngle:r,endAngle:l}=t.to(a);let c,h,d,u,g;return n==="removed"?(c=s.innerRadius,h=s.innerRadius,d=s.columnWidth,u=s.axisInnerRadius,g=s.axisOuterRadius):(c=Number.isNaN(a.innerRadius)?e:a.innerRadius,h=Number.isNaN(a.outerRadius)?e:a.outerRadius,d=Number.isNaN(a.columnWidth)?s.columnWidth:a.columnWidth,u=a.axisInnerRadius,g=a.axisOuterRadius),{innerRadius:c,outerRadius:h,columnWidth:d,axisInnerRadius:u,axisOuterRadius:g,startAngle:r,endAngle:l}},fromFn:(s,a,n)=>{n=Gk(s,a,n),t.calculate(s,a,n);const{startAngle:r,endAngle:l}=t.from(a);let c,h,d,u,g;n==="removed"||n==="updated"?(c=s.innerRadius,h=s.outerRadius,d=s.columnWidth,u=s.axisInnerRadius,g=s.axisOuterRadius):(c=e,h=e,d=a.columnWidth,u=a.axisInnerRadius,g=a.axisOuterRadius);const m=QK.NODE_UPDATE_STATE_TO_PHASE_MAPPING[n];return{innerRadius:c,outerRadius:h,columnWidth:d,axisInnerRadius:u,axisOuterRadius:g,startAngle:r,endAngle:l,phase:m}}}}function eG(e,{innerRadius:t,outerRadius:i,columnWidth:o,axisInnerRadius:s,axisOuterRadius:a,startAngle:n,endAngle:r}){return{innerRadius:t,outerRadius:i,columnWidth:o,axisInnerRadius:s,axisOuterRadius:a,startAngle:n,endAngle:r}}var{SectorBox:th,motion:tG}=ZK;function eg(e){const{negative:t,innerRadius:i,outerRadius:o,stackInnerRadius:s,stackOuterRadius:a}=e;return{innerRadius:t?a:s,outerRadius:t?s:a,clipInnerRadius:t?o:i,clipOuterRadius:t?i:o}}function iG(e){const t=Kk();return{toFn:(s,a,n)=>{const{startAngle:r,endAngle:l}=t.to(a);let c,h,d;if(n==="removed")c=e,h=e,d=new th(r,l,c,h);else{let u,g;({innerRadius:c,outerRadius:h,clipInnerRadius:u,clipOuterRadius:g}=eg(a)),Number.isNaN(c)&&(c=e),Number.isNaN(h)&&(h=e),Number.isNaN(u)&&(u=e),Number.isNaN(g)&&(g=e),d=new th(r,l,u,g)}return{innerRadius:c,outerRadius:h,startAngle:r,endAngle:l,clipSector:d}},fromFn:(s,a,n)=>{n=Gk(s,a,n),t.calculate(s,a,n);const{startAngle:r,endAngle:l}=t.from(a);let c,h,d;n==="removed"||n==="updated"?(c=s.innerRadius,h=s.outerRadius,d=s.clipSector):(c=e,h=e),d??(d=new th(r,l,c,h));const u=tG.NODE_UPDATE_STATE_TO_PHASE_MAPPING[n];return{innerRadius:c,outerRadius:h,startAngle:r,endAngle:l,clipSector:d,phase:u}}}}function oG(e,t){const{startAngle:i,endAngle:o}=t,{innerRadius:s,outerRadius:a,clipInnerRadius:n,clipOuterRadius:r}=eg(t),l=new th(i,o,n,r);return{innerRadius:s,outerRadius:a,startAngle:i,endAngle:o,clipSector:l}}var{Sector:sG,SectorBox:aG}=AK,tg=class extends Wk{constructor(e){super(e,{animationResetFns:{item:oG}}),this.properties=new be}setZIndex(e){return super.setZIndex(e),this.contentGroup.zIndex=[0,Qu.FOREGROUND,e],this.highlightGroup.zIndex=[0,Qu.HIGHLIGHT,e],this.labelGroup.zIndex=[0,Qu.LABEL,e],!0}getStackId(){return`nightingale-stack-${this.seriesGrouping?.groupIndex??this.id}-yValues`}nodeFactory(){return new sG}updateItemPath(e,t,i){const{negative:o}=t;if(e.centerX=0,e.centerY=0,e.startOuterCornerRadius=o?0:this.properties.cornerRadius,e.endOuterCornerRadius=o?0:this.properties.cornerRadius,e.startInnerCornerRadius=o?this.properties.cornerRadius:0,e.endInnerCornerRadius=o?this.properties.cornerRadius:0,i){const{startAngle:s,endAngle:a}=t,{innerRadius:n,outerRadius:r,clipInnerRadius:l,clipOuterRadius:c}=eg(t);e.innerRadius=n,e.outerRadius=r,e.startAngle=s,e.endAngle=a,e.clipSector=new aG(s,a,l,c)}}getColumnTransitionFunctions(){const e=this.isRadiusAxisReversed()?this.radius:this.getAxisInnerRadius();return iG(e)}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.styler!=null||this.properties.label.itemStyler!=null}};tg.className="NightingaleSeries",tg.type="nightingale";import{_ModuleSupport as nG}from"ag-charts-community";import{boolean as $k,commonSeriesOptionsDefs as rG,constant as lG,number as cG,required as ig,string as hs,undocumented as Yk}from"ag-charts-core";var{nightingaleSeriesThemeableOptionsDef:hG}=nG,og={...rG,...hG,type:ig(lG("nightingale")),angleKey:ig(hs),radiusKey:ig(hs),angleName:hs,radiusName:hs,legendItemName:hs,grouped:$k,stacked:$k,stackGroup:hs,normalizedTo:cG};og.angleKeyAxis=Yk(hs),og.radiusKeyAxis=Yk(hs);import{_ModuleSupport as sg}from"ag-charts-community";import{POLAR_AXIS_SHAPE as Uk,POLAR_AXIS_TYPE as jk}from"ag-charts-core";var{FILL_GRADIENT_RADIAL_SERIES_DEFAULTS:dG,FILL_IMAGE_DEFAULTS:pG,FILL_PATTERN_DEFAULTS:uG}=sg,gG={series:{fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",dG],["image",pG],["pattern",uG]]},stroke:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$ref:"chartBackgroundColor"},{$palette:"stroke"}]},strokeWidth:1,label:{...sg.LABEL_BOXING_DEFAULTS,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},highlight:{...sg.multiSeriesHighlightStyle(),bringToFront:!1}},axes:{[jk.ANGLE_CATEGORY]:{shape:{$findFirstSiblingNotOperation:Uk.CIRCLE},groupPaddingInner:0,paddingInner:0,label:{spacing:10}},[jk.RADIUS_NUMBER]:{shape:{$findFirstSiblingNotOperation:Uk.CIRCLE}}}},Xk={type:"series",name:"nightingale",chartType:"polar",enterprise:!0,stackable:!0,groupable:!0,stackedByDefault:!0,version:DK,dependencies:[kK],options:og,defaultAxes:{angle:{type:Ok.ANGLE_CATEGORY},radius:{type:Ok.RADIUS_NUMBER}},axisKeys:{[Pk.X]:"xKeyAxis",[Pk.Y]:"yKeyAxis"},themeTemplate:gG,create:e=>new tg(e)};import{VERSION as mG}from"ag-charts-community";import{_ModuleSupport as Zk}from"ag-charts-community";import{StateMachine as yG,cachedTextMeasurer as fG,isArray as xG,measureTextSegments as SG,mergeDefaults as qk,toPlainText as Qk,toTextString as bG}from"ag-charts-core";import{_ModuleSupport as vG}from"ag-charts-community";import{Property as $e}from"ag-charts-core";var{SeriesProperties:kG,makeSeriesTooltip:DG,Label:Jk,DropShadow:AG}=vG,MG=class extends Jk{},ag=class extends Jk{constructor(){super(...arguments),this.spacing=0}};p([$e],ag.prototype,"spacing",2),p([$e],ag.prototype,"placement",2);var qe=class extends kG{constructor(){super(...arguments),this.fills=[],this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.direction="vertical",this.reverse=void 0,this.spacing=0,this.aspectRatio=void 0,this.shadow=new AG().set({enabled:!1}),this.label=new MG,this.stageLabel=new ag,this.tooltip=DG()}getStyle(e=0){const{fills:t,strokes:i,fillOpacity:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=this;return{fill:t[e%t.length],fillOpacity:o,stroke:i[e%i.length],strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,opacity:1}}};p([$e],qe.prototype,"stageKey",2),p([$e],qe.prototype,"valueKey",2),p([$e],qe.prototype,"fills",2),p([$e],qe.prototype,"fillOpacity",2),p([$e],qe.prototype,"strokes",2),p([$e],qe.prototype,"strokeWidth",2),p([$e],qe.prototype,"strokeOpacity",2),p([$e],qe.prototype,"lineDash",2),p([$e],qe.prototype,"lineDashOffset",2),p([$e],qe.prototype,"direction",2),p([$e],qe.prototype,"reverse",2),p([$e],qe.prototype,"spacing",2),p([$e],qe.prototype,"aspectRatio",2),p([$e],qe.prototype,"itemStyler",2),p([$e],qe.prototype,"shadow",2),p([$e],qe.prototype,"label",2),p([$e],qe.prototype,"stageLabel",2),p([$e],qe.prototype,"tooltip",2);function eD(e,{x:t,y:i,top:o,right:s,bottom:a,left:n}){e.x0=t-o/2,e.x1=t+o/2,e.x2=t+a/2,e.x3=t-a/2,e.y0=i-n/2,e.y1=i-s/2,e.y2=i+s/2,e.y3=i+n/2}function IG(e){return{fromFn:(s,a)=>{const{x:n,y:r}=a;let{top:l,right:c,bottom:h,left:d}=a;return e==="vertical"?(l=0,h=0):(d=0,c=0),{x:n,y:r,top:l,right:c,bottom:h,left:d}},toFn:(s,a)=>{const{x:n,y:r,top:l,right:c,bottom:h,left:d}=a;return{x:n,y:r,top:l,right:c,bottom:h,left:d}},applyFn:eD}}var{valueProperty:tD,SeriesNodePickMode:iD,createDatumId:LG,BBox:ng,Group:rg,Selection:Sr,Text:lg,PointerEvents:oD,fromToMotion:NG,seriesLabelFadeInAnimation:CG,getLabelStyles:TG}=Zk,cg=class extends Zk.DataModelSeries{constructor(e){super({moduleCtx:e,categoryKey:void 0,pickModes:[iD.EXACT_SHAPE_MATCH,iD.NEAREST_NODE]}),this.properties=new qe,this.itemGroup=this.contentGroup.appendChild(new rg({name:"itemGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new rg({name:"itemLabelGroup"})),this.stageLabelGroup=this.contentGroup.appendChild(new rg({name:"stageLabelGroup"})),this.datumSelection=Sr.select(this.itemGroup,()=>this.nodeFactory()),this.labelSelection=Sr.select(this.itemLabelGroup,lg),this.stageLabelSelection=Sr.select(this.stageLabelGroup,lg),this.highlightLabelSelection=Sr.select(this.highlightLabelGroup,lg),this.highlightDatumSelection=Sr.select(this.highlightNodeGroup,()=>this.nodeFactory()),this.animationState=new yG("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{clear:"empty",reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable()),this.itemLabelGroup.pointerEvents=oD.None,this.stageLabelGroup.pointerEvents=oD.None,this.cleanup.register(this.ctx.eventsHub.on("legend:item-click",t=>this.onLegendItemClick(t)))}nodeFactory(){return new Qi}getNodeData(){return this.contextNodeData?.nodeData}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"&&this.animationState.transition("skip")}async processData(e){if(this.data==null)return;const{id:t,visible:i,ctx:{legendManager:o}}=this,{stageKey:s,valueKey:a}=this.properties,n="category",r="number",l=(h,d,u)=>i&&o.getItemEnabled({seriesId:t,itemId:u}),c=this.visible?{}:{forceValue:0};await this.requestDataModel(e,this.data,{props:[tD(s,n,{id:"xValue"}),tD(a,r,{id:"yValue",...c,validation:l,invalidValue:0})]})}createNodeData(){const{id:e,dataModel:t,processedData:i,properties:o,visible:s,ctx:{legendManager:a}}=this,{stageKey:n,valueKey:r,direction:l,reverse:c=l==="horizontal",spacing:h,aspectRatio:d,label:u,stageLabel:g}=o;if(t==null||i==null)return;const m=l==="horizontal",y=t.resolveColumnById(this,"xValue",i),S=t.resolveColumnById(this,"yValue",i),x=t.getDomain(this,"xValue","value",i).domain,b=t.getDomain(this,"yValue","value",i).domain,f=fG(g);let v,k;m?(v="center",k=g.placement==="before"?"bottom":"top"):(v=g.placement==="after"?"left":"right",k="middle");const A=g.enabled?[]:void 0;let M=0,I=0,D=0;const L=i.dataSources.get(this.id)?.data??[];for(const[z,F]of L.entries()){const G=y[z],Y=S[z],K=s&&a.getItemEnabled({seriesId:e,itemId:z});if(D+=Y,A==null)continue;const U=this.getLabelText(G,F,n,"x",x,this.properties.stageLabel,{datum:F,value:Y,stageKey:n,valueKey:r}),{width:ee,height:re}=xG(U)?SG(U,u):f.measureLines(bG(U));M=Math.max(M,ee),I=Math.max(I,re),A.push({x:Number.NaN,y:Number.NaN,text:U,textAlign:v,textBaseline:k,visible:K})}const N=this._nodeDataDependencies?.seriesRectWidth??0,T=this._nodeDataDependencies?.seriesRectHeight??0,O=h*(i.input.count-1);let R;if(m){const z=I+g.spacing;R=new ng(0,g.placement==="before"?z:0,N,T-z)}else{const z=M+g.spacing;R=new ng(g.placement==="after"?0:z,0,N-z,T)}if(d!=null&&d!==0){const z=l==="horizontal"?1/d:d,F=Math.min(R.width,R.height*z),G=F/z;R=new ng(R.x+(R.width-F)/2,R.y+(R.height-G)/2,F,G)}let w,E;m?E=g.placement==="before"?R.y-g.spacing:R.y+R.height+g.spacing:w=g.placement==="after"?R.x+R.width+g.spacing:R.x-g.spacing;const B=R.width-(m?O:0),P=R.height-(m?0:O);if(B<0||P<0)return;const C=[],_=[];let V=0;for(const[z,F]of L.entries()){const G=y[z],Y=S[z],K=s&&a.getItemEnabled({seriesId:e,itemId:z}),U=V+Y,ee=(V+U)/(2*D),re=(U-V)/D,ye=m?B*ee+h*z:B*.5,le=m?P*.5:P*ee+h*z,ie=R.x+ye,ce=R.y+le;if(A!=null){const ne=A[z];ne.x=w??ie,ne.y=E??ce}let pe,he,Q,Ne;if(m){const ne=B*re;pe=ne,Q=ne;const ue=(ye+ne/2)*(P/R.width),ke=(ye-ne/2)*(P/R.width);he=c?R.height-ue:ue,Ne=c?R.height-ke:ke}else{const ne=P*re;he=ne,Ne=ne;const ue=(le-ne/2)*(B/R.height),ke=(le+ne/2)*(B/R.height);pe=c?R.width-ue:ue,Q=c?R.width-ke:ke}const ve=this.getLabelText(Y,F,r,"y",b,u,{datum:F,value:Y,stageKey:n,valueKey:r}),te={x:ie,y:ce,text:ve,textAlign:"center",textBaseline:"middle",visible:K};_.push(te),C.push({series:this,itemId:r,datum:F,datumIndex:z,index:z,xValue:G,yValue:Y,x:ie,y:ce,top:pe,right:he,bottom:Q,left:Ne,label:te,enabled:K,midPoint:{x:ie,y:ce},style:this.getItemStyle({datumIndex:z,datum:F},!1)}),V=U}return{itemId:e,nodeData:C,labelData:_,stageLabelData:A,bounds:R}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update({seriesRect:e}){this.checkResize(e);const{datumSelection:t,labelSelection:i,stageLabelSelection:o,highlightDatumSelection:s,highlightLabelSelection:a}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let n=this.ctx.highlightManager?.getActiveHighlight();n!=null&&(n.series!==this||n.datum==null)&&(n=void 0);const r=this.contextNodeData?.nodeData??[],l=this.contextNodeData?.labelData??[],c=this.contextNodeData?.stageLabelData??[];this.datumSelection=this.updateDatumSelection({nodeData:r,datumSelection:t}),this.updateDatumStyles({datumSelection:t,isHighlight:!1}),this.updateDatumNodes({datumSelection:t,isHighlight:!1}),this.labelSelection=this.updateLabelSelection({labelData:l,labelSelection:i}),this.updateLabelNodes({labelSelection:i,labelProperties:this.properties.label}),this.stageLabelSelection=this.updateStageLabelSelection({stageLabelData:c,stageLabelSelection:o}),this.updateLabelNodes({labelSelection:o,labelProperties:this.properties.stageLabel,checkActiveHighlight:!0});const h=this.getHighlightLabelData(l,n)??[];this.highlightLabelSelection=a.update(h),this.updateLabelNodes({labelSelection:this.highlightLabelSelection,labelProperties:this.properties.label,isHighlight:!0}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:n==null?[]:[n],datumSelection:s}),this.updateDatumStyles({datumSelection:s,isHighlight:!0}),this.updateDatumNodes({datumSelection:s,isHighlight:!0}),this.animationState.transition("update")}updateDatumSelection(e){return e.datumSelection.update(e.nodeData)}getItemStyle({datumIndex:e,datum:t},i){const{properties:o}=this,{itemStyler:s}=o,a=this.getHighlightStyle(i,e);let r=qk(a,o.getStyle(e));if(s!=null&&e!=null){const l=this.cachedDatumCallback(LG(e,i?"highlight":"node"),()=>{const c=this.makeItemStylerParams(t,e,i,r);return this.callWithContext(s,c)});l&&(r=qk(l,r))}return r}makeItemStylerParams(e,t,i,o){const{id:s,properties:a}=this,{stageKey:n,valueKey:r}=a,l=this.ctx.highlightManager?.getActiveHighlight(),c=this.getHighlightStateString(l,i,t),h=this.filterItemStylerFillParams(o.fill)??o.fill;return{seriesId:s,datum:e,stageKey:n,valueKey:r,highlightState:c,...o,fill:h}}updateDatumStyles({datumSelection:e,isHighlight:t}){e.each((i,o)=>{o.style=this.getItemStyle(o,t)})}updateDatumNodes({datumSelection:e}){const{properties:t}=this,{shadow:i}=t,o=this.contextNodeData?.bounds,s=o?{series:o,axis:o}:void 0;e.each((a,n)=>{a.setStyleProperties(n.style,s),eD(a,n),a.fillShadow=i})}updateLabelSelection(e){return e.labelSelection.update(this.properties.label.enabled?e.labelData:[])}updateStageLabelSelection(e){return e.stageLabelSelection.update(e.stageLabelData)}updateLabelNodes(e){const t=this.ctx.highlightManager?.getActiveHighlight(),{labelSelection:i,labelProperties:o,isHighlight:s=!1,checkActiveHighlight:a=!1}=e;i.each((n,r,l)=>{const{visible:c,x:h,y:d,text:u,textAlign:g,textBaseline:m}=r,y=s||a&&t?.datumIndex===l,S=this.getHighlightStyle(y,l),x=TG(this,void 0,this.properties,o,y,t),{color:b,fontSize:f,fontStyle:v,fontWeight:k,fontFamily:A}=x;n.visible=c,n.x=h,n.y=d,n.text=u,n.fill=b,n.opacity=(S.opacity??1)*(x.fillOpacity??1),n.fillOpacity=(S.opacity??1)*(x.fillOpacity??1),n.fontStyle=v,n.fontWeight=k,n.fontSize=f,n.fontFamily=A,n.textAlign=g,n.textBaseline=m,n.setBoxing(x)})}getHighlightLabelData(e,t){if(t?.label)return[{...t.label}]}computeFocusBounds(e){const t=this.getNodeData()?.[e.datumIndex];if(t!==void 0){for(const i of this.datumSelection)if(i.datum===t)return i.node}}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,properties:s}=this,{stageKey:a,valueKey:n,tooltip:r}=s;if(!i||!o)return;const l=o.dataSources.get(this.id)?.data[e],c=i.resolveColumnById(this,"xValue",o)[e],h=i.resolveColumnById(this,"yValue",o)[e];if(c==null)return;const d=this.getLabelText(c,l,a,"x",i.getDomain(this,"xValue","value",o).domain,this.properties.stageLabel,{datum:l,value:c,stageKey:a,valueKey:n}),u=this.getItemStyle({datumIndex:e,datum:l},!1);return this.formatTooltipWithContext(r,{symbol:this.legendItemSymbol(e),data:[{label:Qk(d),value:Qk(h)}]},{seriesId:t,datum:l,title:void 0,stageKey:a,valueKey:n,...u})}getSeriesDomain(){return{domain:[Number.NaN,Number.NaN]}}getSeriesRange(){return[Number.NaN,Number.NaN]}pickNodeClosestDatum({x:e,y:t}){let i=1/0,o;return this.datumSelection.each((s,a)=>{const n=s.distanceSquared(e,t);n<i&&(i=n,o=a)}),o==null?void 0:{datum:o,distance:Math.sqrt(i)}}legendItemSymbol(e){const{fills:t,strokes:i,strokeWidth:o,fillOpacity:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=this.properties,l=t[e]??"black",c=i[e]??"black";return{marker:{fill:l,fillOpacity:s,stroke:c,strokeWidth:o,strokeOpacity:a,lineDash:n,lineDashOffset:r}}}getLegendData(e){const{processedData:t,dataModel:i,id:o,ctx:{legendManager:s},visible:a}=this;if(!i||!t||e!=="category")return[];const{showInLegend:n}=this.properties,r=[],l=i.resolveColumnById(this,"xValue",t),c=t.dataSources.get(this.id)?.data??[];for(const[h]of c.entries()){const d=l[h];r.push({legendType:"category",id:o,itemId:h,seriesId:o,enabled:a&&s.getItemEnabled({seriesId:o,itemId:h}),label:{text:d},symbol:this.legendItemSymbol(h),hideInLegend:!n})}return r}animateReset(){this.ctx.animationManager.skipCurrentBatch(),this.ctx.animationManager.stopByAnimationGroupId(this.id)}animateEmptyUpdateReady(){const{datumSelection:e,labelSelection:t,properties:i}=this,o=IG(i.direction);NG(this.id,"nodes",this.ctx.animationManager,[e],o),CG(this,"labels",this.ctx.animationManager,t)}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.label.itemStyler!=null}};cg.className="PyramidSeries",cg.type="pyramid";import{_ModuleSupport as wG}from"ag-charts-community";import{commonSeriesOptionsDefs as PG,constant as OG,required as hg,string as sD}from"ag-charts-core";var{pyramidSeriesThemeableOptionsDef:RG}=wG,EG={...RG,...PG,type:hg(OG("pyramid")),stageKey:hg(sD),valueKey:hg(sD)};import{_ModuleSupport as br}from"ag-charts-community";import{DEFAULT_SHADOW_COLOUR as _G}from"ag-charts-core";var BG={series:{direction:"vertical",strokeWidth:{$isUserOption:["./strokes/0",2,0]},spacing:2,fills:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$palette:"fills"},{$applySwitch:[{$path:["/type",void 0,{$value:"$1"}]},{$value:"$1"},["gradient",br.FILL_GRADIENT_LINEAR_DEFAULTS],["pattern",br.FILL_PATTERN_DEFAULTS],["image",br.FILL_IMAGE_DEFAULTS]]}]},strokes:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$palette:"strokes"}]},label:{...br.LABEL_BOXING_DEFAULTS,enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"chartBackgroundColor"}},stageLabel:{...br.LABEL_BOXING_DEFAULTS,enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:12},shadow:{enabled:!1,color:_G,xOffset:3,yOffset:3,blur:5},highlight:{unhighlightedItem:{opacity:.4}}}},aD={type:"series",name:"pyramid",chartType:"standalone",enterprise:!0,solo:!0,version:mG,dependencies:[an],options:EG,themeTemplate:BG,create:e=>new cg(e)};import{PolarChartModule as VG,VERSION as zG}from"ag-charts-community";import{ChartAxisDirection as nD,POLAR_AXIS_TYPE as rD}from"ag-charts-core";import{_ModuleSupport as No}from"ag-charts-community";import{POLAR_AXIS_TYPE as FG,mergeDefaults as lD}from"ag-charts-core";var cD={series:{stroke:{$palette:"stroke"},label:{...No.LABEL_BOXING_DEFAULTS,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},marker:{enabled:!0,fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",No.FILL_GRADIENT_RADIAL_REVERSED_DEFAULTS],["image",No.FILL_IMAGE_DEFAULTS],["pattern",No.FILL_PATTERN_DEFAULTS]]},stroke:{$palette:"stroke"},fillOpacity:1,shape:"circle",size:6,strokeOpacity:1,strokeWidth:{$isUserOption:["./stroke",1,0]}},highlight:No.markerSeriesHighlightStyle(),tooltip:{range:{$path:["/tooltip/range","nearest"]}}},axes:{[FG.ANGLE_CATEGORY]:{label:{spacing:10}}}},HG=lD({series:{stroke:No.SAFE_STROKE_FILL_OPERATION,strokeWidth:2}},cD),WG=lD({series:{fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",No.FILL_GRADIENT_LINEAR_DEFAULTS],["image",No.FILL_IMAGE_DEFAULTS],["pattern",No.FILL_PATTERN_DEFAULTS]]},fillOpacity:.8,strokeWidth:2,marker:{enabled:!1}}},cD);import{_ModuleSupport as hD}from"ag-charts-community";import{ChartAxisDirection as dD}from"ag-charts-core";import{_ModuleSupport as ih}from"ag-charts-community";import{ChartAxisDirection as vi,extent as KG,isFiniteNumber as pD,isNumberEqual as uD,mergeDefaults as GG}from"ag-charts-core";import{_ModuleSupport as $G}from"ag-charts-community";import{Property as st}from"ag-charts-core";var{Label:YG,SeriesMarker:UG,SeriesProperties:jG,makeSeriesTooltip:XG}=$G,Ye=class extends jG{constructor(){super(...arguments),this.angleKeyAxis="angle",this.radiusKeyAxis="radius",this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.rotation=0,this.marker=new UG,this.label=new YG,this.tooltip=XG(),this.connectMissingData=!1}};p([st],Ye.prototype,"angleKey",2),p([st],Ye.prototype,"radiusKey",2),p([st],Ye.prototype,"angleName",2),p([st],Ye.prototype,"radiusName",2),p([st],Ye.prototype,"angleKeyAxis",2),p([st],Ye.prototype,"radiusKeyAxis",2),p([st],Ye.prototype,"legendItemName",2),p([st],Ye.prototype,"stroke",2),p([st],Ye.prototype,"strokeWidth",2),p([st],Ye.prototype,"strokeOpacity",2),p([st],Ye.prototype,"lineDash",2),p([st],Ye.prototype,"lineDashOffset",2),p([st],Ye.prototype,"rotation",2),p([st],Ye.prototype,"styler",2),p([st],Ye.prototype,"marker",2),p([st],Ye.prototype,"label",2),p([st],Ye.prototype,"tooltip",2),p([st],Ye.prototype,"connectMissingData",2);var{DEFAULT_POLAR_DIRECTION_KEYS:ZG,DEFAULT_POLAR_DIRECTION_NAMES:qG,PolarAxis:QG,SeriesNodePickMode:gD,valueProperty:mD,fixNumericExtent:JG,seriesLabelFadeInAnimation:e4,markerFadeInAnimation:t4,resetMarkerFn:i4,resetLabelFn:o4,animationValidation:s4,computeMarkerFocusBounds:a4,BBox:n4,Group:r4,Path:l4,Selection:dg,Text:c4,Marker:h4,updateLabelNode:yD,getMarkerStyles:d4}=ih,p4=class extends ih.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},pg=class extends ih.PolarSeries{constructor(e){super({moduleCtx:e,categoryKey:"angleValue",propertyKeys:ZG,propertyNames:qG,pickModes:[gD.NEAREST_NODE,gD.EXACT_SHAPE_MATCH],canHaveAxes:!0,animationResetFns:{item:i4,label:o4},clipFocusBox:!1}),this.NodeEvent=p4,this.lineGroup=this.contentGroup.appendChild(new r4({name:"radar-line"})),this.lineSelection=dg.select(this.lineGroup,l4),this.resetInvalidToZero=!1,this.circleCache={r:0,cx:0,cy:0},this.lineGroup.zIndex=0,this.itemGroup.zIndex=1}nodeFactory(){return new h4}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;if(!i||!t)return{domain:[]};if(e===vi.Angle){const o=t.getDomain(this,"angleValue","value",i).domain,s=t.getKeySortMetadata(this,"angleValue",i);return{domain:o,sortMetadata:s}}else{const o=t.getDomain(this,"radiusValue","value",i).domain,s=KG(o.length===0?o:[0].concat(o));return{domain:JG(s)}}}async processData(e){const{angleKey:t,radiusKey:i}=this.properties,o=[];this.ctx.animationManager.isSkipped()||o.push(s4());const s=this.axes[vi.Radius]?.scale.type,a=this.axes[vi.Angle]?.scale.type;await this.requestDataModel(e,this.data,{props:[mD(t,a,{id:"angleValue"}),mD(i,s,{id:"radiusValue",invalidValue:void 0}),...o]}),this.animationState.transition("updateData")}didCircleChange(){const e=this.radius,t=this.centerX,i=this.centerY,o=this.circleCache;return e===o.r&&t===o.cx&&i===o.cy?!1:(this.circleCache={r:e,cx:t,cy:i},!0)}getAxisInnerRadius(){const e=this.axes[vi.Radius];return e instanceof QG?this.radius*e.innerRadiusRatio:0}maybeRefreshNodeData(){!this.didCircleChange()&&!this.nodeDataRefresh||(this.contextNodeData=this.createNodeData(),this.nodeData=this.contextNodeData?.nodeData??[],this.nodeDataRefresh=!1)}createNodeData(){const{processedData:e,dataModel:t}=this;if(!e||!t)return;const{angleKey:i,radiusKey:o,angleName:s,radiusName:a,legendItemName:n,marker:r,label:l}=this.properties,c=this.axes[vi.Angle]?.scale,h=this.axes[vi.Radius]?.scale;if(!c||!h)return;const d=t.resolveColumnById(this,"angleValue",e),u=t.resolveColumnById(this,"radiusValue",e),g=this.getAxisInnerRadius(),m=this.getSeriesDomain(vi.Radius).domain,S=(e.dataSources.get(this.id)?.data??[]).map((x,b)=>{const f=d[b],v=u[b],k=c.convert(f),A=this.radius+g-h.convert(v),M=Math.cos(k),I=Math.sin(k),D=M*A,L=I*A;let N;if(l.enabled){const T=this.getLabelText(v,x,o,"radius",m,l,{value:v,datum:x,angleKey:i,radiusKey:o,angleName:s,radiusName:a,legendItemName:n});if(T){let O="right";uD(M,0)?O="center":M>0&&(O="left");let R="bottom";uD(I,0)?R="middle":I>0&&(R="top"),N={x:D+M*r.size,y:L+I*r.size,text:T,textAlign:O,textBaseline:R}}}return{series:this,datum:x,datumIndex:b,index:b,point:{x:D,y:L,size:r.size},midPoint:{x:D,y:L},label:N,angleValue:f,radiusValue:v,missing:!pD(k)||!pD(A)}});return{itemId:o,nodeData:S,labelData:S,styles:d4(this,this.properties,r)}}update({seriesRect:e}){const t=this.checkResize(e),i=!this.ctx.animationManager.isSkipped(),{series:o}=this.ctx.highlightManager?.getActiveHighlight()??{};this.highlightGroup.visible=(i||this.visible)&&o===this,this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updatePathSelections(),this.updateMarkerSelection(),this.updateHighlightSelection(),this.updatePathNodes(),this.hasItemStylers()&&(this.updateDatumStyles(this.itemSelection,!1),this.updateDatumStyles(this.highlightSelection,!0)),this.updateMarkers(this.itemSelection,!1),this.updateMarkers(this.highlightSelection,!0),this.updateLabels(),t&&this.animationState.transition("resize"),this.animationState.transition("update")}updatePathSelections(){const e=this.visible?[!0]:[];this.lineSelection.update(e)}updateMarkerSelection(){const{marker:e,styler:t}=this.properties;e.isDirty()&&(this.itemSelection.clear(),this.itemSelection.cleanup(),this.itemSelection=dg.select(this.itemGroup,()=>this.nodeFactory(),!1));const i=t==null?e.enabled:this.getStyle().marker.enabled,o=this.visible&&e.shape&&i?this.nodeData:[];this.itemSelection.update(o)}updateHighlightSelection(){const{marker:e,styler:t}=this.properties;e.isDirty()&&(this.highlightSelection.clear(),this.highlightSelection.cleanup(),this.highlightSelection=dg.select(this.highlightGroup,()=>this.nodeFactory(),!1));const i=t==null?e.enabled:this.getStyle().marker.enabled,o=this.ctx.highlightManager?.getActiveHighlight(),s=this.visible&&e.shape&&i&&o?.datum?[{...o}]:[];this.highlightSelection.update(s)}getMarkerFill(e){return e?.fill??this.getStyle().marker.fill}getDatumStylerProperties(e){const{id:t,properties:i}=this,{angleKey:o,radiusKey:s}=i;return{seriesId:t,datum:e,angleKey:o,radiusKey:s}}updateDatumStyles(e,t){const i=this.ctx.highlightManager.getActiveHighlight();e.each((o,s)=>{const a=this.getHighlightState(i,t,s.datumIndex),n=this.getStyle(a),{stroke:r,strokeWidth:l,strokeOpacity:c}=n;s.style=this.getMarkerStyle(this.properties.marker,s,this.getDatumStylerProperties(s.datum),{isHighlight:t,highlightState:a},n.marker,{stroke:r,strokeWidth:l,strokeOpacity:c})})}updateMarkers(e,t){const i=this.getShapeFillBBox(),{contextNodeData:o}=this;if(!o)return;const s=this.ctx.highlightManager.getActiveHighlight();e.each((a,n)=>{const r=n.style??o.styles[this.getHighlightState(s,t,n.datumIndex)];this.applyMarkerStyle(r,a,n.point,i)})}updateLabels(){const{properties:e}=this,t=this.ctx.highlightManager?.getActiveHighlight(),i=t?.series===this&&t?.datum?[{...t}]:[];this.labelSelection.update(this.nodeData).each((o,s)=>{s.label&&(o.fillOpacity=this.getHighlightStyle(!1,s.datumIndex).opacity??1,yD(this,o,e,e.label,s.label,!1,t))}),this.highlightLabelSelection.update(i).each((o,s)=>{s.label&&(o.fillOpacity=this.getHighlightStyle(!0,s.datumIndex).opacity??1,yD(this,o,e,e.label,s.label,!0,t))})}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,axes:s,properties:a}=this,{angleKey:n,angleName:r,radiusKey:l,radiusName:c,legendItemName:h,tooltip:d,marker:u}=a,g=s[vi.Angle],m=s[vi.Radius];if(!i||!o||!g||!m)return;const y=o.dataSources.get(this.id)?.data[e],S=i.resolveColumnById(this,"angleValue",o)[e],x=i.resolveColumnById(this,"radiusValue",o)[e];if(S==null)return;const b=this.getMarkerStyle(u,{datum:y,datumIndex:e},this.getDatumStylerProperties(y),{isHighlight:!1});return this.formatTooltipWithContext(d,{heading:this.getAxisValueText(g,"tooltip",S,y,n,void 0),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:l,value:this.getAxisValueText(m,"tooltip",x,y,l,void 0),missing:ih.isTooltipValueMissing(x)}]},{seriesId:t,datum:y,title:r,angleKey:n,radiusKey:l,angleName:r,radiusName:c,legendItemName:h,...b})}legendItemSymbol(){const{stroke:e,strokeWidth:t,strokeOpacity:i,lineDash:o,marker:s}=this.getStyle();return{marker:{shape:s.shape,enabled:s.enabled||t<=0,fill:this.getMarkerFill()??s.stroke??e??"rgba(0, 0, 0, 0)",stroke:s.stroke??e??"rgba(0, 0, 0, 0)",fillOpacity:s.fillOpacity,strokeOpacity:s.strokeOpacity,strokeWidth:s.strokeWidth,lineDash:s.lineDash,lineDashOffset:s.lineDashOffset},line:{enabled:!0,stroke:e,strokeOpacity:i,strokeWidth:t,lineDash:o}}}getLegendData(e){if(e!=="category")return[];const{id:t,ctx:{legendManager:i},visible:o}=this,{radiusKey:s,radiusName:a,legendItemName:n,showInLegend:r}=this.properties;return[{legendType:"category",id:t,itemId:s,seriesId:t,enabled:o&&i.getItemEnabled({seriesId:t,itemId:s}),label:{text:n??a??s},symbol:this.legendItemSymbol(),legendItemName:n,hideInLegend:!r}]}pickNodeClosestDatum(e){const{nodeData:t,centerX:i,centerY:o}=this,{x:s,y:a}=e,n=this.radius;if(Math.hypot(s-i,a-o)>n+this.maxChartMarkerSize)return;let l=1/0,c;for(const h of t){const{point:{x:d=Number.NaN,y:u=Number.NaN}={}}=h;if(Number.isNaN(d)||Number.isNaN(u))continue;const g=Math.hypot(e.x-d-i,e.y-u-o);g<l&&(l=g,c=h)}if(c){const h=Math.max(l-(c.point?.size??0)/2,0);return{datum:c,distance:h}}}computeLabelsBBox(){const{label:e}=this.properties;this.maybeRefreshNodeData();const t=[],i=new c4;for(const o of this.nodeData){if(!e.enabled||!o.label)continue;i.text=o.label.text,i.x=o.label.x,i.y=o.label.y,i.setFont(e),i.setAlign(o.label);const s=i.getBBox();t.push(s)}return t.length===0?null:n4.merge(t)}getLineNode(){return this.lineSelection?.at(0)}beforePathAnimation(){this.updatePathNodes()}getPathNodesStyle(){const e=this.ctx.highlightManager?.getActiveHighlight(),t=this.getHighlightState(e),i=this.getHighlightStyle(void 0,void 0,t),o=this.getStyle(t);return GG(i,o)}getLinePoints(){const{nodeData:e,resetInvalidToZero:t}=this,{connectMissingData:i}=this.properties;if(e.length===0)return[];const o=this.axes[vi.Radius],a=this.axes[vi.Angle]?.isReversed(),r=o?.isReversed()&&!a?[...e].reverse():e,l=[];let c=!1,h;for(const[d,u]of r.entries()){let{x:g,y:m}=u.point;const y=Number.isNaN(g)||Number.isNaN(m);y||(h??(h=u)),y&&!i&&(g=0,m=0);const S=d===0||!t&&!i&&(y||c);l.push({x:g,y:m,moveTo:S}),c=y}return h!==void 0&&l.push({x:h.point.x,y:h.point.y,moveTo:!1}),l}animateSinglePath(e,t,i){const{path:o}=e;o.clear(!0);const s=this.getAxisInnerRadius(),a=this.axes[vi.Radius],r=a?.isReversed()?this.radius+s-a?.scale.convert(0):s;for(const l of t){const{x:c,y:h,arc:d,radius:u=0,startAngle:g=0,endAngle:m=0,moveTo:y}=l,S=Math.atan2(h,c),x=r*Math.cos(S),b=r*Math.sin(S),f=i,v=x*(1-f)+c*f,k=b*(1-f)+h*f;d?o.arc(c,h,u,g,m):y?o.moveTo(v,k):o.lineTo(v,k)}e.checkPathDirty()}animatePaths(e){const t=this.getLinePoints(),i=this.getLineNode();i&&this.animateSinglePath(i,t,e)}animateEmptyUpdateReady(){const{itemSelection:e,labelSelection:t}=this,{animationManager:i}=this.ctx;this.beforePathAnimation(),i.animate({id:`${this.id}_'path`,groupId:this.id,from:0,to:1,phase:"initial",collapsable:!1,onUpdate:o=>this.animatePaths(o),onStop:()=>this.animatePaths(1)}),t4(this,i,"added",e),e4(this,"labels",i,t,this.highlightLabelSelection)}animateWaitingUpdateReady(e){super.animateWaitingUpdateReady(e),this.resetPaths()}animateReadyResize(e){super.animateReadyResize(e),this.resetPaths()}resetPaths(){const e=this.getLineNode();if(e){const{path:t}=e,i=this.getLinePoints(),o=this.getStyle();e.fill=void 0,e.stroke=o.stroke,e.strokeWidth=o.strokeWidth,e.strokeOpacity=o.strokeOpacity,e.lineDash=o.lineDash,e.lineDashOffset=o.lineDashOffset,t.clear(!0);for(const{x:s,y:a,moveTo:n}of i)n?t.moveTo(s,a):t.lineTo(s,a);return e.checkPathDirty(),o}}getStylerResult(e,t){const{styler:i}=this.properties;if(i){const o=this.makeStylerParams(t),s=this.cachedCallWithContext(i,o)??{},a=this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],s,{pick:!1});a&&(e=a)}return e}getFormattedMarkerStyle(e){const{angleKey:t,radiusKey:i}=this.properties;return this.getMarkerStyle(this.properties.marker,e,{angleKey:t,radiusKey:i},{isHighlight:!0})}computeFocusBounds(e){return a4(this,e)}hasItemStylers(){return this.properties.styler!=null||this.properties.marker.itemStyler!=null||this.properties.label.itemStyler!=null}};pg.className="RadarSeries";import"ag-charts-community";import{Property as fD}from"ag-charts-core";var ug=class extends Ye{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1}};p([fD],ug.prototype,"fill",2),p([fD],ug.prototype,"fillOpacity",2);var{Group:u4,HighlightState:g4,Path:m4,PointerEvents:xD,Selection:y4,toHighlightString:f4}=hD,gg=class extends pg{constructor(e){super(e),this.properties=new ug,this.areaGroup=this.contentGroup.appendChild(new u4({name:"radar-area"})),this.areaSelection=y4.select(this.areaGroup,m4),this.resetInvalidToZero=!0,this.areaGroup.zIndex=-1}updatePathSelections(){const e=this.visible?[!0]:[];this.areaSelection.update(e),super.updatePathSelections()}getAreaNode(){return this.areaSelection.at(0)}getMarkerFill(e){if(e?.fill!=null)return e.fill;const t=this.getStyle();return t.marker.fill??t.fill}updatePathNodes(){const e=this.getPathNodesStyle(),{fill:t,fillOpacity:i,strokeWidth:o,stroke:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,opacity:l}=e,c=this.getLineNode();c&&c.setProperties({fill:void 0,lineJoin:"round",lineCap:"round",pointerEvents:xD.None,opacity:l,stroke:s,strokeWidth:o,strokeOpacity:a,lineDash:n,lineDashOffset:r});const h=this.getAreaNode();h&&(h.setStyleProperties({fill:t,fillOpacity:i,stroke:void 0},this.getShapeFillBBox()),h.setProperties({lineJoin:"round",pointerEvents:xD.None,opacity:l}))}animatePaths(e){super.animatePaths(e);const t=this.getAreaNode();t&&this.animateSinglePath(t,this.getAreaPoints(),e)}getAreaPoints(){const e=this.getLinePoints(),t=n=>{const r=this.axes[n];return r instanceof hD.PolarAxis?r:void 0},i=t(dD.Radius),o=t(dD.Angle);if(!i?.isReversed())return e;const a=o?.getAxisLinePoints()?.points??[];return e.concat(...a)}resetPaths(){const e=super.resetPaths(),t=this.getAreaNode();if(t){const{path:i}=t,o=this.getAreaPoints(),s=e??this.getStyle(),a=this.getShapeFillBBox();t.setStyleProperties({fill:s.fill,stroke:void 0,fillOpacity:s.fillOpacity,lineDash:s.lineDash,lineDashOffset:s.lineDashOffset},a),t.lineJoin=t.lineCap="round",i.clear(!0);for(const{x:n,y:r,moveTo:l,arc:c,radius:h=0,startAngle:d=0,endAngle:u=0}of o)c?i.arc(n,r,h,d,u):l?i.moveTo(n,r):i.lineTo(n,r);return i.closePath(),t.checkPathDirty(),s}}makeStylerParams(e){const{properties:t}=this,i=f4(e??g4.None);return{marker:{fill:t.marker.fill,fillOpacity:t.marker.fillOpacity,size:t.marker.size,shape:t.marker.shape,stroke:t.marker.stroke,strokeOpacity:t.marker.strokeOpacity,strokeWidth:t.marker.strokeWidth,lineDash:t.marker.lineDash,lineDashOffset:t.marker.lineDashOffset},highlightState:i,fill:t.fill,fillOpacity:t.fillOpacity,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,seriesId:this.id,stroke:t.stroke,strokeOpacity:t.strokeOpacity,strokeWidth:t.strokeWidth,angleKey:t.angleKey,radiusKey:t.radiusKey}}getStyle(e){const{marker:t,fill:i,fillOpacity:o,lineDash:s,lineDashOffset:a,stroke:n,strokeOpacity:r,strokeWidth:l}=this.properties,{size:c,shape:h,fill:d="transparent",fillOpacity:u}=t,g=this.getStylerResult({},e);return g.marker??(g.marker={}),{fill:g.fill??i,fillOpacity:g.fillOpacity??o,lineDash:g.lineDash??s,lineDashOffset:g.lineDashOffset??a,stroke:g.stroke??n,strokeOpacity:g.strokeOpacity??r,strokeWidth:g.strokeWidth??l,marker:{enabled:g.marker.enabled??t.enabled,fill:g.marker.fill??d,fillOpacity:g.marker.fillOpacity??u,shape:g.marker.shape??h,size:g.marker.size??c,lineDash:g.marker.lineDash??t.lineDash??s,lineDashOffset:g.marker.lineDashOffset??t.lineDashOffset??a,stroke:g.marker.stroke??t.stroke??n,strokeOpacity:g.marker.strokeOpacity??t.strokeOpacity??r,strokeWidth:g.marker.strokeWidth??t.strokeWidth??l}}}};gg.className="RadarAreaSeries",gg.type="radar-area";import{_ModuleSupport as x4}from"ag-charts-community";import{commonSeriesOptionsDefs as S4,constant as b4,required as mg,string as na,undocumented as SD}from"ag-charts-core";var{radarAreaSeriesThemeableOptionsDef:v4}=x4,yg={...S4,...v4,type:mg(b4("radar-area")),angleKey:mg(na),radiusKey:mg(na),angleName:na,radiusName:na,legendItemName:na};yg.angleKeyAxis=SD(na),yg.radiusKeyAxis=SD(na);var bD={type:"series",name:"radar-area",chartType:"polar",enterprise:!0,version:zG,dependencies:[VG],options:yg,defaultAxes:{angle:{type:rD.ANGLE_CATEGORY},radius:{type:rD.RADIUS_NUMBER}},axisKeys:{[nD.Angle]:"angleKeyAxis",[nD.Radius]:"radiusKeyAxis"},themeTemplate:WG,create:e=>new gg(e)};import{PolarChartModule as k4,VERSION as D4}from"ag-charts-community";import{ChartAxisDirection as vD,POLAR_AXIS_TYPE as kD}from"ag-charts-core";import{_ModuleSupport as A4}from"ag-charts-community";var{HighlightState:M4,PointerEvents:I4,toHighlightString:L4}=A4,fg=class extends pg{constructor(){super(...arguments),this.properties=new Ye}updatePathSelections(){this.lineSelection.update(this.visible?[!0]:[])}updatePathNodes(){const e=this.getLineNode();if(!e)return;const t=this.getPathNodesStyle(),{strokeWidth:i,stroke:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,opacity:r}=t;e.setProperties({fill:void 0,lineJoin:"round",lineCap:"round",pointerEvents:I4.None,opacity:r,stroke:o,strokeWidth:i,strokeOpacity:s,lineDash:a,lineDashOffset:n})}makeStylerParams(e){const{properties:t}=this,i=L4(e??M4.None);return{marker:{fill:t.marker.fill,fillOpacity:t.marker.fillOpacity,size:t.marker.size,shape:t.marker.shape,stroke:t.marker.stroke,strokeOpacity:t.marker.strokeOpacity,strokeWidth:t.marker.strokeWidth,lineDash:t.marker.lineDash,lineDashOffset:t.marker.lineDashOffset},highlightState:i,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,seriesId:this.id,stroke:t.stroke,strokeOpacity:t.strokeOpacity,strokeWidth:t.strokeWidth,angleKey:t.angleKey,radiusKey:t.radiusKey}}getStyle(e){const{marker:t,lineDash:i,lineDashOffset:o,stroke:s,strokeOpacity:a,strokeWidth:n}=this.properties,{size:r,shape:l,fill:c="transparent",fillOpacity:h}=t,d=this.getStylerResult({},e);return d.marker??(d.marker={}),{lineDash:d.lineDash??i,lineDashOffset:d.lineDashOffset??o,stroke:d.stroke??s,strokeOpacity:d.strokeOpacity??a,strokeWidth:d.strokeWidth??n,marker:{enabled:d.marker.enabled??t.enabled,fill:d.marker.fill??c,fillOpacity:d.marker.fillOpacity??h,shape:d.marker.shape??l,size:d.marker.size??r,lineDash:d.marker.lineDash??t.lineDash??i,lineDashOffset:d.marker.lineDashOffset??t.lineDashOffset??o,stroke:d.marker.stroke??t.stroke??s,strokeOpacity:d.marker.strokeOpacity??t.strokeOpacity??a,strokeWidth:d.marker.strokeWidth??t.strokeWidth??n}}}};fg.className="RadarLineSeries",fg.type="radar-line";import{_ModuleSupport as N4}from"ag-charts-community";import{commonSeriesOptionsDefs as C4,constant as T4,required as xg,string as ra,undocumented as DD}from"ag-charts-core";var{radarLineSeriesThemeableOptionsDef:w4}=N4,Sg={...C4,...w4,type:xg(T4("radar-line")),angleKey:xg(ra),radiusKey:xg(ra),angleName:ra,radiusName:ra,legendItemName:ra};Sg.angleKeyAxis=DD(ra),Sg.radiusKeyAxis=DD(ra);var AD={type:"series",name:"radar-line",chartType:"polar",enterprise:!0,version:D4,dependencies:[k4],options:Sg,defaultAxes:{angle:{type:kD.ANGLE_CATEGORY},radius:{type:kD.RADIUS_NUMBER}},axisKeys:{[vD.Angle]:"angleKeyAxis",[vD.Radius]:"radiusKeyAxis"},themeTemplate:HG,create:e=>new fg(e)};import{PolarChartModule as P4,VERSION as O4}from"ag-charts-community";import{ChartAxisDirection as MD,POLAR_AXIS_TYPE as ID}from"ag-charts-core";import{_ModuleSupport as vr}from"ag-charts-community";import{ChartAxisDirection as oo,angleBetween as R4,isDefined as E4,isGradientFill as LD}from"ag-charts-core";import{_ModuleSupport as _4}from"ag-charts-community";import{Property as Re}from"ag-charts-core";var{SeriesProperties:B4,makeSeriesTooltip:V4,Label:z4}=_4,Le=class extends B4{constructor(){super(...arguments),this.angleKeyAxis="angle",this.radiusKeyAxis="radius",this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.label=new z4,this.tooltip=V4()}getStyle(){const{fill:e,fillOpacity:t,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,cornerRadius:r}=this;return{fill:e,fillOpacity:t,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,cornerRadius:r,opacity:1}}};p([Re],Le.prototype,"angleKey",2),p([Re],Le.prototype,"radiusKey",2),p([Re],Le.prototype,"angleName",2),p([Re],Le.prototype,"radiusName",2),p([Re],Le.prototype,"angleKeyAxis",2),p([Re],Le.prototype,"radiusKeyAxis",2),p([Re],Le.prototype,"legendItemName",2),p([Re],Le.prototype,"fill",2),p([Re],Le.prototype,"fillOpacity",2),p([Re],Le.prototype,"stroke",2),p([Re],Le.prototype,"strokeWidth",2),p([Re],Le.prototype,"strokeOpacity",2),p([Re],Le.prototype,"lineDash",2),p([Re],Le.prototype,"lineDashOffset",2),p([Re],Le.prototype,"cornerRadius",2),p([Re],Le.prototype,"styler",2),p([Re],Le.prototype,"itemStyler",2),p([Re],Le.prototype,"rotation",2),p([Re],Le.prototype,"stackGroup",2),p([Re],Le.prototype,"normalizedTo",2),p([Re],Le.prototype,"label",2),p([Re],Le.prototype,"tooltip",2);import{_ModuleSupport as F4}from"ag-charts-community";var{SectorBox:ND,motion:H4}=F4;function W4(e,t,i){if(i==="updated"){if(e.previousDatum==null||Number.isNaN(e.previousDatum.innerRadius)||Number.isNaN(e.previousDatum.outerRadius))return"added";if(Number.isNaN(t.innerRadius)||Number.isNaN(t.outerRadius))return"removed"}return i==="added"&&e.previousDatum!=null?"updated":i}function CD(e){return{toFn:(o,s,a)=>{let n,r,l,c,h;return a==="removed"?(n=e,r=e,l=s.innerRadius,c=s.outerRadius,h=new ND(n,r,l,c)):(n=s.startAngle,r=s.endAngle,l=Number.isNaN(s.innerRadius)?o.innerRadius:s.innerRadius,c=Number.isNaN(s.outerRadius)?o.outerRadius:s.outerRadius,h=s.clipSector),{startAngle:n,endAngle:r,innerRadius:l,outerRadius:c,clipSector:h}},fromFn:(o,s,a)=>{a=W4(o,s,a);let n,r,l,c,h;a==="removed"||a==="updated"?(n=o.startAngle,r=o.endAngle,l=o.innerRadius,c=o.outerRadius,h=o.clipSector):(n=e,r=e,l=s.innerRadius,c=s.outerRadius),h??(h=new ND(n,r,l,c));const d=H4.NODE_UPDATE_STATE_TO_PHASE_MAPPING[a];return{startAngle:n,endAngle:r,innerRadius:l,outerRadius:c,clipSector:h,phase:d}}}}function K4(e,t){return{centerX:0,centerY:0,innerRadius:t.innerRadius,outerRadius:t.outerRadius,startAngle:t.startAngle,endAngle:t.endAngle,clipSector:t.clipSector}}var{DEFAULT_POLAR_DIRECTION_KEYS:G4,DEFAULT_POLAR_DIRECTION_NAMES:$4,PolarAxis:Y4,diff:U4,groupAccumulativeValueProperty:TD,keyProperty:j4,normaliseGroupTo:X4,valueProperty:Z4,fixNumericExtent:q4,resetLabelFn:Q4,seriesLabelFadeInAnimation:J4,seriesLabelFadeOutAnimation:e3,animationValidation:t3,createDatumId:i3,CategoryScale:o3,Sector:s3,SectorBox:a3,motion:wD,updateLabelNode:PD,getItemStyles:n3}=vr,r3=class extends vr.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},bg=class extends vr.PolarSeries{constructor(e){super({moduleCtx:e,categoryKey:"radiusValue",propertyKeys:G4,propertyNames:$4,canHaveAxes:!0,animationResetFns:{item:K4,label:Q4}}),this.properties=new Le,this.NodeEvent=r3,this.groupScale=new o3,this.circleCache={r:0,cx:0,cy:0}}nodeFactory(){return new s3}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;if(!i||!t)return{domain:[]};if(e===oo.Angle){const o=t.getDomain(this,"angleValue-end","value",i).domain,s=[Math.min(o[0],0),Math.max(o[1],0)];return{domain:q4(s)}}else return t.getDomain(this,"radiusValue","key",i)}async processData(e){const{angleKey:t,radiusKey:i,normalizedTo:o}=this.properties,s=!this.ctx.animationManager.isSkipped(),a=this.getStackId(),n=`${a}-trailing`,r=[];E4(o)&&r.push(X4([a,n],Math.abs(o))),this.needsDataModelDiff()&&this.processedData&&r.push(U4(this.id,this.processedData)),s&&r.push(t3());const l=this.visible?{}:{forceValue:0},c=this.axes[oo.Radius]?.scale.type,h=this.axes[oo.Angle]?.scale.type;await this.requestDataModel(e,this.data,{props:[j4(i,c,{id:"radiusValue"}),Z4(t,h,{id:"angleValue-raw",invalidValue:null,...l}),...TD(t,"normal",{id:"angleValue-end",rangeId:"angleValue-range",invalidValue:null,groupId:a,separateNegative:!0,...l},h),...TD(t,"trailing",{id:"angleValue-start",invalidValue:null,groupId:n,separateNegative:!0,...l},h),...r],groupByKeys:!0,groupByData:!1}),this.animationState.transition("updateData")}didCircleChange(){const e=this.radius,t=this.centerX,i=this.centerY,o=this.circleCache;return e===o.r&&t===o.cx&&i===o.cy?!1:(this.circleCache={r:e,cx:t,cy:i},!0)}maybeRefreshNodeData(){!this.didCircleChange()&&!this.nodeDataRefresh||(this.contextNodeData=this.createNodeData(),this.nodeData=this.contextNodeData?.nodeData??[],this.nodeDataRefresh=!1)}getAxisInnerRadius(){const e=this.axes[oo.Radius];return e instanceof Y4?this.radius*e.innerRadiusRatio:0}createNodeData(){const{processedData:e,dataModel:t}=this;if(!t||!e||e.type!=="grouped")return;const i=this.axes[oo.Angle],o=this.axes[oo.Radius],s=i?.scale,a=o?.scale;if(!s||!a)return;const n=t.resolveKeysById(this,"radiusValue",e),r=t.resolveColumnById(this,"angleValue-start",e),l=t.resolveColumnById(this,"angleValue-end",e),c=t.resolveColumnById(this,"angleValue-raw",e),h=t.resolveProcessedDataIndexById(this,"angleValue-range");let d=0;o instanceof vs&&(d=o.groupPaddingInner);const{groupScale:u}=this,{index:g,visibleGroupCount:m}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);u.domain=Array.from({length:m}).map((P,C)=>String(C)),u.range=[0,Math.abs(a.bandwidth??0)],u.paddingInner=m>1?d:0;const y=u.bandwidth>=1?u.bandwidth:u.rawBandwidth,S=i.isReversed(),x=o.isReversed(),b=x?this.radius:this.getAxisInnerRadius(),v=(x?this.getAxisInnerRadius():this.radius)+b,k=this.getSeriesDomain(oo.Angle).domain,{angleKey:A,radiusKey:M,angleName:I,radiusName:D,legendItemName:L,label:N}=this.properties,T=(P,C,_,V)=>{const z=this.getLabelText(C,P,A,"angle",k,N,{value:C,datum:P,angleKey:A,radiusKey:M,angleName:I,radiusName:D,legendItemName:L});if(z)return{x:_,y:V,text:z,textAlign:"center",textBaseline:"middle"}},O=[],R=n3((P,C,_)=>fn(this,P,C,_)),w={itemId:M,nodeData:O,labelData:O,styles:R};if(!this.visible)return w;const{dataSources:E}=e,B=E.get(this.id)?.data??[];for(const{datumIndex:P,group:C}of t.forEachGroupDatum(this,e)){const _=B[P],V=n[P];if(V==null)return;const z=c[P],F=r[P],G=l[P],Y=z>=0&&!Object.is(z,-0),K=C.aggregation[h][Y?1:0],U=Y===S;let ee=s.convert(F,{clamp:!0}),re=s.convert(G,{clamp:!0}),ye=s.convert(0,{clamp:!0}),le=s.convert(K,{clamp:!0});U&&([ye,le]=[le,ye],[ee,re]=[re,ee]);const ce=v-a.convert(V)+u.convert(String(g)),pe=ce+y,he=(ce+pe)/2,Q=ee+R4(ee,re)/2,Ne=Math.cos(Q)*he,ve=Math.sin(Q)*he,te=this.properties.label.enabled?T(_,z,Ne,ve):void 0,ne=new a3(ee,re,ce,pe);O.push({series:this,datum:_,datumIndex:P,point:{x:Ne,y:ve,size:0},midPoint:{x:Ne,y:ve},label:te,angleValue:z,radiusValue:V,innerRadius:ce,outerRadius:pe,startAngle:ye,endAngle:le,clipSector:ne,reversed:U,index:P})}return w}update({seriesRect:e}){const t=this.checkResize(e);this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updateSectorSelection(this.itemSelection,!1),this.updateSectorSelection(this.highlightSelection,!0),this.updateLabels(),t&&this.animationState.transition("resize"),this.animationState.transition("update")}updateSectorSelection(e,t){let i=[];const o=this.ctx.highlightManager?.getActiveHighlight();t?o?.datum&&o.series===this&&i.push(o):i=this.nodeData;const{contextNodeData:s}=this;if(!s)return;const a=this.ctx.highlightManager.getActiveHighlight(),n=this.getShapeFillBBox(),r=this.hasItemStylers();e.update(i,void 0,l=>this.getDatumId(l)).each((l,c)=>{const h=Yn(c);if(h==null)return;if(r){const y=this.getHighlightState(o,t,c.datumIndex);c.style=fn(this,c,t,y)}const d=c.style??s.styles[this.getHighlightState(a,t,c.datumIndex)],u=d.cornerRadius,g=d.fill,m=LD(g)&&g.bounds!=="item"?{centerX:0,centerY:0}:void 0;l.setStyleProperties(d,n,m),l.lineJoin="round",l.inset=l.stroke==null?0:l.strokeWidth/2,l.startInnerCornerRadius=h.reversed?u:0,l.startOuterCornerRadius=h.reversed?u:0,l.endInnerCornerRadius=h.reversed?0:u,l.endOuterCornerRadius=h.reversed?0:u,t&&(l.startAngle=c.startAngle,l.endAngle=c.endAngle,l.clipSector=c.clipSector,l.innerRadius=c.innerRadius,l.outerRadius=c.outerRadius)})}updateLabels(){const{properties:e}=this,t=this.ctx.highlightManager?.getActiveHighlight(),i=t?.series===this&&t?.datum?t:void 0,o=i?[i]:[];this.labelSelection.update(this.nodeData).each((s,a)=>{PD(this,s,e,e.label,a.label,!1,t),s.fillOpacity=this.getHighlightStyle(!1,a.datumIndex).opacity??1}),this.highlightLabelSelection.update(o,void 0,s=>this.getDatumId(s)).each((s,a)=>{PD(this,s,e,e.label,a.label,!0,t),s.fillOpacity=this.getHighlightStyle(!0,a.datumIndex).opacity??1})}getBarTransitionFunctions(){const e=this.axes[oo.Angle]?.scale;let t=0;if(!e)return CD(t);const i=Math.min(e.domain[0],e.domain[1]),o=Math.max(e.domain[0],e.domain[1]);return i<=0&&o>=0&&(t=e.convert(0)),CD(t)}animateEmptyUpdateReady(){const{labelSelection:e}=this,t=this.getBarTransitionFunctions();wD.fromToMotion(this.id,"datums",this.ctx.animationManager,[this.itemSelection],t),J4(this,"labels",this.ctx.animationManager,e,this.highlightLabelSelection)}animateClearingUpdateEmpty(){const{itemSelection:e}=this,{animationManager:t}=this.ctx,i=this.getBarTransitionFunctions();wD.fromToMotion(this.id,"datums",t,[e],i),e3(this,"labels",t,this.labelSelection,this.highlightLabelSelection)}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,axes:s,properties:a}=this,{angleKey:n,angleName:r,radiusKey:l,radiusName:c,legendItemName:h,tooltip:d}=a,u=s[oo.Angle],g=s[oo.Radius],m=this.nodeData?.[e];if(!i||!o||!u||!g||!m)return;const y=o.dataSources.get(this.id)?.data[e],S=i.resolveKeysById(this,"radiusValue",o)[e],x=i.resolveColumnById(this,"angleValue-raw",o)[e];if(S==null)return;const b=fn(this,m,!1);return this.formatTooltipWithContext(d,{heading:this.getAxisValueText(g,"tooltip",S,y,l,void 0),symbol:this.legendItemSymbol(),data:[{label:r,fallbackLabel:n,value:this.getAxisValueText(u,"tooltip",x,y,n,void 0),missing:vr.isTooltipValueMissing(x)}]},{seriesId:t,datum:y,title:r,angleKey:n,angleName:r,radiusKey:l,radiusName:c,legendItemName:h,...b})}pickNodeClosestDatum(e){return this.pickNodeNearestDistantObject(e,this.itemSelection.nodes())}legendItemSymbol(){const{fill:e,stroke:t,fillOpacity:i,strokeOpacity:o,strokeWidth:s,lineDash:a,lineDashOffset:n}=Ju(this,!1,vr.HighlightState.None),r={fill:e??"rgba(0, 0, 0, 0)",stroke:t??"rgba(0, 0, 0, 0)",fillOpacity:i,strokeOpacity:o,strokeWidth:s,lineDash:a,lineDashOffset:n};return LD(r.fill)&&(r.fill={...r.fill,gradient:"linear",rotation:0,reverse:!1}),{marker:r}}getLegendData(e){if(e!=="category")return[];const{id:t,visible:i}=this,{angleKey:o,angleName:s,legendItemName:a,showInLegend:n}=this.properties;return[{legendType:"category",id:t,itemId:o,seriesId:t,enabled:i,label:{text:a??s??o},symbol:this.legendItemSymbol(),legendItemName:a,hideInLegend:!n}]}getDatumId(e){return i3(e.radiusValue)}computeLabelsBBox(){return null}getStackId(){return`radialBar-stack-${this.seriesGrouping?.groupIndex??this.id}-xValues`}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.styler!=null||this.properties.label.itemStyler!=null}};bg.className="RadialBarSeries",bg.type="radial-bar";import{_ModuleSupport as l3}from"ag-charts-community";import{boolean as OD,commonSeriesOptionsDefs as c3,constant as h3,number as d3,required as vg,string as ds,undocumented as RD}from"ag-charts-core";var{radialBarSeriesThemeableOptionsDef:p3}=l3,kg={...c3,...p3,type:vg(h3("radial-bar")),angleKey:vg(ds),radiusKey:vg(ds),angleName:ds,radiusName:ds,legendItemName:ds,grouped:OD,stacked:OD,stackGroup:ds,normalizedTo:d3};kg.angleKeyAxis=RD(ds),kg.radiusKeyAxis=RD(ds);import{_ModuleSupport as Dg}from"ag-charts-community";import{POLAR_AXIS_TYPE as u3}from"ag-charts-core";var{FILL_GRADIENT_CONIC_SERIES_DEFAULTS:g3,FILL_IMAGE_DEFAULTS:m3,FILL_PATTERN_DEFAULTS:y3}=Dg,f3={series:{fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",g3],["image",m3],["pattern",y3]]},stroke:{$palette:"stroke"},strokeWidth:{$isUserOption:["./stroke",1,0]},label:{...Dg.LABEL_BOXING_DEFAULTS,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"chartBackgroundColor"}},highlight:Dg.multiSeriesHighlightStyle()},axes:{[u3.RADIUS_CATEGORY]:{innerRadiusRatio:.2,groupPaddingInner:.2,paddingInner:.2,paddingOuter:.1}}},ED={type:"series",name:"radial-bar",chartType:"polar",enterprise:!0,stackable:!0,groupable:!0,version:O4,dependencies:[P4],options:kg,defaultAxes:{angle:{type:ID.ANGLE_NUMBER},radius:{type:ID.RADIUS_CATEGORY}},axisKeys:{[MD.Angle]:"angleKeyAxis",[MD.Radius]:"radiusKeyAxis"},themeTemplate:f3,create:e=>new bg(e)};import{PolarChartModule as x3,VERSION as S3}from"ag-charts-community";import{ChartAxisDirection as _D,POLAR_AXIS_TYPE as BD}from"ag-charts-core";import{_ModuleSupport as b3}from"ag-charts-community";import{ChartAxisDirection as v3}from"ag-charts-core";import{Property as VD}from"ag-charts-core";var Ag=class extends be{};p([VD],Ag.prototype,"columnWidthRatio",2),p([VD],Ag.prototype,"maxColumnWidthRatio",2);var{PolarAxis:k3,RadialColumnShape:D3,getRadialColumnWidth:A3}=b3,Mg=class extends Wk{constructor(e){super(e,{animationResetFns:{item:eG}}),this.properties=new Ag}getStackId(){return`radarColumn-stack-${this.seriesGrouping?.groupIndex??this.id}-yValues`}nodeFactory(){return new D3}getColumnTransitionFunctions(){const e=this.isRadiusAxisReversed()?this.radius:this.getAxisInnerRadius();return JK(e)}isRadiusAxisCircle(){const e=this.axes[v3.Radius];return e instanceof k3?e.shape==="circle":!1}updateItemPath(e,t,i){e.isBeveled=this.isRadiusAxisCircle(),i&&(e.innerRadius=t.innerRadius,e.outerRadius=t.outerRadius,e.startAngle=t.startAngle,e.endAngle=t.endAngle,e.columnWidth=t.columnWidth,e.axisInnerRadius=t.axisInnerRadius,e.axisOuterRadius=t.axisOuterRadius)}getColumnWidth(e,t){const{columnWidthRatio:i=.5,maxColumnWidthRatio:o=.5}=this.properties;return A3(e,t,this.radius,i,o)}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.styler!=null||this.properties.label.itemStyler!=null}};Mg.className="RadialColumnSeries",Mg.type="radial-column";import{_ModuleSupport as M3}from"ag-charts-community";import{boolean as zD,commonSeriesOptionsDefs as I3,constant as L3,number as N3,required as Ig,string as ps,undocumented as FD}from"ag-charts-core";var{radialColumnSeriesThemeableOptionsDef:C3}=M3,Lg={...I3,...C3,type:Ig(L3("radial-column")),angleKey:Ig(ps),radiusKey:Ig(ps),angleName:ps,radiusName:ps,legendItemName:ps,grouped:zD,stacked:zD,stackGroup:ps,normalizedTo:N3};Lg.angleKeyAxis=FD(ps),Lg.radiusKeyAxis=FD(ps);import{_ModuleSupport as Ng}from"ag-charts-community";import{POLAR_AXIS_SHAPE as HD,POLAR_AXIS_TYPE as WD}from"ag-charts-core";var{FILL_GRADIENT_RADIAL_SERIES_DEFAULTS:T3,FILL_IMAGE_DEFAULTS:w3,FILL_PATTERN_DEFAULTS:P3}=Ng,O3={series:{fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",T3],["image",w3],["pattern",P3]]},stroke:{$palette:"stroke"},columnWidthRatio:.5,maxColumnWidthRatio:.5,strokeWidth:{$isUserOption:["./stroke",1,0]},label:{...Ng.LABEL_BOXING_DEFAULTS,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},highlight:Ng.multiSeriesHighlightStyle()},axes:{[WD.ANGLE_CATEGORY]:{shape:{$findFirstSiblingNotOperation:HD.CIRCLE},groupPaddingInner:0,paddingInner:0,label:{spacing:10}},[WD.RADIUS_NUMBER]:{shape:{$findFirstSiblingNotOperation:HD.CIRCLE},innerRadiusRatio:.5}}},KD={type:"series",name:"radial-column",chartType:"polar",enterprise:!0,stackable:!0,groupable:!0,version:S3,dependencies:[x3],options:Lg,defaultAxes:{angle:{type:BD.ANGLE_CATEGORY},radius:{type:BD.RADIUS_NUMBER}},axisKeys:{[_D.Angle]:"angleKeyAxis",[_D.Radius]:"radiusKeyAxis"},themeTemplate:O3,create:e=>new Mg(e)};import{VERSION as R3,_ModuleSupport as oh}from"ag-charts-community";import{FONT_SIZE_RATIO as E3,radialGaugeSeriesOptionsDef as _3}from"ag-charts-core";import{_ModuleSupport as la}from"ag-charts-community";import{StateMachine as B3,cachedTextMeasurer as V3,isArray as z3,isBetweenAngles as sh,measureTextSegments as F3,mergeDefaults as H3,normalizeAngle360 as W3,normalizeAngle360Inclusive as GD,tickFormat as K3,toPlainText as G3,toRadians as ah,toTextString as $3}from"ag-charts-core";import{_ModuleSupport as Y3}from"ag-charts-community";var{SvgPath:U3,Rotatable:j3,Translatable:X3,Scalable:Z3}=Y3,Cg=class extends j3(Z3(X3(U3))){constructor(){super(...arguments),this.scalingCenterX=.5,this.scalingCenterY=.5,this.rotationCenterX=.5,this.rotationCenterY=.5}};Cg.defaultPathData="M0.50245 0.53745C0.481767 0.53745 0.465 0.520683 0.465 0.5C0.465 0.479317 0.481767 0.46255 0.50245 0.46255L1 0.500012L0.50245 0.53745Z";import{_ModuleSupport as nh}from"ag-charts-community";import{BaseProperties as kr,PropertiesArray as Tg,Property as H,normalizeAngle360 as q3,normalizeAngle360Inclusive as Q3,toDegrees as J3}from"ag-charts-core";var{getColorStops:e$}=nh,{makeSeriesTooltip:t$,SeriesProperties:i$,AxisLabel:o$,Label:s$}=nh,$D=class extends s${};p([H],$D.prototype,"spacing",2);var gt=class extends kr{constructor(){super(...arguments),this.label=new $D}getStyle(){const{fill:e="black",fillOpacity:t=1,stroke:i="black",strokeWidth:o=0,strokeOpacity:s=1,lineDash:a=[0],lineDashOffset:n=0}=this;return{fill:e,fillOpacity:t,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}}};p([H],gt.prototype,"text",2),p([H],gt.prototype,"value",2),p([H],gt.prototype,"shape",2),p([H],gt.prototype,"placement",2),p([H],gt.prototype,"spacing",2),p([H],gt.prototype,"size",2),p([H],gt.prototype,"rotation",2),p([H],gt.prototype,"fill",2),p([H],gt.prototype,"fillOpacity",2),p([H],gt.prototype,"stroke",2),p([H],gt.prototype,"strokeWidth",2),p([H],gt.prototype,"strokeOpacity",2),p([H],gt.prototype,"lineDash",2),p([H],gt.prototype,"lineDashOffset",2),p([H],gt.prototype,"label",2);var Oi=class extends kr{constructor(){super(...arguments),this.enabled=!0,this.fills=new Tg(nh.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}getStyle(e,t){const{enabled:i,fill:o,fills:s,fillMode:a,fillOpacity:n,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}=this;return{fill:i?o??jD(s,a,e,t):"none",fillOpacity:n,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}}};p([H],Oi.prototype,"enabled",2),p([H],Oi.prototype,"fills",2),p([H],Oi.prototype,"fillMode",2),p([H],Oi.prototype,"fill",2),p([H],Oi.prototype,"fillOpacity",2),p([H],Oi.prototype,"stroke",2),p([H],Oi.prototype,"strokeWidth",2),p([H],Oi.prototype,"strokeOpacity",2),p([H],Oi.prototype,"lineDash",2),p([H],Oi.prototype,"lineDashOffset",2);var Dr=class extends kr{constructor(){super(...arguments),this.values=void 0,this.step=void 0,this.minSpacing=0,this.maxSpacing=1e3}};p([H],Dr.prototype,"values",2),p([H],Dr.prototype,"step",2),p([H],Dr.prototype,"minSpacing",2),p([H],Dr.prototype,"maxSpacing",2);var a$=class extends o${},wt=class extends kr{constructor(){super(...arguments),this.min=0,this.max=1,this.fills=new Tg(nh.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.defaultFill="black",this.interval=new Dr,this.label=new a$}getStyle(e,t,i){const{fill:o,fills:s,defaultFill:a,fillMode:n,fillOpacity:r,stroke:l,strokeWidth:c,strokeOpacity:h,lineDash:d,lineDashOffset:u}=this;return{fill:o??(e&&s.length===0?a:void 0)??jD(s,n,t,i),fillOpacity:r,stroke:l,strokeWidth:c,strokeOpacity:h,lineDash:d,lineDashOffset:u}}};p([H],wt.prototype,"min",2),p([H],wt.prototype,"max",2),p([H],wt.prototype,"fills",2),p([H],wt.prototype,"fillMode",2),p([H],wt.prototype,"fill",2),p([H],wt.prototype,"fillOpacity",2),p([H],wt.prototype,"stroke",2),p([H],wt.prototype,"strokeWidth",2),p([H],wt.prototype,"strokeOpacity",2),p([H],wt.prototype,"lineDash",2),p([H],wt.prototype,"lineDashOffset",2),p([H],wt.prototype,"defaultFill",2),p([H],wt.prototype,"interval",2),p([H],wt.prototype,"label",2);var Ri=class extends kr{constructor(){super(...arguments),this.enabled=!0,this.spacing=0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};p([H],Ri.prototype,"enabled",2),p([H],Ri.prototype,"radiusRatio",2),p([H],Ri.prototype,"spacing",2),p([H],Ri.prototype,"fill",2),p([H],Ri.prototype,"fillOpacity",2),p([H],Ri.prototype,"stroke",2),p([H],Ri.prototype,"strokeWidth",2),p([H],Ri.prototype,"strokeOpacity",2),p([H],Ri.prototype,"lineDash",2),p([H],Ri.prototype,"lineDashOffset",2);var YD=class extends Ka{};p([H],YD.prototype,"text",2);var UD=class extends Xl{};p([H],UD.prototype,"text",2);var Fe=class extends i${constructor(){super(...arguments),this.startAngle=0,this.endAngle=0,this.segmentation=new dr,this.defaultColorRange=[],this.targets=new Tg(gt),this.defaultTarget=new gt,this.outerRadiusRatio=1,this.innerRadiusRatio=1,this.cornerRadius=0,this.cornerMode="container",this.spacing=0,this.scale=new wt,this.bar=new Oi,this.needle=new Ri,this.label=new YD,this.secondaryLabel=new UD,this.tooltip=t$()}};p([H],Fe.prototype,"value",2),p([H],Fe.prototype,"startAngle",2),p([H],Fe.prototype,"endAngle",2),p([H],Fe.prototype,"segmentation",2),p([H],Fe.prototype,"defaultColorRange",2),p([H],Fe.prototype,"targets",2),p([H],Fe.prototype,"defaultTarget",2),p([H],Fe.prototype,"outerRadiusRatio",2),p([H],Fe.prototype,"innerRadiusRatio",2),p([H],Fe.prototype,"outerRadius",2),p([H],Fe.prototype,"innerRadius",2),p([H],Fe.prototype,"cornerRadius",2),p([H],Fe.prototype,"cornerMode",2),p([H],Fe.prototype,"spacing",2),p([H],Fe.prototype,"scale",2),p([H],Fe.prototype,"bar",2),p([H],Fe.prototype,"needle",2),p([H],Fe.prototype,"label",2),p([H],Fe.prototype,"secondaryLabel",2),p([H],Fe.prototype,"tooltip",2);function jD(e,t,i,o){const{domain:s,range:a}=o,[n,r]=a,l=q3((n+r)/2+Math.PI),c=Q3(r-n);return{type:"gradient",gradient:"conic",colorSpace:"oklch",colorStops:e$(e,i,s,t).map(({color:d,stop:u})=>(u=Math.min(Math.max(u,0),1),u=(n+c*u-l)/(2*Math.PI),u=(u%1+1)%1,{stop:u,color:d})),bounds:"series",rotation:J3(l)+90}}import{_ModuleSupport as n$}from"ag-charts-community";import{toPlainText as wg}from"ag-charts-core";var{SectorBox:Pg}=n$;function r$(e){const{startAngle:t,endAngle:i,clipStartAngle:o,clipEndAngle:s,innerRadius:a,outerRadius:n}=e;if(!(o==null||s==null))return new Pg(Math.max(o,t),Math.min(s,i),a,n)}function XD(e,t,i){return Math.max(e,i.startAngle)<=Math.min(t,i.endAngle)}function Og(e){return e.clipStartAngle!=null&&e.clipEndAngle!=null}function Rg(e,t){const{clipStartAngle:i,clipEndAngle:o,innerRadius:s,outerRadius:a}=e;return new Pg(i,t?i:o,s,a)}function ZD(e,t){const i=e?"initial":"update";return{node:{fromFn(a,n){const r=a.previousDatum;let{startAngle:l,endAngle:c}=r??n;const h=r!=null&&Og(r)?Rg(r,e):void 0,d=Og(n)?Rg(n,e):void 0;let u;return h!=null&&d!=null?u=h:h==null&&d!=null?(u=d,l=n.startAngle,c=n.endAngle):h!=null&&d==null?(u=void 0,l=n.startAngle,c=n.endAngle):e&&(c=l),{startAngle:l,endAngle:c,clipSector:u,phase:i}},toFn(a,n){const{startAngle:r,endAngle:l}=n;let c;return Og(n)&&(c=Rg(n,!1)),{startAngle:r,endAngle:l,clipSector:c}},applyFn(a,n){const{startAngle:r,endAngle:l}=n;let{clipSector:c}=n;c!=null&&(c=new Pg(Math.max(r,c.startAngle),Math.min(l,c.endAngle),c.innerRadius,c.outerRadius));const h=c==null||XD(r,l,c);a.startAngle=r,a.endAngle=l,a.clipSector=c,a.visible=h}},needle:{fromFn(a){let{angle:n}=a.previousDatum??a.datum;return e&&(n=t),{rotation:n,phase:i}},toFn(a,n){const{angle:r}=n;return{rotation:r}}}}}function Eg(e,t){const{startAngle:i,endAngle:o}=t,s=r$(t),a=s==null||XD(i,o,s);return{startAngle:i,endAngle:o,clipSector:s,visible:a}}function qD(e,t){const{angle:i}=t;return{rotation:i}}var l$={top:0,middle:.5,bottom:1};function c$(e,t,i,o,s,a){const{padding:n,textAlign:r,verticalAlign:l}=o;let c,h;if(i.each((k,A)=>{A.label==="primary"?c=A:A.label==="secondary"&&(h=A)}),c==null)return;const d=hr(e.id,t,c,a?.label);if(d==null)return;const u=h==null?void 0:hr(e.id,t,h,a?.secondaryLabel),g={padding:n},m=r==="center"?2:1,y=l==="middle"?2:1,S=k=>({width:Math.sqrt(Math.max(s**2-(k/y)**2,0))*m,height:Math.min(k,y*s),meta:null});let x,b,f;if(h!=null&&u!=null){const k=jx(wg(d),c,wg(u),h,g,S);x=k?.label,b=k?.secondaryLabel,f=k?.height??0}else{const k=Jn(wg(d),c,g,S);x=k?.[0],b=void 0,f=k?.[0].height??0}const v=f*l$[l];i.each((k,A)=>{let M;if(A.label==="primary"?M=x:A.label==="secondary"&&(M=b),M==null){k.visible=!1;return}k.visible=!0,k.text=M.text,k.fontSize=M.fontSize,k.lineHeight=M.lineHeight,k.textAlign=r,k.textBaseline="middle";const I=A.label==="primary"?M.height/2:f-M.height/2;k.y=A.centerY+I-v,k.x=A.centerX})}var{fromToMotion:Ar,resetMotion:QD,SeriesNodePickMode:JD,createDatumId:_g,sectorBox:h$,BBox:d$,Group:us,PointerEvents:rh,Selection:gs,Sector:p$,SectorBox:u$,Text:eA,Marker:g$}=la,m$={inside:90,middle:0,outside:-90},y$=[{textAlign:"left",textBaseline:"top"},{textAlign:"right",textBaseline:"top"},{textAlign:"right",textBaseline:"bottom"},{textAlign:"left",textBaseline:"bottom"}],f$=[{textAlign:"right",textBaseline:"bottom"},{textAlign:"left",textBaseline:"bottom"},{textAlign:"left",textBaseline:"top"},{textAlign:"right",textBaseline:"top"}],Bg=class extends la.Series{constructor(e){super({moduleCtx:e,pickModes:[JD.EXACT_SHAPE_MATCH,JD.NEAREST_NODE]}),this.centerX=0,this.centerY=0,this.radius=0,this.textAlign="center",this.verticalAlign="middle",this.properties=new Fe,this.scale=new km,this.scaleGroup=this.contentGroup.appendChild(new us({name:"scaleGroup"})),this.itemGroup=this.contentGroup.appendChild(new us({name:"itemGroup"})),this.itemNeedleGroup=this.contentGroup.appendChild(new us({name:"itemNeedleGroup"})),this.itemTargetGroup=this.contentGroup.appendChild(new us({name:"itemTargetGroup"})),this.itemTargetLabelGroup=this.contentGroup.appendChild(new us({name:"itemTargetLabelGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new us({name:"itemLabelGroup"})),this.highlightTargetGroup=this.highlightGroup.appendChild(new us({name:"itemTargetLabelGroup"})),this.tickGroup=this.contentGroup.appendChild(new us({name:"tickGroup"})),this.scaleSelection=gs.select(this.scaleGroup,()=>this.nodeFactory()),this.datumSelection=gs.select(this.itemGroup,()=>this.nodeFactory()),this.needleSelection=gs.select(this.itemNeedleGroup,Cg),this.targetSelection=gs.select(this.itemTargetGroup,()=>this.markerFactory()),this.targetLabelSelection=gs.select(this.itemTargetLabelGroup,eA),this.labelSelection=gs.select(this.itemLabelGroup,eA),this.highlightTargetSelection=gs.select(this.highlightTargetGroup,()=>this.markerFactory()),this.tickSelection=gs.select(this.tickGroup,la.TransformableText),this.datumUnion=new Nv,this.animationState=new B3("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.animateReadyResize(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateWaitingUpdateReady()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty"},reset:"empty",skip:"ready"}}),this.scaleGroup.pointerEvents=rh.None,this.tickGroup.pointerEvents=rh.None,this.itemNeedleGroup.pointerEvents=rh.None,this.itemLabelGroup.pointerEvents=rh.None}get hasData(){return this.properties.value!=null}nodeFactory(){return new p$}markerFactory(){const e=new g$;return e.size=1,e}processData(){this.nodeDataRefresh=!0,this.animationState.transition("updateData")}formatLabel(e){const{min:t,max:i}=this.properties.scale;return Tv(e,{min:t,max:i})}layoutScale(){const{scale:e,properties:t}=this,{seriesRectWidth:i,seriesRectHeight:o}=this.nodeDataDependencies,{scale:s,outerRadius:a}=this.properties,{min:n,max:r,label:l,interval:c}=s,h=ah(t.startAngle-90),d=ah(t.endAngle-90),g=GD(d-h)>Math.PI,m=g||sh(1.5*Math.PI,h,d),y=g||sh(0*Math.PI,h,d),S=g||sh(.5*Math.PI,h,d),x=g||sh(1*Math.PI,h,d);let b;x&&!y?b="right":!x&&y?b="left":b="center";let f;m&&!S?f="bottom":!m&&S?f="top":f="middle";const v=h$({startAngle:h,endAngle:d,innerRadius:0,outerRadius:.5}),k=-(v.x+v.width/2)*2,A=-(v.y+v.height/2)*2,M=Math.min(i/v.width,o/v.height);e.domain=[n,r],e.range=[h,d],e.arcLength=M/2;const{maxSpacing:I,minSpacing:D}=c,{arcLength:L}=e,N=I?Math.floor(L/I):1,T=D?Math.floor(L/D):1/0,O=Math.floor(4/Math.PI*Math.abs(e.range[0]-e.range[1])),R=Math.max(N,Math.min(T,O)),w=c.values??e.ticks({nice:[!1,!1],interval:c.step,minTickCount:N,maxTickCount:T,tickCount:R})?.ticks??[],E=K3(w,typeof l.format=="string"?l.format:void 0),B=V3(l),P=w.map((G,Y)=>{let K;if(l.formatter&&(K=nr(this.ctx,l.formatter,{value:G,index:Y,domain:e.domain,boundSeries:void 0})),K??(K=E?.(G)),K==null)return;const{width:U,height:ee}=z3(K)?F3(K,l):B.measureLines($3(K));return{index:Y,value:G,text:K,width:U,height:ee}}).filter(G=>G!=null),C=P.reduce((G,Y)=>Math.max(G,Y.width),0),_=P.reduce((G,Y)=>Math.max(G,Y.height),0),V=l.enabled?Math.max(C,_)+l.spacing:0,z=Math.max(.5*M-V,0),F=a??z;return this.centerX=i/2+k*F,this.centerY=o/2+A*F,this.radius=F,this.textAlign=b,this.verticalAlign=f,P}getShapeFillBBox(){const{centerX:e,centerY:t,radius:i}=this,o=new d$(e-i,t-i,2*i,2*i);return{series:o,axis:o}}getTargets(){const{properties:e}=this,t=e.defaultTarget;return Array.from(e.targets).map(i=>{const{text:o=t.text,value:s=t.value??0,shape:a=t.shape??"triangle",rotation:n=t.rotation??0,placement:r=t.placement??"middle",spacing:l=t.spacing??0,size:c=t.size??0}=i,{enabled:h=t.label.enabled,color:d=t.label.color??"black",fontStyle:u=t.label.fontStyle??"normal",fontWeight:g=t.label.fontWeight??"normal",fontSize:m=t.label.fontSize,fontFamily:y=t.label.fontFamily,spacing:S=t.label.spacing??0}=i.label;return{text:o,value:s,shape:a,placement:r,spacing:l,size:c,rotation:n,label:{enabled:h,color:d,fontStyle:u,fontWeight:g,fontSize:m,fontFamily:y,spacing:S},style:i.getStyle()}})}getTargetRadius(e){const{radius:t,properties:i}=this,{innerRadiusRatio:o,outerRadiusRatio:s}=i,{placement:a,spacing:n,size:r}=e,l=t*s,c=t*o;switch(a){case"inside":return Math.max(c-n-r/2,0);case"outside":return l+n+r/2;default:return(c+l)/2}}getTargetLabel(e){const{scale:t}=this,{value:i,size:o,placement:s,label:a}=e,{spacing:n,color:r,fontStyle:l,fontWeight:c,fontSize:h,fontFamily:d}=a,u=void 0,g=t.convert(i),m=Math.trunc(W3(g)/(Math.PI/2)),y=o/2+n;let S,x,b,f;switch(s){case"outside":({textAlign:S,textBaseline:x}=y$[m]),b=y*Math.cos(g),f=y*Math.sin(g);break;case"inside":({textAlign:S,textBaseline:x}=f$[m]),b=-y*Math.cos(g),f=-y*Math.sin(g);break;default:S="center",x="bottom",b=0,f=-y;break}return{offsetX:b,offsetY:f,fill:r,textAlign:S,textBaseline:x,fontStyle:l,fontWeight:c,fontSize:h,fontFamily:d,lineHeight:u}}createNodeData(){const e=this.layoutScale(),{id:t,scale:i,properties:o,radius:s,centerX:a,centerY:n}=this,{value:r,innerRadiusRatio:l,outerRadiusRatio:c,segmentation:h,cornerRadius:d,cornerMode:u,needle:g,bar:m,scale:y,label:S,secondaryLabel:x}=o,{outerRadius:b=s*c,innerRadius:f=s*l,defaultColorRange:v}=o,k=this.getTargets(),A=[],M=[],I=[],D=[],L=[],N=u==="item",T=i.convert(i.domain[0]),O=i.convert(r),R=Math.ceil(GD(O-T)*s);let w=h.enabled?h.interval.getSegments(i,R):void 0;const E=m.getStyle(v,i),B=y.getStyle(m.enabled,v,i);if(w==null&&N){const P=Math.min(...i.domain),C=Math.max(...i.domain),_={value:r,segmentStart:P,segmentEnd:C},z=Math.min(d,(b-f)/2)/((f+b)/2);A.push({series:this,itemId:"value",datum:_,datumIndex:{type:0},type:0,centerX:a,centerY:n,outerRadius:b,innerRadius:f,startAngle:T-z,endAngle:O+z,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:d,endCornerRadius:d,style:E}),L.push({series:this,itemId:"scale",datum:_,datumIndex:{type:0},type:0,centerX:a,centerY:n,outerRadius:b,innerRadius:f,startAngle:i.range[0]-z,endAngle:i.range[1]+z,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:d,endCornerRadius:d,style:B})}else{w??(w=i.domain);for(let P=0;P<w.length-1;P++){const C=w[P],_=w[P+1],V={value:r,segmentStart:C,segmentEnd:_},z=P===0,F=P===w.length-2,G=i.convert(C),Y=i.convert(_);A.push({series:this,itemId:`value-${P}`,datum:V,datumIndex:{type:0},type:0,centerX:a,centerY:n,outerRadius:b,innerRadius:f,startAngle:G,endAngle:Y,clipStartAngle:T,clipEndAngle:O,startCornerRadius:N||z?d:0,endCornerRadius:N||F?d:0,style:E}),L.push({series:this,itemId:`scale-${P}`,datum:V,datumIndex:{type:0},type:0,centerX:a,centerY:n,outerRadius:b,innerRadius:f,startAngle:G,endAngle:Y,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:N||z?d:0,endCornerRadius:N||F?d:0,style:B})}}if(!g.enabled&&S.enabled){const{text:P,color:C,fontSize:_,minimumFontSize:V,fontStyle:z,fontWeight:F,fontFamily:G,lineHeight:Y,formatter:K=U=>this.formatLabel(U.value)}=S;D.push({label:"primary",centerX:a,centerY:n,text:P,value:r,fill:C,fontSize:_,minimumFontSize:V,fontStyle:z,fontWeight:F,fontFamily:G,lineHeight:Y,formatter:K})}if(!g.enabled&&x.enabled){const{text:P,color:C,fontSize:_,minimumFontSize:V,fontStyle:z,fontWeight:F,fontFamily:G,lineHeight:Y,formatter:K}=x;D.push({label:"secondary",centerX:a,centerY:n,text:P,value:r,fill:C,fontSize:_,minimumFontSize:V,fontStyle:z,fontWeight:F,fontFamily:G,lineHeight:Y,formatter:K})}if(g.enabled){let P=g.radiusRatio==null?f:s*g.radiusRatio;P=Math.max(P-g.spacing,0);const C=i.convert(r);I.push({centerX:a,centerY:n,radius:P,angle:C,series:this})}for(let P=0;P<k.length;P+=1){const C=k[P],{value:_,text:V,size:z,shape:F,style:G}=C;if(_<Math.min(...i.domain)||_>Math.max(...i.domain))continue;const Y=this.getTargetRadius(C),K=i.convert(_),U=ah(C.rotation+m$[C.placement]);M.push({series:this,itemId:`target-${P}`,midPoint:{x:Y*Math.cos(K)+a,y:Y*Math.sin(K)+n},datum:{value:_},datumIndex:{type:1,index:P},type:1,value:_,text:V,centerX:a,centerY:n,shape:F,radius:Y,angle:K,rotation:U,size:z,label:this.getTargetLabel(C),style:G})}return{itemId:t,nodeData:A,needleData:I,targetData:M,labelData:D,scaleData:L,tickData:e}}updateSelections(e){(this.nodeDataRefresh||e)&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}highlightDatum(e){if(e!=null&&e.series===this&&e.type===1)return e}update({seriesRect:e}){const{datumSelection:t,labelSelection:i,needleSelection:o,targetSelection:s,targetLabelSelection:a,scaleSelection:n,highlightTargetSelection:r,tickSelection:l}=this,c=this.checkResize(e);this.updateSelections(c),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();const h=this.contextNodeData?.nodeData??[],d=this.contextNodeData?.labelData??[],u=this.contextNodeData?.needleData??[],g=this.contextNodeData?.targetData??[],m=this.contextNodeData?.scaleData??[],y=this.contextNodeData?.tickData??[],S=this.highlightDatum(this.ctx.highlightManager.getActiveHighlight());this.scaleSelection=this.updateScaleSelection({scaleData:m,scaleSelection:n}),this.updateScaleNodes({scaleSelection:n}),this.needleSelection=this.updateNeedleSelection({needleData:u,needleSelection:o}),this.updateNeedleNodes({needleSelection:o}),this.targetSelection=this.updateTargetSelection({targetData:g,targetSelection:s}),this.updateTargetStyles({targetSelection:s,isHighlight:!1}),this.updateTargetNodes({targetSelection:s}),this.targetLabelSelection=this.updateTargetLabelSelection({targetData:g,targetLabelSelection:a}),this.updateTargetLabelNodes({targetLabelSelection:a}),this.datumSelection=this.updateDatumSelection({nodeData:h,datumSelection:t}),this.updateDatumNodes({datumSelection:t}),this.labelSelection=this.updateLabelSelection({labelData:d,labelSelection:i}),this.updateLabelNodes({labelSelection:i}),this.highlightTargetSelection=this.updateTargetSelection({targetData:S==null?[]:[S],targetSelection:r}),this.updateTargetStyles({targetSelection:r,isHighlight:!0}),this.updateTargetNodes({targetSelection:r}),this.tickSelection=this.updateTickSelection({tickData:y,tickSelection:l}),this.updateTickNodes({tickSelection:l}),c&&this.animationState.transition("resize"),this.animationState.transition("update")}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>_g(e.nodeData.length,t.itemId))}updateDatumNodes(e){const{datumSelection:t}=e,{ctx:i,properties:o}=this,{segmentation:s}=o,a=s.spacing??0,n=i.animationManager.isSkipped(),r=this.getShapeFillBBox();t.each((l,c)=>{const{centerX:h,centerY:d,innerRadius:u,outerRadius:g,startCornerRadius:m,endCornerRadius:y}=c;l.centerX=h,l.centerY=d,l.innerRadius=u,l.outerRadius=g,l.pointerEvents=this.properties.bar.enabled?la.PointerEvents.All:la.PointerEvents.None,l.setStyleProperties(c.style,r),l.startOuterCornerRadius=m,l.startInnerCornerRadius=m,l.endOuterCornerRadius=y,l.endInnerCornerRadius=y,l.radialEdgeInset=(a+l.strokeWidth)/2,l.concentricEdgeInset=l.strokeWidth/2,(n||l.previousDatum==null)&&l.setProperties(Eg(l,c))}),this.datumUnion.update(t,this.itemGroup,la.Sector,(l,c,h)=>{l.clipSector??(l.clipSector=new u$(Number.NaN,Number.NaN,Number.NaN,Number.NaN)),l.centerX=c.centerX,l.centerY=c.centerY,l.outerRadius=l.clipSector.outerRadius=c.outerRadius,l.innerRadius=l.clipSector.innerRadius=c.innerRadius,l.startAngle=l.clipSector.startAngle=c.startAngle,l.startInnerCornerRadius=c.startInnerCornerRadius,l.startOuterCornerRadius=c.startOuterCornerRadius,l.endAngle=h.endAngle,l.clipSector.endAngle=h.clipSector?.endAngle??h.endAngle,l.endInnerCornerRadius=h.endInnerCornerRadius,l.endOuterCornerRadius=h.endOuterCornerRadius,l.pointerEvents=la.PointerEvents.None})}updateScaleSelection(e){return e.scaleSelection.update(e.scaleData,void 0,t=>_g(e.scaleData.length,t.itemId))}updateScaleNodes(e){const{scaleSelection:t}=e,{segmentation:i}=this.properties,o=i.spacing??0,s=this.getShapeFillBBox();t.each((a,n)=>{const{centerX:r,centerY:l,innerRadius:c,outerRadius:h,startCornerRadius:d,endCornerRadius:u}=n;a.centerX=r,a.centerY=l,a.innerRadius=c,a.outerRadius=h,a.setStyleProperties(n.style,s),a.startOuterCornerRadius=d,a.startInnerCornerRadius=d,a.endOuterCornerRadius=u,a.endInnerCornerRadius=u,a.radialEdgeInset=(o+a.strokeWidth)/2,a.concentricEdgeInset=a.strokeWidth/2,a.setProperties(Eg(a,n))})}updateNeedleSelection(e){return e.needleSelection.update(e.needleData,void 0,()=>_g(0))}updateNeedleNodes(e){const{needleSelection:t}=e,{fill:i,fillOpacity:o,stroke:s,strokeOpacity:a,strokeWidth:n,lineDash:r,lineDashOffset:l}=this.properties.needle,c=this.ctx.animationManager.isSkipped();t.each((h,d)=>{const{centerX:u,centerY:g,radius:m}=d,y=m*2;h.d=Cg.defaultPathData,h.setStyleProperties({fill:i,fillOpacity:o,stroke:s,strokeOpacity:a,strokeWidth:n/y,lineDash:r.map(S=>S/y),lineDashOffset:l/y}),h.translationX=u,h.translationY=g,h.scalingX=y,h.scalingY=y,c&&h.setProperties(qD(h,d))})}updateTargetSelection(e){return e.targetSelection.update(e.targetData,void 0,t=>t.itemId)}updateTargetStyles({targetSelection:e,isHighlight:t}){e.each((i,o)=>{o.style=this.getTargetStyle(t,o)})}updateTargetNodes({targetSelection:e}){e.each((t,i)=>{const{centerX:o,centerY:s,angle:a,radius:n,shape:r,size:l,rotation:c}=i;t.setStyleProperties(i.style),t.size=l,t.shape=r==="line"?wv:r,t.translationX=o+n*Math.cos(a),t.translationY=s+n*Math.sin(a),t.rotation=a+c})}getTargetStyle(e,{datumIndex:t,style:i}){const o=this.getHighlightStyle(e,t);return H3(o,{...i,opacity:1})}updateTargetLabelSelection(e){return e.targetLabelSelection.update(e.targetData,void 0,t=>t.itemId)}updateTargetLabelNodes(e){const{targetLabelSelection:t}=e;t.each((i,o)=>{const{centerX:s,centerY:a,radius:n,angle:r,text:l}=o,{offsetX:c,offsetY:h,fill:d,fontStyle:u,fontWeight:g,fontSize:m,fontFamily:y,textAlign:S,textBaseline:x}=o.label;if(l==null){i.visible=!1;return}i.visible=!0,i.x=s+n*Math.cos(r)+c,i.y=a+n*Math.sin(r)+h,i.text=l,i.fill=d,i.fontStyle=u,i.fontWeight=g,i.fontSize=m,i.fontFamily=y,i.textAlign=S,i.textBaseline=x})}updateLabelSelection(e){return e.labelSelection.update(e.labelData,void 0,t=>t.label)}updateLabelNodes(e){const{labelSelection:t}=e,i=this.ctx.animationManager.isSkipped();t.each((o,s)=>{o.fill=s.fill,o.fontStyle=s.fontStyle,o.fontWeight=s.fontWeight,o.fontFamily=s.fontFamily}),(i||this.labelsHaveExplicitText())&&this.formatLabelText()}updateTickSelection(e){return e.tickSelection.update(e.tickData,void 0,t=>t.index)}updateTickNodes(e){const{scale:t,radius:i,centerX:o,centerY:s,properties:a}=this,{enabled:n,color:r,fontFamily:l,fontSize:c,fontStyle:h,fontWeight:d,spacing:u}=a.scale.label,g=ah(a.scale.label.rotation??0);e.tickSelection.each((m,y)=>{if(!n){m.visible=!1;return}m.visible=!0,m.text=y.text,m.fill=r,m.fontFamily=l,m.fontSize=c,m.fontStyle=h,m.fontWeight=d,m.textAlign="center",m.textBaseline="middle";const S=t.convert(y.value),{width:x,height:b}=y,f=Math.abs(i*Math.cos(S)),v=Math.abs(i*Math.sin(S)),k=Math.min(Math.max(Math.abs(i/Math.tan(S)),f-x/2),f+x/2),A=Math.min(Math.max(Math.abs(i*Math.tan(S)),v-b/2),v+b/2),M=Math.hypot(k,A),I=o+(M+u)*Math.cos(S),D=s+(M+u)*Math.sin(S);m.x=I,m.y=D,m.rotationCenterX=I,m.rotationCenterY=D,m.rotation=g})}labelsHaveExplicitText(){for(const{datum:e}of this.labelSelection)if(e.text==null)return!1;return!0}formatLabelText(e){const{labelSelection:t,radius:i,textAlign:o,verticalAlign:s}=this,{spacing:a,innerRadiusRatio:n}=this.properties;c$(this,this.ctx,t,{padding:a,textAlign:o,verticalAlign:s},i*n,e)}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),QD([this.datumSelection],Eg),QD([this.needleSelection],qD),this.formatLabelText()}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"&&this.animationState.transition("skip")}animateLabelText(e={}){const{animationManager:t}=this.ctx;let i,o,s,a;if(this.labelSelection.each((n,r)=>{n.opacity=1,r.label==="primary"?(i=n.previousDatum?.value??e.from??r.value,o=r.value):r.label==="secondary"&&(s=n.previousDatum?.value??e.from??r.value,a=r.value)}),!this.labelsHaveExplicitText())if(o==null||a==null)this.formatLabelText();else if(i===o&&s===a)this.formatLabelText({label:o,secondaryLabel:a});else{const n=`${this.id}_labels`;t.animate({id:n,groupId:"label",from:{label:i,secondaryLabel:s},to:{label:o,secondaryLabel:a},phase:e.phase??"update",onUpdate:r=>this.formatLabelText(r),onStop:()=>this.formatLabelText({label:o,secondaryLabel:a})})}}animateEmptyUpdateReady(){const{animationManager:e}=this.ctx,{node:t,needle:i}=ZD(!0,this.scale.range[0]);Ar(this.id,"node",e,[this.datumSelection],t,(o,s)=>s.itemId),Ar(this.id,"needle",e,[this.needleSelection],i,()=>"needle"),Ar(this.id,"label",e,[this.labelSelection],Cv,(o,s)=>s.label),this.animateLabelText({from:this.properties.scale.min,phase:"initial"})}animateWaitingUpdateReady(){const{animationManager:e}=this.ctx,{node:t,needle:i}=ZD(!1,this.scale.range[0]);Ar(this.id,"node",e,[this.datumSelection],t,(o,s)=>s.itemId),Ar(this.id,"needle",e,[this.needleSelection],i,()=>"needle"),this.animateLabelText()}animateReadyResize(){this.resetAllAnimation()}dataCount(){return Number.NaN}getSeriesDomain(){return{domain:[Number.NaN,Number.NaN]}}getSeriesRange(){return[Number.NaN,Number.NaN]}getLegendData(){return[]}getTooltipContent(e){const{id:t,properties:i}=this,{tooltip:o}=i;let s,a,n;if(e.type===0?(s=i.value,a=i.label.text,n=this.ctx.localeManager.t("ariaLabelGaugeValue")):({value:s,text:a}=i.targets[e.index],n=this.ctx.localeManager.t("ariaLabelGaugeTarget")),s!=null)return this.formatTooltipWithContext(o,{data:[{label:a,fallbackLabel:n,value:this.formatLabel(s)}]},{seriesId:t,title:void 0,datum:void 0,value:s})}pickNodeClosestDatum(e){return Ov(this,e)}pickFocus(e){return Rv(this,e)}getCaptionText(){const{value:e}=this.properties,t=[];return t.push(this.formatLabel(e)),this.labelSelection.each((i,o)=>{const s=hr(this.id,this.ctx,o);s!=null&&t.push(G3(s))}),t.join(". ")}getCategoryValue(e){}datumIndexForCategoryValue(e){}hasItemStylers(){return this.properties.label.itemStyler!=null}};Bg.className="RadialGaugeSeries",Bg.type="radial-gauge";var tA={type:"series",name:"radial-gauge",chartType:"standalone",enterprise:!0,dependencies:[Mv],version:R3,options:_3,themeTemplate:{minWidth:200,minHeight:200,tooltip:{enabled:!1},series:{outerRadiusRatio:1,innerRadiusRatio:.8,startAngle:270,endAngle:450,defaultColorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$interpolate:[{$palette:"secondDivergingColors"},5]},oh.SAFE_RANGE2_OPERATION]},scale:{defaultFill:{$path:["/1",{$palette:"fill"},{$palette:"hierarchyColors"}]},stroke:{$path:["/2",oh.SAFE_STROKE_FILL_OPERATION,{$palette:"hierarchyColors"}]},strokeWidth:{$isUserOption:["./stroke",2,0]},label:{fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},spacing:12}},bar:{strokeWidth:{$isUserOption:["./stroke",2,0]}},segmentation:{enabled:!1,interval:{},spacing:2},defaultTarget:{fill:{$ref:"foregroundColor"},stroke:{$ref:"foregroundColor"},size:10,shape:"triangle",placement:"outside",spacing:5,label:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},spacing:5}},needle:{enabled:!1,fill:{$ref:"foregroundColor"},spacing:10},label:{...oh.LABEL_BOXING_DEFAULTS,enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:56,minimumFontSize:18/56,fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"}},secondaryLabel:{...oh.LABEL_BOXING_DEFAULTS,enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:E3.LARGE},minimumFontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"subtleTextColor"}},tooltip:{range:{$path:["/tooltip/range",10]}}}},create:e=>new Bg(e)};import{VERSION as x$,_ModuleSupport as Mr}from"ag-charts-community";import{_ModuleSupport as S$}from"ag-charts-community";import{Logger as b$,cachedTextMeasurer as v$,calcLineHeight as k$,mergeDefaults as lh,toPlainText as D$,wrapText as Vg}from"ag-charts-core";import{_ModuleSupport as A$}from"ag-charts-community";import{SceneChangeDetection as xn,Vec2 as at,clamp as M$}from"ag-charts-core";var{BBox:I$,Path:L$}=A$,ca=class extends L${constructor(){super(...arguments),this.x1=0,this.x2=0,this.y1=0,this.y2=0,this.height=0,this.inset=0,this.elbows=[]}computeBBox(){const e=Math.min(this.x1,this.x2),t=Math.max(this.x1,this.x2)-e,i=Math.min(this.y1,this.y2),o=Math.max(this.y1,this.y2)-i+this.height;return new I$(e,i,t,o)}updatePath(){const{path:e,inset:t}=this;e.clear();const i=this.height-2*this.inset,o=i/2;let s=this.x1+t,a=this.y1+t;e.moveTo(s,a);for(const l of this.elbows)this.updatePathSection(s,a,l.x,l.y,i,-o),s=l.x,a=l.y;const n=this.x2-t,r=this.y2+t;this.updatePathSection(s,a,n,r,i,-o),e.lineTo(n,r+i),s=n,a=r;for(const l of this.elbows.toReversed())this.updatePathSection(s,a,l.x,l.y,i,o),s=l.x,a=l.y;this.updatePathSection(s,a,this.x1+t,this.y1+t,i,o),e.closePath()}updatePathSection(e,t,i,o,s,a){const{path:n}=this,r=at.from(e,t+a+s/2),l=at.from(i,o+a+s/2);if(Math.abs(l.y-r.y)<2){n.lineTo(l.x,l.y);return}let c=at.angle(at.sub(l,r));c<0&&(c=2*Math.PI+c);const h=0,d=Math.PI/2,u=Math.PI,g=Math.PI*1.5,m=iA(r,l,0),y=iA(r,l,s);if(m.radius<s){n.cubicCurveTo((r.x+l.x)/2,r.y,(r.x+l.x)/2,l.y,l.x,l.y);return}c>=g?(n.arc(r.x,t-m.radius,m.radius,d,d+y.angle,!0),n.arc(l.x,o+y.radius,y.radius,g+y.angle,g),n.lineTo(l.x,l.y)):c>h&&c<=d?(n.arc(r.x,t+y.radius,y.radius,g,g+y.angle),n.arc(l.x,o-m.radius,m.radius,d+m.angle,d,!0),n.lineTo(l.x,l.y)):c>d&&c<=u?(n.arc(r.x,t+y.radius,y.radius-s,g,g+y.angle,!0),n.arc(l.x,o-m.radius,m.radius+s,d+m.angle,d),n.lineTo(l.x,l.y)):(n.arc(r.x,t-m.radius,m.radius+s,d,d+m.angle),n.arc(l.x,o+y.radius,y.radius-s,g+y.angle,g,!0),n.lineTo(l.x,l.y))}};p([xn()],ca.prototype,"x1",2),p([xn()],ca.prototype,"x2",2),p([xn()],ca.prototype,"y1",2),p([xn()],ca.prototype,"y2",2),p([xn()],ca.prototype,"height",2),p([xn()],ca.prototype,"inset",2);function iA(e,t,i){const o=at.angle(at.sub(t,e)),s=at.distance(e,t),a=at.add(e,at.rotate(at.from(s/2,0),o)),n=-1/at.gradient(e,t),r=at.intercept(a,n),l=N$(.1,.5,Math.PI/2-Math.abs(at.gradient(e,t))),c=at.intersectAtX(n,r,e.x),h=Math.max(i,at.distance(e,c)*l);return{angle:at.angle(at.sub(c,e),at.sub(c,a))/-(1.1-l),radius:h}}function N$(e,t,i){return M$(e,(t-e)*i+e,t)}import{_ModuleSupport as C$}from"ag-charts-community";import{BaseProperties as oA,Property as X}from"ag-charts-core";var{FillGradientDefaults:T$,FillPatternDefaults:w$,FillImageDefaults:P$,makeSeriesTooltip:O$,SeriesProperties:R$,Label:E$}=C$,ch=class extends E${constructor(){super(...arguments),this.spacing=1,this.placement=void 0,this.edgePlacement=void 0}};p([X],ch.prototype,"spacing",2),p([X],ch.prototype,"placement",2),p([X],ch.prototype,"edgePlacement",2);var Co=class extends oA{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};p([X],Co.prototype,"fill",2),p([X],Co.prototype,"fillOpacity",2),p([X],Co.prototype,"stroke",2),p([X],Co.prototype,"strokeOpacity",2),p([X],Co.prototype,"strokeWidth",2),p([X],Co.prototype,"lineDash",2),p([X],Co.prototype,"lineDashOffset",2),p([X],Co.prototype,"itemStyler",2);var Pt=class extends oA{constructor(){super(...arguments),this.spacing=1,this.minSpacing=0,this.width=1,this.alignment="justify",this.verticalAlignment="center",this.sort="auto",this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};p([X],Pt.prototype,"spacing",2),p([X],Pt.prototype,"minSpacing",2),p([X],Pt.prototype,"width",2),p([X],Pt.prototype,"alignment",2),p([X],Pt.prototype,"verticalAlignment",2),p([X],Pt.prototype,"sort",2),p([X],Pt.prototype,"fill",2),p([X],Pt.prototype,"fillOpacity",2),p([X],Pt.prototype,"stroke",2),p([X],Pt.prototype,"strokeOpacity",2),p([X],Pt.prototype,"strokeWidth",2),p([X],Pt.prototype,"lineDash",2),p([X],Pt.prototype,"lineDashOffset",2),p([X],Pt.prototype,"itemStyler",2);var He=class extends R${constructor(){super(...arguments),this.nodes=void 0,this.idKey="",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.sizeKey=void 0,this.sizeName=void 0,this.fillGradientDefaults=new T$,this.fillPatternDefaults=new w$,this.fillImageDefaults=new P$,this.defaultColorRange=[],this.defaultPatternFills=[],this.fills=[],this.strokes=[],this.label=new ch,this.link=new Co,this.node=new Pt,this.tooltip=O$()}getStyle(e,t,i,o){const{fillOpacity:s,strokeWidth:a,strokeOpacity:n,lineDash:r,lineDashOffset:l,fill:c=t[o%t.length],stroke:h=i[o%t.length]}=e?this.link:this.node;return{fill:c,fillOpacity:s,stroke:h,strokeWidth:a,strokeOpacity:n,lineDash:r,lineDashOffset:l}}};p([X],He.prototype,"nodes",2),p([X],He.prototype,"fromKey",2),p([X],He.prototype,"toKey",2),p([X],He.prototype,"idKey",2),p([X],He.prototype,"idName",2),p([X],He.prototype,"labelKey",2),p([X],He.prototype,"labelName",2),p([X],He.prototype,"sizeKey",2),p([X],He.prototype,"sizeName",2),p([X],He.prototype,"fillGradientDefaults",2),p([X],He.prototype,"fillPatternDefaults",2),p([X],He.prototype,"fillImageDefaults",2),p([X],He.prototype,"defaultColorRange",2),p([X],He.prototype,"defaultPatternFills",2),p([X],He.prototype,"fills",2),p([X],He.prototype,"strokes",2),p([X],He.prototype,"label",2),p([X],He.prototype,"link",2),p([X],He.prototype,"node",2),p([X],He.prototype,"tooltip",2);var{Transformable:_$,SeriesNodePickMode:sA,createDatumId:hh,getShapeStyle:aA,getLabelStyles:B$,Rect:nA,BBox:rA}=S$,zg=class extends jb{constructor(e){super({moduleCtx:e,pickModes:[sA.NEAREST_NODE,sA.EXACT_SHAPE_MATCH]}),this.properties=new He}isLabelEnabled(){return(this.properties.labelKey!=null||this.nodes==null)&&this.properties.label.enabled}linkFactory(){return new ca}nodeFactory(){return new nA}createNodeData(){const e=this._nodeDataDependencies?.seriesRectWidth??0,t=this.properties.node.width,{nodeGraph:i,links:o,maxPathLength:s}=this.getNodeGraph(this.createNode.bind(this,t),this.createLink,{includeCircularReferences:!1}),a=i;if(a.size===0)return;const n=this.initialiseColumns(s);this.assignNodesToColumns(a,n,s);const r=v$(this.properties.label),{columnLabelInsetBefore:l,columnLabelInsetAfter:c}=this.getColumnLabelInsets(n,r,s),h=(e-t-l-c)/(s-1);this.positionNodesInColumnsX(n,h,l),this.createGhostNodesAndColumnDiffs(a,n),this.weightNodes(n);const d=1,{sizeScale:u,nodeSpacing:g}=this.getScaleAndSpacing(n,d);if(u<0){b$.warnOnce("There was insufficient space to display the Sankey Series. Reduce [node.spacing], [node.minSpacing], or provide a larger container.");return}this.positionNodesInColumnsY(n,d,u,g),this.sortAndPositionLinks(a,u);const m=[],y=[];return this.createNodesNodeData(m,a,n,h,r,y),this.createLinksNodeData(m,o,d,u),{itemId:this.id,nodeData:m,labelData:y}}createNode(e,t){return{...t,x:Number.NaN,y:Number.NaN,width:e,height:Number.NaN}}createLink(e){return{...e,x1:Number.NaN,x2:Number.NaN,y1:Number.NaN,y2:Number.NaN,height:Number.NaN,elbows:[]}}initialiseColumns(e){const t=[];for(let i=0;i<e;i+=1)t.push({index:i,size:0,nodes:[],x:0});return t}assignNodesToColumns(e,t,i){const{fromKey:o,toKey:s,sizeKey:a,labelKey:n}=this.properties;for(const r of e.values()){const{datum:l,linksBefore:c,linksAfter:h}=r,d=Math.max(c.reduce((y,{link:S})=>y+S.size,0),h.reduce((y,{link:S})=>y+S.size,0));if(c.length===0&&h.length===0||d===0){r.columnIndex=-1;continue}const u=this.getNodeColumn(t,r,i);l.size=d;const{label:g}=this.properties,m=g.enabled?this.getLabelText(l.label,l.datum,n,"label",[],this.properties.label,{datum:l.datum,value:l.label,fromKey:o,toKey:s,sizeKey:a,size:d}):void 0;l.label=D$(m),u.nodes.push(r),u.size+=d,r.columnIndex=u.index}}getNodeColumn(e,t,i){const{node:{alignment:o}}=this.properties,{linksBefore:s,linksAfter:a,maxPathLengthBefore:n,maxPathLengthAfter:r}=t;let l;switch(o){case"left":l=e[n];break;case"right":l=e[i-1-r];break;case"center":{if(s.length!==0)l=e[n];else if(a.length===0)l=e[0];else{const c=a.reduce((h,d)=>Math.min(h,d.node.maxPathLengthBefore),i)-1;l=e[c]}break}case"justify":{l=a.length===0?e[i-1]:e[n];break}}return l}getColumnLabelInsets(e,t,i){const{label:{spacing:o,placement:s,edgePlacement:a},node:{width:n}}=this.properties,r=this._nodeDataDependencies?.seriesRectWidth??0;let l=0,c=0;if(this.isLabelEnabled()&&(a==="outside"||a==null)){const h=(d,u)=>{const g=u;if(g.datum.label==null||g.datum.label==="")return d;let m=(r-n)/(i-1)-o;s==="center"&&a==null&&(m/=2);const y=Vg(g.datum.label,{maxWidth:m,maxHeight:g.datum.height,font:this.properties.label,textWrap:"never"});let{width:S}=t.measureLines(y);return s==="center"&&a==null&&(S/=2),Math.max(d,S)};(s!=="right"||a==="outside")&&(l=n+e[0].nodes.reduce(h,0)),(s!=="left"||a==="outside")&&(c=n+e.at(-1).nodes.reduce(h,0))}return{columnLabelInsetBefore:l,columnLabelInsetAfter:c}}positionNodesInColumnsX(e,t,i){for(let o=0;o<e.length;o++){const s=e[o];s.x=i+o*t;for(const a of s.nodes)a.datum.x=s.x}}createGhostNodesAndColumnDiffs(e,t){for(const i of e.values()){i.weight=0;let o=1/0;for(const s of i.linksAfter){const a=s.node;o=Math.min(o,a.columnIndex-i.columnIndex)}if(o===1/0)for(const s of i.linksBefore){const a=s.node;o=Math.min(o,i.columnIndex-a.columnIndex)}i.closestColumnDiff=o,this.createNodeGhostNodes(i,t,o)}}createNodeGhostNodes(e,t,i){for(const o of e.linksAfter){const s=o.node;if(!(s.columnIndex<=e.columnIndex))for(let a=s.columnIndex-1;a>e.columnIndex;a--){const n=o.link.size,r={ghost:!0,datum:{...e.datum,size:n,y:0,height:0},weight:0,linksBefore:[{node:{columnIndex:a-1,datum:{size:n}}}],linksAfter:[{node:{columnIndex:a+1,datum:{size:n}}}],link:o.link,columnIndex:e.columnIndex,size:e.datum.size,closestColumnDiff:i,fromNode:{y:s.datum.y},toNode:{y:0}};t[a].size+=n,t[a].nodes.push(r)}}}weightNodes(e){const{properties:t}=this;if(t.node.sort==="data")return;if(t.node.sort!=="auto"){for(const s of e)s.nodes.sort((a,n)=>this.sortNodes(a,n));return}const i=e.toSorted((s,a)=>{const n=s.nodes.reduce((l,c)=>Math.max(l,c.datum.size),0);return a.nodes.reduce((l,c)=>Math.max(l,c.datum.size),0)-n}),o={};for(let s=0;s<i.length;s++)o[i[s].index]=Math.pow(10,i.length-s-1);for(const s of e){for(const a of s.nodes){if("ghost"in a&&a.ghost){a.weight=a.size/s.size*o[s.index];continue}a.weight=a.datum.size/s.size*o[s.index]}s.nodes.sort((a,n)=>a.weight-n.weight)}for(const s of e){for(const a of s.nodes)"ghost"in a&&a.ghost||(a.weight+=a.linksBefore.reduce((n,r)=>{if(r.node.columnIndex!==s.index-1)return n;const l=e[r.node.columnIndex].nodes.indexOf(r.node)*o[r.node.columnIndex];return Math.max(n,l)},0),a.weight+=a.linksAfter.reduce((n,r)=>{if(r.node.columnIndex!==s.index+1)return n;const l=e[r.node.columnIndex].nodes.indexOf(r.node)*o[r.node.columnIndex];return Math.max(n,l)},0));s.nodes.sort((a,n)=>this.sortNodes(a,n))}}getScaleAndSpacing(e,t){const i=this._nodeDataDependencies?.seriesRectHeight??0,o=n=>e.reduce((r,{size:l,nodes:c})=>{const h=i-c.length*t,u=(1-(c.length-1)*n/h)/l;return Math.min(r,u)},1/0);let s=this.properties.node.spacing,a=o(s);for(;a<0&&s>this.properties.node.minSpacing;)s-=1,a=o(s);return{nodeSpacing:s,sizeScale:a}}positionNodesInColumnsY(e,t,i,o){const s=this._nodeDataDependencies?.seriesRectHeight??0;for(const a of e){let n=0;for(const c of a.nodes){const h=s*c.datum.size*i;c.datum.height=Math.max(t,h),n+=h}const r=o*(a.nodes.length-1);let l=0;this.properties.node.verticalAlignment==="bottom"?l=s-n-r:this.properties.node.verticalAlignment==="center"&&(l=(s-n-r)/2);for(const c of a.nodes)c.datum.y=l,l+=s*c.datum.size*i+o,"ghost"in c&&c.ghost&&c.link.elbows.push({x:a.x,y:c.datum.y})}}sortAndPositionLinks(e,t){const i=this._nodeDataDependencies?.seriesRectHeight??0;for(const{datum:o,linksBefore:s,linksAfter:a}of e.values()){let n=o.y;s.sort((l,c)=>this.sortNodes(l.node,c.node));for(const{link:l}of s)l.y2=n,n+=l.size*i*t;let r=o.y;a.sort((l,c)=>this.sortNodes(l.node,c.node,{invertColumnSort:!0}));for(const{link:l}of a)l.y1=r,r+=l.size*i*t}}createNodesNodeData(e,t,i,o,s,a){for(const[n,r]of i.entries()){const l=n===0,c=n===i.length-1;let h=-1/0;r.nodes.sort((d,u)=>d.datum.y-u.datum.y);for(const d of r.nodes){if("ghost"in d&&d.ghost)continue;const{datum:u}=d;u.midPoint={x:u.x+u.width/2,y:u.y+u.height/2},e.push(u),h=this.createNodeLabelData(t,o,s,a,u,l,c,h)}}}createNodeLabelData(e,t,i,o,s,a,n,r){if(s.label==null)return r;const{label:{spacing:l,edgePlacement:c,fontSize:h}}=this.properties,d=this._nodeDataDependencies?.seriesRectWidth??0,u=s.y+s.height/2;let g;if(!a&&!n){const f=k$(h),v=u-f,k=u+f;let A=d;for(const{datum:I}of e.values())I.x>s.x&&Math.max(I.y,v)<=Math.min(I.y+I.height,k)&&(A=Math.min(A,I.x-l));const M=A-s.x-2*l;g=Vg(s.label,{maxWidth:M,maxHeight:s.height,font:this.properties.label,textWrap:"never",overflow:"hide"})}if(g==null||g===""){const f=c==null&&(a||n)?l:l*2;g=Vg(s.label,{maxWidth:t-f,maxHeight:s.height,font:this.properties.label,textWrap:"never"})}if(g==="")return r;const{height:m}=i.measureLines(g),y=u-m/2,S=u+m/2,{x,textAlign:b}=this.getNodeLabelPlacement(s,a,n);return y>=r&&(o.push({x,y:u,textAlign:b,text:g,size:s.size,nodeDatum:s,datumIndex:s.datumIndex}),r=S),r}getNodeLabelPlacement(e,t,i){const{label:{spacing:o,placement:s,edgePlacement:a}}=this.properties;let n=e.x+e.width+o,r="left",l=s;return t&&a==null&&s==null&&(l="left"),a==="outside"?(t&&(l="left"),i&&(l="right")):a==="inside"&&(t&&(l="right"),i&&(l="left")),l==="left"?(n=e.x-o,r="right"):l==="center"&&(n=e.x+e.width/2,r="center"),{x:n,textAlign:r}}createLinksNodeData(e,t,i,o){const s=this._nodeDataDependencies?.seriesRectHeight??0,a=this.properties.node.width;for(const n of t){const{fromNode:r,toNode:l,size:c}=n;n.height=Math.max(i,s*c*o),n.x1=r.x+a,n.x2=l.x,n.midPoint={x:(n.x1+n.x2)/2,y:(n.y1+n.y2)/2+n.height/2},e.push(n)}}sortNodes(e,t,i){const{properties:o}=this;return o.node.sort==="ascending"?(e.datum.label??"").localeCompare(t.datum.label??""):o.node.sort==="descending"?(t.datum.label??"").localeCompare(e.datum.label??""):o.node.sort==="data"?0:e.columnIndex<t.columnIndex?i?.invertColumnSort?1:-1:e.columnIndex>t.columnIndex?i?.invertColumnSort?-1:1:e.weight===t.weight?e.datum.size-t.datum.size:e.closestColumnDiff<t.closestColumnDiff?1:e.closestColumnDiff>t.closestColumnDiff?-1:e.weight-t.weight}updateLabelSelection(e){const t=this.isLabelEnabled()?e.labelData:[];return e.labelSelection.update(t)}updateLabelNodes(e){const t=this.getHighlightedDatum();e.labelSelection.each((i,o)=>{const{x:s,y:a,textAlign:n,text:r,datumIndex:l,nodeDatum:c}=o,h=o,d=this.isLabelHighlighted(c,t),u=this.getHighlightStyle(d,l),g=B$(this,void 0,h,this.properties.label,d,t),{color:m,fontStyle:y,fontWeight:S,fontSize:x,fontFamily:b}=g;i.visible=!0,i.x=s,i.y=a,i.text=r,i.fill=m,i.fontStyle=y,i.fontWeight=S,i.fontSize=x,i.fontFamily=b,i.textAlign=n,i.textBaseline="middle";const f=u.opacity??1;i.opacity=f,i.fillOpacity=f,i.setBoxing(g)})}updateNodeSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>hh(t.type,t.id))}getNodeStyle(e,t,i){const{properties:o}=this,{fills:s,strokes:a,defaultColorRange:n,defaultPatternFills:r,fillGradientDefaults:l,fillPatternDefaults:c,fillImageDefaults:h}=o,{itemStyler:d}=o.node,u=n[t%n.length].map(b=>({color:b})),g=r[t%r.length],m=this.getHighlightStyle(i,e.datumIndex),y=lh(m,o.getStyle(!1,s,a,t)),S=o.node.fill!=null;let x=aA(y,S?l:{...l.toJson(),colorStops:u},S?c:{...c.toJson(),fill:g,stroke:g},h);if(d!=null&&e.datumIndex!=null){const b=this.cachedDatumCallback(hh(e.datumIndex.index,"node",i?"highlight":"node"),()=>{const f=this.makeItemStylerParams(e,i,x);return this.callWithContext(d,f)});b&&(x=lh(b,x,{...l.toJson(),colorStops:u},{...c.toJson(),fill:g,stroke:g},h))}return x.opacity=1,x}makeItemStylerParams({datum:e,datumIndex:t,size:i=0,label:o},s,a){const{id:n}=this,r=this.ctx.highlightManager?.getActiveHighlight(),l=this.getHighlightStateString(r,s,t),c=this.filterItemStylerFillParams(a.fill)??a.fill;return{seriesId:n,datum:e,highlightState:l,...a,size:i,label:o,fill:c}}updateNodeNodes(e){const{datumSelection:t,isHighlight:i}=e,o=this.getShapeFillBBox();t.each((s,a)=>{const{datumIndex:n}=a,r=this.getNodeStyle(a,n.index,i);s.x=a.x,s.y=a.y,s.width=Math.max(a.width,0),s.height=Math.max(a.height,0),s.setStyleProperties(r,o)})}getShapeFillBBox(){const e=this._nodeDataDependencies?.seriesRectWidth??0,t=this._nodeDataDependencies?.seriesRectHeight??0,i=new rA(0,0,e,t);return{series:i,axis:i}}updateLinkSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>hh(t.type,t.index,t.fromNode.id,t.toNode.id))}getLinkStyle({datumIndex:e,datum:t},i,o){const{id:s,properties:a}=this,{fills:n,strokes:r,defaultColorRange:l,defaultPatternFills:c,fillGradientDefaults:h,fillPatternDefaults:d,fillImageDefaults:u}=a,{itemStyler:g}=a.link,m=l[i.index%l.length].map(v=>({color:v})),y=c[i.index%c.length],S=this.getHighlightStyle(o,e),x=lh(S,a.getStyle(!0,n,r,i.index)),b=a.link.fill!=null;let f=aA(x,b?h:{...h.toJson(),colorStops:m},b?d:{...d.toJson(),fill:y,stroke:y},u);if(g!=null&&e!=null){const v=this.cachedDatumCallback(hh(e.index,"link",o?"highlight":"node"),()=>{const k=this.ctx.highlightManager?.getActiveHighlight(),A=this.getHighlightStateString(k,o,e);return this.callWithContext(g,{seriesId:s,datum:t,highlightState:A,...f})});v&&(f=lh(v,f,{...h.toJson(),colorStops:m},{...d.toJson(),fill:y,stroke:y},u))}return f.opacity=1,f}updateLinkNodes(e){const{datumSelection:t,isHighlight:i}=e,o=this.getShapeFillBBox();t.each((s,a)=>{const n=a.fromNode.datumIndex,r=this.getLinkStyle(a,n,i);s.x1=a.x1,s.y1=a.y1,s.x2=a.x2,s.y2=a.y2,s.height=a.height,s.elbows=a.elbows,s.setStyleProperties(r,o),s.inset=s.strokeWidth/2})}getTooltipContent(e){const{id:t,linksProcessedData:i,nodesProcessedData:o,properties:s,ctx:{formatManager:a}}=this,{fromKey:n,toKey:r,sizeKey:l,sizeName:c,tooltip:h}=s,d=this.contextNodeData?.nodeData.find(b=>b.datumIndex.type===e.type&&b.datumIndex.index===e.index);if(d==null)return;const u=d.type===0?d.fromNode.index:d.index,g=d.type===0?`${d.fromNode.label} - ${d.toNode.label}`:d.label,m=e.type===0?i?.dataSources.get(this.id)?.data[e.index]:o?.dataSources.get(this.id)?.data[e.index],y=d.size;let S;if(d.type===0){const b=d.fromNode.datumIndex;S=this.getLinkStyle({datumIndex:e,datum:m},b,!1)}else S=this.getNodeStyle({datumIndex:e,datum:m},e.index,!1);const x=[];if(l!=null){const b=a.format(this.callWithContext.bind(this),{type:"number",value:y,datum:m,seriesId:t,legendItemName:void 0,key:l,source:"tooltip",property:"size",domain:[],boundSeries:this.getFormatterContext("size"),fractionDigits:void 0});x.push({label:c,fallbackLabel:l,value:b??String(y)})}return this.formatTooltipWithContext(h,{title:g,symbol:this.legendItemSymbol(d.type,u,S),data:x},{seriesId:t,datum:m,title:g,fromKey:n,toKey:r,sizeKey:l,sizeName:c,size:y,...S})}computeFocusBounds(e){if(e instanceof nA){const{x:t,y:i,width:o,height:s}=e,a=new rA(t,i,o,s);return _$.toCanvas(this.contentGroup,a)}return e}hasItemStylers(){return this.properties.node.itemStyler!=null||this.properties.link.itemStyler!=null||this.properties.label.itemStyler!=null}};zg.className="SankeySeries",zg.type="sankey";import{_ModuleSupport as V$}from"ag-charts-community";import{arrayOf as Fg,color as lA,commonSeriesOptionsDefs as z$,constant as F$,fillGradientDefaults as H$,fillImageDefaults as W$,fillPatternDefaults as K$,required as Hg,string as dh,undocumented as Ir}from"ag-charts-core";var{sankeySeriesThemeableOptionsDef:G$}=V$,Sn={...G$,...z$,type:Hg(F$("sankey")),fromKey:Hg(dh),toKey:Hg(dh),sizeKey:dh,sizeName:dh};Sn.fillGradientDefaults=Ir(H$),Sn.fillPatternDefaults=Ir(K$),Sn.fillImageDefaults=Ir(W$),Sn.defaultColorRange=Ir(Fg(Fg(lA))),Sn.defaultPatternFills=Ir(Fg(lA));var cA={type:"series",name:"sankey",chartType:"standalone",enterprise:!0,solo:!0,version:x$,dependencies:[an],options:Sn,themeTemplate:{seriesArea:{padding:{top:10,bottom:10}},series:{fills:{$palette:"fills"},strokes:{$palette:"strokes"},fillGradientDefaults:Mr.FILL_GRADIENT_LINEAR_DEFAULTS,fillPatternDefaults:Mr.FILL_PATTERN_DEFAULTS,fillImageDefaults:Mr.FILL_IMAGE_DEFAULTS,defaultColorRange:{$palette:"gradients"},defaultPatternFills:Mr.SAFE_FILLS_OPERATION,highlight:{unhighlightedItem:{opacity:.5}},label:{...Mr.LABEL_BOXING_DEFAULTS,enabled:!0,fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:10},node:{spacing:{$if:[{$greaterThan:[{$path:"./minSpacing"},20]},{$path:"./minSpacing"},20]},minSpacing:0,width:10,strokeWidth:{$isUserOption:["./stroke",2,0]}},link:{fillOpacity:.5,strokeWidth:{$isUserOption:["./stroke",2,0]}}},legend:{enabled:!1,toggleSeries:!1}},create:e=>new zg(e)};import{VERSION as $$,_ModuleSupport as Lr}from"ag-charts-community";import{BASE_FONT_SIZE as hA,FONT_SIZE_RATIO as dA}from"ag-charts-core";import{_ModuleSupport as Wg}from"ag-charts-community";import{formatValue as pA,isGradientFill as uA,mergeDefaults as gA,normalizeAngle360 as Y$,toPlainText as mA}from"ag-charts-core";import{_ModuleSupport as U$}from"ag-charts-community";import{BaseProperties as j$,Property as Ee}from"ag-charts-core";var{HierarchySeriesProperties:X$,makeSeriesTooltip:Z$,HighlightProperties:q$}=U$,ms=class extends j${};p([Ee],ms.prototype,"fill",2),p([Ee],ms.prototype,"fillOpacity",2),p([Ee],ms.prototype,"stroke",2),p([Ee],ms.prototype,"strokeWidth",2),p([Ee],ms.prototype,"strokeOpacity",2),p([Ee],ms.prototype,"opacity",2);var Kg=class extends q${constructor(){super(...arguments),this.highlightedBranch=new ms,this.unhighlightedBranch=new ms}};p([Ee],Kg.prototype,"highlightedBranch",2),p([Ee],Kg.prototype,"unhighlightedBranch",2);var Ot=class extends X${constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=0,this.strokeOpacity=1,this.cornerRadius=0,this.highlight=new Kg,this.label=new Ka,this.secondaryLabel=new Xl,this.tooltip=Z$()}getStyle(e){const{fills:t,strokes:i,fillOpacity:o,strokeWidth:s,strokeOpacity:a}=this;return{fill:t[e%t.length],fillOpacity:o,stroke:i[e%i.length],strokeWidth:s,strokeOpacity:a,opacity:1}}};p([Ee],Ot.prototype,"sizeName",2),p([Ee],Ot.prototype,"labelKey",2),p([Ee],Ot.prototype,"secondaryLabelKey",2),p([Ee],Ot.prototype,"fillOpacity",2),p([Ee],Ot.prototype,"strokeWidth",2),p([Ee],Ot.prototype,"strokeOpacity",2),p([Ee],Ot.prototype,"cornerRadius",2),p([Ee],Ot.prototype,"sectorSpacing",2),p([Ee],Ot.prototype,"padding",2),p([Ee],Ot.prototype,"itemStyler",2),p([Ee],Ot.prototype,"highlight",2),p([Ee],Ot.prototype,"label",2),p([Ee],Ot.prototype,"secondaryLabel",2),p([Ee],Ot.prototype,"tooltip",2);var{fromToMotion:Q$,createDatumId:J$,PointerEvents:e5,Sector:yA,Group:ph,ScalableGroup:t5,Selection:Gg,TransformableText:$g,BBox:fA,getLabelStyles:i5,toHierarchyHighlightString:o5}=Wg,s5=class extends Wg.HierarchyNode{constructor(){super(...arguments),this.label=void 0,this.secondaryLabel=void 0,this.contentHeight=0,this.bbox=void 0,this.startAngle=0,this.endAngle=0}};function xA(e,t=0,i=2*Math.PI/e.sumSize){for(const o of e.children){const s=t+o.sumSize*i;o.startAngle=t,o.endAngle=s,xA(o,t,i),t=s}}var Yg=class extends Wg.HierarchySeries{constructor(e){super(e),this.NodeClass=s5,this.properties=new Ot,this.scalingGroup=this.contentGroup.appendChild(new t5),this.sectorGroup=this.scalingGroup.appendChild(new ph),this.highlightSectorGroup=this.scalingGroup.appendChild(new ph),this.sectorLabelGroup=this.scalingGroup.appendChild(new ph),this.datumSelection=Gg.select(this.sectorGroup,yA),this.labelSelection=Gg.select(this.sectorLabelGroup,ph),this.highlightSelection=Gg.select(this.highlightSectorGroup,yA),this.sectorLabelGroup.pointerEvents=e5.None}processData(){super.processData(),xA(this.rootNode)}updateSelections(){const e=this.getActiveHighlightNode();if(this.highlightSelection.update(e==null?[]:[e],void 0,a=>this.getDatumId(a)),!this.nodeDataRefresh)return;this.nodeDataRefresh=!1;const{chart:t}=this;if(t==null||t.seriesRect==null)return;const o=Array.from(this.rootNode),s=a=>{a.append([new $g({tag:0}),new $g({tag:1})])};this.datumSelection.update(o,void 0,a=>this.getDatumId(a)),this.labelSelection.update(o,s,a=>this.getDatumId(a))}getItemStyle(e,t){const{properties:i,colorScale:o}=this,{itemStyler:s}=i,a=e.datumIndex?.[0]??0,n=this.getActiveHighlightNode(),r=this.getHierarchyHighlightState(t,n,e),l=this.getHierarchyHighlightStyles(r,this.properties.highlight),c=gA(l,i.getStyle(a));e.colorValue!=null&&l?.fill==null&&(c.fill=o.convert(e.colorValue));let h=c;if(s!=null&&e!=null){const d=this.cachedDatumCallback(J$(this.getDatumId(e),t?"highlight":"node"),()=>{const u=this.makeItemStylerParams(e,h,o5(r));return this.callWithContext(s,u)});d&&(h=gA(d,h))}return h}makeItemStylerParams(e,t,i){const{id:o}=this,s=this.filterItemStylerFillParams(t.fill)??t.fill;return{seriesId:o,datum:e.datum,depth:e.depth??0,highlightState:i,...t,fill:s}}updateNodes(){const{chart:e,data:t,maxDepth:i}=this;if(e==null||t==null)return;const{width:o,height:s}=e.seriesRect,{sectorSpacing:a=0,padding:n=0,cornerRadius:r,childrenKey:l,colorKey:c,colorName:h,labelKey:d,secondaryLabelKey:u,sizeKey:g,sizeName:m}=this.properties;this.contentGroup.translationX=o/2,this.contentGroup.translationY=s/2;const y=a*.5,S=Math.min(o,s)/2,x=S/(i+1),b=-Math.PI/2,f={series:new fA(-S,-S,2*S,2*S),axis:new fA(-S,-S,2*S,2*S)};this.rootNode?.walk(I=>{const{startAngle:D,endAngle:L}=I;if(I.depth!=null){const N=(D+L)/2+b,T=(I.depth+.5)*x;I.midPoint.x=Math.cos(N)*T,I.midPoint.y=Math.sin(N)*T}}),this.rootNode?.walk(I=>{const{datum:D,depth:L,startAngle:N,endAngle:T,parent:O,sumSize:R}=I;I.label=void 0,I.secondaryLabel=void 0,I.contentHeight=0;let w;if(D!=null&&L!=null&&d!=null){const te=D[d];w=this.getLabelText(te,D,d,"label",[],this.properties.label,{depth:L,datum:D,childrenKey:l,colorKey:c,colorName:h,labelKey:d,secondaryLabelKey:u,sizeKey:g,sizeName:m,value:te})}w===""&&(w=void 0);let E;if(D!=null&&L!=null&&u!=null){const te=D[u];E=this.getLabelText(te,D,u,"secondaryLabel",[],this.properties.secondaryLabel,{depth:L,datum:D,childrenKey:l,colorKey:c,colorName:h,labelKey:d,secondaryLabelKey:u,sizeKey:g,sizeName:m,value:te})}if(E===""&&(E=void 0),L==null)return;const B=L*x+y,P=(L+1)*x-y,C=B>y?y/B:y,_=P>y?y/P:y,V=N+C,F=T+C-V,G=N+_,K=T+_-G,U=te=>{if(L===0&&O?.sumSize===R)return{width:2*Math.sqrt(P**2-(te*.5)**2),height:te,meta:0};const ue=te,ke=2*Math.sqrt(P**2-(B+ue)**2),ni=F<Math.PI?2*B*Math.tan(F*.5):1/0,Po=Math.min(ke,ni),ga=Math.PI/4;let Di,_i;return L===0?(Di=te,_i=Math.sqrt(P**2-(Di/2)**2)-te/(2*Math.tan(K*.5))):Y$(F)<ga?(Di=2*B*Math.tan(F*.5),_i=Math.sqrt(P**2-(Di/2)**2)-B):(_i=0,Di=0),Po>=_i?{width:Po,height:ue,meta:1}:{width:_i,height:Di,meta:2}},ee=mp(mA(w),this.properties.label,mA(E),this.properties.secondaryLabel,{padding:n},U);if(ee==null)return;const{width:re,height:ye,meta:le,label:ie,secondaryLabel:ce}=ee,pe=b+(N+T)/2,he=Math.sin(pe)>=0,Q=Math.cos(pe)>=0,Ne=(he?3:12)&(Q?6:9);let ve;switch(le){case 0:ve=0;break;case 1:{const ne=P-(x-ye)*.58,ue=Math.sqrt((P-n)**2-(re/2)**2);ve=Math.min(ne,ue);break}case 2:if(L===0){const te=ye/(2*Math.tan(F*.5))+re*.5,ne=Math.sqrt(P**2-(ye*.5)**2)-re*.5;ve=(te+ne)*.5}else ve=(B+P)*.5;break}if(ie!=null){const{fontStyle:te="normal",fontFamily:ne,fontWeight:ue="normal",color:ke="black"}=this.properties.label;I.label={...ie,fontStyle:te,fontFamily:ne,fontWeight:ue,color:ke,labelPlacement:le,circleQuarter:Ne,radius:ve,theta:pe}}if(ce!=null){const{fontStyle:te="normal",fontFamily:ne,fontWeight:ue="normal",color:ke="black"}=this.properties.secondaryLabel;I.secondaryLabel={...ce,fontStyle:te,fontFamily:ne,fontWeight:ue,color:ke,labelPlacement:le,circleQuarter:Ne,radius:ve,theta:pe}}I.contentHeight=ee.height});const v=(I,D,L)=>{const{depth:N,startAngle:T,endAngle:O}=I;if(N==null){D.visible=!1;return}D.visible=!0;const R=this.getItemStyle(I,L),w=R.fill,E=R.strokeWidth,B=uA(w)&&w.bounds!=="item"?f:void 0;D.setStyleProperties(R,B),D.centerX=0,D.centerY=0,D.innerRadius=N*x,D.outerRadius=(N+1)*x,D.startAngle=T+b,D.endAngle=O+b,D.inset=y+E*.5,D.cornerRadius=r};this.datumSelection.each((I,D)=>{v(D,I,!1)}),this.highlightSelection.each((I,D)=>{v(D,I,!0)});const k=this.getActiveHighlightNode(),A=(I,D,L,N)=>{const{depth:T,contentHeight:O}=I,R=L===0,w=R?I.label:I.secondaryLabel;if(T==null||w==null){D.visible=!1;return}const{labelPlacement:E,circleQuarter:B,radius:P,theta:C}=w,_=this.getHierarchyHighlightState(N,k,I),{opacity:V}=this.getHierarchyHighlightStyles(_,this.properties.highlight)??{},z={childrenKey:this.properties.childrenKey,colorKey:this.properties.colorKey,colorName:this.properties.colorName??this.properties.colorKey,depth:I.depth??Number.NaN,labelKey:this.properties.labelKey,secondaryLabelKey:this.properties.secondaryLabelKey,sizeKey:this.properties.sizeKey,sizeName:this.properties.sizeName??this.properties.sizeKey},F=R?this.properties.label:this.properties.secondaryLabel,G=this.ctx.highlightManager?.getActiveHighlight(),Y=i5(this,I,z,F,N,G);switch(D.text=w.text,D.fontSize=w.fontSize,D.lineHeight=w.lineHeight,D.fontStyle=w.fontStyle,D.fontFamily=w.fontFamily,D.fontWeight=w.fontWeight,D.fillOpacity=V??1,D.fill=Y.color,D.setBoxing(Y),E){case 0:D.textAlign="center",D.textBaseline="top",D.translationX=0,D.translationY=(R?0:O-w.height)-O*.5,D.rotation=0;break;case 1:{const K=(B&3)!==0,U=R===!K?P:P-(O-w.height);D.textAlign="center",D.textBaseline=K?"bottom":"top",D.translationX=Math.cos(C)*U,D.translationY=Math.sin(C)*U,D.rotation=K?C-Math.PI*.5:C+Math.PI*.5;break}case 2:{const K=(B&6)!==0,U=R===!K?(O-w.height)*.5:(w.height-O)*.5;D.textAlign="center",D.textBaseline="middle",D.translationX=Math.cos(C)*P+Math.cos(C+Math.PI/2)*U,D.translationY=Math.sin(C)*P+Math.sin(C+Math.PI/2)*U,D.rotation=K?C:C+Math.PI;break}}D.visible=!0},M=this.getActiveHighlightNode();for(const I of this.labelSelection.selectByClass($g)){const D=I.closestDatum();A(D,I,I.tag,D===M)}}getTooltipContent(e){const{id:t,properties:i,ctx:o}=this,{labelKey:s,secondaryLabelKey:a,childrenKey:n,sizeKey:r,sizeName:l,colorKey:c,colorName:h,tooltip:d}=i,{formatManager:u}=o,g=e.reduce((A,M)=>A?.children[M],this.rootNode);if(g==null)return;const{datum:m,depth:y}=g;if(m==null||y==null)return;const S=[],x=r==null?void 0:m[r];if(x!=null){const A=[0,this.rootNode?.sumSize??0],M=u.format(this.callWithContext.bind(this),{type:"number",value:x,datum:m,seriesId:t,legendItemName:void 0,key:r,source:"tooltip",property:"size",boundSeries:this.getFormatterContext("size"),domain:A,fractionDigits:void 0});S.push({label:l,fallbackLabel:r,value:M??pA(x)})}const b=c==null?void 0:m[c];if(b!=null){const{colorDomain:A}=this,M=u.format(this.callWithContext.bind(this),{type:"number",value:b,datum:m,seriesId:t,legendItemName:void 0,key:c,source:"tooltip",property:"color",boundSeries:this.getFormatterContext("color"),domain:A,fractionDigits:void 0});S.push({label:h,fallbackLabel:c,value:M??pA(b)})}const f=this.getItemStyle({...g,colorValue:b??g.colorValue},!1),k={shape:"square",fill:f.fill,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0};return uA(k.fill)&&(k.fill={...k.fill,gradient:"linear",rotation:0,reverse:!1}),this.formatTooltipWithContext(d,{title:s==null?void 0:m[s],symbol:{marker:k},data:S},{seriesId:t,datum:m,title:void 0,depth:y,labelKey:s,secondaryLabelKey:a,childrenKey:n,sizeKey:r,sizeName:l,colorKey:c,colorName:h,...f})}createNodeData(){}pickNodeClosestDatum(e){return this.pickNodeNearestDistantObject(e,this.datumSelection.nodes())}animateEmptyUpdateReady(){Q$(this.id,"nodes",this.ctx.animationManager,[this.scalingGroup],{toFn(){return{scalingX:1,scalingY:1}},fromFn(){return{scalingX:0,scalingY:0}}})}computeFocusBounds(e){return e}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.label.itemStyler!=null}};Yg.className="SunburstSeries",Yg.type="sunburst";import{_ModuleSupport as a5}from"ag-charts-community";import{commonSeriesOptionsDefs as n5,constant as r5,required as l5,string as ha,without as c5}from"ag-charts-core";var{sunburstSeriesThemeableOptionsDef:h5}=a5,d5={...h5,...c5(n5,["highlightStyle","highlight","showInLegend"]),type:l5(r5("sunburst")),labelKey:ha,secondaryLabelKey:ha,childrenKey:ha,sizeKey:ha,colorKey:ha,sizeName:ha,colorName:ha},p5={series:{fills:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$palette:"fills"},{$applySwitch:[{$path:["/type",void 0,{$value:"$1"}]},{$value:"$1"},["gradient",Lr.FILL_GRADIENT_RADIAL_REVERSED_SERIES_DEFAULTS],["pattern",Lr.FILL_PATTERN_DEFAULTS],["image",Lr.FILL_IMAGE_DEFAULTS]]}]},strokes:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$palette:"strokes"}]},colorRange:{$palette:"divergingColors"},strokeWidth:{$isUserOption:["./strokes/0",2,0]},label:{...Lr.LABEL_BOXING_DEFAULTS,enabled:!0,fontFamily:{$ref:"fontFamily"},fontSize:{$rem:dA.LARGE},minimumFontSize:{$rem:9/hA},fontWeight:{$ref:"fontWeight"},color:{$ref:"chartBackgroundColor"},overflowStrategy:"ellipsis",wrapping:"never",spacing:2},secondaryLabel:{...Lr.LABEL_BOXING_DEFAULTS,enabled:!0,fontFamily:{$ref:"fontFamily"},fontSize:{$rem:dA.SMALLEST},minimumFontSize:{$rem:7/hA},fontWeight:{$ref:"fontWeight"},color:{$ref:"chartBackgroundColor"},overflowStrategy:"ellipsis",wrapping:"never"},sectorSpacing:2,padding:3,highlight:{unhighlightedItem:{fillOpacity:.6,strokeOpacity:.6},unhighlightedBranch:{fillOpacity:.2,strokeOpacity:.2}}},gradientLegend:{enabled:{$if:[{$path:"../series/0/colorKey"},!0,!1]}}},SA={type:"series",name:"sunburst",chartType:"standalone",enterprise:!0,solo:!0,version:$$,dependencies:[an],options:d5,themeTemplate:p5,create:e=>new Yg(e)};import{VERSION as u5,_ModuleSupport as bn}from"ag-charts-community";import{FONT_SIZE_RATIO as bA}from"ag-charts-core";import{_ModuleSupport as uh}from"ag-charts-community";import{cachedTextMeasurer as g5,calcLineHeight as m5,formatValue as vA,isGradientFill as y5,isNumberEqual as f5,mergeDefaults as kA,toPlainText as DA,wrapText as x5}from"ag-charts-core";import{_ModuleSupport as S5}from"ag-charts-community";import{BaseProperties as vn,Property as $}from"ag-charts-core";var{HierarchySeriesProperties:b5,makeSeriesTooltip:v5,Label:k5}=S5,AA=class extends k5{constructor(){super(...arguments),this.spacing=0}};p([$],AA.prototype,"spacing",2);var ys=class extends vn{};p([$],ys.prototype,"fill",2),p([$],ys.prototype,"fillOpacity",2),p([$],ys.prototype,"stroke",2),p([$],ys.prototype,"strokeWidth",2),p([$],ys.prototype,"strokeOpacity",2),p([$],ys.prototype,"opacity",2);var Ug=class extends vn{constructor(){super(...arguments),this.highlightedItem=new ys,this.unhighlightedItem=new ys}};p([$],Ug.prototype,"highlightedItem",2),p([$],Ug.prototype,"unhighlightedItem",2);var so=class extends vn{};p([$],so.prototype,"fill",2),p([$],so.prototype,"fillOpacity",2),p([$],so.prototype,"stroke",2),p([$],so.prototype,"strokeWidth",2),p([$],so.prototype,"strokeOpacity",2),p([$],so.prototype,"opacity",2);var Nr=class extends vn{constructor(){super(...arguments),this.highlightedBranch=new so,this.highlightedItem=new so,this.unhighlightedItem=new so,this.unhighlightedBranch=new so}};p([$],Nr.prototype,"highlightedBranch",2),p([$],Nr.prototype,"highlightedItem",2),p([$],Nr.prototype,"unhighlightedItem",2),p([$],Nr.prototype,"unhighlightedBranch",2);var ai=class extends vn{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.cornerRadius=0,this.textAlign="center",this.gap=0,this.padding=0,this.interactive=!0,this.label=new AA,this.highlight=new Ug}};p([$],ai.prototype,"fill",2),p([$],ai.prototype,"fillOpacity",2),p([$],ai.prototype,"stroke",2),p([$],ai.prototype,"strokeWidth",2),p([$],ai.prototype,"strokeOpacity",2),p([$],ai.prototype,"cornerRadius",2),p([$],ai.prototype,"textAlign",2),p([$],ai.prototype,"gap",2),p([$],ai.prototype,"padding",2),p([$],ai.prototype,"interactive",2),p([$],ai.prototype,"label",2),p([$],ai.prototype,"highlight",2);var Wt=class extends vn{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.cornerRadius=0,this.textAlign="center",this.verticalAlign="middle",this.gap=0,this.padding=0,this.label=new Ka,this.secondaryLabel=new Xl,this.highlight=new Nr}};p([$],Wt.prototype,"fill",2),p([$],Wt.prototype,"fillOpacity",2),p([$],Wt.prototype,"stroke",2),p([$],Wt.prototype,"strokeWidth",2),p([$],Wt.prototype,"strokeOpacity",2),p([$],Wt.prototype,"cornerRadius",2),p([$],Wt.prototype,"textAlign",2),p([$],Wt.prototype,"verticalAlign",2),p([$],Wt.prototype,"gap",2),p([$],Wt.prototype,"padding",2),p([$],Wt.prototype,"label",2),p([$],Wt.prototype,"secondaryLabel",2),p([$],Wt.prototype,"highlight",2);var ao=class extends b5{constructor(){super(...arguments),this.tooltip=v5(),this.group=new ai,this.tile=new Wt,this.undocumentedGroupFills=[],this.undocumentedGroupStrokes=[]}getStyle(e,t,i,o){const{fillOpacity:s,strokeWidth:a,strokeOpacity:n,fill:r=e?t[o%t.length]:t[Math.min(o,t.length)],stroke:l=e?i[o%t.length]:i[Math.min(o,i.length)]}=e?this.tile:this.group;return{fill:r,fillOpacity:s,stroke:l,strokeWidth:a,strokeOpacity:n,opacity:1}}};p([$],ao.prototype,"sizeName",2),p([$],ao.prototype,"labelKey",2),p([$],ao.prototype,"secondaryLabelKey",2),p([$],ao.prototype,"itemStyler",2),p([$],ao.prototype,"tooltip",2),p([$],ao.prototype,"group",2),p([$],ao.prototype,"tile",2),p([$],ao.prototype,"undocumentedGroupFills",2),p([$],ao.prototype,"undocumentedGroupStrokes",2);var{createDatumId:D5,Rect:MA,Group:IA,BBox:kn,Selection:jg,Text:Xg,Transformable:A5,getLabelStyles:M5,HierarchyHighlightState:Ei,toHierarchyHighlightString:Cr}=uh,I5=class extends uh.HierarchyNode{constructor(){super(...arguments),this.labelValue=void 0,this.secondaryLabelValue=void 0,this.label=void 0,this.secondaryLabel=void 0,this.bbox=void 0,this.padding=void 0}};function fs(e){return e.children.length>0?e.sumSize-e.sizeValue:e.sizeValue}var LA={left:0,center:.5,right:1},L5={top:0,middle:.5,bottom:1},MQ=class extends uh.Group{distanceSquared(e,t){return this.getBBox().distanceSquared(e,t)}},Zg=class extends uh.HierarchySeries{constructor(){super(...arguments),this.NodeClass=I5,this.properties=new ao,this.rectGroup=this.contentGroup.appendChild(new IA),this.datumSelection=jg.select(this.rectGroup,MA),this.labelSelection=jg.select(this.labelGroup,IA),this.highlightSelection=jg.select(this.rectGroup,MA)}groupTitleHeight(e,t){const{labelValue:i}=e,{label:o}=this.properties.group,s=3;if(i!=null){if(o.fontSize>t.width/s||o.fontSize>t.height/s)return;{const{height:a}=g5(o).measureLines(i);return Math.max(a,o.fontSize)}}}getNodePadding(e,t){if(e.parent==null)return{top:0,right:0,bottom:0,left:0};if(e.children.length===0){const{padding:n}=this.properties.tile;return{top:n,right:n,bottom:n,left:n}}const{label:{spacing:i},padding:o}=this.properties.group,s=this.groupTitleHeight(e,t),a=s==null?0:s+i;return{top:o+a,right:o,bottom:o,left:o}}sortChildren({children:e}){const t=Array.from(e,(o,s)=>s).filter(o=>fs(e[o])>0).sort((o,s)=>fs(e[s])-fs(e[o]));return{sortedChildrenIndices:t,childAt:o=>{const s=t[o];return e[s]}}}squarify(e,t){const{datum:i,children:o}=e;if(t.width<=0||t.height<=0){e.bbox=void 0,e.padding=void 0,e.midPoint.x=Number.NaN,e.midPoint.y=Number.NaN;return}const s=i==null?{top:0,right:0,bottom:0,left:0}:this.getNodePadding(e,t);e.parent==null?(e.bbox=void 0,e.padding=void 0,e.midPoint.x=Number.NaN,e.midPoint.y=Number.NaN):(e.bbox=t,e.padding=s,e.midPoint.x=t.x+t.width/2,e.midPoint.y=t.y);const{sortedChildrenIndices:a,childAt:n}=this.sortChildren(e),r=a.every(k=>o[k].children.length===0),l=1,c=t.width-s.left-s.right,h=t.height-s.top-s.bottom;if(c<=0||h<=0)return;const d=a.length;let u=0,g=0,m=1/0,y=a.reduce((k,A)=>k+fs(o[A]),0);const S=new kn(t.x+s.left,t.y+s.top,c,h),x=S.clone();let b=0;for(;b<d;){const k=fs(n(b)),A=fs(n(g)),M=x.width<x.height;u+=k;const I=M?x.height:x.width,D=M?x.width:x.height,L=D*A/u;let N=I*u/y;const T=Math.max(L,N)/Math.min(L,N),O=Math.abs(l-T);if(O<m){m=O,b++;continue}u-=k,N=I*u/y;let R=M?x.x:x.y;for(let w=g;w<b;w++){const E=n(w),B=fs(E),P=M?R:x.x,C=M?x.y:R,_=D*B/u,V=M?_:N,z=M?N:_,F=new kn(P,C,V,z);this.applyGap(S,F,r),this.squarify(E,F),y-=B,R+=_}M?(x.y+=N,x.height-=N):(x.x+=N,x.width-=N),g=b,u=0,m=1/0}const f=x.width<x.height;let v=f?x.x:x.y;for(let k=g;k<d;k++){const A=n(k),M=f?v:x.x,I=f?x.y:v,D=fs(A)/y,L=x.width*(f?D:1),N=x.height*(f?1:D),T=new kn(M,I,L,N);this.applyGap(S,T,r),this.squarify(A,T),v+=f?L:N}}applyGap(e,t,i){const o=i?this.properties.tile.gap*.5:this.properties.group.gap*.5,s=l=>({left:l.x,top:l.y,right:l.x+l.width,bottom:l.y+l.height}),a=s(e),n=s(t),r=["top","right","bottom","left"];for(const l of r)f5(a[l],n[l])||t.shrink(o,l)}createNodeData(){}getItemStyle(e,t,i){const{properties:o,colorScale:s}=this,{itemStyler:a}=o,n=e.datumIndex?.[0]??0,r=t?o.fills:o.undocumentedGroupFills,l=t?o.strokes:o.undocumentedGroupStrokes,c=t?n:e.depth??-1,h=this.getActiveHighlightNode(),d=this.getHierarchyHighlightState(i,h,e),u=this.getGroupHighlightState(i,h,e),g=t?d:u,m=t?this.getTileHighlightStyle(d,u,h):this.getGroupHighlightStyle(u),y=kA(m,o.getStyle(t,r,l,c));t&&e.colorValue!=null&&m?.fill==null&&(y.fill=s.convert(e.colorValue));let S=y;if(a!=null&&e!=null){const x=this.cachedDatumCallback(D5(this.getDatumId(e),i?"highlight":"node"),()=>{const b=this.makeItemStylerParams(e,S,Cr(g));return this.callWithContext(a,b)});x&&(S=kA(x,S))}return S}makeItemStylerParams(e,t,i){const{id:o}=this,s=this.filterItemStylerFillParams(t.fill)??t.fill;return{seriesId:o,datum:e.datum,depth:e.depth??-1,highlightState:i,...t,fill:s}}updateSelections(){const e=this.getActiveHighlightNode();if(this.highlightSelection.update(e==null?[]:[e],void 0,s=>this.getDatumId(s)),!this.nodeDataRefresh)return;this.nodeDataRefresh=!1;const{seriesRect:t}=this.chart??{};if(!t)return;const i=Array.from(this.rootNode),o=s=>{s.append([new Xg({tag:0}),new Xg({tag:1})])};this.datumSelection.update(i,void 0,s=>this.getDatumId(s)),this.labelSelection.update(i,o,s=>this.getDatumId(s))}getActiveHighlightNode(){const e=super.getActiveHighlightNode();if(!(e?.children.length&&!this.properties.group.interactive))return e}updateNodes(){const{rootNode:e,data:t}=this,{childrenKey:i,colorKey:o,colorName:s,labelKey:a,secondaryLabelKey:n,sizeKey:r,sizeName:l,tile:c,group:h}=this.properties,{seriesRect:d}=this.chart??{};if(!d||!t)return;this.rootNode?.walk(b=>{const{datum:f,depth:v,children:k}=b,A=k.length===0,M=A?c.label:h.label;let I;if(M.enabled&&f!=null&&v!=null&&a!=null){const L=f[a];I=this.getLabelText(L,f,a,"label",[],M,{depth:v,datum:f,childrenKey:i,colorKey:o,colorName:s,labelKey:a,secondaryLabelKey:n,sizeKey:r,sizeName:l,value:L})}I===""&&(I=void 0);let D;if(c.secondaryLabel.enabled&&A&&f!=null&&v!=null&&n!=null){const L=f[n];D=this.getLabelText(L,f,n,"secondaryLabel",[],c.secondaryLabel,{depth:v,datum:f,childrenKey:i,colorKey:o,colorName:s,labelKey:a,secondaryLabelKey:n,sizeKey:r,sizeName:l,value:L})}D===""&&(D=void 0),b.labelValue=DA(I),b.secondaryLabelValue=DA(D)});const{width:u,height:g}=d;this.squarify(e,new kn(0,0,u,g)),this.rootNode?.walk(b=>{const{bbox:f,children:v,labelValue:k,secondaryLabelValue:A}=b;if(b.label=void 0,b.secondaryLabel=void 0,f!=null)if(v.length===0){const M={width:f.width,height:f.height,meta:null},I=mp(k,this.properties.tile.label,A,this.properties.tile.secondaryLabel,{padding:c.padding},()=>M);if(I==null)return;const{height:D,label:L,secondaryLabel:N}=I,{textAlign:T,verticalAlign:O,padding:R}=c,w=LA[T]??.5,E=f.x+R+(f.width-2*R)*w,B=L5[O]??.5,P=f.y+R+D*.5+(f.height-2*R-D)*B;if(L!=null){const{fontStyle:C="normal",fontFamily:_,fontWeight:V="normal",color:z="black"}=this.properties.tile.label;b.label={text:L.text,fontSize:L.fontSize,lineHeight:L.lineHeight,fontStyle:C,fontFamily:_,fontWeight:V,color:z,textAlign:T,verticalAlign:"middle",x:E,y:P-(D-L.height)*.5}}if(N!=null){const{fontStyle:C="normal",fontFamily:_,fontWeight:V="normal",color:z="black"}=this.properties.tile.secondaryLabel;b.secondaryLabel={text:N.text,fontSize:N.fontSize,lineHeight:N.fontSize,fontStyle:C,fontFamily:_,fontWeight:V,color:z,textAlign:T,verticalAlign:"middle",x:E,y:P+(D-N.height)*.5}}}else{if(k==null)return;{const{padding:M,textAlign:I}=h,D=this.groupTitleHeight(b,f);if(D==null)return;const L=f.width-2*M,N=x5(k,{maxWidth:f.width-2*M,font:h.label,textWrap:"never"}),T=LA[I]??.5,{fontStyle:O="normal",fontFamily:R,fontWeight:w="normal",color:E="black"}=this.properties.group.label;b.label={text:N,fontSize:h.label.fontSize,lineHeight:m5(h.label.fontSize),fontStyle:O,fontFamily:R,fontWeight:w,color:E,textAlign:I,verticalAlign:"middle",x:f.x+M+L*T,y:f.y+M+D*.5}}}});const m={series:new kn(0,0,u,g),axis:new kn(0,0,u,g)},y=(b,f,v)=>{const{bbox:k}=b;if(k==null){f.visible=!1;return}const{depth:A=-1}=b,M=b.children.length===0,I=this.getItemStyle(b,M,v);f.crisp=!0,f.setStyleProperties(I,m),f.cornerRadius=M?c.cornerRadius:h.cornerRadius,f.zIndex=[0,A,v?1:0];const D=b.parent?.children.every(T=>T.children.length===0),L=b.parent==null?void 0:b.parent.bbox,N=b.parent==null?void 0:b.parent.padding;D===!0&&L!=null&&N!=null?(f.clipBBox=k,f.x=L.x+N.left,f.y=L.y+N.top,f.width=L.width-(N.left+N.right),f.height=L.height-(N.top+N.bottom)):(f.clipBBox=void 0,f.x=k.x,f.y=k.y,f.width=k.width,f.height=k.height),f.visible=!0};this.datumSelection.each((b,f)=>y(f,b,!1)),this.highlightSelection.each((b,f)=>{y(f,b,!0)});const S=(b,f,v,k)=>{const A=b.children.length===0,M=v===0?b.label:b.secondaryLabel;if(M==null){f.visible=!1;return}let I,D;v===0?(I=A?c.label:h.label,D=["series",`${this.declarationOrder}`,A?"tile":"group","label"]):(I=c.secondaryLabel,D=["series",`${this.declarationOrder}`,"tile","secondaryLabel"]);const{opacity:L}=this.getItemStyle(b,A,k)??{},N={childrenKey:this.properties.childrenKey,colorKey:this.properties.colorKey,colorName:this.properties.colorName??this.properties.colorKey,depth:b.depth??Number.NaN,labelKey:this.properties.labelKey,secondaryLabelKey:this.properties.secondaryLabelKey,sizeKey:this.properties.sizeKey,sizeName:this.properties.sizeName??this.properties.sizeKey},T=this.ctx.highlightManager?.getActiveHighlight(),O=M5(this,b,N,I,k,T,D);f.text=M.text,f.fontSize=M.fontSize,f.lineHeight=M.lineHeight,f.fontStyle=M.fontStyle,f.fontFamily=M.fontFamily,f.fontWeight=M.fontWeight,f.fillOpacity=L??1,f.fill=O.color,f.setBoxing(O),f.textAlign=M.textAlign,f.textBaseline=M.verticalAlign,f.x=M.x,f.y=M.y,f.visible=!0,f.zIndex=1},x=this.getActiveHighlightNode();for(const b of this.labelSelection.selectByClass(Xg)){const f=b.closestDatum();S(f,b,b.tag,f===x)}}getGroupHighlightState(e,t,i){const o=i.datumIndex,s=t?.datumIndex,a=this.isDescendantDatumIndex(o,s);if(i.children?.length===0)return o==null||t==null||t.children?.length===0?Ei.None:a?Ei.Item:Ei.OtherItem;if(t==null||t.children?.length===0)return Ei.None;const n=i.depth!=null&&t.depth!=null&&i.depth===t.depth;return a&&!n?Ei.None:e?Ei.Item:Ei.OtherItem}getTileHighlightStyle(e,t,i){if(i?.children&&i.children.length>0){const s=this.getGroupHighlightStyle(t);return s?.fillOpacity==null&&s?.strokeOpacity==null?void 0:{fillOpacity:s.fillOpacity,strokeOpacity:s.strokeOpacity}}return this.getHierarchyHighlightStyles(e,this.properties.tile.highlight)}getGroupHighlightStyle(e){const{highlight:t}=this.properties.group;switch(e){case Ei.Item:return t.highlightedItem;case Ei.OtherItem:return t.unhighlightedItem;default:return}}getHighlightStateString(e,t,i){if(i==null)return Cr(Ei.None);const o=i.reduce((r,l)=>r?.children[l],this.rootNode),s=this.getActiveHighlightNode();if(o==null)return Cr(Ei.None);if((o.children?.length??0)===0){const r=this.getHierarchyHighlightState(t??!1,s,o);return Cr(r)}const n=this.getGroupHighlightState(t??!1,s,o);return Cr(n)}isDescendantDatumIndex(e,t){if(t==null||t.length===0)return!0;if(e==null||e.length<t.length)return!1;for(let i=0;i<t.length;i+=1)if(e[i]!==t[i])return!1;return!0}pickNodesExactShape(e){const t=super.pickNodesExactShape(e);return t.sort((i,o)=>o.datumIndex.length-i.datumIndex.length),t}pickNodeClosestDatum(e){const t=this.pickNodesExactShape(e);return t.length!==0?{datum:t[0],distance:0}:this.pickNodeNearestDistantObject(e,this.datumSelection.nodes())}getTooltipContent(e){const{id:t,properties:i,ctx:o}=this,{formatManager:s}=o,{labelKey:a,secondaryLabelKey:n,childrenKey:r,sizeKey:l,sizeName:c,colorKey:h,colorName:d,tooltip:u}=i,g=e.reduce((D,L)=>D?.children[L],this.rootNode);if(g==null)return;const{datum:m,depth:y,children:S}=g;if(m==null||y==null)return;const x=S.length===0,b=[],f=l==null?void 0:m[l];if(f!=null){const D=[0,this.rootNode?.sumSize??0],L=s.format(this.callWithContext.bind(this),{type:"number",value:f,datum:m,seriesId:t,legendItemName:void 0,key:l,source:"tooltip",property:"size",boundSeries:this.getFormatterContext("size"),domain:D,fractionDigits:void 0});b.push({label:c,fallbackLabel:l,value:L??vA(f)})}const v=h==null?void 0:m[h];if(v!=null){const{colorDomain:D}=this,L=s.format(this.callWithContext.bind(this),{type:"number",value:v,datum:m,seriesId:t,legendItemName:void 0,key:h,source:"tooltip",property:"color",boundSeries:this.getFormatterContext("color"),domain:D,fractionDigits:void 0});b.push({label:d,fallbackLabel:h,value:L??vA(v)})}const k=this.getItemStyle({...g,colorValue:v??g.colorValue},x,!1),M={shape:"square",fill:k.fill,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0};y5(M.fill)&&(M.fill={...M.fill,gradient:"linear",rotation:0,reverse:!1});const I=x?{marker:M}:void 0;return this.formatTooltipWithContext(u,{title:a==null?void 0:m[a],symbol:I,data:b},{seriesId:t,datum:m,title:void 0,depth:y,labelKey:a,secondaryLabelKey:n,childrenKey:r,sizeKey:l,sizeName:c,colorKey:h,colorName:d,...k})}computeFocusBounds(e){return A5.toCanvas(this.contentGroup,e.getBBox())}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.tile.label.itemStyler!=null||this.properties.group.label.itemStyler!=null}};Zg.className="TreemapSeries",Zg.type="treemap";import{_ModuleSupport as N5}from"ag-charts-community";import{arrayOf as NA,color as CA,commonSeriesOptionsDefs as C5,constant as T5,required as w5,string as da,undocumented as TA,without as P5}from"ag-charts-core";var{treemapSeriesThemeableOptionsDef:O5}=N5,qg={...O5,...P5(C5,["highlightStyle","highlight","showInLegend"]),type:w5(T5("treemap")),labelKey:da,secondaryLabelKey:da,childrenKey:da,sizeKey:da,colorKey:da,sizeName:da,colorName:da};qg.undocumentedGroupFills=TA(NA(CA)),qg.undocumentedGroupStrokes=TA(NA(CA));var wA={type:"series",name:"treemap",chartType:"standalone",enterprise:!0,solo:!0,version:u5,dependencies:[an],options:qg,themeTemplate:{series:{fills:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$palette:"fills"},{$applySwitch:[{$path:["/type",void 0,{$value:"$1"}]},{$value:"$1"},["gradient",bn.FILL_GRADIENT_LINEAR_DEFAULTS],["pattern",bn.FILL_PATTERN_DEFAULTS],["image",bn.FILL_IMAGE_DEFAULTS]]}]},strokes:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$palette:"strokes"}]},colorRange:{$palette:"divergingColors"},undocumentedGroupFills:{$palette:"hierarchyColors"},undocumentedGroupStrokes:{$palette:"secondHierarchyColors"},group:{label:{...bn.LABEL_BOXING_DEFAULTS,enabled:!0,color:{$ref:"textColor"},fontStyle:void 0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},spacing:4},fill:void 0,stroke:void 0,strokeWidth:1,padding:4,gap:2,textAlign:"left",highlight:{unhighlightedItem:{opacity:.2,fillOpacity:.2,strokeOpacity:.2}}},tile:{label:{...bn.LABEL_BOXING_DEFAULTS,enabled:!0,color:{$ref:"chartBackgroundColor"},fontStyle:void 0,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:1.5},minimumFontSize:{$rem:bA.SMALLER},fontFamily:{$ref:"fontFamily"},wrapping:"on-space",overflowStrategy:"ellipsis",spacing:2},secondaryLabel:{...bn.LABEL_BOXING_DEFAULTS,enabled:!0,color:{$ref:"chartBackgroundColor"},fontStyle:void 0,fontWeight:void 0,fontSize:{$ref:"fontSize"},minimumFontSize:{$rem:bA.SMALLER},fontFamily:{$ref:"fontFamily"},wrapping:"never",overflowStrategy:"ellipsis"},fill:void 0,stroke:void 0,strokeWidth:{$isUserOption:["../strokes/0",2,{$isUserOption:["./stroke",2,0]}]},padding:3,gap:1,highlight:{unhighlightedItem:{fillOpacity:.6,strokeOpacity:.6},unhighlightedBranch:{fillOpacity:.2,strokeOpacity:.2}}}},gradientLegend:{enabled:{$if:[{$path:"../series/0/colorKey"},!0,!1]}}},create:e=>new Zg(e)};import{AllCommunityModule as R5}from"ag-charts-community";import{AllCartesianAxesModule as E5}from"ag-charts-community";var PA=[E5,Ch].flat();import{AllCartesianSeriesModule as _5}from"ag-charts-community";var OA=[_5,ip,Ul,uv,bv,Sp,ql,oc,nc,Kp].flat(),RA=[PA,OA,Tn,Rd,Ed,wl,$n,Hd,_l,Kd,cx,Mc,Gp,jp,qp,iu,sn].flat();import{BarSeriesModule as B5,LineSeriesModule as V5,NumberAxisModule as z5,TimeAxisModule as F5}from"ag-charts-community";import{VERSION as H5}from"ag-charts-community";import{array as W5,boolean as pa,commonChartOptionsDefs as K5,defined as me,positiveNumber as G5,string as Dn,tooltipOptionsDefs as $5,undocumented as Y5,union as U5}from"ag-charts-core";import{_ModuleSupport as j5}from"ag-charts-community";import{Logger as X5,mergeDefaults as Z5}from"ag-charts-core";import*as q5 from"ag-charts-core";import{FONT_SIZE_RATIO as Qg}from"ag-charts-core";var{DEFAULT_ANNOTATION_HANDLE_FILL:Q5,DEFAULT_ANNOTATION_STATISTICS_COLOR:J5,DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE:eY,DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL:EA,DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE:_A,DEFAULT_ANNOTATION_STATISTICS_FILL:tY,DEFAULT_ANNOTATION_STATISTICS_STROKE:iY,DEFAULT_FIBONACCI_STROKES:BA,DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL:An,DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR:To,DEFAULT_TEXTBOX_COLOR:oY,DEFAULT_TEXTBOX_FILL:sY,DEFAULT_TEXTBOX_STROKE:aY,DEFAULT_TEXT_ANNOTATION_COLOR:nY}=q5,ki={stroke:To},mt={fill:Q5},VA={color:"white",fill:To},wo={color:To},ua={color:nY,fontSize:{$rem:Qg.LARGE},fontFamily:{$ref:"fontFamily"}},Jg={...ua,fontSize:{$ref:"fontSize"},color:J5,fill:tY,stroke:iY,strokeWidth:1,divider:{stroke:eY,strokeWidth:1,strokeOpacity:.5}},em={...ki,background:{fill:An,fillOpacity:.2},handle:{...mt},text:{...wo},statistics:{...Jg}},rY={line:{...ki,handle:{...mt},text:{...wo}},"horizontal-line":{...ki,handle:{...mt},axisLabel:{...VA},text:{...wo}},"vertical-line":{...ki,handle:{...mt},axisLabel:{...VA},text:{...wo}},"disjoint-channel":{...ki,background:{fill:An,fillOpacity:.2},handle:{...mt},text:{...wo}},"parallel-channel":{...ki,background:{fill:An,fillOpacity:.2},handle:{...mt},text:{...wo}},"fibonacci-retracement":{...ki,strokes:BA,rangeStroke:To,handle:{...mt},text:{...wo,position:"center"},label:{...ua,color:void 0,fontSize:{$rem:Qg.SMALLER}}},"fibonacci-retracement-trend-based":{...ki,strokes:BA,rangeStroke:To,handle:{...mt},text:{...wo,position:"center"},label:{...ua,color:void 0,fontSize:{$rem:Qg.SMALLER}}},callout:{...ki,...ua,color:{$ref:"textColor"},handle:{...mt},fill:An,fillOpacity:.2},comment:{...ua,color:"white",fontWeight:700,handle:{...mt},fill:To},note:{...ua,color:oY,fill:To,stroke:{$ref:"chartBackgroundColor"},strokeWidth:1,strokeOpacity:1,handle:{...mt},background:{fill:sY,stroke:aY,strokeWidth:1}},text:{...ua,handle:{...mt}},arrow:{...ki,handle:{...mt},text:{...wo}},"arrow-up":{fill:{$palette:"up.fill"},handle:{...mt,stroke:To}},"arrow-down":{fill:{$palette:"down.fill"},handle:{...mt,stroke:To}},"date-range":{...em},"price-range":{...em},"date-price-range":{...em},"quick-date-price-range":{up:{...ki,fill:An,fillOpacity:.2,handle:{...mt},statistics:{...Jg,color:"#fff",fill:An,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}}},down:{...ki,stroke:_A,fill:EA,fillOpacity:.2,handle:{...mt,stroke:_A},statistics:{...Jg,color:"#fff",fill:EA,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}}}},axesButtons:{enabled:!0}},{SAFE_STROKE_FILL_OPERATION:lY}=j5,cY=["ohlc","line","step-line","hlc","high-low","candlestick","hollow-candlestick"],hY=[{icon:"trend-line-drawing",tooltip:"toolbarAnnotationsLineAnnotations",value:"line-menu"},{icon:"fibonacci-retracement-drawing",tooltip:"toolbarAnnotationsFibonacciAnnotations",value:"fibonacci-menu"},{icon:"text-annotation",tooltip:"toolbarAnnotationsTextAnnotations",value:"text-menu"},{icon:"arrow-drawing",tooltip:"toolbarAnnotationsShapeAnnotations",value:"shape-menu"},{icon:"measurer-drawing",tooltip:"toolbarAnnotationsMeasurerAnnotations",value:"measurer-menu"},{icon:"delete",tooltip:"toolbarAnnotationsClearAll",value:"clear"}];function dY(e,t,i){const{dateKey:o="date",highKey:s="high",openKey:a="open",lowKey:n="low",closeKey:r="close",volumeKey:l="volume",chartType:c="candlestick",navigator:h=!1,volume:d=!0,rangeButtons:u=!0,statusBar:g=!0,toolbar:m=!0,zoom:y=!0,sync:S=!1,theme:x,data:b,formatter:f,...v}=e,k=uY(c,o,s,n,a,r),A=pY(i,o,a,r,d,l),I={navigator:{enabled:h,...d?{miniChart:{enabled:h,series:[{type:"line",xKey:o,yKey:l,stroke:lY,marker:{enabled:!1}}]},height:40,minHandle:{height:46},maxHandle:{height:46}}:null}},D={annotations:{enabled:m,optionsToolbar:{enabled:m},snap:!0,toolbar:{enabled:m,buttons:hY,padding:0},data:b,xKey:o,volumeKey:d?l:void 0}},L=g?{statusBar:{enabled:!0,highKey:s,openKey:a,lowKey:n,closeKey:r,volumeKey:d?l:void 0}}:null,N={zoom:{enabled:y,autoScaling:{enabled:!0},onDataChange:{stickToEnd:!0},enableIndependentAxes:!0}},T={ranges:{enabled:u}},O=S?{sync:{enabled:S,nodeInteraction:!0,zoom:!0}}:null,R=d?{yVolume:{type:"number",position:"left",label:{enabled:!1},crosshair:{enabled:!1},gridLine:{enabled:!1},nice:!1,layoutConstraints:{stacked:!1,width:20,unit:"percent",align:"end"}}}:{};return{theme:{baseTheme:typeof x=="string"?x:"ag-financial",...Z5(typeof x=="object"?x:null,{overrides:{common:{title:{padding:4},padding:{top:6,right:8,bottom:6},chartToolbar:{enabled:m},annotations:{...rY},axes:{number:{interval:{maxSpacing:45},label:{format:".2f"}},category:{gridLine:{enabled:!0}},time:{gridLine:{enabled:!0}},"unit-time":{gridLine:{enabled:!0}},"ordinal-time":{gridLine:{enabled:!0}}}},bar:{series:{fillOpacity:.5,highlight:{unhighlightedItem:{opacity:1},unhighlightedSeries:{opacity:1}}}},line:{series:{marker:{enabled:!1},highlight:{unhighlightedSeries:{opacity:1}},...gh(c,{hlc:{stroke:{$palette:"altNeutral.stroke"},strokeWidth:2},line:{stroke:{$palette:"neutral.stroke"}},"step-line":{stroke:{$palette:"neutral.stroke"},interpolation:{type:"step"}}})}},candlestick:{series:{highlight:{unhighlightedItem:{opacity:1},unhighlightedSeries:{opacity:1}},...gh(c,{"hollow-candlestick":{item:{up:{fill:"transparent"}}}})}},ohlc:{series:{highlight:{unhighlightedItem:{opacity:1},unhighlightedSeries:{opacity:1}}}},"range-area":{series:{fillOpacity:.3,strokeWidth:2,highlight:{bringToFront:!1,unhighlightedItem:{opacity:1},unhighlightedSeries:{opacity:1}},...gh(c,{hlc:{fill:{$if:[{$eq:[{$value:"$index"},1]},{$palette:"up.fill"},{$palette:"down.fill"}]},stroke:{$if:[{$eq:[{$value:"$index"},1]},{$palette:"up.stroke"},{$palette:"down.stroke"}]}}})}},"range-bar":{series:{highlight:{unhighlightedItem:{opacity:1},unhighlightedSeries:{opacity:1}},...gh(c,{"high-low":{fill:{$palette:"neutral.fill"},stroke:{$palette:"neutral.stroke"}}})}}}})},animation:{enabled:!1},legend:{enabled:!1},series:[...A,...k],axes:{y:{type:"number",position:"right",crosshair:{enabled:!0,snap:!1},layoutConstraints:{stacked:!1,width:100,unit:"percent",align:"start"}},...R,x:{type:"ordinal-time",position:"bottom",line:{enabled:!1},label:{enabled:!0},crosshair:{enabled:!0}}},tooltip:{enabled:!1},data:b,formatter:f,...D,...I,...L,...N,...T,...O,...v}}function pY(e,t,i,o,s,a){return s?[{type:"bar",xKey:t,yKey:a,yKeyAxis:"yVolume",tooltip:{enabled:!1},simpleItemStyler(n){const{up:r,down:l}=e().palette;return{fill:n[i]<n[o]?r?.fill:l?.fill}},focusPriority:1,highlight:{unhighlightedSeries:{opacity:1}}}]:[]}var zA="range-area";function uY(e,t,i,o,s,a){const n={xKey:t,openKey:s,closeKey:a,highKey:i,lowKey:o},r={xKey:t,yKey:a},l={pickOutsideVisibleMinorAxis:!0};switch(e??"candlestick"){case"ohlc":return gY(l,n);case"line":case"step-line":return mY(l,r);case"hlc":return yY(l,r,n);case"high-low":return fY(l,n);case"candlestick":case"hollow-candlestick":return FA(l,n);default:return X5.warnOnce(`unknown chart type: ${e}; expected one of: ${cY.join(", ")}`),FA(l,n)}}function gY(e,t){return[{type:"ohlc",focusPriority:0,...e,...t}]}function mY(e,t){return[{type:"line",focusPriority:0,...e,...t}]}function yY(e,t,{xKey:i,highKey:o,closeKey:s,lowKey:a}){return[{type:zA,focusPriority:0,...e,xKey:i,yHighKey:o,yLowKey:s},{type:zA,focusPriority:0,...e,xKey:i,yHighKey:s,yLowKey:a},{type:"line",...e,...t}]}function fY(e,{xKey:t,highKey:i,lowKey:o}){return[{type:"range-bar",...e,xKey:t,yHighKey:i,yLowKey:o,tooltip:{range:"nearest"},focusPriority:0}]}function FA(e,t){return[{type:"candlestick",focusPriority:0,...e,...t}]}function gh(e,t){return t[e]??t.default}var xY={chartType:U5("candlestick","hollow-candlestick","ohlc","line","step-line","hlc","high-low"),dateKey:Dn,openKey:Dn,highKey:Dn,lowKey:Dn,closeKey:Dn,volumeKey:Dn,navigator:pa,volume:pa,rangeButtons:pa,statusBar:pa,toolbar:pa,zoom:pa,sync:pa,theme:me,container:me,width:me,height:me,minWidth:me,minHeight:me,listeners:me,initialState:me,title:me,data:W5,formatter:me},SY={theme:me,container:me,animation:me,background:me,contextMenu:me,context:()=>!0,listeners:me,locale:me,width:me,height:me,minWidth:me,minHeight:me,title:me,subtitle:me,footnote:me,padding:me,tooltip:{...$5,...K5.tooltip}};SY.overrideDevicePixelRatio=Y5(G5);var bY={type:"preset",name:"price-volume",enterprise:!0,dependencies:[wl,qp],version:H5,options:xY,create:dY},HA=[bY,B5,V5,Ul,ql,nc,oc,Tn,Rd,Ed,wl,$n,Hd,_l,Kd,Mc,Gp,jp,iu,sn,Ch,F5,z5],WA=[$v,tA];import{AllPolarModule as vY}from"ag-charts-community";var KA=[vY,Dm,Sm,zm,Vm,Xk,bD,AD,ED,KD,Tn,$n,_l,Mc].flat(),GA=[lk,hk,bk,Ck,wk],$A=[R5,RA,KA,GA,WA,HA,Qb,aD,cA,SA,wA].flat();import{AgCharts as mh,ModuleRegistry as YA,VERSION as kY,_Scene as DY,_Theme as AY,_Util as MY}from"ag-charts-community";import"ag-charts-community";import{ModuleRegistry as IY,enterpriseRegistry as Tr}from"ag-charts-core";function LY(){IY.registerModules($A),Tr.styles=cm,Tr.licenseManager=e=>new Ss(e.container?.ownerDocument??(typeof document>"u"?void 0:document)),Tr.injectWatermark=lm,Tr.createBackground=e=>new yh(e),Tr.createForeground=e=>new In(e)}var NY={setLicenseKey(e){Ss.setLicenseKey(e)}},CY={VERSION:kY,_Scene:DY,_Theme:AY,_Util:MY,create:mh.create.bind(mh),createSparkline:mh.__createSparkline.bind(mh),setup:()=>{YA.setRegistryMode(YA.RegistryMode.Integrated),LY()},setGridContext:Ss.setGridContext.bind(Ss),setLicenseKey:Ss.setLicenseKey.bind(Ss),isEnterprise:!0};sm.setRegistryMode(sm.RegistryMode.Enterprise),Mn.styles=cm,Mn.licenseManager=e=>new Ss(e.container?.ownerDocument??(typeof document>"u"?void 0:document)),Mn.injectWatermark=lm,Mn.createBackground=e=>new yh(e),Mn.createForeground=e=>new In(e);export{CY as AgChartsEnterpriseModule,hm as AgTooltipAnchorToType,dm as AgTooltipPlacementType,PA as AllCartesianAxesModule,RA as AllCartesianModule,OA as AllCartesianSeriesModule,$A as AllEnterpriseModule,WA as AllGaugeModule,GA as AllMapSeriesModule,KA as AllPolarModule,Sm as AngleCategoryAxisModule,Dm as AngleNumberAxisModule,Tn as AnimationModule,Rd as AnnotationsModule,Ed as BandHighlightModule,ip as BoxPlotSeriesModule,Ul as CandlestickSeriesModule,wl as ChartToolbarModule,Qb as ChordSeriesModule,uv as ConeFunnelSeriesModule,$n as ContextMenuModule,Hd as CrosshairModule,_l as DataSourceModule,Kd as ErrorBarsModule,HA as FinancialChartModule,cx as FlashOnUpdateModule,bv as FunnelSeriesModule,Mc as GradientLegendModule,Sp as HeatmapSeriesModule,NY as LicenseManager,$v as LinearGaugeModule,hk as MapLineBackgroundSeriesModule,lk as MapLineSeriesModule,bk as MapMarkerSeriesModule,wk as MapShapeBackgroundSeriesModule,Ck as MapShapeSeriesModule,Gp as NavigatorModule,Xk as NightingaleSeriesModule,ql as OhlcSeriesModule,Ch as OrdinalTimeAxisModule,aD as PyramidSeriesModule,bD as RadarAreaSeriesModule,AD as RadarLineSeriesModule,ED as RadialBarSeriesModule,KD as RadialColumnSeriesModule,tA as RadialGaugeModule,Vm as RadiusCategoryAxisModule,zm as RadiusNumberAxisModule,oc as RangeAreaSeriesModule,nc as RangeBarSeriesModule,jp as RangesModule,cA as SankeySeriesModule,qp as StatusBarModule,SA as SunburstSeriesModule,iu as SyncModule,wA as TreemapSeriesModule,Kp as WaterfallSeriesModule,sn as ZoomModule};
